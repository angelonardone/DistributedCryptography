import{r as t,g as s,f as e,h as n,H as i}from"./p-7af91c05.js";import{R as o,r,c,a,d as u,e as l}from"./p-2cf94d81.js";import{r as d,i as f}from"./p-23a9d308.js";import{S as h}from"./p-2a2bca47.js";import{L as m}from"./p-9db16727.js";const p="--ch-layout-splitter-fixed-sizes-sum";const b=0;const g=t=>{const s=t.item.id;return t.parentItem.items.findIndex((t=>t.id===s))};const z=(t,s)=>s==="columns"?t.clientX:t.clientY;const y=(t,s)=>s==="columns"?t.left:t.top;const v=t=>Number(t.size.replace("fr","").trim());const x=(t,s="size")=>{const e=s==="size"?t.size:t.minSize;return Number(e.replace("px","").trim())};const $=t=>t.size.includes("px");const w=t=>t.minSize&&t.minSize!=="0px";const k=t=>!$(t.item)&&w(t.item)?`minmax(${t.item.minSize},${t.actualSize})`:t.actualSize;const S=(t,s,e)=>t.map(((t,n)=>t.dragBar?.hidden!==true&&n!==e?`${k(s.get(t.id))} ${t.dragBar?.size??0}px`:k(s.get(t.id)))).join(" ");const _=t=>{const s=v(t);const e=`${s*100}%`;return t.fixedOffsetSize?`calc(${e} + var(${p}) * ${-s} + ${t.fixedOffsetSize}px)`:`calc(${e} + var(${p}) * ${-s})`};const I=t=>$(t)?t.size:_(t);const R=(t,s)=>{const e=`${s}px`;t.item.size=e;t.actualSize=e};const D=(t,s)=>R(t,x(t.item)+s);const M=(t,s)=>{const e=`${s}fr`;t.item.size=e;t.actualSize=_(t.item)};const j=(t,s)=>M(t,v(t.item)+s);const A=(t,s)=>{const e=t.item;e.fixedOffsetSize=s;t.actualSize=I(e)};const C=(t,s)=>A(t,s+(t.item.fixedOffsetSize??0));const L=t=>{if(w(t)&&x(t)<x(t,"min")){t.size=t.minSize}};const B=(t,s)=>{const e=t.container.querySelector(`[id="${s.item.id}"]`);return t.direction==="columns"?e.clientWidth:e.clientHeight};const H=(t,s,e)=>{if(e.mouseEvent===undefined){return{status:"ok"}}const n=e.dragBar.getBoundingClientRect();const i=y(n,e.direction);const o=z(e.mouseEvent,e.direction);if(t===0){const t=e.direction==="columns"&&e.RTL?o>i:o<i;if(t){return{status:"deny"}}}if(s===0){const t=e.direction==="columns"&&e.RTL?o<i:o>i;if(t){return{status:"deny"}}}return{status:"ok"}};const F=(t,s,e,n,i,o)=>{const r=w(t.item)?x(t.item,"min"):b;const c=e==="px"?x(t.item):B(o,t);const a=c-r;if(a+i<=0){return{status:a===0?"deny":"not-enough-space",availableIncrement:a}}const u=w(s.item)?x(s.item,"min"):b;const l=n==="px"?x(s.item):B(o,s);const d=l-u;if(d-i<=0){return{status:d===0?"deny":"not-enough-space",availableIncrement:d}}return H(a,d,o)};const P=(t,s)=>T(t.items,s,o);function T(t,s,e){let n=0;let i=0;const o=t.length-1;t.forEach(((t,s)=>{if($(t)){L(t);i+=x(t)}else{n+=v(t)}i+=(t.fixedOffsetSize??0)+(s!==o?t.dragBar?.size??0:0)}));if(n>0){t.forEach((t=>{if(!$(t)){const s=v(t);const e=s/n;t.size=`${e}fr`}}))}t.forEach((t=>{const n={item:t,parentItem:e,actualSize:I(t)};if(t.items!=null){const e=t;const i=T(e.items,s,e);n.fixedSizesSum=i}s.set(t.id,n)}));return i}const E={"px-px":(t,s,e)=>{D(t,e);D(s,-e)},"px-fr":(t,s,e)=>{D(t,e);C(s,-e)},"fr-px":(t,s,e)=>{C(t,e);D(s,-e)},"fr-fr":(t,s,e,n)=>{const i=e/n;j(t,i);j(s,-i)}};const N=(t,s,e,n,i)=>{const o=$(t.item)?"px":"fr";const r=$(s.item)?"px":"fr";let c=e;const a=F(t,s,o,r,e,i);if(a.status==="deny"){return false}if(a.status==="not-enough-space"){c=a.availableIncrement*Math.sign(c)}E[`${o}-${r}`](t,s,c,n);return true};const O=(t,s,e,n)=>{const i=t.direction==="columns"&&t.RTL?-e:e;const r=s.get(t.itemStartId);const c=s.get(t.itemEndId);const a=r.parentItem===o?t.fixedSizesSumRoot:s.get(r.parentItem.id).fixedSizesSum;const u=t.layoutItems;const l=t.containerSize-a;const d=N(r,c,i,l,t);if(!d){return}t.container.style.setProperty(n,S(u,s,u.length-1));t.dragBar.ariaValueText=r.actualSize};const U=0;const K=(t,s)=>{const e=s.get(t);let n=undefined;let i=U;if(!e){return{success:false,reconnectedSubtree:n,fixedSizesSumDecrement:i}}const o=[];const r=g(e);const c=e.parentItem;const a=c.items;const u=r===0?1:r-1;const l=a[u];o.push([a,r,t]);if(a.length>2){i=V(e,s.get(l.id))}else if(a.length===2){const t=s.get(c.id);const e=s.get(l.id);n={nodeToRemove:l.id,nodeToReconnect:c.id};if(l.items!=null){l.items.forEach((t=>{s.get(t.id).parentItem=c}))}t.fixedSizesSum=e.fixedSizesSum;delete c.items;Object.keys(l).forEach((t=>{if(t!=="id"&&t!=="size"&&t!=="dragBar"&&t!=="fixedOffsetSize"&&t!=="sticky"){c[t]=l[t]}}));s.delete(l.id)}else;o.forEach((t=>{d(t[0],t[1]);s.delete(t[2])}));return{success:true,reconnectedSubtree:n,fixedSizesSumDecrement:i}};function V(t,s,e){const n=t.item;const i=s.item;if($(n)&&$(i)){D(s,x(n));return U}if($(n)){const t=x(n);let e=t;const o=i.fixedOffsetSize;if(o!=null){e+=o;C(s,-o)}return e}if($(i)){return U}if(n.fixedOffsetSize!=null){C(t,n.fixedOffsetSize)}const o=v(n)+v(i);M(s,o);return U}const q=(t,s,e,n,i,o)=>{const r=i.get(t);if(!r){return{success:false}}const c=i.get(s);if(!c){return{success:false}}const a=g(c);const u=e==="before"?a:a+1;const l=r.item.items;if(u===l.length){l.push(n)}else{f(l,n,u)}const d={item:n,parentItem:r.item,actualSize:undefined};if(o){const t=$(c.item);const s=(t?x(c.item):v(c.item))/2;if(t){R(d,s);R(c,s)}else{const t=c.item.fixedOffsetSize;if(t){A(d,t/2);A(c,t/2)}M(d,s);M(c,s)}}i.set(n.id,d);return{success:true,fixedSizesSumIncrement:n.dragBar?.size}};const G='*,::after,::before{box-sizing:border-box}:host{--ch-drag-bar__size:5px;display:grid;position:relative;block-size:100%;inline-size:100%}:host(.ch-layout-splitter--dragging){pointer-events:all}:host(.ch-layout-splitter--dragging)>.group{pointer-events:none}.bar{--position-fix:calc((var(--size, 0px) - var(--ch-drag-bar__size)) / 2);position:relative;inline-size:100%;block-size:100%;background-color:currentColor;z-index:1}.bar[aria-disabled]{pointer-events:none}.bar:focus-visible{outline:unset}.bar::after{content:"";display:flex;position:absolute;background-color:currentColor;opacity:0;transition:opacity 0s linear}.bar:is(:active,:focus-visible,:hover)::after{opacity:1}.bar:hover::after{transition-delay:250ms}.sticky{position:sticky;z-index:1}.leaf{display:grid}.group{display:grid;position:relative}.direction--columns{grid-template-columns:var(--ch-layout-splitter__distribution)}.direction--columns>.bar{cursor:ew-resize}.direction--columns>.bar::after{block-size:100%;inline-size:var(--ch-drag-bar__size);margin-inline-start:var(--position-fix)}.direction--rows{grid-template-rows:var(--ch-layout-splitter__distribution)}.direction--rows>.bar{cursor:ns-resize}.direction--rows>.bar::after{block-size:var(--ch-drag-bar__size);inline-size:100%;margin-block-start:var(--position-fix)}';const J=G;const Q="--ch-layout-splitter__distribution";const W="inset-block-start";const X="inset-block-end";const Y="inset-inline-start";const Z="inset-inline-end";const tt=t=>`group direction--${t}`;const st=(t,s,e,n)=>({[Q]:S(t,s,t.length-1),[p]:`${e}px`,[W]:n?.blockStart,[X]:n?.blockEnd,[Y]:n?.inlineStart,[Z]:n?.inlineEnd});const et=(t,s)=>`${t[s].id} ${t[s+1].id}`;const nt="ArrowUp";const it="ArrowRight";const ot="ArrowDown";const rt="ArrowLeft";const ct=class{constructor(s){t(this,s);this.dragging=false;this.barAccessibleName="Resize";this.dragBarDisabled=false;this.incrementWithKeyboard=2;this.model={id:"root",direction:"columns",items:[]}}#t;#s;#e;#n;#i;#o=new Map;get el(){return s(this)}modelChanged(t){this.#r(t)}async refreshLayout(){e(this)}async addSiblingLeaf(t,s,n,i,r){const c=q(t,s,n,i,this.#o,r);if(c.success){const s=c.fixedSizesSumIncrement;if(s){const e=this.#o.get(t).parentItem;if(e===o){this.#i+=s}else{this.#o.get(e.id).fixedSizesSum+=s}}e(this)}return c}async removeItem(t){const s=this.#o.get(t).parentItem;const n=K(t,this.#o);if(n.success){const t=n.fixedSizesSumDecrement;if(t!==U){if(s===o){this.#i-=t}else{this.#o.get(s.id).fixedSizesSum-=t}}e(this)}return n}#c=t=>{t.preventDefault();this.#n=z(t,this.#s.direction);this.#s.mouseEvent=t;this.#t.perform(this.#a)};#a=t=>{O(this.#s,this.#o,t??this.#n-this.#e,Q);this.#e=this.#n};#u=()=>{document.removeEventListener("mousemove",this.#c,{capture:true})};#l=()=>{this.dragging=false;if(this.#t){this.#t.cancel()}this.#u();r();c();document.removeEventListener("mouseup",this.#l,{capture:true})};#d=(t,s,e,n)=>{const i=n.target;const o=i.parentElement;this.#s={container:o,containerSize:t==="columns"?o.clientWidth:o.clientHeight,direction:t,dragBar:i,fixedSizesSumRoot:this.#i,itemStartId:e[s].id,itemEndId:e[s+1].id,layoutItems:e,mouseEvent:undefined,RTL:a()}};#f=(t,s,e)=>n=>{this.dragging=true;n.preventDefault();this.#t??=new h;this.#d(t,s,e,n);u(t==="columns"?"ew-resize":"ns-resize");l();const i=z(n,t);this.#e=i;this.#n=i;document.addEventListener("mousemove",this.#c,{capture:true});document.addEventListener("mouseup",this.#l,{capture:true,passive:true})};#h=(t,s,e)=>n=>{if(t==="rows"&&n.code!==nt&&n.code!==ot||t==="columns"&&n.code!==rt&&n.code!==it){return}n.preventDefault();this.#d(t,s,e,n);const i=n.code===it||n.code===ot;this.#a(i?this.incrementWithKeyboard:-this.incrementWithKeyboard)};#m=(t,s,e,i,o)=>{const r=this.#o.get(i.id);const c=!!i.sticky;return[i.items?n("div",{id:i.id,class:{[tt(i.direction)]:true,sticky:c},part:i.id,style:st(i.items,this.#o,r.fixedSizesSum,i.sticky)},this.#p(i.direction,i.items,i.items.length-1)):n("div",{id:i.id,class:{leaf:true,sticky:c},style:c?{[W]:i.sticky?.blockStart,[X]:i.sticky?.blockEnd,[Y]:i.sticky?.inlineStart,[Z]:i.sticky?.inlineEnd}:undefined},n("slot",{key:i.id,name:i.id})),i.dragBar?.hidden!==true&&o!==s&&n("div",{role:"separator","aria-controls":et(e,o),"aria-disabled":this.dragBarDisabled?"true":null,"aria-label":this.barAccessibleName,"aria-orientation":t==="columns"?"vertical":"horizontal","aria-valuetext":r.actualSize,title:this.barAccessibleName,tabindex:"0",class:"bar",part:i.dragBar?.part?`${m.BAR} ${i.dragBar.part}`:m.BAR,style:i.dragBar?.size?{"--size":`${i.dragBar.size}px`}:null,onKeyDown:!this.dragBarDisabled?this.#h(t,o,e):null,onMouseDown:!this.dragBarDisabled?this.#f(t,o,e):null})]};#p=(t,s,e)=>s.map(((n,i)=>this.#m(t,e,s,n,i)));#r=t=>{this.#o.clear();if(t?.items?.length>0){this.#i=P(t,this.#o)}};connectedCallback(){this.#r(this.model)}disconnectedCallback(){this.#l()}render(){const t=this.model;if(t?.items==null){return""}return n(i,{class:this.dragging?"ch-layout-splitter--dragging":undefined},n("div",{class:tt(t.direction),style:st(t.items,this.#o,this.#i)},this.#p(t.direction,t.items,t.items.length-1)))}static get watchers(){return{model:["modelChanged"]}}};ct.style=J;export{ct as ch_layout_splitter};
//# sourceMappingURL=p-7c306beb.entry.js.map