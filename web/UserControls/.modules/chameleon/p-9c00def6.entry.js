import{r as t,g as e,h as i,H as n,c as s,f as a}from"./p-7af91c05.js";import{g as r}from"./p-ebac9feb.js";import{M as o,b as c,a as h,D as d,K as u,f as m}from"./p-9db16727.js";import{u as l,t as p}from"./p-2cf94d81.js";import{a as f,b as g,f as b,g as v,A as k,c as y,d as C,e as x,h as I,W as _}from"./p-2866a291.js";import{f as w}from"./p-d161cf55.js";import"./p-5f934da7.js";const z=(t,e)=>{t[o]={parentItem:e}};const A=t=>t[o];const M=(t,e)=>{for(let i=0;i<t.length;i++){const n=t[i];z(n,e);if(f(n)&&g(n)){M(n.items,n)}}};const O=':where(button,a){all:unset;display:inline-flex;align-items:center;user-select:none;touch-action:manipulation;cursor:pointer}button:disabled{pointer-events:none}*,::after,::before{box-sizing:border-box}:host{display:grid}.expandable-button{justify-content:center;align-self:center}.ch-disabled{pointer-events:none}::slotted([slot=action]){pointer-events:none}ch-popover{--ch-popover-separation-x:var(--ch-action-menu-separation-x);--ch-popover-separation-y:var(--ch-action-menu-separation-y)}ch-popover:not(.hydrated){display:none;opacity:0}.action{text-align:start;--ch-action-menu-item-start-img:var(--ch-start-img--base);--ch-action-menu-item-end-img:var(--ch-end-img--base)}.action.start-img--hover:hover{--ch-action-menu-item-start-img:var(--ch-start-img--hover)}.action.end-img--hover:hover{--ch-action-menu-item-end-img:var(--ch-start-end--hover)}.action.start-img--active:active{--ch-action-menu-item-start-img:var(--ch-start-img--active)}.action.end-img--active:active{--ch-action-menu-item-end-img:var(--ch-start-end--active)}.action.start-img--focus:focus{--ch-action-menu-item-start-img:var(--ch-start-img--focus)}.action.end-img--focus:focus{--ch-action-menu-item-end-img:var(--ch-end-img--focus)}.action.start-img--disabled.ch-disabled{--ch-action-menu-item-start-img:var(--ch-start-img--disabled)}.action.end-img--disabled.ch-disabled{--ch-action-menu-item-end-img:var(--ch-end-img--disabled)}.pseudo-img--start::before,.pseudo-img--end::before{content:"";display:block;inline-size:var(--ch-action-menu-item__image-size);block-size:var(--ch-action-menu-item__image-size);min-inline-size:var(--ch-action-menu-item__image-size)}.start-img-type--background::before{background:no-repeat center/var(--ch-action-menu-item__background-image-size) var(--ch-action-menu-item-start-img)}.end-img-type--background::after{background:no-repeat center/var(--ch-action-menu-item__background-image-size) var(--ch-action-menu-item-end-img)}.start-img-type--mask::before{-webkit-mask:no-repeat center/var(--ch-action-menu-item__background-image-size) var(--ch-action-menu-item-start-img);background-color:currentColor}.end-img-type--mask::after{-webkit-mask:no-repeat center/var(--ch-action-menu-item__background-image-size) var(--ch-action-menu-item-end-img);background-color:currentColor}.content{inline-size:100%}';const $=O;const j=/\s+/;const S=(t,e)=>({base:e==="start"?t.startImgSrc:t.endImgSrc});const T=`${c.ACTION} ${c.LINK}`;const E=`${T} ${c.EXPANDABLE}`;const D=`${c.ACTION} ${c.BUTTON}`;const P=`${D} ${c.EXPANDABLE}`;const R="window";let K;const B=class{constructor(e){t(this,e);this.actionGroupParent=false;this.blockAlign="center";this.caption=undefined;this.disabled=false;this.endImgSrc=undefined;this.endImgType="background";this.expandable=false;this.expanded=false;this.getImagePathCallback=undefined;this.inlineAlign="center";this.link=undefined;this.model=undefined;this.openOnFocus=false;this.parts=undefined;this.positionTry=undefined;this.shortcut=undefined;this.startImgSrc=undefined;this.startImgType="background"}#t;#e;#i;get el(){return e(this)}endImgSrcChanged(){this.#e=this.#n("end")}getImagePathCallbackChanged(){this.#t=this.#n("start");this.#e=this.#n("end")}partsChanged(t){this.#s(t)}startImgSrcChanged(){this.#t=this.#n("start")}#n=t=>{if(t==="start"&&!this.startImgSrc||t==="end"&&!this.endImgSrc){return undefined}const e=this.getImagePathCallback??K;if(!e){return undefined}const i=e(this.model,t);return i?l(i,t):undefined};#a=()=>[i("span",{class:"content",part:c.CONTENT},this.caption),!!this.shortcut&&i("span",{"aria-hidden":"true",part:c.SHORTCUT},this.shortcut)];#r=()=>{const t=this.#t?.classes;const e=this.#e?.classes;const n={action:true,[d]:this.disabled,[`start-img-type--${this.startImgType??"background"} pseudo-img--start`]:!!this.#t,[t]:!!t,[`end-img-type--${this.endImgType??"background"} pseudo-img--end`]:!!this.#e,[e]:!!e};const s=this.expandable;return this.link?i("a",{role:this.disabled?"link":undefined,"aria-controls":s?R:null,"aria-disabled":this.disabled?"true":undefined,"aria-expanded":s?(!!this.expanded).toString():null,"aria-haspopup":s?"true":null,class:n,style:this.#e?.styles??undefined,part:p({[E]:s,[T]:!s,[c.DISABLED]:this.disabled,[c.EXPANDED]:s&&this.expanded,[c.COLLAPSED]:s&&!this.expanded}),href:!this.disabled?this.link.url:undefined,rel:!this.disabled?this.link.rel:undefined,target:!this.disabled?this.link.target:undefined,ref:t=>this.#i=t},this.#a()):i("button",{popoverTarget:R,"aria-controls":s?R:null,"aria-expanded":s?(!!this.expanded).toString():null,"aria-haspopup":s?"true":null,class:n,part:p({[P]:s,[D]:!s,[c.DISABLED]:this.disabled,[c.EXPANDED]:s&&this.expanded,[c.COLLAPSED]:s&&!this.expanded}),style:this.#e?.styles??undefined,disabled:this.disabled,type:"button",ref:t=>this.#i=t},this.#a())};#o=()=>i("ch-popover",{role:"list",id:R,part:c.WINDOW,actionById:true,actionElement:this.#i,blockAlign:this.blockAlign,firstLayer:this.actionGroupParent,inlineAlign:this.inlineAlign,popover:"manual",positionTry:this.positionTry,show:true},i("slot",null));#s=t=>{const e=t?`${h},${t.split(j).join(",")}`:h;this.el.setAttribute("exportparts",e)};connectedCallback(){this.el.setAttribute("role","listitem");this.#s(this.parts);K??=r("getImagePathCallback","ch-action-menu-render")??S;this.#t=this.#n("start");this.#e=this.#n("end")}componentDidRender(){const t=A(this.model);if(this.expanded&&t.focusFirstItemAfterExpand){t.focusFirstItemAfterExpand=false;requestAnimationFrame((()=>b(this.el)))}if(!this.expanded&&t.focusAfterCollapse){t.focusAfterCollapse=false;this.el.focus()}}render(){return i(n,{key:"bcd3c1ad46dfd2c7e0a1626f2a21e57385d5b6ae",style:this.#t?.styles??undefined},this.#r(),this.expandable&&this.expanded&&this.#o())}static get delegatesFocus(){return true}static get watchers(){return{endImgSrc:["endImgSrcChanged"],getImagePathCallback:["getImagePathCallbackChanged"],parts:["partsChanged"],startImgSrc:["startImgSrcChanged"]}}};B.style=$;const F={[u.ARROW_UP]:(t,e)=>{const i=v(t);if(i===undefined){return}t.preventDefault();return i===k?y(e):C(i,"previous")},[u.ARROW_DOWN]:(t,e)=>{const i=v(t);if(i===undefined){return}t.preventDefault();return i===k?b(e):C(i,"next")},[u.ARROW_RIGHT]:t=>{const e=v(t);if(e===undefined||e===k||!g(e.model)){return}t.preventDefault();if(e.model.expanded){return b(e.ref)}A(e.model).focusFirstItemAfterExpand=true;return{newExpanded:true,model:e.model}},[u.ARROW_LEFT]:t=>{const e=v(t);if(e===undefined||e===k){return undefined}const i=A(e.model);if(!i.parentItem){return undefined}t.preventDefault();A(i.parentItem).focusAfterCollapse=true;return{newExpanded:false,model:i.parentItem}},[u.HOME]:(t,e)=>{const i=v(t);if(i===undefined){return}if(i===k){t.preventDefault();return b(e)}if(x(i.ref)){t.preventDefault();return b(i.ref.parentElement)}},[u.END]:(t,e)=>{const i=v(t);if(i===undefined){return}if(i===k){t.preventDefault();return y(e)}if(x(i.ref)){t.preventDefault();return y(i.ref.parentElement)}}};const L=t=>{for(let e=0;e<t.length;e++){const i=t[e];if(f(i)&&i.expanded){i.expanded=false;if(i.items?.length>0){L(i.items)}}}};const q=t=>{t.expanded=false;if(t.items?.length>0){L(t.items)}};const H=t=>{let e=t;while(e!==undefined){e.expanded=true;e=A(e).parentItem}};const W=":where(button,a){all:unset;display:inline-flex;align-items:center;user-select:none;touch-action:manipulation;cursor:pointer}button:disabled{pointer-events:none}*,::after,::before{box-sizing:border-box}:host{--ch-action-menu-item__image-size:0.875em;--ch-action-menu-item__background-image-size:100%;--ch-action-menu-separation:0px;--ch-action-menu-separation-x:var(--ch-action-menu-separation);--ch-action-menu-separation-y:var(--ch-action-menu-separation);display:contents}::slotted(action){pointer-events:none}hr{display:grid;block-size:1px;margin:0;background-color:color-mix(in srgb, currentColor 25%, transparent);border:unset;pointer-events:none}";const G=W;const J=class{constructor(e){t(this,e);this.buttonClick=s(this,"buttonClick",7);this.expandedChange=s(this,"expandedChange",7);this.expandedItemChange=s(this,"expandedItemChange",7);this.hyperlinkClick=s(this,"hyperlinkClick",7);this.buttonAccessibleName=undefined;this.blockAlign="outside-end";this.disabled=false;this.getImagePathCallback=undefined;this.expanded=false;this.gxImageConstructor=undefined;this.gxSettings=undefined;this.inlineAlign="center";this.model=undefined;this.positionTry="none";this.useGxRender=false}#c;#h;get el(){return e(this)}expandedChanged(){if(this.expanded){this.#d()}else{this.#u()}}modelChanged(){this.#m()}buttonClick;expandedChange;expandedItemChange;hyperlinkClick;#l=t=>{const e=g(t);return i("ch-action-menu",{blockAlign:t.itemsBlockAlign??"inside-start",caption:t.caption,disabled:t.disabled??this.disabled,endImgSrc:this.useGxRender?w(t.endImgSrc,this.gxSettings,this.gxImageConstructor):t.endImgSrc,endImgType:t.endImgType,expandable:e,expanded:t.expanded,getImagePathCallback:this.getImagePathCallback,inlineAlign:t.itemsBlockAlign??"outside-end",link:t.link,model:t,parts:t.parts,positionTry:t.positionTry??this.positionTry,shortcut:t.shortcut,startImgSrc:this.useGxRender?w(t.startImgSrc,this.gxSettings,this.gxImageConstructor):t.startImgSrc,startImgType:t.startImgType},e&&t.expanded&&this.#p(t.items))};#f={separator:t=>i("hr",{key:t.id,part:p({[t.id]:!!t.id,[c.SEPARATOR]:true,[t.parts]:!!t.parts})}),slot:t=>i("slot",{name:t.id})};#p=t=>t.map((t=>f(t)?this.#l(t):this.#f[t.type](t)));#g=(t,e)=>{const i=v(t);if(i===undefined){return}if(i===k){if(e==="click"){return this.expanded?this.#b():this.#v()}return}const n=i.model;if(e==="click"){if(I(n)){const e=this.hyperlinkClick.emit({item:n,event:t});if(e.defaultPrevented){t.preventDefault()}this.#b();return}if(!g(n)){const e=this.buttonClick.emit(n);if(e.defaultPrevented){t.preventDefault();return}this.#b();return}}if(e==="mouseout"){q(n)}else{L(this.model);H(n);const t=e==="mouseover"||n.expanded;if(n.expanded!==t){n.expanded=t;this.expandedItemChange.emit({item:n,expanded:t})}}a(this)};#k=t=>this.#g(t,"click");#y=t=>this.#g(t,"mouseover");#C=t=>this.#g(t,"mouseout");#x=t=>{if(!this.expanded&&(t.code===u.ARROW_UP||t.code===u.ARROW_DOWN)){this.expanded=true;this.expandedChange.emit(true);return}const e=F[t.code];if(e){const i=e(t,this.#h);if(!i){return}if(i.newExpanded){L(this.model);H(i.model)}else{q(i.model)}this.expandedItemChange.emit({item:i.model,expanded:i.newExpanded});a(this)}};#I=t=>{const e=t.composedPath();if(!e.includes(this.el)){this.#b()}};#_=t=>{if(t.code===u.ESCAPE){this.#c.focus();this.#b()}};#v=()=>{this.expanded=true;this.expandedChange.emit(true)};#b=()=>{L(this.model);this.expanded=false;this.expandedChange.emit(false)};#d=()=>{document.addEventListener("click",this.#I,{capture:true,passive:true});document.addEventListener("keydown",this.#_,{capture:true,passive:true})};#u=()=>{document.removeEventListener("click",this.#I,true);document.removeEventListener("keydown",this.#_,true)};#m=()=>{if(this.model){M(this.model,undefined)}};connectedCallback(){this.#m();if(this.expanded){this.#d()}}disconnectedCallback(){this.#u()}render(){const t=!(this.disabled&&!this.expanded);return i(n,{key:"66cf034b0b2698c52fce03d2026f07283ebb7b55",onClick:t&&this.#k,onKeyDown:t&&this.#x},i("button",{key:"497b3c98f5868246b758959c7113ccb83f182582","aria-controls":_,"aria-expanded":this.expanded.toString(),"aria-haspopup":"true","aria-label":this.buttonAccessibleName,part:p({[m.EXPANDABLE_BUTTON]:true,[c.EXPANDED]:this.expanded,[c.COLLAPSED]:!this.expanded,[c.DISABLED]:this.disabled}),disabled:this.disabled,popoverTarget:_,type:"button",ref:t=>this.#c=t},i("slot",{key:"4e114f81b55b2dbc7e887313b0520eb7093ccab5"})),this.expanded&&this.model&&i("ch-popover",{key:"95b06265de6ce9bb5bb3791dd9ec171a3e3c05c4",role:"list",id:_,part:c.WINDOW,actionById:true,actionElement:this.#c,blockAlign:this.blockAlign,firstLayer:true,inlineAlign:this.inlineAlign,popover:"manual",positionTry:this.positionTry,show:true,onMouseOver:this.#y,onMouseOut:this.#C,ref:t=>this.#h=t},this.model!==undefined&&this.#p(this.model)))}static get watchers(){return{expanded:["expandedChanged"],model:["modelChanged"]}}};J.style=G;export{B as ch_action_menu,J as ch_action_menu_render};
//# sourceMappingURL=p-9c00def6.entry.js.map