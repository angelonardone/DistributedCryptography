import{h as t,r as n,g as e,H as s}from"./p-7af91c05.js";import{b as a,a as c,r,o}from"./p-1648189c.js";const l=new Map;const i=new Map;const u=t=>{const n=l.get(t);if(n!==undefined){return n}const e=i.get(t);if(e!==undefined){return e.promise}let s;const a=new Promise((t=>{s=t}));i.set(t,{promise:a,resolver:s});return a};const d=(t,n)=>{l.set(t,n);const e=i.get(t);if(e!==undefined){e.resolver(n)}};const f=()=>{l.clear();i.clear()};const h=/\{#(.*?)\}/;const m="last-nested-child";let w;let p;let g;const y=t=>t===g?m:undefined;const b={1:(n,e,s)=>t("h1",{class:e,id:s},n),2:(n,e,s)=>t("h2",{class:e,id:s},n),3:(n,e,s)=>t("h3",{class:e,id:s},n),4:(n,e,s)=>t("h4",{class:e,id:s},n),5:(n,e,s)=>t("h5",{class:e,id:s},n),6:(n,e,s)=>t("h6",{class:e,id:s},n)};const k={left:"ch-markdown-table-column-start",center:"ch-markdown-table-column-center",right:"ch-markdown-table-column-end"};const x=async(n,e)=>{const s=n.children[0];const a=n.children.slice(1);const c=s.children.length;const r=s.children.map((t=>_(t,e)));const o=[];a.forEach((t=>{t.children.forEach((t=>{o.push(_(t,e))}))}));const l=await Promise.allSettled(r);const i=await Promise.allSettled(o);const u=l.map((t=>t.value));const d=i.map((t=>t.value));const f=n.align.map((t=>k[t]));return t("table",null,t("thead",null,t("tr",null,s.children.map(((n,e)=>t("th",{class:{[f[e]]:!!f[e],[m]:n===g}},u[e]))))),t("tbody",null,a.map(((n,e)=>t("tr",null,n.children.map(((n,s)=>t("td",{class:{[f[s]]:!!f[s],[m]:n===g}},d[c*e+s]))))))))};const j={blockquote:async(n,e)=>{const s=await _(n,e);return t("blockquote",{class:y(n)},s)},break:()=>t("br",null),code:async(t,n)=>{w||=(await Promise.resolve().then((function(){return I}))).parseCodeToJSX;const e=await w(t.value,t.lang,n.renderCode,t===g);return e},definition:t=>d(t.identifier,t.url),delete:async(n,e)=>{const s=await _(n,e);return t("del",{class:y(n)},s)},emphasis:async(n,e)=>{const s=await _(n,e);return t("em",{class:y(n)},s)},footnoteDefinition:()=>"",footnoteReference:()=>"",heading:async(t,n)=>{const e=t.children.at(-1);let s;if(e?.type==="text"){const t=e.value.match(h);if(t&&t.length>1){s=t[1];e.value=e.value.replace(`{#${s}}`,"")}}const a=await _(t,n);const c=y(t);return b[t.depth](a,c,s)},html:async(t,n)=>{if(n.rawHTML&&!p){p=(await import("./p-e95cbc34.js")).rawHTMLToJSX}return n.rawHTML?p(t.value,n.allowDangerousHtml):t.value},image:n=>t("img",{src:n.url,alt:n.alt,title:n.title,loading:"lazy"}),imageReference:()=>"",inlineCode:n=>t("code",{class:"hljs"},n.value),link:async(n,e)=>{if(n.url.includes("javascript:")){return}const s=await _(n,e);return t("a",{"aria-label":n.title||null,title:n.title||null,class:y(n),href:n.url},s)},linkReference:async(n,e)=>{const s=await _(n,e);let a="";if(n.referenceType==="shortcut"){a=await u(n.identifier)}if(a.includes("javascript:")){return}return t("a",{"aria-label":n.label||null,class:y(n),href:a},s)},list:async(n,e)=>{const s=await _(n,e);return n.ordered?t("ol",{class:y(n),start:n.start},s):t("ul",{class:y(n)},s)},listItem:async(n,e)=>{const s=await _(n,e);return t("li",{class:y(n)},s)},paragraph:async(n,e)=>{const s=await _(n,e);return t("p",{class:y(n)},s)},strong:async(n,e)=>{const s=await _(n,e);return t("strong",{class:y(n)},s)},table:x,text:t=>t.value,thematicBreak:()=>t("hr",null),yaml:()=>""};const C=t=>{const n=t.children.at(-1);if(n.children?.length>0){return C(n)}if(n.type==="code"){return n}return t};async function _(t,n){const e=t.children.length;const s=new Array(e);for(let a=0;a<e;a++){const e=t.children[a];s.push(j[e.type](e,n))}const a=await Promise.allSettled(s);return a.map((t=>t.value))}const P=async(t,n)=>{const e=a(t);g=C(e);const s=await _(e,n);f();return s};let R;const T=t=>t===R?m:undefined;const v={element:n=>{const e=n.properties.className;const s=T(n);const a=e?e.join(" "):undefined;return t("span",{class:{[a]:!!a,[s]:!!s}},H(n))},text:t=>t.value};function H(t){return t.children.map((t=>v[t.type](t)))}const M=t=>{const n=t.children.at(-1);if(n.children?.length>0){return M(n)}return t};const q=async(t,n,e,s)=>{const a=o(n||"plaintext");await c(a);const l=r(a,t);R=undefined;if(s){R=M(l)}const i=s&&l===R;return e({language:n||"plaintext",nestedChildIsCodeTag:i,plainText:t,renderedContent:l.children.map((t=>v[t.type](t)))})};const D=n=>t("pre",null,t("code",{class:{[`hljs language-${n.language}`]:true,[m]:n.nestedChildIsCodeTag}},t("div",{class:"code-block__content"},n.renderedContent)));const I=Object.freeze({__proto__:null,parseCodeToJSX:q,defaultCodeRender:D});const J="ch-markdown{display:grid;grid-auto-rows:max-content}.ch-markdown-table-column-start{text-align:start}.ch-markdown-table-column-center{text-align:center}.ch-markdown-table-column-end{text-align:end}";const S=J;const X=class{constructor(t){n(this,t);this.rawHtml=false;this.renderCode=D;this.value=undefined}#t;get el(){return e(this)}async componentWillRender(){if(!this.value){return}this.#t=await P(this.value,{rawHTML:this.rawHtml,allowDangerousHtml:true,renderCode:this.renderCode})}render(){if(!this.value){return""}return t(s,null,this.#t)}};X.style=S;export{X as ch_markdown};
//# sourceMappingURL=p-6fbd4e7e.entry.js.map