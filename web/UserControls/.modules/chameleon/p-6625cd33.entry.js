import{r as t,h as e,H as i,c as n,g as s}from"./p-7af91c05.js";import{K as a}from"./p-9db16727.js";const o='ch-next-data-modeling{--delete-icon:url(\'data:image/svg+xml,<svg width="14" height="16" viewBox="0 0 14 16" xmlns="http://www.w3.org/2000/svg"><path d="M1.87729 4.55154H12.1585V14.3936C12.1613 14.8186 11.9944 15.2273 11.6949 15.5288C11.3953 15.8304 10.9878 16 10.5627 16H3.47304C3.04797 16 2.64046 15.8304 2.34089 15.5288C2.04133 15.2273 1.87447 14.8186 1.87729 14.3936V4.55154ZM10.5734 1.42436V1.25301C10.5676 0.559264 10.0035 0 9.30972 0H4.72605C4.03228 0 3.46821 0.559264 3.46233 1.25301V1.42436H0.078125V3.03079H14.0005V1.42436H10.5734Z" fill="%23000"/></svg>\');--edit-icon:url(\'data:image/svg+xml,<svg width="17" height="16" viewBox="0 0 17 16" xmlns="http://www.w3.org/2000/svg"><path d="M14.4291 5.4137L10.8838 1.73151L12.0517 0.50411C12.3715 0.168037 12.7644 0 13.2304 0C13.6964 0 14.089 0.168037 14.4082 0.50411L15.5761 1.73151C15.8958 2.06758 16.0627 2.47321 16.0766 2.94838C16.0905 3.42356 15.9376 3.82889 15.6178 4.16438L14.4291 5.4137ZM13.2195 6.70685L4.37728 16H0.832031V12.274L9.67429 2.98082L13.2195 6.70685Z" fill="%23000"/></svg>\');display:grid;grid-template-columns:1fr;grid-auto-rows:min-content;flex:1;height:100%}';const r=o;const d=class{constructor(e){t(this,e)}render(){return e(i,{key:"2c358083893537c78c30e9c837c4feeb19b9a1a9",role:"list"},e("slot",{key:"1d51cea9e3f9a773d159b1c30c0e4a76bcb84bfa"}))}};d.style=r;const l=':where(button){all:unset;display:inline-flex;cursor:pointer}*,::before,::after{box-sizing:border-box}.error-text,.name{color:inherit;font:inherit;margin:0;padding:0;outline:0}gx-edit:is(.gx-edit--auto-fill,.gx-edit--auto-fill:focus-within,.gx-edit--auto-fill:hover){background-color:var(--gx-edit-auto-fill-background-color)}:host{display:grid;--chevron-color:#ccc}:host(:not(.gx-disabled):hover) .button-primary,:host(:not(.gx-disabled):focus-within) .button-primary{display:grid}:host(:not(.gx-disabled):hover) .button-primary::before,:host(:not(.gx-disabled):focus-within) .button-primary::before{content:""}:host(.gx-disabled){pointer-events:none}:host(.gx-disabled) .accordion{pointer-events:all}.add-new-field--level-0{display:grid;grid-template:"name . . ." min-content "field-name type confirm cancel" 1fr "error-text . confirm cancel" min-content "sub-item sub-item confirm cancel" min-content/1fr min-content 56px 32px;row-gap:8px}.add-new-field--level-0 ::slotted(ch-next-data-modeling){grid-area:sub-item}.add-new-field--level-1{display:grid;grid-template:"name . . ." min-content "field-name type confirm cancel" 1fr "error-text . . ." min-content/1fr min-content 56px 32px;row-gap:8px}.add-new-field--level-2{display:grid;grid-template:"sub-field name . . ." min-content ". field-name type confirm cancel" 1fr ". error-text . . ." min-content/min-content 1fr min-content 56px 32px;row-gap:4px}.add-new-field--no-actions{grid-template:"sub-field name ." min-content ". field-name type" 1fr ". error-text ." min-content/min-content 1fr min-content}.accordion:hover .edit-button,.accordion:hover .delete-button,.accordion:focus-within .edit-button,.accordion:focus-within .delete-button{display:grid}.sub-field{grid-area:sub-field}.field-name{grid-area:field-name;margin-inline-end:8px}.button-confirm{grid-area:confirm;margin-inline:16px 8px}.button-cancel{grid-area:cancel}.error-text{grid-area:error-text;display:flex;white-space:break-spaces}.header{display:grid;grid-template:"sub-field name type edit delete" 1fr/min-content max-content 1fr min-content max-content;align-items:center;width:100%;margin-inline-end:12px}.accordion::part(accordion__header){column-gap:24px}.edit-mode{grid-template:"sub-field field-name type confirm cancel" min-content "sub-field error-text error-text confirm cancel" min-content/min-content 1fr min-content 56px 32px}.name{grid-area:name}.name-entity{text-decoration:underline}.type{grid-area:type}.select-wrapper{--chevron:url(\'data:image/svg+xml,<svg width="12" height="8" viewBox="0 0 12 8" xmlns="http://www.w3.org/2000/svg"><path d="M1.41 0L6 4.59L10.59 0L12 1.42L6 7.42L0 1.42L1.41 0Z"/></svg>\');grid-area:type;position:relative}.select-wrapper::after{content:"";display:flex;position:absolute;inset-inline-end:0;inset-block-start:calc(50% - 3.75px);width:12px;height:7.5px;margin-inline:8px 16px;-webkit-mask:var(--chevron) no-repeat;background-color:var(--chevron-color);pointer-events:none}.select{display:flex;height:100%;appearance:none;background-color:unset;cursor:pointer;outline:unset;transition-property:background-color, border-color, color;transition-duration:250ms}.button-new-entity{align-items:center;transition:color 250ms}.optimization{display:contents}.button-primary{display:none;align-self:center;height:20px;padding:2px}.button-primary::before{display:flex}.button-edit{grid-area:edit;width:21px}.button-edit::before{-webkit-mask:var(--edit-icon) no-repeat}.button-delete{grid-area:delete;width:18px;margin-inline-start:12px}.button-delete::before{-webkit-mask:var(--delete-icon) no-repeat}.delete-mode,.waiting-mode{grid-area:delete;display:grid;grid-template-columns:1fr 24px 24px;align-items:center;column-gap:8px;cursor:auto;animation:fade-in 250ms ease-in-out}.waiting-mode{grid-template-columns:24px 1fr}.waiting-mode__loading{order:-1;width:100%;fill:none;animation:rotate 1.5s linear 0.125s infinite}circle{stroke:currentColor;stroke-dasharray:1, 200;stroke-linecap:round;animation:indeterminate-loading 1.25s ease-in-out 0.125s infinite}@keyframes fade-in{0%{opacity:0}}@keyframes rotate{100%{transform:rotate(1turn)}}@keyframes indeterminate-loading{50%,60%{stroke-dasharray:20, 200;stroke-dashoffset:-8px}100%{stroke-dashoffset:-24px}}';const h=l;const c="name";const p="dm-item__";const m="button-cancel";const u="button-confirm";const f=t=>`${p}button-action confirm${t}`;const g=t=>`${p}button-action cancel${t}`;const b=`${p}select-option`;const x=class{constructor(e){t(this,e);this.deleteField=n(this,"deleteField",7);this.editField=n(this,"editField",7);this.newEntity=n(this,"newEntity",7);this.firstNewField=n(this,"firstNewField",7);this.firstNewFieldErrors=n(this,"firstNewFieldErrors",7);this.newField=n(this,"newField",7);this.expanded=false;this.errorType="None";this.waitingMode="none";this.actionsVisible=true;this.captions=undefined;this.dataType="";this.disabled=false;this.entityNameToATTs={};this.errorTexts=undefined;this.fieldNames=[];this.level=1;this.maxAtts=3;this.mode="normal";this.name="";this.readonly=false;this.showNewFieldBtn=true;this.type="LEVEL"}actions=(t,e)=>({add:[{label:t.confirm,class:u,part:f(e),event:this.confirmAction("new")},{label:t.cancel,class:m,part:g(e),event:this.toggleShowNewField}],delete:[{label:t.confirm,class:undefined,part:`${p}button-delete-action confirm${e}`,event:this.emitDelete},{label:t.cancel,class:undefined,part:`${p}button-delete-action cancel${e}`,event:this.toggleMode("delete")}],edit:[{label:t.confirm,class:u,part:f(e),event:this.confirmAction("edit")},{label:t.cancel,class:m,part:g(e),event:this.toggleMode("edit")}],normal:[{label:t.edit,class:"button-primary button-edit",part:`${p}button-primary edit${e}`,event:this.toggleMode("edit")},{label:t.delete,class:"button-primary button-delete",part:`${p}button-primary delete${e}`,event:this.toggleMode("delete")}]});errorName;lastEditInfo={name:"",type:"ATT"};focusInputInNextRender=false;inputName;inputType;get el(){return s(this)}deleteField;editField;newEntity;firstNewField;firstNewFieldErrors;newField;handleExpandedChange(t){t.stopPropagation()}handleFirstNewField(t){if(this.level!==0){return}this.confirmAction("new","no",t.detail)(t)}handleFirstNewFieldErrors(t){this.confirmAction("new","yes")(t)}async setAddingMode(){this.clearInput();this.waitingMode="adding"}async clearInput(){if(this.inputName){const t=this.inputName.shadowRoot.firstElementChild;t.value=""}this.errorType="None"}async checkErrors(t,e){this.confirmAction("new",t)(e)}async delete(t){this.emitDelete(t)}async hideWaitingMode(){if(this.mode==="add"&&this.level===0){const t=this.el.firstElementChild.firstElementChild;t.hideWaitingMode()}else if(this.mode!=="add"){this.mode="normal"}this.waitingMode="none"}makeAttsPrettier=(t,e)=>t.length<=e?"("+t.join(", ")+")":`(${t.slice(0,e).join(", ")} (+${t.length-e}))`;emitDelete=t=>{if(this.level!==0&&this.fieldNames.length===1){const e=this.el.parentElement.parentElement;e.delete(t);this.mode="normal";return}t.stopPropagation();this.waitingMode="deleting";this.deleteField.emit()};toggleMode=t=>e=>{e.stopPropagation();this.mode=this.mode==="normal"?t:"normal";this.focusInputInNextRender=t==="edit"};toggleShowNewField=t=>{t.stopPropagation();this.errorType="None";const e=!this.showNewFieldBtn;this.showNewFieldBtn=e;this.focusInputInNextRender=!e;if(!e&&this.level===0){const t=this.el.firstElementChild.firstElementChild;t.clearInput()}};getGxEditInputValue=t=>t.shadowRoot.firstElementChild.value;handleKeyDown=t=>e=>{if(e.code!==a.ENTER){return}e.preventDefault();this.confirmAction(t)(e)};checkChildErrors=(t,e)=>{this.el.firstElementChild.firstElementChild.checkErrors(t,e)};validateErrorsWhenAddingEntity=(t,e="unknown",i)=>{if(this.level===0&&t==="new"&&e==="unknown"){this.checkChildErrors(e,i)}else if(!this.actionsVisible&&e==="unknown"){this.firstNewFieldErrors.emit()}};confirmAction=(t,e="unknown",i=null)=>n=>{n.stopPropagation();const s=this.getGxEditInputValue(this.inputName).trim();this.errorType="None";if(s===""){this.errorType="Empty";this.validateErrorsWhenAddingEntity(t,e,n);return}if(this.name!==s&&this.fieldNames.includes(s)){this.errorType="AlreadyDefined";this.errorName=s;this.validateErrorsWhenAddingEntity(t,e,n);return}if(t==="new"){this.lastEditInfo={name:s,type:this.level===0?"ATT":this.inputType.value};if(this.level===0){if(e==="unknown"){this.checkChildErrors(e,n)}else if(e==="no"){this.waitingMode="adding";this.expanded=true;this.newEntity.emit({name:s,level:[i]});this.toggleShowNewField(n);this.el.firstElementChild.firstElementChild.setAddingMode()}}else if(this.actionsVisible){this.waitingMode="adding";this.newField.emit(this.lastEditInfo);this.toggleShowNewField(n)}else{this.firstNewField.emit(this.lastEditInfo)}return}if(this.name!==s||this.level!==0&&this.type!==this.inputType.value){this.waitingMode="editing";this.lastEditInfo={name:s,type:this.level===0?"ATT":this.inputType.value};this.editField.emit(this.lastEditInfo)}this.toggleMode("edit")(n)};loading=()=>e("svg",{class:"waiting-mode__loading",height:"28",viewBox:"6 6 12 12"},e("circle",{cx:"12",cy:"12",r:"4","stroke-width":"1.125"}));errorText=t=>e("p",{class:"error-text",part:`${p}error-text`},this.errorType==="Empty"?t.Empty:[this.level===0?t.AlreadyDefinedEntity1:t.AlreadyDefined1,e("span",{part:`${p}error-text-name`},this.errorName),t.AlreadyDefined2]);readonlyContent=(t,i,n)=>[e("h1",{id:c,class:{name:true,"name-entity":n==="ENTITY"},part:`${p}name`},i),this.level!==0&&n!=="ATT"&&e("span",{class:"type",part:n==="LEVEL"?`${p}collection`:`${p}entity`},n==="LEVEL"?t.collection:this.makeAttsPrettier(this.entityNameToATTs[this.dataType]||[],this.maxAtts))];editableContent=(t,i,n,s)=>[e("gx-edit",{class:"field-name",part:`${p}input${s}${n}`,disabled:this.disabled,type:"text",value:this.name,ref:t=>this.inputName=t,onKeydown:this.handleKeyDown(t)}),this.level!==0&&e("div",{class:"select-wrapper"},e("select",{class:"select",part:`${p}input${n} select`,disabled:this.disabled,ref:t=>this.inputType=t},e("option",{part:b,value:"ATT",selected:this.type==="ATT"},i.ATT),e("option",{part:b,value:"ENTITY",selected:this.type==="ENTITY"},i.ENTITY),e("option",{part:b,value:"LEVEL",selected:this.type==="LEVEL"},i.LEVEL))),this.errorType!=="None"&&this.errorText(this.errorTexts)];newFieldMode=(t,i,n,s)=>this.showNewFieldBtn?e("button",{class:"button-new-entity",part:`${p}button-new-entity${n}`,disabled:this.disabled,type:"button",onClick:this.toggleShowNewField},this.level===0?t.addNewEntity:t.addNewField):e("div",{slot:this.level===0?"header":undefined,class:{[`add-new-field--level-${this.level}`]:true,"add-new-field--no-actions":!this.actionsVisible},part:`${p}header-content`,tabindex:this.level!==0&&this.actionsVisible?"0":undefined},this.level===2&&e("div",{"aria-hidden":"true",class:"sub-field",part:`${p}sub-field`}),e("h1",{class:"name",part:`${p}name`},this.level===0?t.newEntity:t.newField),this.editableContent("new",t,n,i),this.level===0&&e("slot",null),this.actionsVisible&&[e("button",{"aria-label":s[0].label,class:s[0].class,part:s[0].part,disabled:this.disabled,type:"button",onClick:s[0].event}),e("button",{"aria-label":s[1].label,class:s[1].class,part:s[1].part,disabled:this.disabled,type:"button",onClick:s[1].event})]);normalMode=(t,i,n,s,a,o)=>[e("div",{slot:this.level===0?"header":undefined,class:{header:true,"edit-mode":this.mode==="edit"},part:`${p}header-content ${this.level!==0?this.type.toLowerCase():""}`,tabindex:this.level!==0?"0":undefined},this.level===2&&e("div",{"aria-hidden":"true",class:"sub-field",part:`${p}sub-field`}),this.mode==="edit"?this.editableContent("edit",t,n,i):this.readonlyContent(t,o?this.lastEditInfo.name:this.name,o?this.lastEditInfo.type:this.type),!this.readonly&&this.actionsVisible&&e("div",{class:{"delete-mode":this.mode==="delete",optimization:this.mode!=="delete","waiting-mode":this.waitingMode!=="none"},part:`${p}delete-mode${s}`},this.waitingMode==="none"?[this.mode==="delete"&&t.deleteMode,e("button",{"aria-label":a[0].label,class:a[0].class,part:a[0].part,disabled:this.disabled,type:"button",onClick:a[0].event}),e("button",{"aria-label":a[1].label,class:a[1].class,part:a[1].part,disabled:this.disabled,type:"button",onClick:a[1].event})]:[t[this.waitingMode],this.loading()])),this.type==="LEVEL"&&(this.level===0?e("div",{slot:"content",part:`${p}content`},e("slot",null)):e("slot",null))];componentDidUpdate(){if(this.focusInputInNextRender&&this.inputName){this.focusInputInNextRender=false;requestAnimationFrame((()=>{this.inputName.click()}))}}render(){const t=this.disabled?" disabled":"";const n=this.waitingMode==="none"?"":` ${p}waiting-mode`;const s=this.errorType!=="None"?" error":"";const a=this.captions;const o=this.actions(a,t)[this.mode];const r=this.waitingMode==="editing"||this.waitingMode==="adding";return e(i,{key:"ecfcf04388164be7959985980174c16095b55411",role:"listitem","aria-labelledby":c,class:{"gx-disabled":this.disabled}},this.mode==="add"&&this.waitingMode!=="adding"?this.newFieldMode(a,s,t,o):this.level===0?e("ch-accordion",{class:"accordion",part:`${p}accordion`,accessibleName:this.name,expanded:this.expanded,exportparts:`accordion__chevron:${p}chevron,accordion__expandable:${p}expandable,accordion__header:${p}header`},this.normalMode(a,s,t,n,o,r)):this.normalMode(a,s,t,n,o,r))}};x.style=h;export{d as ch_next_data_modeling,x as ch_next_data_modeling_item};
//# sourceMappingURL=p-6625cd33.entry.js.map