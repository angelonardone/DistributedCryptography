import{r as e,c as t,g as i,h as s,H as o}from"./p-7af91c05.js";import{K as n,S as r}from"./p-9db16727.js";import{S as h}from"./p-2a2bca47.js";import{a as c}from"./p-a859514b.js";import{s as a,a as l,b as d,f as p}from"./p-2cf94d81.js";import"./p-e7a788ef.js";const v=e=>{const t=[document];let i=e;while(i){if(i instanceof Element&&i.assignedSlot){i=i.assignedSlot;continue}const e=i.parentNode;if(e){i=e}else if(i instanceof ShadowRoot){t.push(i);i=i.host}else{break}}return t};const u="--ch-popover-separation-x";const b="--ch-popover-separation-y";const f={"outside-start":"outside-end","outside-end":"outside-start","inside-start":"inside-end","inside-end":"inside-start"};const g=(e,t,i,s)=>({start:t-(i+e+s),end:e+s});const k=e=>e.start<0||e.end<0;const m={"outside-start":(e,t,i)=>-t-i,"inside-start":(e,t,i)=>i,center:(e,t,i)=>e*.5+i-t*.5,"inside-end":(e,t,i)=>e-(i+t),"outside-end":(e,t,i)=>e+i};const z=e=>Number(e.replace("px","").trim());const _=(e,t,i,s,o,n,r)=>{const h=m[e](i,s,n);const c=g(t,o,s,h);const a=Math.min(c.start,c.end);if(!r||!k(c)){return{alignmentPosition:h,alignmentOverflow:a}}const l=f[e];const d=m[l](i,s,n);const p=g(t,o,s,d);const v=Math.min(p.start,p.end);if(!k(p)){return{alignmentPosition:d,alignmentOverflow:v}}return a<v?{alignmentPosition:d,alignmentOverflow:v}:{alignmentPosition:h,alignmentOverflow:a}};const w=(e,t,i,s,o,n,r,h,c)=>{const a=n.getPropertyValue(u);const l=n.getPropertyValue(b);const d=_(r,i,t.width,s,e.width,z(a),r!=="center"&&c==="flip-inline");const p=_(h,t.top,t.height,o,e.height,z(l),h!=="center"&&c==="flip-block");return[d,p]};const x="*,::after,::before{box-sizing:border-box}:host{--ch-popover-block-size:max-content;--ch-popover-inline-size:max-content;--ch-popover-max-block-size:auto;--ch-popover-max-inline-size:auto;--ch-popover-min-block-size:auto;--ch-popover-min-inline-size:auto;--ch-popover-resize-threshold:8px;--ch-popover-separation-x:0px;--ch-popover-separation-y:0px;--ch-popover-resize-threshold--half-negative:calc(\n    var(--ch-popover-resize-threshold) * -0.5\n  );--ch-popover-border-inline-start-width:0px;--ch-popover-border-inline-end-width:0px;--ch-popover-border-block-start-width:0px;--ch-popover-border-block-end-width:0px;--ch-popover-resize__inline-start:calc(\n    var(--ch-popover-resize-threshold--half-negative) -\n      var(--ch-popover-border-inline-start-width) * 0.5\n  );--ch-popover-resize__inline-end:calc(\n    var(--ch-popover-resize-threshold--half-negative) -\n      var(--ch-popover-border-inline-end-width) * 0.5\n  );--ch-popover-resize__block-start:calc(\n    var(--ch-popover-resize-threshold--half-negative) -\n      var(--ch-popover-border-block-start-width) * 0.5\n  );--ch-popover-resize__block-end:calc(\n    var(--ch-popover-resize-threshold--half-negative) -\n      var(--ch-popover-border-block-end-width) * 0.5\n  );--ch-popover-x:calc(\n    (\n        var(--ch-popover-action-left) + var(--ch-popover-inline) +\n          var(--ch-popover-dragged-x)\n      ) * var(--ch-popover-rtl)\n  );--ch-popover-y:calc(\n    var(--ch-popover-action-top) + var(--ch-popover-block) +\n      var(--ch-popover-dragged-y)\n  );--ch-popover-dragged-x:0px;--ch-popover-dragged-y:0px;--ch-popover-rtl:1;display:none;grid-auto-rows:max-content;position:fixed;inline-size:var(--ch-popover-inline-size);block-size:var(--ch-popover-block-size);min-inline-size:var(--ch-popover-min-inline-size);min-block-size:var(--ch-popover-min-block-size);max-inline-size:var(--ch-popover-forced-max-inline-size, var(--ch-popover-max-inline-size));max-block-size:var(--ch-popover-forced-max-block-size, var(--ch-popover-max-block-size));margin:0;padding:0;background-color:unset;border:unset;color:unset;overflow:visible;top:0;inset-inline-start:0;translate:var(--ch-popover-x) var(--ch-popover-y)}:host([overflow-behavior=add-scroll]){overflow:auto;translate:max(0px, var(--ch-popover-x)) max(0px, var(--ch-popover-y))}:host(.ch-popover-rtl[overflow-behavior=add-scroll]){translate:max(-100dvw, var(--ch-popover-x)) max(0px, var(--ch-popover-y))}:host([show]){display:grid}:host(.gx-popover-prevent-flickering){visibility:hidden !important}:host(.gx-popover-header-drag){display:grid;grid-template-rows:max-content 1fr}:host(.gx-popover-dragging){cursor:move}:host(.gx-popover-dragging) ::slotted(*){pointer-events:none;user-select:none}:host(.ch-popover-resizing){pointer-events:none;user-select:none}.edge__block-start,.edge__block-end{position:fixed;inset-inline:min(0px, (var(--ch-popover-resize-threshold) - var(--ch-popover-border-inline-start-width)) / 2) min(0px, (var(--ch-popover-resize-threshold) - var(--ch-popover-border-inline-end-width)) / 2);block-size:var(--ch-popover-resize-threshold);cursor:ns-resize}.edge__inline-start,.edge__inline-end{position:fixed;inset-block:min(0px, (var(--ch-popover-resize-threshold) - var(--ch-popover-border-block-start-width)) / 2) min(0px, (var(--ch-popover-resize-threshold) - var(--ch-popover-border-block-end-width)) / 2);inline-size:var(--ch-popover-resize-threshold);cursor:ew-resize}.edge__block-start{inset-block-start:var(--ch-popover-resize__block-start)}.edge__block-end{inset-block-end:var(--ch-popover-resize__block-end)}.edge__inline-start{inset-inline-start:var(--ch-popover-resize__inline-start)}.edge__inline-end{inset-inline-end:var(--ch-popover-resize__inline-end)}.corner__block-start-inline-start,.corner__block-end-inline-end{position:fixed;block-size:var(--ch-popover-resize-threshold);inline-size:var(--ch-popover-resize-threshold);cursor:nwse-resize}.corner__block-start-inline-end,.corner__block-end-inline-start{position:fixed;block-size:var(--ch-popover-resize-threshold);inline-size:var(--ch-popover-resize-threshold);cursor:nesw-resize}.corner__block-start-inline-start{inset-block-start:var(--ch-popover-resize__block-start);inset-inline-start:var(--ch-popover-resize__inline-start)}.corner__block-end-inline-end{inset-block-end:var(--ch-popover-resize__block-end);inset-inline-end:var(--ch-popover-resize__inline-end)}.corner__block-start-inline-end{inset-block-start:var(--ch-popover-resize__block-start);inset-inline-end:var(--ch-popover-resize__inline-end)}.corner__block-end-inline-start{inset-block-end:var(--ch-popover-resize__block-end);inset-inline-start:var(--ch-popover-resize__inline-start)}:host(.ch-popover-rtl) .corner__block-start-inline-start,:host(.ch-popover-rtl) .corner__block-end-inline-end{cursor:nesw-resize}:host(.ch-popover-rtl) .corner__block-start-inline-end,:host(.ch-popover-rtl) .corner__block-end-inline-start{cursor:nwse-resize}.resize-layer{position:fixed;inset:0;pointer-events:none}";const y=x;const C="gx-popover-dragging";const D="gx-popover-prevent-flickering";const S="ch-popover-resizing";const A="--ch-popover-block";const R="--ch-popover-inline";const P="--ch-popover-action-width";const F="--ch-popover-action-height";const M="--ch-popover-action-left";const O="--ch-popover-action-top";const W="--ch-popover-dragged-x";const E="--ch-popover-dragged-y";const I="--ch-popover-block-size";const B="--ch-popover-inline-size";const j="--ch-popover-min-block-size";const N="--ch-popover-min-inline-size";const T="--ch-popover-forced-max-block-size";const L="--ch-popover-forced-max-inline-size";const q="--ch-popover-border-block-start-width";const K="--ch-popover-border-block-end-width";const X="--ch-popover-border-inline-start-width";const Y="--ch-popover-border-inline-end-width";const $="ch-popover-rtl";const H="--ch-popover-rtl";const G="-1";const J=1.5;const Q=e=>document.body.style.cursor=e;const U={"block-start":()=>Q("ns-resize"),"block-end":()=>Q("ns-resize"),"inline-start":()=>Q("ew-resize"),"inline-end":()=>Q("ew-resize"),"block-start-inline-start":e=>Q(e?"nesw-resize":"nwse-resize"),"block-start-inline-end":e=>Q(e?"nwse-resize":"nesw-resize"),"block-end-inline-start":e=>Q(e?"nwse-resize":"nesw-resize"),"block-end-inline-end":e=>Q(e?"nesw-resize":"nwse-resize")};const V=(e,t,i)=>e.style.setProperty(t,`${i}px`);const Z=(e,t)=>Number((e.style.getPropertyValue(t)||"0px").replace("px",""));const ee=(e,t,i)=>{if(e&&i){e.popoverTargetElement=t}};const te=e=>{if(e){e.popoverTargetElement=undefined}};let ie=0;const se=class{constructor(i){e(this,i);this.popoverOpened=t(this,"popoverOpened",7);this.popoverClosed=t(this,"popoverClosed",7);this.resizing=false;this.actionById=false;this.actionElement=undefined;this.allowDrag="no";this.blockAlign="center";this.blockSizeMatch="content";this.closeOnClickOutside=false;this.firstLayer=true;this.inlineAlign="center";this.inlineSizeMatch="content";this.mode="auto";this.overflowBehavior="overflow";this.positionTry="none";this.resizable=false;this.show=false}#e=`${ie++}`;#t;#i;#s;#o;#n=false;#r=false;#h=false;#c;#a;#l=0;#d=0;#p=false;#v;#u;#b;#f;#g=0;#k=0;#m=0;#z=0;#_=0;#w=0;#x=false;#y={block:(e,t)=>{let i=this.#u.clientY-this.#v.clientY;if(t==="start"){i=-i}const s=e.height+i;const o=p(s,this.#_,this.#m);if(o===e.height){return}if(t==="start"){this.#k-=i;V(this.el,E,this.#k)}V(this.el,I,o)},inline:(e,t)=>{let i=this.#u.clientX-this.#v.clientX;if(this.#b){i=-i}if(t==="start"){i=-i}const s=e.width+i;const o=p(s,this.#w,this.#z);if(o===e.width){return}if(t==="start"){this.#g-=i;V(this.el,W,this.#g)}V(this.el,B,o)}};#C={"block-start":e=>this.#y.block(e,"start"),"block-end":e=>this.#y.block(e,"end"),"inline-start":e=>this.#y.inline(e,"start"),"inline-end":e=>this.#y.inline(e,"end"),"block-start-inline-start":e=>{this.#y.block(e,"start");this.#y.inline(e,"start")},"block-start-inline-end":e=>{this.#y.block(e,"start");this.#y.inline(e,"end")},"block-end-inline-start":e=>{this.#y.block(e,"end");this.#y.inline(e,"start")},"block-end-inline-end":e=>{this.#y.block(e,"end");this.#y.inline(e,"end")}};#D;#S;get el(){return i(this)}handleActionChange(e,t){this.#l=0;this.#d=0;te(t);ee(e,this.el,!this.actionById);this.#r=true}handleBlockChange(){this.#n=true}blockSizeWatchChange(e){if(this.#x){return}if(e==="content"){this.el.style.removeProperty(I);this.el.style.removeProperty(j)}else if(e==="action-element"){this.el.style.removeProperty(j)}else{this.el.style.removeProperty(I)}this.#n=true}handleInlineChange(){this.#n=true}inlineSizeWatchChange(e){if(this.#x){return}if(e==="content"){this.el.style.removeProperty(B);this.el.style.removeProperty(N)}else if(e==="action-element"){this.el.style.removeProperty(N)}else{this.el.style.removeProperty(B)}this.#n=true}resizableChanged(){this.#h=true}showChanged(e){this.#h=true;this.#r=true;if(e){this.#A()}else{if(this.firstLayer){this.#R(true)}this.#P()}}popoverOpened;popoverClosed;#A=()=>{this.el.showPopover();this.#F()};#P=()=>{this.el.hidePopover();this.#M()};#O=e=>{const t=this.popoverClosed.emit();if(t.defaultPrevented){e.preventDefault();return}this.show=false};#W=e=>{const t=e.composedPath();if(!t.includes(this.el)&&!t.includes(this.actionElement)){this.#O(e)}};#E=e=>{if(e.code===n.ESCAPE){this.#O(e)}};#F=()=>{if(this.mode==="manual"&&this.closeOnClickOutside){document.addEventListener("click",this.#W,{capture:true,passive:true});document.addEventListener("keydown",this.#E,{capture:true,passive:true})}};#M=()=>{document.removeEventListener("click",this.#W,{capture:true});document.removeEventListener("keydown",this.#E,{capture:true})};#I=()=>{if(!this.#p){this.el.classList.add(C);this.#p=true}};#B=()=>{this.el.classList.remove(C);this.#p=false};#R=e=>{if(e){this.el.classList.add(D)}else{this.el.classList.remove(D)}};#j=()=>{if(!this.actionElement||!this.show){this.#N();return}if(this.#a){this.#a.disconnect()}this.#s??=new h;this.#a??=new ResizeObserver((e=>{const t=e.find((e=>e.target===this.el));if(t){this.#T()}else{this.#L()}}));this.#a.observe(this.actionElement);this.#a.observe(document.body);this.#a.observe(this.el);this.#T();if(this.firstLayer){requestAnimationFrame((()=>{this.#R(false)}))}this.#S??=v(this.el);this.#S.forEach((e=>e.addEventListener("scroll",this.#L,{capture:true,passive:true})))};#L=()=>{this.#s.perform(this.#T)};#T=()=>{const e=document.documentElement.getBoundingClientRect();const t=this.actionElement.getBoundingClientRect();const i={width:this.el.scrollWidth,height:this.el.scrollHeight};const s=getComputedStyle(this.el);const o=this.#q(e,t);this.#K(e,t,o,i,s);V(this.el,P,t.width);V(this.el,F,t.height);V(this.el,M,o);V(this.el,O,t.top)};#q=(e,t)=>this.#b?e.width-(t.left+t.width):t.left;#K=(e,t,i,s,o)=>{const n=this.#X(t,s);const r=this.#Y(t,s);const h=w(e,t,i,n,r,o,this.inlineAlign,this.blockAlign,this.positionTry);const c=h[0].alignmentOverflow;const a=h[1].alignmentOverflow;this.#$(n,r,c,a);V(this.el,R,h[0].alignmentPosition);V(this.el,A,h[1].alignmentPosition)};#$=(e,t,i,s)=>{if(this.overflowBehavior!=="add-scroll"){return}const o=Z(this.el,L);const n=Z(this.el,T);if(i<0){const t=e+i;V(this.el,L,t)}else if(o&&e+J<o+i){this.el.style.removeProperty(L)}if(s<0){const e=t+s;V(this.el,T,e)}else if(n&&t+J<n+s){this.el.style.removeProperty(T)}};#X=(e,t)=>{if(this.inlineSizeMatch==="action-element-as-minimum"){V(this.el,N,e.width);return e.width}if(this.#x||this.inlineSizeMatch==="content"){return t.width}V(this.el,B,e.width);return e.width};#Y=(e,t)=>{if(this.blockSizeMatch==="action-element-as-minimum"){V(this.el,j,e.height);return e.height}if(this.#x||this.blockSizeMatch==="content"){return t.height}V(this.el,I,e.height);return e.height};#N=()=>{if(this.#a){this.#a.disconnect();this.#a=null}this.#S?.forEach((e=>e?.removeEventListener("scroll",this.#L,{capture:true})));this.#S=undefined};#H=e=>{const t=e.newState==="open";let i;if(t){i=this.popoverOpened.emit()}else{i=this.popoverClosed.emit()}if(i.defaultPrevented){e.preventDefault();return}this.show=t};#G=e=>{this.#i||=new h;this.#v=e;document.addEventListener("mousemove",this.#J,{capture:true});document.addEventListener("mouseup",this.#Q,{capture:true,passive:true})};#J=e=>{this.#i.perform(this.#U,(()=>{e.preventDefault();this.#I();this.#u=e}))};#U=()=>{const e=this.#u.clientX-this.#v.clientX;const t=this.#u.clientY-this.#v.clientY;if(e!==0){this.#l+=this.#b?-e:e;V(this.el,W,this.#l)}if(t!==0){this.#d+=t;V(this.el,E,this.#d)}this.#v=this.#u};#Q=()=>{this.#i?.cancel();document.removeEventListener("mousemove",this.#J,{capture:true});document.removeEventListener("mouseup",this.#Q,{capture:true});this.#B();this.#i=null;this.#v=null;this.#u=null};#V=e=>t=>{this.resizing=true;this.#o||=new h;this.#f=e;this.#v=t;U[this.#f](this.#b);this.#g=this.#l;this.#k=this.#d;const i=getComputedStyle(this.el);this.#m=z(i.maxBlockSize);this.#z=z(i.maxInlineSize);this.#_=z(i.minBlockSize);this.#w=z(i.minInlineSize);this.#N();this.#Z();this.#M();document.addEventListener("mousemove",this.#ee,{capture:true});document.addEventListener("mouseup",this.#te,{capture:true,passive:true})};#ee=e=>{this.#o.perform(this.#ie,(()=>{e.preventDefault();this.#I();this.#u=e}))};#ie=()=>{const e=this.el.getBoundingClientRect();this.#C[this.#f](e);this.#x=true;this.#v=this.#u};#te=()=>{this.resizing=false;this.#o?.cancel();document.body.style.cursor=null;V(this.el,W,this.#l);V(this.el,E,this.#d);this.#j();this.#se();requestAnimationFrame(this.#F);document.removeEventListener("mousemove",this.#ee,{capture:true});document.removeEventListener("mouseup",this.#te,{capture:true});this.#B();this.#o=null;this.#v=null;this.#u=null};#se=()=>{if(!this.resizable||!this.show){this.#Z();return}this.#t??=new h;this.#c=new ResizeObserver(this.#oe);this.#c.observe(this.el,{box:"border-box"});this.#c.observe(this.#D)};#oe=()=>{this.#t.perform(this.#ne)};#ne=()=>{const e=getComputedStyle(this.el);this.el.style.setProperty(q,e.borderBlockStartWidth);this.el.style.setProperty(K,e.borderBlockEndWidth);this.el.style.setProperty(X,e.borderInlineStartWidth);this.el.style.setProperty(Y,e.borderInlineEndWidth)};#Z=()=>{if(this.#c){this.#c.disconnect();this.#c=null}this.#t?.cancel();this.#t=null};#re=e=>{this.#b=e;if(e){this.el.style.setProperty(H,G);this.el.classList.add($)}else{this.el.style.removeProperty(H);this.el.classList.remove($)}};connectedCallback(){c(this.el.shadowRoot.adoptedStyleSheets);a(this.#e,this.#re);this.#re(l());if(this.firstLayer){this.#R(true)}}componentWillRender(){if(this.#r){this.#r=false;this.#j()}if(this.#h){this.#h=false;requestAnimationFrame((()=>{this.#se()}))}if(this.#n){const e=document.documentElement.getBoundingClientRect();const t=this.actionElement.getBoundingClientRect();const i={width:this.el.scrollWidth,height:this.el.scrollHeight};const s=getComputedStyle(this.el);const o=this.#q(e,t);this.#K(e,t,o,i,s)}}componentDidLoad(){ee(this.actionElement,this.el,!this.actionById);this.#j();this.#se();if(this.show){this.#A()}}disconnectedCallback(){this.#N();this.#Z();te(this.actionElement);this.#Q();this.#M();d(this.#e)}render(){const e=this.show;return s(o,{key:"344e8ddddeb0c46be604f578c8d89fecaedf42d1",class:{"gx-popover-header-drag":e&&this.allowDrag==="header",[S]:this.resizing,[r]:this.overflowBehavior==="add-scroll"},popover:this.mode,onMouseDown:e&&this.allowDrag==="box"?this.#G:null,onToggle:this.#H},this.allowDrag==="header"&&s("div",{key:"ca9a27e4daf2e722c630ef82e8f2e6b10ce6e433",class:"header",part:"header",onMouseDown:e?this.#G:null},s("slot",{key:"a5ac9e62f1672b50e9807faa264bb4fb3c1c22fc",name:"header"})),s("slot",{key:"d3dd9111f037ede469f0f9690537b505d6fb09e6"}),this.resizable&&this.show&&[s("div",{key:"9a995bef0643a45293a61a81ad01c13a3139336d",class:"edge__block-start",onMouseDown:this.#V("block-start")}),s("div",{key:"fb80b5449e07cf9b4e20acddb082d85cce69474a",class:"edge__inline-end",onMouseDown:this.#V("inline-end")}),s("div",{key:"997480e271cf508fd5fe2301b59d2f6c7821221d",class:"edge__block-end",onMouseDown:this.#V("block-end")}),s("div",{key:"0feb50cd962f1b68973b42d651ba4af6b38ee95c",class:"edge__inline-start",onMouseDown:this.#V("inline-start")}),s("div",{key:"d01c9208e18e0867ab02b01d376be12722ee4bb4",class:"corner__block-start-inline-start",onMouseDown:this.#V("block-start-inline-start")}),s("div",{key:"81e55ce0e807b2395b0ac7c4e4b9c20b79de74ac",class:"corner__block-start-inline-end",onMouseDown:this.#V("block-start-inline-end")}),s("div",{key:"c338d800e151adf13fdb5dbf84c5447a24248d02",class:"corner__block-end-inline-start",onMouseDown:this.#V("block-end-inline-start")}),s("div",{key:"095d0bfd1d778e3428264a18efc0d205e24cb310",class:"corner__block-end-inline-end",onMouseDown:this.#V("block-end-inline-end")}),s("div",{key:"b0ee87d313bb93dd1d8675bf70c8bb9e604e0630",class:"resize-layer",ref:e=>this.#D=e})])}static get watchers(){return{actionElement:["handleActionChange"],blockAlign:["handleBlockChange"],blockSizeMatch:["blockSizeWatchChange"],inlineAlign:["handleInlineChange"],inlineSizeMatch:["inlineSizeWatchChange"],resizable:["resizableChanged"],show:["showChanged"]}}};se.style=y;export{se as ch_popover};
//# sourceMappingURL=p-18c7e615.entry.js.map