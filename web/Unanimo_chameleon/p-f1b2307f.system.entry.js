var __awaiter=this&&this.__awaiter||function(t,e,i,n){function a(t){return t instanceof i?t:new i((function(e){e(t)}))}return new(i||(i=Promise))((function(i,r){function s(t){try{l(n.next(t))}catch(t){r(t)}}function o(t){try{l(n["throw"](t))}catch(t){r(t)}}function l(t){t.done?i(t.value):a(t.value).then(s,o)}l((n=n.apply(t,e||[])).next())}))};var __generator=this&&this.__generator||function(t,e){var i={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},n,a,r,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(t){return function(e){return l([t,e])}}function l(o){if(n)throw new TypeError("Generator is already executing.");while(s&&(s=0,o[0]&&(i=0)),i)try{if(n=1,a&&(r=o[0]&2?a["return"]:o[0]?a["throw"]||((r=a["return"])&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;if(a=0,r)o=[o[0]&2,r.value];switch(o[0]){case 0:case 1:r=o;break;case 4:i.label++;return{value:o[1],done:false};case 5:i.label++;a=o[1];o=[0];continue;case 7:o=i.ops.pop();i.trys.pop();continue;default:if(!(r=i.trys,r=r.length>0&&r[r.length-1])&&(o[0]===6||o[0]===2)){i=0;continue}if(o[0]===3&&(!r||o[1]>r[0]&&o[1]<r[3])){i.label=o[1];break}if(o[0]===6&&i.label<r[1]){i.label=r[1];r=o;break}if(r&&i.label<r[2]){i.label=r[2];i.ops.push(o);break}if(r[2])i.ops.pop();i.trys.pop();continue}o=e.call(t,i)}catch(t){o=[6,t];a=0}finally{n=r=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true}}};var __classPrivateFieldGet=this&&this.__classPrivateFieldGet||function(t,e,i,n){if(i==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e==="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return i==="m"?n:i==="a"?n.call(t):n?n.value:e.get(t)};var __classPrivateFieldSet=this&&this.__classPrivateFieldSet||function(t,e,i,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof e==="function"?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(t,i):a?a.value=i:e.set(t,i),i};var __spreadArray=this&&this.__spreadArray||function(t,e,i){if(i||arguments.length===2)for(var n=0,a=e.length,r;n<a;n++){if(r||!(n in e)){if(!r)r=Array.prototype.slice.call(e,0,n);r[n]=e[n]}}return t.concat(r||Array.prototype.slice.call(e))};System.register(["./p-62fc4e49.system.js","./p-3adf2593.system.js","./p-81126801.system.js","./p-f209c7cb.system.js","./p-16b65a3e.system.js"],(function(t){"use strict";var e,i,n,a,r,s,o,l,c;return{setters:[function(t){e=t.h;i=t.r;n=t.g;a=t.f;r=t.H},function(t){s=t.r},function(t){o=t.m;l=t.t},function(t){c=t.a},function(){}],execute:function(){var d,u,f,h,p,v,m,g,w,_,b,x,k,y,P,F,G;var C=function(t){return function(){return o(t)}};var M=function(t){return t==="complete"||t===undefined?"false":"true"};var z=function(t){return t?"assistant-content ".concat(t):"assistant-content"};var W=function(t,e){return function(){var i=new Blob([t.plainText],{type:"text/plain"});var n=window.URL.createObjectURL(i);e.anchor.href=n;e.anchor.download="Answer.txt";e.anchor.click();setTimeout((function(){window.URL.revokeObjectURL(n)}))}};var S=function(t,i){return function(n){return e("div",null,e("div",{class:"code-block__header",part:"code-block__header"},n.language,e("div",{class:"code-block__header-actions",part:"code-block__header-actions"},e("button",{"aria-label":t.isMobile?i.text.copyCodeButton:undefined,class:"code-block__copy-code-button",part:"code-block__copy-code-button",type:"button",onClick:C(n.plainText)},!t.isMobile&&i.text.copyCodeButton),t.hyperlinkToDownloadFile&&e("button",{"aria-label":i.accessibleName.downloadCodeButton,title:i.accessibleName.downloadCodeButton,class:"code-block__download-code-button",part:"code-block__download-code-button",onClick:W(n,t.hyperlinkToDownloadFile)}))),e("ch-code",{class:"code-block__content",language:n.language,lastNestedChildClass:n.lastNestedChildClass,showIndicator:n.showIndicator,value:n.plainText}))}};var j=function(t){return typeof t.content==="string"?t.content:e("div",{class:"message-with-images",part:"message-with-images"},e("span",{part:"message-with-images__text"},t.content[0].text),t.content.slice(1).map((function(t){return e("img",{"aria-hidden":"true",class:!t.image_url.url?"file-skeleton":undefined,part:t.image_url.url?"message-with-images__image":"message-with-images__image file-skeleton",src:t.image_url.url,alt:"",loading:"lazy"})})))};var B=function(t,i){var n,a;var r=typeof i.content==="string"?i.content:i.content.message;var s=(n=i.content.files)!==null&&n!==void 0?n:null;var o=t.translations;return e("div",{"aria-live":"polite","aria-busy":M(i.status),class:"assistant-content",part:z(i.status)},i.status==="waiting"?e("div",{class:"assistant-loading",part:"assistant-loading"},r):[e("ch-markdown-viewer",{renderCode:(a=t.renderCode)!==null&&a!==void 0?a:S(t,o),showIndicator:i.status==="streaming",theme:t.markdownTheme,value:r}),s&&e("div",{class:"assistant-files",part:"assistant-files"},o.text.sourceFiles,s.map((function(t){return e("a",{href:t.url,target:"_blank",part:"assistant-file"},t.caption)})))],(i.status==="complete"||!i.status)&&e("button",{"aria-label":o.accessibleName.copyResponseButton,title:o.accessibleName.copyResponseButton,part:"copy-response-button",type:"button",onClick:C(r)}))};var A=function(t,i){var n;return e("ch-markdown-viewer",{renderCode:(n=t.renderCode)!==null&&n!==void 0?n:S(t,t.translations),theme:t.markdownTheme,value:i.content})};var T=function(t){return function(e){if(e.role==="assistant"){return B(t,e)}return e.role==="user"?j(e):A(t,e)}};var I=':where(button,a){all:unset;display:-ms-inline-flexbox;display:inline-flex;-ms-flex-align:center;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-ms-touch-action:manipulation;touch-action:manipulation;cursor:pointer}button:disabled{pointer-events:none}*,::after,::before{-webkit-box-sizing:border-box;box-sizing:border-box}h1,h2,h3,h4,h5,h6,p{font:inherit;margin:0;padding:0;color:inherit}:host{display:grid;grid-template-rows:1fr -webkit-max-content;grid-template-rows:1fr max-content}:host(.ch-chat--additional-content){grid-template-rows:1fr -webkit-max-content -webkit-max-content;grid-template-rows:1fr max-content max-content}.assistant-content,.user-content{contain:paint}.message-with-images{display:grid}img{display:block;max-inline-size:100%}.assistant-loading{display:grid;grid-template-columns:-webkit-max-content 1fr;grid-template-columns:max-content 1fr;-ms-flex-align:center;align-items:center}.assistant-files{grid-area:2/2;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-align:center;align-items:center}.file-skeleton{position:relative}.file-skeleton::before,.file-skeleton::after{content:"";display:-ms-inline-flexbox;display:inline-flex}.stop-generating-answer-button{grid-area:input-wrapper;position:absolute;inset-block-start:0;justify-self:center;-webkit-transform:translateY(-100%);transform:translateY(-100%)}.images-to-upload{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.send-container{display:grid;grid-template:"input-wrapper send-or-audio" 1fr/1fr -webkit-max-content;grid-template:"input-wrapper send-or-audio" 1fr/1fr max-content;position:relative;-ms-flex-align:end;align-items:end}.send-container--file-uploading{grid-template:"upload-image input-wrapper send-or-audio" 1fr/max-content 1fr -webkit-max-content;grid-template:"upload-image input-wrapper send-or-audio" 1fr/max-content 1fr max-content}.send-input-wrapper{grid-area:input-wrapper}.send-or-audio-button{grid-area:send-or-audio}.spinner-loading{-webkit-animation:infinite-rotate 0.875s linear 0s infinite;animation:infinite-rotate 0.875s linear 0s infinite}@-webkit-keyframes infinite-rotate{100%{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes infinite-rotate{100%{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@-webkit-keyframes gx-skeleton-load{to{-webkit-transform:translateX(192%);transform:translateX(192%)}}@keyframes gx-skeleton-load{to{-webkit-transform:translateX(192%);transform:translateX(192%)}}.processing-animation{content:"";-webkit-margin-start:auto;margin-inline-start:auto;display:block;background-image:url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="6" height="6" viewBox="0 0 6 6"><path d="M3 6C4.65685 6 6 4.65685 6 3C6 1.34315 4.65685 0 3 0C1.34315 0 0 1.34315 0 3C0 4.65685 1.34315 6 3 6Z" fill="%23939498"/></svg>\'), url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="6" height="6" viewBox="0 0 6 6"><path d="M3 6C4.65685 6 6 4.65685 6 3C6 1.34315 4.65685 0 3 0C1.34315 0 0 1.34315 0 3C0 4.65685 1.34315 6 3 6Z" fill="%23939498"/></svg>\'), url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="6" height="6" viewBox="0 0 6 6"><path d="M3 6C4.65685 6 6 4.65685 6 3C6 1.34315 4.65685 0 3 0C1.34315 0 0 1.34315 0 3C0 4.65685 1.34315 6 3 6Z" fill="%23939498"/></svg>\');inline-size:20px;block-size:16px;background-position:left, center, right;background-size:4px, 4px, 4px;background-repeat:no-repeat;-webkit-animation:ellipsis 1s infinite linear;animation:ellipsis 1s infinite linear}@-webkit-keyframes ellipsis{0%{background-size:6px, 4px, 4px}25%{background-size:4px, 6px, 4px}50%{background-size:4px, 4px, 6px}75%{background-size:4px, 6px, 4px}100%{background-size:6px, 4px, 4px}}@keyframes ellipsis{0%{background-size:6px, 4px, 4px}25%{background-size:4px, 6px, 4px}50%{background-size:4px, 4px, 6px}75%{background-size:4px, 6px, 4px}100%{background-size:6px, 4px, 4px}}';var E=I;var D="Enter";var L=t("ch_chat",(G=function(){function t(t){var n=this;d.set(this,void 0);u.set(this,void 0);f.set(this,void 0);h.set(this,(function(t){return __awaiter(n,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:if(!(this.items.length===0))return[3,1];this.items.push(t);a(this);return[3,3];case 1:return[4,__classPrivateFieldGet(this,f,"f").addItems("end",t)];case 2:e.sent();e.label=3;case 3:return[2]}}))}))}));p.set(this,(function(t){return typeof t.content==="string"?t.content:t.content.message}));v.set(this,(function(t,e,i){if(i==="concat"){var a=__classPrivateFieldGet(n,p,"f").call(n,n.items[t])+__classPrivateFieldGet(n,p,"f").call(n,e);if(typeof e.content==="string"){e.content=a}else{e.content.message=a}}var r=n.items[t].id;n.items[t]=Object.assign({id:r},e)}));m.set(this,(function(t){if(t.key!==D||t.shiftKey){return}t.preventDefault();__classPrivateFieldGet(n,w,"f").call(n)}));g.set(this,(function(t){return __awaiter(n,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:__classPrivateFieldGet(this,d,"f").value="";__classPrivateFieldGet(this,d,"f").click();if(__classPrivateFieldGet(this,u,"f")){__classPrivateFieldGet(this,u,"f").scrollTop=__classPrivateFieldGet(this,u,"f").scrollHeight}return[4,__classPrivateFieldGet(this,h,"f").call(this,t)];case 1:e.sent();return[2]}}))}))}));w.set(this,(function(){return __awaiter(n,void 0,void 0,(function(){var t,e,i;var n=this;var r;return __generator(this,(function(s){switch(s.label){case 0:if(!__classPrivateFieldGet(this,d,"f").value||this.disabled||this.loadingState==="initial"||this.loadingState==="loading"||this.generatingResponse||this.uploadingImagesToTheServer>0){return[2]}if(!(!this.imageUpload||this.imagesToUpload.length===0))return[3,2];t={id:"".concat((new Date).getTime()),role:"user",content:__classPrivateFieldGet(this,d,"f").value};return[4,__classPrivateFieldGet(this,g,"f").call(this,t)];case 1:s.sent();(r=this.callbacks)===null||r===void 0?void 0:r.sendChatToLLM(this.items);a(this);return[2];case 2:this.uploadingImagesToTheServer=this.imagesToUpload.length;e=[{type:"text",text:__classPrivateFieldGet(this,d,"f").value}];this.imagesToUpload.forEach((function(t,i){var a;e.push({type:"image_url",image_url:{url:""}});(a=n.callbacks)===null||a===void 0?void 0:a.uploadImage(t.file).then((function(t){var a;e[i+1]={type:"image_url",image_url:{url:t}};n.uploadingImagesToTheServer--;if(n.uploadingImagesToTheServer===0){(a=n.callbacks)===null||a===void 0?void 0:a.sendChatToLLM(n.items)}})).catch((function(){var t;n.uploadingImagesToTheServer--;if(n.uploadingImagesToTheServer===0){(t=n.callbacks)===null||t===void 0?void 0:t.sendChatToLLM(n.items)}}))}));i={id:"".concat((new Date).getTime()),role:"user",content:e};return[4,__classPrivateFieldGet(this,g,"f").call(this,i)];case 3:s.sent();this.imagesToUpload=[];return[2]}}))}))}));_.set(this,(function(t){var e;t.stopPropagation();(e=n.callbacks)===null||e===void 0?void 0:e.stopGeneratingAnswer()}));b.set(this,(function(t){return function(e){var i;var r=e.target;var o=(i=r.nextElementSibling)!==null&&i!==void 0?i:r.previousElementSibling;o===null||o===void 0?void 0:o.focus();s(n.imagesToUpload,t);a(n)}}));x.set(this,(function(t){return function(){URL.revokeObjectURL(t)}}));k.set(this,(function(t){n.virtualItems=t.detail.virtualItems}));y.set(this,(function(){return n.loadingState==="all-records-loaded"&&n.items.length===0?e("slot",{name:"empty-chat"}):e("ch-smart-grid",{dataProvider:n.loadingState==="more-data-to-fetch",loadingState:n.virtualItems.length===0?"initial":n.loadingState,inverseLoading:true,itemsCount:n.virtualItems.length,onInfiniteThresholdReached:__classPrivateFieldGet(n,F,"f"),ref:function(t){return __classPrivateFieldSet(n,u,t,"f")}},e("ch-virtual-scroller",{role:"row",slot:"grid-content",class:"grid-content",part:"content",inverseLoading:true,items:n.items,itemsCount:n.items.length,onVirtualItemsChanged:__classPrivateFieldGet(n,k,"f"),ref:function(t){return __classPrivateFieldSet(n,f,t,"f")}},n.virtualItems.map(__classPrivateFieldGet(n,P,"f"))))}));P.set(this,(function(t){var i;return t.role!=="system"&&e("ch-smart-grid-cell",{key:t.id,cellId:t.id,part:l((i={},i["message ".concat(t.role)]=true,i[t.parts]=!!t.parts,i[t.status]=t.role==="assistant",i))},n.renderItem?n.renderItem(t):T(n.el)(t))}));F.set(this,(function(){n.loadingState="loading";setTimeout((function(){var t;var e=n.items.length;var i=Array.from({length:20},(function(t,i){return i%2===0?{id:"index: ".concat(i-e),role:"user",content:"index: ".concat(i-e)+"index: ".concat(i-e,"\n")+"index: ".concat(i-e,"\n")+"index: ".concat(i-e,"\n")+"index: ".concat(i-e,"\n")+"index: ".concat(i-e,"\n")+"index: ".concat(i-e,"\n")}:{id:"index: ".concat(i-e),role:"assistant",content:"\nindex: ".concat(i-e,"\n")+"index: ".concat(i-e,"\n")+"index: ".concat(i-e,"\n")+"index: ".concat(i-e,"\n")+"index: ".concat(i-e,"\n")+"index: ".concat(i-e,"\n")+"index: ".concat(i-e,"\n")}}));(t=__classPrivateFieldGet(n,f,"f")).addItems.apply(t,__spreadArray(["start"],i,false));n.loadingState="more-data-to-fetch"}),10)}));i(this,t);this.imagesToUpload=[];this.uploadingImagesToTheServer=0;this.virtualItems=[];this.callbacks=undefined;this.disabled=false;this.generatingResponse=false;this.hyperlinkToDownloadFile=undefined;this.imageUpload=false;this.isMobile=false;this.items=[];this.loadingState="initial";this.markdownTheme="ch-markdown-viewer";this.renderCode=undefined;this.showAdditionalContent=false;this.theme=undefined;this.translations={accessibleName:{clearChat:"Clear chat",copyResponseButton:"Copy assistant response",downloadCodeButton:"Download code",imagePicker:"Select images",removeUploadedImage:"Remove uploaded image",sendButton:"Send",sendInput:"Message",stopGeneratingAnswerButton:"Stop generating answer"},placeholder:{sendInput:"Ask me a question..."},text:{stopGeneratingAnswerButton:"Stop generating answer",copyCodeButton:"Copy code",processing:"Processing...",sourceFiles:"Source files:"}};this.renderItem=undefined}Object.defineProperty(t.prototype,"el",{get:function(){return n(this)},enumerable:false,configurable:true});t.prototype.addNewMessage=function(t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){__classPrivateFieldGet(this,h,"f").call(this,t);return[2]}))}))};t.prototype.focusChatInput=function(){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(e){(t=__classPrivateFieldGet(this,d,"f"))===null||t===void 0?void 0:t.focus();return[2]}))}))};t.prototype.setChatInputMessage=function(t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){if(__classPrivateFieldGet(this,d,"f")){__classPrivateFieldGet(this,d,"f").value=t}return[2]}))}))};t.prototype.updateChatMessage=function(t,e,i){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(n){if(this.items.length===0||!this.items[t]){return[2]}__classPrivateFieldGet(this,v,"f").call(this,t,e,i);a(this);return[2]}))}))};t.prototype.updateLastMessage=function(t,e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(i){if(this.items.length===0){return[2]}__classPrivateFieldGet(this,v,"f").call(this,this.items.length-1,t,e);this.virtualItems[this.virtualItems.length-1]=this.items.at(-1);a(this);return[2]}))}))};t.prototype.connectedCallback=function(){c(this.el.shadowRoot.adoptedStyleSheets)};t.prototype.render=function(){var t=this;var i,n;var a=this.translations.text;var s=this.translations.accessibleName;var o=this.showAdditionalContent&&this.loadingState!=="initial"&&!(this.items.length===0&&this.loadingState==="all-records-loaded");return e(r,{key:"5132bf18a4d65c8f89bc15eff0326ddb2adf7cf4",class:o?"ch-chat--additional-content":undefined},this.theme&&e("ch-theme",{key:"fdd66de7e914d3bfd7608506d8611221ded140d5",model:this.theme}),this.loadingState==="initial"?e("div",{class:"loading-chat",slot:"empty-chat"}):__classPrivateFieldGet(this,y,"f").call(this),o&&e("slot",{key:"0477dc93373a3410bf080dbb4c0876c2e0b51122",name:"additional-content"}),e("div",{key:"52d0120573c101093206005308c764a00fbacdea",class:{"send-container":true,"send-container--file-uploading":this.imageUpload},part:"send-container"},this.generatingResponse&&((i=this.callbacks)===null||i===void 0?void 0:i.stopGeneratingAnswer)&&e("button",{key:"58cea186731ac8c977bf7093a1c145da64cd6c36","aria-label":s.stopGeneratingAnswerButton!==a.stopGeneratingAnswerButton&&((n=s.stopGeneratingAnswerButton)!==null&&n!==void 0?n:a.stopGeneratingAnswerButton),class:"stop-generating-answer-button",part:"stop-generating-answer-button",type:"button",onClick:__classPrivateFieldGet(this,_,"f")},a.stopGeneratingAnswerButton),e("div",{key:"d6eea397778eaaf813504aab0bd254085a629ab7",class:"send-input-wrapper",part:"send-input-wrapper"},this.imagesToUpload.length>0&&e("div",{key:"760ea791646e9e068df9aa2dec7feb28139a88da",class:"images-to-upload",part:"images-to-upload"},this.imagesToUpload.map((function(i,n){return e("button",{key:i.src,"aria-label":s.removeUploadedImage,title:s.removeUploadedImage,part:"remove-image-to-upload-button",type:"button",onClick:__classPrivateFieldGet(t,b,"f").call(t,n)},e("img",{part:"image-to-upload","aria-hidden":"true",src:i.src,alt:"",loading:"lazy",onLoad:__classPrivateFieldGet(t,x,"f").call(t,i.src)}))}))),e("ch-edit",{key:"cee370c7f2015958ec10245be23a105c6df34b65",accessibleName:s.sendInput,autoGrow:true,hostParts:"send-input",multiline:true,placeholder:this.translations.placeholder.sendInput,onKeyDown:__classPrivateFieldGet(this,m,"f"),ref:function(e){return __classPrivateFieldSet(t,d,e,"f")}})),e("button",{key:"ab31794fe001ccad7e32ec318fa46b9bdd6f756d","aria-label":s.sendButton,title:s.sendButton,class:"send-or-audio-button",part:"send-button",disabled:this.disabled,type:"button",onClick:this.loadingState!=="initial"?__classPrivateFieldGet(this,w,"f"):undefined})))};return t}(),d=new WeakMap,u=new WeakMap,f=new WeakMap,h=new WeakMap,p=new WeakMap,v=new WeakMap,m=new WeakMap,g=new WeakMap,w=new WeakMap,_=new WeakMap,b=new WeakMap,x=new WeakMap,k=new WeakMap,y=new WeakMap,P=new WeakMap,F=new WeakMap,G));L.style=E}}}));
//# sourceMappingURL=p-f1b2307f.system.entry.js.map