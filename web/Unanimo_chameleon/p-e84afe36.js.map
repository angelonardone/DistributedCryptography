{"version":3,"names":["tagsToSanitize","Set","LAST_SEMICOLON_AND_SPACES_IN_INLINE_STYLE","SEMICOLON_AND_SPACES","COLON_AND_SPACES","getStyleObjectFromString","inlineStyle","formattedStyle","replace","propertiesWithValues","split","styleObject","forEach","propertyAndValue","separatedPropertyAndValue","renderDictionary","comment","element","properties","has","tagName","href","includes","key","startsWith","style","undefined","className","class","join","htmlFor","for","h","renderChildren","text","value","doctype","children","map","child","type","rawHTMLToJSX","htmlString","allowDangerousHtml","hast","fromHTMLStringToHast","fragment"],"sources":["src/deprecated-components/markdown/parsers/raw-html-to-jsx.tsx"],"sourcesContent":["import { h } from \"@stencil/core\";\r\nimport { fromHTMLStringToHast } from \"@genexus/markdown-parser/dist/parse-html.js\";\r\n// import { Root, RootContent, RootContentMap } from \"hast\";\r\nimport { Element as HElement, Root, RootContentMap } from \"hast\";\r\n\r\nconst tagsToSanitize = new Set([\r\n  \"base\",\r\n  \"body\",\r\n  \"embed\",\r\n  \"head\",\r\n  \"html\",\r\n  \"iframe\",\r\n  \"link\",\r\n  \"meta\",\r\n  \"object\",\r\n  \"script\",\r\n  \"style\",\r\n  \"svg\",\r\n  \"title\"\r\n]);\r\n\r\nconst LAST_SEMICOLON_AND_SPACES_IN_INLINE_STYLE = /\\s*;\\s*$/;\r\nconst SEMICOLON_AND_SPACES = /\\s*;\\s*/;\r\nconst COLON_AND_SPACES = /\\s*:\\s*/;\r\n\r\nconst getStyleObjectFromString = (\r\n  inlineStyle: string\r\n): { [key in string]: string } => {\r\n  // Remove last \" ;   \"\r\n  const formattedStyle = inlineStyle.replace(\r\n    LAST_SEMICOLON_AND_SPACES_IN_INLINE_STYLE,\r\n    \"\"\r\n  );\r\n\r\n  // [\"background-color: red\", \"color: black\", ...]\r\n  const propertiesWithValues = formattedStyle.split(SEMICOLON_AND_SPACES);\r\n  const styleObject = {};\r\n\r\n  propertiesWithValues.forEach(propertyAndValue => {\r\n    const separatedPropertyAndValue = propertyAndValue.split(COLON_AND_SPACES);\r\n    styleObject[separatedPropertyAndValue[0]] = separatedPropertyAndValue[1];\r\n  });\r\n\r\n  return styleObject;\r\n};\r\n\r\nconst renderDictionary: {\r\n  [key in keyof RootContentMap]: (element: RootContentMap[key]) => any;\r\n} = {\r\n  comment: () => \"\",\r\n  element: element => {\r\n    const properties = element.properties;\r\n\r\n    // Minimal sanitization\r\n    if (\r\n      tagsToSanitize.has(element.tagName) ||\r\n      (element.tagName === \"a\" &&\r\n        (properties.href as string)?.includes(\"javascript:\"))\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    // Remove native attr listeners\r\n    for (const key in properties) {\r\n      if (key.startsWith(\"on\")) {\r\n        delete properties[key];\r\n      }\r\n    }\r\n\r\n    // Parse style to an object\r\n    if (properties.style !== undefined) {\r\n      properties.style = getStyleObjectFromString(\r\n        properties.style as string\r\n      ) as any;\r\n    }\r\n\r\n    if (properties.className !== undefined) {\r\n      properties.class = (properties.className as string[]).join(\" \");\r\n      delete properties.className;\r\n    }\r\n\r\n    if (properties.htmlFor) {\r\n      properties.for = properties.htmlFor;\r\n      delete properties.htmlFor;\r\n    }\r\n\r\n    return (\r\n      <element.tagName {...properties}>\r\n        {renderChildren(element)}\r\n      </element.tagName>\r\n    );\r\n  },\r\n  text: element => element.value,\r\n  doctype: () => \"\"\r\n};\r\n\r\nfunction renderChildren(element: Root | HElement) {\r\n  return element.children.map(child => renderDictionary[child.type](child));\r\n}\r\n\r\nexport const rawHTMLToJSX = (\r\n  htmlString: string,\r\n  allowDangerousHtml: boolean\r\n) => {\r\n  const hast: Root = fromHTMLStringToHast(htmlString, allowDangerousHtml, {\r\n    fragment: true\r\n  });\r\n\r\n  // Render the hast as JSX\r\n  return renderChildren(hast);\r\n};\r\n"],"mappings":"gGAKA,MAAMA,EAAiB,IAAIC,IAAI,CAC7B,OACA,OACA,QACA,OACA,OACA,SACA,OACA,OACA,SACA,SACA,QACA,MACA,UAGF,MAAMC,EAA4C,WAClD,MAAMC,EAAuB,UAC7B,MAAMC,EAAmB,UAEzB,MAAMC,EACJC,IAGA,MAAMC,EAAiBD,EAAYE,QACjCN,EACA,IAIF,MAAMO,EAAuBF,EAAeG,MAAMP,GAClD,MAAMQ,EAAc,GAEpBF,EAAqBG,SAAQC,IAC3B,MAAMC,EAA4BD,EAAiBH,MAAMN,GACzDO,EAAYG,EAA0B,IAAMA,EAA0B,EAAE,IAG1E,OAAOH,CAAW,EAGpB,MAAMI,EAEF,CACFC,QAAS,IAAM,GACfC,QAASA,IACP,MAAMC,EAAaD,EAAQC,WAG3B,GACElB,EAAemB,IAAIF,EAAQG,UAC1BH,EAAQG,UAAY,KAClBF,EAAWG,MAAiBC,SAAS,eACxC,CACA,M,CAIF,IAAK,MAAMC,KAAOL,EAAY,CAC5B,GAAIK,EAAIC,WAAW,MAAO,QACjBN,EAAWK,E,EAKtB,GAAIL,EAAWO,QAAUC,UAAW,CAClCR,EAAWO,MAAQpB,EACjBa,EAAWO,M,CAIf,GAAIP,EAAWS,YAAcD,UAAW,CACtCR,EAAWU,MAASV,EAAWS,UAAuBE,KAAK,YACpDX,EAAWS,S,CAGpB,GAAIT,EAAWY,QAAS,CACtBZ,EAAWa,IAAMb,EAAWY,eACrBZ,EAAWY,O,CAGpB,OACEE,EAACf,EAAQG,QAAO,IAAKF,GAClBe,EAAehB,GACA,EAGtBiB,KAAMjB,GAAWA,EAAQkB,MACzBC,QAAS,IAAM,IAGjB,SAASH,EAAehB,GACtB,OAAOA,EAAQoB,SAASC,KAAIC,GAASxB,EAAiBwB,EAAMC,MAAMD,IACpE,C,MAEaE,EAAe,CAC1BC,EACAC,KAEA,MAAMC,EAAaC,EAAqBH,EAAYC,EAAoB,CACtEG,SAAU,OAIZ,OAAOb,EAAeW,EAAK,S"}