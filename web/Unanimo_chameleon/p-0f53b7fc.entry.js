import{r as e,c as t,g as i,h as s,H as o}from"./p-7af91c05.js";import{a as n}from"./p-a859514b.js";import{a as r,f as h}from"./p-6d91f415.js";import{S as c}from"./p-2a2bca47.js";import{K as a,S as l}from"./p-625020d1.js";import"./p-e7a788ef.js";const d="--ch-popover-separation-x";const p="--ch-popover-separation-y";const v={"outside-start":"outside-end","outside-end":"outside-start","inside-start":"inside-end","inside-end":"inside-start"};const u=(e,t,i,s)=>({start:t-(i+e+s),end:e+s});const b=e=>e.start<0||e.end<0;const f={"outside-start":(e,t,i)=>-t-i,"inside-start":(e,t,i)=>i,center:(e,t,i)=>e*.5+i-t*.5,"inside-end":(e,t,i)=>e-(i+t),"outside-end":(e,t,i)=>e+i};const g=e=>Number(e.replace("px","").trim());const m=(e,t,i,s,o,n,r)=>{const h=f[e](i,s,n);const c=u(t,o,s,h);const a=Math.min(c.start,c.end);if(!r||!b(c)){return{alignmentPosition:h,alignmentOverflow:a}}const l=v[e];const d=f[l](i,s,n);const p=u(t,o,s,d);const g=Math.min(p.start,p.end);if(!b(p)){return{alignmentPosition:d,alignmentOverflow:g}}return a<g?{alignmentPosition:d,alignmentOverflow:g}:{alignmentPosition:h,alignmentOverflow:a}};const k=(e,t,i,s,o,n,r,h,c)=>{const a=n.getPropertyValue(d);const l=n.getPropertyValue(p);const v=m(r,i,t.width,s,e.width,g(a),r!=="center"&&c==="flip-inline");const u=m(h,t.top,t.height,o,e.height,g(l),h!=="center"&&c==="flip-block");return[v,u]};const z="*,::after,::before{-webkit-box-sizing:border-box;box-sizing:border-box}:host{--ch-popover-block-size:max-content;--ch-popover-inline-size:max-content;--ch-popover-max-block-size:auto;--ch-popover-max-inline-size:auto;--ch-popover-min-block-size:auto;--ch-popover-min-inline-size:auto;--ch-popover-resize-threshold:8px;--ch-popover-separation-x:0px;--ch-popover-separation-y:0px;--ch-popover-resize-threshold--half-negative:calc(\n    var(--ch-popover-resize-threshold) * -0.5\n  );--ch-popover-border-inline-start-width:0px;--ch-popover-border-inline-end-width:0px;--ch-popover-border-block-start-width:0px;--ch-popover-border-block-end-width:0px;--ch-popover-resize__inline-start:calc(\n    var(--ch-popover-resize-threshold--half-negative) -\n      var(--ch-popover-border-inline-start-width) * 0.5\n  );--ch-popover-resize__inline-end:calc(\n    var(--ch-popover-resize-threshold--half-negative) -\n      var(--ch-popover-border-inline-end-width) * 0.5\n  );--ch-popover-resize__block-start:calc(\n    var(--ch-popover-resize-threshold--half-negative) -\n      var(--ch-popover-border-block-start-width) * 0.5\n  );--ch-popover-resize__block-end:calc(\n    var(--ch-popover-resize-threshold--half-negative) -\n      var(--ch-popover-border-block-end-width) * 0.5\n  );--ch-popover-x:calc(\n    (\n        var(--ch-popover-action-left) + var(--ch-popover-inline) +\n          var(--ch-popover-dragged-x)\n      ) * var(--ch-popover-rtl)\n  );--ch-popover-y:calc(\n    var(--ch-popover-action-top) + var(--ch-popover-block) +\n      var(--ch-popover-dragged-y)\n  );--ch-popover-dragged-x:0px;--ch-popover-dragged-y:0px;--ch-popover-rtl:1;display:none;position:fixed;inline-size:var(--ch-popover-inline-size);block-size:var(--ch-popover-block-size);min-inline-size:var(--ch-popover-min-inline-size);min-block-size:var(--ch-popover-min-block-size);max-inline-size:var(--ch-popover-forced-max-inline-size, var(--ch-popover-max-inline-size));max-block-size:var(--ch-popover-forced-max-block-size, var(--ch-popover-max-block-size));margin:0;padding:0;background-color:unset;border:unset;color:unset;overflow:visible;top:0;inset-inline-start:0;translate:var(--ch-popover-x) var(--ch-popover-y)}:host([overflow-behavior=add-scroll]){overflow:auto;translate:max(0px, var(--ch-popover-x)) max(0px, var(--ch-popover-y))}:host([show]){display:grid}:host(.gx-popover-prevent-flickering){visibility:hidden !important}:host(.gx-popover-header-drag){display:grid;grid-template-rows:-webkit-max-content 1fr;grid-template-rows:max-content 1fr}:host(.gx-popover-dragging){cursor:move}:host(.gx-popover-dragging) ::slotted(*){pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}:host(.ch-popover-resizing){pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.edge__block-start,.edge__block-end{position:fixed;inset-inline:min(0px, (var(--ch-popover-resize-threshold) - var(--ch-popover-border-inline-start-width)) / 2) min(0px, (var(--ch-popover-resize-threshold) - var(--ch-popover-border-inline-end-width)) / 2);block-size:var(--ch-popover-resize-threshold);cursor:ns-resize}.edge__inline-start,.edge__inline-end{position:fixed;inset-block:min(0px, (var(--ch-popover-resize-threshold) - var(--ch-popover-border-block-start-width)) / 2) min(0px, (var(--ch-popover-resize-threshold) - var(--ch-popover-border-block-end-width)) / 2);inline-size:var(--ch-popover-resize-threshold);cursor:ew-resize}.edge__block-start{inset-block-start:var(--ch-popover-resize__block-start)}.edge__block-end{inset-block-end:var(--ch-popover-resize__block-end)}.edge__inline-start{inset-inline-start:var(--ch-popover-resize__inline-start)}.edge__inline-end{inset-inline-end:var(--ch-popover-resize__inline-end)}.corner__block-start-inline-start,.corner__block-end-inline-end{position:fixed;block-size:var(--ch-popover-resize-threshold);inline-size:var(--ch-popover-resize-threshold);cursor:nwse-resize}.corner__block-start-inline-end,.corner__block-end-inline-start{position:fixed;block-size:var(--ch-popover-resize-threshold);inline-size:var(--ch-popover-resize-threshold);cursor:nesw-resize}.corner__block-start-inline-start{inset-block-start:var(--ch-popover-resize__block-start);inset-inline-start:var(--ch-popover-resize__inline-start)}.corner__block-end-inline-end{inset-block-end:var(--ch-popover-resize__block-end);inset-inline-end:var(--ch-popover-resize__inline-end)}.corner__block-start-inline-end{inset-block-start:var(--ch-popover-resize__block-start);inset-inline-end:var(--ch-popover-resize__inline-end)}.corner__block-end-inline-start{inset-block-end:var(--ch-popover-resize__block-end);inset-inline-start:var(--ch-popover-resize__inline-start)}:host(.ch-popover-rtl) .corner__block-start-inline-start,:host(.ch-popover-rtl) .corner__block-end-inline-end{cursor:nesw-resize}:host(.ch-popover-rtl) .corner__block-start-inline-end,:host(.ch-popover-rtl) .corner__block-end-inline-start{cursor:nwse-resize}.resize-layer{position:fixed;inset:0;pointer-events:none}";const _=z;const w="gx-popover-dragging";const x="gx-popover-prevent-flickering";const y="ch-popover-resizing";const C="--ch-popover-block";const D="--ch-popover-inline";const S="--ch-popover-action-width";const A="--ch-popover-action-height";const R="--ch-popover-action-left";const F="--ch-popover-action-top";const M="--ch-popover-dragged-x";const O="--ch-popover-dragged-y";const P="--ch-popover-block-size";const W="--ch-popover-inline-size";const E="--ch-popover-min-block-size";const B="--ch-popover-min-inline-size";const I="--ch-popover-forced-max-block-size";const j="--ch-popover-forced-max-inline-size";const N="--ch-popover-border-block-start-width";const T="--ch-popover-border-block-end-width";const q="--ch-popover-border-inline-start-width";const L="--ch-popover-border-inline-end-width";const K="ch-popover-rtl";const X="--ch-popover-rtl";const Y="-1";const H=1.5;const $=e=>document.body.style.cursor=e;const G={"block-start":()=>$("ns-resize"),"block-end":()=>$("ns-resize"),"inline-start":()=>$("ew-resize"),"inline-end":()=>$("ew-resize"),"block-start-inline-start":e=>$(e?"nesw-resize":"nwse-resize"),"block-start-inline-end":e=>$(e?"nwse-resize":"nesw-resize"),"block-end-inline-start":e=>$(e?"nwse-resize":"nesw-resize"),"block-end-inline-end":e=>$(e?"nesw-resize":"nwse-resize")};const J=(e,t,i)=>e.style.setProperty(t,`${i}px`);const Q=(e,t)=>Number((e.style.getPropertyValue(t)||"0px").replace("px",""));const U=(e,t,i)=>{if(e&&i){e.popoverTargetElement=t}};const V=e=>{if(e){e.popoverTargetElement=undefined}};const Z=class{constructor(i){e(this,i);this.popoverOpened=t(this,"popoverOpened",7);this.popoverClosed=t(this,"popoverClosed",7);this.resizing=false;this.actionById=false;this.actionElement=undefined;this.allowDrag="no";this.blockAlign="center";this.blockSizeMatch="content";this.closeOnClickOutside=false;this.firstLayer=true;this.inlineAlign="center";this.inlineSizeMatch="content";this.mode="auto";this.overflowBehavior="overflow";this.positionTry="none";this.resizable=false;this.show=false}#e;#t;#i;#s;#o=false;#n=false;#r=false;#h;#c;#a;#l=0;#d=0;#p=false;#v;#u;#b;#f;#g=0;#m=0;#k=0;#z=0;#_=0;#w=0;#x=false;#y={block:(e,t)=>{let i=this.#u.clientY-this.#v.clientY;if(t==="start"){i=-i}const s=e.height+i;const o=h(s,this.#_,this.#k);if(o===e.height){return}if(t==="start"){this.#m-=i;J(this.el,O,this.#m)}J(this.el,P,o)},inline:(e,t)=>{let i=this.#u.clientX-this.#v.clientX;if(this.#b){i=-i}if(t==="start"){i=-i}const s=e.width+i;const o=h(s,this.#w,this.#z);if(o===e.width){return}if(t==="start"){this.#g-=i;J(this.el,M,this.#g)}J(this.el,W,o)}};#C={"block-start":e=>this.#y.block(e,"start"),"block-end":e=>this.#y.block(e,"end"),"inline-start":e=>this.#y.inline(e,"start"),"inline-end":e=>this.#y.inline(e,"end"),"block-start-inline-start":e=>{this.#y.block(e,"start");this.#y.inline(e,"start")},"block-start-inline-end":e=>{this.#y.block(e,"start");this.#y.inline(e,"end")},"block-end-inline-start":e=>{this.#y.block(e,"end");this.#y.inline(e,"start")},"block-end-inline-end":e=>{this.#y.block(e,"end");this.#y.inline(e,"end")}};#D;get el(){return i(this)}handleActionChange(e,t){this.#l=0;this.#d=0;V(t);U(e,this.el,!this.actionById);this.#n=true}handleBlockChange(){this.#o=true}blockSizeWatchChange(e){if(this.#x){return}if(e==="content"){this.el.style.removeProperty(P);this.el.style.removeProperty(E)}else if(e==="action-element"){this.el.style.removeProperty(E)}else{this.el.style.removeProperty(P)}this.#o=true}handleInlineChange(){this.#o=true}inlineSizeWatchChange(e){if(this.#x){return}if(e==="content"){this.el.style.removeProperty(W);this.el.style.removeProperty(B)}else if(e==="action-element"){this.el.style.removeProperty(B)}else{this.el.style.removeProperty(W)}this.#o=true}resizableChanged(){this.#r=true}showChanged(e){this.#r=true;this.#n=true;if(e){this.#S()}else{if(this.firstLayer){this.#A(true)}this.el.hidePopover()}}popoverOpened;popoverClosed;#S=()=>{this.el.showPopover();this.#R()};#F=e=>{const t=e.composedPath();if(!t.includes(this.el)&&!t.includes(this.actionElement)){this.#M();this.show=false;this.popoverClosed.emit()}};#O=e=>{if(e.code===a.ESCAPE){this.#M();this.show=false;this.popoverClosed.emit()}};#R=()=>{if(this.mode==="manual"&&this.closeOnClickOutside){document.addEventListener("click",this.#F,{capture:true,passive:true});document.addEventListener("keydown",this.#O,{capture:true,passive:true})}};#M=()=>{document.removeEventListener("click",this.#F,{capture:true});document.removeEventListener("keydown",this.#O,{capture:true})};#P=()=>{if(!this.#p){this.el.classList.add(w);this.#p=true}};#W=()=>{this.el.classList.remove(w);this.#p=false};#A=e=>{if(e){this.el.classList.add(x)}else{this.el.classList.remove(x)}};#E=()=>{if(!this.actionElement||!this.show){this.#B();return}if(this.#c){this.#c.disconnect()}this.#i??=new c;this.#c??=new ResizeObserver((e=>{const t=e.find((e=>e.target===this.el));if(t){this.#I()}else{this.#j()}}));this.#c.observe(this.actionElement);this.#c.observe(document.body);this.#c.observe(this.el);this.#I();if(this.firstLayer){requestAnimationFrame((()=>{this.#A(false)}))}document.addEventListener("scroll",this.#j,{capture:true,passive:true})};#j=()=>{this.#i.perform(this.#I)};#I=()=>{const e=document.documentElement.getBoundingClientRect();const t=this.actionElement.getBoundingClientRect();const i={width:this.el.scrollWidth,height:this.el.scrollHeight};const s=getComputedStyle(this.el);const o=this.#N(e,t);this.#T(e,t,o,i,s);J(this.el,S,t.width);J(this.el,A,t.height);J(this.el,R,o);J(this.el,F,t.top)};#N=(e,t)=>this.#b?e.width-(t.left+t.width):t.left;#T=(e,t,i,s,o)=>{const n=this.#q(t,s);const r=this.#L(t,s);const h=k(e,t,i,n,r,o,this.inlineAlign,this.blockAlign,this.positionTry);const c=h[0].alignmentOverflow;const a=h[1].alignmentOverflow;this.#K(n,r,c,a);J(this.el,D,h[0].alignmentPosition);J(this.el,C,h[1].alignmentPosition)};#K=(e,t,i,s)=>{if(this.overflowBehavior!=="add-scroll"){return}const o=Q(this.el,j);const n=Q(this.el,I);if(i<0){const t=e+i;J(this.el,j,t)}else if(o&&e+H<o+i){this.el.style.removeProperty(j)}if(s<0){const e=t+s;J(this.el,I,e)}else if(n&&t+H<n+s){this.el.style.removeProperty(I)}};#q=(e,t)=>{if(this.inlineSizeMatch==="action-element-as-minimum"){J(this.el,B,e.width);return e.width}if(this.#x||this.inlineSizeMatch==="content"){return t.width}J(this.el,W,e.width);return e.width};#L=(e,t)=>{if(this.blockSizeMatch==="action-element-as-minimum"){J(this.el,E,e.height);return e.height}if(this.#x||this.blockSizeMatch==="content"){return t.height}J(this.el,P,e.height);return e.height};#B=()=>{if(this.#c){this.#c.disconnect();this.#c=null}document.removeEventListener("scroll",this.#j,{capture:true})};#X=e=>{const t=e.newState==="open";this.show=t;if(t){this.popoverOpened.emit()}else{this.popoverClosed.emit()}};#Y=e=>{this.#t||=new c;this.#v=e;document.addEventListener("mousemove",this.#H,{capture:true});document.addEventListener("mouseup",this.#$,{capture:true,passive:true})};#H=e=>{this.#t.perform(this.#G,(()=>{e.preventDefault();this.#P();this.#u=e}))};#G=()=>{const e=this.#u.clientX-this.#v.clientX;const t=this.#u.clientY-this.#v.clientY;if(e!==0){this.#l+=this.#b?-e:e;J(this.el,M,this.#l)}if(t!==0){this.#d+=t;J(this.el,O,this.#d)}this.#v=this.#u};#$=()=>{if(this.#t){this.#t.cancel()}document.removeEventListener("mousemove",this.#H,{capture:true});document.removeEventListener("mouseup",this.#$,{capture:true});this.#W();this.#t=null;this.#v=null;this.#u=null};#J=e=>t=>{this.resizing=true;this.#s||=new c;this.#f=e;this.#v=t;G[this.#f](this.#b);this.#g=this.#l;this.#m=this.#d;const i=getComputedStyle(this.el);this.#k=g(i.maxBlockSize);this.#z=g(i.maxInlineSize);this.#_=g(i.minBlockSize);this.#w=g(i.minInlineSize);this.#B();this.#Q();this.#M();document.addEventListener("mousemove",this.#U,{capture:true});document.addEventListener("mouseup",this.#V,{capture:true,passive:true})};#U=e=>{this.#s.perform(this.#Z,(()=>{e.preventDefault();this.#P();this.#u=e}))};#Z=()=>{const e=this.el.getBoundingClientRect();this.#C[this.#f](e);this.#x=true;this.#v=this.#u};#V=()=>{this.resizing=false;if(this.#s){this.#s.cancel()}document.body.style.cursor=null;J(this.el,M,this.#l);J(this.el,O,this.#d);this.#E();this.#ee();requestAnimationFrame(this.#R);document.removeEventListener("mousemove",this.#U,{capture:true});document.removeEventListener("mouseup",this.#V,{capture:true});this.#W();this.#s=null;this.#v=null;this.#u=null};#ee=()=>{if(!this.resizable||!this.show){this.#Q();return}this.#e??=new c;this.#h=new ResizeObserver(this.#te);this.#h.observe(this.el,{box:"border-box"});this.#h.observe(this.#D)};#te=()=>{this.#e.perform(this.#ie)};#ie=()=>{const e=getComputedStyle(this.el);this.el.style.setProperty(N,e.borderBlockStartWidth);this.el.style.setProperty(T,e.borderBlockEndWidth);this.el.style.setProperty(q,e.borderInlineStartWidth);this.el.style.setProperty(L,e.borderInlineEndWidth)};#Q=()=>{if(this.#h){this.#h.disconnect();this.#h=null}this.#e=null};connectedCallback(){n(this.el.shadowRoot.adoptedStyleSheets);this.#a=new MutationObserver((()=>{this.#b=r();if(this.#b){this.el.style.setProperty(X,Y);this.el.classList.add(K)}else{this.el.style.removeProperty(X);this.el.classList.remove(K)}}));if(this.firstLayer){this.#A(true)}this.#a.observe(document.documentElement,{attributeFilter:["dir"]})}componentWillRender(){if(this.#n){this.#n=false;this.#E()}if(this.#r){this.#r=false;requestAnimationFrame((()=>{this.#ee()}))}if(this.#o){const e=document.documentElement.getBoundingClientRect();const t=this.actionElement.getBoundingClientRect();const i={width:this.el.scrollWidth,height:this.el.scrollHeight};const s=getComputedStyle(this.el);const o=this.#N(e,t);this.#T(e,t,o,i,s)}}componentDidLoad(){U(this.actionElement,this.el,!this.actionById);this.#E();this.#ee();if(this.show){this.#S()}}disconnectedCallback(){this.#B();this.#Q();V(this.actionElement);this.#$();this.#M();if(this.#a){this.#a.disconnect();this.#a=null}}render(){const e=this.show;return s(o,{key:"116ef08dcd4c42693f7ac7a440e887ff4341ee72",class:{"gx-popover-header-drag":e&&this.allowDrag==="header",[y]:this.resizing,[l]:this.overflowBehavior==="add-scroll"},popover:this.mode,onMouseDown:e&&this.allowDrag==="box"?this.#Y:null,onToggle:this.#X},this.allowDrag==="header"&&s("div",{key:"da66171decf2a3b02d841c58edf5191479158f11",class:"header",part:"header",onMouseDown:e?this.#Y:null},s("slot",{key:"5695edbb4ea37954a68c43bec58d60bb395004c0",name:"header"})),s("slot",{key:"49a9cda20b2d803fd9dc39a91e474c4e9d056ccc"}),this.resizable&&this.show&&[s("div",{key:"f495027cdb327d905e73a1dd6b12590e31469deb",class:"edge__block-start",onMouseDown:this.#J("block-start")}),s("div",{key:"11b967c8f9c6ebdd0692ae5a48071a8bdd26fc75",class:"edge__inline-end",onMouseDown:this.#J("inline-end")}),s("div",{key:"52411732c4ad3517d5995f57b32214444edd4080",class:"edge__block-end",onMouseDown:this.#J("block-end")}),s("div",{key:"3c4b7e1936bef21d413ebfcadaf58673742af0b4",class:"edge__inline-start",onMouseDown:this.#J("inline-start")}),s("div",{key:"adbc5c7d0e2a9f4cf2d1aed8418e6f82a95a5b71",class:"corner__block-start-inline-start",onMouseDown:this.#J("block-start-inline-start")}),s("div",{key:"cf006a7ff28594420fc5f75a86db49a5d83013df",class:"corner__block-start-inline-end",onMouseDown:this.#J("block-start-inline-end")}),s("div",{key:"aa8d3c75d8ade21aa66f69b1b13743caa01cb297",class:"corner__block-end-inline-start",onMouseDown:this.#J("block-end-inline-start")}),s("div",{key:"007d408a3cc7595054bb3c015bdfb9ae3016636e",class:"corner__block-end-inline-end",onMouseDown:this.#J("block-end-inline-end")}),s("div",{key:"360cb845e5a4271cf1be1f684f36a7525741ecdd",class:"resize-layer",ref:e=>this.#D=e})])}static get watchers(){return{actionElement:["handleActionChange"],blockAlign:["handleBlockChange"],blockSizeMatch:["blockSizeWatchChange"],inlineAlign:["handleInlineChange"],inlineSizeMatch:["inlineSizeWatchChange"],resizable:["resizableChanged"],show:["showChanged"]}}};Z.style=_;export{Z as ch_popover};
//# sourceMappingURL=p-0f53b7fc.entry.js.map