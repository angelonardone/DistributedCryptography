var t=Object.defineProperty;var i=(i,e,s)=>e in i?t(i,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[e]=s;var e=(t,e,s)=>i(t,typeof e!="symbol"?e+"":e,s);function s(t,i=0){return t[t.length-(1+i)]}function n(t,i,e=((t,i)=>t===i)){if(t===i)return!0;if(!t||!i||t.length!==i.length)return!1;for(let s=0,n=t.length;s<n;s++)if(!e(t[s],i[s]))return!1;return!0}function r(t,i,e){return function(t,i){let e=0,s=t-1;for(;e<=s;){const t=(e+s)/2|0,n=i(t);if(n<0)e=t+1;else{if(!(n>0))return t;s=t-1}}return-(e+1)}(t.length,(s=>e(t[s],i)))}function o(t,i,e){if((t|=0)>=i.length)throw new TypeError("invalid index");const s=i[Math.floor(i.length*Math.random())],n=[],r=[],h=[];for(const t of i){const i=e(t,s);i<0?n.push(t):i>0?r.push(t):h.push(t)}return t<n.length?o(t,n,e):t<n.length+h.length?h[0]:o(t-(n.length+h.length),r,e)}function h(t,i){const e=[];let s;for(const n of t.slice(0).sort(i))s&&i(s[0],n)===0?s.push(n):(s=[n],e.push(s));return e}function*c(t,i){let e,s;for(const n of t)s!==void 0&&i(s,n)?e.push(n):(e&&(yield e),e=[n]),s=n;e&&(yield e)}function l(t,i){for(let e=0;e<=t.length;e++)i(e===0?void 0:t[e-1],e===t.length?void 0:t[e])}function a(t){return t.filter((t=>!!t))}function u(t){let i=0;for(let e=0;e<t.length;e++)t[e]&&(t[i]=t[e],i+=1);t.length=i}function d(t){return!Array.isArray(t)||t.length===0}function f(t){return Array.isArray(t)&&t.length>0}function g(t,i=(t=>t)){const e=new Set;return t.filter((t=>{const s=i(t);return!e.has(s)&&(e.add(s),!0)}))}function p(t,i){return t.length>0?t[0]:i}function m(t,i){let e=typeof i=="number"?t:0;typeof i=="number"?e=t:(e=0,i=t);const s=[];if(e<=i)for(let t=e;t<i;t++)s.push(t);else for(let t=e;t>i;t--)s.push(t);return s}function w(t,i,e){const s=t.slice(0,i),n=t.slice(i);return s.concat(e,n)}function v(t,i){const e=t.indexOf(i);e>-1&&(t.splice(e,1),t.unshift(i))}function b(t,i){const e=t.indexOf(i);e>-1&&(t.splice(e,1),t.push(i))}function y(t,i){for(const e of i)t.push(e)}function k(t){return Array.isArray(t)?t:[t]}function C(t,i,e,s){const n=S(t,i);let r=t.splice(n,e);return r===void 0&&(r=[]),function(t,i,e){const s=S(t,i),n=t.length,r=e.length;t.length=n+r;for(let i=n-1;i>=s;i--)t[i+r]=t[i];for(let i=0;i<r;i++)t[i+s]=e[i]}(t,n,s),r}function S(t,i){return i<0?Math.max(i+t.length,0):Math.min(i,t.length)}var x;function D(t,i){return(e,s)=>i(t(e),t(s))}(function(t){t.isLessThan=function(t){return t<0},t.isLessThanOrEqual=function(t){return t<=0},t.isGreaterThan=function(t){return t>0},t.isNeitherLessOrGreaterThan=function(t){return t===0},t.greaterThan=1,t.lessThan=-1,t.neitherLessOrGreaterThan=0})(x||(x={}));const E=(t,i)=>t-i,A=(t,i)=>E(t?1:0,i?1:0);function M(t){return(i,e)=>-t(i,e)}class L{constructor(t){this.items=t,this.firstIdx=0,this.lastIdx=this.items.length-1}get length(){return this.lastIdx-this.firstIdx+1}takeWhile(t){let i=this.firstIdx;for(;i<this.items.length&&t(this.items[i]);)i++;const e=i===this.firstIdx?null:this.items.slice(this.firstIdx,i);return this.firstIdx=i,e}takeFromEndWhile(t){let i=this.lastIdx;for(;i>=0&&t(this.items[i]);)i--;const e=i===this.lastIdx?null:this.items.slice(i+1,this.lastIdx+1);return this.lastIdx=i,e}peek(){if(this.length!==0)return this.items[this.firstIdx]}dequeue(){const t=this.items[this.firstIdx];return this.firstIdx++,t}takeCount(t){const i=this.items.slice(this.firstIdx,this.firstIdx+t);return this.firstIdx+=t,i}}class F{constructor(t){this.iterate=t}toArray(){const t=[];return this.iterate((i=>(t.push(i),!0))),t}filter(t){return new F((i=>this.iterate((e=>!t(e)||i(e)))))}map(t){return new F((i=>this.iterate((e=>i(t(e))))))}findLast(t){let i;return this.iterate((e=>(t(e)&&(i=e),!0))),i}findLastMaxBy(t){let i,e=!0;return this.iterate((s=>((e||x.isGreaterThan(t(s,i)))&&(e=!1,i=s),!0))),i}}F.empty=new F((t=>{}));class T{constructor(t){this._indexMap=t}static createSortPermutation(t,i){const e=Array.from(t.keys()).sort(((e,s)=>i(t[e],t[s])));return new T(e)}apply(t){return t.map(((i,e)=>t[this._indexMap[e]]))}inverse(){const t=this._indexMap.slice();for(let i=0;i<this._indexMap.length;i++)t[this._indexMap[i]]=i;return new T(t)}}function R(t){return typeof t=="string"}function O(t){return!(typeof t!="object"||t===null||Array.isArray(t)||t instanceof RegExp||t instanceof Date)}function I(t){const i=Object.getPrototypeOf(Uint8Array);return typeof t=="object"&&t instanceof i}function _(t){return typeof t=="number"&&!isNaN(t)}function P(t){return!!t&&typeof t[Symbol.iterator]=="function"}function N(t){return t===!0||t===!1}function B(t){return t===void 0}function $(t){return!W(t)}function W(t){return B(t)||t===null}function j(t,i){if(!t)throw new Error(i?`Unexpected type, expected '${i}'`:"Unexpected type")}function H(t){if(W(t))throw new Error("Assertion Failed: argument is undefined or null");return t}function V(t){return typeof t=="function"}function z(t,i){if(R(i)){if(typeof t!==i)throw new Error(`argument does not match constraint: typeof ${i}`)}else if(V(i)){try{if(t instanceof i)return}catch{}if(!W(t)&&t.constructor===i||i.length===1&&i.call(void 0,t)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function U(t){if(!t||typeof t!="object"||t instanceof RegExp)return t;const i=Array.isArray(t)?[]:{};return Object.entries(t).forEach((([t,e])=>{i[t]=e&&typeof e=="object"?U(e):e})),i}const K=Object.prototype.hasOwnProperty;function q(t,i){return G(t,i,new Set)}function G(t,i,e){if(W(t))return t;const s=i(t);if(s!==void 0)return s;if(Array.isArray(t)){const s=[];for(const n of t)s.push(G(n,i,e));return s}if(O(t)){if(e.has(t))throw new Error("Cannot clone recursive data-structure");e.add(t);const s={};for(const n in t)K.call(t,n)&&(s[n]=G(t[n],i,e));return e.delete(t),s}return t}function Z(t,i,e=!0){return O(t)?(O(i)&&Object.keys(i).forEach((s=>{s in t?e&&(O(t[s])&&O(i[s])?Z(t[s],i[s],e):t[s]=i[s]):t[s]=i[s]})),t):i}function J(t,i){if(t===i)return!0;if(t==null||i==null||typeof t!=typeof i||typeof t!="object"||Array.isArray(t)!==Array.isArray(i))return!1;let e,s;if(Array.isArray(t)){if(t.length!==i.length)return!1;for(e=0;e<t.length;e++)if(!J(t[e],i[e]))return!1}else{const n=[];for(s in t)n.push(s);n.sort();const r=[];for(s in i)r.push(s);if(r.sort(),!J(n,r))return!1;for(e=0;e<n.length;e++)if(!J(t[n[e]],i[n[e]]))return!1}return!0}function Q(t){const i=[];for(const e of function(t){let i=[];for(;Object.prototype!==t;)i=i.concat(Object.getOwnPropertyNames(t)),t=Object.getPrototypeOf(t);return i}(t))typeof t[e]=="function"&&i.push(e);return i}let Y=typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function X(t,i){let e;return e=i.length===0?t:t.replace(/\{(\d+)\}/g,((t,e)=>{const s=e[0],n=i[s];let r=t;return typeof n=="string"?r=n:typeof n!="number"&&typeof n!="boolean"&&n!=null||(r=String(n)),r})),Y&&(e="［"+e.replace(/[aouei]/g,"$&$&")+"］"),e}function tt(t,i,...e){return X(i,e)}function it(t,i,...e){const s=X(i,e);return{value:s,original:s}}var et,st;const nt="en";let rt,ot,ht=!1,ct=!1,lt=!1,at=!1,ut=!1,dt=!1,ft=!1,gt=nt;const pt=globalThis;let mt;pt.vscode!==void 0&&pt.vscode.process!==void 0?mt=pt.vscode.process:typeof process<"u"&&typeof((et=process==null?void 0:process.versions)===null||et===void 0?void 0:et.node)=="string"&&(mt=process);const wt=typeof((st=mt==null?void 0:mt.versions)===null||st===void 0?void 0:st.electron)=="string"&&(mt==null?void 0:mt.type)==="renderer";if(typeof mt=="object"){ht=mt.platform==="win32",ct=mt.platform==="darwin",lt=mt.platform==="linux",rt=nt,gt=nt;const t=mt.env.VSCODE_NLS_CONFIG;if(t)try{const i=JSON.parse(t),e=i.availableLanguages["*"];rt=i.locale,gt=e||nt}catch{}at=!0}else typeof navigator!="object"||wt?console.error("Unable to resolve platform."):(ot=navigator.userAgent,ht=ot.indexOf("Windows")>=0,ct=ot.indexOf("Macintosh")>=0,dt=(ot.indexOf("Macintosh")>=0||ot.indexOf("iPad")>=0||ot.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,lt=ot.indexOf("Linux")>=0,ft=(ot==null?void 0:ot.indexOf("Mobi"))>=0,ut=!0,tt(0,"_"),rt=nt,gt=rt,navigator.language);const vt=ht,bt=ct,yt=lt,kt=at,Ct=ut,St=ut&&typeof pt.importScripts=="function"?pt.origin:void 0,xt=dt,Dt=ft,Et=ot,At=gt,Mt=typeof pt.postMessage=="function"&&!pt.importScripts,Lt=(()=>{if(Mt){const t=[];pt.addEventListener("message",(i=>{if(i.data&&i.data.vscodeScheduleAsyncWork)for(let e=0,s=t.length;e<s;e++){const s=t[e];if(s.id===i.data.vscodeScheduleAsyncWork)return t.splice(e,1),void s.callback()}}));let i=0;return e=>{const s=++i;t.push({id:s,callback:e}),pt.postMessage({vscodeScheduleAsyncWork:s},"*")}}return t=>setTimeout(t)})(),Ft=ct||dt?2:ht?1:3;let Tt=!0,Rt=!1;function Ot(){if(!Rt){Rt=!0;const t=new Uint8Array(2);t[0]=1,t[1]=2,Tt=new Uint16Array(t.buffer)[0]===513}return Tt}const It=!!(Et&&Et.indexOf("Chrome")>=0),_t=!!(Et&&Et.indexOf("Firefox")>=0),Pt=!!(!It&&Et&&Et.indexOf("Safari")>=0),Nt=!!(Et&&Et.indexOf("Edg/")>=0),Bt=!!(Et&&Et.indexOf("Android")>=0),$t={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}};var Wt;(function(t){function i(t){return t&&typeof t=="object"&&typeof t[Symbol.iterator]=="function"}t.is=i;const e=Object.freeze([]);function*s(t){yield t}t.empty=function(){return e},t.single=s,t.wrap=function(t){return i(t)?t:s(t)},t.from=function(t){return t||e},t.reverse=function*(t){for(let i=t.length-1;i>=0;i--)yield t[i]},t.isEmpty=function(t){return!t||t[Symbol.iterator]().next().done===!0},t.first=function(t){return t[Symbol.iterator]().next().value},t.some=function(t,i){for(const e of t)if(i(e))return!0;return!1},t.find=function(t,i){for(const e of t)if(i(e))return e},t.filter=function*(t,i){for(const e of t)i(e)&&(yield e)},t.map=function*(t,i){let e=0;for(const s of t)yield i(s,e++)},t.concat=function*(...t){for(const i of t)yield*i},t.reduce=function(t,i,e){let s=e;for(const e of t)s=i(s,e);return s},t.slice=function*(t,i,e=t.length){for(i<0&&(i+=t.length),e<0?e+=t.length:e>t.length&&(e=t.length);i<e;i++)yield t[i]},t.consume=function(i,e=Number.POSITIVE_INFINITY){const s=[];if(e===0)return[s,i];const n=i[Symbol.iterator]();for(let i=0;i<e;i++){const i=n.next();if(i.done)return[s,t.empty()];s.push(i.value)}return[s,{[Symbol.iterator]:()=>n}]},t.asyncToArray=async function(t){const i=[];for await(const e of t)i.push(e);return Promise.resolve(i)}})(Wt||(Wt={}));let jt=class t{constructor(i){this.element=i,this.next=t.Undefined,this.prev=t.Undefined}};jt.Undefined=new jt(void 0);class Ht{constructor(){this._first=jt.Undefined,this._last=jt.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===jt.Undefined}clear(){let t=this._first;for(;t!==jt.Undefined;){const i=t.next;t.prev=jt.Undefined,t.next=jt.Undefined,t=i}this._first=jt.Undefined,this._last=jt.Undefined,this._size=0}unshift(t){return this._insert(t,!1)}push(t){return this._insert(t,!0)}_insert(t,i){const e=new jt(t);if(this._first===jt.Undefined)this._first=e,this._last=e;else if(i){const t=this._last;this._last=e,e.prev=t,t.next=e}else{const t=this._first;this._first=e,e.next=t,t.prev=e}this._size+=1;let s=!1;return()=>{s||(s=!0,this._remove(e))}}shift(){if(this._first!==jt.Undefined){const t=this._first.element;return this._remove(this._first),t}}pop(){if(this._last!==jt.Undefined){const t=this._last.element;return this._remove(this._last),t}}_remove(t){if(t.prev!==jt.Undefined&&t.next!==jt.Undefined){const i=t.prev;i.next=t.next,t.next.prev=i}else t.prev===jt.Undefined&&t.next===jt.Undefined?(this._first=jt.Undefined,this._last=jt.Undefined):t.next===jt.Undefined?(this._last=this._last.prev,this._last.next=jt.Undefined):t.prev===jt.Undefined&&(this._first=this._first.next,this._first.prev=jt.Undefined);this._size-=1}*[Symbol.iterator](){let t=this._first;for(;t!==jt.Undefined;)yield t.element,t=t.next}}const Vt="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?",zt=function(t=""){let i="(-?\\d*\\.\\d\\w*)|([^";for(const e of Vt)t.indexOf(e)>=0||(i+="\\"+e);return i+="\\s]+)",new RegExp(i,"g")}();function Ut(t){let i=zt;if(t&&t instanceof RegExp)if(t.global)i=t;else{let e="g";t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),i=new RegExp(t.source,e)}return i.lastIndex=0,i}const Kt=new Ht;function qt(t,i,e,s,n){if(i=Ut(i),n||(n=Wt.first(Kt)),e.length>n.maxLen){let r=t-n.maxLen/2;return r<0?r=0:s+=r,qt(t,i,e=e.substring(r,t+n.maxLen/2),s,n)}const r=Date.now(),o=t-1-s;let h=-1,c=null;for(let t=1;!(Date.now()-r>=n.timeBudget);t++){const s=o-n.windowSize*t;i.lastIndex=Math.max(0,s);const r=Gt(i,e,o,h);if(!r&&c||(c=r,s<=0))break;h=s}if(c){const t={word:c[0],startColumn:s+1+c.index,endColumn:s+1+c.index+c[0].length};return i.lastIndex=0,t}return null}function Gt(t,i,e,s){let n;for(;n=t.exec(i);){const i=n.index||0;if(i<=e&&t.lastIndex>=e)return n;if(s>0&&i>s)return null}return null}Kt.unshift({maxLen:1e3,windowSize:15,timeBudget:150});class Zt{constructor(t){this._values=t}hasChanged(t){return this._values[t]}}class Jt{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}}class Qt{constructor(t,i,e,s){this.id=t,this.name=i,this.defaultValue=e,this.schema=s}applyUpdate(t,i){return Xt(t,i)}compute(t,i,e){return e}}class Yt{constructor(t,i){this.newValue=t,this.didChange=i}}function Xt(t,i){if(typeof t!="object"||typeof i!="object"||!t||!i)return new Yt(i,t!==i);if(Array.isArray(t)||Array.isArray(i)){const e=Array.isArray(t)&&Array.isArray(i)&&n(t,i);return new Yt(i,!e)}let e=!1;for(const s in i)if(i.hasOwnProperty(s)){const n=Xt(t[s],i[s]);n.didChange&&(t[s]=n.newValue,e=!0)}return new Yt(t,e)}class ti{constructor(t){this.schema=void 0,this.id=t,this.name="_never_",this.defaultValue=void 0}applyUpdate(t,i){return Xt(t,i)}validate(t){return this.defaultValue}}class ii{constructor(t,i,e,s){this.id=t,this.name=i,this.defaultValue=e,this.schema=s}applyUpdate(t,i){return Xt(t,i)}validate(t){return t===void 0?this.defaultValue:t}compute(t,i,e){return e}}function ei(t,i){return t===void 0?i:t!=="false"&&!!t}class si extends ii{constructor(t,i,e,s=void 0){s!==void 0&&(s.type="boolean",s.default=e),super(t,i,e,s)}validate(t){return ei(t,this.defaultValue)}}function ni(t,i,e,s){if(t===void 0)return i;let n=parseInt(t,10);return isNaN(n)?i:(n=Math.max(e,n),n=Math.min(s,n),0|n)}class ri extends ii{static clampedInt(t,i,e,s){return ni(t,i,e,s)}constructor(t,i,e,s,n,r=void 0){r!==void 0&&(r.type="integer",r.default=e,r.minimum=s,r.maximum=n),super(t,i,e,r),this.minimum=s,this.maximum=n}validate(t){return ri.clampedInt(t,this.defaultValue,this.minimum,this.maximum)}}function oi(t,i,e,s){if(t===void 0)return i;const n=hi.float(t,i);return hi.clamp(n,e,s)}class hi extends ii{static clamp(t,i,e){return t<i?i:t>e?e:t}static float(t,i){if(typeof t=="number")return t;if(t===void 0)return i;const e=parseFloat(t);return isNaN(e)?i:e}constructor(t,i,e,s,n){n!==void 0&&(n.type="number",n.default=e),super(t,i,e,n),this.validationFn=s}validate(t){return this.validationFn(hi.float(t,this.defaultValue))}}class ci extends ii{static string(t,i){return typeof t!="string"?i:t}constructor(t,i,e,s=void 0){s!==void 0&&(s.type="string",s.default=e),super(t,i,e,s)}validate(t){return ci.string(t,this.defaultValue)}}function li(t,i,e,s){return typeof t!="string"?i:s&&t in s?s[t]:e.indexOf(t)===-1?i:t}class ai extends ii{constructor(t,i,e,s,n=void 0){n!==void 0&&(n.type="string",n.enum=s,n.default=e),super(t,i,e,n),this._allowedValues=s}validate(t){return li(t,this.defaultValue,this._allowedValues)}}class ui extends Qt{constructor(t,i,e,s,n,r,o=void 0){o!==void 0&&(o.type="string",o.enum=n,o.default=s),super(t,i,e,o),this._allowedValues=n,this._convert=r}validate(t){return typeof t!="string"||this._allowedValues.indexOf(t)===-1?this.defaultValue:this._convert(t)}}var di,fi;(function(t){t[t.Line=1]="Line",t[t.Block=2]="Block",t[t.Underline=3]="Underline",t[t.LineThin=4]="LineThin",t[t.BlockOutline=5]="BlockOutline",t[t.UnderlineThin=6]="UnderlineThin"})(di||(di={}));class gi extends Qt{constructor(){super(51,"fontLigatures",gi.OFF,{anyOf:[{type:"boolean",description:tt(0,"Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:tt(0,"Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:tt(0,"Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(t){return t===void 0?this.defaultValue:typeof t=="string"?t==="false"||t.length===0?gi.OFF:t==="true"?gi.ON:t:t?gi.ON:gi.OFF}}gi.OFF='"liga" off, "calt" off',gi.ON='"liga" on, "calt" on';class pi extends Qt{constructor(){super(54,"fontVariations",pi.OFF,{anyOf:[{type:"boolean",description:tt(0,"Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:tt(0,"Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:tt(0,"Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(t){return t===void 0?this.defaultValue:typeof t=="string"?t==="false"?pi.OFF:t==="true"?pi.TRANSLATE:t:t?pi.TRANSLATE:pi.OFF}compute(t,i,e){return t.fontInfo.fontVariationSettings}}pi.OFF="normal",pi.TRANSLATE="translate";class mi extends Qt{constructor(){super(53,"fontWeight",Li.fontWeight,{anyOf:[{type:"number",minimum:mi.MINIMUM_VALUE,maximum:mi.MAXIMUM_VALUE,errorMessage:tt(0,'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:mi.SUGGESTION_VALUES}],default:Li.fontWeight,description:tt(0,'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(t){return t==="normal"||t==="bold"?t:String(ri.clampedInt(t,Li.fontWeight,mi.MINIMUM_VALUE,mi.MAXIMUM_VALUE))}}mi.SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"],mi.MINIMUM_VALUE=1,mi.MAXIMUM_VALUE=1e3;class wi extends ti{constructor(){super(145)}compute(t,i,e){return wi.computeLayout(i,{memory:t.memory,outerWidth:t.outerWidth,outerHeight:t.outerHeight,isDominatedByLongLines:t.isDominatedByLongLines,lineHeight:t.fontInfo.lineHeight,viewLineCount:t.viewLineCount,lineNumbersDigitCount:t.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:t.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:t.fontInfo.maxDigitWidth,pixelRatio:t.pixelRatio,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(t){const i=t.height/t.lineHeight,e=Math.floor(t.paddingTop/t.lineHeight);let s=Math.floor(t.paddingBottom/t.lineHeight);t.scrollBeyondLastLine&&(s=Math.max(s,i-1));const n=(e+t.viewLineCount+s)/(t.pixelRatio*t.height);return{typicalViewportLineCount:i,extraLinesBeforeFirstLine:e,extraLinesBeyondLastLine:s,desiredRatio:n,minimapLineCount:Math.floor(t.viewLineCount/n)}}static _computeMinimapLayout(t,i){const e=t.outerWidth,s=t.outerHeight,n=t.pixelRatio;if(!t.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(n*s),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:s};const r=i.stableMinimapLayoutInput,o=r&&t.outerHeight===r.outerHeight&&t.lineHeight===r.lineHeight&&t.typicalHalfwidthCharacterWidth===r.typicalHalfwidthCharacterWidth&&t.pixelRatio===r.pixelRatio&&t.scrollBeyondLastLine===r.scrollBeyondLastLine&&t.paddingTop===r.paddingTop&&t.paddingBottom===r.paddingBottom&&t.minimap.enabled===r.minimap.enabled&&t.minimap.side===r.minimap.side&&t.minimap.size===r.minimap.size&&t.minimap.showSlider===r.minimap.showSlider&&t.minimap.renderCharacters===r.minimap.renderCharacters&&t.minimap.maxColumn===r.minimap.maxColumn&&t.minimap.scale===r.minimap.scale&&t.verticalScrollbarWidth===r.verticalScrollbarWidth&&t.isViewportWrapping===r.isViewportWrapping,h=t.lineHeight,c=t.typicalHalfwidthCharacterWidth,l=t.scrollBeyondLastLine,a=t.minimap.renderCharacters;let u=n>=2?Math.round(2*t.minimap.scale):t.minimap.scale;const d=t.minimap.maxColumn,f=t.minimap.size,g=t.minimap.side,p=t.verticalScrollbarWidth,m=t.viewLineCount,w=t.remainingWidth,v=t.isViewportWrapping,b=a?2:3;let y=Math.floor(n*s);const k=y/n;let C=!1,S=!1,x=b*u,D=u/n,E=1;if(f==="fill"||f==="fit"){const{typicalViewportLineCount:e,extraLinesBeforeFirstLine:r,extraLinesBeyondLastLine:c,desiredRatio:a,minimapLineCount:d}=wi.computeContainedMinimapLineCount({viewLineCount:m,scrollBeyondLastLine:l,paddingTop:t.paddingTop,paddingBottom:t.paddingBottom,height:s,lineHeight:h,pixelRatio:n});if(m/d>1)C=!0,S=!0,u=1,x=1,D=u/n;else{let s=!1,l=u+1;if(f==="fit"){const t=Math.ceil((r+m+c)*x);v&&o&&w<=i.stableFitRemainingWidth?(s=!0,l=i.stableFitMaxMinimapScale):s=t>y}if(f==="fill"||s){C=!0;const s=u;x=Math.min(h*n,Math.max(1,Math.floor(1/a))),v&&o&&w<=i.stableFitRemainingWidth&&(l=i.stableFitMaxMinimapScale),u=Math.min(l,Math.max(1,Math.floor(x/b))),u>s&&(E=Math.min(2,u/s)),D=u/n/E,y=Math.ceil(Math.max(e,r+m+c)*x),v?(i.stableMinimapLayoutInput=t,i.stableFitRemainingWidth=w,i.stableFitMaxMinimapScale=u):(i.stableMinimapLayoutInput=null,i.stableFitRemainingWidth=0)}}}const A=Math.floor(d*D),M=Math.min(A,Math.max(0,Math.floor((w-p-2)*D/(c+D)))+8);let L=Math.floor(n*M);const F=L/n;return L=Math.floor(L*E),{renderMinimap:a?1:2,minimapLeft:g==="left"?0:e-M-p,minimapWidth:M,minimapHeightIsEditorHeight:C,minimapIsSampling:S,minimapScale:u,minimapLineHeight:x,minimapCanvasInnerWidth:L,minimapCanvasInnerHeight:y,minimapCanvasOuterWidth:F,minimapCanvasOuterHeight:k}}static computeLayout(t,i){const e=0|i.outerWidth,s=0|i.outerHeight,n=0|i.lineHeight,r=0|i.lineNumbersDigitCount,o=i.typicalHalfwidthCharacterWidth,h=i.maxDigitWidth,c=i.pixelRatio,l=i.viewLineCount,a=t.get(137),u=a==="inherit"?t.get(136):a,d=u==="inherit"?t.get(132):u,f=t.get(135),g=i.isDominatedByLongLines,p=t.get(57),m=t.get(68).renderType!==0,w=t.get(69),v=t.get(105),b=t.get(84),y=t.get(73),k=t.get(103),C=k.verticalScrollbarSize,S=k.verticalHasArrows,x=k.arrowSize,D=k.horizontalScrollbarSize,E=t.get(43),A=t.get(110)!=="never";let M=t.get(66);E&&A&&(M+=16);let L=0;if(m){const t=Math.max(r,w);L=Math.round(t*h)}let F=0;p&&(F=n*i.glyphMarginDecorationLaneCount);let T=0,R=T+F,O=R+L,I=O+M;const _=e-F-L-M;let P=!1,N=!1,B=-1;u==="inherit"&&g?(P=!0,N=!0):d==="on"||d==="bounded"?N=!0:d==="wordWrapColumn"&&(B=f);const $=wi._computeMinimapLayout({outerWidth:e,outerHeight:s,lineHeight:n,typicalHalfwidthCharacterWidth:o,pixelRatio:c,scrollBeyondLastLine:v,paddingTop:b.top,paddingBottom:b.bottom,minimap:y,verticalScrollbarWidth:C,viewLineCount:l,remainingWidth:_,isViewportWrapping:N},i.memory||new Jt);$.renderMinimap!==0&&$.minimapLeft===0&&(T+=$.minimapWidth,R+=$.minimapWidth,O+=$.minimapWidth,I+=$.minimapWidth);const W=_-$.minimapWidth,j=Math.max(1,Math.floor((W-C-2)/o)),H=S?x:0;return N&&(B=Math.max(1,j),d==="bounded"&&(B=Math.min(B,f))),{width:e,height:s,glyphMarginLeft:T,glyphMarginWidth:F,glyphMarginDecorationLaneCount:i.glyphMarginDecorationLaneCount,lineNumbersLeft:R,lineNumbersWidth:L,decorationsLeft:O,decorationsWidth:M,contentLeft:I,contentWidth:W,minimap:$,viewportColumn:j,isWordWrapMinified:P,isViewportWrapping:N,wrappingColumn:B,verticalScrollbarWidth:C,horizontalScrollbarHeight:D,overviewRuler:{top:H,width:C,height:s-2*H,right:0}}}}(function(t){t.Off="off",t.OnCode="onCode",t.On="on"})(fi||(fi={}));function vi(t){const i=t.get(98);return i==="editable"?t.get(91):i!=="on"}function bi(t,i){if(typeof t!="string")return i;switch(t){case"hidden":return 2;case"visible":return 3;default:return 1}}const yi="inUntrustedWorkspace",ki="editor.unicodeHighlight.allowedCharacters",Ci="editor.unicodeHighlight.invisibleCharacters",Si="editor.unicodeHighlight.nonBasicASCII",xi="editor.unicodeHighlight.ambiguousCharacters",Di="editor.unicodeHighlight.includeComments",Ei="editor.unicodeHighlight.includeStrings",Ai="editor.unicodeHighlight.allowedLocales";function Mi(t,i,e){const s=e.indexOf(t);return s===-1?i:e[s]}const Li={fontFamily:bt?"Menlo, Monaco, 'Courier New', monospace":yt?"'Droid Sans Mono', 'monospace', monospace":"Consolas, 'Courier New', monospace",fontWeight:"normal",fontSize:bt?12:14,lineHeight:0,letterSpacing:0},Fi=[];function Ti(t){return Fi[t.id]=t,t}const Ri={acceptSuggestionOnCommitCharacter:Ti(new si(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:tt(0,"Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:Ti(new ai(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",tt(0,"Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:tt(0,"Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:Ti(new class extends Qt{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[tt(0,"Use platform APIs to detect when a Screen Reader is attached."),tt(0,"Optimize for usage with a Screen Reader."),tt(0,"Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:tt(0,"Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(t){switch(t){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(t,i,e){return e===0?t.accessibilitySupport:e}}),accessibilityPageSize:Ti(new ri(3,"accessibilityPageSize",10,1,1073741824,{description:tt(0,"Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),ariaLabel:Ti(new ci(4,"ariaLabel",tt(0,"Editor content"))),ariaRequired:Ti(new si(5,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:Ti(new si(8,"screenReaderAnnounceInlineSuggestion",!0,{description:tt(0,"Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),autoClosingBrackets:Ti(new ai(6,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",tt(0,"Use language configurations to determine when to autoclose brackets."),tt(0,"Autoclose brackets only when the cursor is to the left of whitespace."),""],description:tt(0,"Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingComments:Ti(new ai(7,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",tt(0,"Use language configurations to determine when to autoclose comments."),tt(0,"Autoclose comments only when the cursor is to the left of whitespace."),""],description:tt(0,"Controls whether the editor should automatically close comments after the user adds an opening comment.")})),autoClosingDelete:Ti(new ai(9,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",tt(0,"Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:tt(0,"Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:Ti(new ai(10,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",tt(0,"Type over closing quotes or brackets only if they were automatically inserted."),""],description:tt(0,"Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:Ti(new ai(11,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",tt(0,"Use language configurations to determine when to autoclose quotes."),tt(0,"Autoclose quotes only when the cursor is to the left of whitespace."),""],description:tt(0,"Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:Ti(new ui(12,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],(function(t){switch(t){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}),{enumDescriptions:[tt(0,"The editor will not insert indentation automatically."),tt(0,"The editor will keep the current line's indentation."),tt(0,"The editor will keep the current line's indentation and honor language defined brackets."),tt(0,"The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),tt(0,"The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:tt(0,"Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),automaticLayout:Ti(new si(13,"automaticLayout",!1)),autoSurround:Ti(new ai(14,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[tt(0,"Use language configurations to determine when to automatically surround selections."),tt(0,"Surround with quotes but not brackets."),tt(0,"Surround with brackets but not quotes."),""],description:tt(0,"Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:Ti(new class extends Qt{constructor(){const t={enabled:$t.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:$t.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(15,"bracketPairColorization",t,{"editor.bracketPairColorization.enabled":{type:"boolean",default:t.enabled,markdownDescription:tt(0,"Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:t.independentColorPoolPerBracketType,description:tt(0,"Controls whether each bracket type has its own independent color pool.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;const i=t;return{enabled:ei(i.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:ei(i.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}}),bracketPairGuides:Ti(new class extends Qt{constructor(){const t={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(16,"guides",t,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[tt(0,"Enables bracket pair guides."),tt(0,"Enables bracket pair guides only for the active bracket pair."),tt(0,"Disables bracket pair guides.")],default:t.bracketPairs,description:tt(0,"Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[tt(0,"Enables horizontal guides as addition to vertical bracket pair guides."),tt(0,"Enables horizontal guides only for the active bracket pair."),tt(0,"Disables horizontal bracket pair guides.")],default:t.bracketPairsHorizontal,description:tt(0,"Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:t.highlightActiveBracketPair,description:tt(0,"Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:t.indentation,description:tt(0,"Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[tt(0,"Highlights the active indent guide."),tt(0,"Highlights the active indent guide even if bracket guides are highlighted."),tt(0,"Do not highlight the active indent guide.")],default:t.highlightActiveIndentation,description:tt(0,"Controls whether the editor should highlight the active indent guide.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;const i=t;return{bracketPairs:Mi(i.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:Mi(i.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:ei(i.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:ei(i.indentation,this.defaultValue.indentation),highlightActiveIndentation:Mi(i.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}}),stickyTabStops:Ti(new si(116,"stickyTabStops",!1,{description:tt(0,"Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:Ti(new si(17,"codeLens",!0,{description:tt(0,"Controls whether the editor shows CodeLens.")})),codeLensFontFamily:Ti(new ci(18,"codeLensFontFamily","",{description:tt(0,"Controls the font family for CodeLens.")})),codeLensFontSize:Ti(new ri(19,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:tt(0,"Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),colorDecorators:Ti(new si(20,"colorDecorators",!0,{description:tt(0,"Controls whether the editor should render the inline color decorators and color picker.")})),colorDecoratorActivatedOn:Ti(new ai(148,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[tt(0,"Make the color picker appear both on click and hover of the color decorator"),tt(0,"Make the color picker appear on hover of the color decorator"),tt(0,"Make the color picker appear on click of the color decorator")],description:tt(0,"Controls the condition to make a color picker appear from a color decorator")})),colorDecoratorsLimit:Ti(new ri(21,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:tt(0,"Controls the max number of color decorators that can be rendered in an editor at once.")})),columnSelection:Ti(new si(22,"columnSelection",!1,{description:tt(0,"Enable that the selection with the mouse and keys is doing column selection.")})),comments:Ti(new class extends Qt{constructor(){const t={insertSpace:!0,ignoreEmptyLines:!0};super(23,"comments",t,{"editor.comments.insertSpace":{type:"boolean",default:t.insertSpace,description:tt(0,"Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:t.ignoreEmptyLines,description:tt(0,"Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;const i=t;return{insertSpace:ei(i.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:ei(i.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}}),contextmenu:Ti(new si(24,"contextmenu",!0)),copyWithSyntaxHighlighting:Ti(new si(25,"copyWithSyntaxHighlighting",!0,{description:tt(0,"Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:Ti(new ui(26,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],(function(t){switch(t){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}),{description:tt(0,"Control the cursor animation style.")})),cursorSmoothCaretAnimation:Ti(new ai(27,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[tt(0,"Smooth caret animation is disabled."),tt(0,"Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),tt(0,"Smooth caret animation is always enabled.")],description:tt(0,"Controls whether the smooth caret animation should be enabled.")})),cursorStyle:Ti(new ui(28,"cursorStyle",di.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],(function(t){switch(t){case"line":return di.Line;case"block":return di.Block;case"underline":return di.Underline;case"line-thin":return di.LineThin;case"block-outline":return di.BlockOutline;case"underline-thin":return di.UnderlineThin}}),{description:tt(0,"Controls the cursor style.")})),cursorSurroundingLines:Ti(new ri(29,"cursorSurroundingLines",0,0,1073741824,{description:tt(0,"Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:Ti(new ai(30,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[tt(0,"`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),tt(0,"`cursorSurroundingLines` is enforced always.")],markdownDescription:tt(0,"Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),cursorWidth:Ti(new ri(31,"cursorWidth",0,0,1073741824,{markdownDescription:tt(0,"Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),disableLayerHinting:Ti(new si(32,"disableLayerHinting",!1)),disableMonospaceOptimizations:Ti(new si(33,"disableMonospaceOptimizations",!1)),domReadOnly:Ti(new si(34,"domReadOnly",!1)),dragAndDrop:Ti(new si(35,"dragAndDrop",!0,{description:tt(0,"Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:Ti(new class extends si{constructor(){super(37,"emptySelectionClipboard",!0,{description:tt(0,"Controls whether copying without a selection copies the current line.")})}compute(t,i,e){return e&&t.emptySelectionClipboard}}),dropIntoEditor:Ti(new class extends Qt{constructor(){const t={enabled:!0,showDropSelector:"afterDrop"};super(36,"dropIntoEditor",t,{"editor.dropIntoEditor.enabled":{type:"boolean",default:t.enabled,markdownDescription:tt(0,"Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:tt(0,"Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[tt(0,"Show the drop selector widget after a file is dropped into the editor."),tt(0,"Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;const i=t;return{enabled:ei(i.enabled,this.defaultValue.enabled),showDropSelector:li(i.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}}),stickyScroll:Ti(new class extends Qt{constructor(){const t={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(115,"stickyScroll",t,{"editor.stickyScroll.enabled":{type:"boolean",default:t.enabled,description:tt(0,"Shows the nested current scopes during the scroll at the top of the editor."),tags:["experimental"]},"editor.stickyScroll.maxLineCount":{type:"number",default:t.maxLineCount,minimum:1,maximum:20,description:tt(0,"Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:t.defaultModel,description:tt(0,"Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:t.scrollWithEditor,description:tt(0,"Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;const i=t;return{enabled:ei(i.enabled,this.defaultValue.enabled),maxLineCount:ri.clampedInt(i.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:li(i.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:ei(i.scrollWithEditor,this.defaultValue.scrollWithEditor)}}}),experimentalWhitespaceRendering:Ti(new ai(38,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[tt(0,"Use a new rendering method with svgs."),tt(0,"Use a new rendering method with font characters."),tt(0,"Use the stable rendering method.")],description:tt(0,"Controls whether whitespace is rendered with a new, experimental method.")})),extraEditorClassName:Ti(new ci(39,"extraEditorClassName","")),fastScrollSensitivity:Ti(new hi(40,"fastScrollSensitivity",5,(t=>t<=0?5:t),{markdownDescription:tt(0,"Scrolling speed multiplier when pressing `Alt`.")})),find:Ti(new class extends Qt{constructor(){const t={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(41,"find",t,{"editor.find.cursorMoveOnType":{type:"boolean",default:t.cursorMoveOnType,description:tt(0,"Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:t.seedSearchStringFromSelection,enumDescriptions:[tt(0,"Never seed search string from the editor selection."),tt(0,"Always seed search string from the editor selection, including word at cursor position."),tt(0,"Only seed search string from the editor selection.")],description:tt(0,"Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:t.autoFindInSelection,enumDescriptions:[tt(0,"Never turn on Find in Selection automatically (default)."),tt(0,"Always turn on Find in Selection automatically."),tt(0,"Turn on Find in Selection automatically when multiple lines of content are selected.")],description:tt(0,"Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:t.globalFindClipboard,description:tt(0,"Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:bt},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:t.addExtraSpaceOnTop,description:tt(0,"Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:t.loop,description:tt(0,"Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;const i=t;return{cursorMoveOnType:ei(i.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof t.seedSearchStringFromSelection=="boolean"?t.seedSearchStringFromSelection?"always":"never":li(i.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof t.autoFindInSelection=="boolean"?t.autoFindInSelection?"always":"never":li(i.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:ei(i.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:ei(i.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:ei(i.loop,this.defaultValue.loop)}}}),fixedOverflowWidgets:Ti(new si(42,"fixedOverflowWidgets",!1)),folding:Ti(new si(43,"folding",!0,{description:tt(0,"Controls whether the editor has code folding enabled.")})),foldingStrategy:Ti(new ai(44,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[tt(0,"Use a language-specific folding strategy if available, else the indentation-based one."),tt(0,"Use the indentation-based folding strategy.")],description:tt(0,"Controls the strategy for computing folding ranges.")})),foldingHighlight:Ti(new si(45,"foldingHighlight",!0,{description:tt(0,"Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:Ti(new si(46,"foldingImportsByDefault",!1,{description:tt(0,"Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:Ti(new ri(47,"foldingMaximumRegions",5e3,10,65e3,{description:tt(0,"The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:Ti(new si(48,"unfoldOnClickAfterEndOfLine",!1,{description:tt(0,"Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:Ti(new ci(49,"fontFamily",Li.fontFamily,{description:tt(0,"Controls the font family.")})),fontInfo:Ti(new class extends ti{constructor(){super(50)}compute(t,i,e){return t.fontInfo}}),fontLigatures2:Ti(new gi),fontSize:Ti(new class extends ii{constructor(){super(52,"fontSize",Li.fontSize,{type:"number",minimum:6,maximum:100,default:Li.fontSize,description:tt(0,"Controls the font size in pixels.")})}validate(t){const i=hi.float(t,this.defaultValue);return i===0?Li.fontSize:hi.clamp(i,6,100)}compute(t,i,e){return t.fontInfo.fontSize}}),fontWeight:Ti(new mi),fontVariations:Ti(new pi),formatOnPaste:Ti(new si(55,"formatOnPaste",!1,{description:tt(0,"Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:Ti(new si(56,"formatOnType",!1,{description:tt(0,"Controls whether the editor should automatically format the line after typing.")})),glyphMargin:Ti(new si(57,"glyphMargin",!0,{description:tt(0,"Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:Ti(new class extends Qt{constructor(){const t={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:""},i={type:"string",enum:["peek","gotoAndPeek","goto"],default:t.multiple,enumDescriptions:[tt(0,"Show Peek view of the results (default)"),tt(0,"Go to the primary result and show a Peek view"),tt(0,"Go to the primary result and enable Peek-less navigation to others")]},e=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(58,"gotoLocation",t,{"editor.gotoLocation.multiple":{deprecationMessage:tt(0,"This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:tt(0,"Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...i},"editor.gotoLocation.multipleTypeDefinitions":{description:tt(0,"Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...i},"editor.gotoLocation.multipleDeclarations":{description:tt(0,"Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...i},"editor.gotoLocation.multipleImplementations":{description:tt(0,"Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...i},"editor.gotoLocation.multipleReferences":{description:tt(0,"Controls the behavior the 'Go to References'-command when multiple target locations exist."),...i},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:t.alternativeDefinitionCommand,enum:e,description:tt(0,"Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:t.alternativeTypeDefinitionCommand,enum:e,description:tt(0,"Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:t.alternativeDeclarationCommand,enum:e,description:tt(0,"Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:t.alternativeImplementationCommand,enum:e,description:tt(0,"Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:t.alternativeReferenceCommand,enum:e,description:tt(0,"Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(t){var i,e,s,n,r;if(!t||typeof t!="object")return this.defaultValue;const o=t;return{multiple:li(o.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:(i=o.multipleDefinitions)!==null&&i!==void 0?i:li(o.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:(e=o.multipleTypeDefinitions)!==null&&e!==void 0?e:li(o.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:(s=o.multipleDeclarations)!==null&&s!==void 0?s:li(o.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:(n=o.multipleImplementations)!==null&&n!==void 0?n:li(o.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:(r=o.multipleReferences)!==null&&r!==void 0?r:li(o.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:ci.string(o.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:ci.string(o.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:ci.string(o.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:ci.string(o.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:ci.string(o.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand)}}}),hideCursorInOverviewRuler:Ti(new si(59,"hideCursorInOverviewRuler",!1,{description:tt(0,"Controls whether the cursor should be hidden in the overview ruler.")})),hover:Ti(new class extends Qt{constructor(){const t={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(60,"hover",t,{"editor.hover.enabled":{type:"boolean",default:t.enabled,description:tt(0,"Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:t.delay,minimum:0,maximum:1e4,description:tt(0,"Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:t.sticky,description:tt(0,"Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:t.hidingDelay,description:tt(0,"Controls the delay in milliseconds after which the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:"boolean",default:t.above,description:tt(0,"Prefer showing hovers above the line, if there's space.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;const i=t;return{enabled:ei(i.enabled,this.defaultValue.enabled),delay:ri.clampedInt(i.delay,this.defaultValue.delay,0,1e4),sticky:ei(i.sticky,this.defaultValue.sticky),hidingDelay:ri.clampedInt(i.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:ei(i.above,this.defaultValue.above)}}}),inDiffEditor:Ti(new si(61,"inDiffEditor",!1)),letterSpacing:Ti(new hi(64,"letterSpacing",Li.letterSpacing,(t=>hi.clamp(t,-5,20)),{description:tt(0,"Controls the letter spacing in pixels.")})),lightbulb:Ti(new class extends Qt{constructor(){const t={enabled:fi.On};super(65,"lightbulb",t,{"editor.lightbulb.enabled":{type:"string",tags:["experimental"],enum:[fi.Off,fi.OnCode,fi.On],default:t.enabled,enumDescriptions:[tt(0,"Disable the code action menu."),tt(0,"Show the code action menu when the cursor is on lines with code."),tt(0,"Show the code action menu when the cursor is on lines with code or on empty lines.")],description:tt(0,"Enables the Code Action lightbulb in the editor.")}})}validate(t){return!t||typeof t!="object"?this.defaultValue:{enabled:li(t.enabled,this.defaultValue.enabled,[fi.Off,fi.OnCode,fi.On])}}}),lineDecorationsWidth:Ti(new class extends Qt{constructor(){super(66,"lineDecorationsWidth",10)}validate(t){return typeof t=="string"&&/^\d+(\.\d+)?ch$/.test(t)?-parseFloat(t.substring(0,t.length-2)):ri.clampedInt(t,this.defaultValue,0,1e3)}compute(t,i,e){return e<0?ri.clampedInt(-e*t.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):e}}),lineHeight:Ti(new class extends hi{constructor(){super(67,"lineHeight",Li.lineHeight,(t=>hi.clamp(t,0,150)),{markdownDescription:tt(0,`Controls the line height. \n - Use 0 to automatically compute the line height from the font size.\n - Values between 0 and 8 will be used as a multiplier with the font size.\n - Values greater than or equal to 8 will be used as effective values.`)})}compute(t,i,e){return t.fontInfo.lineHeight}}),lineNumbers:Ti(new class extends Qt{constructor(){super(68,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[tt(0,"Line numbers are not rendered."),tt(0,"Line numbers are rendered as absolute number."),tt(0,"Line numbers are rendered as distance in lines to cursor position."),tt(0,"Line numbers are rendered every 10 lines.")],default:"on",description:tt(0,"Controls the display of line numbers.")})}validate(t){let i=this.defaultValue.renderType,e=this.defaultValue.renderFn;return t!==void 0&&(typeof t=="function"?(i=4,e=t):i=t==="interval"?3:t==="relative"?2:t==="on"?1:0),{renderType:i,renderFn:e}}}),lineNumbersMinChars:Ti(new ri(69,"lineNumbersMinChars",5,1,300)),linkedEditing:Ti(new si(70,"linkedEditing",!1,{description:tt(0,"Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),links:Ti(new si(71,"links",!0,{description:tt(0,"Controls whether the editor should detect links and make them clickable.")})),matchBrackets:Ti(new ai(72,"matchBrackets","always",["always","near","never"],{description:tt(0,"Highlight matching brackets.")})),minimap:Ti(new class extends Qt{constructor(){const t={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,sectionHeaderFontSize:9};super(73,"minimap",t,{"editor.minimap.enabled":{type:"boolean",default:t.enabled,description:tt(0,"Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:t.autohide,description:tt(0,"Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[tt(0,"The minimap has the same size as the editor contents (and might scroll)."),tt(0,"The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),tt(0,"The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:t.size,description:tt(0,"Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:t.side,description:tt(0,"Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:t.showSlider,description:tt(0,"Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:t.scale,minimum:1,maximum:3,enum:[1,2,3],description:tt(0,"Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:t.renderCharacters,description:tt(0,"Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:t.maxColumn,description:tt(0,"Limit the width of the minimap to render at most a certain number of columns.")},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:t.showRegionSectionHeaders,description:tt(0,"Controls whether named regions are shown as section headers in the minimap.")},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:t.showMarkSectionHeaders,description:tt(0,"Controls whether MARK: comments are shown as section headers in the minimap.")},"editor.minimap.sectionHeaderFontSize":{type:"number",default:t.sectionHeaderFontSize,description:tt(0,"Controls the font size of section headers in the minimap.")}})}validate(t){var i;if(!t||typeof t!="object")return this.defaultValue;const e=t;return{enabled:ei(e.enabled,this.defaultValue.enabled),autohide:ei(e.autohide,this.defaultValue.autohide),size:li(e.size,this.defaultValue.size,["proportional","fill","fit"]),side:li(e.side,this.defaultValue.side,["right","left"]),showSlider:li(e.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:ei(e.renderCharacters,this.defaultValue.renderCharacters),scale:ri.clampedInt(e.scale,1,1,3),maxColumn:ri.clampedInt(e.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:ei(e.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:ei(e.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),sectionHeaderFontSize:hi.clamp((i=e.sectionHeaderFontSize)!==null&&i!==void 0?i:this.defaultValue.sectionHeaderFontSize,4,32)}}}),mouseStyle:Ti(new ai(74,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:Ti(new hi(75,"mouseWheelScrollSensitivity",1,(t=>t===0?1:t),{markdownDescription:tt(0,"A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:Ti(new si(76,"mouseWheelZoom",!1,{markdownDescription:tt(0,bt?"Zoom the font of the editor when using mouse wheel and holding `Cmd`.":"Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:Ti(new si(77,"multiCursorMergeOverlapping",!0,{description:tt(0,"Merge multiple cursors when they are overlapping.")})),multiCursorModifier:Ti(new ui(78,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],(function(t){return t==="ctrlCmd"?bt?"metaKey":"ctrlKey":"altKey"}),{markdownEnumDescriptions:[tt(0,"Maps to `Control` on Windows and Linux and to `Command` on macOS."),tt(0,"Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:tt(0,"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),multiCursorPaste:Ti(new ai(79,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[tt(0,"Each cursor pastes a single line of the text."),tt(0,"Each cursor pastes the full text.")],markdownDescription:tt(0,"Controls pasting when the line count of the pasted text matches the cursor count.")})),multiCursorLimit:Ti(new ri(80,"multiCursorLimit",1e4,1,1e5,{markdownDescription:tt(0,"Controls the max number of cursors that can be in an active editor at once.")})),occurrencesHighlight:Ti(new ai(81,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[tt(0,"Does not highlight occurrences."),tt(0,"Highlights occurrences only in the current file."),tt(0,"Experimental: Highlights occurrences across all valid open files.")],markdownDescription:tt(0,"Controls whether occurrences should be highlighted across open files.")})),overviewRulerBorder:Ti(new si(82,"overviewRulerBorder",!0,{description:tt(0,"Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:Ti(new ri(83,"overviewRulerLanes",3,0,3)),padding:Ti(new class extends Qt{constructor(){super(84,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:tt(0,"Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:tt(0,"Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;const i=t;return{top:ri.clampedInt(i.top,0,0,1e3),bottom:ri.clampedInt(i.bottom,0,0,1e3)}}}),pasteAs:Ti(new class extends Qt{constructor(){const t={enabled:!0,showPasteSelector:"afterPaste"};super(85,"pasteAs",t,{"editor.pasteAs.enabled":{type:"boolean",default:t.enabled,markdownDescription:tt(0,"Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:tt(0,"Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[tt(0,"Show the paste selector widget after content is pasted into the editor."),tt(0,"Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;const i=t;return{enabled:ei(i.enabled,this.defaultValue.enabled),showPasteSelector:li(i.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}}),parameterHints:Ti(new class extends Qt{constructor(){const t={enabled:!0,cycle:!0};super(86,"parameterHints",t,{"editor.parameterHints.enabled":{type:"boolean",default:t.enabled,description:tt(0,"Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:t.cycle,description:tt(0,"Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;const i=t;return{enabled:ei(i.enabled,this.defaultValue.enabled),cycle:ei(i.cycle,this.defaultValue.cycle)}}}),peekWidgetDefaultFocus:Ti(new ai(87,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[tt(0,"Focus the tree when opening peek"),tt(0,"Focus the editor when opening peek")],description:tt(0,"Controls whether to focus the inline editor or the tree in the peek widget.")})),definitionLinkOpensInPeek:Ti(new si(88,"definitionLinkOpensInPeek",!1,{description:tt(0,"Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:Ti(new class extends Qt{constructor(){const t={other:"on",comments:"off",strings:"off"},i=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[tt(0,"Quick suggestions show inside the suggest widget"),tt(0,"Quick suggestions show as ghost text"),tt(0,"Quick suggestions are disabled")]}];super(89,"quickSuggestions",t,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:i,default:t.strings,description:tt(0,"Enable quick suggestions inside strings.")},comments:{anyOf:i,default:t.comments,description:tt(0,"Enable quick suggestions inside comments.")},other:{anyOf:i,default:t.other,description:tt(0,"Enable quick suggestions outside of strings and comments.")}},default:t,markdownDescription:tt(0,"Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the '{0}'-setting which controls if suggestions are triggered by special characters.","#editor.suggestOnTriggerCharacters#")}),this.defaultValue=t}validate(t){if(typeof t=="boolean"){const i=t?"on":"off";return{comments:i,strings:i,other:i}}if(!t||typeof t!="object")return this.defaultValue;const{other:i,comments:e,strings:s}=t,n=["on","inline","off"];let r,o,h;return r=typeof i=="boolean"?i?"on":"off":li(i,this.defaultValue.other,n),o=typeof e=="boolean"?e?"on":"off":li(e,this.defaultValue.comments,n),h=typeof s=="boolean"?s?"on":"off":li(s,this.defaultValue.strings,n),{other:r,comments:o,strings:h}}}),quickSuggestionsDelay:Ti(new ri(90,"quickSuggestionsDelay",10,0,1073741824,{description:tt(0,"Controls the delay in milliseconds after which quick suggestions will show up.")})),readOnly:Ti(new si(91,"readOnly",!1)),readOnlyMessage:Ti(new class extends Qt{constructor(){super(92,"readOnlyMessage",void 0)}validate(t){return t&&typeof t=="object"?t:this.defaultValue}}),renameOnType:Ti(new si(93,"renameOnType",!1,{description:tt(0,"Controls whether the editor auto renames on type."),markdownDeprecationMessage:tt(0,"Deprecated, use `editor.linkedEditing` instead.")})),renderControlCharacters:Ti(new si(94,"renderControlCharacters",!0,{description:tt(0,"Controls whether the editor should render control characters."),restricted:!0})),renderFinalNewline:Ti(new ai(95,"renderFinalNewline",yt?"dimmed":"on",["off","on","dimmed"],{description:tt(0,"Render last line number when the file ends with a newline.")})),renderLineHighlight:Ti(new ai(96,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",tt(0,"Highlights both the gutter and the current line.")],description:tt(0,"Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:Ti(new si(97,"renderLineHighlightOnlyWhenFocus",!1,{description:tt(0,"Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:Ti(new ai(98,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:Ti(new ai(99,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",tt(0,"Render whitespace characters except for single spaces between words."),tt(0,"Render whitespace characters only on selected text."),tt(0,"Render only trailing whitespace characters."),""],description:tt(0,"Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:Ti(new ri(100,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:Ti(new si(101,"roundedSelection",!0,{description:tt(0,"Controls whether selections should have rounded corners.")})),rulers:Ti(new class extends Qt{constructor(){const t=[],i={type:"number",description:tt(0,"Number of monospace characters at which this editor ruler will render.")};super(102,"rulers",t,{type:"array",items:{anyOf:[i,{type:["object"],properties:{column:i,color:{type:"string",description:tt(0,"Color of this editor ruler."),format:"color-hex"}}}]},default:t,description:tt(0,"Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(t){if(Array.isArray(t)){const i=[];for(const e of t)if(typeof e=="number")i.push({column:ri.clampedInt(e,0,0,1e4),color:null});else if(e&&typeof e=="object"){const t=e;i.push({column:ri.clampedInt(t.column,0,0,1e4),color:t.color})}return i.sort(((t,i)=>t.column-i.column)),i}return this.defaultValue}}),scrollbar:Ti(new class extends Qt{constructor(){const t={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(103,"scrollbar",t,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[tt(0,"The vertical scrollbar will be visible only when necessary."),tt(0,"The vertical scrollbar will always be visible."),tt(0,"The vertical scrollbar will always be hidden.")],default:"auto",description:tt(0,"Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[tt(0,"The horizontal scrollbar will be visible only when necessary."),tt(0,"The horizontal scrollbar will always be visible."),tt(0,"The horizontal scrollbar will always be hidden.")],default:"auto",description:tt(0,"Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:t.verticalScrollbarSize,description:tt(0,"The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:t.horizontalScrollbarSize,description:tt(0,"The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:t.scrollByPage,description:tt(0,"Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:t.ignoreHorizontalScrollbarInContentHeight,description:tt(0,"When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;const i=t,e=ri.clampedInt(i.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),s=ri.clampedInt(i.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:ri.clampedInt(i.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:bi(i.vertical,this.defaultValue.vertical),horizontal:bi(i.horizontal,this.defaultValue.horizontal),useShadows:ei(i.useShadows,this.defaultValue.useShadows),verticalHasArrows:ei(i.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:ei(i.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:ei(i.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:ei(i.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:e,horizontalSliderSize:ri.clampedInt(i.horizontalSliderSize,e,0,1e3),verticalScrollbarSize:s,verticalSliderSize:ri.clampedInt(i.verticalSliderSize,s,0,1e3),scrollByPage:ei(i.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:ei(i.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}}),scrollBeyondLastColumn:Ti(new ri(104,"scrollBeyondLastColumn",4,0,1073741824,{description:tt(0,"Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:Ti(new si(105,"scrollBeyondLastLine",!0,{description:tt(0,"Controls whether the editor will scroll beyond the last line.")})),scrollPredominantAxis:Ti(new si(106,"scrollPredominantAxis",!0,{description:tt(0,"Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:Ti(new si(107,"selectionClipboard",!0,{description:tt(0,"Controls whether the Linux primary clipboard should be supported."),included:yt})),selectionHighlight:Ti(new si(108,"selectionHighlight",!0,{description:tt(0,"Controls whether the editor should highlight matches similar to the selection.")})),selectOnLineNumbers:Ti(new si(109,"selectOnLineNumbers",!0)),showFoldingControls:Ti(new ai(110,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[tt(0,"Always show the folding controls."),tt(0,"Never show the folding controls and reduce the gutter size."),tt(0,"Only show the folding controls when the mouse is over the gutter.")],description:tt(0,"Controls when the folding controls on the gutter are shown.")})),showUnused:Ti(new si(111,"showUnused",!0,{description:tt(0,"Controls fading out of unused code.")})),showDeprecated:Ti(new si(140,"showDeprecated",!0,{description:tt(0,"Controls strikethrough deprecated variables.")})),inlayHints:Ti(new class extends Qt{constructor(){const t={enabled:"on",fontSize:0,fontFamily:"",padding:!1};super(141,"inlayHints",t,{"editor.inlayHints.enabled":{type:"string",default:t.enabled,description:tt(0,"Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[tt(0,"Inlay hints are enabled"),tt(0,"Inlay hints are showing by default and hide when holding {0}",bt?"Ctrl+Option":"Ctrl+Alt"),tt(0,"Inlay hints are hidden by default and show when holding {0}",bt?"Ctrl+Option":"Ctrl+Alt"),tt(0,"Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:t.fontSize,markdownDescription:tt(0,"Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:t.fontFamily,markdownDescription:tt(0,"Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:t.padding,description:tt(0,"Enables the padding around the inlay hints in the editor.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;const i=t;return typeof i.enabled=="boolean"&&(i.enabled=i.enabled?"on":"off"),{enabled:li(i.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:ri.clampedInt(i.fontSize,this.defaultValue.fontSize,0,100),fontFamily:ci.string(i.fontFamily,this.defaultValue.fontFamily),padding:ei(i.padding,this.defaultValue.padding)}}}),snippetSuggestions:Ti(new ai(112,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[tt(0,"Show snippet suggestions on top of other suggestions."),tt(0,"Show snippet suggestions below other suggestions."),tt(0,"Show snippets suggestions with other suggestions."),tt(0,"Do not show snippet suggestions.")],description:tt(0,"Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:Ti(new class extends Qt{constructor(){super(113,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:tt(0,"Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:tt(0,"Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(t){return t&&typeof t=="object"?{selectLeadingAndTrailingWhitespace:ei(t.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:ei(t.selectSubwords,this.defaultValue.selectSubwords)}:this.defaultValue}}),smoothScrolling:Ti(new si(114,"smoothScrolling",!1,{description:tt(0,"Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:Ti(new ri(117,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:Ti(new class extends Qt{constructor(){const t={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(118,"suggest",t,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[tt(0,"Insert suggestion without overwriting text right of the cursor."),tt(0,"Insert suggestion and overwrite text right of the cursor.")],default:t.insertMode,description:tt(0,"Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:t.filterGraceful,description:tt(0,"Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:t.localityBonus,description:tt(0,"Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:t.shareSuggestSelections,markdownDescription:tt(0,"Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[tt(0,"Always select a suggestion when automatically triggering IntelliSense."),tt(0,"Never select a suggestion when automatically triggering IntelliSense."),tt(0,"Select a suggestion only when triggering IntelliSense from a trigger character."),tt(0,"Select a suggestion only when triggering IntelliSense as you type.")],default:t.selectionMode,markdownDescription:tt(0,"Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions (`#editor.quickSuggestions#` and `#editor.suggestOnTriggerCharacters#`) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:t.snippetsPreventQuickSuggestions,description:tt(0,"Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:t.showIcons,description:tt(0,"Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:t.showStatusBar,description:tt(0,"Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:t.preview,description:tt(0,"Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:t.showInlineDetails,description:tt(0,"Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:tt(0,"This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:tt(0,"This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:tt(0,"When enabled IntelliSense shows `issues`-suggestions.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;const i=t;return{insertMode:li(i.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:ei(i.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:ei(i.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:ei(i.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:ei(i.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:li(i.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:ei(i.showIcons,this.defaultValue.showIcons),showStatusBar:ei(i.showStatusBar,this.defaultValue.showStatusBar),preview:ei(i.preview,this.defaultValue.preview),previewMode:li(i.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:ei(i.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:ei(i.showMethods,this.defaultValue.showMethods),showFunctions:ei(i.showFunctions,this.defaultValue.showFunctions),showConstructors:ei(i.showConstructors,this.defaultValue.showConstructors),showDeprecated:ei(i.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:ei(i.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:ei(i.showFields,this.defaultValue.showFields),showVariables:ei(i.showVariables,this.defaultValue.showVariables),showClasses:ei(i.showClasses,this.defaultValue.showClasses),showStructs:ei(i.showStructs,this.defaultValue.showStructs),showInterfaces:ei(i.showInterfaces,this.defaultValue.showInterfaces),showModules:ei(i.showModules,this.defaultValue.showModules),showProperties:ei(i.showProperties,this.defaultValue.showProperties),showEvents:ei(i.showEvents,this.defaultValue.showEvents),showOperators:ei(i.showOperators,this.defaultValue.showOperators),showUnits:ei(i.showUnits,this.defaultValue.showUnits),showValues:ei(i.showValues,this.defaultValue.showValues),showConstants:ei(i.showConstants,this.defaultValue.showConstants),showEnums:ei(i.showEnums,this.defaultValue.showEnums),showEnumMembers:ei(i.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:ei(i.showKeywords,this.defaultValue.showKeywords),showWords:ei(i.showWords,this.defaultValue.showWords),showColors:ei(i.showColors,this.defaultValue.showColors),showFiles:ei(i.showFiles,this.defaultValue.showFiles),showReferences:ei(i.showReferences,this.defaultValue.showReferences),showFolders:ei(i.showFolders,this.defaultValue.showFolders),showTypeParameters:ei(i.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:ei(i.showSnippets,this.defaultValue.showSnippets),showUsers:ei(i.showUsers,this.defaultValue.showUsers),showIssues:ei(i.showIssues,this.defaultValue.showIssues)}}}),inlineSuggest:Ti(new class extends Qt{constructor(){const t={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default"};super(62,"inlineSuggest",t,{"editor.inlineSuggest.enabled":{type:"boolean",default:t.enabled,description:tt(0,"Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:t.showToolbar,enum:["always","onHover","never"],enumDescriptions:[tt(0,"Show the inline suggestion toolbar whenever an inline suggestion is shown."),tt(0,"Show the inline suggestion toolbar when hovering over an inline suggestion."),tt(0,"Never show the inline suggestion toolbar.")],description:tt(0,"Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:t.suppressSuggestions,description:tt(0,"Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.fontFamily":{type:"string",default:t.fontFamily,description:tt(0,"Controls the font family of the inline suggestions.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;const i=t;return{enabled:ei(i.enabled,this.defaultValue.enabled),mode:li(i.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:li(i.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:ei(i.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:ei(i.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:ci.string(i.fontFamily,this.defaultValue.fontFamily)}}}),inlineEdit:Ti(new class extends Qt{constructor(){const t={enabled:!1,showToolbar:"onHover",fontFamily:"default",keepOnBlur:!1,backgroundColoring:!1};super(63,"experimentalInlineEdit",t,{"editor.experimentalInlineEdit.enabled":{type:"boolean",default:t.enabled,description:tt(0,"Controls whether to show inline edits in the editor.")},"editor.experimentalInlineEdit.showToolbar":{type:"string",default:t.showToolbar,enum:["always","onHover","never"],enumDescriptions:[tt(0,"Show the inline edit toolbar whenever an inline suggestion is shown."),tt(0,"Show the inline edit toolbar when hovering over an inline suggestion."),tt(0,"Never show the inline edit toolbar.")],description:tt(0,"Controls when to show the inline edit toolbar.")},"editor.experimentalInlineEdit.fontFamily":{type:"string",default:t.fontFamily,description:tt(0,"Controls the font family of the inline edit.")},"editor.experimentalInlineEdit.backgroundColoring":{type:"boolean",default:t.backgroundColoring,description:tt(0,"Controls whether to color the background of inline edits.")}})}validate(t){if(!t||typeof t!="object")return this.defaultValue;const i=t;return{enabled:ei(i.enabled,this.defaultValue.enabled),showToolbar:li(i.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),fontFamily:ci.string(i.fontFamily,this.defaultValue.fontFamily),keepOnBlur:ei(i.keepOnBlur,this.defaultValue.keepOnBlur),backgroundColoring:ei(i.backgroundColoring,this.defaultValue.backgroundColoring)}}}),inlineCompletionsAccessibilityVerbose:Ti(new si(149,"inlineCompletionsAccessibilityVerbose",!1,{description:tt(0,"Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),suggestFontSize:Ti(new ri(119,"suggestFontSize",0,0,1e3,{markdownDescription:tt(0,"Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),suggestLineHeight:Ti(new ri(120,"suggestLineHeight",0,0,1e3,{markdownDescription:tt(0,"Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:Ti(new si(121,"suggestOnTriggerCharacters",!0,{description:tt(0,"Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:Ti(new ai(122,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[tt(0,"Always select the first suggestion."),tt(0,"Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),tt(0,"Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:tt(0,"Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:Ti(new ai(123,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[tt(0,"Tab complete will insert the best matching suggestion when pressing tab."),tt(0,"Disable tab completions."),tt(0,"Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:tt(0,"Enables tab completions.")})),tabIndex:Ti(new ri(124,"tabIndex",0,-1,1073741824)),unicodeHighlight:Ti(new class extends Qt{constructor(){const t={nonBasicASCII:yi,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:yi,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(125,"unicodeHighlight",t,{[Si]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,yi],default:t.nonBasicASCII,description:tt(0,"Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[Ci]:{restricted:!0,type:"boolean",default:t.invisibleCharacters,description:tt(0,"Controls whether characters that just reserve space or have no width at all are highlighted.")},[xi]:{restricted:!0,type:"boolean",default:t.ambiguousCharacters,description:tt(0,"Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[Di]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,yi],default:t.includeComments,description:tt(0,"Controls whether characters in comments should also be subject to Unicode highlighting.")},[Ei]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,yi],default:t.includeStrings,description:tt(0,"Controls whether characters in strings should also be subject to Unicode highlighting.")},[ki]:{restricted:!0,type:"object",default:t.allowedCharacters,description:tt(0,"Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[Ai]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:t.allowedLocales,description:tt(0,"Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(t,i){let e=!1;i.allowedCharacters&&t&&(J(t.allowedCharacters,i.allowedCharacters)||(t={...t,allowedCharacters:i.allowedCharacters},e=!0)),i.allowedLocales&&t&&(J(t.allowedLocales,i.allowedLocales)||(t={...t,allowedLocales:i.allowedLocales},e=!0));const s=super.applyUpdate(t,i);return e?new Yt(s.newValue,!0):s}validate(t){if(!t||typeof t!="object")return this.defaultValue;const i=t;return{nonBasicASCII:Mi(i.nonBasicASCII,yi,[!0,!1,yi]),invisibleCharacters:ei(i.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:ei(i.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:Mi(i.includeComments,yi,[!0,!1,yi]),includeStrings:Mi(i.includeStrings,yi,[!0,!1,yi]),allowedCharacters:this.validateBooleanMap(t.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(t.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(t,i){if(typeof t!="object"||!t)return i;const e={};for(const[i,s]of Object.entries(t))s===!0&&(e[i]=!0);return e}}),unusualLineTerminators:Ti(new ai(126,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[tt(0,"Unusual line terminators are automatically removed."),tt(0,"Unusual line terminators are ignored."),tt(0,"Unusual line terminators prompt to be removed.")],description:tt(0,"Remove unusual line terminators that might cause problems.")})),useShadowDOM:Ti(new si(127,"useShadowDOM",!0)),useTabStops:Ti(new si(128,"useTabStops",!0,{description:tt(0,"Spaces and tabs are inserted and deleted in alignment with tab stops.")})),wordBreak:Ti(new ai(129,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[tt(0,"Use the default line break rule."),tt(0,"Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:tt(0,"Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),wordSegmenterLocales:Ti(new class extends Qt{constructor(){super(130,"wordSegmenterLocales",[],{anyOf:[{description:tt(0,"Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"string"},{description:tt(0,"Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"array",items:{type:"string"}}]})}validate(t){if(typeof t=="string"&&(t=[t]),Array.isArray(t)){const i=[];for(const e of t)if(typeof e=="string")try{Intl.Segmenter.supportedLocalesOf(e).length>0&&i.push(e)}catch{}return i}return this.defaultValue}}),wordSeparators:Ti(new ci(131,"wordSeparators",Vt,{description:tt(0,"Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:Ti(new ai(132,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[tt(0,"Lines will never wrap."),tt(0,"Lines will wrap at the viewport width."),tt(0,"Lines will wrap at `#editor.wordWrapColumn#`."),tt(0,"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:tt(0,"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:Ti(new ci(133,"wordWrapBreakAfterCharacters"," \t})]?|/&.,;¢°′″‰℃、。｡､￠，．：；？！％・･ゝゞヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻ｧｨｩｪｫｬｭｮｯｰ”〉》」』】〕）］｝｣")),wordWrapBreakBeforeCharacters:Ti(new ci(134,"wordWrapBreakBeforeCharacters","([{‘“〈《「『【〔（［｛｢£¥＄￡￥+＋")),wordWrapColumn:Ti(new ri(135,"wordWrapColumn",80,1,1073741824,{markdownDescription:tt(0,"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:Ti(new ai(136,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:Ti(new ai(137,"wordWrapOverride2","inherit",["off","on","inherit"])),editorClassName:Ti(new class extends ti{constructor(){super(142)}compute(t,i,e){const s=["monaco-editor"];return i.get(39)&&s.push(i.get(39)),t.extraEditorClassName&&s.push(t.extraEditorClassName),i.get(74)==="default"?s.push("mouse-default"):i.get(74)==="copy"&&s.push("mouse-copy"),i.get(111)&&s.push("showUnused"),i.get(140)&&s.push("showDeprecated"),s.join(" ")}}),defaultColorDecorators:Ti(new si(147,"defaultColorDecorators",!1,{markdownDescription:tt(0,"Controls whether inline color decorations should be shown using the default document color provider")})),pixelRatio:Ti(new class extends ti{constructor(){super(143)}compute(t,i,e){return t.pixelRatio}}),tabFocusMode:Ti(new si(144,"tabFocusMode",!1,{markdownDescription:tt(0,"Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),layoutInfo:Ti(new wi),wrappingInfo:Ti(new class extends ti{constructor(){super(146)}compute(t,i,e){const s=i.get(145);return{isDominatedByLongLines:t.isDominatedByLongLines,isWordWrapMinified:s.isWordWrapMinified,isViewportWrapping:s.isViewportWrapping,wrappingColumn:s.wrappingColumn}}}),wrappingIndent:Ti(new class extends Qt{constructor(){super(138,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[tt(0,"No indentation. Wrapped lines begin at column 1."),tt(0,"Wrapped lines get the same indentation as the parent."),tt(0,"Wrapped lines get +1 indentation toward the parent."),tt(0,"Wrapped lines get +2 indentation toward the parent.")],description:tt(0,"Controls the indentation of wrapped lines."),default:"same"}})}validate(t){switch(t){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(t,i,e){return i.get(2)===2?0:e}}),wrappingStrategy:Ti(new class extends Qt{constructor(){super(139,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[tt(0,"Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),tt(0,"Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:tt(0,"Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(t){return li(t,"simple",["simple","advanced"])}compute(t,i,e){return i.get(2)===2?"advanced":e}})},Oi=new class{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(t){setTimeout((()=>{throw t.stack?Vi.isErrorNoTelemetry(t)?new Vi(t.message+`\n\n`+t.stack):new Error(t.message+`\n\n`+t.stack):t}),0)}}emit(t){this.listeners.forEach((i=>{i(t)}))}onUnexpectedError(t){this.unexpectedErrorHandler(t),this.emit(t)}onUnexpectedExternalError(t){this.unexpectedErrorHandler(t)}};function Ii(t){Bi(t)||Oi.onUnexpectedError(t)}function _i(t){Bi(t)||Oi.onUnexpectedExternalError(t)}function Pi(t){if(t instanceof Error){const{name:i,message:e}=t;return{$isError:!0,name:i,message:e,stack:t.stacktrace||t.stack,noTelemetry:Vi.isErrorNoTelemetry(t)}}return t}const Ni="Canceled";function Bi(t){return t instanceof $i||t instanceof Error&&t.name===Ni&&t.message===Ni}class $i extends Error{constructor(){super(Ni),this.name=this.message}}function Wi(t){return t?new Error(`Illegal argument: ${t}`):new Error("Illegal argument")}function ji(t){return t?new Error(`Illegal state: ${t}`):new Error("Illegal state")}class Hi extends Error{constructor(t){super("NotSupported"),t&&(this.message=t)}}class Vi extends Error{constructor(t){super(t),this.name="CodeExpectedError"}static fromError(t){if(t instanceof Vi)return t;const i=new Vi;return i.message=t.message,i.stack=t.stack,i}static isErrorNoTelemetry(t){return t.name==="CodeExpectedError"}}class zi extends Error{constructor(t){super(t||"An unexpected bug occurred."),Object.setPrototypeOf(this,zi.prototype)}}function Ui(t,i){const e=this;let s,n=!1;return function(){return n||(n=!0,s=t.apply(e,arguments)),s}}function Ki(t){return typeof t.dispose=="function"&&t.dispose.length===0}function qi(t){if(Wt.is(t)){const i=[];for(const e of t)if(e)try{e.dispose()}catch(t){i.push(t)}if(i.length===1)throw i[0];if(i.length>1)throw new AggregateError(i,"Encountered errors while disposing of store");return Array.isArray(t)?[]:t}if(t)return t.dispose(),t}function Gi(...t){return Zi((()=>qi(t)))}function Zi(t){return{dispose:Ui((()=>{t()}))}}class Ji{constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{qi(this._toDispose)}finally{this._toDispose.clear()}}add(t){if(!t)return t;if(t===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?Ji.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(t),t}deleteAndLeak(t){t&&this._toDispose.has(t)&&this._toDispose.delete(t)}}Ji.DISABLE_DISPOSED_WARNING=!1;class Qi{constructor(){this._store=new Ji}dispose(){this._store.dispose()}_register(t){if(t===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(t)}}Qi.None=Object.freeze({dispose(){}});class Yi{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(t){var i;this._isDisposed||t===this._value||((i=this._value)===null||i===void 0||i.dispose(),this._value=t)}clear(){this.value=void 0}dispose(){var t;this._isDisposed=!0,(t=this._value)===null||t===void 0||t.dispose(),this._value=void 0}}class Xi{constructor(t){this._disposable=t,this._counter=1}acquire(){return this._counter++,this}release(){return--this._counter==0&&this._disposable.dispose(),this}}class te{constructor(t){this.object=t}dispose(){}}class ie{constructor(){this._store=new Map,this._isDisposed=!1}dispose(){this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{qi(this._store.values())}finally{this._store.clear()}}get(t){return this._store.get(t)}set(t,i,e=!1){var s;this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),e||(s=this._store.get(t))===null||s===void 0||s.dispose(),this._store.set(t,i)}deleteAndDispose(t){var i;(i=this._store.get(t))===null||i===void 0||i.dispose(),this._store.delete(t)}[Symbol.iterator](){return this._store[Symbol.iterator]()}}const ee=globalThis.performance&&typeof globalThis.performance.now=="function";class se{static create(t){return new se(t)}constructor(t){this._now=ee&&t===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}}var ne;(function(t){function i(t){return(i,e=null,s)=>{let n,r=!1;return n=t((t=>{if(!r)return n?n.dispose():r=!0,i.call(e,t)}),null,s),r&&n.dispose(),n}}function e(t,i,e){return n(((e,s=null,n)=>t((t=>e.call(s,i(t))),null,n)),e)}function s(t,i,e){return n(((e,s=null,n)=>t((t=>i(t)&&e.call(s,t)),null,n)),e)}function n(t,i){let e;const s=new le({onWillAddFirstListener(){e=t(s.fire,s)},onDidRemoveLastListener(){e==null||e.dispose()}});return i==null||i.add(s),s.event}function r(t,i,e=100,s=!1,n=!1,r,o){let h,c,l,a,u=0;const d=new le({leakWarningThreshold:r,onWillAddFirstListener(){h=t((t=>{u++,c=i(c,t),s&&!l&&(d.fire(c),c=void 0),a=()=>{const t=c;c=void 0,l=void 0,(!s||u>1)&&d.fire(t),u=0},typeof e=="number"?(clearTimeout(l),l=setTimeout(a,e)):l===void 0&&(l=0,queueMicrotask(a))}))},onWillRemoveListener(){n&&u>0&&(a==null||a())},onDidRemoveLastListener(){a=void 0,h.dispose()}});return o==null||o.add(d),d.event}t.None=()=>Qi.None,t.defer=function(t,i){return r(t,(()=>{}),0,void 0,!0,void 0,i)},t.once=i,t.map=e,t.forEach=function(t,i,e){return n(((e,s=null,n)=>t((t=>{i(t),e.call(s,t)}),null,n)),e)},t.filter=s,t.signal=function(t){return t},t.any=function(...t){return(i,e=null,s)=>function(t,i){return i instanceof Array?i.push(t):i&&i.add(t),t}(Gi(...t.map((t=>t((t=>i.call(e,t)))))),s)},t.reduce=function(t,i,s,n){let r=s;return e(t,(t=>(r=i(r,t),r)),n)},t.debounce=r,t.accumulate=function(i,e=0,s){return t.debounce(i,((t,i)=>t?(t.push(i),t):[i]),e,void 0,!0,void 0,s)},t.latch=function(t,i=((t,i)=>t===i),e){let n,r=!0;return s(t,(t=>{const e=r||!i(t,n);return r=!1,n=t,e}),e)},t.split=function(i,e,s){return[t.filter(i,e,s),t.filter(i,(t=>!e(t)),s)]},t.buffer=function(t,i=!1,e=[],s){let n=e.slice(),r=t((t=>{n?n.push(t):h.fire(t)}));s&&s.add(r);const o=()=>{n==null||n.forEach((t=>h.fire(t))),n=null},h=new le({onWillAddFirstListener(){r||(r=t((t=>h.fire(t))),s&&s.add(r))},onDidAddFirstListener(){n&&(i?setTimeout(o):o())},onDidRemoveLastListener(){r&&r.dispose(),r=null}});return s&&s.add(h),h.event},t.chain=function(t,i){return(e,s,n)=>{const r=i(new h);return t((function(t){const i=r.evaluate(t);i!==o&&e.call(s,i)}),void 0,n)}};const o=Symbol("HaltChainable");class h{constructor(){this.steps=[]}map(t){return this.steps.push(t),this}forEach(t){return this.steps.push((i=>(t(i),i))),this}filter(t){return this.steps.push((i=>t(i)?i:o)),this}reduce(t,i){let e=i;return this.steps.push((i=>(e=t(e,i),e))),this}latch(t=((t,i)=>t===i)){let i,e=!0;return this.steps.push((s=>{const n=e||!t(s,i);return e=!1,i=s,n?s:o})),this}evaluate(t){for(const i of this.steps)if((t=i(t))===o)break;return t}}t.fromNodeEventEmitter=function(t,i,e=(t=>t)){const s=(...t)=>n.fire(e(...t)),n=new le({onWillAddFirstListener:()=>t.on(i,s),onDidRemoveLastListener:()=>t.removeListener(i,s)});return n.event},t.fromDOMEventEmitter=function(t,i,e=(t=>t)){const s=(...t)=>n.fire(e(...t)),n=new le({onWillAddFirstListener:()=>t.addEventListener(i,s),onDidRemoveLastListener:()=>t.removeEventListener(i,s)});return n.event},t.toPromise=function(t){return new Promise((e=>i(t)(e)))},t.fromPromise=function(t){const i=new le;return t.then((t=>{i.fire(t)}),(()=>{i.fire(void 0)})).finally((()=>{i.dispose()})),i.event},t.runAndSubscribe=function(t,i,e){return i(e),t((t=>i(t)))};class c{constructor(t,i){this._observable=t,this._counter=0,this._hasChanged=!1;const e={onWillAddFirstListener:()=>{t.addObserver(this)},onDidRemoveLastListener:()=>{t.removeObserver(this)}};this.emitter=new le(e),i&&i.add(this.emitter)}beginUpdate(t){this._counter++}handlePossibleChange(t){}handleChange(t,i){this._hasChanged=!0}endUpdate(t){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}t.fromObservable=function(t,i){return new c(t,i).emitter.event},t.fromObservableLight=function(t){return(i,e,s)=>{let n=0,r=!1;const o={beginUpdate(){n++},endUpdate(){n--,n===0&&(t.reportChanges(),r&&(r=!1,i.call(e)))},handlePossibleChange(){},handleChange(){r=!0}};t.addObserver(o),t.reportChanges();const h={dispose(){t.removeObserver(o)}};return s instanceof Ji?s.add(h):Array.isArray(s)&&s.push(h),h}}})(ne||(ne={}));class re{constructor(t){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${t}_${re._idPool++}`,re.all.add(this)}start(t){this._stopWatch=new se,this.listenerCount=t}stop(){if(this._stopWatch){const t=this._stopWatch.elapsed();this.durations.push(t),this.elapsedOverall+=t,this.invocationCount+=1,this._stopWatch=void 0}}}re.all=new Set,re._idPool=0;class oe{constructor(t,i=Math.random().toString(18).slice(2,5)){this.threshold=t,this.name=i,this._warnCountdown=0}dispose(){var t;(t=this._stacks)===null||t===void 0||t.clear()}check(t,i){const e=this.threshold;if(e<=0||i<e)return;this._stacks||(this._stacks=new Map);const s=this._stacks.get(t.value)||0;if(this._stacks.set(t.value,s+1),this._warnCountdown-=1,this._warnCountdown<=0){let t;this._warnCountdown=.5*e;let s=0;for(const[i,e]of this._stacks)(!t||s<e)&&(t=i,s=e);console.warn(`[${this.name}] potential listener LEAK detected, having ${i} listeners already. MOST frequent listener (${s}):`),console.warn(t)}return()=>{const i=this._stacks.get(t.value)||0;this._stacks.set(t.value,i-1)}}}class he{static create(){var t;return new he((t=(new Error).stack)!==null&&t!==void 0?t:"")}constructor(t){this.value=t}print(){console.warn(this.value.split(`\n`).slice(2).join(`\n`))}}class ce{constructor(t){this.value=t}}let le=class{constructor(t){var i,e,s,n,r;this._size=0,this._options=t,this._leakageMon=!((i=this._options)===null||i===void 0)&&i.leakWarningThreshold?new oe((s=(e=this._options)===null||e===void 0?void 0:e.leakWarningThreshold)!==null&&s!==void 0?s:-1):void 0,this._perfMon=!((n=this._options)===null||n===void 0)&&n._profName?new re(this._options._profName):void 0,this._deliveryQueue=(r=this._options)===null||r===void 0?void 0:r.deliveryQueue}dispose(){var t,i,e,s;this._disposed||(this._disposed=!0,((t=this._deliveryQueue)===null||t===void 0?void 0:t.current)===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),(e=(i=this._options)===null||i===void 0?void 0:i.onDidRemoveLastListener)===null||e===void 0||e.call(i),(s=this._leakageMon)===null||s===void 0||s.dispose())}get event(){var t;return(t=this._event)!==null&&t!==void 0||(this._event=(t,i,e)=>{var s,n,r,o,h;if(this._leakageMon&&this._size>3*this._leakageMon.threshold)return console.warn(`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far`),Qi.None;if(this._disposed)return Qi.None;i&&(t=t.bind(i));const c=new ce(t);let l;this._leakageMon&&this._size>=Math.ceil(.2*this._leakageMon.threshold)&&(c.stack=he.create(),l=this._leakageMon.check(c.stack,this._size+1)),this._listeners?this._listeners instanceof ce?((h=this._deliveryQueue)!==null&&h!==void 0||(this._deliveryQueue=new ae),this._listeners=[this._listeners,c]):this._listeners.push(c):((n=(s=this._options)===null||s===void 0?void 0:s.onWillAddFirstListener)===null||n===void 0||n.call(s,this),this._listeners=c,(o=(r=this._options)===null||r===void 0?void 0:r.onDidAddFirstListener)===null||o===void 0||o.call(r,this)),this._size++;const a=Zi((()=>{l==null||l(),this._removeListener(c)}));return e instanceof Ji?e.add(a):Array.isArray(e)&&e.push(a),a}),this._event}_removeListener(t){var i,e,s,n;if((e=(i=this._options)===null||i===void 0?void 0:i.onWillRemoveListener)===null||e===void 0||e.call(i,this),!this._listeners)return;if(this._size===1)return this._listeners=void 0,(n=(s=this._options)===null||s===void 0?void 0:s.onDidRemoveLastListener)===null||n===void 0||n.call(s,this),void(this._size=0);const r=this._listeners,o=r.indexOf(t);if(o===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,r[o]=void 0;const h=this._deliveryQueue.current===this;if(2*this._size<=r.length){let t=0;for(let i=0;i<r.length;i++)r[i]?r[t++]=r[i]:h&&(this._deliveryQueue.end--,t<this._deliveryQueue.i&&this._deliveryQueue.i--);r.length=t}}_deliver(t,i){var e;if(!t)return;const s=((e=this._options)===null||e===void 0?void 0:e.onListenerError)||Ii;if(s)try{t.value(i)}catch(t){s(t)}else t.value(i)}_deliverQueue(t){const i=t.current._listeners;for(;t.i<t.end;)this._deliver(i[t.i++],t.value);t.reset()}fire(t){var i,e,s,n;if(!((i=this._deliveryQueue)===null||i===void 0)&&i.current&&(this._deliverQueue(this._deliveryQueue),(e=this._perfMon)===null||e===void 0||e.stop()),(s=this._perfMon)===null||s===void 0||s.start(this._size),this._listeners)if(this._listeners instanceof ce)this._deliver(this._listeners,t);else{const i=this._deliveryQueue;i.enqueue(this,t,this._listeners.length),this._deliverQueue(i)}(n=this._perfMon)===null||n===void 0||n.stop()}hasListeners(){return this._size>0}};class ae{constructor(){this.i=-1,this.end=0}enqueue(t,i,e){this.i=0,this.end=e,this.current=t,this.value=i}reset(){this.i=this.end,this.current=void 0,this.value=void 0}}class ue extends le{constructor(t){super(t),this._isPaused=0,this._eventQueue=new Ht,this._mergeFn=t==null?void 0:t.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused==0)if(this._mergeFn){if(this._eventQueue.size>0){const t=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(t))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(t){this._size&&(this._isPaused!==0?this._eventQueue.push(t):super.fire(t))}}class de extends ue{constructor(t){var i;super(t),this._delay=(i=t.delay)!==null&&i!==void 0?i:100}fire(t){this._handle||(this.pause(),this._handle=setTimeout((()=>{this._handle=void 0,this.resume()}),this._delay)),super.fire(t)}}class fe extends le{constructor(t){super(t),this._queuedEvents=[],this._mergeFn=t==null?void 0:t.merge}fire(t){this.hasListeners()&&(this._queuedEvents.push(t),this._queuedEvents.length===1&&queueMicrotask((()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach((t=>super.fire(t))),this._queuedEvents=[]})))}}class ge{constructor(){this.hasListeners=!1,this.events=[],this.emitter=new le({onWillAddFirstListener:()=>this.onFirstListenerAdd(),onDidRemoveLastListener:()=>this.onLastListenerRemove()})}get event(){return this.emitter.event}add(t){const i={event:t,listener:null};return this.events.push(i),this.hasListeners&&this.hook(i),Zi(Ui((()=>{this.hasListeners&&this.unhook(i);const t=this.events.indexOf(i);this.events.splice(t,1)})))}onFirstListenerAdd(){this.hasListeners=!0,this.events.forEach((t=>this.hook(t)))}onLastListenerRemove(){this.hasListeners=!1,this.events.forEach((t=>this.unhook(t)))}hook(t){t.listener=t.event((t=>this.emitter.fire(t)))}unhook(t){var i;(i=t.listener)===null||i===void 0||i.dispose(),t.listener=null}dispose(){var t;this.emitter.dispose();for(const i of this.events)(t=i.listener)===null||t===void 0||t.dispose();this.events=[]}}class pe{constructor(){this.buffers=[]}wrapEvent(t){return(i,e,s)=>t((t=>{const s=this.buffers[this.buffers.length-1];s?s.push((()=>i.call(e,t))):i.call(e,t)}),void 0,s)}bufferEvents(t){const i=[];this.buffers.push(i);const e=t();return this.buffers.pop(),i.forEach((t=>t())),e}}class me{constructor(){this.listening=!1,this.inputEvent=ne.None,this.inputEventListener=Qi.None,this.emitter=new le({onDidAddFirstListener:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onDidRemoveLastListener:()=>{this.listening=!1,this.inputEventListener.dispose()}}),this.event=this.emitter.event}set input(t){this.inputEvent=t,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=t(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}}const we=Object.freeze((function(t,i){const e=setTimeout(t.bind(i),0);return{dispose(){clearTimeout(e)}}}));var ve;(function(t){t.isCancellationToken=function(i){return i===t.None||i===t.Cancelled||i instanceof be||!(!i||typeof i!="object")&&typeof i.isCancellationRequested=="boolean"&&typeof i.onCancellationRequested=="function"},t.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:ne.None}),t.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:we})})(ve||(ve={}));class be{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?we:(this._emitter||(this._emitter=new le),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}let ye=class{constructor(t){this._token=void 0,this._parentListener=void 0,this._parentListener=t&&t.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new be),this._token}cancel(){this._token?this._token instanceof be&&this._token.cancel():this._token=ve.Cancelled}dispose(t=!1){var i;t&&this.cancel(),(i=this._parentListener)===null||i===void 0||i.dispose(),this._token?this._token instanceof be&&this._token.dispose():this._token=ve.None}};class ke{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(t,i){this._keyCodeToStr[t]=i,this._strToKeyCode[i.toLowerCase()]=t}keyCodeToStr(t){return this._keyCodeToStr[t]}strToKeyCode(t){return this._strToKeyCode[t.toLowerCase()]||0}}const Ce=new ke,Se=new ke,xe=new ke,De=new Array(230),Ee=Object.create(null),Ae=Object.create(null),Me=[];for(let t=0;t<=193;t++)Me[t]=-1;var Le;function Fe(t,i){return(t|(65535&i)<<16>>>0)>>>0}let Te;(function(){const t="",i=[[1,0,"None",0,"unknown",0,"VK_UNKNOWN",t,t],[1,1,"Hyper",0,t,0,t,t,t],[1,2,"Super",0,t,0,t,t,t],[1,3,"Fn",0,t,0,t,t,t],[1,4,"FnLock",0,t,0,t,t,t],[1,5,"Suspend",0,t,0,t,t,t],[1,6,"Resume",0,t,0,t,t,t],[1,7,"Turbo",0,t,0,t,t,t],[1,8,"Sleep",0,t,0,"VK_SLEEP",t,t],[1,9,"WakeUp",0,t,0,t,t,t],[0,10,"KeyA",31,"A",65,"VK_A",t,t],[0,11,"KeyB",32,"B",66,"VK_B",t,t],[0,12,"KeyC",33,"C",67,"VK_C",t,t],[0,13,"KeyD",34,"D",68,"VK_D",t,t],[0,14,"KeyE",35,"E",69,"VK_E",t,t],[0,15,"KeyF",36,"F",70,"VK_F",t,t],[0,16,"KeyG",37,"G",71,"VK_G",t,t],[0,17,"KeyH",38,"H",72,"VK_H",t,t],[0,18,"KeyI",39,"I",73,"VK_I",t,t],[0,19,"KeyJ",40,"J",74,"VK_J",t,t],[0,20,"KeyK",41,"K",75,"VK_K",t,t],[0,21,"KeyL",42,"L",76,"VK_L",t,t],[0,22,"KeyM",43,"M",77,"VK_M",t,t],[0,23,"KeyN",44,"N",78,"VK_N",t,t],[0,24,"KeyO",45,"O",79,"VK_O",t,t],[0,25,"KeyP",46,"P",80,"VK_P",t,t],[0,26,"KeyQ",47,"Q",81,"VK_Q",t,t],[0,27,"KeyR",48,"R",82,"VK_R",t,t],[0,28,"KeyS",49,"S",83,"VK_S",t,t],[0,29,"KeyT",50,"T",84,"VK_T",t,t],[0,30,"KeyU",51,"U",85,"VK_U",t,t],[0,31,"KeyV",52,"V",86,"VK_V",t,t],[0,32,"KeyW",53,"W",87,"VK_W",t,t],[0,33,"KeyX",54,"X",88,"VK_X",t,t],[0,34,"KeyY",55,"Y",89,"VK_Y",t,t],[0,35,"KeyZ",56,"Z",90,"VK_Z",t,t],[0,36,"Digit1",22,"1",49,"VK_1",t,t],[0,37,"Digit2",23,"2",50,"VK_2",t,t],[0,38,"Digit3",24,"3",51,"VK_3",t,t],[0,39,"Digit4",25,"4",52,"VK_4",t,t],[0,40,"Digit5",26,"5",53,"VK_5",t,t],[0,41,"Digit6",27,"6",54,"VK_6",t,t],[0,42,"Digit7",28,"7",55,"VK_7",t,t],[0,43,"Digit8",29,"8",56,"VK_8",t,t],[0,44,"Digit9",30,"9",57,"VK_9",t,t],[0,45,"Digit0",21,"0",48,"VK_0",t,t],[1,46,"Enter",3,"Enter",13,"VK_RETURN",t,t],[1,47,"Escape",9,"Escape",27,"VK_ESCAPE",t,t],[1,48,"Backspace",1,"Backspace",8,"VK_BACK",t,t],[1,49,"Tab",2,"Tab",9,"VK_TAB",t,t],[1,50,"Space",10,"Space",32,"VK_SPACE",t,t],[0,51,"Minus",88,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,52,"Equal",86,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,53,"BracketLeft",92,"[",219,"VK_OEM_4","[","OEM_4"],[0,54,"BracketRight",94,"]",221,"VK_OEM_6","]","OEM_6"],[0,55,"Backslash",93,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,56,"IntlHash",0,t,0,t,t,t],[0,57,"Semicolon",85,";",186,"VK_OEM_1",";","OEM_1"],[0,58,"Quote",95,"'",222,"VK_OEM_7","'","OEM_7"],[0,59,"Backquote",91,"`",192,"VK_OEM_3","`","OEM_3"],[0,60,"Comma",87,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,61,"Period",89,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,62,"Slash",90,"/",191,"VK_OEM_2","/","OEM_2"],[1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL",t,t],[1,64,"F1",59,"F1",112,"VK_F1",t,t],[1,65,"F2",60,"F2",113,"VK_F2",t,t],[1,66,"F3",61,"F3",114,"VK_F3",t,t],[1,67,"F4",62,"F4",115,"VK_F4",t,t],[1,68,"F5",63,"F5",116,"VK_F5",t,t],[1,69,"F6",64,"F6",117,"VK_F6",t,t],[1,70,"F7",65,"F7",118,"VK_F7",t,t],[1,71,"F8",66,"F8",119,"VK_F8",t,t],[1,72,"F9",67,"F9",120,"VK_F9",t,t],[1,73,"F10",68,"F10",121,"VK_F10",t,t],[1,74,"F11",69,"F11",122,"VK_F11",t,t],[1,75,"F12",70,"F12",123,"VK_F12",t,t],[1,76,"PrintScreen",0,t,0,t,t,t],[1,77,"ScrollLock",84,"ScrollLock",145,"VK_SCROLL",t,t],[1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE",t,t],[1,79,"Insert",19,"Insert",45,"VK_INSERT",t,t],[1,80,"Home",14,"Home",36,"VK_HOME",t,t],[1,81,"PageUp",11,"PageUp",33,"VK_PRIOR",t,t],[1,82,"Delete",20,"Delete",46,"VK_DELETE",t,t],[1,83,"End",13,"End",35,"VK_END",t,t],[1,84,"PageDown",12,"PageDown",34,"VK_NEXT",t,t],[1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",t],[1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",t],[1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",t],[1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",t],[1,89,"NumLock",83,"NumLock",144,"VK_NUMLOCK",t,t],[1,90,"NumpadDivide",113,"NumPad_Divide",111,"VK_DIVIDE",t,t],[1,91,"NumpadMultiply",108,"NumPad_Multiply",106,"VK_MULTIPLY",t,t],[1,92,"NumpadSubtract",111,"NumPad_Subtract",109,"VK_SUBTRACT",t,t],[1,93,"NumpadAdd",109,"NumPad_Add",107,"VK_ADD",t,t],[1,94,"NumpadEnter",3,t,0,t,t,t],[1,95,"Numpad1",99,"NumPad1",97,"VK_NUMPAD1",t,t],[1,96,"Numpad2",100,"NumPad2",98,"VK_NUMPAD2",t,t],[1,97,"Numpad3",101,"NumPad3",99,"VK_NUMPAD3",t,t],[1,98,"Numpad4",102,"NumPad4",100,"VK_NUMPAD4",t,t],[1,99,"Numpad5",103,"NumPad5",101,"VK_NUMPAD5",t,t],[1,100,"Numpad6",104,"NumPad6",102,"VK_NUMPAD6",t,t],[1,101,"Numpad7",105,"NumPad7",103,"VK_NUMPAD7",t,t],[1,102,"Numpad8",106,"NumPad8",104,"VK_NUMPAD8",t,t],[1,103,"Numpad9",107,"NumPad9",105,"VK_NUMPAD9",t,t],[1,104,"Numpad0",98,"NumPad0",96,"VK_NUMPAD0",t,t],[1,105,"NumpadDecimal",112,"NumPad_Decimal",110,"VK_DECIMAL",t,t],[0,106,"IntlBackslash",97,"OEM_102",226,"VK_OEM_102",t,t],[1,107,"ContextMenu",58,"ContextMenu",93,t,t,t],[1,108,"Power",0,t,0,t,t,t],[1,109,"NumpadEqual",0,t,0,t,t,t],[1,110,"F13",71,"F13",124,"VK_F13",t,t],[1,111,"F14",72,"F14",125,"VK_F14",t,t],[1,112,"F15",73,"F15",126,"VK_F15",t,t],[1,113,"F16",74,"F16",127,"VK_F16",t,t],[1,114,"F17",75,"F17",128,"VK_F17",t,t],[1,115,"F18",76,"F18",129,"VK_F18",t,t],[1,116,"F19",77,"F19",130,"VK_F19",t,t],[1,117,"F20",78,"F20",131,"VK_F20",t,t],[1,118,"F21",79,"F21",132,"VK_F21",t,t],[1,119,"F22",80,"F22",133,"VK_F22",t,t],[1,120,"F23",81,"F23",134,"VK_F23",t,t],[1,121,"F24",82,"F24",135,"VK_F24",t,t],[1,122,"Open",0,t,0,t,t,t],[1,123,"Help",0,t,0,t,t,t],[1,124,"Select",0,t,0,t,t,t],[1,125,"Again",0,t,0,t,t,t],[1,126,"Undo",0,t,0,t,t,t],[1,127,"Cut",0,t,0,t,t,t],[1,128,"Copy",0,t,0,t,t,t],[1,129,"Paste",0,t,0,t,t,t],[1,130,"Find",0,t,0,t,t,t],[1,131,"AudioVolumeMute",117,"AudioVolumeMute",173,"VK_VOLUME_MUTE",t,t],[1,132,"AudioVolumeUp",118,"AudioVolumeUp",175,"VK_VOLUME_UP",t,t],[1,133,"AudioVolumeDown",119,"AudioVolumeDown",174,"VK_VOLUME_DOWN",t,t],[1,134,"NumpadComma",110,"NumPad_Separator",108,"VK_SEPARATOR",t,t],[0,135,"IntlRo",115,"ABNT_C1",193,"VK_ABNT_C1",t,t],[1,136,"KanaMode",0,t,0,t,t,t],[0,137,"IntlYen",0,t,0,t,t,t],[1,138,"Convert",0,t,0,t,t,t],[1,139,"NonConvert",0,t,0,t,t,t],[1,140,"Lang1",0,t,0,t,t,t],[1,141,"Lang2",0,t,0,t,t,t],[1,142,"Lang3",0,t,0,t,t,t],[1,143,"Lang4",0,t,0,t,t,t],[1,144,"Lang5",0,t,0,t,t,t],[1,145,"Abort",0,t,0,t,t,t],[1,146,"Props",0,t,0,t,t,t],[1,147,"NumpadParenLeft",0,t,0,t,t,t],[1,148,"NumpadParenRight",0,t,0,t,t,t],[1,149,"NumpadBackspace",0,t,0,t,t,t],[1,150,"NumpadMemoryStore",0,t,0,t,t,t],[1,151,"NumpadMemoryRecall",0,t,0,t,t,t],[1,152,"NumpadMemoryClear",0,t,0,t,t,t],[1,153,"NumpadMemoryAdd",0,t,0,t,t,t],[1,154,"NumpadMemorySubtract",0,t,0,t,t,t],[1,155,"NumpadClear",131,"Clear",12,"VK_CLEAR",t,t],[1,156,"NumpadClearEntry",0,t,0,t,t,t],[1,0,t,5,"Ctrl",17,"VK_CONTROL",t,t],[1,0,t,4,"Shift",16,"VK_SHIFT",t,t],[1,0,t,6,"Alt",18,"VK_MENU",t,t],[1,0,t,57,"Meta",91,"VK_COMMAND",t,t],[1,157,"ControlLeft",5,t,0,"VK_LCONTROL",t,t],[1,158,"ShiftLeft",4,t,0,"VK_LSHIFT",t,t],[1,159,"AltLeft",6,t,0,"VK_LMENU",t,t],[1,160,"MetaLeft",57,t,0,"VK_LWIN",t,t],[1,161,"ControlRight",5,t,0,"VK_RCONTROL",t,t],[1,162,"ShiftRight",4,t,0,"VK_RSHIFT",t,t],[1,163,"AltRight",6,t,0,"VK_RMENU",t,t],[1,164,"MetaRight",57,t,0,"VK_RWIN",t,t],[1,165,"BrightnessUp",0,t,0,t,t,t],[1,166,"BrightnessDown",0,t,0,t,t,t],[1,167,"MediaPlay",0,t,0,t,t,t],[1,168,"MediaRecord",0,t,0,t,t,t],[1,169,"MediaFastForward",0,t,0,t,t,t],[1,170,"MediaRewind",0,t,0,t,t,t],[1,171,"MediaTrackNext",124,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",t,t],[1,172,"MediaTrackPrevious",125,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",t,t],[1,173,"MediaStop",126,"MediaStop",178,"VK_MEDIA_STOP",t,t],[1,174,"Eject",0,t,0,t,t,t],[1,175,"MediaPlayPause",127,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",t,t],[1,176,"MediaSelect",128,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",t,t],[1,177,"LaunchMail",129,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",t,t],[1,178,"LaunchApp2",130,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",t,t],[1,179,"LaunchApp1",0,t,0,"VK_MEDIA_LAUNCH_APP1",t,t],[1,180,"SelectTask",0,t,0,t,t,t],[1,181,"LaunchScreenSaver",0,t,0,t,t,t],[1,182,"BrowserSearch",120,"BrowserSearch",170,"VK_BROWSER_SEARCH",t,t],[1,183,"BrowserHome",121,"BrowserHome",172,"VK_BROWSER_HOME",t,t],[1,184,"BrowserBack",122,"BrowserBack",166,"VK_BROWSER_BACK",t,t],[1,185,"BrowserForward",123,"BrowserForward",167,"VK_BROWSER_FORWARD",t,t],[1,186,"BrowserStop",0,t,0,"VK_BROWSER_STOP",t,t],[1,187,"BrowserRefresh",0,t,0,"VK_BROWSER_REFRESH",t,t],[1,188,"BrowserFavorites",0,t,0,"VK_BROWSER_FAVORITES",t,t],[1,189,"ZoomToggle",0,t,0,t,t,t],[1,190,"MailReply",0,t,0,t,t,t],[1,191,"MailForward",0,t,0,t,t,t],[1,192,"MailSend",0,t,0,t,t,t],[1,0,t,114,"KeyInComposition",229,t,t,t],[1,0,t,116,"ABNT_C2",194,"VK_ABNT_C2",t,t],[1,0,t,96,"OEM_8",223,"VK_OEM_8",t,t],[1,0,t,0,t,0,"VK_KANA",t,t],[1,0,t,0,t,0,"VK_HANGUL",t,t],[1,0,t,0,t,0,"VK_JUNJA",t,t],[1,0,t,0,t,0,"VK_FINAL",t,t],[1,0,t,0,t,0,"VK_HANJA",t,t],[1,0,t,0,t,0,"VK_KANJI",t,t],[1,0,t,0,t,0,"VK_CONVERT",t,t],[1,0,t,0,t,0,"VK_NONCONVERT",t,t],[1,0,t,0,t,0,"VK_ACCEPT",t,t],[1,0,t,0,t,0,"VK_MODECHANGE",t,t],[1,0,t,0,t,0,"VK_SELECT",t,t],[1,0,t,0,t,0,"VK_PRINT",t,t],[1,0,t,0,t,0,"VK_EXECUTE",t,t],[1,0,t,0,t,0,"VK_SNAPSHOT",t,t],[1,0,t,0,t,0,"VK_HELP",t,t],[1,0,t,0,t,0,"VK_APPS",t,t],[1,0,t,0,t,0,"VK_PROCESSKEY",t,t],[1,0,t,0,t,0,"VK_PACKET",t,t],[1,0,t,0,t,0,"VK_DBE_SBCSCHAR",t,t],[1,0,t,0,t,0,"VK_DBE_DBCSCHAR",t,t],[1,0,t,0,t,0,"VK_ATTN",t,t],[1,0,t,0,t,0,"VK_CRSEL",t,t],[1,0,t,0,t,0,"VK_EXSEL",t,t],[1,0,t,0,t,0,"VK_EREOF",t,t],[1,0,t,0,t,0,"VK_PLAY",t,t],[1,0,t,0,t,0,"VK_ZOOM",t,t],[1,0,t,0,t,0,"VK_NONAME",t,t],[1,0,t,0,t,0,"VK_PA1",t,t],[1,0,t,0,t,0,"VK_OEM_CLEAR",t,t]],e=[],s=[];for(const t of i){const[i,n,r,o,h,c,l,a,u]=t;if(s[n]||(s[n]=!0,Ee[r]=n,Ae[r.toLowerCase()]=n,i&&(Me[n]=o)),!e[o]){if(e[o]=!0,!h)throw new Error(`String representation missing for key code ${o} around scan code ${r}`);Ce.define(o,h),Se.define(o,a||h),xe.define(o,u||a||h)}c&&(De[c]=o)}})(),function(t){t.toString=function(t){return Ce.keyCodeToStr(t)},t.fromString=function(t){return Ce.strToKeyCode(t)},t.toUserSettingsUS=function(t){return Se.keyCodeToStr(t)},t.toUserSettingsGeneral=function(t){return xe.keyCodeToStr(t)},t.fromUserSettings=function(t){return Se.strToKeyCode(t)||xe.strToKeyCode(t)},t.toElectronAccelerator=function(t){if(t>=98&&t<=113)return null;switch(t){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return Ce.keyCodeToStr(t)}}(Le||(Le={}));const Re=globalThis.vscode;if(Re!==void 0&&Re.process!==void 0){const t=Re.process;Te={get platform(){return t.platform},get arch(){return t.arch},get env(){return t.env},cwd:()=>t.cwd()}}else Te=typeof process<"u"?{get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd:()=>process.env.VSCODE_CWD||process.cwd()}:{get platform(){return vt?"win32":bt?"darwin":"linux"},get arch(){},get env(){return{}},cwd:()=>"/"};const Oe=Te.cwd,Ie=Te.env,_e=Te.platform,Pe=46,Ne=47,Be=92,$e=58;class We extends Error{constructor(t,i,e){let s;typeof i=="string"&&i.indexOf("not ")===0?(s="must not be",i=i.replace(/^not /,"")):s="must be";const n=t.indexOf(".")!==-1?"property":"argument";let r=`The "${t}" ${n} ${s} of type ${i}`;r+=". Received type "+typeof e,super(r),this.code="ERR_INVALID_ARG_TYPE"}}function je(t,i){if(typeof t!="string")throw new We(i,"string",t)}const He=_e==="win32";function Ve(t){return t===Ne||t===Be}function ze(t){return t===Ne}function Ue(t){return t>=65&&t<=90||t>=97&&t<=122}function Ke(t,i,e,s){let n="",r=0,o=-1,h=0,c=0;for(let l=0;l<=t.length;++l){if(l<t.length)c=t.charCodeAt(l);else{if(s(c))break;c=Ne}if(s(c)){if(!(o===l-1||h===1))if(h===2){if(n.length<2||r!==2||n.charCodeAt(n.length-1)!==Pe||n.charCodeAt(n.length-2)!==Pe){if(n.length>2){const t=n.lastIndexOf(e);t===-1?(n="",r=0):(n=n.slice(0,t),r=n.length-1-n.lastIndexOf(e)),o=l,h=0;continue}if(n.length!==0){n="",r=0,o=l,h=0;continue}}i&&(n+=n.length>0?`${e}..`:"..",r=2)}else n.length>0?n+=`${e}${t.slice(o+1,l)}`:n=t.slice(o+1,l),r=l-o-1;o=l,h=0}else c===Pe&&h!==-1?++h:h=-1}return n}function qe(t,i){(function(t,i){if(t===null||typeof t!="object")throw new We(i,"Object",t)})(i,"pathObject");const e=i.dir||i.root,s=i.base||`${i.name||""}${i.ext||""}`;return e?e===i.root?`${e}${s}`:`${e}${t}${s}`:s}const Ge={resolve(...t){let i="",e="",s=!1;for(let n=t.length-1;n>=-1;n--){let r;if(n>=0){if(r=t[n],je(r,"path"),r.length===0)continue}else i.length===0?r=Oe():(r=Ie[`=${i}`]||Oe(),(r===void 0||r.slice(0,2).toLowerCase()!==i.toLowerCase()&&r.charCodeAt(2)===Be)&&(r=`${i}\\`));const o=r.length;let h=0,c="",l=!1;const a=r.charCodeAt(0);if(o===1)Ve(a)&&(h=1,l=!0);else if(Ve(a))if(l=!0,Ve(r.charCodeAt(1))){let t=2,i=t;for(;t<o&&!Ve(r.charCodeAt(t));)t++;if(t<o&&t!==i){const e=r.slice(i,t);for(i=t;t<o&&Ve(r.charCodeAt(t));)t++;if(t<o&&t!==i){for(i=t;t<o&&!Ve(r.charCodeAt(t));)t++;t!==o&&t===i||(c=`\\\\${e}\\${r.slice(i,t)}`,h=t)}}}else h=1;else Ue(a)&&r.charCodeAt(1)===$e&&(c=r.slice(0,2),h=2,o>2&&Ve(r.charCodeAt(2))&&(l=!0,h=3));if(c.length>0)if(i.length>0){if(c.toLowerCase()!==i.toLowerCase())continue}else i=c;if(s){if(i.length>0)break}else if(e=`${r.slice(h)}\\${e}`,s=l,l&&i.length>0)break}return e=Ke(e,!s,"\\",Ve),s?`${i}\\${e}`:`${i}${e}`||"."},normalize(t){je(t,"path");const i=t.length;if(i===0)return".";let e,s=0,n=!1;const r=t.charCodeAt(0);if(i===1)return ze(r)?"\\":t;if(Ve(r))if(n=!0,Ve(t.charCodeAt(1))){let n=2,r=n;for(;n<i&&!Ve(t.charCodeAt(n));)n++;if(n<i&&n!==r){const o=t.slice(r,n);for(r=n;n<i&&Ve(t.charCodeAt(n));)n++;if(n<i&&n!==r){for(r=n;n<i&&!Ve(t.charCodeAt(n));)n++;if(n===i)return`\\\\${o}\\${t.slice(r)}\\`;n!==r&&(e=`\\\\${o}\\${t.slice(r,n)}`,s=n)}}}else s=1;else Ue(r)&&t.charCodeAt(1)===$e&&(e=t.slice(0,2),s=2,i>2&&Ve(t.charCodeAt(2))&&(n=!0,s=3));let o=s<i?Ke(t.slice(s),!n,"\\",Ve):"";return o.length!==0||n||(o="."),o.length>0&&Ve(t.charCodeAt(i-1))&&(o+="\\"),e===void 0?n?`\\${o}`:o:n?`${e}\\${o}`:`${e}${o}`},isAbsolute(t){je(t,"path");const i=t.length;if(i===0)return!1;const e=t.charCodeAt(0);return Ve(e)||i>2&&Ue(e)&&t.charCodeAt(1)===$e&&Ve(t.charCodeAt(2))},join(...t){if(t.length===0)return".";let i,e;for(let s=0;s<t.length;++s){const n=t[s];je(n,"path"),n.length>0&&(i===void 0?i=e=n:i+=`\\${n}`)}if(i===void 0)return".";let s=!0,n=0;if(typeof e=="string"&&Ve(e.charCodeAt(0))){++n;const t=e.length;t>1&&Ve(e.charCodeAt(1))&&(++n,t>2&&(Ve(e.charCodeAt(2))?++n:s=!1))}if(s){for(;n<i.length&&Ve(i.charCodeAt(n));)n++;n>=2&&(i=`\\${i.slice(n)}`)}return Ge.normalize(i)},relative(t,i){if(je(t,"from"),je(i,"to"),t===i)return"";const e=Ge.resolve(t),s=Ge.resolve(i);if(e===s||(t=e.toLowerCase())===(i=s.toLowerCase()))return"";let n=0;for(;n<t.length&&t.charCodeAt(n)===Be;)n++;let r=t.length;for(;r-1>n&&t.charCodeAt(r-1)===Be;)r--;const o=r-n;let h=0;for(;h<i.length&&i.charCodeAt(h)===Be;)h++;let c=i.length;for(;c-1>h&&i.charCodeAt(c-1)===Be;)c--;const l=c-h,a=o<l?o:l;let u=-1,d=0;for(;d<a;d++){const e=t.charCodeAt(n+d);if(e!==i.charCodeAt(h+d))break;e===Be&&(u=d)}if(d!==a){if(u===-1)return s}else{if(l>a){if(i.charCodeAt(h+d)===Be)return s.slice(h+d+1);if(d===2)return s.slice(h+d)}o>a&&(t.charCodeAt(n+d)===Be?u=d:d===2&&(u=3)),u===-1&&(u=0)}let f="";for(d=n+u+1;d<=r;++d)d!==r&&t.charCodeAt(d)!==Be||(f+=f.length===0?"..":"\\..");return h+=u,f.length>0?`${f}${s.slice(h,c)}`:(s.charCodeAt(h)===Be&&++h,s.slice(h,c))},toNamespacedPath(t){if(typeof t!="string"||t.length===0)return t;const i=Ge.resolve(t);if(i.length<=2)return t;if(i.charCodeAt(0)===Be){if(i.charCodeAt(1)===Be){const t=i.charCodeAt(2);if(t!==63&&t!==Pe)return`\\\\?\\UNC\\${i.slice(2)}`}}else if(Ue(i.charCodeAt(0))&&i.charCodeAt(1)===$e&&i.charCodeAt(2)===Be)return`\\\\?\\${i}`;return t},dirname(t){je(t,"path");const i=t.length;if(i===0)return".";let e=-1,s=0;const n=t.charCodeAt(0);if(i===1)return Ve(n)?t:".";if(Ve(n)){if(e=s=1,Ve(t.charCodeAt(1))){let n=2,r=n;for(;n<i&&!Ve(t.charCodeAt(n));)n++;if(n<i&&n!==r){for(r=n;n<i&&Ve(t.charCodeAt(n));)n++;if(n<i&&n!==r){for(r=n;n<i&&!Ve(t.charCodeAt(n));)n++;if(n===i)return t;n!==r&&(e=s=n+1)}}}}else Ue(n)&&t.charCodeAt(1)===$e&&(e=i>2&&Ve(t.charCodeAt(2))?3:2,s=e);let r=-1,o=!0;for(let e=i-1;e>=s;--e)if(Ve(t.charCodeAt(e))){if(!o){r=e;break}}else o=!1;if(r===-1){if(e===-1)return".";r=e}return t.slice(0,r)},basename(t,i){i!==void 0&&je(i,"ext"),je(t,"path");let e,s=0,n=-1,r=!0;if(t.length>=2&&Ue(t.charCodeAt(0))&&t.charCodeAt(1)===$e&&(s=2),i!==void 0&&i.length>0&&i.length<=t.length){if(i===t)return"";let o=i.length-1,h=-1;for(e=t.length-1;e>=s;--e){const c=t.charCodeAt(e);if(Ve(c)){if(!r){s=e+1;break}}else h===-1&&(r=!1,h=e+1),o>=0&&(c===i.charCodeAt(o)?--o==-1&&(n=e):(o=-1,n=h))}return s===n?n=h:n===-1&&(n=t.length),t.slice(s,n)}for(e=t.length-1;e>=s;--e)if(Ve(t.charCodeAt(e))){if(!r){s=e+1;break}}else n===-1&&(r=!1,n=e+1);return n===-1?"":t.slice(s,n)},extname(t){je(t,"path");let i=0,e=-1,s=0,n=-1,r=!0,o=0;t.length>=2&&t.charCodeAt(1)===$e&&Ue(t.charCodeAt(0))&&(i=s=2);for(let h=t.length-1;h>=i;--h){const i=t.charCodeAt(h);if(Ve(i)){if(!r){s=h+1;break}}else n===-1&&(r=!1,n=h+1),i===Pe?e===-1?e=h:o!==1&&(o=1):e!==-1&&(o=-1)}return e===-1||n===-1||o===0||o===1&&e===n-1&&e===s+1?"":t.slice(e,n)},format:qe.bind(null,"\\"),parse(t){je(t,"path");const i={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return i;const e=t.length;let s=0,n=t.charCodeAt(0);if(e===1)return Ve(n)?(i.root=i.dir=t,i):(i.base=i.name=t,i);if(Ve(n)){if(s=1,Ve(t.charCodeAt(1))){let i=2,n=i;for(;i<e&&!Ve(t.charCodeAt(i));)i++;if(i<e&&i!==n){for(n=i;i<e&&Ve(t.charCodeAt(i));)i++;if(i<e&&i!==n){for(n=i;i<e&&!Ve(t.charCodeAt(i));)i++;i===e?s=i:i!==n&&(s=i+1)}}}}else if(Ue(n)&&t.charCodeAt(1)===$e){if(e<=2)return i.root=i.dir=t,i;if(s=2,Ve(t.charCodeAt(2))){if(e===3)return i.root=i.dir=t,i;s=3}}s>0&&(i.root=t.slice(0,s));let r=-1,o=s,h=-1,c=!0,l=t.length-1,a=0;for(;l>=s;--l)if(n=t.charCodeAt(l),Ve(n)){if(!c){o=l+1;break}}else h===-1&&(c=!1,h=l+1),n===Pe?r===-1?r=l:a!==1&&(a=1):r!==-1&&(a=-1);return h!==-1&&(r===-1||a===0||a===1&&r===h-1&&r===o+1?i.base=i.name=t.slice(o,h):(i.name=t.slice(o,r),i.base=t.slice(o,h),i.ext=t.slice(r,h))),i.dir=o>0&&o!==s?t.slice(0,o-1):i.root,i},sep:"\\",delimiter:";",win32:null,posix:null},Ze=(()=>{if(He){const t=/\\/g;return()=>{const i=Oe().replace(t,"/");return i.slice(i.indexOf("/"))}}return()=>Oe()})(),Je={resolve(...t){let i="",e=!1;for(let s=t.length-1;s>=-1&&!e;s--){const n=s>=0?t[s]:Ze();je(n,"path"),n.length!==0&&(i=`${n}/${i}`,e=n.charCodeAt(0)===Ne)}return i=Ke(i,!e,"/",ze),e?`/${i}`:i.length>0?i:"."},normalize(t){if(je(t,"path"),t.length===0)return".";const i=t.charCodeAt(0)===Ne,e=t.charCodeAt(t.length-1)===Ne;return(t=Ke(t,!i,"/",ze)).length===0?i?"/":e?"./":".":(e&&(t+="/"),i?`/${t}`:t)},isAbsolute:t=>(je(t,"path"),t.length>0&&t.charCodeAt(0)===Ne),join(...t){if(t.length===0)return".";let i;for(let e=0;e<t.length;++e){const s=t[e];je(s,"path"),s.length>0&&(i===void 0?i=s:i+=`/${s}`)}return i===void 0?".":Je.normalize(i)},relative(t,i){if(je(t,"from"),je(i,"to"),t===i||(t=Je.resolve(t))===(i=Je.resolve(i)))return"";const e=t.length,s=e-1,n=i.length-1,r=s<n?s:n;let o=-1,h=0;for(;h<r;h++){const e=t.charCodeAt(1+h);if(e!==i.charCodeAt(1+h))break;e===Ne&&(o=h)}if(h===r)if(n>r){if(i.charCodeAt(1+h)===Ne)return i.slice(1+h+1);if(h===0)return i.slice(1+h)}else s>r&&(t.charCodeAt(1+h)===Ne?o=h:h===0&&(o=0));let c="";for(h=1+o+1;h<=e;++h)h!==e&&t.charCodeAt(h)!==Ne||(c+=c.length===0?"..":"/..");return`${c}${i.slice(1+o)}`},toNamespacedPath:t=>t,dirname(t){if(je(t,"path"),t.length===0)return".";const i=t.charCodeAt(0)===Ne;let e=-1,s=!0;for(let i=t.length-1;i>=1;--i)if(t.charCodeAt(i)===Ne){if(!s){e=i;break}}else s=!1;return e===-1?i?"/":".":i&&e===1?"//":t.slice(0,e)},basename(t,i){i!==void 0&&je(i,"ext"),je(t,"path");let e,s=0,n=-1,r=!0;if(i!==void 0&&i.length>0&&i.length<=t.length){if(i===t)return"";let o=i.length-1,h=-1;for(e=t.length-1;e>=0;--e){const c=t.charCodeAt(e);if(c===Ne){if(!r){s=e+1;break}}else h===-1&&(r=!1,h=e+1),o>=0&&(c===i.charCodeAt(o)?--o==-1&&(n=e):(o=-1,n=h))}return s===n?n=h:n===-1&&(n=t.length),t.slice(s,n)}for(e=t.length-1;e>=0;--e)if(t.charCodeAt(e)===Ne){if(!r){s=e+1;break}}else n===-1&&(r=!1,n=e+1);return n===-1?"":t.slice(s,n)},extname(t){je(t,"path");let i=-1,e=0,s=-1,n=!0,r=0;for(let o=t.length-1;o>=0;--o){const h=t.charCodeAt(o);if(h!==Ne)s===-1&&(n=!1,s=o+1),h===Pe?i===-1?i=o:r!==1&&(r=1):i!==-1&&(r=-1);else if(!n){e=o+1;break}}return i===-1||s===-1||r===0||r===1&&i===s-1&&i===e+1?"":t.slice(i,s)},format:qe.bind(null,"/"),parse(t){je(t,"path");const i={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return i;const e=t.charCodeAt(0)===Ne;let s;e?(i.root="/",s=1):s=0;let n=-1,r=0,o=-1,h=!0,c=t.length-1,l=0;for(;c>=s;--c){const i=t.charCodeAt(c);if(i!==Ne)o===-1&&(h=!1,o=c+1),i===Pe?n===-1?n=c:l!==1&&(l=1):n!==-1&&(l=-1);else if(!h){r=c+1;break}}if(o!==-1){const s=r===0&&e?1:r;n===-1||l===0||l===1&&n===o-1&&n===r+1?i.base=i.name=t.slice(s,o):(i.name=t.slice(s,n),i.base=t.slice(s,o),i.ext=t.slice(n,o))}return r>0?i.dir=t.slice(0,r-1):e&&(i.dir="/"),i},sep:"/",delimiter:":",win32:null,posix:null};Je.win32=Ge.win32=Ge,Je.posix=Ge.posix=Je;const Qe=He?Ge.normalize:Je.normalize,Ye=He?Ge.resolve:Je.resolve,Xe=He?Ge.relative:Je.relative,ts=He?Ge.dirname:Je.dirname,is=He?Ge.basename:Je.basename,es=He?Ge.extname:Je.extname,ss=He?Ge.sep:Je.sep,ns=/^\w[\w\d+.-]*$/,rs=/^\//,os=/^\/\//,hs="",cs="/",ls=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;let as=class t{static isUri(i){return i instanceof t||!!i&&typeof i.authority=="string"&&typeof i.fragment=="string"&&typeof i.path=="string"&&typeof i.query=="string"&&typeof i.scheme=="string"&&typeof i.fsPath=="string"&&typeof i.with=="function"&&typeof i.toString=="function"}constructor(t,i,e,s,n,r=!1){typeof t=="object"?(this.scheme=t.scheme||hs,this.authority=t.authority||hs,this.path=t.path||hs,this.query=t.query||hs,this.fragment=t.fragment||hs):(this.scheme=function(t,i){return t||i?t:"file"}(t,r),this.authority=i||hs,this.path=function(t,i){switch(t){case"https":case"http":case"file":i?i[0]!==cs&&(i=cs+i):i=cs}return i}(this.scheme,e||hs),this.query=s||hs,this.fragment=n||hs,function(t,i){if(!t.scheme&&i)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${t.authority}", path: "${t.path}", query: "${t.query}", fragment: "${t.fragment}"}`);if(t.scheme&&!ns.test(t.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(t.path){if(t.authority){if(!rs.test(t.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(os.test(t.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}(this,r))}get fsPath(){return ms(this,!1)}with(t){if(!t)return this;let{scheme:i,authority:e,path:s,query:n,fragment:r}=t;return i===void 0?i=this.scheme:i===null&&(i=hs),e===void 0?e=this.authority:e===null&&(e=hs),s===void 0?s=this.path:s===null&&(s=hs),n===void 0?n=this.query:n===null&&(n=hs),r===void 0?r=this.fragment:r===null&&(r=hs),i===this.scheme&&e===this.authority&&s===this.path&&n===this.query&&r===this.fragment?this:new ds(i,e,s,n,r)}static parse(t,i=!1){const e=ls.exec(t);return e?new ds(e[2]||hs,ys(e[4]||hs),ys(e[5]||hs),ys(e[7]||hs),ys(e[9]||hs),i):new ds(hs,hs,hs,hs,hs)}static file(t){let i=hs;if(vt&&(t=t.replace(/\\/g,cs)),t[0]===cs&&t[1]===cs){const e=t.indexOf(cs,2);e===-1?(i=t.substring(2),t=cs):(i=t.substring(2,e),t=t.substring(e)||cs)}return new ds("file",i,t,hs,hs)}static from(t,i){return new ds(t.scheme,t.authority,t.path,t.query,t.fragment,i)}static joinPath(i,...e){if(!i.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let s;return s=vt&&i.scheme==="file"?t.file(Ge.join(ms(i,!0),...e)).path:Je.join(i.path,...e),i.with({path:s})}toString(t=!1){return ws(this,t)}toJSON(){return this}static revive(i){var e,s;if(i){if(i instanceof t)return i;{const t=new ds(i);return t._formatted=(e=i.external)!==null&&e!==void 0?e:null,t._fsPath=i._sep===us&&(s=i.fsPath)!==null&&s!==void 0?s:null,t}}return i}};const us=vt?1:void 0;let ds=class extends as{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=ms(this,!1)),this._fsPath}toString(t=!1){return t?ws(this,!0):(this._formatted||(this._formatted=ws(this,!1)),this._formatted)}toJSON(){const t={$mid:1};return this._fsPath&&(t.fsPath=this._fsPath,t._sep=us),this._formatted&&(t.external=this._formatted),this.path&&(t.path=this.path),this.scheme&&(t.scheme=this.scheme),this.authority&&(t.authority=this.authority),this.query&&(t.query=this.query),this.fragment&&(t.fragment=this.fragment),t}};const fs={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function gs(t,i,e){let s,n=-1;for(let r=0;r<t.length;r++){const o=t.charCodeAt(r);if(o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||o===45||o===46||o===95||o===126||i&&o===47||e&&o===91||e&&o===93||e&&o===58)n!==-1&&(s+=encodeURIComponent(t.substring(n,r)),n=-1),s!==void 0&&(s+=t.charAt(r));else{s===void 0&&(s=t.substr(0,r));const i=fs[o];i!==void 0?(n!==-1&&(s+=encodeURIComponent(t.substring(n,r)),n=-1),s+=i):n===-1&&(n=r)}}return n!==-1&&(s+=encodeURIComponent(t.substring(n))),s!==void 0?s:t}function ps(t){let i;for(let e=0;e<t.length;e++){const s=t.charCodeAt(e);s===35||s===63?(i===void 0&&(i=t.substr(0,e)),i+=fs[s]):i!==void 0&&(i+=t[e])}return i!==void 0?i:t}function ms(t,i){let e;return e=t.authority&&t.path.length>1&&t.scheme==="file"?`//${t.authority}${t.path}`:t.path.charCodeAt(0)===47&&(t.path.charCodeAt(1)>=65&&t.path.charCodeAt(1)<=90||t.path.charCodeAt(1)>=97&&t.path.charCodeAt(1)<=122)&&t.path.charCodeAt(2)===58?i?t.path.substr(1):t.path[1].toLowerCase()+t.path.substr(2):t.path,vt&&(e=e.replace(/\//g,"\\")),e}function ws(t,i){const e=i?ps:gs;let s="",{scheme:n,authority:r,path:o,query:h,fragment:c}=t;if(n&&(s+=n,s+=":"),(r||n==="file")&&(s+=cs,s+=cs),r){let t=r.indexOf("@");if(t!==-1){const i=r.substr(0,t);r=r.substr(t+1),t=i.lastIndexOf(":"),t===-1?s+=e(i,!1,!1):(s+=e(i.substr(0,t),!1,!1),s+=":",s+=e(i.substr(t+1),!1,!0)),s+="@"}r=r.toLowerCase(),t=r.lastIndexOf(":"),t===-1?s+=e(r,!1,!0):(s+=e(r.substr(0,t),!1,!0),s+=r.substr(t))}if(o){if(o.length>=3&&o.charCodeAt(0)===47&&o.charCodeAt(2)===58){const t=o.charCodeAt(1);t>=65&&t<=90&&(o=`/${String.fromCharCode(t+32)}:${o.substr(3)}`)}else if(o.length>=2&&o.charCodeAt(1)===58){const t=o.charCodeAt(0);t>=65&&t<=90&&(o=`${String.fromCharCode(t+32)}:${o.substr(2)}`)}s+=e(o,!0,!1)}return h&&(s+="?",s+=e(h,!1,!1)),c&&(s+="#",s+=i?c:gs(c,!1,!1)),s}function vs(t){try{return decodeURIComponent(t)}catch{return t.length>3?t.substr(0,3)+vs(t.substr(3)):t}}const bs=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function ys(t){return t.match(bs)?t.replace(bs,(t=>vs(t))):t}let ks=class t{constructor(t,i){this.lineNumber=t,this.column=i}with(i=this.lineNumber,e=this.column){return i===this.lineNumber&&e===this.column?this:new t(i,e)}delta(t=0,i=0){return this.with(this.lineNumber+t,this.column+i)}equals(i){return t.equals(this,i)}static equals(t,i){return!t&&!i||!!t&&!!i&&t.lineNumber===i.lineNumber&&t.column===i.column}isBefore(i){return t.isBefore(this,i)}static isBefore(t,i){return t.lineNumber<i.lineNumber||!(i.lineNumber<t.lineNumber)&&t.column<i.column}isBeforeOrEqual(i){return t.isBeforeOrEqual(this,i)}static isBeforeOrEqual(t,i){return t.lineNumber<i.lineNumber||!(i.lineNumber<t.lineNumber)&&t.column<=i.column}static compare(t,i){const e=0|t.lineNumber,s=0|i.lineNumber;return e===s?(0|t.column)-(0|i.column):e-s}clone(){return new t(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(i){return new t(i.lineNumber,i.column)}static isIPosition(t){return t&&typeof t.lineNumber=="number"&&typeof t.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}},Cs=class t{constructor(t,i,e,s){t>e||t===e&&i>s?(this.startLineNumber=e,this.startColumn=s,this.endLineNumber=t,this.endColumn=i):(this.startLineNumber=t,this.startColumn=i,this.endLineNumber=e,this.endColumn=s)}isEmpty(){return t.isEmpty(this)}static isEmpty(t){return t.startLineNumber===t.endLineNumber&&t.startColumn===t.endColumn}containsPosition(i){return t.containsPosition(this,i)}static containsPosition(t,i){return!(i.lineNumber<t.startLineNumber||i.lineNumber>t.endLineNumber)&&!(i.lineNumber===t.startLineNumber&&i.column<t.startColumn)&&!(i.lineNumber===t.endLineNumber&&i.column>t.endColumn)}static strictContainsPosition(t,i){return!(i.lineNumber<t.startLineNumber||i.lineNumber>t.endLineNumber)&&!(i.lineNumber===t.startLineNumber&&i.column<=t.startColumn)&&!(i.lineNumber===t.endLineNumber&&i.column>=t.endColumn)}containsRange(i){return t.containsRange(this,i)}static containsRange(t,i){return!(i.startLineNumber<t.startLineNumber||i.endLineNumber<t.startLineNumber)&&!(i.startLineNumber>t.endLineNumber||i.endLineNumber>t.endLineNumber)&&!(i.startLineNumber===t.startLineNumber&&i.startColumn<t.startColumn)&&!(i.endLineNumber===t.endLineNumber&&i.endColumn>t.endColumn)}strictContainsRange(i){return t.strictContainsRange(this,i)}static strictContainsRange(t,i){return!(i.startLineNumber<t.startLineNumber||i.endLineNumber<t.startLineNumber)&&!(i.startLineNumber>t.endLineNumber||i.endLineNumber>t.endLineNumber)&&!(i.startLineNumber===t.startLineNumber&&i.startColumn<=t.startColumn)&&!(i.endLineNumber===t.endLineNumber&&i.endColumn>=t.endColumn)}plusRange(i){return t.plusRange(this,i)}static plusRange(i,e){let s,n,r,o;return e.startLineNumber<i.startLineNumber?(s=e.startLineNumber,n=e.startColumn):e.startLineNumber===i.startLineNumber?(s=e.startLineNumber,n=Math.min(e.startColumn,i.startColumn)):(s=i.startLineNumber,n=i.startColumn),e.endLineNumber>i.endLineNumber?(r=e.endLineNumber,o=e.endColumn):e.endLineNumber===i.endLineNumber?(r=e.endLineNumber,o=Math.max(e.endColumn,i.endColumn)):(r=i.endLineNumber,o=i.endColumn),new t(s,n,r,o)}intersectRanges(i){return t.intersectRanges(this,i)}static intersectRanges(i,e){let s=i.startLineNumber,n=i.startColumn,r=i.endLineNumber,o=i.endColumn;const h=e.startLineNumber,c=e.startColumn,l=e.endLineNumber,a=e.endColumn;return s<h?(s=h,n=c):s===h&&(n=Math.max(n,c)),r>l?(r=l,o=a):r===l&&(o=Math.min(o,a)),s>r||s===r&&n>o?null:new t(s,n,r,o)}equalsRange(i){return t.equalsRange(this,i)}static equalsRange(t,i){return!t&&!i||!!t&&!!i&&t.startLineNumber===i.startLineNumber&&t.startColumn===i.startColumn&&t.endLineNumber===i.endLineNumber&&t.endColumn===i.endColumn}getEndPosition(){return t.getEndPosition(this)}static getEndPosition(t){return new ks(t.endLineNumber,t.endColumn)}getStartPosition(){return t.getStartPosition(this)}static getStartPosition(t){return new ks(t.startLineNumber,t.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(i,e){return new t(this.startLineNumber,this.startColumn,i,e)}setStartPosition(i,e){return new t(i,e,this.endLineNumber,this.endColumn)}collapseToStart(){return t.collapseToStart(this)}static collapseToStart(i){return new t(i.startLineNumber,i.startColumn,i.startLineNumber,i.startColumn)}collapseToEnd(){return t.collapseToEnd(this)}static collapseToEnd(i){return new t(i.endLineNumber,i.endColumn,i.endLineNumber,i.endColumn)}delta(i){return new t(this.startLineNumber+i,this.startColumn,this.endLineNumber+i,this.endColumn)}static fromPositions(i,e=i){return new t(i.lineNumber,i.column,e.lineNumber,e.column)}static lift(i){return i?new t(i.startLineNumber,i.startColumn,i.endLineNumber,i.endColumn):null}static isIRange(t){return t&&typeof t.startLineNumber=="number"&&typeof t.startColumn=="number"&&typeof t.endLineNumber=="number"&&typeof t.endColumn=="number"}static areIntersectingOrTouching(t,i){return!(t.endLineNumber<i.startLineNumber||t.endLineNumber===i.startLineNumber&&t.endColumn<i.startColumn)&&!(i.endLineNumber<t.startLineNumber||i.endLineNumber===t.startLineNumber&&i.endColumn<t.startColumn)}static areIntersecting(t,i){return!(t.endLineNumber<i.startLineNumber||t.endLineNumber===i.startLineNumber&&t.endColumn<=i.startColumn)&&!(i.endLineNumber<t.startLineNumber||i.endLineNumber===t.startLineNumber&&i.endColumn<=t.startColumn)}static compareRangesUsingStarts(t,i){if(t&&i){const e=0|t.startLineNumber,s=0|i.startLineNumber;if(e===s){const e=0|t.startColumn,s=0|i.startColumn;if(e===s){const e=0|t.endLineNumber,s=0|i.endLineNumber;return e===s?(0|t.endColumn)-(0|i.endColumn):e-s}return e-s}return e-s}return(t?1:0)-(i?1:0)}static compareRangesUsingEnds(t,i){return t.endLineNumber===i.endLineNumber?t.endColumn===i.endColumn?t.startLineNumber===i.startLineNumber?t.startColumn-i.startColumn:t.startLineNumber-i.startLineNumber:t.endColumn-i.endColumn:t.endLineNumber-i.endLineNumber}static spansMultipleLines(t){return t.endLineNumber>t.startLineNumber}toJSON(){return this}},Ss=class t extends Cs{constructor(t,i,e,s){super(t,i,e,s),this.selectionStartLineNumber=t,this.selectionStartColumn=i,this.positionLineNumber=e,this.positionColumn=s}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(i){return t.selectionsEqual(this,i)}static selectionsEqual(t,i){return t.selectionStartLineNumber===i.selectionStartLineNumber&&t.selectionStartColumn===i.selectionStartColumn&&t.positionLineNumber===i.positionLineNumber&&t.positionColumn===i.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(i,e){return this.getDirection()===0?new t(this.startLineNumber,this.startColumn,i,e):new t(i,e,this.startLineNumber,this.startColumn)}getPosition(){return new ks(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new ks(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(i,e){return this.getDirection()===0?new t(i,e,this.endLineNumber,this.endColumn):new t(this.endLineNumber,this.endColumn,i,e)}static fromPositions(i,e=i){return new t(i.lineNumber,i.column,e.lineNumber,e.column)}static fromRange(i,e){return e===0?new t(i.startLineNumber,i.startColumn,i.endLineNumber,i.endColumn):new t(i.endLineNumber,i.endColumn,i.startLineNumber,i.startColumn)}static liftSelection(i){return new t(i.selectionStartLineNumber,i.selectionStartColumn,i.positionLineNumber,i.positionColumn)}static selectionsArrEqual(t,i){if(t&&!i||!t&&i)return!1;if(!t&&!i)return!0;if(t.length!==i.length)return!1;for(let e=0,s=t.length;e<s;e++)if(!this.selectionsEqual(t[e],i[e]))return!1;return!0}static isISelection(t){return t&&typeof t.selectionStartLineNumber=="number"&&typeof t.selectionStartColumn=="number"&&typeof t.positionLineNumber=="number"&&typeof t.positionColumn=="number"}static createWithDirection(i,e,s,n,r){return r===0?new t(i,e,s,n):new t(s,n,i,e)}};const xs=Object.create(null);function Ds(t,i){if(R(i)){const e=xs[i];if(e===void 0)throw new Error(`${t} references an unknown codicon: ${i}`);i=e}return xs[t]=i,{id:t}}function Es(){return xs}const As={add:Ds("add",6e4),plus:Ds("plus",6e4),gistNew:Ds("gist-new",6e4),repoCreate:Ds("repo-create",6e4),lightbulb:Ds("lightbulb",60001),lightBulb:Ds("light-bulb",60001),repo:Ds("repo",60002),repoDelete:Ds("repo-delete",60002),gistFork:Ds("gist-fork",60003),repoForked:Ds("repo-forked",60003),gitPullRequest:Ds("git-pull-request",60004),gitPullRequestAbandoned:Ds("git-pull-request-abandoned",60004),recordKeys:Ds("record-keys",60005),keyboard:Ds("keyboard",60005),tag:Ds("tag",60006),gitPullRequestLabel:Ds("git-pull-request-label",60006),tagAdd:Ds("tag-add",60006),tagRemove:Ds("tag-remove",60006),person:Ds("person",60007),personFollow:Ds("person-follow",60007),personOutline:Ds("person-outline",60007),personFilled:Ds("person-filled",60007),gitBranch:Ds("git-branch",60008),gitBranchCreate:Ds("git-branch-create",60008),gitBranchDelete:Ds("git-branch-delete",60008),sourceControl:Ds("source-control",60008),mirror:Ds("mirror",60009),mirrorPublic:Ds("mirror-public",60009),star:Ds("star",60010),starAdd:Ds("star-add",60010),starDelete:Ds("star-delete",60010),starEmpty:Ds("star-empty",60010),comment:Ds("comment",60011),commentAdd:Ds("comment-add",60011),alert:Ds("alert",60012),warning:Ds("warning",60012),search:Ds("search",60013),searchSave:Ds("search-save",60013),logOut:Ds("log-out",60014),signOut:Ds("sign-out",60014),logIn:Ds("log-in",60015),signIn:Ds("sign-in",60015),eye:Ds("eye",60016),eyeUnwatch:Ds("eye-unwatch",60016),eyeWatch:Ds("eye-watch",60016),circleFilled:Ds("circle-filled",60017),primitiveDot:Ds("primitive-dot",60017),closeDirty:Ds("close-dirty",60017),debugBreakpoint:Ds("debug-breakpoint",60017),debugBreakpointDisabled:Ds("debug-breakpoint-disabled",60017),debugHint:Ds("debug-hint",60017),terminalDecorationSuccess:Ds("terminal-decoration-success",60017),primitiveSquare:Ds("primitive-square",60018),edit:Ds("edit",60019),pencil:Ds("pencil",60019),info:Ds("info",60020),issueOpened:Ds("issue-opened",60020),gistPrivate:Ds("gist-private",60021),gitForkPrivate:Ds("git-fork-private",60021),lock:Ds("lock",60021),mirrorPrivate:Ds("mirror-private",60021),close:Ds("close",60022),removeClose:Ds("remove-close",60022),x:Ds("x",60022),repoSync:Ds("repo-sync",60023),sync:Ds("sync",60023),clone:Ds("clone",60024),desktopDownload:Ds("desktop-download",60024),beaker:Ds("beaker",60025),microscope:Ds("microscope",60025),vm:Ds("vm",60026),deviceDesktop:Ds("device-desktop",60026),file:Ds("file",60027),fileText:Ds("file-text",60027),more:Ds("more",60028),ellipsis:Ds("ellipsis",60028),kebabHorizontal:Ds("kebab-horizontal",60028),mailReply:Ds("mail-reply",60029),reply:Ds("reply",60029),organization:Ds("organization",60030),organizationFilled:Ds("organization-filled",60030),organizationOutline:Ds("organization-outline",60030),newFile:Ds("new-file",60031),fileAdd:Ds("file-add",60031),newFolder:Ds("new-folder",60032),fileDirectoryCreate:Ds("file-directory-create",60032),trash:Ds("trash",60033),trashcan:Ds("trashcan",60033),history:Ds("history",60034),clock:Ds("clock",60034),folder:Ds("folder",60035),fileDirectory:Ds("file-directory",60035),symbolFolder:Ds("symbol-folder",60035),logoGithub:Ds("logo-github",60036),markGithub:Ds("mark-github",60036),github:Ds("github",60036),terminal:Ds("terminal",60037),console:Ds("console",60037),repl:Ds("repl",60037),zap:Ds("zap",60038),symbolEvent:Ds("symbol-event",60038),error:Ds("error",60039),stop:Ds("stop",60039),variable:Ds("variable",60040),symbolVariable:Ds("symbol-variable",60040),array:Ds("array",60042),symbolArray:Ds("symbol-array",60042),symbolModule:Ds("symbol-module",60043),symbolPackage:Ds("symbol-package",60043),symbolNamespace:Ds("symbol-namespace",60043),symbolObject:Ds("symbol-object",60043),symbolMethod:Ds("symbol-method",60044),symbolFunction:Ds("symbol-function",60044),symbolConstructor:Ds("symbol-constructor",60044),symbolBoolean:Ds("symbol-boolean",60047),symbolNull:Ds("symbol-null",60047),symbolNumeric:Ds("symbol-numeric",60048),symbolNumber:Ds("symbol-number",60048),symbolStructure:Ds("symbol-structure",60049),symbolStruct:Ds("symbol-struct",60049),symbolParameter:Ds("symbol-parameter",60050),symbolTypeParameter:Ds("symbol-type-parameter",60050),symbolKey:Ds("symbol-key",60051),symbolText:Ds("symbol-text",60051),symbolReference:Ds("symbol-reference",60052),goToFile:Ds("go-to-file",60052),symbolEnum:Ds("symbol-enum",60053),symbolValue:Ds("symbol-value",60053),symbolRuler:Ds("symbol-ruler",60054),symbolUnit:Ds("symbol-unit",60054),activateBreakpoints:Ds("activate-breakpoints",60055),archive:Ds("archive",60056),arrowBoth:Ds("arrow-both",60057),arrowDown:Ds("arrow-down",60058),arrowLeft:Ds("arrow-left",60059),arrowRight:Ds("arrow-right",60060),arrowSmallDown:Ds("arrow-small-down",60061),arrowSmallLeft:Ds("arrow-small-left",60062),arrowSmallRight:Ds("arrow-small-right",60063),arrowSmallUp:Ds("arrow-small-up",60064),arrowUp:Ds("arrow-up",60065),bell:Ds("bell",60066),bold:Ds("bold",60067),book:Ds("book",60068),bookmark:Ds("bookmark",60069),debugBreakpointConditionalUnverified:Ds("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:Ds("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:Ds("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:Ds("debug-breakpoint-data-unverified",60072),debugBreakpointData:Ds("debug-breakpoint-data",60073),debugBreakpointDataDisabled:Ds("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:Ds("debug-breakpoint-log-unverified",60074),debugBreakpointLog:Ds("debug-breakpoint-log",60075),debugBreakpointLogDisabled:Ds("debug-breakpoint-log-disabled",60075),briefcase:Ds("briefcase",60076),broadcast:Ds("broadcast",60077),browser:Ds("browser",60078),bug:Ds("bug",60079),calendar:Ds("calendar",60080),caseSensitive:Ds("case-sensitive",60081),check:Ds("check",60082),checklist:Ds("checklist",60083),chevronDown:Ds("chevron-down",60084),chevronLeft:Ds("chevron-left",60085),chevronRight:Ds("chevron-right",60086),chevronUp:Ds("chevron-up",60087),chromeClose:Ds("chrome-close",60088),chromeMaximize:Ds("chrome-maximize",60089),chromeMinimize:Ds("chrome-minimize",60090),chromeRestore:Ds("chrome-restore",60091),circleOutline:Ds("circle-outline",60092),circle:Ds("circle",60092),debugBreakpointUnverified:Ds("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:Ds("terminal-decoration-incomplete",60092),circleSlash:Ds("circle-slash",60093),circuitBoard:Ds("circuit-board",60094),clearAll:Ds("clear-all",60095),clippy:Ds("clippy",60096),closeAll:Ds("close-all",60097),cloudDownload:Ds("cloud-download",60098),cloudUpload:Ds("cloud-upload",60099),code:Ds("code",60100),collapseAll:Ds("collapse-all",60101),colorMode:Ds("color-mode",60102),commentDiscussion:Ds("comment-discussion",60103),creditCard:Ds("credit-card",60105),dash:Ds("dash",60108),dashboard:Ds("dashboard",60109),database:Ds("database",60110),debugContinue:Ds("debug-continue",60111),debugDisconnect:Ds("debug-disconnect",60112),debugPause:Ds("debug-pause",60113),debugRestart:Ds("debug-restart",60114),debugStart:Ds("debug-start",60115),debugStepInto:Ds("debug-step-into",60116),debugStepOut:Ds("debug-step-out",60117),debugStepOver:Ds("debug-step-over",60118),debugStop:Ds("debug-stop",60119),debug:Ds("debug",60120),deviceCameraVideo:Ds("device-camera-video",60121),deviceCamera:Ds("device-camera",60122),deviceMobile:Ds("device-mobile",60123),diffAdded:Ds("diff-added",60124),diffIgnored:Ds("diff-ignored",60125),diffModified:Ds("diff-modified",60126),diffRemoved:Ds("diff-removed",60127),diffRenamed:Ds("diff-renamed",60128),diff:Ds("diff",60129),diffSidebyside:Ds("diff-sidebyside",60129),discard:Ds("discard",60130),editorLayout:Ds("editor-layout",60131),emptyWindow:Ds("empty-window",60132),exclude:Ds("exclude",60133),extensions:Ds("extensions",60134),eyeClosed:Ds("eye-closed",60135),fileBinary:Ds("file-binary",60136),fileCode:Ds("file-code",60137),fileMedia:Ds("file-media",60138),filePdf:Ds("file-pdf",60139),fileSubmodule:Ds("file-submodule",60140),fileSymlinkDirectory:Ds("file-symlink-directory",60141),fileSymlinkFile:Ds("file-symlink-file",60142),fileZip:Ds("file-zip",60143),files:Ds("files",60144),filter:Ds("filter",60145),flame:Ds("flame",60146),foldDown:Ds("fold-down",60147),foldUp:Ds("fold-up",60148),fold:Ds("fold",60149),folderActive:Ds("folder-active",60150),folderOpened:Ds("folder-opened",60151),gear:Ds("gear",60152),gift:Ds("gift",60153),gistSecret:Ds("gist-secret",60154),gist:Ds("gist",60155),gitCommit:Ds("git-commit",60156),gitCompare:Ds("git-compare",60157),compareChanges:Ds("compare-changes",60157),gitMerge:Ds("git-merge",60158),githubAction:Ds("github-action",60159),githubAlt:Ds("github-alt",60160),globe:Ds("globe",60161),grabber:Ds("grabber",60162),graph:Ds("graph",60163),gripper:Ds("gripper",60164),heart:Ds("heart",60165),home:Ds("home",60166),horizontalRule:Ds("horizontal-rule",60167),hubot:Ds("hubot",60168),inbox:Ds("inbox",60169),issueReopened:Ds("issue-reopened",60171),issues:Ds("issues",60172),italic:Ds("italic",60173),jersey:Ds("jersey",60174),json:Ds("json",60175),kebabVertical:Ds("kebab-vertical",60176),key:Ds("key",60177),law:Ds("law",60178),lightbulbAutofix:Ds("lightbulb-autofix",60179),linkExternal:Ds("link-external",60180),link:Ds("link",60181),listOrdered:Ds("list-ordered",60182),listUnordered:Ds("list-unordered",60183),liveShare:Ds("live-share",60184),loading:Ds("loading",60185),location:Ds("location",60186),mailRead:Ds("mail-read",60187),mail:Ds("mail",60188),markdown:Ds("markdown",60189),megaphone:Ds("megaphone",60190),mention:Ds("mention",60191),milestone:Ds("milestone",60192),gitPullRequestMilestone:Ds("git-pull-request-milestone",60192),mortarBoard:Ds("mortar-board",60193),move:Ds("move",60194),multipleWindows:Ds("multiple-windows",60195),mute:Ds("mute",60196),noNewline:Ds("no-newline",60197),note:Ds("note",60198),octoface:Ds("octoface",60199),openPreview:Ds("open-preview",60200),package:Ds("package",60201),paintcan:Ds("paintcan",60202),pin:Ds("pin",60203),play:Ds("play",60204),run:Ds("run",60204),plug:Ds("plug",60205),preserveCase:Ds("preserve-case",60206),preview:Ds("preview",60207),project:Ds("project",60208),pulse:Ds("pulse",60209),question:Ds("question",60210),quote:Ds("quote",60211),radioTower:Ds("radio-tower",60212),reactions:Ds("reactions",60213),references:Ds("references",60214),refresh:Ds("refresh",60215),regex:Ds("regex",60216),remoteExplorer:Ds("remote-explorer",60217),remote:Ds("remote",60218),remove:Ds("remove",60219),replaceAll:Ds("replace-all",60220),replace:Ds("replace",60221),repoClone:Ds("repo-clone",60222),repoForcePush:Ds("repo-force-push",60223),repoPull:Ds("repo-pull",60224),repoPush:Ds("repo-push",60225),report:Ds("report",60226),requestChanges:Ds("request-changes",60227),rocket:Ds("rocket",60228),rootFolderOpened:Ds("root-folder-opened",60229),rootFolder:Ds("root-folder",60230),rss:Ds("rss",60231),ruby:Ds("ruby",60232),saveAll:Ds("save-all",60233),saveAs:Ds("save-as",60234),save:Ds("save",60235),screenFull:Ds("screen-full",60236),screenNormal:Ds("screen-normal",60237),searchStop:Ds("search-stop",60238),server:Ds("server",60240),settingsGear:Ds("settings-gear",60241),settings:Ds("settings",60242),shield:Ds("shield",60243),smiley:Ds("smiley",60244),sortPrecedence:Ds("sort-precedence",60245),splitHorizontal:Ds("split-horizontal",60246),splitVertical:Ds("split-vertical",60247),squirrel:Ds("squirrel",60248),starFull:Ds("star-full",60249),starHalf:Ds("star-half",60250),symbolClass:Ds("symbol-class",60251),symbolColor:Ds("symbol-color",60252),symbolConstant:Ds("symbol-constant",60253),symbolEnumMember:Ds("symbol-enum-member",60254),symbolField:Ds("symbol-field",60255),symbolFile:Ds("symbol-file",60256),symbolInterface:Ds("symbol-interface",60257),symbolKeyword:Ds("symbol-keyword",60258),symbolMisc:Ds("symbol-misc",60259),symbolOperator:Ds("symbol-operator",60260),symbolProperty:Ds("symbol-property",60261),wrench:Ds("wrench",60261),wrenchSubaction:Ds("wrench-subaction",60261),symbolSnippet:Ds("symbol-snippet",60262),tasklist:Ds("tasklist",60263),telescope:Ds("telescope",60264),textSize:Ds("text-size",60265),threeBars:Ds("three-bars",60266),thumbsdown:Ds("thumbsdown",60267),thumbsup:Ds("thumbsup",60268),tools:Ds("tools",60269),triangleDown:Ds("triangle-down",60270),triangleLeft:Ds("triangle-left",60271),triangleRight:Ds("triangle-right",60272),triangleUp:Ds("triangle-up",60273),twitter:Ds("twitter",60274),unfold:Ds("unfold",60275),unlock:Ds("unlock",60276),unmute:Ds("unmute",60277),unverified:Ds("unverified",60278),verified:Ds("verified",60279),versions:Ds("versions",60280),vmActive:Ds("vm-active",60281),vmOutline:Ds("vm-outline",60282),vmRunning:Ds("vm-running",60283),watch:Ds("watch",60284),whitespace:Ds("whitespace",60285),wholeWord:Ds("whole-word",60286),window:Ds("window",60287),wordWrap:Ds("word-wrap",60288),zoomIn:Ds("zoom-in",60289),zoomOut:Ds("zoom-out",60290),listFilter:Ds("list-filter",60291),listFlat:Ds("list-flat",60292),listSelection:Ds("list-selection",60293),selection:Ds("selection",60293),listTree:Ds("list-tree",60294),debugBreakpointFunctionUnverified:Ds("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:Ds("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:Ds("debug-breakpoint-function-disabled",60296),debugStackframeActive:Ds("debug-stackframe-active",60297),circleSmallFilled:Ds("circle-small-filled",60298),debugStackframeDot:Ds("debug-stackframe-dot",60298),terminalDecorationMark:Ds("terminal-decoration-mark",60298),debugStackframe:Ds("debug-stackframe",60299),debugStackframeFocused:Ds("debug-stackframe-focused",60299),debugBreakpointUnsupported:Ds("debug-breakpoint-unsupported",60300),symbolString:Ds("symbol-string",60301),debugReverseContinue:Ds("debug-reverse-continue",60302),debugStepBack:Ds("debug-step-back",60303),debugRestartFrame:Ds("debug-restart-frame",60304),debugAlt:Ds("debug-alt",60305),callIncoming:Ds("call-incoming",60306),callOutgoing:Ds("call-outgoing",60307),menu:Ds("menu",60308),expandAll:Ds("expand-all",60309),feedback:Ds("feedback",60310),gitPullRequestReviewer:Ds("git-pull-request-reviewer",60310),groupByRefType:Ds("group-by-ref-type",60311),ungroupByRefType:Ds("ungroup-by-ref-type",60312),account:Ds("account",60313),gitPullRequestAssignee:Ds("git-pull-request-assignee",60313),bellDot:Ds("bell-dot",60314),debugConsole:Ds("debug-console",60315),library:Ds("library",60316),output:Ds("output",60317),runAll:Ds("run-all",60318),syncIgnored:Ds("sync-ignored",60319),pinned:Ds("pinned",60320),githubInverted:Ds("github-inverted",60321),serverProcess:Ds("server-process",60322),serverEnvironment:Ds("server-environment",60323),pass:Ds("pass",60324),issueClosed:Ds("issue-closed",60324),stopCircle:Ds("stop-circle",60325),playCircle:Ds("play-circle",60326),record:Ds("record",60327),debugAltSmall:Ds("debug-alt-small",60328),vmConnect:Ds("vm-connect",60329),cloud:Ds("cloud",60330),merge:Ds("merge",60331),export:Ds("export",60332),graphLeft:Ds("graph-left",60333),magnet:Ds("magnet",60334),notebook:Ds("notebook",60335),redo:Ds("redo",60336),checkAll:Ds("check-all",60337),pinnedDirty:Ds("pinned-dirty",60338),passFilled:Ds("pass-filled",60339),circleLargeFilled:Ds("circle-large-filled",60340),circleLarge:Ds("circle-large",60341),circleLargeOutline:Ds("circle-large-outline",60341),combine:Ds("combine",60342),gather:Ds("gather",60342),table:Ds("table",60343),variableGroup:Ds("variable-group",60344),typeHierarchy:Ds("type-hierarchy",60345),typeHierarchySub:Ds("type-hierarchy-sub",60346),typeHierarchySuper:Ds("type-hierarchy-super",60347),gitPullRequestCreate:Ds("git-pull-request-create",60348),runAbove:Ds("run-above",60349),runBelow:Ds("run-below",60350),notebookTemplate:Ds("notebook-template",60351),debugRerun:Ds("debug-rerun",60352),workspaceTrusted:Ds("workspace-trusted",60353),workspaceUntrusted:Ds("workspace-untrusted",60354),workspaceUnknown:Ds("workspace-unknown",60355),terminalCmd:Ds("terminal-cmd",60356),terminalDebian:Ds("terminal-debian",60357),terminalLinux:Ds("terminal-linux",60358),terminalPowershell:Ds("terminal-powershell",60359),terminalTmux:Ds("terminal-tmux",60360),terminalUbuntu:Ds("terminal-ubuntu",60361),terminalBash:Ds("terminal-bash",60362),arrowSwap:Ds("arrow-swap",60363),copy:Ds("copy",60364),personAdd:Ds("person-add",60365),filterFilled:Ds("filter-filled",60366),wand:Ds("wand",60367),debugLineByLine:Ds("debug-line-by-line",60368),inspect:Ds("inspect",60369),layers:Ds("layers",60370),layersDot:Ds("layers-dot",60371),layersActive:Ds("layers-active",60372),compass:Ds("compass",60373),compassDot:Ds("compass-dot",60374),compassActive:Ds("compass-active",60375),azure:Ds("azure",60376),issueDraft:Ds("issue-draft",60377),gitPullRequestClosed:Ds("git-pull-request-closed",60378),gitPullRequestDraft:Ds("git-pull-request-draft",60379),debugAll:Ds("debug-all",60380),debugCoverage:Ds("debug-coverage",60381),runErrors:Ds("run-errors",60382),folderLibrary:Ds("folder-library",60383),debugContinueSmall:Ds("debug-continue-small",60384),beakerStop:Ds("beaker-stop",60385),graphLine:Ds("graph-line",60386),graphScatter:Ds("graph-scatter",60387),pieChart:Ds("pie-chart",60388),bracket:Ds("bracket",60175),bracketDot:Ds("bracket-dot",60389),bracketError:Ds("bracket-error",60390),lockSmall:Ds("lock-small",60391),azureDevops:Ds("azure-devops",60392),verifiedFilled:Ds("verified-filled",60393),newline:Ds("newline",60394),layout:Ds("layout",60395),layoutActivitybarLeft:Ds("layout-activitybar-left",60396),layoutActivitybarRight:Ds("layout-activitybar-right",60397),layoutPanelLeft:Ds("layout-panel-left",60398),layoutPanelCenter:Ds("layout-panel-center",60399),layoutPanelJustify:Ds("layout-panel-justify",60400),layoutPanelRight:Ds("layout-panel-right",60401),layoutPanel:Ds("layout-panel",60402),layoutSidebarLeft:Ds("layout-sidebar-left",60403),layoutSidebarRight:Ds("layout-sidebar-right",60404),layoutStatusbar:Ds("layout-statusbar",60405),layoutMenubar:Ds("layout-menubar",60406),layoutCentered:Ds("layout-centered",60407),target:Ds("target",60408),indent:Ds("indent",60409),recordSmall:Ds("record-small",60410),errorSmall:Ds("error-small",60411),terminalDecorationError:Ds("terminal-decoration-error",60411),arrowCircleDown:Ds("arrow-circle-down",60412),arrowCircleLeft:Ds("arrow-circle-left",60413),arrowCircleRight:Ds("arrow-circle-right",60414),arrowCircleUp:Ds("arrow-circle-up",60415),layoutSidebarRightOff:Ds("layout-sidebar-right-off",60416),layoutPanelOff:Ds("layout-panel-off",60417),layoutSidebarLeftOff:Ds("layout-sidebar-left-off",60418),blank:Ds("blank",60419),heartFilled:Ds("heart-filled",60420),map:Ds("map",60421),mapHorizontal:Ds("map-horizontal",60421),foldHorizontal:Ds("fold-horizontal",60421),mapFilled:Ds("map-filled",60422),mapHorizontalFilled:Ds("map-horizontal-filled",60422),foldHorizontalFilled:Ds("fold-horizontal-filled",60422),circleSmall:Ds("circle-small",60423),bellSlash:Ds("bell-slash",60424),bellSlashDot:Ds("bell-slash-dot",60425),commentUnresolved:Ds("comment-unresolved",60426),gitPullRequestGoToChanges:Ds("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:Ds("git-pull-request-new-changes",60428),searchFuzzy:Ds("search-fuzzy",60429),commentDraft:Ds("comment-draft",60430),send:Ds("send",60431),sparkle:Ds("sparkle",60432),insert:Ds("insert",60433),mic:Ds("mic",60434),thumbsdownFilled:Ds("thumbsdown-filled",60435),thumbsupFilled:Ds("thumbsup-filled",60436),coffee:Ds("coffee",60437),snake:Ds("snake",60438),game:Ds("game",60439),vr:Ds("vr",60440),chip:Ds("chip",60441),piano:Ds("piano",60442),music:Ds("music",60443),micFilled:Ds("mic-filled",60444),repoFetch:Ds("repo-fetch",60445),copilot:Ds("copilot",60446),lightbulbSparkle:Ds("lightbulb-sparkle",60447),robot:Ds("robot",60448),sparkleFilled:Ds("sparkle-filled",60449),diffSingle:Ds("diff-single",60450),diffMultiple:Ds("diff-multiple",60451),surroundWith:Ds("surround-with",60452),share:Ds("share",60453),gitStash:Ds("git-stash",60454),gitStashApply:Ds("git-stash-apply",60455),gitStashPop:Ds("git-stash-pop",60456),vscode:Ds("vscode",60457),vscodeInsiders:Ds("vscode-insiders",60458),codeOss:Ds("code-oss",60459),runCoverage:Ds("run-coverage",60460),runAllCoverage:Ds("run-all-coverage",60461),coverage:Ds("coverage",60462),githubProject:Ds("github-project",60463),mapVertical:Ds("map-vertical",60464),foldVertical:Ds("fold-vertical",60464),mapVerticalFilled:Ds("map-vertical-filled",60465),foldVerticalFilled:Ds("fold-vertical-filled",60465),dialogError:Ds("dialog-error","error"),dialogWarning:Ds("dialog-warning","warning"),dialogInfo:Ds("dialog-info","info"),dialogClose:Ds("dialog-close","close"),treeItemExpanded:Ds("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:Ds("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:Ds("tree-filter-on-type-off","list-selection"),treeFilterClear:Ds("tree-filter-clear","close"),treeItemLoading:Ds("tree-item-loading","loading"),menuSelection:Ds("menu-selection","check"),menuSubmenu:Ds("menu-submenu","chevron-right"),menuBarMore:Ds("menubar-more","more"),scrollbarButtonLeft:Ds("scrollbar-button-left","triangle-left"),scrollbarButtonRight:Ds("scrollbar-button-right","triangle-right"),scrollbarButtonUp:Ds("scrollbar-button-up","triangle-up"),scrollbarButtonDown:Ds("scrollbar-button-down","triangle-down"),toolBarMore:Ds("toolbar-more","more"),quickInputBack:Ds("quick-input-back","arrow-left"),dropDownButton:Ds("drop-down-button",60084),symbolCustomColor:Ds("symbol-customcolor",60252),exportIcon:Ds("export",60332),workspaceUnspecified:Ds("workspace-unspecified",60355),newLine:Ds("newline",60394),thumbsDownFilled:Ds("thumbsdown-filled",60435),thumbsUpFilled:Ds("thumbsup-filled",60436),gitFetch:Ds("git-fetch",60445),lightbulbSparkleAutofix:Ds("lightbulb-sparkle-autofix",60447),debugBreakpointPending:Ds("debug-breakpoint-pending",60377)};class Ms extends Qi{get isResolved(){return this._isResolved}constructor(t,i,e){super(),this._registry=t,this._languageId=i,this._factory=e,this._isDisposed=!1,this._resolvePromise=null,this._isResolved=!1}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){const t=await this._factory.tokenizationSupport;this._isResolved=!0,t&&!this._isDisposed&&this._register(this._registry.register(this._languageId,t))}}let Ls=class{constructor(t,i,e){this.offset=t,this.type=i,this.language=e,this._tokenBrand=void 0}toString(){return"("+this.offset+", "+this.type+")"}};class Fs{constructor(t,i){this.tokens=t,this.endState=i,this._tokenizationResultBrand=void 0}}class Ts{constructor(t,i){this.tokens=t,this.endState=i,this._encodedTokenizationResultBrand=void 0}}var Rs,Os,Is,_s,Ps;(function(t){const i=new Map;i.set(0,As.symbolMethod),i.set(1,As.symbolFunction),i.set(2,As.symbolConstructor),i.set(3,As.symbolField),i.set(4,As.symbolVariable),i.set(5,As.symbolClass),i.set(6,As.symbolStruct),i.set(7,As.symbolInterface),i.set(8,As.symbolModule),i.set(9,As.symbolProperty),i.set(10,As.symbolEvent),i.set(11,As.symbolOperator),i.set(12,As.symbolUnit),i.set(13,As.symbolValue),i.set(15,As.symbolEnum),i.set(14,As.symbolConstant),i.set(15,As.symbolEnum),i.set(16,As.symbolEnumMember),i.set(17,As.symbolKeyword),i.set(27,As.symbolSnippet),i.set(18,As.symbolText),i.set(19,As.symbolColor),i.set(20,As.symbolFile),i.set(21,As.symbolReference),i.set(22,As.symbolCustomColor),i.set(23,As.symbolFolder),i.set(24,As.symbolTypeParameter),i.set(25,As.account),i.set(26,As.issues),t.toIcon=function(t){let e=i.get(t);return e||(console.info("No codicon found for CompletionItemKind "+t),e=As.symbolProperty),e};const e=new Map;e.set("method",0),e.set("function",1),e.set("constructor",2),e.set("field",3),e.set("variable",4),e.set("class",5),e.set("struct",6),e.set("interface",7),e.set("module",8),e.set("property",9),e.set("event",10),e.set("operator",11),e.set("unit",12),e.set("value",13),e.set("constant",14),e.set("enum",15),e.set("enum-member",16),e.set("enumMember",16),e.set("keyword",17),e.set("snippet",27),e.set("text",18),e.set("color",19),e.set("file",20),e.set("reference",21),e.set("customcolor",22),e.set("folder",23),e.set("type-parameter",24),e.set("typeParameter",24),e.set("account",25),e.set("issue",26),t.fromString=function(t,i){let s=e.get(t);return s!==void 0||i||(s=9),s}})(Rs||(Rs={})),function(t){t[t.Automatic=0]="Automatic",t[t.Explicit=1]="Explicit"}(Os||(Os={}));class Ns{constructor(t,i,e,s){this.range=t,this.text=i,this.completionKind=e,this.isSnippetText=s}equals(t){return Cs.lift(this.range).equalsRange(t.range)&&this.text===t.text&&this.completionKind===t.completionKind&&this.isSnippetText===t.isSnippetText}}(function(t){t[t.Automatic=0]="Automatic",t[t.PasteAs=1]="PasteAs"})(Is||(Is={})),function(t){t[t.Invoke=1]="Invoke",t[t.TriggerCharacter=2]="TriggerCharacter",t[t.ContentChange=3]="ContentChange"}(_s||(_s={})),function(t){t[t.Text=0]="Text",t[t.Read=1]="Read",t[t.Write=2]="Write"}(Ps||(Ps={}));const Bs={17:tt(0,"array"),16:tt(0,"boolean"),4:tt(0,"class"),13:tt(0,"constant"),8:tt(0,"constructor"),9:tt(0,"enumeration"),21:tt(0,"enumeration member"),23:tt(0,"event"),7:tt(0,"field"),0:tt(0,"file"),11:tt(0,"function"),10:tt(0,"interface"),19:tt(0,"key"),5:tt(0,"method"),1:tt(0,"module"),2:tt(0,"namespace"),20:tt(0,"null"),15:tt(0,"number"),18:tt(0,"object"),24:tt(0,"operator"),3:tt(0,"package"),6:tt(0,"property"),14:tt(0,"string"),22:tt(0,"struct"),25:tt(0,"type parameter"),12:tt(0,"variable")};var $s,Ws,js,Hs;(function(t){const i=new Map;i.set(0,As.symbolFile),i.set(1,As.symbolModule),i.set(2,As.symbolNamespace),i.set(3,As.symbolPackage),i.set(4,As.symbolClass),i.set(5,As.symbolMethod),i.set(6,As.symbolProperty),i.set(7,As.symbolField),i.set(8,As.symbolConstructor),i.set(9,As.symbolEnum),i.set(10,As.symbolInterface),i.set(11,As.symbolFunction),i.set(12,As.symbolVariable),i.set(13,As.symbolConstant),i.set(14,As.symbolString),i.set(15,As.symbolNumber),i.set(16,As.symbolBoolean),i.set(17,As.symbolArray),i.set(18,As.symbolObject),i.set(19,As.symbolKey),i.set(20,As.symbolNull),i.set(21,As.symbolEnumMember),i.set(22,As.symbolStruct),i.set(23,As.symbolEvent),i.set(24,As.symbolOperator),i.set(25,As.symbolTypeParameter),t.toIcon=function(t){let e=i.get(t);return e||(console.info("No codicon found for SymbolKind "+t),e=As.symbolProperty),e}})($s||($s={}));class Vs{static fromValue(t){switch(t){case"comment":return Vs.Comment;case"imports":return Vs.Imports;case"region":return Vs.Region}return new Vs(t)}constructor(t){this.value=t}}Vs.Comment=new Vs("comment"),Vs.Imports=new Vs("imports"),Vs.Region=new Vs("region"),function(t){t[t.AIGenerated=1]="AIGenerated"}(Ws||(Ws={})),(js||(js={})).is=function(t){return!(!t||typeof t!="object")&&typeof t.id=="string"&&typeof t.title=="string"},function(t){t[t.Type=1]="Type",t[t.Parameter=2]="Parameter"}(Hs||(Hs={}));class zs{constructor(t){this.createSupport=t,this._tokenizationSupport=null}dispose(){this._tokenizationSupport&&this._tokenizationSupport.then((t=>{t&&t.dispose()}))}get tokenizationSupport(){return this._tokenizationSupport||(this._tokenizationSupport=this.createSupport()),this._tokenizationSupport}}const Us=new class{constructor(){this._tokenizationSupports=new Map,this._factories=new Map,this._onDidChange=new le,this.onDidChange=this._onDidChange.event,this._colorMap=null}handleChange(t){this._onDidChange.fire({changedLanguages:t,changedColorMap:!1})}register(t,i){return this._tokenizationSupports.set(t,i),this.handleChange([t]),Zi((()=>{this._tokenizationSupports.get(t)===i&&(this._tokenizationSupports.delete(t),this.handleChange([t]))}))}get(t){return this._tokenizationSupports.get(t)||null}registerFactory(t,i){var e;(e=this._factories.get(t))===null||e===void 0||e.dispose();const s=new Ms(this,t,i);return this._factories.set(t,s),Zi((()=>{const i=this._factories.get(t);i&&i===s&&(this._factories.delete(t),i.dispose())}))}async getOrCreate(t){const i=this.get(t);if(i)return i;const e=this._factories.get(t);return!e||e.isResolved?null:(await e.resolve(),this.get(t))}isResolved(t){if(this.get(t))return!0;const i=this._factories.get(t);return!(i&&!i.isResolved)}setColorMap(t){this._colorMap=t,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}};var Ks,qs,Gs,Zs,Js,Qs,Ys,Xs,tn,en,sn,nn,rn,on,hn,cn,ln,an,un,dn,fn,gn,pn,mn,wn,vn,bn,yn,kn,Cn,Sn,xn,Dn,En,An,Mn,Ln,Fn,Tn,Rn,On,In,_n,Pn,Nn;(function(t){t[t.Invoke=0]="Invoke",t[t.Automatic=1]="Automatic"})(Ks||(Ks={})),function(t){t[t.Unknown=0]="Unknown",t[t.Disabled=1]="Disabled",t[t.Enabled=2]="Enabled"}(qs||(qs={})),function(t){t[t.Invoke=1]="Invoke",t[t.Auto=2]="Auto"}(Gs||(Gs={})),function(t){t[t.None=0]="None",t[t.KeepWhitespace=1]="KeepWhitespace",t[t.InsertAsSnippet=4]="InsertAsSnippet"}(Zs||(Zs={})),function(t){t[t.Method=0]="Method",t[t.Function=1]="Function",t[t.Constructor=2]="Constructor",t[t.Field=3]="Field",t[t.Variable=4]="Variable",t[t.Class=5]="Class",t[t.Struct=6]="Struct",t[t.Interface=7]="Interface",t[t.Module=8]="Module",t[t.Property=9]="Property",t[t.Event=10]="Event",t[t.Operator=11]="Operator",t[t.Unit=12]="Unit",t[t.Value=13]="Value",t[t.Constant=14]="Constant",t[t.Enum=15]="Enum",t[t.EnumMember=16]="EnumMember",t[t.Keyword=17]="Keyword",t[t.Text=18]="Text",t[t.Color=19]="Color",t[t.File=20]="File",t[t.Reference=21]="Reference",t[t.Customcolor=22]="Customcolor",t[t.Folder=23]="Folder",t[t.TypeParameter=24]="TypeParameter",t[t.User=25]="User",t[t.Issue=26]="Issue",t[t.Snippet=27]="Snippet"}(Js||(Js={})),function(t){t[t.Deprecated=1]="Deprecated"}(Qs||(Qs={})),function(t){t[t.Invoke=0]="Invoke",t[t.TriggerCharacter=1]="TriggerCharacter",t[t.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"}(Ys||(Ys={})),function(t){t[t.EXACT=0]="EXACT",t[t.ABOVE=1]="ABOVE",t[t.BELOW=2]="BELOW"}(Xs||(Xs={})),function(t){t[t.NotSet=0]="NotSet",t[t.ContentFlush=1]="ContentFlush",t[t.RecoverFromMarkers=2]="RecoverFromMarkers",t[t.Explicit=3]="Explicit",t[t.Paste=4]="Paste",t[t.Undo=5]="Undo",t[t.Redo=6]="Redo"}(tn||(tn={})),function(t){t[t.LF=1]="LF",t[t.CRLF=2]="CRLF"}(en||(en={})),function(t){t[t.Text=0]="Text",t[t.Read=1]="Read",t[t.Write=2]="Write"}(sn||(sn={})),function(t){t[t.None=0]="None",t[t.Keep=1]="Keep",t[t.Brackets=2]="Brackets",t[t.Advanced=3]="Advanced",t[t.Full=4]="Full"}(nn||(nn={})),function(t){t[t.acceptSuggestionOnCommitCharacter=0]="acceptSuggestionOnCommitCharacter",t[t.acceptSuggestionOnEnter=1]="acceptSuggestionOnEnter",t[t.accessibilitySupport=2]="accessibilitySupport",t[t.accessibilityPageSize=3]="accessibilityPageSize",t[t.ariaLabel=4]="ariaLabel",t[t.ariaRequired=5]="ariaRequired",t[t.autoClosingBrackets=6]="autoClosingBrackets",t[t.autoClosingComments=7]="autoClosingComments",t[t.screenReaderAnnounceInlineSuggestion=8]="screenReaderAnnounceInlineSuggestion",t[t.autoClosingDelete=9]="autoClosingDelete",t[t.autoClosingOvertype=10]="autoClosingOvertype",t[t.autoClosingQuotes=11]="autoClosingQuotes",t[t.autoIndent=12]="autoIndent",t[t.automaticLayout=13]="automaticLayout",t[t.autoSurround=14]="autoSurround",t[t.bracketPairColorization=15]="bracketPairColorization",t[t.guides=16]="guides",t[t.codeLens=17]="codeLens",t[t.codeLensFontFamily=18]="codeLensFontFamily",t[t.codeLensFontSize=19]="codeLensFontSize",t[t.colorDecorators=20]="colorDecorators",t[t.colorDecoratorsLimit=21]="colorDecoratorsLimit",t[t.columnSelection=22]="columnSelection",t[t.comments=23]="comments",t[t.contextmenu=24]="contextmenu",t[t.copyWithSyntaxHighlighting=25]="copyWithSyntaxHighlighting",t[t.cursorBlinking=26]="cursorBlinking",t[t.cursorSmoothCaretAnimation=27]="cursorSmoothCaretAnimation",t[t.cursorStyle=28]="cursorStyle",t[t.cursorSurroundingLines=29]="cursorSurroundingLines",t[t.cursorSurroundingLinesStyle=30]="cursorSurroundingLinesStyle",t[t.cursorWidth=31]="cursorWidth",t[t.disableLayerHinting=32]="disableLayerHinting",t[t.disableMonospaceOptimizations=33]="disableMonospaceOptimizations",t[t.domReadOnly=34]="domReadOnly",t[t.dragAndDrop=35]="dragAndDrop",t[t.dropIntoEditor=36]="dropIntoEditor",t[t.emptySelectionClipboard=37]="emptySelectionClipboard",t[t.experimentalWhitespaceRendering=38]="experimentalWhitespaceRendering",t[t.extraEditorClassName=39]="extraEditorClassName",t[t.fastScrollSensitivity=40]="fastScrollSensitivity",t[t.find=41]="find",t[t.fixedOverflowWidgets=42]="fixedOverflowWidgets",t[t.folding=43]="folding",t[t.foldingStrategy=44]="foldingStrategy",t[t.foldingHighlight=45]="foldingHighlight",t[t.foldingImportsByDefault=46]="foldingImportsByDefault",t[t.foldingMaximumRegions=47]="foldingMaximumRegions",t[t.unfoldOnClickAfterEndOfLine=48]="unfoldOnClickAfterEndOfLine",t[t.fontFamily=49]="fontFamily",t[t.fontInfo=50]="fontInfo",t[t.fontLigatures=51]="fontLigatures",t[t.fontSize=52]="fontSize",t[t.fontWeight=53]="fontWeight",t[t.fontVariations=54]="fontVariations",t[t.formatOnPaste=55]="formatOnPaste",t[t.formatOnType=56]="formatOnType",t[t.glyphMargin=57]="glyphMargin",t[t.gotoLocation=58]="gotoLocation",t[t.hideCursorInOverviewRuler=59]="hideCursorInOverviewRuler",t[t.hover=60]="hover",t[t.inDiffEditor=61]="inDiffEditor",t[t.inlineSuggest=62]="inlineSuggest",t[t.inlineEdit=63]="inlineEdit",t[t.letterSpacing=64]="letterSpacing",t[t.lightbulb=65]="lightbulb",t[t.lineDecorationsWidth=66]="lineDecorationsWidth",t[t.lineHeight=67]="lineHeight",t[t.lineNumbers=68]="lineNumbers",t[t.lineNumbersMinChars=69]="lineNumbersMinChars",t[t.linkedEditing=70]="linkedEditing",t[t.links=71]="links",t[t.matchBrackets=72]="matchBrackets",t[t.minimap=73]="minimap",t[t.mouseStyle=74]="mouseStyle",t[t.mouseWheelScrollSensitivity=75]="mouseWheelScrollSensitivity",t[t.mouseWheelZoom=76]="mouseWheelZoom",t[t.multiCursorMergeOverlapping=77]="multiCursorMergeOverlapping",t[t.multiCursorModifier=78]="multiCursorModifier",t[t.multiCursorPaste=79]="multiCursorPaste",t[t.multiCursorLimit=80]="multiCursorLimit",t[t.occurrencesHighlight=81]="occurrencesHighlight",t[t.overviewRulerBorder=82]="overviewRulerBorder",t[t.overviewRulerLanes=83]="overviewRulerLanes",t[t.padding=84]="padding",t[t.pasteAs=85]="pasteAs",t[t.parameterHints=86]="parameterHints",t[t.peekWidgetDefaultFocus=87]="peekWidgetDefaultFocus",t[t.definitionLinkOpensInPeek=88]="definitionLinkOpensInPeek",t[t.quickSuggestions=89]="quickSuggestions",t[t.quickSuggestionsDelay=90]="quickSuggestionsDelay",t[t.readOnly=91]="readOnly",t[t.readOnlyMessage=92]="readOnlyMessage",t[t.renameOnType=93]="renameOnType",t[t.renderControlCharacters=94]="renderControlCharacters",t[t.renderFinalNewline=95]="renderFinalNewline",t[t.renderLineHighlight=96]="renderLineHighlight",t[t.renderLineHighlightOnlyWhenFocus=97]="renderLineHighlightOnlyWhenFocus",t[t.renderValidationDecorations=98]="renderValidationDecorations",t[t.renderWhitespace=99]="renderWhitespace",t[t.revealHorizontalRightPadding=100]="revealHorizontalRightPadding",t[t.roundedSelection=101]="roundedSelection",t[t.rulers=102]="rulers",t[t.scrollbar=103]="scrollbar",t[t.scrollBeyondLastColumn=104]="scrollBeyondLastColumn",t[t.scrollBeyondLastLine=105]="scrollBeyondLastLine",t[t.scrollPredominantAxis=106]="scrollPredominantAxis",t[t.selectionClipboard=107]="selectionClipboard",t[t.selectionHighlight=108]="selectionHighlight",t[t.selectOnLineNumbers=109]="selectOnLineNumbers",t[t.showFoldingControls=110]="showFoldingControls",t[t.showUnused=111]="showUnused",t[t.snippetSuggestions=112]="snippetSuggestions",t[t.smartSelect=113]="smartSelect",t[t.smoothScrolling=114]="smoothScrolling",t[t.stickyScroll=115]="stickyScroll",t[t.stickyTabStops=116]="stickyTabStops",t[t.stopRenderingLineAfter=117]="stopRenderingLineAfter",t[t.suggest=118]="suggest",t[t.suggestFontSize=119]="suggestFontSize",t[t.suggestLineHeight=120]="suggestLineHeight",t[t.suggestOnTriggerCharacters=121]="suggestOnTriggerCharacters",t[t.suggestSelection=122]="suggestSelection",t[t.tabCompletion=123]="tabCompletion",t[t.tabIndex=124]="tabIndex",t[t.unicodeHighlighting=125]="unicodeHighlighting",t[t.unusualLineTerminators=126]="unusualLineTerminators",t[t.useShadowDOM=127]="useShadowDOM",t[t.useTabStops=128]="useTabStops",t[t.wordBreak=129]="wordBreak",t[t.wordSegmenterLocales=130]="wordSegmenterLocales",t[t.wordSeparators=131]="wordSeparators",t[t.wordWrap=132]="wordWrap",t[t.wordWrapBreakAfterCharacters=133]="wordWrapBreakAfterCharacters",t[t.wordWrapBreakBeforeCharacters=134]="wordWrapBreakBeforeCharacters",t[t.wordWrapColumn=135]="wordWrapColumn",t[t.wordWrapOverride1=136]="wordWrapOverride1",t[t.wordWrapOverride2=137]="wordWrapOverride2",t[t.wrappingIndent=138]="wrappingIndent",t[t.wrappingStrategy=139]="wrappingStrategy",t[t.showDeprecated=140]="showDeprecated",t[t.inlayHints=141]="inlayHints",t[t.editorClassName=142]="editorClassName",t[t.pixelRatio=143]="pixelRatio",t[t.tabFocusMode=144]="tabFocusMode",t[t.layoutInfo=145]="layoutInfo",t[t.wrappingInfo=146]="wrappingInfo",t[t.defaultColorDecorators=147]="defaultColorDecorators",t[t.colorDecoratorsActivatedOn=148]="colorDecoratorsActivatedOn",t[t.inlineCompletionsAccessibilityVerbose=149]="inlineCompletionsAccessibilityVerbose"}(rn||(rn={})),function(t){t[t.TextDefined=0]="TextDefined",t[t.LF=1]="LF",t[t.CRLF=2]="CRLF"}(on||(on={})),function(t){t[t.LF=0]="LF",t[t.CRLF=1]="CRLF"}(hn||(hn={})),function(t){t[t.Left=1]="Left",t[t.Center=2]="Center",t[t.Right=3]="Right"}(cn||(cn={})),function(t){t[t.None=0]="None",t[t.Indent=1]="Indent",t[t.IndentOutdent=2]="IndentOutdent",t[t.Outdent=3]="Outdent"}(ln||(ln={})),function(t){t[t.Both=0]="Both",t[t.Right=1]="Right",t[t.Left=2]="Left",t[t.None=3]="None"}(an||(an={})),function(t){t[t.Type=1]="Type",t[t.Parameter=2]="Parameter"}(un||(un={})),function(t){t[t.Automatic=0]="Automatic",t[t.Explicit=1]="Explicit"}(dn||(dn={})),function(t){t[t.Invoke=0]="Invoke",t[t.Automatic=1]="Automatic"}(fn||(fn={})),function(t){t[t.DependsOnKbLayout=-1]="DependsOnKbLayout",t[t.Unknown=0]="Unknown",t[t.Backspace=1]="Backspace",t[t.Tab=2]="Tab",t[t.Enter=3]="Enter",t[t.Shift=4]="Shift",t[t.Ctrl=5]="Ctrl",t[t.Alt=6]="Alt",t[t.PauseBreak=7]="PauseBreak",t[t.CapsLock=8]="CapsLock",t[t.Escape=9]="Escape",t[t.Space=10]="Space",t[t.PageUp=11]="PageUp",t[t.PageDown=12]="PageDown",t[t.End=13]="End",t[t.Home=14]="Home",t[t.LeftArrow=15]="LeftArrow",t[t.UpArrow=16]="UpArrow",t[t.RightArrow=17]="RightArrow",t[t.DownArrow=18]="DownArrow",t[t.Insert=19]="Insert",t[t.Delete=20]="Delete",t[t.Digit0=21]="Digit0",t[t.Digit1=22]="Digit1",t[t.Digit2=23]="Digit2",t[t.Digit3=24]="Digit3",t[t.Digit4=25]="Digit4",t[t.Digit5=26]="Digit5",t[t.Digit6=27]="Digit6",t[t.Digit7=28]="Digit7",t[t.Digit8=29]="Digit8",t[t.Digit9=30]="Digit9",t[t.KeyA=31]="KeyA",t[t.KeyB=32]="KeyB",t[t.KeyC=33]="KeyC",t[t.KeyD=34]="KeyD",t[t.KeyE=35]="KeyE",t[t.KeyF=36]="KeyF",t[t.KeyG=37]="KeyG",t[t.KeyH=38]="KeyH",t[t.KeyI=39]="KeyI",t[t.KeyJ=40]="KeyJ",t[t.KeyK=41]="KeyK",t[t.KeyL=42]="KeyL",t[t.KeyM=43]="KeyM",t[t.KeyN=44]="KeyN",t[t.KeyO=45]="KeyO",t[t.KeyP=46]="KeyP",t[t.KeyQ=47]="KeyQ",t[t.KeyR=48]="KeyR",t[t.KeyS=49]="KeyS",t[t.KeyT=50]="KeyT",t[t.KeyU=51]="KeyU",t[t.KeyV=52]="KeyV",t[t.KeyW=53]="KeyW",t[t.KeyX=54]="KeyX",t[t.KeyY=55]="KeyY",t[t.KeyZ=56]="KeyZ",t[t.Meta=57]="Meta",t[t.ContextMenu=58]="ContextMenu",t[t.F1=59]="F1",t[t.F2=60]="F2",t[t.F3=61]="F3",t[t.F4=62]="F4",t[t.F5=63]="F5",t[t.F6=64]="F6",t[t.F7=65]="F7",t[t.F8=66]="F8",t[t.F9=67]="F9",t[t.F10=68]="F10",t[t.F11=69]="F11",t[t.F12=70]="F12",t[t.F13=71]="F13",t[t.F14=72]="F14",t[t.F15=73]="F15",t[t.F16=74]="F16",t[t.F17=75]="F17",t[t.F18=76]="F18",t[t.F19=77]="F19",t[t.F20=78]="F20",t[t.F21=79]="F21",t[t.F22=80]="F22",t[t.F23=81]="F23",t[t.F24=82]="F24",t[t.NumLock=83]="NumLock",t[t.ScrollLock=84]="ScrollLock",t[t.Semicolon=85]="Semicolon",t[t.Equal=86]="Equal",t[t.Comma=87]="Comma",t[t.Minus=88]="Minus",t[t.Period=89]="Period",t[t.Slash=90]="Slash",t[t.Backquote=91]="Backquote",t[t.BracketLeft=92]="BracketLeft",t[t.Backslash=93]="Backslash",t[t.BracketRight=94]="BracketRight",t[t.Quote=95]="Quote",t[t.OEM_8=96]="OEM_8",t[t.IntlBackslash=97]="IntlBackslash",t[t.Numpad0=98]="Numpad0",t[t.Numpad1=99]="Numpad1",t[t.Numpad2=100]="Numpad2",t[t.Numpad3=101]="Numpad3",t[t.Numpad4=102]="Numpad4",t[t.Numpad5=103]="Numpad5",t[t.Numpad6=104]="Numpad6",t[t.Numpad7=105]="Numpad7",t[t.Numpad8=106]="Numpad8",t[t.Numpad9=107]="Numpad9",t[t.NumpadMultiply=108]="NumpadMultiply",t[t.NumpadAdd=109]="NumpadAdd",t[t.NUMPAD_SEPARATOR=110]="NUMPAD_SEPARATOR",t[t.NumpadSubtract=111]="NumpadSubtract",t[t.NumpadDecimal=112]="NumpadDecimal",t[t.NumpadDivide=113]="NumpadDivide",t[t.KEY_IN_COMPOSITION=114]="KEY_IN_COMPOSITION",t[t.ABNT_C1=115]="ABNT_C1",t[t.ABNT_C2=116]="ABNT_C2",t[t.AudioVolumeMute=117]="AudioVolumeMute",t[t.AudioVolumeUp=118]="AudioVolumeUp",t[t.AudioVolumeDown=119]="AudioVolumeDown",t[t.BrowserSearch=120]="BrowserSearch",t[t.BrowserHome=121]="BrowserHome",t[t.BrowserBack=122]="BrowserBack",t[t.BrowserForward=123]="BrowserForward",t[t.MediaTrackNext=124]="MediaTrackNext",t[t.MediaTrackPrevious=125]="MediaTrackPrevious",t[t.MediaStop=126]="MediaStop",t[t.MediaPlayPause=127]="MediaPlayPause",t[t.LaunchMediaPlayer=128]="LaunchMediaPlayer",t[t.LaunchMail=129]="LaunchMail",t[t.LaunchApp2=130]="LaunchApp2",t[t.Clear=131]="Clear",t[t.MAX_VALUE=132]="MAX_VALUE"}(gn||(gn={})),function(t){t[t.Hint=1]="Hint",t[t.Info=2]="Info",t[t.Warning=4]="Warning",t[t.Error=8]="Error"}(pn||(pn={})),function(t){t[t.Unnecessary=1]="Unnecessary",t[t.Deprecated=2]="Deprecated"}(mn||(mn={})),function(t){t[t.Inline=1]="Inline",t[t.Gutter=2]="Gutter"}(wn||(wn={})),function(t){t[t.Normal=1]="Normal",t[t.Underlined=2]="Underlined"}(vn||(vn={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.TEXTAREA=1]="TEXTAREA",t[t.GUTTER_GLYPH_MARGIN=2]="GUTTER_GLYPH_MARGIN",t[t.GUTTER_LINE_NUMBERS=3]="GUTTER_LINE_NUMBERS",t[t.GUTTER_LINE_DECORATIONS=4]="GUTTER_LINE_DECORATIONS",t[t.GUTTER_VIEW_ZONE=5]="GUTTER_VIEW_ZONE",t[t.CONTENT_TEXT=6]="CONTENT_TEXT",t[t.CONTENT_EMPTY=7]="CONTENT_EMPTY",t[t.CONTENT_VIEW_ZONE=8]="CONTENT_VIEW_ZONE",t[t.CONTENT_WIDGET=9]="CONTENT_WIDGET",t[t.OVERVIEW_RULER=10]="OVERVIEW_RULER",t[t.SCROLLBAR=11]="SCROLLBAR",t[t.OVERLAY_WIDGET=12]="OVERLAY_WIDGET",t[t.OUTSIDE_EDITOR=13]="OUTSIDE_EDITOR"}(bn||(bn={})),function(t){t[t.AIGenerated=1]="AIGenerated"}(yn||(yn={})),function(t){t[t.TOP_RIGHT_CORNER=0]="TOP_RIGHT_CORNER",t[t.BOTTOM_RIGHT_CORNER=1]="BOTTOM_RIGHT_CORNER",t[t.TOP_CENTER=2]="TOP_CENTER"}(kn||(kn={})),function(t){t[t.Left=1]="Left",t[t.Center=2]="Center",t[t.Right=4]="Right",t[t.Full=7]="Full"}(Cn||(Cn={})),function(t){t[t.Word=0]="Word",t[t.Line=1]="Line",t[t.Suggest=2]="Suggest"}(Sn||(Sn={})),function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.None=2]="None",t[t.LeftOfInjectedText=3]="LeftOfInjectedText",t[t.RightOfInjectedText=4]="RightOfInjectedText"}(xn||(xn={})),function(t){t[t.Off=0]="Off",t[t.On=1]="On",t[t.Relative=2]="Relative",t[t.Interval=3]="Interval",t[t.Custom=4]="Custom"}(Dn||(Dn={})),function(t){t[t.None=0]="None",t[t.Text=1]="Text",t[t.Blocks=2]="Blocks"}(En||(En={})),function(t){t[t.Smooth=0]="Smooth",t[t.Immediate=1]="Immediate"}(An||(An={})),function(t){t[t.Auto=1]="Auto",t[t.Hidden=2]="Hidden",t[t.Visible=3]="Visible"}(Mn||(Mn={})),function(t){t[t.LTR=0]="LTR",t[t.RTL=1]="RTL"}(Ln||(Ln={})),function(t){t.Off="off",t.OnCode="onCode",t.On="on"}(Fn||(Fn={})),function(t){t[t.Invoke=1]="Invoke",t[t.TriggerCharacter=2]="TriggerCharacter",t[t.ContentChange=3]="ContentChange"}(Tn||(Tn={})),function(t){t[t.File=0]="File",t[t.Module=1]="Module",t[t.Namespace=2]="Namespace",t[t.Package=3]="Package",t[t.Class=4]="Class",t[t.Method=5]="Method",t[t.Property=6]="Property",t[t.Field=7]="Field",t[t.Constructor=8]="Constructor",t[t.Enum=9]="Enum",t[t.Interface=10]="Interface",t[t.Function=11]="Function",t[t.Variable=12]="Variable",t[t.Constant=13]="Constant",t[t.String=14]="String",t[t.Number=15]="Number",t[t.Boolean=16]="Boolean",t[t.Array=17]="Array",t[t.Object=18]="Object",t[t.Key=19]="Key",t[t.Null=20]="Null",t[t.EnumMember=21]="EnumMember",t[t.Struct=22]="Struct",t[t.Event=23]="Event",t[t.Operator=24]="Operator",t[t.TypeParameter=25]="TypeParameter"}(Rn||(Rn={})),function(t){t[t.Deprecated=1]="Deprecated"}(On||(On={})),function(t){t[t.Hidden=0]="Hidden",t[t.Blink=1]="Blink",t[t.Smooth=2]="Smooth",t[t.Phase=3]="Phase",t[t.Expand=4]="Expand",t[t.Solid=5]="Solid"}(In||(In={})),function(t){t[t.Line=1]="Line",t[t.Block=2]="Block",t[t.Underline=3]="Underline",t[t.LineThin=4]="LineThin",t[t.BlockOutline=5]="BlockOutline",t[t.UnderlineThin=6]="UnderlineThin"}(_n||(_n={})),function(t){t[t.AlwaysGrowsWhenTypingAtEdges=0]="AlwaysGrowsWhenTypingAtEdges",t[t.NeverGrowsWhenTypingAtEdges=1]="NeverGrowsWhenTypingAtEdges",t[t.GrowsOnlyWhenTypingBefore=2]="GrowsOnlyWhenTypingBefore",t[t.GrowsOnlyWhenTypingAfter=3]="GrowsOnlyWhenTypingAfter"}(Pn||(Pn={})),function(t){t[t.None=0]="None",t[t.Same=1]="Same",t[t.Indent=2]="Indent",t[t.DeepIndent=3]="DeepIndent"}(Nn||(Nn={}));let Bn=class{static chord(t,i){return Fe(t,i)}};function $n(){return{editor:void 0,languages:void 0,CancellationTokenSource:ye,Emitter:le,KeyCode:gn,KeyMod:Bn,Position:ks,Range:Cs,Selection:Ss,SelectionDirection:Ln,MarkerSeverity:pn,MarkerTag:mn,Uri:as,Token:Ls}}Bn.CtrlCmd=2048,Bn.Shift=1024,Bn.Alt=512,Bn.WinCtrl=256;const Wn=window;class jn{get cachedValues(){return this._map}constructor(t){this.fn=t,this._map=new Map}get(t){if(this._map.has(t))return this._map.get(t);const i=this.fn(t);return this._map.set(t,i),i}}class Hn{constructor(t){this.executor=t,this._didRun=!1}get value(){if(!this._didRun)try{this._value=this.executor()}catch(t){this._error=t}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}}var Vn;function zn(t){return!t||typeof t!="string"||t.trim().length===0}const Un=/{(\d+)}/g;function Kn(t,...i){return i.length===0?t:t.replace(Un,(function(t,e){const s=parseInt(e,10);return isNaN(s)||s<0||s>=i.length?t:i[s]}))}function qn(t){return t.replace(/[<>&]/g,(function(t){switch(t){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return t}}))}function Gn(t){return t.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function Zn(t,i=" "){return Qn(Jn(t,i),i)}function Jn(t,i){if(!t||!i)return t;const e=i.length;if(e===0||t.length===0)return t;let s=0;for(;t.indexOf(i,s)===s;)s+=e;return t.substring(s)}function Qn(t,i){if(!t||!i)return t;const e=i.length,s=t.length;if(e===0||s===0)return t;let n=s,r=-1;for(;r=t.lastIndexOf(i,n-1),r!==-1&&r+e===n;){if(r===0)return"";n=r}return t.substring(0,n)}function Yn(t,i,e={}){if(!t)throw new Error("Cannot create regex from empty string");i||(t=Gn(t)),e.wholeWord&&(/\B/.test(t.charAt(0))||(t="\\b"+t),/\B/.test(t.charAt(t.length-1))||(t+="\\b"));let s="";return e.global&&(s+="g"),e.matchCase||(s+="i"),e.multiline&&(s+="m"),e.unicode&&(s+="u"),new RegExp(t,s)}function Xn(t){return t.split(/\r\n|\r|\n/)}function tr(t){for(let i=0,e=t.length;i<e;i++){const e=t.charCodeAt(i);if(e!==32&&e!==9)return i}return-1}function ir(t,i=0,e=t.length){for(let s=i;s<e;s++){const e=t.charCodeAt(s);if(e!==32&&e!==9)return t.substring(i,s)}return t.substring(i,e)}function er(t,i=t.length-1){for(let e=i;e>=0;e--){const i=t.charCodeAt(e);if(i!==32&&i!==9)return e}return-1}function sr(t,i){return t<i?-1:t>i?1:0}function nr(t,i,e=0,s=t.length,n=0,r=i.length){for(;e<s&&n<r;e++,n++){const s=t.charCodeAt(e),r=i.charCodeAt(n);if(s<r)return-1;if(s>r)return 1}const o=s-e,h=r-n;return o<h?-1:o>h?1:0}function rr(t,i){return or(t,i,0,t.length,0,i.length)}function or(t,i,e=0,s=t.length,n=0,r=i.length){for(;e<s&&n<r;e++,n++){let o=t.charCodeAt(e),h=i.charCodeAt(n);if(o===h)continue;if(o>=128||h>=128)return nr(t.toLowerCase(),i.toLowerCase(),e,s,n,r);cr(o)&&(o-=32),cr(h)&&(h-=32);const c=o-h;if(c!==0)return c}const o=s-e,h=r-n;return o<h?-1:o>h?1:0}function hr(t){return t>=48&&t<=57}function cr(t){return t>=97&&t<=122}function lr(t){return t>=65&&t<=90}function ar(t,i){return t.length===i.length&&or(t,i)===0}function ur(t,i){const e=i.length;return!(i.length>t.length)&&or(t,i,0,e)===0}function dr(t,i){const e=Math.min(t.length,i.length);let s;for(s=0;s<e;s++)if(t.charCodeAt(s)!==i.charCodeAt(s))return s;return e}function fr(t,i){const e=Math.min(t.length,i.length);let s;const n=t.length-1,r=i.length-1;for(s=0;s<e;s++)if(t.charCodeAt(n-s)!==i.charCodeAt(r-s))return s;return e}function gr(t){return 55296<=t&&t<=56319}function pr(t){return 56320<=t&&t<=57343}function mr(t,i){return i-56320+(t-55296<<10)+65536}function wr(t,i,e){const s=t.charCodeAt(e);if(gr(s)&&e+1<i){const i=t.charCodeAt(e+1);if(pr(i))return mr(s,i)}return s}class vr{get offset(){return this._offset}constructor(t,i=0){this._str=t,this._len=t.length,this._offset=i}setOffset(t){this._offset=t}prevCodePoint(){const t=function(t,i){const e=t.charCodeAt(i-1);if(pr(e)&&i>1){const s=t.charCodeAt(i-2);if(gr(s))return mr(s,e)}return e}(this._str,this._offset);return this._offset-=t>=65536?2:1,t}nextCodePoint(){const t=wr(this._str,this._len,this._offset);return this._offset+=t>=65536?2:1,t}eol(){return this._offset>=this._len}}class br{get offset(){return this._iterator.offset}constructor(t,i=0){this._iterator=new vr(t,i)}nextGraphemeLength(){const t=Ir.getInstance(),i=this._iterator,e=i.offset;let s=t.getGraphemeBreakType(i.nextCodePoint());for(;!i.eol();){const e=i.offset,n=t.getGraphemeBreakType(i.nextCodePoint());if(Or(s,n)){i.setOffset(e);break}s=n}return i.offset-e}prevGraphemeLength(){const t=Ir.getInstance(),i=this._iterator,e=i.offset;let s=t.getGraphemeBreakType(i.prevCodePoint());for(;i.offset>0;){const e=i.offset,n=t.getGraphemeBreakType(i.prevCodePoint());if(Or(n,s)){i.setOffset(e);break}s=n}return e-i.offset}eol(){return this._iterator.eol()}}function yr(t,i){return new br(t,i).nextGraphemeLength()}function kr(t,i){return new br(t,i).prevGraphemeLength()}let Cr;function Sr(t){return Cr||(Cr=/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/),Cr.test(t)}const xr=/^[\t\n\r\x20-\x7E]*$/;function Dr(t){return xr.test(t)}const Er=/[\u2028\u2029]/;function Ar(t){return Er.test(t)}function Mr(t){return t>=11904&&t<=55215||t>=63744&&t<=64255||t>=65281&&t<=65374}function Lr(t){return t>=127462&&t<=127487||t===8986||t===8987||t===9200||t===9203||t>=9728&&t<=10175||t===11088||t===11093||t>=127744&&t<=128591||t>=128640&&t<=128764||t>=128992&&t<=129008||t>=129280&&t<=129535||t>=129648&&t<=129782}const Fr="\ufeff";function Tr(t){return!!(t&&t.length>0&&t.charCodeAt(0)===65279)}function Rr(t){return(t%=52)<26?String.fromCharCode(97+t):String.fromCharCode(65+t-26)}function Or(t,i){return t===0?i!==5&&i!==7:(t!==2||i!==3)&&(t===4||t===2||t===3||i===4||i===2||i===3||(t!==8||i!==8&&i!==9&&i!==11&&i!==12)&&(t!==11&&t!==9||i!==9&&i!==10)&&(t!==12&&t!==10||i!==10)&&i!==5&&i!==13&&i!==7&&t!==1&&(t!==13||i!==14)&&(t!==6||i!==6))}class Ir{static getInstance(){return Ir._INSTANCE||(Ir._INSTANCE=new Ir),Ir._INSTANCE}constructor(){this._data=JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}getGraphemeBreakType(t){if(t<32)return t===10?3:t===13?2:4;if(t<127)return 0;const i=this._data,e=i.length/3;let s=1;for(;s<=e;)if(t<i[3*s])s*=2;else{if(!(t>i[3*s+1]))return i[3*s+2];s=2*s+1}return 0}}function _r(t,i){if(t===0)return 0;const e=function(t,i){const e=new vr(i,t);let s=e.prevCodePoint();for(;Pr(s)||s===65039||s===8419;){if(e.offset===0)return;s=e.prevCodePoint()}if(!Lr(s))return;let n=e.offset;return n>0&&e.prevCodePoint()===8205&&(n=e.offset),n}(t,i);if(e!==void 0)return e;const s=new vr(i,t);return s.prevCodePoint(),s.offset}function Pr(t){return 127995<=t&&t<=127999}Ir._INSTANCE=null;class Nr{static getInstance(t){return Vn.cache.get(Array.from(t))}static getLocales(){return Vn._locales.value}constructor(t){this.confusableDictionary=t}isAmbiguous(t){return this.confusableDictionary.has(t)}getPrimaryConfusable(t){return this.confusableDictionary.get(t)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}}Vn=Nr,Nr.ambiguousCharacterData=new Hn((()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'))),Nr.cache=new class{constructor(t,i=JSON.stringify){this.fn=t,this._computeKey=i,this.lastCache=void 0,this.lastArgKey=void 0}get(t){const i=this._computeKey(t);return this.lastArgKey!==i&&(this.lastArgKey=i,this.lastCache=this.fn(t)),this.lastCache}}((t=>{function i(t){const i=new Map;for(let e=0;e<t.length;e+=2)i.set(t[e],t[e+1]);return i}function e(t,i){if(!t)return i;const e=new Map;for(const[s,n]of t)i.has(s)&&e.set(s,n);return e}const s=Vn.ambiguousCharacterData.value;let n,r=t.filter((t=>!t.startsWith("_")&&t in s));r.length===0&&(r=["_default"]);for(const t of r)n=e(n,i(s[t]));const o=function(t,i){const e=new Map(t);for(const[t,s]of i)e.set(t,s);return e}(i(s._common),n);return new Vn(o)})),Nr._locales=new Hn((()=>Object.keys(Vn.ambiguousCharacterData.value).filter((t=>!t.startsWith("_")))));class Br{static getRawData(){return JSON.parse("[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]")}static getData(){return this._data||(this._data=new Set(Br.getRawData())),this._data}static isInvisibleCharacter(t){return Br.getData().has(t)}static get codePoints(){return Br.getData()}}Br._data=void 0;class $r{constructor(){this.mapWindowIdToZoomFactor=new Map}getZoomFactor(t){var i;return(i=this.mapWindowIdToZoomFactor.get(this.getWindowId(t)))!==null&&i!==void 0?i:1}getWindowId(t){return t.vscodeWindowId}}function Wr(t,i,e){typeof i=="string"&&(i=t.matchMedia(i)),i.addEventListener("change",e)}$r.INSTANCE=new $r;const jr=navigator.userAgent,Hr=jr.indexOf("Firefox")>=0,Vr=jr.indexOf("AppleWebKit")>=0,zr=jr.indexOf("Chrome")>=0,Ur=!zr&&jr.indexOf("Safari")>=0,Kr=!zr&&!Ur&&Vr;jr.indexOf("Electron/");const qr=jr.indexOf("Android")>=0;if(typeof Wn.matchMedia=="function"){const t=Wn.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)");Wn.matchMedia("(display-mode: fullscreen)");Wr(Wn,t,(({matches:t})=>{}))}kt||document.queryCommandSupported&&document.queryCommandSupported("copy")||navigator&&navigator.clipboard&&navigator.clipboard.writeText;const Gr=Wn.PointerEvent&&("ontouchstart"in Wn||navigator.maxTouchPoints>0);function Zr(t,i){if(typeof t=="number"){if(t===0)return null;const e=(65535&t)>>>0,s=(4294901760&t)>>>16;return new Yr(s!==0?[Jr(e,i),Jr(s,i)]:[Jr(e,i)])}{const e=[];for(let s=0;s<t.length;s++)e.push(Jr(t[s],i));return new Yr(e)}}function Jr(t,i){const e=!!(2048&t),s=!!(256&t);return new Qr(i===2?s:e,!!(1024&t),!!(512&t),i===2?e:s,255&t)}class Qr{constructor(t,i,e,s,n){this.ctrlKey=t,this.shiftKey=i,this.altKey=e,this.metaKey=s,this.keyCode=n}equals(t){return t instanceof Qr&&this.ctrlKey===t.ctrlKey&&this.shiftKey===t.shiftKey&&this.altKey===t.altKey&&this.metaKey===t.metaKey&&this.keyCode===t.keyCode}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}}class Yr{constructor(t){if(t.length===0)throw Wi("chords");this.chords=t}}class Xr{constructor(t,i,e,s,n,r){this.ctrlKey=t,this.shiftKey=i,this.altKey=e,this.metaKey=s,this.keyLabel=n,this.keyAriaLabel=r}}class to{}const io=bt?256:2048,eo=bt?2048:256;class so{constructor(t){var i;this._standardKeyboardEventBrand=!0;const e=t;this.browserEvent=e,this.target=e.target,this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.altKey=e.altKey,this.metaKey=e.metaKey,this.altGraphKey=(i=e.getModifierState)===null||i===void 0?void 0:i.call(e,"AltGraph"),this.keyCode=function(t){if(t.charCode){const i=String.fromCharCode(t.charCode).toUpperCase();return Le.fromString(i)}const i=t.keyCode;if(i===3)return 7;if(Hr)switch(i){case 59:return 85;case 60:if(yt)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(bt)return 57}else if(Vr&&(bt&&i===93||!bt&&i===92))return 57;return De[i]||0}(e),this.code=e.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(t){return this._asKeybinding===t}_computeKeybinding(){let t=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(t=this.keyCode);let i=0;return this.ctrlKey&&(i|=io),this.altKey&&(i|=512),this.shiftKey&&(i|=1024),this.metaKey&&(i|=eo),i|=t,i}_computeKeyCodeChord(){let t=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(t=this.keyCode),new Qr(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,t)}}const no=new WeakMap;function ro(t){if(!t.parent||t.parent===t)return null;try{const i=t.location,e=t.parent.location;if(i.origin!=="null"&&e.origin!=="null"&&i.origin!==e.origin)return null}catch{return null}return t.parent}class oo{static getSameOriginWindowChain(t){let i=no.get(t);if(!i){i=[],no.set(t,i);let e,s=t;do{e=ro(s),e?i.push({window:new WeakRef(s),iframeElement:s.frameElement||null}):i.push({window:new WeakRef(s),iframeElement:null}),s=e}while(s)}return i.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(t,i){var e,s;if(!i||t===i)return{top:0,left:0};let n=0,r=0;const o=this.getSameOriginWindowChain(t);for(const t of o){const o=t.window.deref();if(n+=(e=o==null?void 0:o.scrollY)!==null&&e!==void 0?e:0,r+=(s=o==null?void 0:o.scrollX)!==null&&s!==void 0?s:0,o===i||!t.iframeElement)break;const h=t.iframeElement.getBoundingClientRect();n+=h.top,r+=h.left}return{top:n,left:r}}}class ho{constructor(t,i){this.timestamp=Date.now(),this.browserEvent=i,this.leftButton=i.button===0,this.middleButton=i.button===1,this.rightButton=i.button===2,this.buttons=i.buttons,this.target=i.target,this.detail=i.detail||1,i.type==="dblclick"&&(this.detail=2),this.ctrlKey=i.ctrlKey,this.shiftKey=i.shiftKey,this.altKey=i.altKey,this.metaKey=i.metaKey,typeof i.pageX=="number"?(this.posx=i.pageX,this.posy=i.pageY):(this.posx=i.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=i.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);const e=oo.getPositionOfChildWindowRelativeToAncestorWindow(t,i.view);this.posx-=e.left,this.posy-=e.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}}class co{constructor(t,i=0,e=0){var s;this.browserEvent=t||null,this.target=t?t.target||t.targetNode||t.srcElement:null,this.deltaY=e,this.deltaX=i;let n=!1;if(zr){const t=navigator.userAgent.match(/Chrome\/(\d+)/);n=(t?parseInt(t[1]):123)<=122}if(t){const i=t,e=t,r=((s=t.view)===null||s===void 0?void 0:s.devicePixelRatio)||1;if(i.wheelDeltaY!==void 0)this.deltaY=n?i.wheelDeltaY/(120*r):i.wheelDeltaY/120;else if(e.VERTICAL_AXIS!==void 0&&e.axis===e.VERTICAL_AXIS)this.deltaY=-e.detail/3;else if(t.type==="wheel"){const i=t;i.deltaMode===i.DOM_DELTA_LINE?this.deltaY=Hr&&!bt?-t.deltaY/3:-t.deltaY:this.deltaY=-t.deltaY/40}if(i.wheelDeltaX!==void 0)this.deltaX=Ur&&vt?-i.wheelDeltaX/120:n?i.wheelDeltaX/(120*r):i.wheelDeltaX/120;else if(e.HORIZONTAL_AXIS!==void 0&&e.axis===e.HORIZONTAL_AXIS)this.deltaX=-t.detail/3;else if(t.type==="wheel"){const i=t;i.deltaMode===i.DOM_DELTA_LINE?this.deltaX=Hr&&!bt?-t.deltaX/3:-t.deltaX:this.deltaX=-t.deltaX/40}this.deltaY===0&&this.deltaX===0&&t.wheelDelta&&(this.deltaY=n?t.wheelDelta/(120*r):t.wheelDelta/120)}}preventDefault(){var t;(t=this.browserEvent)===null||t===void 0||t.preventDefault()}stopPropagation(){var t;(t=this.browserEvent)===null||t===void 0||t.stopPropagation()}}const lo=Symbol("MicrotaskDelay");function ao(t){return!!t&&typeof t.then=="function"}function uo(t){const i=new ye,e=t(i.token),s=new Promise(((t,s)=>{const n=i.token.onCancellationRequested((()=>{n.dispose(),s(new $i)}));Promise.resolve(e).then((e=>{n.dispose(),i.dispose(),t(e)}),(t=>{n.dispose(),i.dispose(),s(t)}))}));return new class{cancel(){i.cancel(),i.dispose()}then(t,i){return s.then(t,i)}catch(t){return this.then(void 0,t)}finally(t){return s.finally(t)}}}function fo(t,i,e){return new Promise(((s,n)=>{const r=i.onCancellationRequested((()=>{r.dispose(),s(e)}));t.then(s,n).finally((()=>r.dispose()))}))}class go{constructor(){this.isDisposed=!1,this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(t){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=t,!this.queuedPromise){const t=()=>{if(this.queuedPromise=null,this.isDisposed)return;const t=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,t};this.queuedPromise=new Promise((i=>{this.activePromise.then(t,t).then(i)}))}return new Promise(((t,i)=>{this.queuedPromise.then(t,i)}))}return this.activePromise=t(),new Promise(((t,i)=>{this.activePromise.then((i=>{this.activePromise=null,t(i)}),(t=>{this.activePromise=null,i(t)}))}))}dispose(){this.isDisposed=!0}}class po{constructor(t){this.defaultDelay=t,this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(t,i=this.defaultDelay){this.task=t,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(((t,i)=>{this.doResolve=t,this.doReject=i})).then((()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const t=this.task;return this.task=null,t()}})));const e=()=>{var t;this.deferred=null,(t=this.doResolve)===null||t===void 0||t.call(this,null)};return this.deferred=i===lo?(t=>{let i=!0;return queueMicrotask((()=>{i&&(i=!1,t())})),{isTriggered:()=>i,dispose:()=>{i=!1}}})(e):((t,i)=>{let e=!0;const s=setTimeout((()=>{e=!1,i()}),t);return{isTriggered:()=>e,dispose:()=>{clearTimeout(s),e=!1}}})(i,e),this.completionPromise}isTriggered(){var t;return!!(!((t=this.deferred)===null||t===void 0)&&t.isTriggered())}cancel(){var t;this.cancelTimeout(),this.completionPromise&&((t=this.doReject)===null||t===void 0||t.call(this,new $i),this.completionPromise=null)}cancelTimeout(){var t;(t=this.deferred)===null||t===void 0||t.dispose(),this.deferred=null}dispose(){this.cancel()}}class mo{constructor(t){this.delayer=new po(t),this.throttler=new go}trigger(t,i){return this.delayer.trigger((()=>this.throttler.queue(t)),i)}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}}function wo(t,i){return i?new Promise(((e,s)=>{const n=setTimeout((()=>{r.dispose(),e()}),t),r=i.onCancellationRequested((()=>{clearTimeout(n),r.dispose(),s(new $i)}))})):uo((i=>wo(t,i)))}function vo(t,i=0,e){const s=setTimeout((()=>{t(),e&&n.dispose()}),i),n=Zi((()=>{clearTimeout(s),e==null||e.deleteAndLeak(n)}));return e==null||e.add(n),n}function bo(t,i=(t=>!!t),e=null){let s=0;const n=t.length,r=()=>{if(s>=n)return Promise.resolve(e);const o=t[s++];return Promise.resolve(o()).then((t=>i(t)?Promise.resolve(t):r()))};return r()}class yo{constructor(t,i){this._token=-1,typeof t=="function"&&typeof i=="number"&&this.setIfNotSet(t,i)}dispose(){this.cancel()}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(t,i){this.cancel(),this._token=setTimeout((()=>{this._token=-1,t()}),i)}setIfNotSet(t,i){this._token===-1&&(this._token=setTimeout((()=>{this._token=-1,t()}),i))}}class ko{constructor(){this.disposable=void 0}cancel(){var t;(t=this.disposable)===null||t===void 0||t.dispose(),this.disposable=void 0}cancelAndSet(t,i,e=globalThis){this.cancel();const s=e.setInterval((()=>{t()}),i);this.disposable=Zi((()=>{e.clearInterval(s),this.disposable=void 0}))}dispose(){this.cancel()}}class Co{constructor(t,i){this.timeoutToken=-1,this.runner=t,this.timeout=i,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(t=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,t)}get delay(){return this.timeout}set delay(t){this.timeout=t}isScheduled(){return this.timeoutToken!==-1}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){var t;(t=this.runner)===null||t===void 0||t.call(this)}}let So,xo;xo=typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?(t,i)=>{Lt((()=>{if(e)return;const t=Date.now()+15;i(Object.freeze({didTimeout:!0,timeRemaining:()=>Math.max(0,t-Date.now())}))}));let e=!1;return{dispose(){e||(e=!0)}}}:(t,i,e)=>{const s=t.requestIdleCallback(i,typeof e=="number"?{timeout:e}:void 0);let n=!1;return{dispose(){n||(n=!0,t.cancelIdleCallback(s))}}},So=t=>xo(globalThis,t);class Do{constructor(t,i){this._didRun=!1,this._executor=()=>{try{this._value=i()}catch(t){this._error=t}finally{this._didRun=!0}},this._handle=xo(t,(()=>this._executor()))}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}class Eo extends Do{constructor(t){super(globalThis,t)}}class Ao{get isRejected(){var t;return((t=this.outcome)===null||t===void 0?void 0:t.outcome)===1}get isSettled(){return!!this.outcome}constructor(){this.p=new Promise(((t,i)=>{this.completeCallback=t,this.errorCallback=i}))}complete(t){return new Promise((i=>{this.completeCallback(t),this.outcome={outcome:0,value:t},i()}))}error(t){return new Promise((i=>{this.errorCallback(t),this.outcome={outcome:1,value:t},i()}))}cancel(){return this.error(new $i)}}var Mo;(function(t){t.settled=async function(t){let i;const e=await Promise.all(t.map((t=>t.then((t=>t),(t=>{i||(i=t)})))));if(i!==void 0)throw i;return e},t.withAsyncBody=function(t){return new Promise((async(i,e)=>{try{await t(i,e)}catch(t){e(t)}}))}})(Mo||(Mo={}));class Lo{static fromArray(t){return new Lo((i=>{i.emitMany(t)}))}static fromPromise(t){return new Lo((async i=>{i.emitMany(await t)}))}static fromPromises(t){return new Lo((async i=>{await Promise.all(t.map((async t=>i.emitOne(await t))))}))}static merge(t){return new Lo((async i=>{await Promise.all(t.map((async t=>{for await(const e of t)i.emitOne(e)})))}))}constructor(t){this._state=0,this._results=[],this._error=null,this._onStateChanged=new le,queueMicrotask((async()=>{const i={emitOne:t=>this.emitOne(t),emitMany:t=>this.emitMany(t),reject:t=>this.reject(t)};try{await Promise.resolve(t(i)),this.resolve()}catch(t){this.reject(t)}finally{i.emitOne=void 0,i.emitMany=void 0,i.reject=void 0}}))}[Symbol.asyncIterator](){let t=0;return{next:async()=>{for(;;){if(this._state===2)throw this._error;if(t<this._results.length)return{done:!1,value:this._results[t++]};if(this._state===1)return{done:!0,value:void 0};await ne.toPromise(this._onStateChanged.event)}}}}static map(t,i){return new Lo((async e=>{for await(const s of t)e.emitOne(i(s))}))}map(t){return Lo.map(this,t)}static filter(t,i){return new Lo((async e=>{for await(const s of t)i(s)&&e.emitOne(s)}))}filter(t){return Lo.filter(this,t)}static coalesce(t){return Lo.filter(t,(t=>!!t))}coalesce(){return Lo.coalesce(this)}static async toPromise(t){const i=[];for await(const e of t)i.push(e);return i}toPromise(){return Lo.toPromise(this)}emitOne(t){this._state===0&&(this._results.push(t),this._onStateChanged.fire())}emitMany(t){this._state===0&&(this._results=this._results.concat(t),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(t){this._state===0&&(this._state=2,this._error=t,this._onStateChanged.fire())}}Lo.EMPTY=Lo.fromArray([]);class Fo extends Lo{constructor(t,i){super(i),this._source=t}cancel(){this._source.cancel()}}const{entries:To,setPrototypeOf:Ro,isFrozen:Oo,getPrototypeOf:Io,getOwnPropertyDescriptor:_o}=Object;let{freeze:Po,seal:No,create:Bo}=Object,{apply:$o,construct:Wo}=typeof Reflect<"u"&&Reflect;$o||($o=function(t,i,e){return t.apply(i,e)}),Po||(Po=function(t){return t}),No||(No=function(t){return t}),Wo||(Wo=function(t,i){return new t(...i)});const jo=Xo(Array.prototype.forEach),Ho=Xo(Array.prototype.pop),Vo=Xo(Array.prototype.push),zo=Xo(String.prototype.toLowerCase),Uo=Xo(String.prototype.toString),Ko=Xo(String.prototype.match),qo=Xo(String.prototype.replace),Go=Xo(String.prototype.indexOf),Zo=Xo(String.prototype.trim),Jo=Xo(RegExp.prototype.test),Qo=(Yo=TypeError,function(){for(var t=arguments.length,i=new Array(t),e=0;e<t;e++)i[e]=arguments[e];return Wo(Yo,i)});var Yo;function Xo(t){return function(i){for(var e=arguments.length,s=new Array(e>1?e-1:0),n=1;n<e;n++)s[n-1]=arguments[n];return $o(t,i,s)}}function th(t,i,e){var s;e=(s=e)!==null&&s!==void 0?s:zo,Ro&&Ro(t,null);let n=i.length;for(;n--;){let s=i[n];if(typeof s=="string"){const t=e(s);t!==s&&(Oo(i)||(i[n]=t),s=t)}t[s]=!0}return t}function ih(t){const i=Bo(null);for(const[e,s]of To(t))i[e]=s;return i}function eh(t,i){for(;t!==null;){const e=_o(t,i);if(e){if(e.get)return Xo(e.get);if(typeof e.value=="function")return Xo(e.value)}t=Io(t)}return function(t){return console.warn("fallback value for",t),null}}const sh=Po(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),nh=Po(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),rh=Po(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),oh=Po(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),hh=Po(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),ch=Po(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),lh=Po(["#text"]),ah=Po(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),uh=Po(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),dh=Po(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),fh=Po(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),gh=No(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ph=No(/<%[\w\W]*|[\w\W]*%>/gm),mh=No(/\${[\w\W]*}/gm),wh=No(/^data-[\-\w.\u00B7-\uFFFF]/),vh=No(/^aria-[\-\w]+$/),bh=No(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),yh=No(/^(?:\w+script|data):/i),kh=No(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Ch=No(/^html$/i);var Sh=Object.freeze({__proto__:null,MUSTACHE_EXPR:gh,ERB_EXPR:ph,TMPLIT_EXPR:mh,DATA_ATTR:wh,ARIA_ATTR:vh,IS_ALLOWED_URI:bh,IS_SCRIPT_OR_DATA:yh,ATTR_WHITESPACE:kh,DOCTYPE_NAME:Ch});const xh=()=>typeof window>"u"?null:window;var Dh=function t(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xh();const e=i=>t(i);if(e.version="3.0.5",e.removed=[],!i||!i.document||i.document.nodeType!==9)return e.isSupported=!1,e;const s=i.document,n=s.currentScript;let{document:r}=i;const{DocumentFragment:o,HTMLTemplateElement:h,Node:c,Element:l,NodeFilter:a,NamedNodeMap:u=i.NamedNodeMap||i.MozNamedAttrMap,HTMLFormElement:d,DOMParser:f,trustedTypes:g}=i,p=l.prototype,m=eh(p,"cloneNode"),w=eh(p,"nextSibling"),v=eh(p,"childNodes"),b=eh(p,"parentNode");if(typeof h=="function"){const t=r.createElement("template");t.content&&t.content.ownerDocument&&(r=t.content.ownerDocument)}let y,k="";const{implementation:C,createNodeIterator:S,createDocumentFragment:x,getElementsByTagName:D}=r,{importNode:E}=s;let A={};e.isSupported=typeof To=="function"&&typeof b=="function"&&C&&C.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:M,ERB_EXPR:L,TMPLIT_EXPR:F,DATA_ATTR:T,ARIA_ATTR:R,IS_SCRIPT_OR_DATA:O,ATTR_WHITESPACE:I}=Sh;let{IS_ALLOWED_URI:_}=Sh,P=null;const N=th({},[...sh,...nh,...rh,...hh,...lh]);let B=null;const $=th({},[...ah,...uh,...dh,...fh]);let W=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),j=null,H=null,V=!0,z=!0,U=!1,K=!0,q=!1,G=!1,Z=!1,J=!1,Q=!1,Y=!1,X=!1,tt=!0,it=!1,et=!0,st=!1,nt={},rt=null;const ot=th({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ht=null;const ct=th({},["audio","video","img","source","image","track"]);let lt=null;const at=th({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ut="http://www.w3.org/1998/Math/MathML",dt="http://www.w3.org/2000/svg",ft="http://www.w3.org/1999/xhtml";let gt=ft,pt=!1,mt=null;const wt=th({},[ut,dt,ft],Uo);let vt;const bt=["application/xhtml+xml","text/html"];let yt,kt=null;const Ct=r.createElement("form"),St=function(t){return t instanceof RegExp||t instanceof Function},xt=function(t){if(!kt||kt!==t){if(t&&typeof t=="object"||(t={}),t=ih(t),vt=vt=bt.indexOf(t.PARSER_MEDIA_TYPE)===-1?"text/html":t.PARSER_MEDIA_TYPE,yt=vt==="application/xhtml+xml"?Uo:zo,P="ALLOWED_TAGS"in t?th({},t.ALLOWED_TAGS,yt):N,B="ALLOWED_ATTR"in t?th({},t.ALLOWED_ATTR,yt):$,mt="ALLOWED_NAMESPACES"in t?th({},t.ALLOWED_NAMESPACES,Uo):wt,lt="ADD_URI_SAFE_ATTR"in t?th(ih(at),t.ADD_URI_SAFE_ATTR,yt):at,ht="ADD_DATA_URI_TAGS"in t?th(ih(ct),t.ADD_DATA_URI_TAGS,yt):ct,rt="FORBID_CONTENTS"in t?th({},t.FORBID_CONTENTS,yt):ot,j="FORBID_TAGS"in t?th({},t.FORBID_TAGS,yt):{},H="FORBID_ATTR"in t?th({},t.FORBID_ATTR,yt):{},nt="USE_PROFILES"in t&&t.USE_PROFILES,V=t.ALLOW_ARIA_ATTR!==!1,z=t.ALLOW_DATA_ATTR!==!1,U=t.ALLOW_UNKNOWN_PROTOCOLS||!1,K=t.ALLOW_SELF_CLOSE_IN_ATTR!==!1,q=t.SAFE_FOR_TEMPLATES||!1,G=t.WHOLE_DOCUMENT||!1,Q=t.RETURN_DOM||!1,Y=t.RETURN_DOM_FRAGMENT||!1,X=t.RETURN_TRUSTED_TYPE||!1,J=t.FORCE_BODY||!1,tt=t.SANITIZE_DOM!==!1,it=t.SANITIZE_NAMED_PROPS||!1,et=t.KEEP_CONTENT!==!1,st=t.IN_PLACE||!1,_=t.ALLOWED_URI_REGEXP||bh,gt=t.NAMESPACE||ft,W=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&St(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(W.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&St(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(W.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(W.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),q&&(z=!1),Y&&(Q=!0),nt&&(P=th({},[...lh]),B=[],nt.html===!0&&(th(P,sh),th(B,ah)),nt.svg===!0&&(th(P,nh),th(B,uh),th(B,fh)),nt.svgFilters===!0&&(th(P,rh),th(B,uh),th(B,fh)),nt.mathMl===!0&&(th(P,hh),th(B,dh),th(B,fh))),t.ADD_TAGS&&(P===N&&(P=ih(P)),th(P,t.ADD_TAGS,yt)),t.ADD_ATTR&&(B===$&&(B=ih(B)),th(B,t.ADD_ATTR,yt)),t.ADD_URI_SAFE_ATTR&&th(lt,t.ADD_URI_SAFE_ATTR,yt),t.FORBID_CONTENTS&&(rt===ot&&(rt=ih(rt)),th(rt,t.FORBID_CONTENTS,yt)),et&&(P["#text"]=!0),G&&th(P,["html","head","body"]),P.table&&(th(P,["tbody"]),delete j.tbody),t.TRUSTED_TYPES_POLICY){if(typeof t.TRUSTED_TYPES_POLICY.createHTML!="function")throw Qo('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof t.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Qo('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');y=t.TRUSTED_TYPES_POLICY,k=y.createHTML("")}else y===void 0&&(y=function(t,i){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let e=null;const s="data-tt-policy-suffix";i&&i.hasAttribute(s)&&(e=i.getAttribute(s));const n="dompurify"+(e?"#"+e:"");try{return t.createPolicy(n,{createHTML:t=>t,createScriptURL:t=>t})}catch{return console.warn("TrustedTypes policy "+n+" could not be created."),null}}(g,n)),y!==null&&typeof k=="string"&&(k=y.createHTML(""));Po&&Po(t),kt=t}},Dt=th({},["mi","mo","mn","ms","mtext"]),Et=th({},["foreignobject","desc","title","annotation-xml"]),At=th({},["title","style","font","a","script"]),Mt=th({},nh);th(Mt,rh),th(Mt,oh);const Lt=th({},hh);th(Lt,ch);const Ft=function(t){Vo(e.removed,{element:t});try{t.parentNode.removeChild(t)}catch{t.remove()}},Tt=function(t,i){try{Vo(e.removed,{attribute:i.getAttributeNode(t),from:i})}catch{Vo(e.removed,{attribute:null,from:i})}if(i.removeAttribute(t),t==="is"&&!B[t])if(Q||Y)try{Ft(i)}catch{}else try{i.setAttribute(t,"")}catch{}},Rt=function(t){let i,e;if(J)t="<remove></remove>"+t;else{const i=Ko(t,/^[\r\n\t ]+/);e=i&&i[0]}vt==="application/xhtml+xml"&&gt===ft&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");const s=y?y.createHTML(t):t;if(gt===ft)try{i=(new f).parseFromString(s,vt)}catch{}if(!i||!i.documentElement){i=C.createDocument(gt,"template",null);try{i.documentElement.innerHTML=pt?k:s}catch{}}const n=i.body||i.documentElement;return t&&e&&n.insertBefore(r.createTextNode(e),n.childNodes[0]||null),gt===ft?D.call(i,G?"html":"body")[0]:G?i.documentElement:n},Ot=function(t){return S.call(t.ownerDocument||t,t,a.SHOW_ELEMENT|a.SHOW_COMMENT|a.SHOW_TEXT,null,!1)},It=function(t){return typeof c=="object"?t instanceof c:t&&typeof t=="object"&&typeof t.nodeType=="number"&&typeof t.nodeName=="string"},_t=function(t,i,s){A[t]&&jo(A[t],(t=>{t.call(e,i,s,kt)}))},Pt=function(t){let i;if(_t("beforeSanitizeElements",t,null),(s=t)instanceof d&&(typeof s.nodeName!="string"||typeof s.textContent!="string"||typeof s.removeChild!="function"||!(s.attributes instanceof u)||typeof s.removeAttribute!="function"||typeof s.setAttribute!="function"||typeof s.namespaceURI!="string"||typeof s.insertBefore!="function"||typeof s.hasChildNodes!="function"))return Ft(t),!0;var s;const n=yt(t.nodeName);if(_t("uponSanitizeElement",t,{tagName:n,allowedTags:P}),t.hasChildNodes()&&!It(t.firstElementChild)&&(!It(t.content)||!It(t.content.firstElementChild))&&Jo(/<[/\w]/g,t.innerHTML)&&Jo(/<[/\w]/g,t.textContent))return Ft(t),!0;if(!P[n]||j[n]){if(!j[n]&&Bt(n)&&(W.tagNameCheck instanceof RegExp&&Jo(W.tagNameCheck,n)||W.tagNameCheck instanceof Function&&W.tagNameCheck(n)))return!1;if(et&&!rt[n]){const i=b(t)||t.parentNode,e=v(t)||t.childNodes;if(e&&i)for(let s=e.length-1;s>=0;--s)i.insertBefore(m(e[s],!0),w(t))}return Ft(t),!0}return t instanceof l&&!function(t){let i=b(t);i&&i.tagName||(i={namespaceURI:gt,tagName:"template"});const e=zo(t.tagName),s=zo(i.tagName);return!!mt[t.namespaceURI]&&(t.namespaceURI===dt?i.namespaceURI===ft?e==="svg":i.namespaceURI===ut?e==="svg"&&(s==="annotation-xml"||Dt[s]):!!Mt[e]:t.namespaceURI===ut?i.namespaceURI===ft?e==="math":i.namespaceURI===dt?e==="math"&&Et[s]:!!Lt[e]:t.namespaceURI===ft?!(i.namespaceURI===dt&&!Et[s])&&!(i.namespaceURI===ut&&!Dt[s])&&!Lt[e]&&(At[e]||!Mt[e]):!(vt!=="application/xhtml+xml"||!mt[t.namespaceURI]))}(t)?(Ft(t),!0):n!=="noscript"&&n!=="noembed"&&n!=="noframes"||!Jo(/<\/no(script|embed|frames)/i,t.innerHTML)?(q&&t.nodeType===3&&(i=t.textContent,i=qo(i,M," "),i=qo(i,L," "),i=qo(i,F," "),t.textContent!==i&&(Vo(e.removed,{element:t.cloneNode()}),t.textContent=i)),_t("afterSanitizeElements",t,null),!1):(Ft(t),!0)},Nt=function(t,i,e){if(tt&&(i==="id"||i==="name")&&(e in r||e in Ct))return!1;if(!(z&&!H[i]&&Jo(T,i))){if(!(V&&Jo(R,i))){if(!B[i]||H[i]){if(!(Bt(t)&&(W.tagNameCheck instanceof RegExp&&Jo(W.tagNameCheck,t)||W.tagNameCheck instanceof Function&&W.tagNameCheck(t))&&(W.attributeNameCheck instanceof RegExp&&Jo(W.attributeNameCheck,i)||W.attributeNameCheck instanceof Function&&W.attributeNameCheck(i))||i==="is"&&W.allowCustomizedBuiltInElements&&(W.tagNameCheck instanceof RegExp&&Jo(W.tagNameCheck,e)||W.tagNameCheck instanceof Function&&W.tagNameCheck(e))))return!1}else if(!lt[i]){if(!Jo(_,qo(e,I,""))){if((i!=="src"&&i!=="xlink:href"&&i!=="href"||t==="script"||Go(e,"data:")!==0||!ht[t])&&!(U&&!Jo(O,qo(e,I,"")))){if(e)return!1}}}}}return!0},Bt=function(t){return t.indexOf("-")>0},$t=function(t){let i,s,n,r;_t("beforeSanitizeAttributes",t,null);const{attributes:o}=t;if(!o)return;const h={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:B};for(r=o.length;r--;){i=o[r];const{name:c,namespaceURI:l}=i;if(s=c==="value"?i.value:Zo(i.value),n=yt(c),h.attrName=n,h.attrValue=s,h.keepAttr=!0,h.forceKeepAttr=void 0,_t("uponSanitizeAttribute",t,h),s=h.attrValue,h.forceKeepAttr||(Tt(c,t),!h.keepAttr))continue;if(!K&&Jo(/\/>/i,s)){Tt(c,t);continue}q&&(s=qo(s,M," "),s=qo(s,L," "),s=qo(s,F," "));const a=yt(t.nodeName);if(Nt(a,n,s)){if(!it||n!=="id"&&n!=="name"||(Tt(c,t),s="user-content-"+s),y&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!l)switch(g.getAttributeType(a,n)){case"TrustedHTML":s=y.createHTML(s);break;case"TrustedScriptURL":s=y.createScriptURL(s)}try{l?t.setAttributeNS(l,c,s):t.setAttribute(c,s),Ho(e.removed)}catch{}}}_t("afterSanitizeAttributes",t,null)},Wt=function t(i){let e;const s=Ot(i);for(_t("beforeSanitizeShadowDOM",i,null);e=s.nextNode();)_t("uponSanitizeShadowNode",e,null),Pt(e)||(e.content instanceof o&&t(e.content),$t(e));_t("afterSanitizeShadowDOM",i,null)};return e.sanitize=function(t){let i,n,r,h,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(pt=!t,pt&&(t="\x3c!--\x3e"),typeof t!="string"&&!It(t)){if(typeof t.toString!="function")throw Qo("toString is not a function");if(typeof(t=t.toString())!="string")throw Qo("dirty is not a string, aborting")}if(!e.isSupported)return t;if(Z||xt(l),e.removed=[],typeof t=="string"&&(st=!1),st){if(t.nodeName){const i=yt(t.nodeName);if(!P[i]||j[i])throw Qo("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof c)i=Rt("\x3c!----\x3e"),n=i.ownerDocument.importNode(t,!0),n.nodeType===1&&n.nodeName==="BODY"||n.nodeName==="HTML"?i=n:i.appendChild(n);else{if(!Q&&!q&&!G&&t.indexOf("<")===-1)return y&&X?y.createHTML(t):t;if(i=Rt(t),!i)return Q?null:X?k:""}i&&J&&Ft(i.firstChild);const a=Ot(st?t:i);for(;r=a.nextNode();)Pt(r)||(r.content instanceof o&&Wt(r.content),$t(r));if(st)return t;if(Q){if(Y)for(h=x.call(i.ownerDocument);i.firstChild;)h.appendChild(i.firstChild);else h=i;return(B.shadowroot||B.shadowrootmode)&&(h=E.call(s,h,!0)),h}let u=G?i.outerHTML:i.innerHTML;return G&&P["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&Jo(Ch,i.ownerDocument.doctype.name)&&(u="<!DOCTYPE "+i.ownerDocument.doctype.name+`>\n`+u),q&&(u=qo(u,M," "),u=qo(u,L," "),u=qo(u,F," ")),y&&X?y.createHTML(u):u},e.setConfig=function(t){xt(t),Z=!0},e.clearConfig=function(){kt=null,Z=!1},e.isValidAttribute=function(t,i,e){kt||xt({});const s=yt(t),n=yt(i);return Nt(s,n,e)},e.addHook=function(t,i){typeof i=="function"&&(A[t]=A[t]||[],Vo(A[t],i))},e.removeHook=function(t){if(A[t])return Ho(A[t])},e.removeHooks=function(t){A[t]&&(A[t]=[])},e.removeAllHooks=function(){A={}},e}();const Eh=Dh.sanitize;const Ah=Dh.addHook,Mh=Dh.removeHook;var Lh;function Fh(t,i){return as.isUri(t)?ar(t.scheme,i):ur(t,i+":")}function Th(t,...i){return i.some((i=>Fh(t,i)))}(function(t){t.inMemory="inmemory",t.vscode="vscode",t.internal="private",t.walkThrough="walkThrough",t.walkThroughSnippet="walkThroughSnippet",t.http="http",t.https="https",t.file="file",t.mailto="mailto",t.untitled="untitled",t.data="data",t.command="command",t.vscodeRemote="vscode-remote",t.vscodeRemoteResource="vscode-remote-resource",t.vscodeManagedRemoteResource="vscode-managed-remote-resource",t.vscodeUserData="vscode-userdata",t.vscodeCustomEditor="vscode-custom-editor",t.vscodeNotebookCell="vscode-notebook-cell",t.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",t.vscodeNotebookCellOutput="vscode-notebook-cell-output",t.vscodeInteractiveInput="vscode-interactive-input",t.vscodeSettings="vscode-settings",t.vscodeWorkspaceTrust="vscode-workspace-trust",t.vscodeTerminal="vscode-terminal",t.vscodeChatCodeBlock="vscode-chat-code-block",t.vscodeChatSesssion="vscode-chat-editor",t.webviewPanel="webview-panel",t.vscodeWebview="vscode-webview",t.extension="extension",t.vscodeFileResource="vscode-file",t.tmp="tmp",t.vsls="vsls",t.vscodeSourceControl="vscode-scm",t.codeSetting="code-setting"})(Lh||(Lh={}));const Rh=new class{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null,this._serverRootPath="/"}setPreferredWebSchema(t){this._preferredWebSchema=t}get _remoteResourcesPath(){return Je.join(this._serverRootPath,Lh.vscodeRemoteResource)}rewrite(t){if(this._delegate)try{return this._delegate(t)}catch(i){return Ii(i),t}const i=t.authority;let e=this._hosts[i];e&&e.indexOf(":")!==-1&&e.indexOf("[")===-1&&(e=`[${e}]`);const s=this._ports[i],n=this._connectionTokens[i];let r=`path=${encodeURIComponent(t.path)}`;return typeof n=="string"&&(r+=`&tkn=${encodeURIComponent(n)}`),as.from({scheme:Ct?this._preferredWebSchema:Lh.vscodeRemoteResource,authority:`${e}:${s}`,path:this._remoteResourcesPath,query:r})}};class Oh{uriToBrowserUri(t){return t.scheme===Lh.vscodeRemote?Rh.rewrite(t):t.scheme!==Lh.file||!kt&&St!==`${Lh.vscodeFileResource}://${Oh.FALLBACK_AUTHORITY}`?t:t.with({scheme:Lh.vscodeFileResource,authority:t.authority||Oh.FALLBACK_AUTHORITY,query:null,fragment:null})}}Oh.FALLBACK_AUTHORITY="vscode-app";const Ih=new Oh;var _h;function Ph(t){return Nh(t,0)}function Nh(t,i){switch(typeof t){case"object":return t===null?Bh(349,i):Array.isArray(t)?(e=t,s=Bh(104579,s=i),e.reduce(((t,i)=>Nh(i,t)),s)):function(t,i){return i=Bh(181387,i),Object.keys(t).sort().reduce(((i,e)=>(i=$h(e,i),Nh(t[e],i))),i)}(t,i);case"string":return $h(t,i);case"boolean":return function(t,i){return Bh(t?433:863,i)}(t,i);case"number":return Bh(t,i);case"undefined":return Bh(937,i);default:return Bh(617,i)}var e,s}function Bh(t,i){return(i<<5)-i+t|0}function $h(t,i){i=Bh(149417,i);for(let e=0,s=t.length;e<s;e++)i=Bh(t.charCodeAt(e),i);return i}function Wh(t,i,e=32){const s=e-i;return(t<<i|(~((1<<s)-1)&t)>>>s)>>>0}function jh(t,i=0,e=t.byteLength,s=0){for(let n=0;n<e;n++)t[i+n]=s}function Hh(t,i=32){return t instanceof ArrayBuffer?Array.from(new Uint8Array(t)).map((t=>t.toString(16).padStart(2,"0"))).join(""):function(t,i,e="0"){for(;t.length<i;)t=e+t;return t}((t>>>0).toString(16),i/4)}(function(t){const i=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);t.CoopAndCoep=Object.freeze(i.get("3"));const e="vscode-coi";t.getHeadersFromQuery=function(t){let s;typeof t=="string"?s=new URL(t).searchParams:t instanceof URL?s=t.searchParams:as.isUri(t)&&(s=new URL(t.toString(!0)).searchParams);const n=s==null?void 0:s.get(e);if(n)return i.get(n)},t.addSearchParam=function(t,i,s){if(!globalThis.crossOriginIsolated)return;const n=i&&s?"3":s?"2":"1";t instanceof URLSearchParams?t.set(e,n):t[e]=n}})(_h||(_h={}));class Vh{constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(t){const i=t.length;if(i===0)return;const e=this._buff;let s,n,r=this._buffLen,o=this._leftoverHighSurrogate;for(o!==0?(s=o,n=-1,o=0):(s=t.charCodeAt(0),n=0);;){let h=s;if(gr(s)){if(!(n+1<i)){o=s;break}{const i=t.charCodeAt(n+1);pr(i)?(n++,h=mr(s,i)):h=65533}}else pr(s)&&(h=65533);if(r=this._push(e,r,h),n++,!(n<i))break;s=t.charCodeAt(n)}this._buffLen=r,this._leftoverHighSurrogate=o}_push(t,i,e){return e<128?t[i++]=e:e<2048?(t[i++]=192|(1984&e)>>>6,t[i++]=128|(63&e)>>>0):e<65536?(t[i++]=224|(61440&e)>>>12,t[i++]=128|(4032&e)>>>6,t[i++]=128|(63&e)>>>0):(t[i++]=240|(1835008&e)>>>18,t[i++]=128|(258048&e)>>>12,t[i++]=128|(4032&e)>>>6,t[i++]=128|(63&e)>>>0),i>=64&&(this._step(),i-=64,this._totalLen+=64,t[0]=t[64],t[1]=t[65],t[2]=t[66]),i}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),Hh(this._h0)+Hh(this._h1)+Hh(this._h2)+Hh(this._h3)+Hh(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,jh(this._buff,this._buffLen),this._buffLen>56&&(this._step(),jh(this._buff));const t=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(t/4294967296),!1),this._buffDV.setUint32(60,t%4294967296,!1),this._step()}_step(){const t=Vh._bigBlock32,i=this._buffDV;for(let e=0;e<64;e+=4)t.setUint32(e,i.getUint32(e,!1),!1);for(let i=64;i<320;i+=4)t.setUint32(i,Wh(t.getUint32(i-12,!1)^t.getUint32(i-32,!1)^t.getUint32(i-56,!1)^t.getUint32(i-64,!1),1),!1);let e,s,n,r=this._h0,o=this._h1,h=this._h2,c=this._h3,l=this._h4;for(let i=0;i<80;i++)i<20?(e=o&h|~o&c,s=1518500249):i<40?(e=o^h^c,s=1859775393):i<60?(e=o&h|o&c|h&c,s=2400959708):(e=o^h^c,s=3395469782),n=Wh(r,5)+e+l+s+t.getUint32(4*i,!1)&4294967295,l=c,c=h,h=Wh(o,30),o=r,r=n;this._h0=this._h0+r&4294967295,this._h1=this._h1+o&4294967295,this._h2=this._h2+h&4294967295,this._h3=this._h3+c&4294967295,this._h4=this._h4+l&4294967295}}Vh._bigBlock32=new DataView(new ArrayBuffer(320));const{registerWindow:zh,getWindow:Uh,getDocument:Kh,getWindows:qh,getWindowsCount:Gh,getWindowId:Zh,getWindowById:Jh,hasWindow:Qh,onDidRegisterWindow:Yh,onWillUnregisterWindow:Xh,onDidUnregisterWindow:tc}=function(){const t=new Map;(function(t,i){const e=t;typeof e.vscodeWindowId!="number"&&Object.defineProperty(e,"vscodeWindowId",{get:()=>i})})(Wn,1);const i={window:Wn,disposables:new Ji};t.set(Wn.vscodeWindowId,i);const e=new le,s=new le,n=new le;return{onDidRegisterWindow:e.event,onWillUnregisterWindow:n.event,onDidUnregisterWindow:s.event,registerWindow(i){if(t.has(i.vscodeWindowId))return Qi.None;const r=new Ji,o={window:i,disposables:r.add(new Ji)};return t.set(i.vscodeWindowId,o),r.add(Zi((()=>{t.delete(i.vscodeWindowId),s.fire(i)}))),r.add(sc(i,qc.BEFORE_UNLOAD,(()=>{n.fire(i)}))),e.fire(o),r},getWindows:()=>t.values(),getWindowsCount:()=>t.size,getWindowId:t=>t.vscodeWindowId,hasWindow:i=>t.has(i),getWindowById:function(e,s){const n=typeof e=="number"?t.get(e):void 0;return n??(s?i:void 0)},getWindow(t){var i;const e=t;if(!((i=e==null?void 0:e.ownerDocument)===null||i===void 0)&&i.defaultView)return e.ownerDocument.defaultView.window;const s=t;return s!=null&&s.view?s.view.window:Wn},getDocument:t=>Uh(t).document}}();function ic(t){for(;t.firstChild;)t.firstChild.remove()}class ec{constructor(t,i,e,s){this._node=t,this._type=i,this._handler=e,this._options=s||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}}function sc(t,i,e,s){return new ec(t,i,e,s)}function nc(t,i){return function(e){return i(new ho(t,e))}}const rc=function(t,i,e,s){let n=e;return i==="click"||i==="mousedown"?n=nc(Uh(t),e):i!=="keydown"&&i!=="keypress"&&i!=="keyup"||(n=function(t){return function(i){return t(new so(i))}}(e)),sc(t,i,n,s)},oc=function(t,i,e){return function(t,i,e){return sc(t,xt&&Gr?qc.POINTER_DOWN:qc.MOUSE_DOWN,i,e)}(t,nc(Uh(t),i),e)};function hc(t,i,e){return xo(t,i,e)}class cc extends Do{constructor(t,i){super(t,i)}}let lc,ac;class uc extends ko{constructor(t){super(),this.defaultTarget=t&&Uh(t)}cancelAndSet(t,i,e){return super.cancelAndSet(t,i,e??this.defaultTarget)}}class dc{constructor(t,i=0){this._runner=t,this.priority=i,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(t){Ii(t)}}static sort(t,i){return i.priority-t.priority}}function fc(t){return Uh(t).getComputedStyle(t,null)}function gc(t,i){const e=Uh(t),s=e.document;if(t!==s.body)return new mc(t.clientWidth,t.clientHeight);if(xt&&(e!=null&&e.visualViewport))return new mc(e.visualViewport.width,e.visualViewport.height);if(e!=null&&e.innerWidth&&e.innerHeight)return new mc(e.innerWidth,e.innerHeight);if(s.body&&s.body.clientWidth&&s.body.clientHeight)return new mc(s.body.clientWidth,s.body.clientHeight);if(s.documentElement&&s.documentElement.clientWidth&&s.documentElement.clientHeight)return new mc(s.documentElement.clientWidth,s.documentElement.clientHeight);throw new Error("Unable to figure out browser width and height")}(function(){const t=new Map,i=new Map,e=new Map,s=new Map;ac=(n,r,o=0)=>{const h=Zh(n),c=new dc(r,o);let l=t.get(h);return l||(l=[],t.set(h,l)),l.push(c),e.get(h)||(e.set(h,!0),n.requestAnimationFrame((()=>(n=>{var r;e.set(n,!1);const o=(r=t.get(n))!==null&&r!==void 0?r:[];for(i.set(n,o),t.set(n,[]),s.set(n,!0);o.length>0;)o.sort(dc.sort),o.shift().execute();s.set(n,!1)})(h)))),c},lc=(t,e,n)=>{const r=Zh(t);if(s.get(r)){const t=new dc(e,n);let s=i.get(r);return s||(s=[],i.set(r,s)),s.push(t),t}return ac(t,e,n)}})();class pc{static convertToPixels(t,i){return parseFloat(i)||0}static getDimension(t,i,e){const s=fc(t),n=s?s.getPropertyValue(i):"0";return pc.convertToPixels(t,n)}static getBorderLeftWidth(t){return pc.getDimension(t,"border-left-width","borderLeftWidth")}static getBorderRightWidth(t){return pc.getDimension(t,"border-right-width","borderRightWidth")}static getBorderTopWidth(t){return pc.getDimension(t,"border-top-width","borderTopWidth")}static getBorderBottomWidth(t){return pc.getDimension(t,"border-bottom-width","borderBottomWidth")}static getPaddingLeft(t){return pc.getDimension(t,"padding-left","paddingLeft")}static getPaddingRight(t){return pc.getDimension(t,"padding-right","paddingRight")}static getPaddingTop(t){return pc.getDimension(t,"padding-top","paddingTop")}static getPaddingBottom(t){return pc.getDimension(t,"padding-bottom","paddingBottom")}static getMarginLeft(t){return pc.getDimension(t,"margin-left","marginLeft")}static getMarginTop(t){return pc.getDimension(t,"margin-top","marginTop")}static getMarginRight(t){return pc.getDimension(t,"margin-right","marginRight")}static getMarginBottom(t){return pc.getDimension(t,"margin-bottom","marginBottom")}}class mc{constructor(t,i){this.width=t,this.height=i}with(t=this.width,i=this.height){return t!==this.width||i!==this.height?new mc(t,i):this}static is(t){return typeof t=="object"&&typeof t.height=="number"&&typeof t.width=="number"}static lift(t){return t instanceof mc?t:new mc(t.width,t.height)}static equals(t,i){return t===i||!(!t||!i)&&t.width===i.width&&t.height===i.height}}function wc(t){let i=t.offsetParent,e=t.offsetTop,s=t.offsetLeft;for(;(t=t.parentNode)!==null&&t!==t.ownerDocument.body&&t!==t.ownerDocument.documentElement;){e-=t.scrollTop;const n=Ec(t)?null:fc(t);n&&(s-=n.direction!=="rtl"?t.scrollLeft:-t.scrollLeft),t===i&&(s+=pc.getBorderLeftWidth(t),e+=pc.getBorderTopWidth(t),e+=t.offsetTop,s+=t.offsetLeft,i=t.offsetParent)}return{left:s,top:e}}function vc(t){const i=t.getBoundingClientRect(),e=Uh(t);return{left:i.left+e.scrollX,top:i.top+e.scrollY,width:i.width,height:i.height}}function bc(t){let i=t,e=1;do{const t=fc(i).zoom;t!=null&&t!=="1"&&(e*=t),i=i.parentElement}while(i!==null&&i!==i.ownerDocument.documentElement);return e}function yc(t){const i=pc.getMarginLeft(t)+pc.getMarginRight(t);return t.offsetWidth+i}function kc(t){const i=pc.getBorderLeftWidth(t)+pc.getBorderRightWidth(t),e=pc.getPaddingLeft(t)+pc.getPaddingRight(t);return t.offsetWidth-i-e}function Cc(t){const i=pc.getBorderTopWidth(t)+pc.getBorderBottomWidth(t),e=pc.getPaddingTop(t)+pc.getPaddingBottom(t);return t.offsetHeight-i-e}function Sc(t){const i=pc.getMarginTop(t)+pc.getMarginBottom(t);return t.offsetHeight+i}function xc(t,i){return!!(i!=null&&i.contains(t))}function Dc(t,i,e){return!!function(t,i,e){for(;t&&t.nodeType===t.ELEMENT_NODE;){if(t.classList.contains(i))return t;if(e){if(typeof e=="string"){if(t.classList.contains(e))return null}else if(t===e)return null}t=t.parentNode}return null}(t,i,e)}function Ec(t){return t&&!!t.host&&!!t.mode}function Ac(t){return!!Mc(t)}function Mc(t){for(var i;t.parentNode;){if(t===((i=t.ownerDocument)===null||i===void 0?void 0:i.body))return null;t=t.parentNode}return Ec(t)?t:null}function Lc(){let t=Rc().activeElement;for(;t!=null&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}function Fc(t){return Lc()===t}function Tc(t){return xc(Lc(),t)}function Rc(){var t;return Gh()<=1?Wn.document:(t=Array.from(qh()).map((({window:t})=>t.document)).find((t=>t.hasFocus())))!==null&&t!==void 0?t:Wn.document}mc.None=new mc(0,0);const Oc=new Map;function Ic(){return new _c}class _c{constructor(){this._currentCssStyle="",this._styleSheet=void 0}setStyle(t){t!==this._currentCssStyle&&(this._currentCssStyle=t,this._styleSheet?this._styleSheet.innerText=t:this._styleSheet=Pc(Wn.document.head,(i=>i.innerText=t)))}dispose(){this._styleSheet&&(this._styleSheet.remove(),this._styleSheet=void 0)}}function Pc(t=Wn.document.head,i,e){const s=document.createElement("style");if(s.type="text/css",s.media="screen",i==null||i(s),t.appendChild(s),e&&e.add(Zi((()=>t.removeChild(s)))),t===Wn.document.head){const t=new Set;Oc.set(s,t);for(const{window:i,disposables:n}of qh()){if(i===Wn)continue;const r=n.add(Nc(s,t,i));e==null||e.add(r)}}return s}function Nc(t,i,e){var s,n;const r=new Ji,o=t.cloneNode(!0);e.document.head.appendChild(o),r.add(Zi((()=>e.document.head.removeChild(o))));for(const i of jc(t))(s=o.sheet)===null||s===void 0||s.insertRule(i.cssText,(n=o.sheet)===null||n===void 0?void 0:n.cssRules.length);return r.add(Bc.observe(t,r,{childList:!0})((()=>{o.textContent=t.textContent}))),i.add(o),r.add(Zi((()=>i.delete(o)))),r}const Bc=new class{constructor(){this.mutationObservers=new Map}observe(t,i,e){let s=this.mutationObservers.get(t);s||(s=new Map,this.mutationObservers.set(t,s));const n=Ph(e);let r=s.get(n);if(r)r.users+=1;else{const o=new le,h=new MutationObserver((t=>o.fire(t)));h.observe(t,e);const c=r={users:1,observer:h,onDidMutate:o.event};i.add(Zi((()=>{c.users-=1,c.users===0&&(o.dispose(),h.disconnect(),s==null||s.delete(n),(s==null?void 0:s.size)===0&&this.mutationObservers.delete(t))}))),s.set(n,r)}return r.onDidMutate}};let $c=null;function Wc(){return $c||($c=Pc()),$c}function jc(t){var i,e;return!((i=t==null?void 0:t.sheet)===null||i===void 0)&&i.rules?t.sheet.rules:!((e=t==null?void 0:t.sheet)===null||e===void 0)&&e.cssRules?t.sheet.cssRules:[]}function Hc(t,i,e=Wc()){var s,n;if(e&&i){(s=e.sheet)===null||s===void 0||s.insertRule(`${t} {${i}}`,0);for(const s of(n=Oc.get(e))!==null&&n!==void 0?n:[])Hc(t,i,s)}}function Vc(t,i=Wc()){var e,s;if(!i)return;const n=jc(i),r=[];for(let i=0;i<n.length;i++){const e=n[i];zc(e)&&e.selectorText.indexOf(t)!==-1&&r.push(i)}for(let t=r.length-1;t>=0;t--)(e=i.sheet)===null||e===void 0||e.deleteRule(r[t]);for(const e of(s=Oc.get(i))!==null&&s!==void 0?s:[])Vc(t,e)}function zc(t){return typeof t.selectorText=="string"}function Uc(t){return t instanceof MouseEvent||t instanceof Uh(t).MouseEvent}function Kc(t){return t instanceof KeyboardEvent||t instanceof Uh(t).KeyboardEvent}const qc={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",WHEEL:"wheel",KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup",LOAD:"load",BEFORE_UNLOAD:"beforeunload",UNLOAD:"unload",PAGE_SHOW:"pageshow",PAGE_HIDE:"pagehide",PASTE:"paste",ABORT:"abort",ERROR:"error",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_CHANGE:"fullscreenchange",WK_FULLSCREEN_CHANGE:"webkitfullscreenchange",SELECT:"select",CHANGE:"change",SUBMIT:"submit",RESET:"reset",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",STORAGE:"storage",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend",ANIMATION_START:Vr?"webkitAnimationStart":"animationstart",ANIMATION_END:Vr?"webkitAnimationEnd":"animationend",ANIMATION_ITERATION:Vr?"webkitAnimationIteration":"animationiteration"};function Gc(t){const i=t;return!(!i||typeof i.preventDefault!="function"||typeof i.stopPropagation!="function")}const Zc=(t,i)=>(t.preventDefault(),i&&t.stopPropagation(),t);class Jc extends Qi{static hasFocusWithin(t){if(t instanceof HTMLElement){const i=Mc(t);return xc(i?i.activeElement:t.ownerDocument.activeElement,t)}{const i=t;return xc(i.document.activeElement,i.document)}}constructor(t){super(),this._onDidFocus=this._register(new le),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new le),this.onDidBlur=this._onDidBlur.event;let i=Jc.hasFocusWithin(t),e=!1;const s=()=>{e=!1,i||(i=!0,this._onDidFocus.fire())},n=()=>{i&&(e=!0,(t instanceof HTMLElement?Uh(t):t).setTimeout((()=>{e&&(e=!1,i=!1,this._onDidBlur.fire())}),0))};this._refreshStateHandler=()=>{Jc.hasFocusWithin(t)!==i&&(i?n():s())},this._register(sc(t,qc.FOCUS,s,!0)),this._register(sc(t,qc.BLUR,n,!0)),t instanceof HTMLElement&&(this._register(sc(t,qc.FOCUS_IN,(()=>this._refreshStateHandler()))),this._register(sc(t,qc.FOCUS_OUT,(()=>this._refreshStateHandler()))))}}function Qc(t){return new Jc(t)}function Yc(t,...i){if(t.append(...i),i.length===1&&typeof i[0]!="string")return i[0]}function Xc(t,i){return t.insertBefore(i,t.firstChild),i}function tl(t,...i){t.innerText="",Yc(t,...i)}const il=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;var el;function sl(t,i,e,...s){const n=il.exec(i);if(!n)throw new Error("Bad use of emmet");const r=n[1]||"div";let o;return o=t!==el.HTML?document.createElementNS(t,r):document.createElement(r),n[3]&&(o.id=n[3]),n[4]&&(o.className=n[4].replace(/\./g," ").trim()),e&&Object.entries(e).forEach((([t,i])=>{i!==void 0&&(/^on\w+$/.test(t)?o[t]=i:t==="selected"?i&&o.setAttribute(t,"true"):o.setAttribute(t,i))})),o.append(...s),o}function nl(t,i,...e){return sl(el.HTML,t,i,...e)}function rl(...t){for(const i of t)i.style.display="",i.removeAttribute("aria-hidden")}function ol(...t){for(const i of t)i.style.display="none",i.setAttribute("aria-hidden","true")}function hl(t,i){const e=t.devicePixelRatio*i;return Math.max(1,Math.floor(e))/t.devicePixelRatio}function cl(t){Wn.open(t,"_blank","noopener")}function ll(t){return t?`url('${Ih.uriToBrowserUri(t).toString(!0).replace(/'/g,"%27")}')`:"url('')"}function al(t){return`'${t.replace(/'/g,"%27")}'`}function ul(t,i){if(t!==void 0){const e=t.match(/^\s*var\((.+)\)$/);if(e){const t=e[1].split(",",2);return t.length===2&&(i=ul(t[1].trim(),i)),`var(${t[0]}, ${i})`}return t}return i}(function(t){t.HTML="http://www.w3.org/1999/xhtml",t.SVG="http://www.w3.org/2000/svg"})(el||(el={})),nl.SVG=function(t,i,...e){return sl(el.SVG,t,i,...e)},Rh.setPreferredWebSchema(/^https:/.test(Wn.location.href)?"https":"http");const dl=Object.freeze(["a","abbr","b","bdo","blockquote","br","caption","cite","code","col","colgroup","dd","del","details","dfn","div","dl","dt","em","figcaption","figure","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","label","li","mark","ol","p","pre","q","rp","rt","ruby","samp","small","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","video","wbr"]);class fl extends le{constructor(){super(),this._subscriptions=new Ji,this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(ne.runAndSubscribe(Yh,(({window:t,disposables:i})=>this.registerListeners(t,i)),{window:Wn,disposables:this._subscriptions}))}registerListeners(t,i){i.add(sc(t,"keydown",(t=>{if(t.defaultPrevented)return;const i=new so(t);if(i.keyCode!==6||!t.repeat){if(t.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(t.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(t.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(t.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else{if(i.keyCode===6)return;this._keyStatus.lastKeyPressed=void 0}this._keyStatus.altKey=t.altKey,this._keyStatus.ctrlKey=t.ctrlKey,this._keyStatus.metaKey=t.metaKey,this._keyStatus.shiftKey=t.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=t,this.fire(this._keyStatus))}}),!0)),i.add(sc(t,"keyup",(t=>{t.defaultPrevented||(!t.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!t.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!t.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!t.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=t.altKey,this._keyStatus.ctrlKey=t.ctrlKey,this._keyStatus.metaKey=t.metaKey,this._keyStatus.shiftKey=t.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=t,this.fire(this._keyStatus)))}),!0)),i.add(sc(t.document.body,"mousedown",(()=>{this._keyStatus.lastKeyPressed=void 0}),!0)),i.add(sc(t.document.body,"mouseup",(()=>{this._keyStatus.lastKeyPressed=void 0}),!0)),i.add(sc(t.document.body,"mousemove",(t=>{t.buttons&&(this._keyStatus.lastKeyPressed=void 0)}),!0)),i.add(sc(t,"blur",(()=>{this.resetKeyStatus()})))}get keyStatus(){return this._keyStatus}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return fl.instance||(fl.instance=new fl),fl.instance}dispose(){super.dispose(),this._subscriptions.dispose()}}class gl extends Qi{constructor(t,i){super(),this.element=t,this.callbacks=i,this.counter=0,this.dragStartTime=0,this.registerListeners()}registerListeners(){this.callbacks.onDragStart&&this._register(sc(this.element,qc.DRAG_START,(t=>{var i,e;(e=(i=this.callbacks).onDragStart)===null||e===void 0||e.call(i,t)}))),this.callbacks.onDrag&&this._register(sc(this.element,qc.DRAG,(t=>{var i,e;(e=(i=this.callbacks).onDrag)===null||e===void 0||e.call(i,t)}))),this._register(sc(this.element,qc.DRAG_ENTER,(t=>{var i,e;this.counter++,this.dragStartTime=t.timeStamp,(e=(i=this.callbacks).onDragEnter)===null||e===void 0||e.call(i,t)}))),this._register(sc(this.element,qc.DRAG_OVER,(t=>{var i,e;t.preventDefault(),(e=(i=this.callbacks).onDragOver)===null||e===void 0||e.call(i,t,t.timeStamp-this.dragStartTime)}))),this._register(sc(this.element,qc.DRAG_LEAVE,(t=>{var i,e;this.counter--,this.counter===0&&(this.dragStartTime=0,(e=(i=this.callbacks).onDragLeave)===null||e===void 0||e.call(i,t))}))),this._register(sc(this.element,qc.DRAG_END,(t=>{var i,e;this.counter=0,this.dragStartTime=0,(e=(i=this.callbacks).onDragEnd)===null||e===void 0||e.call(i,t)}))),this._register(sc(this.element,qc.DROP,(t=>{var i,e;this.counter=0,this.dragStartTime=0,(e=(i=this.callbacks).onDrop)===null||e===void 0||e.call(i,t)})))}}const pl=/(?<tag>[\w\-]+)?(?:#(?<id>[\w\-]+))?(?<class>(?:\.(?:[\w\-]+))*)(?:@(?<name>(?:[\w\_])+))?/;function ml(t,...i){let e,s;Array.isArray(i[0])?(e={},s=i[0]):(e=i[0]||{},s=i[1]);const n=pl.exec(t);if(!n||!n.groups)throw new Error("Bad use of h");const r=n.groups.tag||"div",o=document.createElement(r);n.groups.id&&(o.id=n.groups.id);const h=[];if(n.groups.class)for(const t of n.groups.class.split("."))t!==""&&h.push(t);if(e.className!==void 0)for(const t of e.className.split("."))t!==""&&h.push(t);h.length>0&&(o.className=h.join(" "));const c={};if(n.groups.name&&(c[n.groups.name]=o),s)for(const t of s)t instanceof HTMLElement?o.appendChild(t):typeof t=="string"?o.append(t):"root"in t&&(Object.assign(c,t),o.appendChild(t.root));for(const[t,i]of Object.entries(e))if(t!=="className")if(t==="style")for(const[t,e]of Object.entries(i))o.style.setProperty(wl(t),typeof e=="number"?e+"px":""+e);else t==="tabIndex"?o.tabIndex=i:o.setAttribute(wl(t),i.toString());return c.root=o,c}function wl(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}class vl extends Qi{constructor(t){super(),this._onDidChange=this._register(new le),this.onDidChange=this._onDidChange.event,this._listener=()=>this._handleChange(t,!0),this._mediaQueryList=null,this._handleChange(t,!1)}_handleChange(t,i){var e;(e=this._mediaQueryList)===null||e===void 0||e.removeEventListener("change",this._listener),this._mediaQueryList=t.matchMedia(`(resolution: ${t.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),i&&this._onDidChange.fire()}}class bl extends Qi{get value(){return this._value}constructor(t){super(),this._onDidChange=this._register(new le),this.onDidChange=this._onDidChange.event,this._value=this._getPixelRatio(t);const i=this._register(new vl(t));this._register(i.onDidChange((()=>{this._value=this._getPixelRatio(t),this._onDidChange.fire(this._value)})))}_getPixelRatio(t){const i=document.createElement("canvas").getContext("2d");return(t.devicePixelRatio||1)/(i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1)}}const yl=new class{constructor(){this.mapWindowIdToPixelRatioMonitor=new Map}_getOrCreatePixelRatioMonitor(t){const i=Zh(t);let e=this.mapWindowIdToPixelRatioMonitor.get(i);return e||(e=new bl(t),this.mapWindowIdToPixelRatioMonitor.set(i,e),ne.once(tc)((({vscodeWindowId:t})=>{t===i&&(e==null||e.dispose(),this.mapWindowIdToPixelRatioMonitor.delete(i))}))),e}getInstance(t){return this._getOrCreatePixelRatioMonitor(t)}};class kl{constructor(t){this.domNode=t,this._maxWidth="",this._width="",this._height="",this._top="",this._left="",this._bottom="",this._right="",this._paddingLeft="",this._fontFamily="",this._fontWeight="",this._fontSize="",this._fontStyle="",this._fontFeatureSettings="",this._fontVariationSettings="",this._textDecoration="",this._lineHeight="",this._letterSpacing="",this._className="",this._display="",this._position="",this._visibility="",this._color="",this._backgroundColor="",this._layerHint=!1,this._contain="none",this._boxShadow=""}setMaxWidth(t){const i=Cl(t);this._maxWidth!==i&&(this._maxWidth=i,this.domNode.style.maxWidth=this._maxWidth)}setWidth(t){const i=Cl(t);this._width!==i&&(this._width=i,this.domNode.style.width=this._width)}setHeight(t){const i=Cl(t);this._height!==i&&(this._height=i,this.domNode.style.height=this._height)}setTop(t){const i=Cl(t);this._top!==i&&(this._top=i,this.domNode.style.top=this._top)}setLeft(t){const i=Cl(t);this._left!==i&&(this._left=i,this.domNode.style.left=this._left)}setBottom(t){const i=Cl(t);this._bottom!==i&&(this._bottom=i,this.domNode.style.bottom=this._bottom)}setRight(t){const i=Cl(t);this._right!==i&&(this._right=i,this.domNode.style.right=this._right)}setPaddingLeft(t){const i=Cl(t);this._paddingLeft!==i&&(this._paddingLeft=i,this.domNode.style.paddingLeft=this._paddingLeft)}setFontFamily(t){this._fontFamily!==t&&(this._fontFamily=t,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(t){const i=Cl(t);this._fontSize!==i&&(this._fontSize=i,this.domNode.style.fontSize=this._fontSize)}setFontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(t){this._fontFeatureSettings!==t&&(this._fontFeatureSettings=t,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(t){this._fontVariationSettings!==t&&(this._fontVariationSettings=t,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(t){this._textDecoration!==t&&(this._textDecoration=t,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(t){const i=Cl(t);this._lineHeight!==i&&(this._lineHeight=i,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(t){const i=Cl(t);this._letterSpacing!==i&&(this._letterSpacing=i,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(t){this._className!==t&&(this._className=t,this.domNode.className=this._className)}toggleClassName(t,i){this.domNode.classList.toggle(t,i),this._className=this.domNode.className}setDisplay(t){this._display!==t&&(this._display=t,this.domNode.style.display=this._display)}setPosition(t){this._position!==t&&(this._position=t,this.domNode.style.position=this._position)}setVisibility(t){this._visibility!==t&&(this._visibility=t,this.domNode.style.visibility=this._visibility)}setColor(t){this._color!==t&&(this._color=t,this.domNode.style.color=this._color)}setBackgroundColor(t){this._backgroundColor!==t&&(this._backgroundColor=t,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(t){this._layerHint!==t&&(this._layerHint=t,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(t){this._boxShadow!==t&&(this._boxShadow=t,this.domNode.style.boxShadow=t)}setContain(t){this._contain!==t&&(this._contain=t,this.domNode.style.contain=this._contain)}setAttribute(t,i){this.domNode.setAttribute(t,i)}removeAttribute(t){this.domNode.removeAttribute(t)}appendChild(t){this.domNode.appendChild(t.domNode)}removeChild(t){this.domNode.removeChild(t.domNode)}}function Cl(t){return typeof t=="number"?`${t}px`:t}function Sl(t){return new kl(t)}function xl(t,i){t instanceof kl?(t.setFontFamily(i.getMassagedFontFamily()),t.setFontWeight(i.fontWeight),t.setFontSize(i.fontSize),t.setFontFeatureSettings(i.fontFeatureSettings),t.setFontVariationSettings(i.fontVariationSettings),t.setLineHeight(i.lineHeight),t.setLetterSpacing(i.letterSpacing)):(t.style.fontFamily=i.getMassagedFontFamily(),t.style.fontWeight=i.fontWeight,t.style.fontSize=i.fontSize+"px",t.style.fontFeatureSettings=i.fontFeatureSettings,t.style.fontVariationSettings=i.fontVariationSettings,t.style.lineHeight=i.lineHeight+"px",t.style.letterSpacing=i.letterSpacing+"px")}class Dl{constructor(t,i){this.chr=t,this.type=i,this.width=0}fulfill(t){this.width=t}}class El{constructor(t,i){this._bareFontInfo=t,this._requests=i,this._container=null,this._testElements=null}read(t){this._createDomElements(),t.document.body.appendChild(this._container),this._readFromDomElements(),t.document.body.removeChild(this._container),this._container=null,this._testElements=null}_createDomElements(){const t=document.createElement("div");t.style.position="absolute",t.style.top="-50000px",t.style.width="50000px";const i=document.createElement("div");xl(i,this._bareFontInfo),t.appendChild(i);const e=document.createElement("div");xl(e,this._bareFontInfo),e.style.fontWeight="bold",t.appendChild(e);const s=document.createElement("div");xl(s,this._bareFontInfo),s.style.fontStyle="italic",t.appendChild(s);const n=[];for(const t of this._requests){let r;t.type===0&&(r=i),t.type===2&&(r=e),t.type===1&&(r=s),r.appendChild(document.createElement("br"));const o=document.createElement("span");El._render(o,t),r.appendChild(o),n.push(o)}this._container=t,this._testElements=n}static _render(t,i){if(i.chr===" "){let i=" ";for(let t=0;t<8;t++)i+=i;t.innerText=i}else{let e=i.chr;for(let t=0;t<8;t++)e+=e;t.textContent=e}}_readFromDomElements(){for(let t=0,i=this._requests.length;t<i;t++){const i=this._requests[t],e=this._testElements[t];i.fulfill(e.offsetWidth/256)}}}const Al=new class{constructor(){this._zoomLevel=0,this._onDidChangeZoomLevel=new le,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event}getZoomLevel(){return this._zoomLevel}setZoomLevel(t){t=Math.min(Math.max(-5,t),20),this._zoomLevel!==t&&(this._zoomLevel=t,this._onDidChangeZoomLevel.fire(this._zoomLevel))}},Ml=bt?1.5:1.35;class Ll{static createFromValidatedSettings(t,i,e){const s=t.get(49),n=t.get(53),r=t.get(52),o=t.get(51),h=t.get(54),c=t.get(67),l=t.get(64);return Ll._create(s,n,r,o,h,c,l,i,e)}static _create(t,i,e,s,n,r,o,h,c){r===0?r=Ml*e:r<8&&(r*=e),(r=Math.round(r))<8&&(r=8);const l=1+(c?0:.1*Al.getZoomLevel());return e*=l,r*=l,n===pi.TRANSLATE&&(i==="normal"||i==="bold"?n=pi.OFF:(n=`'wght' ${parseInt(i,10)}`,i="normal")),new Ll({pixelRatio:h,fontFamily:t,fontWeight:i,fontSize:e,fontFeatureSettings:s,fontVariationSettings:n,lineHeight:r,letterSpacing:o})}constructor(t){this._bareFontInfoBrand=void 0,this.pixelRatio=t.pixelRatio,this.fontFamily=String(t.fontFamily),this.fontWeight=String(t.fontWeight),this.fontSize=t.fontSize,this.fontFeatureSettings=t.fontFeatureSettings,this.fontVariationSettings=t.fontVariationSettings,this.lineHeight=0|t.lineHeight,this.letterSpacing=t.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){const t=Li.fontFamily,i=Ll._wrapInQuotes(this.fontFamily);return t&&this.fontFamily!==t?`${i}, ${t}`:i}static _wrapInQuotes(t){return/[,"']/.test(t)?t:/[+ ]/.test(t)?`"${t}"`:t}}class Fl extends Ll{constructor(t,i){super(t),this._editorStylingBrand=void 0,this.version=2,this.isTrusted=i,this.isMonospace=t.isMonospace,this.typicalHalfwidthCharacterWidth=t.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=t.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=t.canUseHalfwidthRightwardsArrow,this.spaceWidth=t.spaceWidth,this.middotWidth=t.middotWidth,this.wsmiddotWidth=t.wsmiddotWidth,this.maxDigitWidth=t.maxDigitWidth}equals(t){return this.fontFamily===t.fontFamily&&this.fontWeight===t.fontWeight&&this.fontSize===t.fontSize&&this.fontFeatureSettings===t.fontFeatureSettings&&this.fontVariationSettings===t.fontVariationSettings&&this.lineHeight===t.lineHeight&&this.letterSpacing===t.letterSpacing&&this.typicalHalfwidthCharacterWidth===t.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===t.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===t.canUseHalfwidthRightwardsArrow&&this.spaceWidth===t.spaceWidth&&this.middotWidth===t.middotWidth&&this.wsmiddotWidth===t.wsmiddotWidth&&this.maxDigitWidth===t.maxDigitWidth}}class Tl{constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(t){const i=t.getId();return!!this._values[i]}get(t){const i=t.getId();return this._values[i]}put(t,i){const e=t.getId();this._keys[e]=t,this._values[e]=i}remove(t){const i=t.getId();delete this._keys[i],delete this._values[i]}getValues(){return Object.keys(this._keys).map((t=>this._values[t]))}}const Rl=new class extends Qi{constructor(){super(...arguments),this._cache=new Map,this._evictUntrustedReadingsTimeout=-1,this._onDidChange=this._register(new le),this.onDidChange=this._onDidChange.event}dispose(){this._evictUntrustedReadingsTimeout!==-1&&(clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearAllFontInfos(){this._cache.clear(),this._onDidChange.fire()}_ensureCache(t){const i=Zh(t);let e=this._cache.get(i);return e||(e=new Tl,this._cache.set(i,e)),e}_writeToCache(t,i,e){this._ensureCache(t).put(i,e),e.isTrusted||this._evictUntrustedReadingsTimeout!==-1||(this._evictUntrustedReadingsTimeout=t.setTimeout((()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings(t)}),5e3))}_evictUntrustedReadings(t){const i=this._ensureCache(t),e=i.getValues();let s=!1;for(const t of e)t.isTrusted||(s=!0,i.remove(t));s&&this._onDidChange.fire()}readFontInfo(t,i){const e=this._ensureCache(t);if(!e.has(i)){let e=this._actualReadFontInfo(t,i);(e.typicalHalfwidthCharacterWidth<=2||e.typicalFullwidthCharacterWidth<=2||e.spaceWidth<=2||e.maxDigitWidth<=2)&&(e=new Fl({pixelRatio:yl.getInstance(t).value,fontFamily:e.fontFamily,fontWeight:e.fontWeight,fontSize:e.fontSize,fontFeatureSettings:e.fontFeatureSettings,fontVariationSettings:e.fontVariationSettings,lineHeight:e.lineHeight,letterSpacing:e.letterSpacing,isMonospace:e.isMonospace,typicalHalfwidthCharacterWidth:Math.max(e.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(e.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:e.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(e.spaceWidth,5),middotWidth:Math.max(e.middotWidth,5),wsmiddotWidth:Math.max(e.wsmiddotWidth,5),maxDigitWidth:Math.max(e.maxDigitWidth,5)},!1)),this._writeToCache(t,i,e)}return e.get(i)}_createRequest(t,i,e,s){const n=new Dl(t,i);return e.push(n),s==null||s.push(n),n}_actualReadFontInfo(t,i){const e=[],s=[],n=this._createRequest("n",0,e,s),r=this._createRequest("ｍ",0,e,null),o=this._createRequest(" ",0,e,s),h=this._createRequest("0",0,e,s),c=this._createRequest("1",0,e,s),l=this._createRequest("2",0,e,s),a=this._createRequest("3",0,e,s),u=this._createRequest("4",0,e,s),d=this._createRequest("5",0,e,s),f=this._createRequest("6",0,e,s),g=this._createRequest("7",0,e,s),p=this._createRequest("8",0,e,s),m=this._createRequest("9",0,e,s),w=this._createRequest("→",0,e,s),v=this._createRequest("￫",0,e,null),b=this._createRequest("·",0,e,s),y=this._createRequest("⸱",0,e,null),k="|/-_ilm%";for(let t=0,i=8;t<i;t++)this._createRequest(k.charAt(t),0,e,s),this._createRequest(k.charAt(t),1,e,s),this._createRequest(k.charAt(t),2,e,s);(function(t,i,e){new El(i,e).read(t)})(t,i,e);const C=Math.max(h.width,c.width,l.width,a.width,u.width,d.width,f.width,g.width,p.width,m.width);let S=i.fontFeatureSettings===gi.OFF;const x=s[0].width;for(let t=1,i=s.length;S&&t<i;t++){const i=x-s[t].width;if(i<-.001||i>.001){S=!1;break}}let D=!0;return S&&v.width!==x&&(D=!1),v.width>w.width&&(D=!1),new Fl({pixelRatio:yl.getInstance(t).value,fontFamily:i.fontFamily,fontWeight:i.fontWeight,fontSize:i.fontSize,fontFeatureSettings:i.fontFeatureSettings,fontVariationSettings:i.fontVariationSettings,lineHeight:i.lineHeight,letterSpacing:i.letterSpacing,isMonospace:S,typicalHalfwidthCharacterWidth:n.width,typicalFullwidthCharacterWidth:r.width,canUseHalfwidthRightwardsArrow:D,spaceWidth:o.width,middotWidth:b.width,wsmiddotWidth:y.width,maxDigitWidth:C},!0)}};var Ol;(function(t){t.serviceIds=new Map,t.DI_TARGET="$di$target",t.DI_DEPENDENCIES="$di$dependencies",t.getServiceDependencies=function(i){return i[t.DI_DEPENDENCIES]||[]}})(Ol||(Ol={}));const Il=_l("instantiationService");function _l(t){if(Ol.serviceIds.has(t))return Ol.serviceIds.get(t);const i=function(t,e,s){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(t,i,e){i[Ol.DI_TARGET]===i?i[Ol.DI_DEPENDENCIES].push({id:t,index:e}):(i[Ol.DI_DEPENDENCIES]=[{id:t,index:e}],i[Ol.DI_TARGET]=i)})(i,t,s)};return i.toString=()=>t,Ol.serviceIds.set(t,i),i}const Pl=_l("codeEditorService"),Nl=_l("modelService"),Bl=_l("textModelService");class $l extends Qi{constructor(t,i="",e="",s=!0,n){super(),this._onDidChange=this._register(new le),this.onDidChange=this._onDidChange.event,this._enabled=!0,this._id=t,this._label=i,this._cssClass=e,this._enabled=s,this._actionCallback=n}get id(){return this._id}get label(){return this._label}set label(t){this._setLabel(t)}_setLabel(t){this._label!==t&&(this._label=t,this._onDidChange.fire({label:t}))}get tooltip(){return this._tooltip||""}set tooltip(t){this._setTooltip(t)}_setTooltip(t){this._tooltip!==t&&(this._tooltip=t,this._onDidChange.fire({tooltip:t}))}get class(){return this._cssClass}set class(t){this._setClass(t)}_setClass(t){this._cssClass!==t&&(this._cssClass=t,this._onDidChange.fire({class:t}))}get enabled(){return this._enabled}set enabled(t){this._setEnabled(t)}_setEnabled(t){this._enabled!==t&&(this._enabled=t,this._onDidChange.fire({enabled:t}))}get checked(){return this._checked}set checked(t){this._setChecked(t)}_setChecked(t){this._checked!==t&&(this._checked=t,this._onDidChange.fire({checked:t}))}async run(t,i){this._actionCallback&&await this._actionCallback(t)}}class Wl extends Qi{constructor(){super(...arguments),this._onWillRun=this._register(new le),this.onWillRun=this._onWillRun.event,this._onDidRun=this._register(new le),this.onDidRun=this._onDidRun.event}async run(t,i){if(!t.enabled)return;let e;this._onWillRun.fire({action:t});try{await this.runAction(t,i)}catch(t){e=t}this._onDidRun.fire({action:t,error:e})}async runAction(t,i){await t.run(i)}}class jl{constructor(){this.id=jl.ID,this.label="",this.tooltip="",this.class="separator",this.enabled=!1,this.checked=!1}static join(...t){let i=[];for(const e of t)e.length&&(i=i.length?[...i,new jl,...e]:e);return i}async run(){}}jl.ID="vs.actions.separator";class Hl{get actions(){return this._actions}constructor(t,i,e,s){this.tooltip="",this.enabled=!0,this.checked=void 0,this.id=t,this.label=i,this.class=s,this._actions=e}async run(){}}class Vl extends $l{constructor(){super(Vl.ID,tt(0,"(empty)"),void 0,!1)}}function zl(t){var i;return{id:t.id,label:t.label,class:t.class,enabled:(i=t.enabled)===null||i===void 0||i,checked:t.checked,run:async(...i)=>t.run(...i),tooltip:t.label}}var Ul,Kl;Vl.ID="vs.actions.empty",function(t){t.isThemeColor=function(t){return t&&typeof t=="object"&&typeof t.id=="string"}}(Ul||(Ul={})),function(t){t.iconNameSegment="[A-Za-z0-9]+",t.iconNameExpression="[A-Za-z0-9-]+",t.iconModifierExpression="~[A-Za-z]+",t.iconNameCharacter="[A-Za-z0-9~-]";const i=new RegExp(`^(${t.iconNameExpression})(${t.iconModifierExpression})?$`);function e(t){const s=i.exec(t.id);if(!s)return e(As.error);const[,n,r]=s,o=["codicon","codicon-"+n];return r&&o.push("codicon-modifier-"+r.substring(1)),o}t.asClassNameArray=e,t.asClassName=function(t){return e(t).join(" ")},t.asCSSSelector=function(t){return"."+e(t).join(".")},t.isThemeIcon=function(t){return t&&typeof t=="object"&&typeof t.id=="string"&&(t.color===void 0||Ul.isThemeColor(t.color))};const s=new RegExp(`^\\$\\((${t.iconNameExpression}(?:${t.iconModifierExpression})?)\\)$`);t.fromString=function(t){const i=s.exec(t);if(!i)return;const[,e]=i;return{id:e}},t.fromId=function(t){return{id:t}},t.modify=function(t,i){let e=t.id;const s=e.lastIndexOf("~");return s!==-1&&(e=e.substring(0,s)),i&&(e=`${e}~${i}`),{id:e}},t.getModifier=function(t){const i=t.id.lastIndexOf("~");if(i!==-1)return t.id.substring(i+1)},t.isEqual=function(t,i){var e,s;return t.id===i.id&&((e=t.color)===null||e===void 0?void 0:e.id)===((s=i.color)===null||s===void 0?void 0:s.id)}}(Kl||(Kl={}));const ql=_l("commandService"),Gl=new class{constructor(){this._commands=new Map,this._onDidRegisterCommand=new le,this.onDidRegisterCommand=this._onDidRegisterCommand.event}registerCommand(t,i){if(!t)throw new Error("invalid command");if(typeof t=="string"){if(!i)throw new Error("invalid command");return this.registerCommand({id:t,handler:i})}if(t.metadata&&Array.isArray(t.metadata.args)){const i=[];for(const e of t.metadata.args)i.push(e.constraint);const e=t.handler;t.handler=function(t,...s){return function(t,i){const e=Math.min(t.length,i.length);for(let s=0;s<e;s++)z(t[s],i[s])}(s,i),e(t,...s)}}const{id:e}=t;let s=this._commands.get(e);s||(s=new Ht,this._commands.set(e,s));const n=s.unshift(t),r=Zi((()=>{n();const t=this._commands.get(e);t!=null&&t.isEmpty()&&this._commands.delete(e)}));return this._onDidRegisterCommand.fire(e),r}registerCommandAlias(t,i){return Gl.registerCommand(t,((t,...e)=>t.get(ql).executeCommand(i,...e)))}getCommand(t){const i=this._commands.get(t);if(i&&!i.isEmpty())return Wt.first(i)}getCommands(){const t=new Map;for(const i of this._commands.keys()){const e=this.getCommand(i);e&&t.set(i,e)}return t}};function Zl(...t){switch(t.length){case 1:return tt(0,"Did you mean {0}?",t[0]);case 2:return tt(0,"Did you mean {0} or {1}?",t[0],t[1]);case 3:return tt(0,"Did you mean {0}, {1} or {2}?",t[0],t[1],t[2]);default:return}}Gl.registerCommand("noop",(()=>{}));const Jl=tt(0,"Did you forget to open or close the quote?"),Ql=tt(0,"Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'.");let Yl=class t{constructor(){this._input="",this._start=0,this._current=0,this._tokens=[],this._errors=[],this.stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(t){switch(t.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return t.isTripleEq?"===":"==";case 4:return t.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:case 8:return">=";case 9:return"=~";case 10:case 17:case 18:case 19:return t.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 20:return"EOF";default:throw ji(`unhandled token type: ${JSON.stringify(t)}; have you forgotten to add a case?`)}}reset(t){return this._input=t,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){const t=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:t})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){const t=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:t})}else this._match(126)?this._addToken(9):this._error(Zl("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(Zl("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(Zl("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(t){return!this._isAtEnd()&&this._input.charCodeAt(this._current)===t&&(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(t){this._tokens.push({type:t,offset:this._start})}_error(t){const i=this._start,e=this._input.substring(this._start,this._current),s={type:19,offset:this._start,lexeme:e};this._errors.push({offset:i,lexeme:e,additionalInfo:t}),this._tokens.push(s)}_string(){this.stringRe.lastIndex=this._start;const i=this.stringRe.exec(this._input);if(i){this._current=this._start+i[0].length;const e=this._input.substring(this._start,this._current),s=t._keywords.get(e);s?this._addToken(s):this._tokens.push({type:17,lexeme:e,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();this._isAtEnd()?this._error(Jl):(this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1}))}_regex(){let i=this._current,e=!1,s=!1;for(;;){if(i>=this._input.length)return this._current=i,void this._error(Ql);const t=this._input.charCodeAt(i);if(e)e=!1;else{if(t===47&&!s){i++;break}t===91?s=!0:t===92?e=!0:t===93&&(s=!1)}i++}for(;i<this._input.length&&t._regexFlags.has(this._input.charCodeAt(i));)i++;this._current=i;const n=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:n,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}};Yl._regexFlags=new Set(["i","g","s","m","y","u"].map((t=>t.charCodeAt(0)))),Yl._keywords=new Map([["not",14],["in",13],["false",12],["true",11]]);const Xl=new Map;Xl.set("false",!1),Xl.set("true",!0),Xl.set("isMac",bt),Xl.set("isLinux",yt),Xl.set("isWindows",vt),Xl.set("isWeb",Ct),Xl.set("isMacNative",bt&&!Ct),Xl.set("isEdge",Nt),Xl.set("isFirefox",_t),Xl.set("isChrome",It),Xl.set("isSafari",Pt);const ta=Object.prototype.hasOwnProperty,ia={regexParsingWithErrorRecovery:!0},ea=tt(0,"Empty context key expression"),sa=tt(0,"Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),na=tt(0,"'in' after 'not'."),ra=tt(0,"closing parenthesis ')'"),oa=tt(0,"Unexpected token"),ha=tt(0,"Did you forget to put && or || before the token?"),ca=tt(0,"Unexpected end of expression"),la=tt(0,"Did you forget to put a context key?");let aa=class t{constructor(t=ia){this._config=t,this._scanner=new Yl,this._tokens=[],this._current=0,this._parsingErrors=[],this._flagsGYRe=/g|y/g}parse(i){if(i!==""){this._tokens=this._scanner.reset(i).scan(),this._current=0,this._parsingErrors=[];try{const i=this._expr();if(!this._isAtEnd()){const i=this._peek(),e=i.type===17?ha:void 0;throw this._parsingErrors.push({message:oa,offset:i.offset,lexeme:Yl.getLexeme(i),additionalInfo:e}),t._parseError}return i}catch(i){if(i!==t._parseError)throw i;return}}else this._parsingErrors.push({message:ea,offset:0,lexeme:"",additionalInfo:sa})}_expr(){return this._or()}_or(){const t=[this._and()];for(;this._matchOne(16);){const i=this._and();t.push(i)}return t.length===1?t[0]:ua.or(...t)}_and(){const t=[this._term()];for(;this._matchOne(15);){const i=this._term();t.push(i)}return t.length===1?t[0]:ua.and(...t)}_term(){if(this._matchOne(2)){const t=this._peek();switch(t.type){case 11:return this._advance(),fa.INSTANCE;case 12:return this._advance(),ga.INSTANCE;case 0:{this._advance();const t=this._expr();return this._consume(1,ra),t==null?void 0:t.negate()}case 17:return this._advance(),ya.create(t.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",t)}}return this._primary()}_primary(){const i=this._peek();switch(i.type){case 11:return this._advance(),ua.true();case 12:return this._advance(),ua.false();case 0:{this._advance();const t=this._expr();return this._consume(1,ra),t}case 17:{const t=i.lexeme;if(this._advance(),this._matchOne(9)){const i=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),i.type!==10)throw this._errExpectedButGot("REGEX",i);const e=i.lexeme,s=e.lastIndexOf("/"),n=s===e.length-1?void 0:this._removeFlagsGY(e.substring(s+1));let r;try{r=new RegExp(e.substring(1,s),n)}catch{throw this._errExpectedButGot("REGEX",i)}return Ea.create(t,r)}switch(i.type){case 10:case 19:{const e=[i.lexeme];this._advance();let s=this._peek(),n=0;for(let t=0;t<i.lexeme.length;t++)i.lexeme.charCodeAt(t)===40?n++:i.lexeme.charCodeAt(t)===41&&n--;for(;!this._isAtEnd()&&s.type!==15&&s.type!==16;){switch(s.type){case 0:n++;break;case 1:n--;break;case 10:case 18:for(let t=0;t<s.lexeme.length;t++)s.lexeme.charCodeAt(t)===40?n++:i.lexeme.charCodeAt(t)===41&&n--}if(n<0)break;e.push(Yl.getLexeme(s)),this._advance(),s=this._peek()}const r=e.join(""),o=r.lastIndexOf("/"),h=o===r.length-1?void 0:this._removeFlagsGY(r.substring(o+1));let c;try{c=new RegExp(r.substring(1,o),h)}catch{throw this._errExpectedButGot("REGEX",i)}return ua.regex(t,c)}case 18:{const e=i.lexeme;this._advance();let s=null;if(!zn(e)){const t=e.indexOf("/"),n=e.lastIndexOf("/");if(t!==n&&t>=0){const r=e.slice(t+1,n),o=e[n+1]==="i"?"i":"";try{s=new RegExp(r,o)}catch{throw this._errExpectedButGot("REGEX",i)}}}if(s===null)throw this._errExpectedButGot("REGEX",i);return Ea.create(t,s)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,na);const i=this._value();return ua.notIn(t,i)}switch(this._peek().type){case 3:{this._advance();const i=this._value();if(this._previous().type===18)return ua.equals(t,i);switch(i){case"true":return ua.has(t);case"false":return ua.not(t);default:return ua.equals(t,i)}}case 4:{this._advance();const i=this._value();if(this._previous().type===18)return ua.notEquals(t,i);switch(i){case"true":return ua.not(t);case"false":return ua.has(t);default:return ua.notEquals(t,i)}}case 5:return this._advance(),xa.create(t,this._value());case 6:return this._advance(),Da.create(t,this._value());case 7:return this._advance(),Ca.create(t,this._value());case 8:return this._advance(),Sa.create(t,this._value());case 13:return this._advance(),ua.in(t,this._value());default:return ua.has(t)}}case 20:throw this._parsingErrors.push({message:ca,offset:i.offset,lexeme:"",additionalInfo:la}),t._parseError;default:throw this._errExpectedButGot(`true | false | KEY \n\t| KEY '=~' REGEX \n\t| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){const t=this._peek();switch(t.type){case 17:case 18:return this._advance(),t.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_removeFlagsGY(t){return t.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(t){return!!this._check(t)&&(this._advance(),!0)}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(t,i){if(this._check(t))return this._advance();throw this._errExpectedButGot(i,this._peek())}_errExpectedButGot(i,e,s){const n=tt(0,`Expected: {0}\nReceived: '{1}'.`,i,Yl.getLexeme(e)),r=e.offset,o=Yl.getLexeme(e);return this._parsingErrors.push({message:n,offset:r,lexeme:o,additionalInfo:s}),t._parseError}_check(t){return this._peek().type===t}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}};aa._parseError=new Error;class ua{static false(){return fa.INSTANCE}static true(){return ga.INSTANCE}static has(t){return pa.create(t)}static equals(t,i){return ma.create(t,i)}static notEquals(t,i){return ba.create(t,i)}static regex(t,i){return Ea.create(t,i)}static in(t,i){return wa.create(t,i)}static notIn(t,i){return va.create(t,i)}static not(t){return ya.create(t)}static and(...t){return La.create(t,null,!0)}static or(...t){return Fa.create(t,null,!0)}static deserialize(t){if(t!=null)return this._parser.parse(t)}}function da(t,i){return t.cmp(i)}ua._parser=new aa({regexParsingWithErrorRecovery:!1});class fa{constructor(){this.type=0}cmp(t){return this.type-t.type}equals(t){return t.type===this.type}substituteConstants(){return this}evaluate(t){return!1}serialize(){return"false"}keys(){return[]}negate(){return ga.INSTANCE}}fa.INSTANCE=new fa;class ga{constructor(){this.type=1}cmp(t){return this.type-t.type}equals(t){return t.type===this.type}substituteConstants(){return this}evaluate(t){return!0}serialize(){return"true"}keys(){return[]}negate(){return fa.INSTANCE}}ga.INSTANCE=new ga;class pa{static create(t,i=null){const e=Xl.get(t);return typeof e=="boolean"?e?ga.INSTANCE:fa.INSTANCE:new pa(t,i)}constructor(t,i){this.key=t,this.negated=i,this.type=2}cmp(t){return t.type!==this.type?this.type-t.type:Oa(this.key,t.key)}equals(t){return t.type===this.type&&this.key===t.key}substituteConstants(){const t=Xl.get(this.key);return typeof t=="boolean"?t?ga.INSTANCE:fa.INSTANCE:this}evaluate(t){return!!t.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}negate(){return this.negated||(this.negated=ya.create(this.key,this)),this.negated}}class ma{static create(t,i,e=null){if(typeof i=="boolean")return i?pa.create(t,e):ya.create(t,e);const s=Xl.get(t);return typeof s=="boolean"?i===(s?"true":"false")?ga.INSTANCE:fa.INSTANCE:new ma(t,i,e)}constructor(t,i,e){this.key=t,this.value=i,this.negated=e,this.type=4}cmp(t){return t.type!==this.type?this.type-t.type:Ia(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type&&this.key===t.key&&this.value===t.value}substituteConstants(){const t=Xl.get(this.key);if(typeof t=="boolean"){const i=t?"true":"false";return this.value===i?ga.INSTANCE:fa.INSTANCE}return this}evaluate(t){return t.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ba.create(this.key,this.value,this)),this.negated}}class wa{static create(t,i){return new wa(t,i)}constructor(t,i){this.key=t,this.valueKey=i,this.type=10,this.negated=null}cmp(t){return t.type!==this.type?this.type-t.type:Ia(this.key,this.valueKey,t.key,t.valueKey)}equals(t){return t.type===this.type&&this.key===t.key&&this.valueKey===t.valueKey}substituteConstants(){return this}evaluate(t){const i=t.getValue(this.valueKey),e=t.getValue(this.key);return Array.isArray(i)?i.includes(e):typeof e=="string"&&typeof i=="object"&&i!==null&&ta.call(i,e)}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}negate(){return this.negated||(this.negated=va.create(this.key,this.valueKey)),this.negated}}class va{static create(t,i){return new va(t,i)}constructor(t,i){this.key=t,this.valueKey=i,this.type=11,this._negated=wa.create(t,i)}cmp(t){return t.type!==this.type?this.type-t.type:this._negated.cmp(t._negated)}equals(t){return t.type===this.type&&this._negated.equals(t._negated)}substituteConstants(){return this}evaluate(t){return!this._negated.evaluate(t)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}negate(){return this._negated}}class ba{static create(t,i,e=null){if(typeof i=="boolean")return i?ya.create(t,e):pa.create(t,e);const s=Xl.get(t);return typeof s=="boolean"?i===(s?"true":"false")?fa.INSTANCE:ga.INSTANCE:new ba(t,i,e)}constructor(t,i,e){this.key=t,this.value=i,this.negated=e,this.type=5}cmp(t){return t.type!==this.type?this.type-t.type:Ia(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type&&this.key===t.key&&this.value===t.value}substituteConstants(){const t=Xl.get(this.key);if(typeof t=="boolean"){const i=t?"true":"false";return this.value===i?fa.INSTANCE:ga.INSTANCE}return this}evaluate(t){return t.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ma.create(this.key,this.value,this)),this.negated}}class ya{static create(t,i=null){const e=Xl.get(t);return typeof e=="boolean"?e?fa.INSTANCE:ga.INSTANCE:new ya(t,i)}constructor(t,i){this.key=t,this.negated=i,this.type=3}cmp(t){return t.type!==this.type?this.type-t.type:Oa(this.key,t.key)}equals(t){return t.type===this.type&&this.key===t.key}substituteConstants(){const t=Xl.get(this.key);return typeof t=="boolean"?t?fa.INSTANCE:ga.INSTANCE:this}evaluate(t){return!t.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=pa.create(this.key,this)),this.negated}}function ka(t,i){if(typeof t=="string"){const i=parseFloat(t);isNaN(i)||(t=i)}return typeof t=="string"||typeof t=="number"?i(t):fa.INSTANCE}class Ca{static create(t,i,e=null){return ka(i,(i=>new Ca(t,i,e)))}constructor(t,i,e){this.key=t,this.value=i,this.negated=e,this.type=12}cmp(t){return t.type!==this.type?this.type-t.type:Ia(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type&&this.key===t.key&&this.value===t.value}substituteConstants(){return this}evaluate(t){return typeof this.value!="string"&&parseFloat(t.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=Da.create(this.key,this.value,this)),this.negated}}class Sa{static create(t,i,e=null){return ka(i,(i=>new Sa(t,i,e)))}constructor(t,i,e){this.key=t,this.value=i,this.negated=e,this.type=13}cmp(t){return t.type!==this.type?this.type-t.type:Ia(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type&&this.key===t.key&&this.value===t.value}substituteConstants(){return this}evaluate(t){return typeof this.value!="string"&&parseFloat(t.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=xa.create(this.key,this.value,this)),this.negated}}class xa{static create(t,i,e=null){return ka(i,(i=>new xa(t,i,e)))}constructor(t,i,e){this.key=t,this.value=i,this.negated=e,this.type=14}cmp(t){return t.type!==this.type?this.type-t.type:Ia(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type&&this.key===t.key&&this.value===t.value}substituteConstants(){return this}evaluate(t){return typeof this.value!="string"&&parseFloat(t.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=Sa.create(this.key,this.value,this)),this.negated}}class Da{static create(t,i,e=null){return ka(i,(i=>new Da(t,i,e)))}constructor(t,i,e){this.key=t,this.value=i,this.negated=e,this.type=15}cmp(t){return t.type!==this.type?this.type-t.type:Ia(this.key,this.value,t.key,t.value)}equals(t){return t.type===this.type&&this.key===t.key&&this.value===t.value}substituteConstants(){return this}evaluate(t){return typeof this.value!="string"&&parseFloat(t.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=Ca.create(this.key,this.value,this)),this.negated}}class Ea{static create(t,i){return new Ea(t,i)}constructor(t,i){this.key=t,this.regexp=i,this.type=7,this.negated=null}cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.key<t.key)return-1;if(this.key>t.key)return 1;const i=this.regexp?this.regexp.source:"",e=t.regexp?t.regexp.source:"";return i<e?-1:i>e?1:0}equals(t){if(t.type===this.type){const i=this.regexp?this.regexp.source:"",e=t.regexp?t.regexp.source:"";return this.key===t.key&&i===e}return!1}substituteConstants(){return this}evaluate(t){const i=t.getValue(this.key);return!!this.regexp&&this.regexp.test(i)}serialize(){const t=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${t}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=Aa.create(this)),this.negated}}class Aa{static create(t){return new Aa(t)}constructor(t){this._actual=t,this.type=8}cmp(t){return t.type!==this.type?this.type-t.type:this._actual.cmp(t._actual)}equals(t){return t.type===this.type&&this._actual.equals(t._actual)}substituteConstants(){return this}evaluate(t){return!this._actual.evaluate(t)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}negate(){return this._actual}}function Ma(t){let i=null;for(let e=0,s=t.length;e<s;e++){const s=t[e].substituteConstants();if(t[e]!==s&&i===null){i=[];for(let s=0;s<e;s++)i[s]=t[s]}i!==null&&(i[e]=s)}return i===null?t:i}class La{static create(t,i,e){return La._normalizeArr(t,i,e)}constructor(t,i){this.expr=t,this.negated=i,this.type=6}cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.expr.length<t.expr.length)return-1;if(this.expr.length>t.expr.length)return 1;for(let i=0,e=this.expr.length;i<e;i++){const e=da(this.expr[i],t.expr[i]);if(e!==0)return e}return 0}equals(t){if(t.type===this.type){if(this.expr.length!==t.expr.length)return!1;for(let i=0,e=this.expr.length;i<e;i++)if(!this.expr[i].equals(t.expr[i]))return!1;return!0}return!1}substituteConstants(){const t=Ma(this.expr);return t===this.expr?this:La.create(t,this.negated,!1)}evaluate(t){for(let i=0,e=this.expr.length;i<e;i++)if(!this.expr[i].evaluate(t))return!1;return!0}static _normalizeArr(t,i,e){const s=[];let n=!1;for(const i of t)if(i)if(i.type!==1){if(i.type===0)return fa.INSTANCE;i.type!==6?s.push(i):s.push(...i.expr)}else n=!0;if(s.length===0&&n)return ga.INSTANCE;if(s.length!==0){if(s.length===1)return s[0];s.sort(da);for(let t=1;t<s.length;t++)s[t-1].equals(s[t])&&(s.splice(t,1),t--);if(s.length===1)return s[0];for(;s.length>1;){const t=s[s.length-1];if(t.type!==9)break;s.pop();const i=s.pop(),n=s.length===0,r=Fa.create(t.expr.map((t=>La.create([t,i],null,e))),null,n);r&&(s.push(r),s.sort(da))}if(s.length===1)return s[0];if(e){for(let t=0;t<s.length;t++)for(let i=t+1;i<s.length;i++)if(s[t].negate().equals(s[i]))return fa.INSTANCE;if(s.length===1)return s[0]}return new La(s,i)}}serialize(){return this.expr.map((t=>t.serialize())).join(" && ")}keys(){const t=[];for(const i of this.expr)t.push(...i.keys());return t}negate(){if(!this.negated){const t=[];for(const i of this.expr)t.push(i.negate());this.negated=Fa.create(t,this,!0)}return this.negated}}class Fa{static create(t,i,e){return Fa._normalizeArr(t,i,e)}constructor(t,i){this.expr=t,this.negated=i,this.type=9}cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.expr.length<t.expr.length)return-1;if(this.expr.length>t.expr.length)return 1;for(let i=0,e=this.expr.length;i<e;i++){const e=da(this.expr[i],t.expr[i]);if(e!==0)return e}return 0}equals(t){if(t.type===this.type){if(this.expr.length!==t.expr.length)return!1;for(let i=0,e=this.expr.length;i<e;i++)if(!this.expr[i].equals(t.expr[i]))return!1;return!0}return!1}substituteConstants(){const t=Ma(this.expr);return t===this.expr?this:Fa.create(t,this.negated,!1)}evaluate(t){for(let i=0,e=this.expr.length;i<e;i++)if(this.expr[i].evaluate(t))return!0;return!1}static _normalizeArr(t,i,e){let s=[],n=!1;if(t){for(let i=0,e=t.length;i<e;i++){const e=t[i];if(e)if(e.type!==0){if(e.type===1)return ga.INSTANCE;e.type!==9?s.push(e):s=s.concat(e.expr)}else n=!0}if(s.length===0&&n)return fa.INSTANCE;s.sort(da)}if(s.length!==0){if(s.length===1)return s[0];for(let t=1;t<s.length;t++)s[t-1].equals(s[t])&&(s.splice(t,1),t--);if(s.length===1)return s[0];if(e){for(let t=0;t<s.length;t++)for(let i=t+1;i<s.length;i++)if(s[t].negate().equals(s[i]))return ga.INSTANCE;if(s.length===1)return s[0]}return new Fa(s,i)}}serialize(){return this.expr.map((t=>t.serialize())).join(" || ")}keys(){const t=[];for(const i of this.expr)t.push(...i.keys());return t}negate(){if(!this.negated){const t=[];for(const i of this.expr)t.push(i.negate());for(;t.length>1;){const i=t.shift(),e=t.shift(),s=[];for(const t of Na(i))for(const i of Na(e))s.push(La.create([t,i],null,!1));t.unshift(Fa.create(s,null,!1))}this.negated=Fa.create(t,this,!0)}return this.negated}}class Ta extends pa{static all(){return Ta._info.values()}constructor(t,i,e){super(t,null),this._defaultValue=i,typeof e=="object"?Ta._info.push({...e,key:t}):e!==!0&&Ta._info.push({key:t,description:e,type:i!=null?typeof i:void 0})}bindTo(t){return t.createKey(this.key,this._defaultValue)}getValue(t){return t.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(t){return ma.create(this.key,t)}}Ta._info=[];const Ra=_l("contextKeyService");function Oa(t,i){return t<i?-1:t>i?1:0}function Ia(t,i,e,s){return t<e?-1:t>e?1:i<s?-1:i>s?1:0}function _a(t,i){if(t.type===0||i.type===1)return!0;if(t.type===9)return i.type===9&&Pa(t.expr,i.expr);if(i.type===9){for(const e of i.expr)if(_a(t,e))return!0;return!1}if(t.type===6){if(i.type===6)return Pa(i.expr,t.expr);for(const e of t.expr)if(_a(e,i))return!0;return!1}return t.equals(i)}function Pa(t,i){let e=0,s=0;for(;e<t.length&&s<i.length;){const n=t[e].cmp(i[s]);if(n<0)return!1;n===0&&e++,s++}return e===t.length}function Na(t){return t.type===9?t.expr:[t]}function Ba(t,i){if(!t)throw new Error(i?`Assertion failed (${i})`:"Assertion Failed")}function $a(t,i="Unreachable"){throw new Error(i)}function Wa(t){t||Ii(new zi("Soft Assertion Failed"))}function ja(t){t()||(t(),Ii(new zi("Assertion Failed")))}function Ha(t,i){let e=0;for(;e<t.length-1;){if(!i(t[e],t[e+1]))return!1;e++}return!0}const Va=new class{constructor(){this.data=new Map}add(t,i){Ba(R(t)),Ba(O(i)),Ba(!this.data.has(t),"There is already an extension with this id"),this.data.set(t,i)}as(t){return this.data.get(t)||null}};class za{constructor(){this._coreKeybindings=new Ht,this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(t){if(Ft===1){if(t&&t.win)return t.win}else if(Ft===2){if(t&&t.mac)return t.mac}else if(t&&t.linux)return t.linux;return t}registerKeybindingRule(t){const i=za.bindToCurrentPlatform(t),e=new Ji;if(i&&i.primary){const s=Zr(i.primary,Ft);s&&e.add(this._registerDefaultKeybinding(s,t.id,t.args,t.weight,0,t.when))}if(i&&Array.isArray(i.secondary))for(let s=0,n=i.secondary.length;s<n;s++){const n=Zr(i.secondary[s],Ft);n&&e.add(this._registerDefaultKeybinding(n,t.id,t.args,t.weight,-s-1,t.when))}return e}registerCommandAndKeybindingRule(t){return Gi(this.registerKeybindingRule(t),Gl.registerCommand(t))}_registerDefaultKeybinding(t,i,e,s,n,r){const o=this._coreKeybindings.push({keybinding:t,command:i,commandArgs:e,when:r,weight1:s,weight2:n,extensionId:null,isBuiltinExtension:!1});return this._cachedMergedKeybindings=null,Zi((()=>{o(),this._cachedMergedKeybindings=null}))}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(Ka)),this._cachedMergedKeybindings.slice(0)}}const Ua=new za;function Ka(t,i){if(t.weight1!==i.weight1)return t.weight1-i.weight1;if(t.command&&i.command){if(t.command<i.command)return-1;if(t.command>i.command)return 1}return t.weight2-i.weight2}Va.add("platform.keybindingsRegistry",Ua);var qa,Ga=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Za=function(t,i){return function(e,s){i(e,s,t)}};function Ja(t){return t.command!==void 0}class Qa{constructor(t){if(Qa._instances.has(t))throw new TypeError(`MenuId with identifier '${t}' already exists. Use MenuId.for(ident) or a unique identifier`);Qa._instances.set(t,this),this.id=t}}Qa._instances=new Map,Qa.CommandPalette=new Qa("CommandPalette"),Qa.DebugBreakpointsContext=new Qa("DebugBreakpointsContext"),Qa.DebugCallStackContext=new Qa("DebugCallStackContext"),Qa.DebugConsoleContext=new Qa("DebugConsoleContext"),Qa.DebugVariablesContext=new Qa("DebugVariablesContext"),Qa.NotebookVariablesContext=new Qa("NotebookVariablesContext"),Qa.DebugHoverContext=new Qa("DebugHoverContext"),Qa.DebugWatchContext=new Qa("DebugWatchContext"),Qa.DebugToolBar=new Qa("DebugToolBar"),Qa.DebugToolBarStop=new Qa("DebugToolBarStop"),Qa.EditorContext=new Qa("EditorContext"),Qa.SimpleEditorContext=new Qa("SimpleEditorContext"),Qa.EditorContent=new Qa("EditorContent"),Qa.EditorLineNumberContext=new Qa("EditorLineNumberContext"),Qa.EditorContextCopy=new Qa("EditorContextCopy"),Qa.EditorContextPeek=new Qa("EditorContextPeek"),Qa.EditorContextShare=new Qa("EditorContextShare"),Qa.EditorTitle=new Qa("EditorTitle"),Qa.EditorTitleRun=new Qa("EditorTitleRun"),Qa.EditorTitleContext=new Qa("EditorTitleContext"),Qa.EditorTitleContextShare=new Qa("EditorTitleContextShare"),Qa.EmptyEditorGroup=new Qa("EmptyEditorGroup"),Qa.EmptyEditorGroupContext=new Qa("EmptyEditorGroupContext"),Qa.EditorTabsBarContext=new Qa("EditorTabsBarContext"),Qa.EditorTabsBarShowTabsSubmenu=new Qa("EditorTabsBarShowTabsSubmenu"),Qa.EditorTabsBarShowTabsZenModeSubmenu=new Qa("EditorTabsBarShowTabsZenModeSubmenu"),Qa.EditorActionsPositionSubmenu=new Qa("EditorActionsPositionSubmenu"),Qa.ExplorerContext=new Qa("ExplorerContext"),Qa.ExplorerContextShare=new Qa("ExplorerContextShare"),Qa.ExtensionContext=new Qa("ExtensionContext"),Qa.GlobalActivity=new Qa("GlobalActivity"),Qa.CommandCenter=new Qa("CommandCenter"),Qa.CommandCenterCenter=new Qa("CommandCenterCenter"),Qa.LayoutControlMenuSubmenu=new Qa("LayoutControlMenuSubmenu"),Qa.LayoutControlMenu=new Qa("LayoutControlMenu"),Qa.MenubarMainMenu=new Qa("MenubarMainMenu"),Qa.MenubarAppearanceMenu=new Qa("MenubarAppearanceMenu"),Qa.MenubarDebugMenu=new Qa("MenubarDebugMenu"),Qa.MenubarEditMenu=new Qa("MenubarEditMenu"),Qa.MenubarCopy=new Qa("MenubarCopy"),Qa.MenubarFileMenu=new Qa("MenubarFileMenu"),Qa.MenubarGoMenu=new Qa("MenubarGoMenu"),Qa.MenubarHelpMenu=new Qa("MenubarHelpMenu"),Qa.MenubarLayoutMenu=new Qa("MenubarLayoutMenu"),Qa.MenubarNewBreakpointMenu=new Qa("MenubarNewBreakpointMenu"),Qa.PanelAlignmentMenu=new Qa("PanelAlignmentMenu"),Qa.PanelPositionMenu=new Qa("PanelPositionMenu"),Qa.ActivityBarPositionMenu=new Qa("ActivityBarPositionMenu"),Qa.MenubarPreferencesMenu=new Qa("MenubarPreferencesMenu"),Qa.MenubarRecentMenu=new Qa("MenubarRecentMenu"),Qa.MenubarSelectionMenu=new Qa("MenubarSelectionMenu"),Qa.MenubarShare=new Qa("MenubarShare"),Qa.MenubarSwitchEditorMenu=new Qa("MenubarSwitchEditorMenu"),Qa.MenubarSwitchGroupMenu=new Qa("MenubarSwitchGroupMenu"),Qa.MenubarTerminalMenu=new Qa("MenubarTerminalMenu"),Qa.MenubarViewMenu=new Qa("MenubarViewMenu"),Qa.MenubarHomeMenu=new Qa("MenubarHomeMenu"),Qa.OpenEditorsContext=new Qa("OpenEditorsContext"),Qa.OpenEditorsContextShare=new Qa("OpenEditorsContextShare"),Qa.ProblemsPanelContext=new Qa("ProblemsPanelContext"),Qa.SCMInputBox=new Qa("SCMInputBox"),Qa.SCMChangesSeparator=new Qa("SCMChangesSeparator"),Qa.SCMIncomingChanges=new Qa("SCMIncomingChanges"),Qa.SCMIncomingChangesContext=new Qa("SCMIncomingChangesContext"),Qa.SCMIncomingChangesSetting=new Qa("SCMIncomingChangesSetting"),Qa.SCMOutgoingChanges=new Qa("SCMOutgoingChanges"),Qa.SCMOutgoingChangesContext=new Qa("SCMOutgoingChangesContext"),Qa.SCMOutgoingChangesSetting=new Qa("SCMOutgoingChangesSetting"),Qa.SCMIncomingChangesAllChangesContext=new Qa("SCMIncomingChangesAllChangesContext"),Qa.SCMIncomingChangesHistoryItemContext=new Qa("SCMIncomingChangesHistoryItemContext"),Qa.SCMOutgoingChangesAllChangesContext=new Qa("SCMOutgoingChangesAllChangesContext"),Qa.SCMOutgoingChangesHistoryItemContext=new Qa("SCMOutgoingChangesHistoryItemContext"),Qa.SCMChangeContext=new Qa("SCMChangeContext"),Qa.SCMResourceContext=new Qa("SCMResourceContext"),Qa.SCMResourceContextShare=new Qa("SCMResourceContextShare"),Qa.SCMResourceFolderContext=new Qa("SCMResourceFolderContext"),Qa.SCMResourceGroupContext=new Qa("SCMResourceGroupContext"),Qa.SCMSourceControl=new Qa("SCMSourceControl"),Qa.SCMSourceControlInline=new Qa("SCMSourceControlInline"),Qa.SCMSourceControlTitle=new Qa("SCMSourceControlTitle"),Qa.SCMTitle=new Qa("SCMTitle"),Qa.SearchContext=new Qa("SearchContext"),Qa.SearchActionMenu=new Qa("SearchActionContext"),Qa.StatusBarWindowIndicatorMenu=new Qa("StatusBarWindowIndicatorMenu"),Qa.StatusBarRemoteIndicatorMenu=new Qa("StatusBarRemoteIndicatorMenu"),Qa.StickyScrollContext=new Qa("StickyScrollContext"),Qa.TestItem=new Qa("TestItem"),Qa.TestItemGutter=new Qa("TestItemGutter"),Qa.TestMessageContext=new Qa("TestMessageContext"),Qa.TestMessageContent=new Qa("TestMessageContent"),Qa.TestPeekElement=new Qa("TestPeekElement"),Qa.TestPeekTitle=new Qa("TestPeekTitle"),Qa.TouchBarContext=new Qa("TouchBarContext"),Qa.TitleBarContext=new Qa("TitleBarContext"),Qa.TitleBarTitleContext=new Qa("TitleBarTitleContext"),Qa.TunnelContext=new Qa("TunnelContext"),Qa.TunnelPrivacy=new Qa("TunnelPrivacy"),Qa.TunnelProtocol=new Qa("TunnelProtocol"),Qa.TunnelPortInline=new Qa("TunnelInline"),Qa.TunnelTitle=new Qa("TunnelTitle"),Qa.TunnelLocalAddressInline=new Qa("TunnelLocalAddressInline"),Qa.TunnelOriginInline=new Qa("TunnelOriginInline"),Qa.ViewItemContext=new Qa("ViewItemContext"),Qa.ViewContainerTitle=new Qa("ViewContainerTitle"),Qa.ViewContainerTitleContext=new Qa("ViewContainerTitleContext"),Qa.ViewTitle=new Qa("ViewTitle"),Qa.ViewTitleContext=new Qa("ViewTitleContext"),Qa.CommentEditorActions=new Qa("CommentEditorActions"),Qa.CommentThreadTitle=new Qa("CommentThreadTitle"),Qa.CommentThreadActions=new Qa("CommentThreadActions"),Qa.CommentThreadAdditionalActions=new Qa("CommentThreadAdditionalActions"),Qa.CommentThreadTitleContext=new Qa("CommentThreadTitleContext"),Qa.CommentThreadCommentContext=new Qa("CommentThreadCommentContext"),Qa.CommentTitle=new Qa("CommentTitle"),Qa.CommentActions=new Qa("CommentActions"),Qa.CommentsViewThreadActions=new Qa("CommentsViewThreadActions"),Qa.InteractiveToolbar=new Qa("InteractiveToolbar"),Qa.InteractiveCellTitle=new Qa("InteractiveCellTitle"),Qa.InteractiveCellDelete=new Qa("InteractiveCellDelete"),Qa.InteractiveCellExecute=new Qa("InteractiveCellExecute"),Qa.InteractiveInputExecute=new Qa("InteractiveInputExecute"),Qa.IssueReporter=new Qa("IssueReporter"),Qa.NotebookToolbar=new Qa("NotebookToolbar"),Qa.NotebookStickyScrollContext=new Qa("NotebookStickyScrollContext"),Qa.NotebookCellTitle=new Qa("NotebookCellTitle"),Qa.NotebookCellDelete=new Qa("NotebookCellDelete"),Qa.NotebookCellInsert=new Qa("NotebookCellInsert"),Qa.NotebookCellBetween=new Qa("NotebookCellBetween"),Qa.NotebookCellListTop=new Qa("NotebookCellTop"),Qa.NotebookCellExecute=new Qa("NotebookCellExecute"),Qa.NotebookCellExecuteGoTo=new Qa("NotebookCellExecuteGoTo"),Qa.NotebookCellExecutePrimary=new Qa("NotebookCellExecutePrimary"),Qa.NotebookDiffCellInputTitle=new Qa("NotebookDiffCellInputTitle"),Qa.NotebookDiffCellMetadataTitle=new Qa("NotebookDiffCellMetadataTitle"),Qa.NotebookDiffCellOutputsTitle=new Qa("NotebookDiffCellOutputsTitle"),Qa.NotebookOutputToolbar=new Qa("NotebookOutputToolbar"),Qa.NotebookOutlineFilter=new Qa("NotebookOutlineFilter"),Qa.NotebookOutlineActionMenu=new Qa("NotebookOutlineActionMenu"),Qa.NotebookEditorLayoutConfigure=new Qa("NotebookEditorLayoutConfigure"),Qa.NotebookKernelSource=new Qa("NotebookKernelSource"),Qa.BulkEditTitle=new Qa("BulkEditTitle"),Qa.BulkEditContext=new Qa("BulkEditContext"),Qa.TimelineItemContext=new Qa("TimelineItemContext"),Qa.TimelineTitle=new Qa("TimelineTitle"),Qa.TimelineTitleContext=new Qa("TimelineTitleContext"),Qa.TimelineFilterSubMenu=new Qa("TimelineFilterSubMenu"),Qa.AccountsContext=new Qa("AccountsContext"),Qa.SidebarTitle=new Qa("SidebarTitle"),Qa.PanelTitle=new Qa("PanelTitle"),Qa.AuxiliaryBarTitle=new Qa("AuxiliaryBarTitle"),Qa.AuxiliaryBarHeader=new Qa("AuxiliaryBarHeader"),Qa.TerminalInstanceContext=new Qa("TerminalInstanceContext"),Qa.TerminalEditorInstanceContext=new Qa("TerminalEditorInstanceContext"),Qa.TerminalNewDropdownContext=new Qa("TerminalNewDropdownContext"),Qa.TerminalTabContext=new Qa("TerminalTabContext"),Qa.TerminalTabEmptyAreaContext=new Qa("TerminalTabEmptyAreaContext"),Qa.TerminalStickyScrollContext=new Qa("TerminalStickyScrollContext"),Qa.WebviewContext=new Qa("WebviewContext"),Qa.InlineCompletionsActions=new Qa("InlineCompletionsActions"),Qa.InlineEditActions=new Qa("InlineEditActions"),Qa.NewFile=new Qa("NewFile"),Qa.MergeInput1Toolbar=new Qa("MergeToolbar1Toolbar"),Qa.MergeInput2Toolbar=new Qa("MergeToolbar2Toolbar"),Qa.MergeBaseToolbar=new Qa("MergeBaseToolbar"),Qa.MergeInputResultToolbar=new Qa("MergeToolbarResultToolbar"),Qa.InlineSuggestionToolbar=new Qa("InlineSuggestionToolbar"),Qa.InlineEditToolbar=new Qa("InlineEditToolbar"),Qa.ChatContext=new Qa("ChatContext"),Qa.ChatCodeBlock=new Qa("ChatCodeblock"),Qa.ChatMessageTitle=new Qa("ChatMessageTitle"),Qa.ChatExecute=new Qa("ChatExecute"),Qa.ChatExecuteSecondary=new Qa("ChatExecuteSecondary"),Qa.ChatInputSide=new Qa("ChatInputSide"),Qa.AccessibleView=new Qa("AccessibleView"),Qa.MultiDiffEditorFileToolbar=new Qa("MultiDiffEditorFileToolbar"),Qa.DiffEditorHunkToolbar=new Qa("DiffEditorHunkToolbar"),Qa.DiffEditorSelectionToolbar=new Qa("DiffEditorSelectionToolbar");const Ya=_l("menuService");class Xa{static for(t){let i=this._all.get(t);return i||(i=new Xa(t),this._all.set(t,i)),i}static merge(t){const i=new Set;for(const e of t)e instanceof Xa&&i.add(e.id);return i}constructor(t){this.id=t,this.has=i=>i===t}}Xa._all=new Map;const tu=new class{constructor(){this._commands=new Map,this._menuItems=new Map,this._onDidChangeMenu=new fe({merge:Xa.merge}),this.onDidChangeMenu=this._onDidChangeMenu.event}addCommand(t){return this._commands.set(t.id,t),this._onDidChangeMenu.fire(Xa.for(Qa.CommandPalette)),Zi((()=>{this._commands.delete(t.id)&&this._onDidChangeMenu.fire(Xa.for(Qa.CommandPalette))}))}getCommand(t){return this._commands.get(t)}getCommands(){const t=new Map;return this._commands.forEach(((i,e)=>t.set(e,i))),t}appendMenuItem(t,i){let e=this._menuItems.get(t);e||(e=new Ht,this._menuItems.set(t,e));const s=e.push(i);return this._onDidChangeMenu.fire(Xa.for(t)),Zi((()=>{s(),this._onDidChangeMenu.fire(Xa.for(t))}))}appendMenuItems(t){const i=new Ji;for(const{id:e,item:s}of t)i.add(this.appendMenuItem(e,s));return i}getMenuItems(t){let i;return i=this._menuItems.has(t)?[...this._menuItems.get(t)]:[],t===Qa.CommandPalette&&this._appendImplicitItems(i),i}_appendImplicitItems(t){const i=new Set;for(const e of t)Ja(e)&&(i.add(e.command.id),e.alt&&i.add(e.alt.id));this._commands.forEach(((e,s)=>{i.has(s)||t.push({command:e})}))}};class iu extends Hl{constructor(t,i,e){super(`submenuitem.${t.submenu.id}`,typeof t.title=="string"?t.title:t.title.value,e,"submenu"),this.item=t,this.hideActions=i}}let eu=qa=class{static label(t,i){return i!=null&&i.renderShortTitle&&t.shortTitle?typeof t.shortTitle=="string"?t.shortTitle:t.shortTitle.value:typeof t.title=="string"?t.title:t.title.value}constructor(t,i,e,s,n,r){var o,h;let c;if(this.hideActions=s,this._commandService=r,this.id=t.id,this.label=qa.label(t,e),this.tooltip=(h=typeof t.tooltip=="string"?t.tooltip:(o=t.tooltip)===null||o===void 0?void 0:o.value)!==null&&h!==void 0?h:"",this.enabled=!t.precondition||n.contextMatchesRules(t.precondition),this.checked=void 0,t.toggled){const i=t.toggled.condition?t.toggled:{condition:t.toggled};this.checked=n.contextMatchesRules(i.condition),this.checked&&i.tooltip&&(this.tooltip=typeof i.tooltip=="string"?i.tooltip:i.tooltip.value),this.checked&&Kl.isThemeIcon(i.icon)&&(c=i.icon),this.checked&&i.title&&(this.label=typeof i.title=="string"?i.title:i.title.value)}c||(c=Kl.isThemeIcon(t.icon)?t.icon:void 0),this.item=t,this.alt=i?new qa(i,void 0,e,s,n,r):void 0,this._options=e,this.class=c&&Kl.asClassName(c)}run(...t){var i,e;let s=[];return!((i=this._options)===null||i===void 0)&&i.arg&&(s=[...s,this._options.arg]),!((e=this._options)===null||e===void 0)&&e.shouldForwardArgs&&(s=[...s,...t]),this._commandService.executeCommand(this.id,...s)}};eu=qa=Ga([Za(4,Ra),Za(5,ql)],eu);class su{constructor(t){this.desc=t}}function nu(t){const i=new Ji,e=new t,{f1:s,menu:n,keybinding:r,...o}=e.desc;if(Gl.getCommand(o.id))throw new Error(`Cannot register two commands with the same id: ${o.id}`);if(i.add(Gl.registerCommand({id:o.id,handler:(t,...i)=>e.run(t,...i),metadata:o.metadata})),Array.isArray(n))for(const t of n)i.add(tu.appendMenuItem(t.id,{command:{...o,precondition:t.precondition===null?void 0:o.precondition},...t}));else n&&i.add(tu.appendMenuItem(n.id,{command:{...o,precondition:n.precondition===null?void 0:o.precondition},...n}));if(s&&(i.add(tu.appendMenuItem(Qa.CommandPalette,{command:o,when:o.precondition})),i.add(tu.addCommand(o))),Array.isArray(r))for(const t of r)i.add(Ua.registerKeybindingRule({...t,id:o.id,when:o.precondition?ua.and(o.precondition,t.when):t.when}));else r&&i.add(Ua.registerKeybindingRule({...r,id:o.id,when:o.precondition?ua.and(o.precondition,r.when):r.when}));return i}const ru=_l("telemetryService"),ou=_l("logService");var hu;(function(t){t[t.Off=0]="Off",t[t.Trace=1]="Trace",t[t.Debug=2]="Debug",t[t.Info=3]="Info",t[t.Warning=4]="Warning",t[t.Error=5]="Error"})(hu||(hu={}));const cu=hu.Info;class lu extends Qi{constructor(){super(...arguments),this.level=cu,this._onDidChangeLogLevel=this._register(new le),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event}setLevel(t){this.level!==t&&(this.level=t,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}checkLogLevel(t){return this.level!==hu.Off&&this.level<=t}}class au extends lu{constructor(t=cu,i=!0){super(),this.useColors=i,this.setLevel(t)}trace(t,...i){this.checkLogLevel(hu.Trace)&&(this.useColors?console.log("%cTRACE","color: #888",t,...i):console.log(t,...i))}debug(t,...i){this.checkLogLevel(hu.Debug)&&(this.useColors?console.log("%cDEBUG","background: #eee; color: #888",t,...i):console.log(t,...i))}info(t,...i){this.checkLogLevel(hu.Info)&&(this.useColors?console.log("%c INFO","color: #33f",t,...i):console.log(t,...i))}warn(t,...i){this.checkLogLevel(hu.Warning)&&(this.useColors?console.log("%c WARN","color: #993",t,...i):console.log(t,...i))}error(t,...i){this.checkLogLevel(hu.Error)&&(this.useColors?console.log("%c  ERR","color: #f33",t,...i):console.error(t,...i))}}class uu extends lu{constructor(t){super(),this.loggers=t,t.length&&this.setLevel(t[0].getLevel())}setLevel(t){for(const i of this.loggers)i.setLevel(t);super.setLevel(t)}trace(t,...i){for(const e of this.loggers)e.trace(t,...i)}debug(t,...i){for(const e of this.loggers)e.debug(t,...i)}info(t,...i){for(const e of this.loggers)e.info(t,...i)}warn(t,...i){for(const e of this.loggers)e.warn(t,...i)}error(t,...i){for(const e of this.loggers)e.error(t,...i)}dispose(){for(const t of this.loggers)t.dispose();super.dispose()}}new Ta("logLevel",function(t){switch(t){case hu.Trace:return"trace";case hu.Debug:return"debug";case hu.Info:return"info";case hu.Warning:return"warn";case hu.Error:return"error";case hu.Off:return"off"}}(hu.Info));class du{constructor(t){this.id=t.id,this.precondition=t.precondition,this._kbOpts=t.kbOpts,this._menuOpts=t.menuOpts,this.metadata=t.metadata}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){const t=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(const i of t){let t=i.kbExpr;this.precondition&&(t=t?ua.and(t,this.precondition):this.precondition);const e={id:this.id,weight:i.weight,args:i.args,when:t,primary:i.primary,secondary:i.secondary,win:i.win,linux:i.linux,mac:i.mac};Ua.registerKeybindingRule(e)}}Gl.registerCommand({id:this.id,handler:(t,i)=>this.runCommand(t,i),metadata:this.metadata})}_registerMenuItem(t){tu.appendMenuItem(t.menuId,{group:t.group,command:{id:this.id,title:t.title,icon:t.icon,precondition:this.precondition},when:t.when,order:t.order})}}class fu extends du{constructor(){super(...arguments),this._implementations=[]}addImplementation(t,i,e,s){return this._implementations.push({priority:t,name:i,implementation:e,when:s}),this._implementations.sort(((t,i)=>i.priority-t.priority)),{dispose:()=>{for(let t=0;t<this._implementations.length;t++)if(this._implementations[t].implementation===e)return void this._implementations.splice(t,1)}}}runCommand(t,i){const e=t.get(ou),s=t.get(Ra);e.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(const n of this._implementations){if(n.when){const t=s.getContext(Lc());if(!n.when.evaluate(t))continue}const r=n.implementation(t,i);if(r)return e.trace(`Command '${this.id}' was handled by '${n.name}'.`),typeof r=="boolean"?void 0:r}e.trace(`The Command '${this.id}' was not handled by any implementation.`)}}class gu extends du{constructor(t,i){super(i),this.command=t}runCommand(t,i){return this.command.runCommand(t,i)}}class pu extends du{static bindToContribution(t){return class extends pu{constructor(t){super(t),this._callback=t.handler}runEditorCommand(i,e,s){const n=t(e);n&&this._callback(n,s)}}}static runEditorCommand(t,i,e,s){const n=t.get(Pl),r=n.getFocusedCodeEditor()||n.getActiveCodeEditor();if(r)return r.invokeWithinContext((t=>{if(t.get(Ra).contextMatchesRules(e??void 0))return s(t,r,i)}))}runCommand(t,i){return pu.runEditorCommand(t,i,this.precondition,((t,i,e)=>this.runEditorCommand(t,i,e)))}}class mu extends pu{static convertOptions(t){let i;function e(i){return i.menuId||(i.menuId=Qa.EditorContext),i.title||(i.title=t.label),i.when=ua.and(t.precondition,i.when),i}return i=Array.isArray(t.menuOpts)?t.menuOpts:t.menuOpts?[t.menuOpts]:[],Array.isArray(t.contextMenuOpts)?i.push(...t.contextMenuOpts.map(e)):t.contextMenuOpts&&i.push(e(t.contextMenuOpts)),t.menuOpts=i,t}constructor(t){super(mu.convertOptions(t)),this.label=t.label,this.alias=t.alias}runEditorCommand(t,i,e){return this.reportTelemetry(t,i),this.run(t,i,e||{})}reportTelemetry(t,i){t.get(ru).publicLog2("editorActionInvoked",{name:this.label,id:this.id})}}class wu extends mu{constructor(){super(...arguments),this._implementations=[]}addImplementation(t,i){return this._implementations.push([t,i]),this._implementations.sort(((t,i)=>i[0]-t[0])),{dispose:()=>{for(let t=0;t<this._implementations.length;t++)if(this._implementations[t][1]===i)return void this._implementations.splice(t,1)}}}run(t,i,e){for(const s of this._implementations){const n=s[1](t,i,e);if(n)return typeof n=="boolean"?void 0:n}}}class vu extends su{run(t,...i){const e=t.get(Pl),s=e.getFocusedCodeEditor()||e.getActiveCodeEditor();if(s)return s.invokeWithinContext((t=>{var e,n;const r=t.get(Ra),o=t.get(ou);if(r.contextMatchesRules((e=this.desc.precondition)!==null&&e!==void 0?e:void 0))return this.runEditorCommand(t,s,...i);o.debug("[EditorAction2] NOT running command because its precondition is FALSE",this.desc.id,(n=this.desc.precondition)===null||n===void 0?void 0:n.serialize())}))}}function bu(t,i){Gl.registerCommand(t,(function(t,...e){const s=t.get(Il),[n,r]=e;j(as.isUri(n)),j(ks.isIPosition(r));const o=t.get(Nl).getModel(n);if(o){const t=ks.lift(r);return s.invokeFunction(i,o,t,...e.slice(2))}return t.get(Bl).createModelReference(n).then((t=>new Promise(((n,o)=>{try{n(s.invokeFunction(i,t.object.textEditorModel,ks.lift(r),e.slice(2)))}catch(t){o(t)}})).finally((()=>{t.dispose()}))))}))}function yu(t){return Du.INSTANCE.registerEditorCommand(t),t}function ku(t){const i=new t;return Du.INSTANCE.registerEditorAction(i),i}function Cu(t){return Du.INSTANCE.registerEditorAction(t),t}function Su(t,i,e){Du.INSTANCE.registerEditorContribution(t,i,e)}var xu;(function(t){t.getEditorCommand=function(t){return Du.INSTANCE.getEditorCommand(t)},t.getEditorActions=function(){return Du.INSTANCE.getEditorActions()},t.getEditorContributions=function(){return Du.INSTANCE.getEditorContributions()},t.getSomeEditorContributions=function(t){return Du.INSTANCE.getEditorContributions().filter((i=>t.indexOf(i.id)>=0))},t.getDiffEditorContributions=function(){return Du.INSTANCE.getDiffEditorContributions()}})(xu||(xu={}));class Du{constructor(){this.editorContributions=[],this.diffEditorContributions=[],this.editorActions=[],this.editorCommands=Object.create(null)}registerEditorContribution(t,i,e){this.editorContributions.push({id:t,ctor:i,instantiation:e})}getEditorContributions(){return this.editorContributions.slice(0)}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(t){t.register(),this.editorActions.push(t)}getEditorActions(){return this.editorActions}registerEditorCommand(t){t.register(),this.editorCommands[t.id]=t}getEditorCommand(t){return this.editorCommands[t]||null}}function Eu(t){return t.register(),t}Du.INSTANCE=new Du,Va.add("editor.contributions",Du.INSTANCE);const Au=Eu(new fu({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:Qa.MenubarEditMenu,group:"1_do",title:tt(0,"&&Undo"),order:1},{menuId:Qa.CommandPalette,group:"",title:tt(0,"Undo"),order:1}]}));Eu(new gu(Au,{id:"default:undo",precondition:void 0}));const Mu=Eu(new fu({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:Qa.MenubarEditMenu,group:"1_do",title:tt(0,"&&Redo"),order:2},{menuId:Qa.CommandPalette,group:"",title:tt(0,"Redo"),order:1}]}));Eu(new gu(Mu,{id:"default:redo",precondition:void 0}));const Lu=Eu(new fu({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:Qa.MenubarSelectionMenu,group:"1_basic",title:tt(0,"&&Select All"),order:1},{menuId:Qa.CommandPalette,group:"",title:tt(0,"Select All"),order:1}]}));let Fu=!1;function Tu(t){Ct&&(Fu||(Fu=!0,console.warn("Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes. Please see https://github.com/microsoft/monaco-editor#faq")),console.warn(t.message))}class Ru{constructor(t,i,e,s){this.vsWorker=t,this.req=i,this.method=e,this.args=s,this.type=0}}class Ou{constructor(t,i,e,s){this.vsWorker=t,this.seq=i,this.res=e,this.err=s,this.type=1}}class Iu{constructor(t,i,e,s){this.vsWorker=t,this.req=i,this.eventName=e,this.arg=s,this.type=2}}class _u{constructor(t,i,e){this.vsWorker=t,this.req=i,this.event=e,this.type=3}}class Pu{constructor(t,i){this.vsWorker=t,this.req=i,this.type=4}}class Nu{constructor(t){this._workerId=-1,this._handler=t,this._lastSentReq=0,this._pendingReplies=Object.create(null),this._pendingEmitters=new Map,this._pendingEvents=new Map}setWorkerId(t){this._workerId=t}sendMessage(t,i){const e=String(++this._lastSentReq);return new Promise(((s,n)=>{this._pendingReplies[e]={resolve:s,reject:n},this._send(new Ru(this._workerId,e,t,i))}))}listen(t,i){let e=null;const s=new le({onWillAddFirstListener:()=>{e=String(++this._lastSentReq),this._pendingEmitters.set(e,s),this._send(new Iu(this._workerId,e,t,i))},onDidRemoveLastListener:()=>{this._pendingEmitters.delete(e),this._send(new Pu(this._workerId,e)),e=null}});return s.event}handleMessage(t){t&&t.vsWorker&&(this._workerId!==-1&&t.vsWorker!==this._workerId||this._handleMessage(t))}_handleMessage(t){switch(t.type){case 1:return this._handleReplyMessage(t);case 0:return this._handleRequestMessage(t);case 2:return this._handleSubscribeEventMessage(t);case 3:return this._handleEventMessage(t);case 4:return this._handleUnsubscribeEventMessage(t)}}_handleReplyMessage(t){if(!this._pendingReplies[t.seq])return void console.warn("Got reply to unknown seq");const i=this._pendingReplies[t.seq];if(delete this._pendingReplies[t.seq],t.err){let e=t.err;return t.err.$isError&&(e=new Error,e.name=t.err.name,e.message=t.err.message,e.stack=t.err.stack),void i.reject(e)}i.resolve(t.res)}_handleRequestMessage(t){const i=t.req;this._handler.handleMessage(t.method,t.args).then((t=>{this._send(new Ou(this._workerId,i,t,void 0))}),(t=>{t.detail instanceof Error&&(t.detail=Pi(t.detail)),this._send(new Ou(this._workerId,i,void 0,Pi(t)))}))}_handleSubscribeEventMessage(t){const i=t.req,e=this._handler.handleEvent(t.eventName,t.arg)((t=>{this._send(new _u(this._workerId,i,t))}));this._pendingEvents.set(i,e)}_handleEventMessage(t){this._pendingEmitters.has(t.req)?this._pendingEmitters.get(t.req).fire(t.event):console.warn("Got event for unknown req")}_handleUnsubscribeEventMessage(t){this._pendingEvents.has(t.req)?(this._pendingEvents.get(t.req).dispose(),this._pendingEvents.delete(t.req)):console.warn("Got unsubscribe for unknown req")}_send(t){const i=[];if(t.type===0)for(let e=0;e<t.args.length;e++)t.args[e]instanceof ArrayBuffer&&i.push(t.args[e]);else t.type===1&&t.res instanceof ArrayBuffer&&i.push(t.res);this._handler.sendMessage(t,i)}}class Bu extends Qi{constructor(t,i,e){super();let s=null;this._worker=this._register(t.create("vs/base/common/worker/simpleWorker",(t=>{this._protocol.handleMessage(t)}),(t=>{s==null||s(t)}))),this._protocol=new Nu({sendMessage:(t,i)=>{this._worker.postMessage(t,i)},handleMessage:(t,i)=>{if(typeof e[t]!="function")return Promise.reject(new Error("Missing method "+t+" on main thread host."));try{return Promise.resolve(e[t].apply(e,i))}catch(t){return Promise.reject(t)}},handleEvent:(t,i)=>{if(Wu(t)){const s=e[t].call(e,i);if(typeof s!="function")throw new Error(`Missing dynamic event ${t} on main thread host.`);return s}if($u(t)){const i=e[t];if(typeof i!="function")throw new Error(`Missing event ${t} on main thread host.`);return i}throw new Error(`Malformed event name ${t}`)}}),this._protocol.setWorkerId(this._worker.getId());let n=null;const r=globalThis.require;r!==void 0&&typeof r.getConfig=="function"?n=r.getConfig():globalThis.requirejs!==void 0&&(n=globalThis.requirejs.s.contexts._.config);const o=Q(e);this._onModuleLoaded=this._protocol.sendMessage("$initialize",[this._worker.getId(),JSON.parse(JSON.stringify(n)),i,o]);const h=(t,i)=>this._request(t,i),c=(t,i)=>this._protocol.listen(t,i);this._lazyProxy=new Promise(((t,e)=>{s=e,this._onModuleLoaded.then((i=>{t(function(t,i,e){const s=t=>function(){const e=Array.prototype.slice.call(arguments,0);return i(t,e)},n=t=>function(i){return e(t,i)},r={};for(const i of t)Wu(i)?r[i]=n(i):$u(i)?r[i]=e(i,void 0):r[i]=s(i);return r}(i,h,c))}),(t=>{e(t),this._onError("Worker failed to load "+i,t)}))}))}getProxyObject(){return this._lazyProxy}_request(t,i){return new Promise(((e,s)=>{this._onModuleLoaded.then((()=>{this._protocol.sendMessage(t,i).then(e,s)}),s)}))}_onError(t,i){console.error(t),console.info(i)}}function $u(t){return t[0]==="o"&&t[1]==="n"&&lr(t.charCodeAt(2))}function Wu(t){return/^onDynamic/.test(t)&&lr(t.charCodeAt(9))}function ju(t,i){var e;const s=globalThis.MonacoEnvironment;if(s!=null&&s.createTrustedTypesPolicy)try{return s.createTrustedTypesPolicy(t,i)}catch(t){return void Ii(t)}try{return(e=Wn.trustedTypes)===null||e===void 0?void 0:e.createPolicy(t,i)}catch(t){return void Ii(t)}}const Hu=ju("defaultWorkerFactory",{createScriptURL:t=>t});class Vu extends Qi{constructor(t,i,e,s,n){super(),this.id=i,this.label=e;const r=function(t){const i=globalThis.MonacoEnvironment;if(i){if(typeof i.getWorker=="function")return i.getWorker("workerMain.js",t);if(typeof i.getWorkerUrl=="function"){const e=i.getWorkerUrl("workerMain.js",t);return new Worker(Hu?Hu.createScriptURL(e):e,{name:t})}}throw new Error("You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker")}(e);typeof r.then=="function"?this.worker=r:this.worker=Promise.resolve(r),this.postMessage(t,[]),this.worker.then((t=>{t.onmessage=function(t){s(t.data)},t.onmessageerror=n,typeof t.addEventListener=="function"&&t.addEventListener("error",n)})),this._register(Zi((()=>{var t;(t=this.worker)===null||t===void 0||t.then((t=>{t.onmessage=null,t.onmessageerror=null,t.removeEventListener("error",n),t.terminate()})),this.worker=null})))}getId(){return this.id}postMessage(t,i){var e;(e=this.worker)===null||e===void 0||e.then((e=>{try{e.postMessage(t,i)}catch(t){Ii(t),Ii(new Error(`FAILED to post message to '${this.label}'-worker`,{cause:t}))}}))}}class zu{constructor(t){this._label=t,this._webWorkerFailedBeforeError=!1}create(t,i,e){const s=++zu.LAST_WORKER_ID;if(this._webWorkerFailedBeforeError)throw this._webWorkerFailedBeforeError;return new Vu(t,s,this._label||"anonymous"+s,i,(t=>{Tu(t),this._webWorkerFailedBeforeError=t,e(t)}))}}var Uu;zu.LAST_WORKER_ID=0,function(t){t[t.None=0]="None",t[t.Indent=1]="Indent",t[t.IndentOutdent=2]="IndentOutdent",t[t.Outdent=3]="Outdent"}(Uu||(Uu={}));class Ku{constructor(t){if(this._neutralCharacter=null,this._neutralCharacterSearched=!1,this.open=t.open,this.close=t.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(t.notIn))for(let i=0,e=t.notIn.length;i<e;i++)switch(t.notIn[i]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1}}isOK(t){switch(t){case 0:return!0;case 1:return this._inComment;case 2:return this._inString;case 3:return this._inRegEx}}shouldAutoClose(t,i){if(t.getTokenCount()===0)return!0;const e=t.findTokenIndexAtOffset(i-2),s=t.getStandardTokenType(e);return this.isOK(s)}_findNeutralCharacterInRange(t,i){for(let e=t;e<=i;e++){const t=String.fromCharCode(e);if(!this.open.includes(t)&&!this.close.includes(t))return t}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(48,57)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(97,122)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(65,90))),this._neutralCharacter}}class qu{constructor(t){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(const i of t)Gu(this.autoClosingPairsOpenByStart,i.open.charAt(0),i),Gu(this.autoClosingPairsOpenByEnd,i.open.charAt(i.open.length-1),i),Gu(this.autoClosingPairsCloseByStart,i.close.charAt(0),i),Gu(this.autoClosingPairsCloseByEnd,i.close.charAt(i.close.length-1),i),i.close.length===1&&i.open.length===1&&Gu(this.autoClosingPairsCloseSingleChar,i.close,i)}}function Gu(t,i,e){t.has(i)?t.get(i).push(e):t.set(i,[e])}function Zu(t,i){const e=t.getCount(),s=t.findTokenIndexAtOffset(i),n=t.getLanguageId(s);let r=s;for(;r+1<e&&t.getLanguageId(r+1)===n;)r++;let o=s;for(;o>0&&t.getLanguageId(o-1)===n;)o--;return new Ju(t,n,o,r+1,t.getStartOffset(o),t.getEndOffset(r))}class Ju{constructor(t,i,e,s,n,r){this._scopedLineTokensBrand=void 0,this._actual=t,this.languageId=i,this._firstTokenIndex=e,this._lastTokenIndex=s,this.firstCharOffset=n,this._lastCharOffset=r}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getActualLineContentBefore(t){return this._actual.getLineContent().substring(0,this.firstCharOffset+t)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(t){return this._actual.findTokenIndexAtOffset(t+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(t){return this._actual.getStandardTokenType(t+this._firstTokenIndex)}}function Qu(t){return!!(3&t)}class Yu{constructor(t){if(t.autoClosingPairs?this._autoClosingPairs=t.autoClosingPairs.map((t=>new Ku(t))):t.brackets?this._autoClosingPairs=t.brackets.map((t=>new Ku({open:t[0],close:t[1]}))):this._autoClosingPairs=[],t.__electricCharacterSupport&&t.__electricCharacterSupport.docComment){const i=t.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new Ku({open:i.open,close:i.close||""}))}this._autoCloseBeforeForQuotes=typeof t.autoCloseBefore=="string"?t.autoCloseBefore:Yu.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES,this._autoCloseBeforeForBrackets=typeof t.autoCloseBefore=="string"?t.autoCloseBefore:Yu.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS,this._surroundingPairs=t.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(t){return t?this._autoCloseBeforeForQuotes:this._autoCloseBeforeForBrackets}getSurroundingPairs(){return this._surroundingPairs}}Yu.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES=`;:.,=}])> \n\t`,Yu.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS=`'"\`;:.,=}])> \n\t`;const Xu=typeof Buffer<"u";let td,id,ed,sd;class nd{static wrap(t){return Xu&&!Buffer.isBuffer(t)&&(t=Buffer.from(t.buffer,t.byteOffset,t.byteLength)),new nd(t)}constructor(t){this.buffer=t,this.byteLength=this.buffer.byteLength}toString(){return Xu?this.buffer.toString():(td||(td=new TextDecoder),td.decode(this.buffer))}}function rd(t,i){return(t[i+0]|0)>>>0|t[i+1]<<8>>>0}function od(t,i,e){t[e+0]=255&i,i>>>=8,t[e+1]=255&i}function hd(t,i){return t[i]*2**24+65536*t[i+1]+256*t[i+2]+t[i+3]}function cd(t,i,e){t[e+3]=i,i>>>=8,t[e+2]=i,i>>>=8,t[e+1]=i,i>>>=8,t[e]=i}function ld(t,i){return t[i]}function ad(t,i,e){t[e]=i}function ud(){return id||(id=new TextDecoder("UTF-16LE")),id}function dd(){return sd||(sd=Ot()?ud():(ed||(ed=new TextDecoder("UTF-16BE")),ed)),sd}function fd(t,i,e){const s=new Uint16Array(t.buffer,i,e);return e>0&&(s[0]===65279||s[0]===65534)?function(t,i,e){const s=[];let n=0;for(let r=0;r<e;r++){const e=rd(t,i);i+=2,s[n++]=String.fromCharCode(e)}return s.join("")}(t,i,e):ud().decode(s)}class gd{constructor(t){this._capacity=0|t,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";const t=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return dd().decode(t)}_flushBuffer(){const t=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[t]:this._completedStrings[this._completedStrings.length]=t}appendCharCode(t){const i=this._capacity-this._bufferLength;i<=1&&(i===0||gr(t))&&this._flushBuffer(),this._buffer[this._bufferLength++]=t}appendASCIICharCode(t){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=t}appendString(t){const i=t.length;if(this._bufferLength+i>=this._capacity)return this._flushBuffer(),void(this._completedStrings[this._completedStrings.length]=t);for(let e=0;e<i;e++)this._buffer[this._bufferLength++]=t.charCodeAt(e)}}class pd{constructor(t,i,e,s,n,r){this._richEditBracketBrand=void 0,this.languageId=t,this.index=i,this.open=e,this.close=s,this.forwardRegex=n,this.reversedRegex=r,this._openSet=pd._toSet(this.open),this._closeSet=pd._toSet(this.close)}isOpen(t){return this._openSet.has(t)}isClose(t){return this._closeSet.has(t)}static _toSet(t){const i=new Set;for(const e of t)i.add(e);return i}}class md{constructor(t,i){this._richEditBracketsBrand=void 0;const e=function(t){const i=t.length;t=t.map((t=>[t[0].toLowerCase(),t[1].toLowerCase()]));const e=[];for(let t=0;t<i;t++)e[t]=t;const s=(t,i)=>{const[e,s]=t,[n,r]=i;return e===n||e===r||s===n||s===r},n=(t,s)=>{const n=Math.min(t,s),r=Math.max(t,s);for(let t=0;t<i;t++)e[t]===r&&(e[t]=n)};for(let r=0;r<i;r++){const o=t[r];for(let h=r+1;h<i;h++)s(o,t[h])&&n(e[r],e[h])}const r=[];for(let s=0;s<i;s++){const n=[],o=[];for(let r=0;r<i;r++)if(e[r]===s){const[i,e]=t[r];n.push(i),o.push(e)}n.length>0&&r.push({open:n,close:o})}return r}(i);this.brackets=e.map(((i,s)=>new pd(t,s,i.open,i.close,function(t,i,e,s){let n=[];n=n.concat(t),n=n.concat(i);for(let t=0,i=n.length;t<i;t++)wd(n[t],e,s,n);return n=bd(n),n.sort(vd),n.reverse(),kd(n)}(i.open,i.close,e,s),function(t,i,e,s){let n=[];n=n.concat(t),n=n.concat(i);for(let t=0,i=n.length;t<i;t++)wd(n[t],e,s,n);return n=bd(n),n.sort(vd),n.reverse(),kd(n.map(Cd))}(i.open,i.close,e,s)))),this.forwardRegex=function(t){let i=[];for(const e of t){for(const t of e.open)i.push(t);for(const t of e.close)i.push(t)}return i=bd(i),kd(i)}(this.brackets),this.reversedRegex=function(t){let i=[];for(const e of t){for(const t of e.open)i.push(t);for(const t of e.close)i.push(t)}return i=bd(i),kd(i.map(Cd))}(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(const t of this.brackets){for(const i of t.open)this.textIsBracket[i]=t,this.textIsOpenBracket[i]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,i.length);for(const i of t.close)this.textIsBracket[i]=t,this.textIsOpenBracket[i]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,i.length)}}}function wd(t,i,e,s){for(let n=0,r=i.length;n<r;n++){if(n===e)continue;const r=i[n];for(const i of r.open)i.indexOf(t)>=0&&s.push(i);for(const i of r.close)i.indexOf(t)>=0&&s.push(i)}}function vd(t,i){return t.length-i.length}function bd(t){if(t.length<=1)return t;const i=[],e=new Set;for(const s of t)e.has(s)||(i.push(s),e.add(s));return i}function yd(t){const i=/^[\w ]+$/.test(t);return t=Gn(t),i?`\\b${t}\\b`:t}function kd(t){return Yn(`(${t.map(yd).join(")|(")})`,!0)}const Cd=function(){let t=null,i=null;return function(e){return t!==e&&(t=e,i=function(t){const i=new Uint16Array(t.length);let e=0;for(let s=t.length-1;s>=0;s--)i[e++]=t.charCodeAt(s);return dd().decode(i)}(t)),i}}();class Sd{static _findPrevBracketInText(t,i,e,s){const n=e.match(t);if(!n)return null;const r=e.length-(n.index||0),o=n[0].length,h=s+r;return new Cs(i,h-o+1,i,h+1)}static findPrevBracketInRange(t,i,e,s,n){const r=Cd(e).substring(e.length-n,e.length-s);return this._findPrevBracketInText(t,i,r,s)}static findNextBracketInText(t,i,e,s){const n=e.match(t);if(!n)return null;const r=n.index||0,o=n[0].length;if(o===0)return null;const h=s+r;return new Cs(i,h+1,i,h+1+o)}static findNextBracketInRange(t,i,e,s,n){const r=e.substring(s,n);return this.findNextBracketInText(t,i,r,s)}}class xd{constructor(t){this._richEditBrackets=t}getElectricCharacters(){const t=[];if(this._richEditBrackets)for(const i of this._richEditBrackets.brackets)for(const e of i.close){const i=e.charAt(e.length-1);t.push(i)}return g(t)}onElectricCharacter(t,i,e){if(!this._richEditBrackets||this._richEditBrackets.brackets.length===0)return null;const s=i.findTokenIndexAtOffset(e-1);if(Qu(i.getStandardTokenType(s)))return null;const n=this._richEditBrackets.reversedRegex,r=i.getLineContent().substring(0,e-1)+t,o=Sd.findPrevBracketInRange(n,1,r,0,r.length);if(!o)return null;const h=r.substring(o.startColumn-1,o.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[h])return null;const c=i.getActualLineContentBefore(o.startColumn-1);return/^\s*$/.test(c)?{matchOpenBracket:h}:null}}function Dd(t){return t.global&&(t.lastIndex=0),!0}class Ed{constructor(t){this._indentationRules=t}shouldIncrease(t){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&Dd(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(t))}shouldDecrease(t){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&Dd(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(t))}shouldIndentNextLine(t){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&Dd(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(t))}shouldIgnore(t){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&Dd(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(t))}getIndentMetadata(t){let i=0;return this.shouldIncrease(t)&&(i+=1),this.shouldDecrease(t)&&(i+=2),this.shouldIndentNextLine(t)&&(i+=4),this.shouldIgnore(t)&&(i+=8),i}}class Ad{constructor(t){(t=t||{}).brackets=t.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],t.brackets.forEach((t=>{const i=Ad._createOpenBracketRegExp(t[0]),e=Ad._createCloseBracketRegExp(t[1]);i&&e&&this._brackets.push({open:t[0],openRegExp:i,close:t[1],closeRegExp:e})})),this._regExpRules=t.onEnterRules||[]}onEnter(t,i,e,s){if(t>=3)for(let t=0,n=this._regExpRules.length;t<n;t++){const n=this._regExpRules[t];if([{reg:n.beforeText,text:e},{reg:n.afterText,text:s},{reg:n.previousLineText,text:i}].every((t=>!t.reg||(t.reg.lastIndex=0,t.reg.test(t.text)))))return n.action}if(t>=2&&e.length>0&&s.length>0)for(let t=0,i=this._brackets.length;t<i;t++){const i=this._brackets[t];if(i.openRegExp.test(e)&&i.closeRegExp.test(s))return{indentAction:Uu.IndentOutdent}}if(t>=2&&e.length>0){for(let t=0,i=this._brackets.length;t<i;t++)if(this._brackets[t].openRegExp.test(e))return{indentAction:Uu.Indent}}return null}static _createOpenBracketRegExp(t){let i=Gn(t);return/\B/.test(i.charAt(0))||(i="\\b"+i),i+="\\s*$",Ad._safeRegExp(i)}static _createCloseBracketRegExp(t){let i=Gn(t);return/\B/.test(i.charAt(i.length-1))||(i+="\\b"),i="^\\s*"+i,Ad._safeRegExp(i)}static _safeRegExp(t){try{return new RegExp(t)}catch(t){return Ii(t),null}}}const Md=_l("configurationService");function Ld(t,i){const e=Object.create(null);for(const s in t)Fd(e,s,t[s],i);return e}function Fd(t,i,e,s){const n=i.split("."),r=n.pop();let o=t;for(let t=0;t<n.length;t++){const e=n[t];let r=o[e];switch(typeof r){case"undefined":r=o[e]=Object.create(null);break;case"object":break;default:return void s(`Ignoring ${i} as ${n.slice(0,t+1).join(".")} is ${JSON.stringify(r)}`)}o=r}if(typeof o=="object"&&o!==null)try{o[r]=e}catch{s(`Ignoring ${i} as ${n.join(".")} is ${JSON.stringify(o)}`)}else s(`Ignoring ${i} as ${n.join(".")} is ${JSON.stringify(o)}`)}function Td(t,i){Rd(t,i.split("."))}function Rd(t,i){const e=i.shift();if(i.length!==0){if(Object.keys(t).indexOf(e)!==-1){const s=t[e];typeof s!="object"||Array.isArray(s)||(Rd(s,i),Object.keys(s).length===0&&delete t[e])}}else delete t[e]}function Od(t,i,e){const s=function(t,i){let e=t;for(const t of i){if(typeof e!="object"||e===null)return;e=e[t]}return e}(t,i.split("."));return s===void 0?e:s}const Id=_l("languageService");class _d{constructor(t,i=[],e=!1){this.ctor=t,this.staticArguments=i,this.supportsDelayedInstantiation=e}}const Pd=[];function Nd(t,i,e){i instanceof _d||(i=new _d(i,[],!!e)),Pd.push([t,i])}function Bd(){return Pd}const $d=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"}),Wd="base.contributions.json",jd=new class{constructor(){this._onDidChangeSchema=new le,this.schemasById={}}registerSchema(t,i){var e;this.schemasById[(e=t,e.length>0&&e.charAt(e.length-1)==="#"?e.substring(0,e.length-1):e)]=i,this._onDidChangeSchema.fire(t)}notifySchemaChanged(t){this._onDidChangeSchema.fire(t)}};Va.add(Wd,jd);const Hd="base.contributions.configuration",Vd="vscode://schemas/settings/resourceLanguage",zd=Va.as(Wd),Ud="\\[([^\\]]+)\\]",Kd=new RegExp(Ud,"g"),qd=new RegExp(`^(${Ud})+$`);function Gd(t){const i=[];if(qd.test(t)){let e=Kd.exec(t);for(;e!=null&&e.length;){const s=e[1].trim();s&&i.push(s),e=Kd.exec(t)}}return g(i)}const Zd=new class{constructor(){this.overrideIdentifiers=new Set,this._onDidSchemaChange=new le,this._onDidUpdateConfiguration=new le,this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:tt(0,"Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},zd.registerSchema(Vd,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(t,i=!0){this.registerConfigurations([t],i)}registerConfigurations(t,i=!0){const e=new Set;this.doRegisterConfigurations(t,i,e),zd.registerSchema(Vd,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:e})}registerDefaultConfigurations(t){const i=new Set;this.doRegisterDefaultConfigurations(t,i),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i,defaultsOverrides:!0})}doRegisterDefaultConfigurations(t,i){var e;const s=[];for(const{overrides:n,source:r}of t)for(const t in n)if(i.add(t),qd.test(t)){const i=this.configurationDefaultsOverrides.get(t),o=(e=i==null?void 0:i.valuesSources)!==null&&e!==void 0?e:new Map;if(r)for(const i of Object.keys(n[t]))o.set(i,r);const h={...(i==null?void 0:i.value)||{},...n[t]};this.configurationDefaultsOverrides.set(t,{source:r,value:h,valuesSources:o});const c={type:"object",default:h,description:tt(0,"Configure settings to be overridden for the {0} language.",t.replace(/[\[\]]/g,"")),$ref:Vd,defaultDefaultValue:h,source:R(r)?void 0:r,defaultValueSource:r};s.push(...Gd(t)),this.configurationProperties[t]=c,this.defaultLanguageConfigurationOverridesNode.properties[t]=c}else{this.configurationDefaultsOverrides.set(t,{value:n[t],source:r});const i=this.configurationProperties[t];i&&(this.updatePropertyDefaultValue(t,i),this.updateSchema(t,i))}this.doRegisterOverrideIdentifiers(s)}registerOverrideIdentifiers(t){this.doRegisterOverrideIdentifiers(t),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(t){for(const i of t)this.overrideIdentifiers.add(i);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(t,i,e){t.forEach((t=>{this.validateAndRegisterProperties(t,i,t.extensionInfo,t.restrictedProperties,void 0,e),this.configurationContributors.push(t),this.registerJSONConfiguration(t)}))}validateAndRegisterProperties(t,i=!0,e,s,n=3,r){var o;n=W(t.scope)?n:t.scope;const h=t.properties;if(h)for(const t in h){const c=h[t];i&&Jd(t,c)?delete h[t]:(c.source=e,c.defaultDefaultValue=h[t].default,this.updatePropertyDefaultValue(t,c),qd.test(t)?c.scope=void 0:(c.scope=W(c.scope)?n:c.scope,c.restricted=W(c.restricted)?!!(s!=null&&s.includes(t)):c.restricted),!h[t].hasOwnProperty("included")||h[t].included?(this.configurationProperties[t]=h[t],!((o=h[t].policy)===null||o===void 0)&&o.name&&this.policyConfigurations.set(h[t].policy.name,t),!h[t].deprecationMessage&&h[t].markdownDeprecationMessage&&(h[t].deprecationMessage=h[t].markdownDeprecationMessage),r.add(t)):(this.excludedConfigurationProperties[t]=h[t],delete h[t]))}const c=t.allOf;if(c)for(const t of c)this.validateAndRegisterProperties(t,i,e,s,n,r)}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}registerJSONConfiguration(t){const i=t=>{const e=t.properties;if(e)for(const t in e)this.updateSchema(t,e[t]);const s=t.allOf;s==null||s.forEach(i)};i(t)}updateSchema(t,i){switch(i.scope){case 1:case 2:case 6:case 3:case 4:break;case 5:this.resourceLanguageSettingsSchema.properties[t]=i}}updateOverridePropertyPatternKey(){for(const t of this.overrideIdentifiers.values()){const i=`[${t}]`,e={type:"object",description:tt(0,"Configure editor settings to be overridden for a language."),errorMessage:tt(0,"This setting does not support per-language configuration."),$ref:Vd};this.updatePropertyDefaultValue(i,e)}}registerOverridePropertyPatternKey(){tt(0,"Configure editor settings to be overridden for a language."),tt(0,"This setting does not support per-language configuration."),this._onDidSchemaChange.fire()}updatePropertyDefaultValue(t,i){const e=this.configurationDefaultsOverrides.get(t);let s=e==null?void 0:e.value,n=e==null?void 0:e.source;B(s)&&(s=i.defaultDefaultValue,n=void 0),B(s)&&(s=function(t){switch(Array.isArray(t)?t[0]:t){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}(i.type)),i.default=s,i.defaultValueSource=n}};function Jd(t,i){var e,s,n,r;return t.trim()?qd.test(t)?tt(0,"Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",t):Zd.getConfigurationProperties()[t]!==void 0?tt(0,"Cannot register '{0}'. This property is already registered.",t):!((e=i.policy)===null||e===void 0)&&e.name&&Zd.getPolicyConfigurations().get((s=i.policy)===null||s===void 0?void 0:s.name)!==void 0?tt(0,"Cannot register '{0}'. The associated policy {1} is already registered with {2}.",t,(n=i.policy)===null||n===void 0?void 0:n.name,Zd.getPolicyConfigurations().get((r=i.policy)===null||r===void 0?void 0:r.name)):null:tt(0,"Cannot register an empty property")}Va.add(Hd,Zd);const Qd=new class{constructor(){this._onDidChangeLanguages=new le,this.onDidChangeLanguages=this._onDidChangeLanguages.event,this._languages=[]}registerLanguage(t){return this._languages.push(t),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let i=0,e=this._languages.length;i<e;i++)if(this._languages[i]===t)return void this._languages.splice(i,1)}}}getLanguages(){return this._languages}};Va.add("editor.modesRegistry",Qd);const Yd="plaintext";Qd.registerLanguage({id:Yd,extensions:[".txt"],aliases:[tt(0,"Plain Text"),"text"],mimetypes:[$d.text]}),Va.as(Hd).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1}}}]);class Xd{constructor(t,i){this.languageId=t;const e=i.brackets?tf(i.brackets):[],s=new jn((t=>{const i=new Set;return{info:new sf(this,t,i),closing:i}})),n=new jn((t=>{const i=new Set,e=new Set;return{info:new nf(this,t,i,e),opening:i,openingColorized:e}}));for(const[t,i]of e){const e=s.get(t),r=n.get(i);e.closing.add(r.info),r.opening.add(e.info)}const r=i.colorizedBracketPairs?tf(i.colorizedBracketPairs):e.filter((t=>!(t[0]==="<"&&t[1]===">")));for(const[t,i]of r){const e=s.get(t),r=n.get(i);e.closing.add(r.info),r.openingColorized.add(e.info),r.opening.add(e.info)}this._openingBrackets=new Map([...s.cachedValues].map((([t,i])=>[t,i.info]))),this._closingBrackets=new Map([...n.cachedValues].map((([t,i])=>[t,i.info])))}get openingBrackets(){return[...this._openingBrackets.values()]}get closingBrackets(){return[...this._closingBrackets.values()]}getOpeningBracketInfo(t){return this._openingBrackets.get(t)}getClosingBracketInfo(t){return this._closingBrackets.get(t)}getBracketInfo(t){return this.getOpeningBracketInfo(t)||this.getClosingBracketInfo(t)}}function tf(t){return t.filter((([t,i])=>t!==""&&i!==""))}class ef{constructor(t,i){this.config=t,this.bracketText=i}get languageId(){return this.config.languageId}}class sf extends ef{constructor(t,i,e){super(t,i),this.openedBrackets=e,this.isOpeningBracket=!0}}class nf extends ef{constructor(t,i,e,s){super(t,i),this.openingBrackets=e,this.openingColorizedBrackets=s,this.isOpeningBracket=!1}closes(t){return t.config===this.config&&this.openingBrackets.has(t)}closesColorized(t){return t.config===this.config&&this.openingColorizedBrackets.has(t)}getOpeningBrackets(){return[...this.openingBrackets]}}var rf=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},of=function(t,i){return function(e,s){i(e,s,t)}};class hf{constructor(t){this.languageId=t}affects(t){return!this.languageId||this.languageId===t}}const cf=_l("languageConfigurationService");let lf=class extends Qi{constructor(t,i){super(),this.configurationService=t,this.languageService=i,this._registry=this._register(new vf),this.onDidChangeEmitter=this._register(new le),this.onDidChange=this.onDidChangeEmitter.event,this.configurations=new Map;const e=new Set(Object.values(af));this._register(this.configurationService.onDidChangeConfiguration((t=>{const i=t.change.keys.some((t=>e.has(t))),s=t.change.overrides.filter((([t,i])=>i.some((t=>e.has(t))))).map((([t])=>t));if(i)this.configurations.clear(),this.onDidChangeEmitter.fire(new hf(void 0));else for(const t of s)this.languageService.isRegisteredLanguageId(t)&&(this.configurations.delete(t),this.onDidChangeEmitter.fire(new hf(t)))}))),this._register(this._registry.onDidChange((t=>{this.configurations.delete(t.languageId),this.onDidChangeEmitter.fire(new hf(t.languageId))})))}register(t,i,e){return this._registry.register(t,i,e)}getLanguageConfiguration(t){let i=this.configurations.get(t);return i||(i=function(t,i,e,s){let n=i.getLanguageConfiguration(t);if(!n){if(!s.isRegisteredLanguageId(t))return new bf(t,{});n=new bf(t,{})}const r=function(t,i){const e=i.getValue(af.brackets,{overrideIdentifier:t}),s=i.getValue(af.colorizedBracketPairs,{overrideIdentifier:t});return{brackets:uf(e),colorizedBracketPairs:uf(s)}}(n.languageId,e),o=pf([n.underlyingConfig,r]);return new bf(n.languageId,o)}(t,this._registry,this.configurationService,this.languageService),this.configurations.set(t,i)),i}};lf=rf([of(0,Md),of(1,Id)],lf);const af={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function uf(t){if(Array.isArray(t))return t.map((t=>{if(Array.isArray(t)&&t.length===2)return[t[0],t[1]]})).filter((t=>!!t))}function df(t,i,e){let s=ir(t.getLineContent(i));return s.length>e-1&&(s=s.substring(0,e-1)),s}function ff(t,i,e){return t.tokenization.forceTokenization(i),Zu(t.tokenization.getLineTokens(i),e===void 0?t.getLineMaxColumn(i)-1:e-1)}class gf{constructor(t){this.languageId=t,this._resolved=null,this._entries=[],this._order=0,this._resolved=null}register(t,i){const e=new mf(t,i,++this._order);return this._entries.push(e),this._resolved=null,Zi((()=>{for(let t=0;t<this._entries.length;t++)if(this._entries[t]===e){this._entries.splice(t,1),this._resolved=null;break}}))}getResolvedConfiguration(){if(!this._resolved){const t=this._resolve();t&&(this._resolved=new bf(this.languageId,t))}return this._resolved}_resolve(){return this._entries.length===0?null:(this._entries.sort(mf.cmp),pf(this._entries.map((t=>t.configuration))))}}function pf(t){let i={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(const e of t)i={comments:e.comments||i.comments,brackets:e.brackets||i.brackets,wordPattern:e.wordPattern||i.wordPattern,indentationRules:e.indentationRules||i.indentationRules,onEnterRules:e.onEnterRules||i.onEnterRules,autoClosingPairs:e.autoClosingPairs||i.autoClosingPairs,surroundingPairs:e.surroundingPairs||i.surroundingPairs,autoCloseBefore:e.autoCloseBefore||i.autoCloseBefore,folding:e.folding||i.folding,colorizedBracketPairs:e.colorizedBracketPairs||i.colorizedBracketPairs,__electricCharacterSupport:e.__electricCharacterSupport||i.__electricCharacterSupport};return i}class mf{constructor(t,i,e){this.configuration=t,this.priority=i,this.order=e}static cmp(t,i){return t.priority===i.priority?t.order-i.order:t.priority-i.priority}}class wf{constructor(t){this.languageId=t}}class vf extends Qi{constructor(){super(),this._entries=new Map,this._onDidChange=this._register(new le),this.onDidChange=this._onDidChange.event,this._register(this.register(Yd,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0))}register(t,i,e=0){let s=this._entries.get(t);s||(s=new gf(t),this._entries.set(t,s));const n=s.register(i,e);return this._onDidChange.fire(new wf(t)),Zi((()=>{n.dispose(),this._onDidChange.fire(new wf(t))}))}getLanguageConfiguration(t){const i=this._entries.get(t);return(i==null?void 0:i.getResolvedConfiguration())||null}}class bf{constructor(t,i){this.languageId=t,this.underlyingConfig=i,this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new Ad(this.underlyingConfig):null,this.comments=bf._handleComments(this.underlyingConfig),this.characterPair=new Yu(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||zt,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new Ed(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{},this.bracketsNew=new Xd(t,this.underlyingConfig)}getWordDefinition(){return Ut(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new md(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new xd(this.brackets)),this._electricCharacter}onEnter(t,i,e,s){return this._onEnterSupport?this._onEnterSupport.onEnter(t,i,e,s):null}getAutoClosingPairs(){return new qu(this.characterPair.getAutoClosingPairs())}getAutoCloseBeforeSet(t){return this.characterPair.getAutoCloseBeforeSet(t)}getSurroundingPairs(){return this.characterPair.getSurroundingPairs()}static _handleComments(t){const i=t.comments;if(!i)return null;const e={};if(i.lineComment&&(e.lineCommentToken=i.lineComment),i.blockComment){const[t,s]=i.blockComment;e.blockCommentStartToken=t,e.blockCommentEndToken=s}return e}}Nd(cf,lf,1);class yf{constructor(t,i,e,s){this.originalStart=t,this.originalLength=i,this.modifiedStart=e,this.modifiedLength=s}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}class kf{constructor(t){this.source=t}getElements(){const t=this.source,i=new Int32Array(t.length);for(let e=0,s=t.length;e<s;e++)i[e]=t.charCodeAt(e);return i}}function Cf(t,i,e){return new Ef(new kf(t),new kf(i)).ComputeDiff(e).changes}class Sf{static Assert(t,i){if(!t)throw new Error(i)}}class xf{static Copy(t,i,e,s,n){for(let r=0;r<n;r++)e[s+r]=t[i+r]}static Copy2(t,i,e,s,n){for(let r=0;r<n;r++)e[s+r]=t[i+r]}}class Df{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new yf(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(t,i){this.m_originalStart=Math.min(this.m_originalStart,t),this.m_modifiedStart=Math.min(this.m_modifiedStart,i),this.m_originalCount++}AddModifiedElement(t,i){this.m_originalStart=Math.min(this.m_originalStart,t),this.m_modifiedStart=Math.min(this.m_modifiedStart,i),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}class Ef{constructor(t,i,e=null){this.ContinueProcessingPredicate=e,this._originalSequence=t,this._modifiedSequence=i;const[s,n,r]=Ef._getElements(t),[o,h,c]=Ef._getElements(i);this._hasStrings=r&&c,this._originalStringElements=s,this._originalElementsOrHash=n,this._modifiedStringElements=o,this._modifiedElementsOrHash=h,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(t){return t.length>0&&typeof t[0]=="string"}static _getElements(t){const i=t.getElements();if(Ef._isStringArray(i)){const t=new Int32Array(i.length);for(let e=0,s=i.length;e<s;e++)t[e]=$h(i[e],0);return[i,t,!0]}return i instanceof Int32Array?[[],i,!1]:[[],new Int32Array(i),!1]}ElementsAreEqual(t,i){return this._originalElementsOrHash[t]===this._modifiedElementsOrHash[i]&&(!this._hasStrings||this._originalStringElements[t]===this._modifiedStringElements[i])}ElementsAreStrictEqual(t,i){return this.ElementsAreEqual(t,i)?Ef._getStrictElement(this._originalSequence,t)===Ef._getStrictElement(this._modifiedSequence,i):!1}static _getStrictElement(t,i){return typeof t.getStrictElement=="function"?t.getStrictElement(i):null}OriginalElementsAreEqual(t,i){return this._originalElementsOrHash[t]===this._originalElementsOrHash[i]&&(!this._hasStrings||this._originalStringElements[t]===this._originalStringElements[i])}ModifiedElementsAreEqual(t,i){return this._modifiedElementsOrHash[t]===this._modifiedElementsOrHash[i]&&(!this._hasStrings||this._modifiedStringElements[t]===this._modifiedStringElements[i])}ComputeDiff(t){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,t)}_ComputeDiff(t,i,e,s,n){const r=[!1];let o=this.ComputeDiffRecursive(t,i,e,s,r);return n&&(o=this.PrettifyChanges(o)),{quitEarly:r[0],changes:o}}ComputeDiffRecursive(t,i,e,s,n){for(n[0]=!1;t<=i&&e<=s&&this.ElementsAreEqual(t,e);)t++,e++;for(;i>=t&&s>=e&&this.ElementsAreEqual(i,s);)i--,s--;if(t>i||e>s){let n;return e<=s?(Sf.Assert(t===i+1,"originalStart should only be one more than originalEnd"),n=[new yf(t,0,e,s-e+1)]):t<=i?(Sf.Assert(e===s+1,"modifiedStart should only be one more than modifiedEnd"),n=[new yf(t,i-t+1,e,0)]):(Sf.Assert(t===i+1,"originalStart should only be one more than originalEnd"),Sf.Assert(e===s+1,"modifiedStart should only be one more than modifiedEnd"),n=[]),n}const r=[0],o=[0],h=this.ComputeRecursionPoint(t,i,e,s,r,o,n),c=r[0],l=o[0];if(h!==null)return h;if(!n[0]){const r=this.ComputeDiffRecursive(t,c,e,l,n);let o=[];return o=n[0]?[new yf(c+1,i-(c+1)+1,l+1,s-(l+1)+1)]:this.ComputeDiffRecursive(c+1,i,l+1,s,n),this.ConcatenateChanges(r,o)}return[new yf(t,i-t+1,e,s-e+1)]}WALKTRACE(t,i,e,s,n,r,o,h,c,l,a,u,d,f,g,p,m,w){let v=null,b=null,y=new Df,k=i,C=e,S=d[0]-p[0]-s,x=-1073741824,D=this.m_forwardHistory.length-1;do{const i=S+t;i===k||i<C&&c[i-1]<c[i+1]?(f=(a=c[i+1])-S-s,a<x&&y.MarkNextChange(),x=a,y.AddModifiedElement(a+1,f),S=i+1-t):(f=(a=c[i-1]+1)-S-s,a<x&&y.MarkNextChange(),x=a-1,y.AddOriginalElement(a,f+1),S=i-1-t),D>=0&&(t=(c=this.m_forwardHistory[D])[0],k=1,C=c.length-1)}while(--D>=-1);if(v=y.getReverseChanges(),w[0]){let t=d[0]+1,i=p[0]+1;if(v!==null&&v.length>0){const e=v[v.length-1];t=Math.max(t,e.getOriginalEnd()),i=Math.max(i,e.getModifiedEnd())}b=[new yf(t,u-t+1,i,g-i+1)]}else{y=new Df,k=r,C=o,S=d[0]-p[0]-h,x=1073741824,D=m?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const t=S+n;t===k||t<C&&l[t-1]>=l[t+1]?(f=(a=l[t+1]-1)-S-h,a>x&&y.MarkNextChange(),x=a+1,y.AddOriginalElement(a+1,f+1),S=t+1-n):(f=(a=l[t-1])-S-h,a>x&&y.MarkNextChange(),x=a,y.AddModifiedElement(a+1,f+1),S=t-1-n),D>=0&&(n=(l=this.m_reverseHistory[D])[0],k=1,C=l.length-1)}while(--D>=-1);b=y.getChanges()}return this.ConcatenateChanges(v,b)}ComputeRecursionPoint(t,i,e,s,n,r,o){let h=0,c=0,l=0,a=0,u=0,d=0;t--,e--,n[0]=0,r[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];const f=i-t+(s-e),g=f+1,p=new Int32Array(g),m=new Int32Array(g),w=s-e,v=i-t,b=t-e,y=i-s,k=(v-w)%2==0;p[w]=t,m[v]=i,o[0]=!1;for(let C=1;C<=f/2+1;C++){let f=0,S=0;l=this.ClipDiagonalBound(w-C,C,w,g),a=this.ClipDiagonalBound(w+C,C,w,g);for(let t=l;t<=a;t+=2){h=t===l||t<a&&p[t-1]<p[t+1]?p[t+1]:p[t-1]+1,c=h-(t-w)-b;const e=h;for(;h<i&&c<s&&this.ElementsAreEqual(h+1,c+1);)h++,c++;if(p[t]=h,h+c>f+S&&(f=h,S=c),!k&&Math.abs(t-v)<=C-1&&h>=m[t])return n[0]=h,r[0]=c,e<=m[t]&&C<=1448?this.WALKTRACE(w,l,a,b,v,u,d,y,p,m,h,i,n,c,s,r,k,o):null}const x=(f-t+(S-e)-C)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(f,x))return o[0]=!0,n[0]=f,r[0]=S,x>0&&C<=1448?this.WALKTRACE(w,l,a,b,v,u,d,y,p,m,h,i,n,c,s,r,k,o):(t++,e++,[new yf(t,i-t+1,e,s-e+1)]);u=this.ClipDiagonalBound(v-C,C,v,g),d=this.ClipDiagonalBound(v+C,C,v,g);for(let f=u;f<=d;f+=2){h=f===u||f<d&&m[f-1]>=m[f+1]?m[f+1]-1:m[f-1],c=h-(f-v)-y;const g=h;for(;h>t&&c>e&&this.ElementsAreEqual(h,c);)h--,c--;if(m[f]=h,k&&Math.abs(f-w)<=C&&h<=p[f])return n[0]=h,r[0]=c,g>=p[f]&&C<=1448?this.WALKTRACE(w,l,a,b,v,u,d,y,p,m,h,i,n,c,s,r,k,o):null}if(C<=1447){let t=new Int32Array(a-l+2);t[0]=w-l+1,xf.Copy2(p,l,t,1,a-l+1),this.m_forwardHistory.push(t),t=new Int32Array(d-u+2),t[0]=v-u+1,xf.Copy2(m,u,t,1,d-u+1),this.m_reverseHistory.push(t)}}return this.WALKTRACE(w,l,a,b,v,u,d,y,p,m,h,i,n,c,s,r,k,o)}PrettifyChanges(t){for(let i=0;i<t.length;i++){const e=t[i],s=i<t.length-1?t[i+1].originalStart:this._originalElementsOrHash.length,n=i<t.length-1?t[i+1].modifiedStart:this._modifiedElementsOrHash.length,r=e.originalLength>0,o=e.modifiedLength>0;for(;e.originalStart+e.originalLength<s&&e.modifiedStart+e.modifiedLength<n&&(!r||this.OriginalElementsAreEqual(e.originalStart,e.originalStart+e.originalLength))&&(!o||this.ModifiedElementsAreEqual(e.modifiedStart,e.modifiedStart+e.modifiedLength));){const t=this.ElementsAreStrictEqual(e.originalStart,e.modifiedStart);if(this.ElementsAreStrictEqual(e.originalStart+e.originalLength,e.modifiedStart+e.modifiedLength)&&!t)break;e.originalStart++,e.modifiedStart++}const h=[null];i<t.length-1&&this.ChangesOverlap(t[i],t[i+1],h)&&(t[i]=h[0],t.splice(i+1,1),i--)}for(let i=t.length-1;i>=0;i--){const e=t[i];let s=0,n=0;if(i>0){const e=t[i-1];s=e.originalStart+e.originalLength,n=e.modifiedStart+e.modifiedLength}const r=e.originalLength>0,o=e.modifiedLength>0;let h=0,c=this._boundaryScore(e.originalStart,e.originalLength,e.modifiedStart,e.modifiedLength);for(let t=1;;t++){const i=e.originalStart-t,l=e.modifiedStart-t;if(i<s||l<n||r&&!this.OriginalElementsAreEqual(i,i+e.originalLength)||o&&!this.ModifiedElementsAreEqual(l,l+e.modifiedLength))break;const a=(i===s&&l===n?5:0)+this._boundaryScore(i,e.originalLength,l,e.modifiedLength);a>c&&(c=a,h=t)}e.originalStart-=h,e.modifiedStart-=h;const l=[null];i>0&&this.ChangesOverlap(t[i-1],t[i],l)&&(t[i-1]=l[0],t.splice(i,1),i++)}if(this._hasStrings)for(let i=1,e=t.length;i<e;i++){const e=t[i-1],s=t[i],n=s.originalStart-e.originalStart-e.originalLength,r=e.originalStart,o=s.originalStart+s.originalLength,h=o-r,c=e.modifiedStart,l=s.modifiedStart+s.modifiedLength,a=l-c;if(n<5&&h<20&&a<20){const t=this._findBetterContiguousSequence(r,h,c,a,n);if(t){const[i,r]=t;i===e.originalStart+e.originalLength&&r===e.modifiedStart+e.modifiedLength||(e.originalLength=i-e.originalStart,e.modifiedLength=r-e.modifiedStart,s.originalStart=i+n,s.modifiedStart=r+n,s.originalLength=o-s.originalStart,s.modifiedLength=l-s.modifiedStart)}}}return t}_findBetterContiguousSequence(t,i,e,s,n){if(i<n||s<n)return null;const r=t+i-n+1,o=e+s-n+1;let h=0,c=0,l=0;for(let i=t;i<r;i++)for(let t=e;t<o;t++){const e=this._contiguousSequenceScore(i,t,n);e>0&&e>h&&(h=e,c=i,l=t)}return h>0?[c,l]:null}_contiguousSequenceScore(t,i,e){let s=0;for(let n=0;n<e;n++){if(!this.ElementsAreEqual(t+n,i+n))return 0;s+=this._originalStringElements[t+n].length}return s}_OriginalIsBoundary(t){return t<=0||t>=this._originalElementsOrHash.length-1||this._hasStrings&&/^\s*$/.test(this._originalStringElements[t])}_OriginalRegionIsBoundary(t,i){if(this._OriginalIsBoundary(t)||this._OriginalIsBoundary(t-1))return!0;if(i>0){const e=t+i;if(this._OriginalIsBoundary(e-1)||this._OriginalIsBoundary(e))return!0}return!1}_ModifiedIsBoundary(t){return t<=0||t>=this._modifiedElementsOrHash.length-1||this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[t])}_ModifiedRegionIsBoundary(t,i){if(this._ModifiedIsBoundary(t)||this._ModifiedIsBoundary(t-1))return!0;if(i>0){const e=t+i;if(this._ModifiedIsBoundary(e-1)||this._ModifiedIsBoundary(e))return!0}return!1}_boundaryScore(t,i,e,s){return(this._OriginalRegionIsBoundary(t,i)?1:0)+(this._ModifiedRegionIsBoundary(e,s)?1:0)}ConcatenateChanges(t,i){const e=[];if(t.length===0||i.length===0)return i.length>0?i:t;if(this.ChangesOverlap(t[t.length-1],i[0],e)){const s=new Array(t.length+i.length-1);return xf.Copy(t,0,s,0,t.length-1),s[t.length-1]=e[0],xf.Copy(i,1,s,t.length,i.length-1),s}{const e=new Array(t.length+i.length);return xf.Copy(t,0,e,0,t.length),xf.Copy(i,0,e,t.length,i.length),e}}ChangesOverlap(t,i,e){if(Sf.Assert(t.originalStart<=i.originalStart,"Left change is not less than or equal to right change"),Sf.Assert(t.modifiedStart<=i.modifiedStart,"Left change is not less than or equal to right change"),t.originalStart+t.originalLength>=i.originalStart||t.modifiedStart+t.modifiedLength>=i.modifiedStart){const s=t.originalStart;let n=t.originalLength;const r=t.modifiedStart;let o=t.modifiedLength;return t.originalStart+t.originalLength>=i.originalStart&&(n=i.originalStart+i.originalLength-t.originalStart),t.modifiedStart+t.modifiedLength>=i.modifiedStart&&(o=i.modifiedStart+i.modifiedLength-t.modifiedStart),e[0]=new yf(s,n,r,o),!0}return e[0]=null,!1}ClipDiagonalBound(t,i,e,s){if(t>=0&&t<s)return t;const n=i%2==0;return t<0?n===(e%2==0)?0:1:n===((s-e-1)%2==0)?s-1:s-2}}function Af(t){return t<0?0:t>255?255:0|t}function Mf(t){return t<0?0:t>4294967295?4294967295:0|t}class Lf{constructor(t){this.values=t,this.prefixSum=new Uint32Array(t.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}insertValues(t,i){t=Mf(t);const e=this.values,s=this.prefixSum,n=i.length;return n!==0&&(this.values=new Uint32Array(e.length+n),this.values.set(e.subarray(0,t),0),this.values.set(e.subarray(t),t+n),this.values.set(i,t),t-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=t-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(s.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}setValue(t,i){return t=Mf(t),i=Mf(i),this.values[t]!==i&&(this.values[t]=i,t-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=t-1),!0)}removeValues(t,i){t=Mf(t),i=Mf(i);const e=this.values,s=this.prefixSum;if(t>=e.length)return!1;const n=e.length-t;return i>=n&&(i=n),i!==0&&(this.values=new Uint32Array(e.length-i),this.values.set(e.subarray(0,t),0),this.values.set(e.subarray(t+i),t),this.prefixSum=new Uint32Array(this.values.length),t-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=t-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(s.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return this.values.length===0?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(t){return t<0?0:(t=Mf(t),this._getPrefixSum(t))}_getPrefixSum(t){if(t<=this.prefixSumValidIndex[0])return this.prefixSum[t];let i=this.prefixSumValidIndex[0]+1;i===0&&(this.prefixSum[0]=this.values[0],i++),t>=this.values.length&&(t=this.values.length-1);for(let e=i;e<=t;e++)this.prefixSum[e]=this.prefixSum[e-1]+this.values[e];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],t),this.prefixSum[t]}getIndexOf(t){t=Math.floor(t),this.getTotalSum();let i=0,e=this.values.length-1,s=0,n=0,r=0;for(;i<=e;)if(s=i+(e-i)/2|0,n=this.prefixSum[s],r=n-this.values[s],t<r)e=s-1;else{if(!(t>=n))break;i=s+1}return new Tf(s,t-r)}}class Ff{constructor(t){this._values=t,this._isValid=!1,this._validEndIndex=-1,this._prefixSum=[],this._indexBySum=[]}getTotalSum(){return this._ensureValid(),this._indexBySum.length}getPrefixSum(t){return this._ensureValid(),t===0?0:this._prefixSum[t-1]}getIndexOf(t){this._ensureValid();const i=this._indexBySum[t],e=i>0?this._prefixSum[i-1]:0;return new Tf(i,t-e)}removeValues(t,i){this._values.splice(t,i),this._invalidate(t)}insertValues(t,i){this._values=w(this._values,t,i),this._invalidate(t)}_invalidate(t){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,t-1)}_ensureValid(){if(!this._isValid){for(let t=this._validEndIndex+1,i=this._values.length;t<i;t++){const i=this._values[t],e=t>0?this._prefixSum[t-1]:0;this._prefixSum[t]=e+i;for(let s=0;s<i;s++)this._indexBySum[e+s]=t}this._prefixSum.length=this._values.length,this._indexBySum.length=this._prefixSum[this._prefixSum.length-1],this._isValid=!0,this._validEndIndex=this._values.length-1}}setValue(t,i){this._values[t]!==i&&(this._values[t]=i,this._invalidate(t))}}class Tf{constructor(t,i){this.index=t,this.remainder=i,this._prefixSumIndexOfResultBrand=void 0,this.index=t,this.remainder=i}}class Rf{constructor(t,i,e,s){this._uri=t,this._lines=i,this._eol=e,this._versionId=s,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return this._cachedTextValue===null&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(t){t.eol&&t.eol!==this._eol&&(this._eol=t.eol,this._lineStarts=null);const i=t.changes;for(const t of i)this._acceptDeleteRange(t.range),this._acceptInsertText(new ks(t.range.startLineNumber,t.range.startColumn),t.text);this._versionId=t.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const t=this._eol.length,i=this._lines.length,e=new Uint32Array(i);for(let s=0;s<i;s++)e[s]=this._lines[s].length+t;this._lineStarts=new Lf(e)}}_setLineText(t,i){this._lines[t]=i,this._lineStarts&&this._lineStarts.setValue(t,this._lines[t].length+this._eol.length)}_acceptDeleteRange(t){if(t.startLineNumber!==t.endLineNumber)this._setLineText(t.startLineNumber-1,this._lines[t.startLineNumber-1].substring(0,t.startColumn-1)+this._lines[t.endLineNumber-1].substring(t.endColumn-1)),this._lines.splice(t.startLineNumber,t.endLineNumber-t.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(t.startLineNumber,t.endLineNumber-t.startLineNumber);else{if(t.startColumn===t.endColumn)return;this._setLineText(t.startLineNumber-1,this._lines[t.startLineNumber-1].substring(0,t.startColumn-1)+this._lines[t.startLineNumber-1].substring(t.endColumn-1))}}_acceptInsertText(t,i){if(i.length===0)return;const e=Xn(i);if(e.length===1)return void this._setLineText(t.lineNumber-1,this._lines[t.lineNumber-1].substring(0,t.column-1)+e[0]+this._lines[t.lineNumber-1].substring(t.column-1));e[e.length-1]+=this._lines[t.lineNumber-1].substring(t.column-1),this._setLineText(t.lineNumber-1,this._lines[t.lineNumber-1].substring(0,t.column-1)+e[0]);const s=new Uint32Array(e.length-1);for(let i=1;i<e.length;i++)this._lines.splice(t.lineNumber+i-1,0,e[i]),s[i-1]=e[i].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(t.lineNumber,s)}}class Of{constructor(t){const i=Af(t);this._defaultValue=i,this._asciiMap=Of._createAsciiMap(i),this._map=new Map}static _createAsciiMap(t){const i=new Uint8Array(256);return i.fill(t),i}set(t,i){const e=Af(i);t>=0&&t<256?this._asciiMap[t]=e:this._map.set(t,e)}get(t){return t>=0&&t<256?this._asciiMap[t]:this._map.get(t)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}}class If{constructor(){this._actual=new Of(0)}add(t){this._actual.set(t,1)}has(t){return this._actual.get(t)===1}clear(){return this._actual.clear()}}class _f{constructor(t,i,e){const s=new Uint8Array(t*i);for(let n=0,r=t*i;n<r;n++)s[n]=e;this._data=s,this.rows=t,this.cols=i}get(t,i){return this._data[t*this.cols+i]}set(t,i,e){this._data[t*this.cols+i]=e}}class Pf{constructor(t){let i=0,e=0;for(let s=0,n=t.length;s<n;s++){const[n,r,o]=t[s];r>i&&(i=r),n>e&&(e=n),o>e&&(e=o)}i++,e++;const s=new _f(e,i,0);for(let i=0,e=t.length;i<e;i++){const[e,n,r]=t[i];s.set(e,n,r)}this._states=s,this._maxCharCode=i}nextState(t,i){return i<0||i>=this._maxCharCode?0:this._states.get(t,i)}}let Nf=null,Bf=null;class $f{static _createLink(t,i,e,s,n){let r=n-1;do{const e=i.charCodeAt(r);if(t.get(e)!==2)break;r--}while(r>s);if(s>0){const t=i.charCodeAt(s-1),e=i.charCodeAt(r);(t===40&&e===41||t===91&&e===93||t===123&&e===125)&&r--}return{range:{startLineNumber:e,startColumn:s+1,endLineNumber:e,endColumn:r+2},url:i.substring(s,r+1)}}static computeLinks(t,i=function(){return Nf===null&&(Nf=new Pf([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),Nf}()){const e=function(){if(Bf===null){Bf=new Of(0);const t=` \t<>'"、。｡､，．：；‘〈「『〔（［｛｢｣｝］）〕』」〉’｀～…`;for(let i=0;i<t.length;i++)Bf.set(t.charCodeAt(i),1);const i=".,;:";for(let t=0;t<i.length;t++)Bf.set(i.charCodeAt(t),2)}return Bf}(),s=[];for(let n=1,r=t.getLineCount();n<=r;n++){const r=t.getLineContent(n),o=r.length;let h=0,c=0,l=0,a=1,u=!1,d=!1,f=!1,g=!1;for(;h<o;){let t=!1;const o=r.charCodeAt(h);if(a===13){let i;switch(o){case 40:u=!0,i=0;break;case 41:i=u?0:1;break;case 91:f=!0,d=!0,i=0;break;case 93:f=!1,i=d?0:1;break;case 123:g=!0,i=0;break;case 125:i=g?0:1;break;case 39:case 34:case 96:i=l===o?1:l===39||l===34||l===96?0:1;break;case 42:i=l===42?1:0;break;case 124:i=l===124?1:0;break;case 32:i=f?0:1;break;default:i=e.get(o)}i===1&&(s.push($f._createLink(e,r,n,c,h)),t=!0)}else if(a===12){let i;o===91?(d=!0,i=0):i=e.get(o),i===1?t=!0:a=13}else a=i.nextState(a,o),a===0&&(t=!0);t&&(a=1,u=!1,d=!1,g=!1,c=h+1,l=o),h++}a===13&&s.push($f._createLink(e,r,n,c,o))}return s}}class Wf{constructor(){this._defaultValueSet=[["true","false"],["True","False"],["Private","Public","Friend","ReadOnly","Partial","Protected","WriteOnly"],["public","protected","private"]]}navigateValueSet(t,i,e,s,n){if(t&&i){const e=this.doNavigateValueSet(i,n);if(e)return{range:t,value:e}}if(e&&s){const t=this.doNavigateValueSet(s,n);if(t)return{range:e,value:t}}return null}doNavigateValueSet(t,i){const e=this.numberReplace(t,i);return e!==null?e:this.textReplace(t,i)}numberReplace(t,i){const e=Math.pow(10,t.length-(t.lastIndexOf(".")+1));let s=Number(t);const n=parseFloat(t);return isNaN(s)||isNaN(n)||s!==n?null:s!==0||i?(s=Math.floor(s*e),s+=i?e:-e,String(s/e)):null}textReplace(t,i){return this.valueSetsReplace(this._defaultValueSet,t,i)}valueSetsReplace(t,i,e){let s=null;for(let n=0,r=t.length;s===null&&n<r;n++)s=this.valueSetReplace(t[n],i,e);return s}valueSetReplace(t,i,e){let s=t.indexOf(i);return s>=0?(s+=e?1:-1,s<0?s=t.length-1:s%=t.length,t[s]):null}}var jf,Hf;Wf.INSTANCE=new Wf;class Vf{constructor(t,i){this.uri=t,this.value=i}}class zf{constructor(t,i){if(this[jf]="ResourceMap",t instanceof zf)this.map=new Map(t.map),this.toKey=i??zf.defaultToKey;else if(function(t){return Array.isArray(t)}(t)){this.map=new Map,this.toKey=i??zf.defaultToKey;for(const[i,e]of t)this.set(i,e)}else this.map=new Map,this.toKey=t??zf.defaultToKey}set(t,i){return this.map.set(this.toKey(t),new Vf(t,i)),this}get(t){var i;return(i=this.map.get(this.toKey(t)))===null||i===void 0?void 0:i.value}has(t){return this.map.has(this.toKey(t))}get size(){return this.map.size}clear(){this.map.clear()}delete(t){return this.map.delete(this.toKey(t))}forEach(t,i){i!==void 0&&(t=t.bind(i));for(const[i,e]of this.map)t(e.value,e.uri,this)}*values(){for(const t of this.map.values())yield t.value}*keys(){for(const t of this.map.values())yield t.uri}*entries(){for(const t of this.map.values())yield[t.uri,t.value]}*[(jf=Symbol.toStringTag,Symbol.iterator)](){for(const[,t]of this.map)yield[t.uri,t.value]}}zf.defaultToKey=t=>t.toString();class Uf{constructor(){this[Hf]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var t;return(t=this._head)===null||t===void 0?void 0:t.value}get last(){var t;return(t=this._tail)===null||t===void 0?void 0:t.value}has(t){return this._map.has(t)}get(t,i=0){const e=this._map.get(t);if(e)return i!==0&&this.touch(e,i),e.value}set(t,i,e=0){let s=this._map.get(t);if(s)s.value=i,e!==0&&this.touch(s,e);else{switch(s={key:t,value:i,next:void 0,previous:void 0},e){case 0:case 2:default:this.addItemLast(s);break;case 1:this.addItemFirst(s)}this._map.set(t,s),this._size++}return this}delete(t){return!!this.remove(t)}remove(t){const i=this._map.get(t);if(i)return this._map.delete(t),this.removeItem(i),this._size--,i.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const t=this._head;return this._map.delete(t.key),this.removeItem(t),this._size--,t.value}forEach(t,i){const e=this._state;let s=this._head;for(;s;){if(i?t.bind(i)(s.value,s.key,this):t(s.value,s.key,this),this._state!==e)throw new Error("LinkedMap got modified during iteration.");s=s.next}}keys(){const t=this,i=this._state;let e=this._head;const s={[Symbol.iterator]:()=>s,next(){if(t._state!==i)throw new Error("LinkedMap got modified during iteration.");if(e){const t={value:e.key,done:!1};return e=e.next,t}return{value:void 0,done:!0}}};return s}values(){const t=this,i=this._state;let e=this._head;const s={[Symbol.iterator]:()=>s,next(){if(t._state!==i)throw new Error("LinkedMap got modified during iteration.");if(e){const t={value:e.value,done:!1};return e=e.next,t}return{value:void 0,done:!0}}};return s}entries(){const t=this,i=this._state;let e=this._head;const s={[Symbol.iterator]:()=>s,next(){if(t._state!==i)throw new Error("LinkedMap got modified during iteration.");if(e){const t={value:[e.key,e.value],done:!1};return e=e.next,t}return{value:void 0,done:!0}}};return s}[(Hf=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(t){if(t>=this.size)return;if(t===0)return void this.clear();let i=this._head,e=this.size;for(;i&&e>t;)this._map.delete(i.key),i=i.next,e--;this._head=i,this._size=e,i&&(i.previous=void 0),this._state++}addItemFirst(t){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");t.next=this._head,this._head.previous=t}else this._tail=t;this._head=t,this._state++}addItemLast(t){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");t.previous=this._tail,this._tail.next=t}else this._head=t;this._tail=t,this._state++}removeItem(t){if(t===this._head&&t===this._tail)this._head=void 0,this._tail=void 0;else if(t===this._head){if(!t.next)throw new Error("Invalid list");t.next.previous=void 0,this._head=t.next}else if(t===this._tail){if(!t.previous)throw new Error("Invalid list");t.previous.next=void 0,this._tail=t.previous}else{const i=t.next,e=t.previous;if(!i||!e)throw new Error("Invalid list");i.previous=e,e.next=i}t.next=void 0,t.previous=void 0,this._state++}touch(t,i){if(!this._head||!this._tail)throw new Error("Invalid list");if(i===1||i===2){if(i===1){if(t===this._head)return;const i=t.next,e=t.previous;t===this._tail?(e.next=void 0,this._tail=e):(i.previous=e,e.next=i),t.previous=void 0,t.next=this._head,this._head.previous=t,this._head=t,this._state++}else if(i===2){if(t===this._tail)return;const i=t.next,e=t.previous;t===this._head?(i.previous=void 0,this._head=i):(i.previous=e,e.next=i),t.next=void 0,t.previous=this._tail,this._tail.next=t,this._tail=t,this._state++}}}toJSON(){const t=[];return this.forEach(((i,e)=>{t.push([e,i])})),t}fromJSON(t){this.clear();for(const[i,e]of t)this.set(i,e)}}class Kf extends Uf{constructor(t,i=1){super(),this._limit=t,this._ratio=Math.min(Math.max(0,i),1)}get limit(){return this._limit}set limit(t){this._limit=t,this.checkTrim()}get(t,i=2){return super.get(t,i)}peek(t){return super.get(t,0)}set(t,i){return super.set(t,i,2),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}class qf{constructor(t){if(this._m1=new Map,this._m2=new Map,t)for(const[i,e]of t)this.set(i,e)}clear(){this._m1.clear(),this._m2.clear()}set(t,i){this._m1.set(t,i),this._m2.set(i,t)}get(t){return this._m1.get(t)}getKey(t){return this._m2.get(t)}delete(t){const i=this._m1.get(t);return i!==void 0&&(this._m1.delete(t),this._m2.delete(i),!0)}keys(){return this._m1.keys()}values(){return this._m1.values()}}class Gf{constructor(){this.map=new Map}add(t,i){let e=this.map.get(t);e||(e=new Set,this.map.set(t,e)),e.add(i)}delete(t,i){const e=this.map.get(t);e&&(e.delete(i),e.size===0&&this.map.delete(t))}forEach(t,i){const e=this.map.get(t);e&&e.forEach(i)}get(t){return this.map.get(t)||new Set}}class Zf extends Of{constructor(t,i){super(0),this._segmenter=null,this._cachedLine=null,this._cachedSegments=[],this.intlSegmenterLocales=i,this.intlSegmenterLocales.length>0?this._segmenter=new Intl.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this._segmenter=null;for(let i=0,e=t.length;i<e;i++)this.set(t.charCodeAt(i),2);this.set(32,1),this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(t,i){let e=null;for(const s of this._getIntlSegmenterWordsOnLine(t)){if(s.index>i)break;e=s}return e}findNextIntlWordAtOrAfterOffset(t,i){for(const e of this._getIntlSegmenterWordsOnLine(t))if(!(e.index<i))return e;return null}_getIntlSegmenterWordsOnLine(t){return this._segmenter?(this._cachedLine===t||(this._cachedLine=t,this._cachedSegments=this._filterWordSegments(this._segmenter.segment(t))),this._cachedSegments):[]}_filterWordSegments(t){const i=[];for(const e of t)this._isWordLike(e)&&i.push(e);return i}_isWordLike(t){return!!t.isWordLike}}const Jf=new Kf(10);function Qf(t,i){const e=`${t}/${i.join(",")}`;let s=Jf.get(e);return s||(s=new Zf(t,i),Jf.set(e,s)),s}var Yf,Xf,tg;(function(t){t[t.Left=1]="Left",t[t.Center=2]="Center",t[t.Right=4]="Right",t[t.Full=7]="Full"})(Yf||(Yf={})),function(t){t[t.Left=1]="Left",t[t.Center=2]="Center",t[t.Right=3]="Right"}(Xf||(Xf={})),function(t){t[t.Both=0]="Both",t[t.Right=1]="Right",t[t.Left=2]="Left",t[t.None=3]="None"}(tg||(tg={}));class ig{get originalIndentSize(){return this._indentSizeIsTabSize?"tabSize":this.indentSize}constructor(t){this._textModelResolvedOptionsBrand=void 0,this.tabSize=Math.max(1,0|t.tabSize),t.indentSize==="tabSize"?(this.indentSize=this.tabSize,this._indentSizeIsTabSize=!0):(this.indentSize=Math.max(1,0|t.indentSize),this._indentSizeIsTabSize=!1),this.insertSpaces=!!t.insertSpaces,this.defaultEOL=0|t.defaultEOL,this.trimAutoWhitespace=!!t.trimAutoWhitespace,this.bracketPairColorizationOptions=t.bracketPairColorizationOptions}equals(t){return this.tabSize===t.tabSize&&this._indentSizeIsTabSize===t._indentSizeIsTabSize&&this.indentSize===t.indentSize&&this.insertSpaces===t.insertSpaces&&this.defaultEOL===t.defaultEOL&&this.trimAutoWhitespace===t.trimAutoWhitespace&&J(this.bracketPairColorizationOptions,t.bracketPairColorizationOptions)}createChangeEvent(t){return{tabSize:this.tabSize!==t.tabSize,indentSize:this.indentSize!==t.indentSize,insertSpaces:this.insertSpaces!==t.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==t.trimAutoWhitespace}}}class eg{constructor(t,i){this._findMatchBrand=void 0,this.range=t,this.matches=i}}class sg{constructor(t,i,e,s,n,r){this.identifier=t,this.range=i,this.text=e,this.forceMoveMarkers=s,this.isAutoWhitespaceEdit=n,this._isTracked=r}}class ng{constructor(t,i,e){this.regex=t,this.wordSeparators=i,this.simpleSearch=e}}class rg{constructor(t,i,e){this.reverseEdits=t,this.changes=i,this.trimAutoWhitespaceLineNumbers=e}}function og(t){return!t.isTooLargeForSyncing()&&!t.isForSimpleWidget}class hg{constructor(t,i,e,s){this.searchString=t,this.isRegex=i,this.matchCase=e,this.wordSeparators=s}parseSearchRequest(){if(this.searchString==="")return null;let t;t=this.isRegex?function(t){if(!t||t.length===0)return!1;for(let i=0,e=t.length;i<e;i++){const s=t.charCodeAt(i);if(s===10)return!0;if(s===92){if(i++,i>=e)break;const s=t.charCodeAt(i);if(s===110||s===114||s===87)return!0}}return!1}(this.searchString):this.searchString.indexOf(`\n`)>=0;let i=null;try{i=Yn(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:t,global:!0,unicode:!0})}catch{return null}if(!i)return null;let e=!this.isRegex&&!t;return e&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(e=this.matchCase),new ng(i,this.wordSeparators?Qf(this.wordSeparators,[]):null,e?this.searchString:null)}}function cg(t,i,e){if(!e)return new eg(t,null);const s=[];for(let t=0,e=i.length;t<e;t++)s[t]=i[t];return new eg(t,s)}class lg{constructor(t){const i=[];let e=0;for(let s=0,n=t.length;s<n;s++)t.charCodeAt(s)===10&&(i[e++]=s);this._lineFeedsOffsets=i}findLineFeedCountBeforeOffset(t){const i=this._lineFeedsOffsets;let e=0,s=i.length-1;if(s===-1||t<=i[0])return 0;for(;e<s;){const n=e+((s-e)/2|0);i[n]>=t?s=n-1:i[n+1]>=t?(e=n,s=n):e=n+1}return e+1}}class ag{static findMatches(t,i,e,s,n){const r=i.parseSearchRequest();return r?r.regex.multiline?this._doFindMatchesMultiline(t,e,new dg(r.wordSeparators,r.regex),s,n):this._doFindMatchesLineByLine(t,e,r,s,n):[]}static _getMultilineMatchRange(t,i,e,s,n,r){let o,h,c=0;if(s?(c=s.findLineFeedCountBeforeOffset(n),o=i+n+c):o=i+n,s){const t=s.findLineFeedCountBeforeOffset(n+r.length)-c;h=o+r.length+t}else h=o+r.length;const l=t.getPositionAt(o),a=t.getPositionAt(h);return new Cs(l.lineNumber,l.column,a.lineNumber,a.column)}static _doFindMatchesMultiline(t,i,e,s,n){const r=t.getOffsetAt(i.getStartPosition()),o=t.getValueInRange(i,1),h=t.getEOL()===`\r\n`?new lg(o):null,c=[];let l,a=0;for(e.reset(0);l=e.next(o);)if(c[a++]=cg(this._getMultilineMatchRange(t,r,o,h,l.index,l[0]),l,s),a>=n)return c;return c}static _doFindMatchesLineByLine(t,i,e,s,n){const r=[];let o=0;if(i.startLineNumber===i.endLineNumber){const h=t.getLineContent(i.startLineNumber).substring(i.startColumn-1,i.endColumn-1);return o=this._findMatchesInLine(e,h,i.startLineNumber,i.startColumn-1,o,r,s,n),r}const h=t.getLineContent(i.startLineNumber).substring(i.startColumn-1);o=this._findMatchesInLine(e,h,i.startLineNumber,i.startColumn-1,o,r,s,n);for(let h=i.startLineNumber+1;h<i.endLineNumber&&o<n;h++)o=this._findMatchesInLine(e,t.getLineContent(h),h,0,o,r,s,n);if(o<n){const h=t.getLineContent(i.endLineNumber).substring(0,i.endColumn-1);o=this._findMatchesInLine(e,h,i.endLineNumber,0,o,r,s,n)}return r}static _findMatchesInLine(t,i,e,s,n,r,o,h){const c=t.wordSeparators;if(!o&&t.simpleSearch){const o=t.simpleSearch,l=o.length,a=i.length;let u=-l;for(;(u=i.indexOf(o,u+l))!==-1;)if((!c||ug(c,i,a,u,l))&&(r[n++]=new eg(new Cs(e,u+1+s,e,u+1+l+s),null),n>=h))return n;return n}const l=new dg(t.wordSeparators,t.regex);let a;l.reset(0);do{if(a=l.next(i),a&&(r[n++]=cg(new Cs(e,a.index+1+s,e,a.index+1+a[0].length+s),a,o),n>=h))return n}while(a);return n}static findNextMatch(t,i,e,s){const n=i.parseSearchRequest();if(!n)return null;const r=new dg(n.wordSeparators,n.regex);return n.regex.multiline?this._doFindNextMatchMultiline(t,e,r,s):this._doFindNextMatchLineByLine(t,e,r,s)}static _doFindNextMatchMultiline(t,i,e,s){const n=new ks(i.lineNumber,1),r=t.getOffsetAt(n),o=t.getLineCount(),h=t.getValueInRange(new Cs(n.lineNumber,n.column,o,t.getLineMaxColumn(o)),1),c=t.getEOL()===`\r\n`?new lg(h):null;e.reset(i.column-1);const l=e.next(h);return l?cg(this._getMultilineMatchRange(t,r,h,c,l.index,l[0]),l,s):i.lineNumber!==1||i.column!==1?this._doFindNextMatchMultiline(t,new ks(1,1),e,s):null}static _doFindNextMatchLineByLine(t,i,e,s){const n=t.getLineCount(),r=i.lineNumber,o=t.getLineContent(r),h=this._findFirstMatchInLine(e,o,r,i.column,s);if(h)return h;for(let i=1;i<=n;i++){const o=(r+i-1)%n,h=t.getLineContent(o+1),c=this._findFirstMatchInLine(e,h,o+1,1,s);if(c)return c}return null}static _findFirstMatchInLine(t,i,e,s,n){t.reset(s-1);const r=t.next(i);return r?cg(new Cs(e,r.index+1,e,r.index+1+r[0].length),r,n):null}static findPreviousMatch(t,i,e,s){const n=i.parseSearchRequest();if(!n)return null;const r=new dg(n.wordSeparators,n.regex);return n.regex.multiline?this._doFindPreviousMatchMultiline(t,e,r,s):this._doFindPreviousMatchLineByLine(t,e,r,s)}static _doFindPreviousMatchMultiline(t,i,e,s){const n=this._doFindMatchesMultiline(t,new Cs(1,1,i.lineNumber,i.column),e,s,9990);if(n.length>0)return n[n.length-1];const r=t.getLineCount();return i.lineNumber!==r||i.column!==t.getLineMaxColumn(r)?this._doFindPreviousMatchMultiline(t,new ks(r,t.getLineMaxColumn(r)),e,s):null}static _doFindPreviousMatchLineByLine(t,i,e,s){const n=t.getLineCount(),r=i.lineNumber,o=t.getLineContent(r).substring(0,i.column-1),h=this._findLastMatchInLine(e,o,r,s);if(h)return h;for(let i=1;i<=n;i++){const o=(n+r-i-1)%n,h=t.getLineContent(o+1),c=this._findLastMatchInLine(e,h,o+1,s);if(c)return c}return null}static _findLastMatchInLine(t,i,e,s){let n,r=null;for(t.reset(0);n=t.next(i);)r=cg(new Cs(e,n.index+1,e,n.index+1+n[0].length),n,s);return r}}function ug(t,i,e,s,n){return function(t,i,e,s,n){if(s===0)return!0;const r=i.charCodeAt(s-1);if(t.get(r)!==0||r===13||r===10)return!0;if(n>0){const e=i.charCodeAt(s);if(t.get(e)!==0)return!0}return!1}(t,i,0,s,n)&&function(t,i,e,s,n){if(s+n===e)return!0;const r=i.charCodeAt(s+n);if(t.get(r)!==0||r===13||r===10)return!0;if(n>0){const e=i.charCodeAt(s+n-1);if(t.get(e)!==0)return!0}return!1}(t,i,e,s,n)}class dg{constructor(t,i){this._wordSeparators=t,this._searchRegex=i,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(t){this._searchRegex.lastIndex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(t){const i=t.length;let e;do{if(this._prevMatchStartIndex+this._prevMatchLength===i||(e=this._searchRegex.exec(t),!e))return null;const s=e.index,n=e[0].length;if(s===this._prevMatchStartIndex&&n===this._prevMatchLength){if(n===0){wr(t,i,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=s,this._prevMatchLength=n,!this._wordSeparators||ug(this._wordSeparators,t,i,s,n))return e}while(e);return null}}class fg{static computeUnicodeHighlights(t,i,e){const s=e?e.startLineNumber:1,n=e?e.endLineNumber:t.getLineCount(),r=new gg(i),o=r.getCandidateCodePoints();let h;h=o==="allNonBasicAscii"?new RegExp("[^\\t\\n\\r\\x20-\\x7E]","g"):new RegExp(`[${Gn(Array.from(o).map((t=>String.fromCodePoint(t))).join(""))}]`,"g");const c=new dg(null,h),l=[];let a,u=!1,d=0,f=0,g=0;t:for(let i=s,e=n;i<=e;i++){const e=t.getLineContent(i),s=e.length;c.reset(0);do{if(a=c.next(e),a){let t=a.index,n=a.index+a[0].length;t>0&&gr(e.charCodeAt(t-1))&&t--,n+1<s&&gr(e.charCodeAt(n-1))&&n++;const o=e.substring(t,n);let h=qt(t+1,zt,e,0);h&&h.endColumn<=t+1&&(h=null);const c=r.shouldHighlightNonBasicASCII(o,h?h.word:null);if(c!==0){if(c===3?d++:c===2?f++:c===1?g++:$a(),l.length>=1e3){u=!0;break t}l.push(new Cs(i,t+1,i,n+1))}}}while(a)}return{ranges:l,hasMore:u,ambiguousCharacterCount:d,invisibleCharacterCount:f,nonBasicAsciiCharacterCount:g}}static computeUnicodeHighlightReason(t,i){const e=new gg(i);switch(e.shouldHighlightNonBasicASCII(t,null)){case 0:return null;case 2:return{kind:1};case 3:{const s=t.codePointAt(0),n=e.ambiguousCharacters.getPrimaryConfusable(s),r=Nr.getLocales().filter((t=>!Nr.getInstance(new Set([...i.allowedLocales,t])).isAmbiguous(s)));return{kind:0,confusableWith:String.fromCodePoint(n),notAmbiguousInLocales:r}}case 1:return{kind:2}}}}class gg{constructor(t){this.options=t,this.allowedCodePoints=new Set(t.allowedCodePoints),this.ambiguousCharacters=Nr.getInstance(new Set(t.allowedLocales))}getCandidateCodePoints(){if(this.options.nonBasicASCII)return"allNonBasicAscii";const t=new Set;if(this.options.invisibleCharacters)for(const i of Br.codePoints)pg(String.fromCodePoint(i))||t.add(i);if(this.options.ambiguousCharacters)for(const i of this.ambiguousCharacters.getConfusableCodePoints())t.add(i);for(const i of this.allowedCodePoints)t.delete(i);return t}shouldHighlightNonBasicASCII(t,i){const e=t.codePointAt(0);if(this.allowedCodePoints.has(e))return 0;if(this.options.nonBasicASCII)return 1;let s=!1,n=!1;if(i)for(const t of i){const i=t.codePointAt(0),e=Dr(t);s=s||e,e||this.ambiguousCharacters.isAmbiguous(i)||Br.isInvisibleCharacter(i)||(n=!0)}return!s&&n?0:this.options.invisibleCharacters&&!pg(t)&&Br.isInvisibleCharacter(e)?2:this.options.ambiguousCharacters&&this.ambiguousCharacters.isAmbiguous(e)?3:0}}function pg(t){return t===" "||t===`\n`||t==="\t"}class mg{constructor(t,i,e){this.changes=t,this.moves=i,this.hitTimeout=e}}class wg{constructor(t,i){this.lineRangeMapping=t,this.changes=i}}class vg{static addRange(t,i){let e=0;for(;e<i.length&&i[e].endExclusive<t.start;)e++;let s=e;for(;s<i.length&&i[s].start<=t.endExclusive;)s++;if(e===s)i.splice(e,0,t);else{const n=Math.min(t.start,i[e].start),r=Math.max(t.endExclusive,i[s-1].endExclusive);i.splice(e,s-e,new vg(n,r))}}static tryCreate(t,i){if(!(t>i))return new vg(t,i)}static ofLength(t){return new vg(0,t)}static ofStartAndLength(t,i){return new vg(t,t+i)}constructor(t,i){if(this.start=t,this.endExclusive=i,t>i)throw new zi(`Invalid range: ${this.toString()}`)}get isEmpty(){return this.start===this.endExclusive}delta(t){return new vg(this.start+t,this.endExclusive+t)}deltaStart(t){return new vg(this.start+t,this.endExclusive)}deltaEnd(t){return new vg(this.start,this.endExclusive+t)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}contains(t){return this.start<=t&&t<this.endExclusive}join(t){return new vg(Math.min(this.start,t.start),Math.max(this.endExclusive,t.endExclusive))}intersect(t){const i=Math.max(this.start,t.start),e=Math.min(this.endExclusive,t.endExclusive);if(i<=e)return new vg(i,e)}intersects(t){return Math.max(this.start,t.start)<Math.min(this.endExclusive,t.endExclusive)}isBefore(t){return this.endExclusive<=t.start}isAfter(t){return this.start>=t.endExclusive}slice(t){return t.slice(this.start,this.endExclusive)}substring(t){return t.substring(this.start,this.endExclusive)}clip(t){if(this.isEmpty)throw new zi(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,t))}clipCyclic(t){if(this.isEmpty)throw new zi(`Invalid clipping range: ${this.toString()}`);return t<this.start?this.endExclusive-(this.start-t)%this.length:t>=this.endExclusive?this.start+(t-this.start)%this.length:t}forEach(t){for(let i=this.start;i<this.endExclusive;i++)t(i)}}class bg{constructor(){this._sortedRanges=[]}addRange(t){let i=0;for(;i<this._sortedRanges.length&&this._sortedRanges[i].endExclusive<t.start;)i++;let e=i;for(;e<this._sortedRanges.length&&this._sortedRanges[e].start<=t.endExclusive;)e++;if(i===e)this._sortedRanges.splice(i,0,t);else{const s=Math.min(t.start,this._sortedRanges[i].start),n=Math.max(t.endExclusive,this._sortedRanges[e-1].endExclusive);this._sortedRanges.splice(i,e-i,new vg(s,n))}}toString(){return this._sortedRanges.map((t=>t.toString())).join(", ")}intersectsStrict(t){let i=0;for(;i<this._sortedRanges.length&&this._sortedRanges[i].endExclusive<=t.start;)i++;return i<this._sortedRanges.length&&this._sortedRanges[i].start<t.endExclusive}intersectWithRange(t){const i=new bg;for(const e of this._sortedRanges){const s=e.intersect(t);s&&i.addRange(s)}return i}intersectWithRangeLength(t){return this.intersectWithRange(t).length}get length(){return this._sortedRanges.reduce(((t,i)=>t+i.length),0)}}function yg(t,i,e){const s=function(t,i,e=t.length-1){for(let s=e;s>=0;s--)if(i(t[s]))return s;return-1}(t,i);if(s!==-1)return t[s]}function kg(t,i){const e=Cg(t,i);return e===-1?void 0:t[e]}function Cg(t,i,e=0,s=t.length){let n=e,r=s;for(;n<r;){const e=Math.floor((n+r)/2);i(t[e])?n=e+1:r=e}return n-1}function Sg(t,i,e=0,s=t.length){let n=e,r=s;for(;n<r;){const e=Math.floor((n+r)/2);i(t[e])?r=e:n=e+1}return n}class xg{constructor(t){this._array=t,this._findLastMonotonousLastIdx=0}findLastMonotonous(t){if(xg.assertInvariants){if(this._prevFindLastPredicate){for(const i of this._array)if(this._prevFindLastPredicate(i)&&!t(i))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=t}const i=Cg(this._array,t,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=i+1,i===-1?void 0:this._array[i]}}function Dg(t,i){if(t.length===0)return;let e=t[0];for(let s=1;s<t.length;s++){const n=t[s];i(n,e)>0&&(e=n)}return e}function Eg(t,i){if(t.length===0)return-1;let e=0;for(let s=1;s<t.length;s++)i(t[s],t[e])>0&&(e=s);return e}xg.assertInvariants=!1;let Ag=class t{static fromRangeInclusive(i){return new t(i.startLineNumber,i.endLineNumber+1)}static joinMany(t){if(t.length===0)return[];let i=new Mg(t[0].slice());for(let e=1;e<t.length;e++)i=i.getUnion(new Mg(t[e].slice()));return i.ranges}static join(i){if(i.length===0)throw new zi("lineRanges cannot be empty");let e=i[0].startLineNumber,s=i[0].endLineNumberExclusive;for(let t=1;t<i.length;t++)e=Math.min(e,i[t].startLineNumber),s=Math.max(s,i[t].endLineNumberExclusive);return new t(e,s)}static ofLength(i,e){return new t(i,i+e)}static deserialize(i){return new t(i[0],i[1])}constructor(t,i){if(t>i)throw new zi(`startLineNumber ${t} cannot be after endLineNumberExclusive ${i}`);this.startLineNumber=t,this.endLineNumberExclusive=i}contains(t){return this.startLineNumber<=t&&t<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(i){return new t(this.startLineNumber+i,this.endLineNumberExclusive+i)}deltaLength(i){return new t(this.startLineNumber,this.endLineNumberExclusive+i)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(i){return new t(Math.min(this.startLineNumber,i.startLineNumber),Math.max(this.endLineNumberExclusive,i.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(i){const e=Math.max(this.startLineNumber,i.startLineNumber),s=Math.min(this.endLineNumberExclusive,i.endLineNumberExclusive);if(e<=s)return new t(e,s)}intersectsStrict(t){return this.startLineNumber<t.endLineNumberExclusive&&t.startLineNumber<this.endLineNumberExclusive}overlapOrTouch(t){return this.startLineNumber<=t.endLineNumberExclusive&&t.startLineNumber<=this.endLineNumberExclusive}equals(t){return this.startLineNumber===t.startLineNumber&&this.endLineNumberExclusive===t.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new Cs(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new Cs(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(t){const i=[];for(let e=this.startLineNumber;e<this.endLineNumberExclusive;e++)i.push(t(e));return i}forEach(t){for(let i=this.startLineNumber;i<this.endLineNumberExclusive;i++)t(i)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}includes(t){return this.startLineNumber<=t&&t<this.endLineNumberExclusive}toOffsetRange(){return new vg(this.startLineNumber-1,this.endLineNumberExclusive-1)}};class Mg{constructor(t=[]){this._normalizedRanges=t}get ranges(){return this._normalizedRanges}addRange(t){if(t.length===0)return;const i=Sg(this._normalizedRanges,(i=>i.endLineNumberExclusive>=t.startLineNumber)),e=Cg(this._normalizedRanges,(i=>i.startLineNumber<=t.endLineNumberExclusive))+1;if(i===e)this._normalizedRanges.splice(i,0,t);else if(i===e-1){const e=this._normalizedRanges[i];this._normalizedRanges[i]=e.join(t)}else{const s=this._normalizedRanges[i].join(this._normalizedRanges[e-1]).join(t);this._normalizedRanges.splice(i,e-i,s)}}contains(t){const i=kg(this._normalizedRanges,(i=>i.startLineNumber<=t));return!!i&&i.endLineNumberExclusive>t}intersects(t){const i=kg(this._normalizedRanges,(i=>i.startLineNumber<t.endLineNumberExclusive));return!!i&&i.endLineNumberExclusive>t.startLineNumber}getUnion(t){if(this._normalizedRanges.length===0)return t;if(t._normalizedRanges.length===0)return this;const i=[];let e=0,s=0,n=null;for(;e<this._normalizedRanges.length||s<t._normalizedRanges.length;){let r=null;if(e<this._normalizedRanges.length&&s<t._normalizedRanges.length){const i=this._normalizedRanges[e],n=t._normalizedRanges[s];i.startLineNumber<n.startLineNumber?(r=i,e++):(r=n,s++)}else e<this._normalizedRanges.length?(r=this._normalizedRanges[e],e++):(r=t._normalizedRanges[s],s++);n===null?n=r:n.endLineNumberExclusive>=r.startLineNumber?n=new Ag(n.startLineNumber,Math.max(n.endLineNumberExclusive,r.endLineNumberExclusive)):(i.push(n),n=r)}return n!==null&&i.push(n),new Mg(i)}subtractFrom(t){const i=Sg(this._normalizedRanges,(i=>i.endLineNumberExclusive>=t.startLineNumber)),e=Cg(this._normalizedRanges,(i=>i.startLineNumber<=t.endLineNumberExclusive))+1;if(i===e)return new Mg([t]);const s=[];let n=t.startLineNumber;for(let t=i;t<e;t++){const i=this._normalizedRanges[t];i.startLineNumber>n&&s.push(new Ag(n,i.startLineNumber)),n=i.endLineNumberExclusive}return n<t.endLineNumberExclusive&&s.push(new Ag(n,t.endLineNumberExclusive)),new Mg(s)}toString(){return this._normalizedRanges.map((t=>t.toString())).join(", ")}getIntersection(t){const i=[];let e=0,s=0;for(;e<this._normalizedRanges.length&&s<t._normalizedRanges.length;){const n=this._normalizedRanges[e],r=t._normalizedRanges[s],o=n.intersect(r);o&&!o.isEmpty&&i.push(o),n.endLineNumberExclusive<r.endLineNumberExclusive?e++:s++}return new Mg(i)}getWithDelta(t){return new Mg(this._normalizedRanges.map((i=>i.delta(t))))}}class Lg{static inverse(t,i,e){const s=[];let n=1,r=1;for(const i of t){const t=new Lg(new Ag(n,i.original.startLineNumber),new Ag(r,i.modified.startLineNumber));t.modified.isEmpty||s.push(t),n=i.original.endLineNumberExclusive,r=i.modified.endLineNumberExclusive}const o=new Lg(new Ag(n,i+1),new Ag(r,e+1));return o.modified.isEmpty||s.push(o),s}static clip(t,i,e){const s=[];for(const n of t){const t=n.original.intersect(i),r=n.modified.intersect(e);t&&!t.isEmpty&&r&&!r.isEmpty&&s.push(new Lg(t,r))}return s}constructor(t,i){this.original=t,this.modified=i}toString(){return`{${this.original.toString()}->${this.modified.toString()}}`}flip(){return new Lg(this.modified,this.original)}join(t){return new Lg(this.original.join(t.original),this.modified.join(t.modified))}}class Fg extends Lg{static fromRangeMappings(t){const i=Ag.join(t.map((t=>Ag.fromRangeInclusive(t.originalRange)))),e=Ag.join(t.map((t=>Ag.fromRangeInclusive(t.modifiedRange))));return new Fg(i,e,t)}constructor(t,i,e){super(t,i),this.innerChanges=e}flip(){var t;return new Fg(this.modified,this.original,(t=this.innerChanges)===null||t===void 0?void 0:t.map((t=>t.flip())))}withInnerChangesFromLineRanges(){return new Fg(this.original,this.modified,[new Tg(this.original.toExclusiveRange(),this.modified.toExclusiveRange())])}}class Tg{constructor(t,i){this.originalRange=t,this.modifiedRange=i}toString(){return`{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`}flip(){return new Tg(this.modifiedRange,this.originalRange)}}class Rg{computeDiff(t,i,e){var s;const n=new Bg(t,i,{maxComputationTime:e.maxComputationTimeMs,shouldIgnoreTrimWhitespace:e.ignoreTrimWhitespace,shouldComputeCharChanges:!0,shouldMakePrettyDiff:!0,shouldPostProcessCharChanges:!0}).computeDiff(),r=[];let o=null;for(const t of n.changes){let i,e;i=t.originalEndLineNumber===0?new Ag(t.originalStartLineNumber+1,t.originalStartLineNumber+1):new Ag(t.originalStartLineNumber,t.originalEndLineNumber+1),e=t.modifiedEndLineNumber===0?new Ag(t.modifiedStartLineNumber+1,t.modifiedStartLineNumber+1):new Ag(t.modifiedStartLineNumber,t.modifiedEndLineNumber+1);let n=new Fg(i,e,(s=t.charChanges)===null||s===void 0?void 0:s.map((t=>new Tg(new Cs(t.originalStartLineNumber,t.originalStartColumn,t.originalEndLineNumber,t.originalEndColumn),new Cs(t.modifiedStartLineNumber,t.modifiedStartColumn,t.modifiedEndLineNumber,t.modifiedEndColumn)))));o&&(o.modified.endLineNumberExclusive!==n.modified.startLineNumber&&o.original.endLineNumberExclusive!==n.original.startLineNumber||(n=new Fg(o.original.join(n.original),o.modified.join(n.modified),o.innerChanges&&n.innerChanges?o.innerChanges.concat(n.innerChanges):void 0),r.pop())),r.push(n),o=n}return ja((()=>Ha(r,((t,i)=>i.original.startLineNumber-t.original.endLineNumberExclusive==i.modified.startLineNumber-t.modified.endLineNumberExclusive&&t.original.endLineNumberExclusive<i.original.startLineNumber&&t.modified.endLineNumberExclusive<i.modified.startLineNumber)))),new mg(r,[],n.quitEarly)}}function Og(t,i,e,s){return new Ef(t,i,e).ComputeDiff(s)}let Ig=class{constructor(t){const i=[],e=[];for(let s=0,n=t.length;s<n;s++)i[s]=$g(t[s],1),e[s]=Wg(t[s],1);this.lines=t,this._startColumns=i,this._endColumns=e}getElements(){const t=[];for(let i=0,e=this.lines.length;i<e;i++)t[i]=this.lines[i].substring(this._startColumns[i]-1,this._endColumns[i]-1);return t}getStrictElement(t){return this.lines[t]}getStartLineNumber(t){return t+1}getEndLineNumber(t){return t+1}createCharSequence(t,i,e){const s=[],n=[],r=[];let o=0;for(let h=i;h<=e;h++){const i=this.lines[h],c=t?this._startColumns[h]:1,l=t?this._endColumns[h]:i.length+1;for(let t=c;t<l;t++)s[o]=i.charCodeAt(t-1),n[o]=h+1,r[o]=t,o++;!t&&h<e&&(s[o]=10,n[o]=h+1,r[o]=i.length+1,o++)}return new _g(s,n,r)}};class _g{constructor(t,i,e){this._charCodes=t,this._lineNumbers=i,this._columns=e}toString(){return"["+this._charCodes.map(((t,i)=>(t===10?"\\n":String.fromCharCode(t))+`-(${this._lineNumbers[i]},${this._columns[i]})`)).join(", ")+"]"}_assertIndex(t,i){if(t<0||t>=i.length)throw new Error("Illegal index")}getElements(){return this._charCodes}getStartLineNumber(t){return t>0&&t===this._lineNumbers.length?this.getEndLineNumber(t-1):(this._assertIndex(t,this._lineNumbers),this._lineNumbers[t])}getEndLineNumber(t){return t===-1?this.getStartLineNumber(t+1):(this._assertIndex(t,this._lineNumbers),this._charCodes[t]===10?this._lineNumbers[t]+1:this._lineNumbers[t])}getStartColumn(t){return t>0&&t===this._columns.length?this.getEndColumn(t-1):(this._assertIndex(t,this._columns),this._columns[t])}getEndColumn(t){return t===-1?this.getStartColumn(t+1):(this._assertIndex(t,this._columns),this._charCodes[t]===10?1:this._columns[t]+1)}}class Pg{constructor(t,i,e,s,n,r,o,h){this.originalStartLineNumber=t,this.originalStartColumn=i,this.originalEndLineNumber=e,this.originalEndColumn=s,this.modifiedStartLineNumber=n,this.modifiedStartColumn=r,this.modifiedEndLineNumber=o,this.modifiedEndColumn=h}static createFromDiffChange(t,i,e){const s=i.getStartLineNumber(t.originalStart),n=i.getStartColumn(t.originalStart),r=i.getEndLineNumber(t.originalStart+t.originalLength-1),o=i.getEndColumn(t.originalStart+t.originalLength-1),h=e.getStartLineNumber(t.modifiedStart),c=e.getStartColumn(t.modifiedStart),l=e.getEndLineNumber(t.modifiedStart+t.modifiedLength-1),a=e.getEndColumn(t.modifiedStart+t.modifiedLength-1);return new Pg(s,n,r,o,h,c,l,a)}}class Ng{constructor(t,i,e,s,n){this.originalStartLineNumber=t,this.originalEndLineNumber=i,this.modifiedStartLineNumber=e,this.modifiedEndLineNumber=s,this.charChanges=n}static createFromDiffResult(t,i,e,s,n,r,o){let h,c,l,a,u;if(i.originalLength===0?(h=e.getStartLineNumber(i.originalStart)-1,c=0):(h=e.getStartLineNumber(i.originalStart),c=e.getEndLineNumber(i.originalStart+i.originalLength-1)),i.modifiedLength===0?(l=s.getStartLineNumber(i.modifiedStart)-1,a=0):(l=s.getStartLineNumber(i.modifiedStart),a=s.getEndLineNumber(i.modifiedStart+i.modifiedLength-1)),r&&i.originalLength>0&&i.originalLength<20&&i.modifiedLength>0&&i.modifiedLength<20&&n()){const r=e.createCharSequence(t,i.originalStart,i.originalStart+i.originalLength-1),h=s.createCharSequence(t,i.modifiedStart,i.modifiedStart+i.modifiedLength-1);if(r.getElements().length>0&&h.getElements().length>0){let t=Og(r,h,n,!0).changes;o&&(t=function(t){if(t.length<=1)return t;const i=[t[0]];let e=i[0];for(let s=1,n=t.length;s<n;s++){const n=t[s],r=n.originalStart-(e.originalStart+e.originalLength),o=n.modifiedStart-(e.modifiedStart+e.modifiedLength);Math.min(r,o)<3?(e.originalLength=n.originalStart+n.originalLength-e.originalStart,e.modifiedLength=n.modifiedStart+n.modifiedLength-e.modifiedStart):(i.push(n),e=n)}return i}(t)),u=[];for(let i=0,e=t.length;i<e;i++)u.push(Pg.createFromDiffChange(t[i],r,h))}}return new Ng(h,c,l,a,u)}}class Bg{constructor(t,i,e){this.shouldComputeCharChanges=e.shouldComputeCharChanges,this.shouldPostProcessCharChanges=e.shouldPostProcessCharChanges,this.shouldIgnoreTrimWhitespace=e.shouldIgnoreTrimWhitespace,this.shouldMakePrettyDiff=e.shouldMakePrettyDiff,this.originalLines=t,this.modifiedLines=i,this.original=new Ig(t),this.modified=new Ig(i),this.continueLineDiff=jg(e.maxComputationTime),this.continueCharDiff=jg(e.maxComputationTime===0?0:Math.min(e.maxComputationTime,5e3))}computeDiff(){if(this.original.lines.length===1&&this.original.lines[0].length===0)return this.modified.lines.length===1&&this.modified.lines[0].length===0?{quitEarly:!1,changes:[]}:{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:1,modifiedStartLineNumber:1,modifiedEndLineNumber:this.modified.lines.length,charChanges:void 0}]};if(this.modified.lines.length===1&&this.modified.lines[0].length===0)return{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:this.original.lines.length,modifiedStartLineNumber:1,modifiedEndLineNumber:1,charChanges:void 0}]};const t=Og(this.original,this.modified,this.continueLineDiff,this.shouldMakePrettyDiff),i=t.changes,e=t.quitEarly;if(this.shouldIgnoreTrimWhitespace){const t=[];for(let e=0,s=i.length;e<s;e++)t.push(Ng.createFromDiffResult(this.shouldIgnoreTrimWhitespace,i[e],this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges));return{quitEarly:e,changes:t}}const s=[];let n=0,r=0;for(let t=-1,e=i.length;t<e;t++){const o=t+1<e?i[t+1]:null,h=o?o.originalStart:this.originalLines.length,c=o?o.modifiedStart:this.modifiedLines.length;for(;n<h&&r<c;){const t=this.originalLines[n],i=this.modifiedLines[r];if(t!==i){{let e=$g(t,1),o=$g(i,1);for(;e>1&&o>1&&t.charCodeAt(e-2)===i.charCodeAt(o-2);)e--,o--;(e>1||o>1)&&this._pushTrimWhitespaceCharChange(s,n+1,1,e,r+1,1,o)}{let e=Wg(t,1),o=Wg(i,1);const h=t.length+1,c=i.length+1;for(;e<h&&o<c&&t.charCodeAt(e-1)===t.charCodeAt(o-1);)e++,o++;(e<h||o<c)&&this._pushTrimWhitespaceCharChange(s,n+1,e,h,r+1,o,c)}}n++,r++}o&&(s.push(Ng.createFromDiffResult(this.shouldIgnoreTrimWhitespace,o,this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges)),n+=o.originalLength,r+=o.modifiedLength)}return{quitEarly:e,changes:s}}_pushTrimWhitespaceCharChange(t,i,e,s,n,r,o){if(this._mergeTrimWhitespaceCharChange(t,i,e,s,n,r,o))return;let h;this.shouldComputeCharChanges&&(h=[new Pg(i,e,i,s,n,r,n,o)]),t.push(new Ng(i,i,n,n,h))}_mergeTrimWhitespaceCharChange(t,i,e,s,n,r,o){const h=t.length;if(h===0)return!1;const c=t[h-1];return c.originalEndLineNumber!==0&&c.modifiedEndLineNumber!==0&&(c.originalEndLineNumber===i&&c.modifiedEndLineNumber===n?(this.shouldComputeCharChanges&&c.charChanges&&c.charChanges.push(new Pg(i,e,i,s,n,r,n,o)),!0):c.originalEndLineNumber+1===i&&c.modifiedEndLineNumber+1===n&&(c.originalEndLineNumber=i,c.modifiedEndLineNumber=n,this.shouldComputeCharChanges&&c.charChanges&&c.charChanges.push(new Pg(i,e,i,s,n,r,n,o)),!0))}}function $g(t,i){const e=tr(t);return e===-1?i:e+1}function Wg(t,i){const e=er(t);return e===-1?i:e+2}function jg(t){if(t===0)return()=>!0;const i=Date.now();return()=>Date.now()-i<t}class Hg{static trivial(t,i){return new Hg([new Vg(vg.ofLength(t.length),vg.ofLength(i.length))],!1)}static trivialTimedOut(t,i){return new Hg([new Vg(vg.ofLength(t.length),vg.ofLength(i.length))],!0)}constructor(t,i){this.diffs=t,this.hitTimeout=i}}class Vg{static invert(t,i){const e=[];return l(t,((t,s)=>{e.push(Vg.fromOffsetPairs(t?t.getEndExclusives():zg.zero,s?s.getStarts():new zg(i,(t?t.seq2Range.endExclusive-t.seq1Range.endExclusive:0)+i)))})),e}static fromOffsetPairs(t,i){return new Vg(new vg(t.offset1,i.offset1),new vg(t.offset2,i.offset2))}constructor(t,i){this.seq1Range=t,this.seq2Range=i}swap(){return new Vg(this.seq2Range,this.seq1Range)}toString(){return`${this.seq1Range} <-> ${this.seq2Range}`}join(t){return new Vg(this.seq1Range.join(t.seq1Range),this.seq2Range.join(t.seq2Range))}delta(t){return t===0?this:new Vg(this.seq1Range.delta(t),this.seq2Range.delta(t))}deltaStart(t){return t===0?this:new Vg(this.seq1Range.deltaStart(t),this.seq2Range.deltaStart(t))}deltaEnd(t){return t===0?this:new Vg(this.seq1Range.deltaEnd(t),this.seq2Range.deltaEnd(t))}intersect(t){const i=this.seq1Range.intersect(t.seq1Range),e=this.seq2Range.intersect(t.seq2Range);if(i&&e)return new Vg(i,e)}getStarts(){return new zg(this.seq1Range.start,this.seq2Range.start)}getEndExclusives(){return new zg(this.seq1Range.endExclusive,this.seq2Range.endExclusive)}}class zg{constructor(t,i){this.offset1=t,this.offset2=i}toString(){return`${this.offset1} <-> ${this.offset2}`}delta(t){return t===0?this:new zg(this.offset1+t,this.offset2+t)}equals(t){return this.offset1===t.offset1&&this.offset2===t.offset2}}zg.zero=new zg(0,0),zg.max=new zg(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);class Ug{isValid(){return!0}}Ug.instance=new Ug;class Kg{constructor(t){if(this.timeout=t,this.startTime=Date.now(),this.valid=!0,t<=0)throw new zi("timeout must be positive")}isValid(){return!(Date.now()-this.startTime<this.timeout)&&this.valid&&(this.valid=!1),this.valid}}class qg{constructor(t,i){this.width=t,this.height=i,this.array=[],this.array=new Array(t*i)}get(t,i){return this.array[t+i*this.width]}set(t,i,e){this.array[t+i*this.width]=e}}function Gg(t){return t===32||t===9}class Zg{static getKey(t){let i=this.chrKeys.get(t);return i===void 0&&(i=this.chrKeys.size,this.chrKeys.set(t,i)),i}constructor(t,i,e){this.range=t,this.lines=i,this.source=e,this.histogram=[];let s=0;for(let e=t.startLineNumber-1;e<t.endLineNumberExclusive-1;e++){const t=i[e];for(let i=0;i<t.length;i++){s++;const e=t[i],n=Zg.getKey(e);this.histogram[n]=(this.histogram[n]||0)+1}s++;const n=Zg.getKey(`\n`);this.histogram[n]=(this.histogram[n]||0)+1}this.totalCount=s}computeSimilarity(t){var i,e;let s=0;const n=Math.max(this.histogram.length,t.histogram.length);for(let r=0;r<n;r++)s+=Math.abs(((i=this.histogram[r])!==null&&i!==void 0?i:0)-((e=t.histogram[r])!==null&&e!==void 0?e:0));return 1-s/(this.totalCount+t.totalCount)}}Zg.chrKeys=new Map;class Jg{compute(t,i,e=Ug.instance,s){if(t.length===0||i.length===0)return Hg.trivial(t,i);const n=new qg(t.length,i.length),r=new qg(t.length,i.length),o=new qg(t.length,i.length);for(let h=0;h<t.length;h++)for(let c=0;c<i.length;c++){if(!e.isValid())return Hg.trivialTimedOut(t,i);const l=h===0?0:n.get(h-1,c),a=c===0?0:n.get(h,c-1);let u;t.getElement(h)===i.getElement(c)?(u=h===0||c===0?0:n.get(h-1,c-1),h>0&&c>0&&r.get(h-1,c-1)===3&&(u+=o.get(h-1,c-1)),u+=s?s(h,c):1):u=-1;const d=Math.max(l,a,u);if(d===u){const t=h>0&&c>0?o.get(h-1,c-1):0;o.set(h,c,t+1),r.set(h,c,3)}else d===l?(o.set(h,c,0),r.set(h,c,1)):d===a&&(o.set(h,c,0),r.set(h,c,2));n.set(h,c,d)}const h=[];let c=t.length,l=i.length;function a(t,i){t+1===c&&i+1===l||h.push(new Vg(new vg(t+1,c),new vg(i+1,l))),c=t,l=i}let u=t.length-1,d=i.length-1;for(;u>=0&&d>=0;)r.get(u,d)===3?(a(u,d),u--,d--):r.get(u,d)===1?u--:d--;return a(-1,-1),h.reverse(),new Hg(h,!1)}}class Qg{compute(t,i,e=Ug.instance){if(t.length===0||i.length===0)return Hg.trivial(t,i);const s=t,n=i;function r(t,i){for(;t<s.length&&i<n.length&&s.getElement(t)===n.getElement(i);)t++,i++;return t}let o=0;const h=new Xg;h.set(0,r(0,0));const c=new tp;c.set(0,h.get(0)===0?null:new Yg(null,0,0,h.get(0)));let l=0;t:for(;;){if(o++,!e.isValid())return Hg.trivialTimedOut(s,n);const t=-Math.min(o,n.length+o%2),i=Math.min(o,s.length+o%2);for(l=t;l<=i;l+=2){const e=l===i?-1:h.get(l+1),o=l===t?-1:h.get(l-1)+1,a=Math.min(Math.max(e,o),s.length),u=a-l;if(a>s.length||u>n.length)continue;const d=r(a,u);h.set(l,d);const f=a===e?c.get(l+1):c.get(l-1);if(c.set(l,d!==a?new Yg(f,a,u,d-a):f),h.get(l)===s.length&&h.get(l)-l===n.length)break t}}let a=c.get(l);const u=[];let d=s.length,f=n.length;for(;;){const t=a?a.x+a.length:0,i=a?a.y+a.length:0;if(t===d&&i===f||u.push(new Vg(new vg(t,d),new vg(i,f))),!a)break;d=a.x,f=a.y,a=a.prev}return u.reverse(),new Hg(u,!1)}}class Yg{constructor(t,i,e,s){this.prev=t,this.x=i,this.y=e,this.length=s}}class Xg{constructor(){this.positiveArr=new Int32Array(10),this.negativeArr=new Int32Array(10)}get(t){return t<0?(t=-t-1,this.negativeArr[t]):this.positiveArr[t]}set(t,i){if(t<0){if((t=-t-1)>=this.negativeArr.length){const t=this.negativeArr;this.negativeArr=new Int32Array(2*t.length),this.negativeArr.set(t)}this.negativeArr[t]=i}else{if(t>=this.positiveArr.length){const t=this.positiveArr;this.positiveArr=new Int32Array(2*t.length),this.positiveArr.set(t)}this.positiveArr[t]=i}}}class tp{constructor(){this.positiveArr=[],this.negativeArr=[]}get(t){return t<0?(t=-t-1,this.negativeArr[t]):this.positiveArr[t]}set(t,i){t<0?(t=-t-1,this.negativeArr[t]=i):this.positiveArr[t]=i}}class ip{constructor(t,i,e){this.lines=t,this.considerWhitespaceChanges=e,this.elements=[],this.firstCharOffsetByLine=[],this.additionalOffsetByLine=[];let s=!1;i.start>0&&i.endExclusive>=t.length&&(i=new vg(i.start-1,i.endExclusive),s=!0),this.lineRange=i,this.firstCharOffsetByLine[0]=0;for(let i=this.lineRange.start;i<this.lineRange.endExclusive;i++){let n=t[i],r=0;if(s)r=n.length,n="",s=!1;else if(!e){const t=n.trimStart();r=n.length-t.length,n=t.trimEnd()}this.additionalOffsetByLine.push(r);for(let t=0;t<n.length;t++)this.elements.push(n.charCodeAt(t));i<t.length-1&&(this.elements.push(10),this.firstCharOffsetByLine[i-this.lineRange.start+1]=this.elements.length)}this.additionalOffsetByLine.push(0)}toString(){return`Slice: "${this.text}"`}get text(){return this.getText(new vg(0,this.length))}getText(t){return this.elements.slice(t.start,t.endExclusive).map((t=>String.fromCharCode(t))).join("")}getElement(t){return this.elements[t]}get length(){return this.elements.length}getBoundaryScore(t){const i=rp(t>0?this.elements[t-1]:-1),e=rp(t<this.elements.length?this.elements[t]:-1);if(i===7&&e===8)return 0;if(i===8)return 150;let s=0;return i!==e&&(s+=10,i===0&&e===1&&(s+=1)),s+=np(i),s+=np(e),s}translateOffset(t){if(this.lineRange.isEmpty)return new ks(this.lineRange.start+1,1);const i=Cg(this.firstCharOffsetByLine,(i=>i<=t));return new ks(this.lineRange.start+i+1,t-this.firstCharOffsetByLine[i]+this.additionalOffsetByLine[i]+1)}translateRange(t){return Cs.fromPositions(this.translateOffset(t.start),this.translateOffset(t.endExclusive))}findWordContaining(t){if(t<0||t>=this.elements.length||!ep(this.elements[t]))return;let i=t;for(;i>0&&ep(this.elements[i-1]);)i--;let e=t;for(;e<this.elements.length&&ep(this.elements[e]);)e++;return new vg(i,e)}countLinesIn(t){return this.translateOffset(t.endExclusive).lineNumber-this.translateOffset(t.start).lineNumber}isStronglyEqual(t,i){return this.elements[t]===this.elements[i]}extendToFullLines(t){var i,e;const s=(i=kg(this.firstCharOffsetByLine,(i=>i<=t.start)))!==null&&i!==void 0?i:0,n=(e=function(t,i){const e=Sg(t,i);return e===t.length?void 0:t[e]}(this.firstCharOffsetByLine,(i=>t.endExclusive<=i)))!==null&&e!==void 0?e:this.elements.length;return new vg(s,n)}}function ep(t){return t>=97&&t<=122||t>=65&&t<=90||t>=48&&t<=57}const sp={0:0,1:0,2:0,3:10,4:2,5:30,6:3,7:10,8:10};function np(t){return sp[t]}function rp(t){return t===10?8:t===13?7:Gg(t)?6:t>=97&&t<=122?0:t>=65&&t<=90?1:t>=48&&t<=57?2:t===-1?3:t===44||t===59?5:4}function op(t,i,e,s,n,r){let{moves:o,excludedChanges:h}=function(t,i,e,s){const n=[],r=t.filter((t=>t.modified.isEmpty&&t.original.length>=3)).map((t=>new Zg(t.original,i,t))),o=new Set(t.filter((t=>t.original.isEmpty&&t.modified.length>=3)).map((t=>new Zg(t.modified,e,t)))),h=new Set;for(const t of r){let i,e=-1;for(const s of o){const n=t.computeSimilarity(s);n>e&&(e=n,i=s)}if(e>.9&&i&&(o.delete(i),n.push(new Lg(t.range,i.range)),h.add(t.source),h.add(i.source)),!s.isValid())return{moves:n,excludedChanges:h}}return{moves:n,excludedChanges:h}}(t,i,e,r);if(!r.isValid())return[];const c=function(t,i,e,s,n,r){const o=[],h=new Gf;for(const e of t)for(let t=e.original.startLineNumber;t<e.original.endLineNumberExclusive-2;t++){const e=`${i[t-1]}:${i[t+1-1]}:${i[t+2-1]}`;h.add(e,{range:new Ag(t,t+3)})}const c=[];t.sort(D((t=>t.modified.startLineNumber),E));for(const i of t){let t=[];for(let s=i.modified.startLineNumber;s<i.modified.endLineNumberExclusive-2;s++){const i=`${e[s-1]}:${e[s+1-1]}:${e[s+2-1]}`,n=new Ag(s,s+3),r=[];h.forEach(i,(({range:i})=>{for(const e of t)if(e.originalLineRange.endLineNumberExclusive+1===i.endLineNumberExclusive&&e.modifiedLineRange.endLineNumberExclusive+1===n.endLineNumberExclusive)return e.originalLineRange=new Ag(e.originalLineRange.startLineNumber,i.endLineNumberExclusive),e.modifiedLineRange=new Ag(e.modifiedLineRange.startLineNumber,n.endLineNumberExclusive),void r.push(e);const e={modifiedLineRange:n,originalLineRange:i};c.push(e),r.push(e)})),t=r}if(!r.isValid())return[]}c.sort(M(D((t=>t.modifiedLineRange.length),E)));const l=new Mg,a=new Mg;for(const t of c){const i=t.modifiedLineRange.startLineNumber-t.originalLineRange.startLineNumber,e=l.subtractFrom(t.modifiedLineRange),s=a.subtractFrom(t.originalLineRange).getWithDelta(i),n=e.getIntersection(s);for(const t of n.ranges){if(t.length<3)continue;const e=t,s=t.delta(-i);o.push(new Lg(s,e)),l.addRange(e),a.addRange(s)}}o.sort(D((t=>t.original.startLineNumber),E));const u=new xg(t);for(let i=0;i<o.length;i++){const e=o[i],h=u.findLastMonotonous((t=>t.original.startLineNumber<=e.original.startLineNumber)),c=kg(t,(t=>t.modified.startLineNumber<=e.modified.startLineNumber)),d=Math.max(e.original.startLineNumber-h.original.startLineNumber,e.modified.startLineNumber-c.modified.startLineNumber),f=u.findLastMonotonous((t=>t.original.startLineNumber<e.original.endLineNumberExclusive)),g=kg(t,(t=>t.modified.startLineNumber<e.modified.endLineNumberExclusive)),p=Math.max(f.original.endLineNumberExclusive-e.original.endLineNumberExclusive,g.modified.endLineNumberExclusive-e.modified.endLineNumberExclusive);let m,w;for(m=0;m<d;m++){const t=e.original.startLineNumber-m-1,i=e.modified.startLineNumber-m-1;if(t>s.length||i>n.length||l.contains(i)||a.contains(t)||!hp(s[t-1],n[i-1],r))break}for(m>0&&(a.addRange(new Ag(e.original.startLineNumber-m,e.original.startLineNumber)),l.addRange(new Ag(e.modified.startLineNumber-m,e.modified.startLineNumber))),w=0;w<p;w++){const t=e.original.endLineNumberExclusive+w,i=e.modified.endLineNumberExclusive+w;if(t>s.length||i>n.length||l.contains(i)||a.contains(t)||!hp(s[t-1],n[i-1],r))break}w>0&&(a.addRange(new Ag(e.original.endLineNumberExclusive,e.original.endLineNumberExclusive+w)),l.addRange(new Ag(e.modified.endLineNumberExclusive,e.modified.endLineNumberExclusive+w))),(m>0||w>0)&&(o[i]=new Lg(new Ag(e.original.startLineNumber-m,e.original.endLineNumberExclusive+w),new Ag(e.modified.startLineNumber-m,e.modified.endLineNumberExclusive+w)))}return o}(t.filter((t=>!h.has(t))),s,n,i,e,r);return y(o,c),o=function(t){if(t.length===0)return t;t.sort(D((t=>t.original.startLineNumber),E));const i=[t[0]];for(let e=1;e<t.length;e++){const s=i[i.length-1],n=t[e],r=n.original.startLineNumber-s.original.endLineNumberExclusive,o=n.modified.startLineNumber-s.modified.endLineNumberExclusive;r>=0&&o>=0&&r+o<=2?i[i.length-1]=s.join(n):i.push(n)}return i}(o),o=o.filter((t=>{const e=t.original.toOffsetRange().slice(i).map((t=>t.trim()));return e.join(`\n`).length>=15&&function(t,i){let e=0;for(const s of t)i(s)&&e++;return e}(e,(t=>t.length>=2))>=2})),o=function(t,i){const e=new xg(t);return i=i.filter((i=>(e.findLastMonotonous((t=>t.original.startLineNumber<i.original.endLineNumberExclusive))||new Lg(new Ag(1,1),new Ag(1,1)))!==kg(t,(t=>t.modified.startLineNumber<i.modified.endLineNumberExclusive)))),i}(t,o),o}function hp(t,i,e){if(t.trim()===i.trim())return!0;if(t.length>300&&i.length>300)return!1;const s=(new Qg).compute(new ip([t],new vg(0,1),!1),new ip([i],new vg(0,1),!1),e);let n=0;const r=Vg.invert(s.diffs,t.length);for(const i of r)i.seq1Range.forEach((i=>{Gg(t.charCodeAt(i))||n++}));const o=function(i){let e=0;for(let s=0;s<t.length;s++)Gg(i.charCodeAt(s))||e++;return e}(t.length>i.length?t:i);return n/o>.6&&o>10}function cp(t,i,e){let s=e;return s=lp(t,i,s),s=lp(t,i,s),s=function(t,i,e){if(!t.getBoundaryScore||!i.getBoundaryScore)return e;for(let s=0;s<e.length;s++){const n=s>0?e[s-1]:void 0,r=e[s],o=s+1<e.length?e[s+1]:void 0,h=new vg(n?n.seq1Range.endExclusive+1:0,o?o.seq1Range.start-1:t.length),c=new vg(n?n.seq2Range.endExclusive+1:0,o?o.seq2Range.start-1:i.length);r.seq1Range.isEmpty?e[s]=ap(r,t,i,h,c):r.seq2Range.isEmpty&&(e[s]=ap(r.swap(),i,t,c,h).swap())}return e}(t,i,s),s}function lp(t,i,e){if(e.length===0)return e;const s=[];s.push(e[0]);for(let n=1;n<e.length;n++){const r=s[s.length-1];let o=e[n];if(o.seq1Range.isEmpty||o.seq2Range.isEmpty){const e=o.seq1Range.start-r.seq1Range.endExclusive;let n;for(n=1;n<=e&&t.getElement(o.seq1Range.start-n)===t.getElement(o.seq1Range.endExclusive-n)&&i.getElement(o.seq2Range.start-n)===i.getElement(o.seq2Range.endExclusive-n);n++);if(n--,n===e){s[s.length-1]=new Vg(new vg(r.seq1Range.start,o.seq1Range.endExclusive-e),new vg(r.seq2Range.start,o.seq2Range.endExclusive-e));continue}o=o.delta(-n)}s.push(o)}const n=[];for(let e=0;e<s.length-1;e++){const r=s[e+1];let o=s[e];if(o.seq1Range.isEmpty||o.seq2Range.isEmpty){const n=r.seq1Range.start-o.seq1Range.endExclusive;let h;for(h=0;h<n&&t.isStronglyEqual(o.seq1Range.start+h,o.seq1Range.endExclusive+h)&&i.isStronglyEqual(o.seq2Range.start+h,o.seq2Range.endExclusive+h);h++);if(h===n){s[e+1]=new Vg(new vg(o.seq1Range.start+n,r.seq1Range.endExclusive),new vg(o.seq2Range.start+n,r.seq2Range.endExclusive));continue}h>0&&(o=o.delta(h))}n.push(o)}return s.length>0&&n.push(s[s.length-1]),n}function ap(t,i,e,s,n){let r=1;for(;t.seq1Range.start-r>=s.start&&t.seq2Range.start-r>=n.start&&e.isStronglyEqual(t.seq2Range.start-r,t.seq2Range.endExclusive-r)&&r<100;)r++;r--;let o=0;for(;t.seq1Range.start+o<s.endExclusive&&t.seq2Range.endExclusive+o<n.endExclusive&&e.isStronglyEqual(t.seq2Range.start+o,t.seq2Range.endExclusive+o)&&o<100;)o++;if(r===0&&o===0)return t;let h=0,c=-1;for(let s=-r;s<=o;s++){const n=t.seq2Range.start+s,r=t.seq2Range.endExclusive+s,o=t.seq1Range.start+s,l=i.getBoundaryScore(o)+e.getBoundaryScore(n)+e.getBoundaryScore(r);l>c&&(c=l,h=s)}return t.delta(h)}class up{constructor(t,i){this.trimmedHash=t,this.lines=i}getElement(t){return this.trimmedHash[t]}get length(){return this.trimmedHash.length}getBoundaryScore(t){return 1e3-((t===0?0:dp(this.lines[t-1]))+(t===this.lines.length?0:dp(this.lines[t])))}getText(t){return this.lines.slice(t.start,t.endExclusive).join(`\n`)}isStronglyEqual(t,i){return this.lines[t]===this.lines[i]}}function dp(t){let i=0;for(;i<t.length&&(t.charCodeAt(i)===32||t.charCodeAt(i)===9);)i++;return i}class fp{constructor(){this.dynamicProgrammingDiffing=new Jg,this.myersDiffingAlgorithm=new Qg}computeDiff(t,i,e){if(t.length<=1&&n(t,i,((t,i)=>t===i)))return new mg([],[],!1);if(t.length===1&&t[0].length===0||i.length===1&&i[0].length===0)return new mg([new Fg(new Ag(1,t.length+1),new Ag(1,i.length+1),[new Tg(new Cs(1,1,t.length,t[0].length+1),new Cs(1,1,i.length,i[0].length+1))])],[],!1);const s=e.maxComputationTimeMs===0?Ug.instance:new Kg(e.maxComputationTimeMs),r=!e.ignoreTrimWhitespace,o=new Map;function h(t){let i=o.get(t);return i===void 0&&(i=o.size,o.set(t,i)),i}const c=t.map((t=>h(t.trim()))),l=i.map((t=>h(t.trim()))),a=new up(c,t),u=new up(l,i),d=a.length+u.length<1700?this.dynamicProgrammingDiffing.compute(a,u,s,((e,s)=>t[e]===i[s]?i[s].length===0?.1:1+Math.log(1+i[s].length):.99)):this.myersDiffingAlgorithm.compute(a,u);let f=d.diffs,g=d.hitTimeout;f=cp(a,u,f),f=function(t,i,e){let s=e;if(s.length===0)return s;let n,r=0;do{n=!1;const i=[s[0]];for(let e=1;e<s.length;e++){let r=function(i,e){const s=new vg(h.seq1Range.endExclusive,o.seq1Range.start);return t.getText(s).replace(/\s/g,"").length<=4&&(i.seq1Range.length+i.seq2Range.length>5||e.seq1Range.length+e.seq2Range.length>5)};const o=s[e],h=i[i.length-1];r(h,o)?(n=!0,i[i.length-1]=i[i.length-1].join(o)):i.push(o)}s=i}while(r++<10&&n);return s}(a,0,f);const p=[],m=e=>{if(r)for(let n=0;n<e;n++){const e=w+n,o=v+n;if(t[e]!==i[o]){const n=this.refineDiff(t,i,new Vg(new vg(e,e+1),new vg(o,o+1)),s,r);for(const t of n.mappings)p.push(t);n.hitTimeout&&(g=!0)}}};let w=0,v=0;for(const e of f){ja((()=>e.seq1Range.start-w==e.seq2Range.start-v)),m(e.seq1Range.start-w),w=e.seq1Range.endExclusive,v=e.seq2Range.endExclusive;const n=this.refineDiff(t,i,e,s,r);n.hitTimeout&&(g=!0);for(const t of n.mappings)p.push(t)}m(t.length-w);const b=gp(p,t,i);let y=[];return e.computeMoves&&(y=this.computeMoves(b,t,i,c,l,s,r)),ja((()=>{function e(t,i){if(t.lineNumber<1||t.lineNumber>i.length)return!1;const e=i[t.lineNumber-1];return!(t.column<1||t.column>e.length+1)}function s(t,i){return!(t.startLineNumber<1||t.startLineNumber>i.length+1)&&!(t.endLineNumberExclusive<1||t.endLineNumberExclusive>i.length+1)}for(const n of b){if(!n.innerChanges)return!1;for(const s of n.innerChanges)if(!(e(s.modifiedRange.getStartPosition(),i)&&e(s.modifiedRange.getEndPosition(),i)&&e(s.originalRange.getStartPosition(),t)&&e(s.originalRange.getEndPosition(),t)))return!1;if(!s(n.modified,i)||!s(n.original,t))return!1}return!0})),new mg(b,y,g)}computeMoves(t,i,e,s,n,r,o){return op(t,i,e,s,n,r).map((t=>{const s=gp(this.refineDiff(i,e,new Vg(t.original.toOffsetRange(),t.modified.toOffsetRange()),r,o).mappings,i,e,!0);return new wg(t,s)}))}refineDiff(t,i,e,s,n){const r=new ip(t,e.seq1Range,n),o=new ip(i,e.seq2Range,n),h=r.length+o.length<500?this.dynamicProgrammingDiffing.compute(r,o,s):this.myersDiffingAlgorithm.compute(r,o,s);let c=h.diffs;return c=cp(r,o,c),c=function(t,i,e){const s=Vg.invert(e,t.length),n=[];let r=new zg(0,0);function o(e,o){if(e.offset1<r.offset1||e.offset2<r.offset2)return;const h=t.findWordContaining(e.offset1),c=i.findWordContaining(e.offset2);if(!h||!c)return;let l=new Vg(h,c);const a=l.intersect(o);let u=a.seq1Range.length,d=a.seq2Range.length;for(;s.length>0;){const e=s[0];if(!e.seq1Range.intersects(l.seq1Range)&&!e.seq2Range.intersects(l.seq2Range))break;const n=t.findWordContaining(e.seq1Range.start),r=i.findWordContaining(e.seq2Range.start),o=new Vg(n,r),h=o.intersect(e);if(u+=h.seq1Range.length,d+=h.seq2Range.length,l=l.join(o),!(l.seq1Range.endExclusive>=e.seq1Range.endExclusive))break;s.shift()}u+d<2*(l.seq1Range.length+l.seq2Range.length)/3&&n.push(l),r=l.getEndExclusives()}for(;s.length>0;){const t=s.shift();t.seq1Range.isEmpty||(o(t.getStarts(),t),o(t.getEndExclusives().delta(-1),t))}return function(t,i){const e=[];for(;t.length>0||i.length>0;){const s=t[0],n=i[0];let r;r=s&&(!n||s.seq1Range.start<n.seq1Range.start)?t.shift():i.shift(),e.length>0&&e[e.length-1].seq1Range.endExclusive>=r.seq1Range.start?e[e.length-1]=e[e.length-1].join(r):e.push(r)}return e}(e,n)}(r,o,c),c=function(t,i,e){const s=[];for(const t of e){const i=s[s.length-1];i&&(t.seq1Range.start-i.seq1Range.endExclusive<=2||t.seq2Range.start-i.seq2Range.endExclusive<=2)?s[s.length-1]=new Vg(i.seq1Range.join(t.seq1Range),i.seq2Range.join(t.seq2Range)):s.push(t)}return s}(0,0,c),c=function(t,i,e){let s=e;if(s.length===0)return s;let n,r=0;do{n=!1;const e=[s[0]];for(let r=1;r<s.length;r++){let o=function(e,s){const n=new vg(c.seq1Range.endExclusive,h.seq1Range.start);if(t.countLinesIn(n)>5||n.length>500)return!1;const r=t.getText(n).trim();if(r.length>20||r.split(/\r\n|\r|\n/).length>1)return!1;const o=t.countLinesIn(e.seq1Range),l=e.seq1Range.length,a=i.countLinesIn(e.seq2Range),u=e.seq2Range.length,d=t.countLinesIn(s.seq1Range),f=s.seq1Range.length,g=i.countLinesIn(s.seq2Range),p=s.seq2Range.length;function m(t){return Math.min(t,130)}return Math.pow(Math.pow(m(40*o+l),1.5)+Math.pow(m(40*a+u),1.5),1.5)+Math.pow(Math.pow(m(40*d+f),1.5)+Math.pow(m(40*g+p),1.5),1.5)>74184.96480721243};const h=s[r],c=e[e.length-1];o(c,h)?(n=!0,e[e.length-1]=e[e.length-1].join(h)):e.push(h)}s=e}while(r++<10&&n);const o=[];return function(t,i){for(let e=0;e<t.length;e++)i(e===0?void 0:t[e-1],t[e],e+1===t.length?void 0:t[e+1])}(s,((i,e,s)=>{let n=e;function r(t){return t.length>0&&t.trim().length<=3&&e.seq1Range.length+e.seq2Range.length>100}const h=t.extendToFullLines(e.seq1Range),c=t.getText(new vg(h.start,e.seq1Range.start));r(c)&&(n=n.deltaStart(-c.length));const l=t.getText(new vg(e.seq1Range.endExclusive,h.endExclusive));r(l)&&(n=n.deltaEnd(l.length));const a=Vg.fromOffsetPairs(i?i.getEndExclusives():zg.zero,s?s.getStarts():zg.max),u=n.intersect(a);o.length>0&&u.getStarts().equals(o[o.length-1].getEndExclusives())?o[o.length-1]=o[o.length-1].join(u):o.push(u)})),o}(r,o,c),{mappings:c.map((t=>new Tg(r.translateRange(t.seq1Range),o.translateRange(t.seq2Range)))),hitTimeout:h.hitTimeout}}}function gp(t,i,e,s=!1){const n=[];for(const s of c(t.map((t=>function(t,i,e){let s=0,n=0;t.modifiedRange.endColumn===1&&t.originalRange.endColumn===1&&t.originalRange.startLineNumber+s<=t.originalRange.endLineNumber&&t.modifiedRange.startLineNumber+s<=t.modifiedRange.endLineNumber&&(n=-1),t.modifiedRange.startColumn-1>=e[t.modifiedRange.startLineNumber-1].length&&t.originalRange.startColumn-1>=i[t.originalRange.startLineNumber-1].length&&t.originalRange.startLineNumber<=t.originalRange.endLineNumber+n&&t.modifiedRange.startLineNumber<=t.modifiedRange.endLineNumber+n&&(s=1);const r=new Ag(t.originalRange.startLineNumber+s,t.originalRange.endLineNumber+1+n),o=new Ag(t.modifiedRange.startLineNumber+s,t.modifiedRange.endLineNumber+1+n);return new Fg(r,o,[t])}(t,i,e))),((t,i)=>t.original.overlapOrTouch(i.original)||t.modified.overlapOrTouch(i.modified)))){const t=s[0],i=s[s.length-1];n.push(new Fg(t.original.join(i.original),t.modified.join(i.modified),s.map((t=>t.innerChanges[0]))))}return ja((()=>!s&&n.length>0&&(n[0].modified.startLineNumber!==n[0].original.startLineNumber||e.length-n[n.length-1].modified.endLineNumberExclusive!=i.length-n[n.length-1].original.endLineNumberExclusive)?!1:Ha(n,((t,i)=>i.original.startLineNumber-t.original.endLineNumberExclusive==i.modified.startLineNumber-t.modified.endLineNumberExclusive&&t.original.endLineNumberExclusive<i.original.startLineNumber&&t.modified.endLineNumberExclusive<i.modified.startLineNumber)))),n}const pp=()=>new Rg,mp=()=>new fp;function wp(t,i){const e=Math.pow(10,i);return Math.round(t*e)/e}class vp{constructor(t,i,e,s=1){this._rgbaBrand=void 0,this.r=0|Math.min(255,Math.max(0,t)),this.g=0|Math.min(255,Math.max(0,i)),this.b=0|Math.min(255,Math.max(0,e)),this.a=wp(Math.max(Math.min(1,s),0),3)}static equals(t,i){return t.r===i.r&&t.g===i.g&&t.b===i.b&&t.a===i.a}}class bp{constructor(t,i,e,s){this._hslaBrand=void 0,this.h=0|Math.max(Math.min(360,t),0),this.s=wp(Math.max(Math.min(1,i),0),3),this.l=wp(Math.max(Math.min(1,e),0),3),this.a=wp(Math.max(Math.min(1,s),0),3)}static equals(t,i){return t.h===i.h&&t.s===i.s&&t.l===i.l&&t.a===i.a}static fromRGBA(t){const i=t.r/255,e=t.g/255,s=t.b/255,n=t.a,r=Math.max(i,e,s),o=Math.min(i,e,s);let h=0,c=0;const l=(o+r)/2,a=r-o;if(a>0){switch(c=Math.min(l<=.5?a/(2*l):a/(2-2*l),1),r){case i:h=(e-s)/a+(e<s?6:0);break;case e:h=(s-i)/a+2;break;case s:h=(i-e)/a+4}h*=60,h=Math.round(h)}return new bp(h,c,l,n)}static _hue2rgb(t,i,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?t+6*(i-t)*e:e<.5?i:e<2/3?t+(i-t)*(2/3-e)*6:t}static toRGBA(t){const i=t.h/360,{s:e,l:s,a:n}=t;let r,o,h;if(e===0)r=o=h=s;else{const t=s<.5?s*(1+e):s+e-s*e,n=2*s-t;r=bp._hue2rgb(n,t,i+1/3),o=bp._hue2rgb(n,t,i),h=bp._hue2rgb(n,t,i-1/3)}return new vp(Math.round(255*r),Math.round(255*o),Math.round(255*h),n)}}class yp{constructor(t,i,e,s){this._hsvaBrand=void 0,this.h=0|Math.max(Math.min(360,t),0),this.s=wp(Math.max(Math.min(1,i),0),3),this.v=wp(Math.max(Math.min(1,e),0),3),this.a=wp(Math.max(Math.min(1,s),0),3)}static equals(t,i){return t.h===i.h&&t.s===i.s&&t.v===i.v&&t.a===i.a}static fromRGBA(t){const i=t.r/255,e=t.g/255,s=t.b/255,n=Math.max(i,e,s),r=n-Math.min(i,e,s),o=n===0?0:r/n;let h;return h=r===0?0:n===i?((e-s)/r%6+6)%6:n===e?(s-i)/r+2:(i-e)/r+4,new yp(Math.round(60*h),o,n,t.a)}static toRGBA(t){const{h:i,s:e,v:s,a:n}=t,r=s*e,o=r*(1-Math.abs(i/60%2-1)),h=s-r;let[c,l,a]=[0,0,0];return i<60?(c=r,l=o):i<120?(c=o,l=r):i<180?(l=r,a=o):i<240?(l=o,a=r):i<300?(c=o,a=r):i<=360&&(c=r,a=o),c=Math.round(255*(c+h)),l=Math.round(255*(l+h)),a=Math.round(255*(a+h)),new vp(c,l,a,n)}}class kp{static fromHex(t){return kp.Format.CSS.parseHex(t)||kp.red}static equals(t,i){return!t&&!i||!(!t||!i)&&t.equals(i)}get hsla(){return this._hsla?this._hsla:bp.fromRGBA(this.rgba)}get hsva(){return this._hsva?this._hsva:yp.fromRGBA(this.rgba)}constructor(t){if(!t)throw new Error("Color needs a value");if(t instanceof vp)this.rgba=t;else if(t instanceof bp)this._hsla=t,this.rgba=bp.toRGBA(t);else{if(!(t instanceof yp))throw new Error("Invalid color ctor argument");this._hsva=t,this.rgba=yp.toRGBA(t)}}equals(t){return!!t&&vp.equals(this.rgba,t.rgba)&&bp.equals(this.hsla,t.hsla)&&yp.equals(this.hsva,t.hsva)}getRelativeLuminance(){return wp(.2126*kp._relativeLuminanceForComponent(this.rgba.r)+.7152*kp._relativeLuminanceForComponent(this.rgba.g)+.0722*kp._relativeLuminanceForComponent(this.rgba.b),4)}static _relativeLuminanceForComponent(t){const i=t/255;return i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4)}isLighter(){return(299*this.rgba.r+587*this.rgba.g+114*this.rgba.b)/1e3>=128}isLighterThan(t){return this.getRelativeLuminance()>t.getRelativeLuminance()}isDarkerThan(t){return this.getRelativeLuminance()<t.getRelativeLuminance()}lighten(t){return new kp(new bp(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*t,this.hsla.a))}darken(t){return new kp(new bp(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*t,this.hsla.a))}transparent(t){const{r:i,g:e,b:s,a:n}=this.rgba;return new kp(new vp(i,e,s,n*t))}isTransparent(){return this.rgba.a===0}isOpaque(){return this.rgba.a===1}opposite(){return new kp(new vp(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}makeOpaque(t){if(this.isOpaque()||t.rgba.a!==1)return this;const{r:i,g:e,b:s,a:n}=this.rgba;return new kp(new vp(t.rgba.r-n*(t.rgba.r-i),t.rgba.g-n*(t.rgba.g-e),t.rgba.b-n*(t.rgba.b-s),1))}toString(){return this._toString||(this._toString=kp.Format.CSS.format(this)),this._toString}static getLighterColor(t,i,e){if(t.isLighterThan(i))return t;e=e||.5;const s=t.getRelativeLuminance(),n=i.getRelativeLuminance();return e=e*(n-s)/n,t.lighten(e)}static getDarkerColor(t,i,e){if(t.isDarkerThan(i))return t;e=e||.5;const s=t.getRelativeLuminance();return e=e*(s-i.getRelativeLuminance())/s,t.darken(e)}}function Cp(t){const i=[];for(const e of t){const t=Number(e);(t||t===0&&e.replace(/\s/g,"")!=="")&&i.push(t)}return i}function Sp(t,i,e,s){return{red:t/255,blue:e/255,green:i/255,alpha:s}}function xp(t,i){const e=i.index,s=i[0].length;if(!e)return;const n=t.positionAt(e);return{startLineNumber:n.lineNumber,startColumn:n.column,endLineNumber:n.lineNumber,endColumn:n.column+s}}function Dp(t,i){if(!t)return;const e=kp.Format.CSS.parseHex(i);return e?{range:t,color:Sp(e.rgba.r,e.rgba.g,e.rgba.b,e.rgba.a)}:void 0}function Ep(t,i,e){if(!t||i.length!==1)return;const s=Cp(i[0].values());return{range:t,color:Sp(s[0],s[1],s[2],e?s[3]:1)}}function Ap(t,i,e){if(!t||i.length!==1)return;const s=Cp(i[0].values()),n=new kp(new bp(s[0],s[1]/100,s[2]/100,e?s[3]:1));return{range:t,color:Sp(n.rgba.r,n.rgba.g,n.rgba.b,n.rgba.a)}}function Mp(t,i){return typeof t=="string"?[...t.matchAll(i)]:t.findMatches(i)}function Lp(t){return t&&typeof t.getValue=="function"&&typeof t.positionAt=="function"?function(t){const i=[],e=Mp(t,/\b(rgb|rgba|hsl|hsla)(\([0-9\s,.\%]*\))|(#)([A-Fa-f0-9]{3})\b|(#)([A-Fa-f0-9]{4})\b|(#)([A-Fa-f0-9]{6})\b|(#)([A-Fa-f0-9]{8})\b/gm);if(e.length>0)for(const s of e){const e=s.filter((t=>t!==void 0)),n=e[1],r=e[2];if(!r)continue;let o;if(n==="rgb"){const i=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*\)$/gm;o=Ep(xp(t,s),Mp(r,i),!1)}else if(n==="rgba"){const i=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\s*\)$/gm;o=Ep(xp(t,s),Mp(r,i),!0)}else if(n==="hsl"){const i=/^\(\s*(36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*\)$/gm;o=Ap(xp(t,s),Mp(r,i),!1)}else if(n==="hsla"){const i=/^\(\s*(36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\s*\)$/gm;o=Ap(xp(t,s),Mp(r,i),!0)}else n==="#"&&(o=Dp(xp(t,s),n+r));o&&i.push(o)}return i}(t):[]}kp.white=new kp(new vp(255,255,255,1)),kp.black=new kp(new vp(0,0,0,1)),kp.red=new kp(new vp(255,0,0,1)),kp.blue=new kp(new vp(0,0,255,1)),kp.green=new kp(new vp(0,255,0,1)),kp.cyan=new kp(new vp(0,255,255,1)),kp.lightgrey=new kp(new vp(211,211,211,1)),kp.transparent=new kp(new vp(0,0,0,0)),function(t){var i;(function(i){function e(t){const i=t.toString(16);return i.length!==2?"0"+i:i}function s(t){switch(t){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:case 65:return 10;case 98:case 66:return 11;case 99:case 67:return 12;case 100:case 68:return 13;case 101:case 69:return 14;case 102:case 70:return 15}return 0}i.formatRGB=function(i){return i.rgba.a===1?`rgb(${i.rgba.r}, ${i.rgba.g}, ${i.rgba.b})`:t.Format.CSS.formatRGBA(i)},i.formatRGBA=function(t){return`rgba(${t.rgba.r}, ${t.rgba.g}, ${t.rgba.b}, ${+t.rgba.a.toFixed(2)})`},i.formatHSL=function(i){return i.hsla.a===1?`hsl(${i.hsla.h}, ${(100*i.hsla.s).toFixed(2)}%, ${(100*i.hsla.l).toFixed(2)}%)`:t.Format.CSS.formatHSLA(i)},i.formatHSLA=function(t){return`hsla(${t.hsla.h}, ${(100*t.hsla.s).toFixed(2)}%, ${(100*t.hsla.l).toFixed(2)}%, ${t.hsla.a.toFixed(2)})`},i.formatHex=function(t){return`#${e(t.rgba.r)}${e(t.rgba.g)}${e(t.rgba.b)}`},i.formatHexA=function(i,s=!1){return s&&i.rgba.a===1?t.Format.CSS.formatHex(i):`#${e(i.rgba.r)}${e(i.rgba.g)}${e(i.rgba.b)}${e(Math.round(255*i.rgba.a))}`},i.format=function(i){return i.isOpaque()?t.Format.CSS.formatHex(i):t.Format.CSS.formatRGBA(i)},i.parseHex=function(i){const e=i.length;if(e===0||i.charCodeAt(0)!==35)return null;if(e===7){const e=16*s(i.charCodeAt(1))+s(i.charCodeAt(2)),n=16*s(i.charCodeAt(3))+s(i.charCodeAt(4)),r=16*s(i.charCodeAt(5))+s(i.charCodeAt(6));return new t(new vp(e,n,r,1))}if(e===9){const e=16*s(i.charCodeAt(1))+s(i.charCodeAt(2)),n=16*s(i.charCodeAt(3))+s(i.charCodeAt(4)),r=16*s(i.charCodeAt(5))+s(i.charCodeAt(6)),o=16*s(i.charCodeAt(7))+s(i.charCodeAt(8));return new t(new vp(e,n,r,o/255))}if(e===4){const e=s(i.charCodeAt(1)),n=s(i.charCodeAt(2)),r=s(i.charCodeAt(3));return new t(new vp(16*e+e,16*n+n,16*r+r))}if(e===5){const e=s(i.charCodeAt(1)),n=s(i.charCodeAt(2)),r=s(i.charCodeAt(3)),o=s(i.charCodeAt(4));return new t(new vp(16*e+e,16*n+n,16*r+r,(16*o+o)/255))}return null}})((i=t.Format||(t.Format={})).CSS||(i.CSS={}))}(kp||(kp={}));const Fp=new RegExp("\\bMARK:\\s*(.*)$","d"),Tp=/^-+|-+$/g;function Rp(t,i){var e;let s=[];if(i.findRegionSectionHeaders&&(!((e=i.foldingRules)===null||e===void 0)&&e.markers)){const e=function(t,i){const e=[],s=t.getLineCount();for(let n=1;n<=s;n++){const s=t.getLineContent(n),r=s.match(i.foldingRules.markers.start);if(r){const t={startLineNumber:n,startColumn:r[0].length+1,endLineNumber:n,endColumn:s.length+1};if(t.endColumn>t.startColumn){const i={range:t,...Ip(s.substring(r[0].length)),shouldBeInComments:!1};(i.text||i.hasSeparatorLine)&&e.push(i)}}}return e}(t,i);s=s.concat(e)}if(i.findMarkSectionHeaders){const i=function(t){const i=[],e=t.getLineCount();for(let s=1;s<=e;s++)Op(t.getLineContent(s),s,i);return i}(t);s=s.concat(i)}return s}function Op(t,i,e){Fp.lastIndex=0;const s=Fp.exec(t);if(s){const t={startLineNumber:i,startColumn:s.indices[1][0]+1,endLineNumber:i,endColumn:s.indices[1][1]+1};if(t.endColumn>t.startColumn){const i={range:t,...Ip(s[1]),shouldBeInComments:!0};(i.text||i.hasSeparatorLine)&&e.push(i)}}}function Ip(t){const i=(t=t.trim()).startsWith("-");return{text:t=t.replace(Tp,""),hasSeparatorLine:i}}class _p extends Rf{get uri(){return this._uri}get eol(){return this._eol}getValue(){return this.getText()}findMatches(t){const i=[];for(let e=0;e<this._lines.length;e++){const s=this._lines[e],n=this.offsetAt(new ks(e+1,1)),r=s.matchAll(t);for(const t of r)(t.index||t.index===0)&&(t.index=t.index+n),i.push(t)}return i}getLinesContent(){return this._lines.slice(0)}getLineCount(){return this._lines.length}getLineContent(t){return this._lines[t-1]}getWordAtPosition(t,i){const e=qt(t.column,Ut(i),this._lines[t.lineNumber-1],0);return e?new Cs(t.lineNumber,e.startColumn,t.lineNumber,e.endColumn):null}words(t){const i=this._lines,e=this._wordenize.bind(this);let s=0,n="",r=0,o=[];return{*[Symbol.iterator](){for(;;)if(r<o.length){const t=n.substring(o[r].start,o[r].end);r+=1,yield t}else{if(!(s<i.length))break;n=i[s],o=e(n,t),r=0,s+=1}}}}getLineWords(t,i){const e=this._lines[t-1],s=this._wordenize(e,i),n=[];for(const t of s)n.push({word:e.substring(t.start,t.end),startColumn:t.start+1,endColumn:t.end+1});return n}_wordenize(t,i){const e=[];let s;for(i.lastIndex=0;(s=i.exec(t))&&s[0].length!==0;)e.push({start:s.index,end:s.index+s[0].length});return e}getValueInRange(t){if((t=this._validateRange(t)).startLineNumber===t.endLineNumber)return this._lines[t.startLineNumber-1].substring(t.startColumn-1,t.endColumn-1);const i=this._eol,e=t.startLineNumber-1,s=t.endLineNumber-1,n=[];n.push(this._lines[e].substring(t.startColumn-1));for(let t=e+1;t<s;t++)n.push(this._lines[t]);return n.push(this._lines[s].substring(0,t.endColumn-1)),n.join(i)}offsetAt(t){return t=this._validatePosition(t),this._ensureLineStarts(),this._lineStarts.getPrefixSum(t.lineNumber-2)+(t.column-1)}positionAt(t){t=Math.floor(t),t=Math.max(0,t),this._ensureLineStarts();const i=this._lineStarts.getIndexOf(t),e=this._lines[i.index].length;return{lineNumber:1+i.index,column:1+Math.min(i.remainder,e)}}_validateRange(t){const i=this._validatePosition({lineNumber:t.startLineNumber,column:t.startColumn}),e=this._validatePosition({lineNumber:t.endLineNumber,column:t.endColumn});return i.lineNumber!==t.startLineNumber||i.column!==t.startColumn||e.lineNumber!==t.endLineNumber||e.column!==t.endColumn?{startLineNumber:i.lineNumber,startColumn:i.column,endLineNumber:e.lineNumber,endColumn:e.column}:t}_validatePosition(t){if(!ks.isIPosition(t))throw new Error("bad position");let{lineNumber:i,column:e}=t,s=!1;if(i<1)i=1,e=1,s=!0;else if(i>this._lines.length)i=this._lines.length,e=this._lines[i-1].length+1,s=!0;else{const t=this._lines[i-1].length+1;e<1?(e=1,s=!0):e>t&&(e=t,s=!0)}return s?{lineNumber:i,column:e}:t}}class Pp{constructor(t,i){this._host=t,this._models=Object.create(null),this._foreignModuleFactory=i,this._foreignModule=null}dispose(){this._models=Object.create(null)}_getModel(t){return this._models[t]}_getModels(){const t=[];return Object.keys(this._models).forEach((i=>t.push(this._models[i]))),t}acceptNewModel(t){this._models[t.url]=new _p(as.parse(t.url),t.lines,t.EOL,t.versionId)}acceptModelChanged(t,i){this._models[t]&&this._models[t].onEvents(i)}acceptRemovedModel(t){this._models[t]&&delete this._models[t]}async computeUnicodeHighlights(t,i,e){const s=this._getModel(t);return s?fg.computeUnicodeHighlights(s,i,e):{ranges:[],hasMore:!1,ambiguousCharacterCount:0,invisibleCharacterCount:0,nonBasicAsciiCharacterCount:0}}async findSectionHeaders(t,i){const e=this._getModel(t);return e?Rp(e,i):[]}async computeDiff(t,i,e,s){const n=this._getModel(t),r=this._getModel(i);return!n||!r?null:Pp.computeDiff(n,r,e,s)}static computeDiff(t,i,e,s){const n=s==="advanced"?mp():pp(),r=t.getLinesContent(),o=i.getLinesContent(),h=n.computeDiff(r,o,e);function c(t){return t.map((t=>{var i;return[t.original.startLineNumber,t.original.endLineNumberExclusive,t.modified.startLineNumber,t.modified.endLineNumberExclusive,(i=t.innerChanges)===null||i===void 0?void 0:i.map((t=>[t.originalRange.startLineNumber,t.originalRange.startColumn,t.originalRange.endLineNumber,t.originalRange.endColumn,t.modifiedRange.startLineNumber,t.modifiedRange.startColumn,t.modifiedRange.endLineNumber,t.modifiedRange.endColumn]))]}))}return{identical:!(h.changes.length>0)&&this._modelsAreIdentical(t,i),quitEarly:h.hitTimeout,changes:c(h.changes),moves:h.moves.map((t=>[t.lineRangeMapping.original.startLineNumber,t.lineRangeMapping.original.endLineNumberExclusive,t.lineRangeMapping.modified.startLineNumber,t.lineRangeMapping.modified.endLineNumberExclusive,c(t.changes)]))}}static _modelsAreIdentical(t,i){const e=t.getLineCount();if(e!==i.getLineCount())return!1;for(let s=1;s<=e;s++)if(t.getLineContent(s)!==i.getLineContent(s))return!1;return!0}async computeMoreMinimalEdits(t,i,e){const s=this._getModel(t);if(!s)return i;const n=[];let r;i=i.slice(0).sort(((t,i)=>t.range&&i.range?Cs.compareRangesUsingStarts(t.range,i.range):(t.range?0:1)-(i.range?0:1)));let o=0;for(let t=1;t<i.length;t++)Cs.getEndPosition(i[o].range).equals(Cs.getStartPosition(i[t].range))?(i[o].range=Cs.fromPositions(Cs.getStartPosition(i[o].range),Cs.getEndPosition(i[t].range)),i[o].text+=i[t].text):(o++,i[o]=i[t]);i.length=o+1;for(let{range:t,text:o,eol:h}of i){if(typeof h=="number"&&(r=h),Cs.isEmpty(t)&&!o)continue;const i=s.getValueInRange(t);if(o=o.replace(/\r\n|\n|\r/g,s.eol),i===o)continue;if(Math.max(o.length,i.length)>Pp._diffLimit){n.push({range:t,text:o});continue}const c=Cf(i,o,e),l=s.offsetAt(Cs.lift(t).getStartPosition());for(const t of c){const i=s.positionAt(l+t.originalStart),e=s.positionAt(l+t.originalStart+t.originalLength),r={text:o.substr(t.modifiedStart,t.modifiedLength),range:{startLineNumber:i.lineNumber,startColumn:i.column,endLineNumber:e.lineNumber,endColumn:e.column}};s.getValueInRange(r.range)!==r.text&&n.push(r)}}return typeof r=="number"&&n.push({eol:r,text:"",range:{startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:0}}),n}async computeLinks(t){const i=this._getModel(t);return i?function(t){return t&&typeof t.getLineCount=="function"&&typeof t.getLineContent=="function"?$f.computeLinks(t):[]}(i):null}async computeDefaultDocumentColors(t){const i=this._getModel(t);return i?Lp(i):null}async textualSuggest(t,i,e,s){const n=new se,r=new RegExp(e,s),o=new Set;t:for(const e of t){const t=this._getModel(e);if(t){for(const e of t.words(r))if(e!==i&&isNaN(Number(e))&&(o.add(e),o.size>Pp._suggestionsLimit))break t}}return{words:Array.from(o),duration:n.elapsed()}}async computeWordRanges(t,i,e,s){const n=this._getModel(t);if(!n)return Object.create(null);const r=new RegExp(e,s),o=Object.create(null);for(let t=i.startLineNumber;t<i.endLineNumber;t++){const i=n.getLineWords(t,r);for(const e of i){if(!isNaN(Number(e.word)))continue;let i=o[e.word];i||(i=[],o[e.word]=i),i.push({startLineNumber:t,startColumn:e.startColumn,endLineNumber:t,endColumn:e.endColumn})}}return o}async navigateValueSet(t,i,e,s,n){const r=this._getModel(t);if(!r)return null;const o=new RegExp(s,n);i.startColumn===i.endColumn&&(i={startLineNumber:i.startLineNumber,startColumn:i.startColumn,endLineNumber:i.endLineNumber,endColumn:i.endColumn+1});const h=r.getValueInRange(i),c=r.getWordAtPosition({lineNumber:i.startLineNumber,column:i.startColumn},o);if(!c)return null;const l=r.getValueInRange(c);return Wf.INSTANCE.navigateValueSet(i,h,c,l,e)}loadForeignModule(t,i,e){const s=function(t,i){const e=t=>function(){const e=Array.prototype.slice.call(arguments,0);return i(t,e)},s={};for(const i of t)s[i]=e(i);return s}(e,((t,i)=>this._host.fhr(t,i))),n={host:s,getMirrorModels:()=>this._getModels()};return this._foreignModuleFactory?(this._foreignModule=this._foreignModuleFactory(n,i),Promise.resolve(Q(this._foreignModule))):Promise.reject(new Error("Unexpected usage"))}fmr(t,i){if(!this._foreignModule||typeof this._foreignModule[t]!="function")return Promise.reject(new Error("Missing requestHandler or method: "+t));try{return Promise.resolve(this._foreignModule[t].apply(this._foreignModule,i))}catch(t){return Promise.reject(t)}}}Pp._diffLimit=1e5,Pp._suggestionsLimit=1e4,typeof importScripts=="function"&&(globalThis.monaco=$n());const Np=_l("textResourceConfigurationService"),Bp=_l("textResourcePropertiesService"),$p=_l("ILanguageFeaturesService");var Wp=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},jp=function(t,i){return function(e,s){i(e,s,t)}};const Hp=3e5;function Vp(t,i){const e=t.getModel(i);return!!e&&!e.isTooLargeForSyncing()}let zp=class extends Qi{constructor(t,i,e,s,n){super(),this._modelService=t,this._workerManager=this._register(new Kp(this._modelService,s)),this._logService=e,this._register(n.linkProvider.register({language:"*",hasAccessToAllModels:!0},{provideLinks:(t,i)=>Vp(this._modelService,t.uri)?this._workerManager.withWorker().then((i=>i.computeLinks(t.uri))).then((t=>t&&{links:t})):Promise.resolve({links:[]})})),this._register(n.completionProvider.register("*",new Up(this._workerManager,i,this._modelService,s)))}dispose(){super.dispose()}canComputeUnicodeHighlights(t){return Vp(this._modelService,t)}computedUnicodeHighlights(t,i,e){return this._workerManager.withWorker().then((s=>s.computedUnicodeHighlights(t,i,e)))}async computeDiff(t,i,e,s){const n=await this._workerManager.withWorker().then((n=>n.computeDiff(t,i,e,s)));if(!n)return null;return{identical:n.identical,quitEarly:n.quitEarly,changes:r(n.changes),moves:n.moves.map((t=>new wg(new Lg(new Ag(t[0],t[1]),new Ag(t[2],t[3])),r(t[4]))))};function r(t){return t.map((t=>{var i;return new Fg(new Ag(t[0],t[1]),new Ag(t[2],t[3]),(i=t[4])===null||i===void 0?void 0:i.map((t=>new Tg(new Cs(t[0],t[1],t[2],t[3]),new Cs(t[4],t[5],t[6],t[7])))))}))}}computeMoreMinimalEdits(t,i,e=!1){if(f(i)){if(!Vp(this._modelService,t))return Promise.resolve(i);const s=se.create(),n=this._workerManager.withWorker().then((s=>s.computeMoreMinimalEdits(t,i,e)));return n.finally((()=>this._logService.trace("FORMAT#computeMoreMinimalEdits",t.toString(!0),s.elapsed()))),Promise.race([n,wo(1e3).then((()=>i))])}return Promise.resolve(void 0)}canNavigateValueSet(t){return Vp(this._modelService,t)}navigateValueSet(t,i,e){return this._workerManager.withWorker().then((s=>s.navigateValueSet(t,i,e)))}canComputeWordRanges(t){return Vp(this._modelService,t)}computeWordRanges(t,i){return this._workerManager.withWorker().then((e=>e.computeWordRanges(t,i)))}findSectionHeaders(t,i){return this._workerManager.withWorker().then((e=>e.findSectionHeaders(t,i)))}};zp=Wp([jp(0,Nl),jp(1,Np),jp(2,ou),jp(3,cf),jp(4,$p)],zp);class Up{constructor(t,i,e,s){this.languageConfigurationService=s,this._debugDisplayName="wordbasedCompletions",this._workerManager=t,this._configurationService=i,this._modelService=e}async provideCompletionItems(t,i){const e=this._configurationService.getValue(t.uri,i,"editor");if(e.wordBasedSuggestions==="off")return;const s=[];if(e.wordBasedSuggestions==="currentDocument")Vp(this._modelService,t.uri)&&s.push(t.uri);else for(const i of this._modelService.getModels())Vp(this._modelService,i.uri)&&(i===t?s.unshift(i.uri):e.wordBasedSuggestions!=="allDocuments"&&i.getLanguageId()!==t.getLanguageId()||s.push(i.uri));if(s.length===0)return;const n=this.languageConfigurationService.getLanguageConfiguration(t.getLanguageId()).getWordDefinition(),r=t.getWordAtPosition(i),o=r?new Cs(i.lineNumber,r.startColumn,i.lineNumber,r.endColumn):Cs.fromPositions(i),h=o.setEndPosition(i.lineNumber,i.column),c=await this._workerManager.withWorker(),l=await c.textualSuggest(s,r==null?void 0:r.word,n);return l?{duration:l.duration,suggestions:l.words.map((t=>({kind:18,label:t,insertText:t,range:{insert:h,replace:o}})))}:void 0}}class Kp extends Qi{constructor(t,i){super(),this.languageConfigurationService=i,this._modelService=t,this._editorWorkerClient=null,this._lastWorkerUsedTime=(new Date).getTime(),this._register(new uc).cancelAndSet((()=>this._checkStopIdleWorker()),Math.round(15e4),Wn),this._register(this._modelService.onModelRemoved((t=>this._checkStopEmptyWorker())))}dispose(){this._editorWorkerClient&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null),super.dispose()}_checkStopEmptyWorker(){this._editorWorkerClient&&this._modelService.getModels().length===0&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}_checkStopIdleWorker(){this._editorWorkerClient&&(new Date).getTime()-this._lastWorkerUsedTime>Hp&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}withWorker(){return this._lastWorkerUsedTime=(new Date).getTime(),this._editorWorkerClient||(this._editorWorkerClient=new Jp(this._modelService,!1,"editorWorkerService",this.languageConfigurationService)),Promise.resolve(this._editorWorkerClient)}}class qp extends Qi{constructor(t,i,e){if(super(),this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),this._proxy=t,this._modelService=i,!e){const t=new ko;t.cancelAndSet((()=>this._checkStopModelSync()),Math.round(3e4)),this._register(t)}}dispose(){for(const t in this._syncedModels)qi(this._syncedModels[t]);this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),super.dispose()}ensureSyncedResources(t,i){for(const e of t){const t=e.toString();this._syncedModels[t]||this._beginModelSync(e,i),this._syncedModels[t]&&(this._syncedModelsLastUsedTime[t]=(new Date).getTime())}}_checkStopModelSync(){const t=(new Date).getTime(),i=[];for(const e in this._syncedModelsLastUsedTime)t-this._syncedModelsLastUsedTime[e]>6e4&&i.push(e);for(const t of i)this._stopModelSync(t)}_beginModelSync(t,i){const e=this._modelService.getModel(t);if(!e||!i&&e.isTooLargeForSyncing())return;const s=t.toString();this._proxy.acceptNewModel({url:e.uri.toString(),lines:e.getLinesContent(),EOL:e.getEOL(),versionId:e.getVersionId()});const n=new Ji;n.add(e.onDidChangeContent((t=>{this._proxy.acceptModelChanged(s.toString(),t)}))),n.add(e.onWillDispose((()=>{this._stopModelSync(s)}))),n.add(Zi((()=>{this._proxy.acceptRemovedModel(s)}))),this._syncedModels[s]=n}_stopModelSync(t){const i=this._syncedModels[t];delete this._syncedModels[t],delete this._syncedModelsLastUsedTime[t],qi(i)}}class Gp{constructor(t){this._instance=t,this._proxyObj=Promise.resolve(this._instance)}dispose(){this._instance.dispose()}getProxyObject(){return this._proxyObj}}class Zp{constructor(t){this._workerClient=t}fhr(t,i){return this._workerClient.fhr(t,i)}}class Jp extends Qi{constructor(t,i,e,s){super(),this.languageConfigurationService=s,this._disposed=!1,this._modelService=t,this._keepIdleModels=i,this._workerFactory=new zu(e),this._worker=null,this._modelManager=null}fhr(t,i){throw new Error("Not implemented!")}_getOrCreateWorker(){if(!this._worker)try{this._worker=this._register(new Bu(this._workerFactory,"vs/editor/common/services/editorSimpleWorker",new Zp(this)))}catch(t){Tu(t),this._worker=new Gp(new Pp(new Zp(this),null))}return this._worker}_getProxy(){return this._getOrCreateWorker().getProxyObject().then(void 0,(t=>(Tu(t),this._worker=new Gp(new Pp(new Zp(this),null)),this._getOrCreateWorker().getProxyObject())))}_getOrCreateModelManager(t){return this._modelManager||(this._modelManager=this._register(new qp(t,this._modelService,this._keepIdleModels))),this._modelManager}async _withSyncedResources(t,i=!1){return this._disposed?Promise.reject(function(){const t=new Error(Ni);return t.name=t.message,t}()):this._getProxy().then((e=>(this._getOrCreateModelManager(e).ensureSyncedResources(t,i),e)))}computedUnicodeHighlights(t,i,e){return this._withSyncedResources([t]).then((s=>s.computeUnicodeHighlights(t.toString(),i,e)))}computeDiff(t,i,e,s){return this._withSyncedResources([t,i],!0).then((n=>n.computeDiff(t.toString(),i.toString(),e,s)))}computeMoreMinimalEdits(t,i,e){return this._withSyncedResources([t]).then((s=>s.computeMoreMinimalEdits(t.toString(),i,e)))}computeLinks(t){return this._withSyncedResources([t]).then((i=>i.computeLinks(t.toString())))}computeDefaultDocumentColors(t){return this._withSyncedResources([t]).then((i=>i.computeDefaultDocumentColors(t.toString())))}async textualSuggest(t,i,e){const s=await this._withSyncedResources(t),n=e.source,r=e.flags;return s.textualSuggest(t.map((t=>t.toString())),i,n,r)}computeWordRanges(t,i){return this._withSyncedResources([t]).then((e=>{const s=this._modelService.getModel(t);if(!s)return Promise.resolve(null);const n=this.languageConfigurationService.getLanguageConfiguration(s.getLanguageId()).getWordDefinition(),r=n.source,o=n.flags;return e.computeWordRanges(t.toString(),i,r,o)}))}navigateValueSet(t,i,e){return this._withSyncedResources([t]).then((s=>{const n=this._modelService.getModel(t);if(!n)return null;const r=this.languageConfigurationService.getLanguageConfiguration(n.getLanguageId()).getWordDefinition(),o=r.source,h=r.flags;return s.navigateValueSet(t.toString(),i,e,o,h)}))}findSectionHeaders(t,i){return this._withSyncedResources([t]).then((e=>e.findSectionHeaders(t.toString(),i)))}dispose(){super.dispose(),this._disposed=!0}}class Qp extends Jp{constructor(t,i,e){super(t,e.keepIdleModels||!1,e.label,i),this._foreignModuleId=e.moduleId,this._foreignModuleCreateData=e.createData||null,this._foreignModuleHost=e.host||null,this._foreignProxy=null}fhr(t,i){if(!this._foreignModuleHost||typeof this._foreignModuleHost[t]!="function")return Promise.reject(new Error("Missing method "+t+" or missing main thread foreign host."));try{return Promise.resolve(this._foreignModuleHost[t].apply(this._foreignModuleHost,i))}catch(t){return Promise.reject(t)}}_getForeignProxy(){return this._foreignProxy||(this._foreignProxy=this._getProxy().then((t=>{const i=this._foreignModuleHost?Q(this._foreignModuleHost):[];return t.loadForeignModule(this._foreignModuleId,this._foreignModuleCreateData,i).then((i=>{this._foreignModuleCreateData=null;const e=(i,e)=>t.fmr(i,e),s=(t,i)=>function(){const e=Array.prototype.slice.call(arguments,0);return i(t,e)},n={};for(const t of i)n[t]=s(t,e);return n}))}))),this._foreignProxy}getProxy(){return this._getForeignProxy()}withSyncedResources(t){return this._withSyncedResources(t).then((t=>this.getProxy()))}}const Yp={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"},Xp=new class{clone(){return this}equals(t){return this===t}};function tm(t,i){return new Fs([new Ls(0,"",t)],i)}function im(t,i){const e=new Uint32Array(2);return e[0]=0,e[1]=(32768|t|2<<24)>>>0,new Ts(e,i===null?Xp:i)}class em{static getLanguageId(t){return(255&t)>>>0}static getTokenType(t){return(768&t)>>>8}static containsBalancedBrackets(t){return!!(1024&t)}static getFontStyle(t){return(30720&t)>>>11}static getForeground(t){return(16744448&t)>>>15}static getBackground(t){return(4278190080&t)>>>24}static getClassNameFromMetadata(t){let i="mtk"+this.getForeground(t);const e=this.getFontStyle(t);return 1&e&&(i+=" mtki"),2&e&&(i+=" mtkb"),4&e&&(i+=" mtku"),8&e&&(i+=" mtks"),i}static getInlineStyleFromMetadata(t,i){const e=this.getForeground(t),s=this.getFontStyle(t);let n=`color: ${i[e]};`;1&s&&(n+="font-style: italic;"),2&s&&(n+="font-weight: bold;");let r="";return 4&s&&(r+=" underline"),8&s&&(r+=" line-through"),r&&(n+=`text-decoration:${r};`),n}static getPresentationFromMetadata(t){const i=this.getForeground(t),e=this.getFontStyle(t);return{foreground:i,italic:!!(1&e),bold:!!(2&e),underline:!!(4&e),strikethrough:!!(8&e)}}}class sm{static createEmpty(t,i){const e=sm.defaultTokenMetadata,s=new Uint32Array(2);return s[0]=t.length,s[1]=e,new sm(s,t,i)}constructor(t,i,e){this._lineTokensBrand=void 0,this._tokens=t,this._tokensCount=this._tokens.length>>>1,this._text=i,this._languageIdCodec=e}equals(t){return t instanceof sm&&this.slicedEquals(t,0,this._tokensCount)}slicedEquals(t,i,e){if(this._text!==t._text||this._tokensCount!==t._tokensCount)return!1;const s=i<<1,n=s+(e<<1);for(let i=s;i<n;i++)if(this._tokens[i]!==t._tokens[i])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(t){return t>0?this._tokens[t-1<<1]:0}getMetadata(t){return this._tokens[1+(t<<1)]}getLanguageId(t){const i=this._tokens[1+(t<<1)],e=em.getLanguageId(i);return this._languageIdCodec.decodeLanguageId(e)}getStandardTokenType(t){const i=this._tokens[1+(t<<1)];return em.getTokenType(i)}getForeground(t){const i=this._tokens[1+(t<<1)];return em.getForeground(i)}getClassName(t){const i=this._tokens[1+(t<<1)];return em.getClassNameFromMetadata(i)}getInlineStyle(t,i){const e=this._tokens[1+(t<<1)];return em.getInlineStyleFromMetadata(e,i)}getPresentation(t){const i=this._tokens[1+(t<<1)];return em.getPresentationFromMetadata(i)}getEndOffset(t){return this._tokens[t<<1]}findTokenIndexAtOffset(t){return sm.findIndexInTokensArray(this._tokens,t)}inflate(){return this}sliceAndInflate(t,i,e){return new nm(this,t,i,e)}static convertToEndOffset(t,i){const e=(t.length>>>1)-1;for(let i=0;i<e;i++)t[i<<1]=t[i+1<<1];t[e<<1]=i}static findIndexInTokensArray(t,i){if(t.length<=2)return 0;let e=0,s=(t.length>>>1)-1;for(;e<s;){const n=e+Math.floor((s-e)/2),r=t[n<<1];if(r===i)return n+1;r<i?e=n+1:r>i&&(s=n)}return e}withInserted(t){if(t.length===0)return this;let i=0,e=0,s="";const n=new Array;let r=0;for(;;){const o=i<this._tokensCount?this._tokens[i<<1]:-1,h=e<t.length?t[e]:null;if(o!==-1&&(h===null||o<=h.offset)){s+=this._text.substring(r,o);const t=this._tokens[1+(i<<1)];n.push(s.length,t),i++,r=o}else{if(!h)break;if(h.offset>r){s+=this._text.substring(r,h.offset);const t=this._tokens[1+(i<<1)];n.push(s.length,t),r=h.offset}s+=h.text,n.push(s.length,h.tokenMetadata),e++}}return new sm(new Uint32Array(n),s,this._languageIdCodec)}}sm.defaultTokenMetadata=33587200;class nm{constructor(t,i,e,s){this._source=t,this._startOffset=i,this._endOffset=e,this._deltaOffset=s,this._firstTokenIndex=t.findTokenIndexAtOffset(i),this._tokensCount=0;for(let i=this._firstTokenIndex,s=t.getCount();i<s&&!(t.getStartOffset(i)>=e);i++)this._tokensCount++}getMetadata(t){return this._source.getMetadata(this._firstTokenIndex+t)}getLanguageId(t){return this._source.getLanguageId(this._firstTokenIndex+t)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(t){return t instanceof nm&&this._startOffset===t._startOffset&&this._endOffset===t._endOffset&&this._deltaOffset===t._deltaOffset&&this._source.slicedEquals(t._source,this._firstTokenIndex,this._tokensCount)}getCount(){return this._tokensCount}getForeground(t){return this._source.getForeground(this._firstTokenIndex+t)}getEndOffset(t){const i=this._source.getEndOffset(this._firstTokenIndex+t);return Math.min(this._endOffset,i)-this._startOffset+this._deltaOffset}getClassName(t){return this._source.getClassName(this._firstTokenIndex+t)}getInlineStyle(t,i){return this._source.getInlineStyle(this._firstTokenIndex+t,i)}getPresentation(t){return this._source.getPresentation(this._firstTokenIndex+t)}findTokenIndexAtOffset(t){return this._source.findTokenIndexAtOffset(t+this._startOffset-this._deltaOffset)-this._firstTokenIndex}}class rm{constructor(t,i,e,s){this.startColumn=t,this.endColumn=i,this.className=e,this.type=s,this._lineDecorationBrand=void 0}static _equals(t,i){return t.startColumn===i.startColumn&&t.endColumn===i.endColumn&&t.className===i.className&&t.type===i.type}static equalsArr(t,i){const e=t.length;if(e!==i.length)return!1;for(let s=0;s<e;s++)if(!rm._equals(t[s],i[s]))return!1;return!0}static extractWrapped(t,i,e){if(t.length===0)return t;const s=i+1,n=e+1,r=e-i,o=[];let h=0;for(const i of t)i.endColumn<=s||i.startColumn>=n||(o[h++]=new rm(Math.max(1,i.startColumn-s+1),Math.min(r+1,i.endColumn-s+1),i.className,i.type));return o}static filter(t,i,e,s){if(t.length===0)return[];const n=[];let r=0;for(let o=0,h=t.length;o<h;o++){const h=t[o],c=h.range;if(c.endLineNumber<i||c.startLineNumber>i||c.isEmpty()&&(h.type===0||h.type===3))continue;const l=c.startLineNumber===i?c.startColumn:e,a=c.endLineNumber===i?c.endColumn:s;n[r++]=new rm(l,a,h.inlineClassName,h.type)}return n}static _typeCompare(t,i){const e=[2,0,1,3];return e[t]-e[i]}static compare(t,i){if(t.startColumn!==i.startColumn)return t.startColumn-i.startColumn;if(t.endColumn!==i.endColumn)return t.endColumn-i.endColumn;const e=rm._typeCompare(t.type,i.type);return e!==0?e:t.className!==i.className?t.className<i.className?-1:1:0}}class om{constructor(t,i,e,s){this.startOffset=t,this.endOffset=i,this.className=e,this.metadata=s}}class hm{constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(t){let i=0;for(let e=0,s=t.length;e<s;e++)i|=t[e];return i}consumeLowerThan(t,i,e){for(;this.count>0&&this.stopOffsets[0]<t;){let t=0;for(;t+1<this.count&&this.stopOffsets[t]===this.stopOffsets[t+1];)t++;e.push(new om(i,this.stopOffsets[t],this.classNames.join(" "),hm._metadata(this.metadata))),i=this.stopOffsets[t]+1,this.stopOffsets.splice(0,t+1),this.classNames.splice(0,t+1),this.metadata.splice(0,t+1),this.count-=t+1}return this.count>0&&i<t&&(e.push(new om(i,t-1,this.classNames.join(" "),hm._metadata(this.metadata))),i=t),i}insert(t,i,e){if(this.count===0||this.stopOffsets[this.count-1]<=t)this.stopOffsets.push(t),this.classNames.push(i),this.metadata.push(e);else for(let s=0;s<this.count;s++)if(this.stopOffsets[s]>=t){this.stopOffsets.splice(s,0,t),this.classNames.splice(s,0,i),this.metadata.splice(s,0,e);break}this.count++}}class cm{static normalize(t,i){if(i.length===0)return[];const e=[],s=new hm;let n=0;for(let r=0,o=i.length;r<o;r++){const o=i[r];let h=o.startColumn,c=o.endColumn;const l=o.className,a=o.type===1?2:o.type===2?4:0;h>1&&gr(t.charCodeAt(h-2))&&h--,c>1&&gr(t.charCodeAt(c-2))&&c--;const u=h-1,d=c-2;n=s.consumeLowerThan(u,n,e),s.count===0&&(n=u),s.insert(d,l,a)}return s.consumeLowerThan(1073741824,n,e),e}}class lm{constructor(t,i,e,s){this.endIndex=t,this.type=i,this.metadata=e,this.containsRTL=s,this._linePartBrand=void 0}isWhitespace(){return!!(1&this.metadata)}isPseudoAfter(){return!!(4&this.metadata)}}class am{constructor(t,i){this.startOffset=t,this.endOffset=i}equals(t){return this.startOffset===t.startOffset&&this.endOffset===t.endOffset}}class um{constructor(t,i,e,s,n,r,o,h,c,l,a,u,d,f,g,p,m,w,v){this.useMonospaceOptimizations=t,this.canUseHalfwidthRightwardsArrow=i,this.lineContent=e,this.continuesWithWrappedLine=s,this.isBasicASCII=n,this.containsRTL=r,this.fauxIndentLength=o,this.lineTokens=h,this.lineDecorations=c.sort(rm.compare),this.tabSize=l,this.startVisibleColumn=a,this.spaceWidth=u,this.stopRenderingLineAfter=g,this.renderWhitespace=p==="all"?4:p==="boundary"?1:p==="selection"?2:p==="trailing"?3:0,this.renderControlCharacters=m,this.fontLigatures=w,this.selectionsOnLine=v&&v.sort(((t,i)=>t.startOffset<i.startOffset?-1:1)),Math.abs(f-u)<Math.abs(d-u)?(this.renderSpaceWidth=f,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=d,this.renderSpaceCharCode=183)}sameSelection(t){if(this.selectionsOnLine===null)return t===null;if(t===null||t.length!==this.selectionsOnLine.length)return!1;for(let i=0;i<this.selectionsOnLine.length;i++)if(!this.selectionsOnLine[i].equals(t[i]))return!1;return!0}equals(t){return this.useMonospaceOptimizations===t.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===t.canUseHalfwidthRightwardsArrow&&this.lineContent===t.lineContent&&this.continuesWithWrappedLine===t.continuesWithWrappedLine&&this.isBasicASCII===t.isBasicASCII&&this.containsRTL===t.containsRTL&&this.fauxIndentLength===t.fauxIndentLength&&this.tabSize===t.tabSize&&this.startVisibleColumn===t.startVisibleColumn&&this.spaceWidth===t.spaceWidth&&this.renderSpaceWidth===t.renderSpaceWidth&&this.renderSpaceCharCode===t.renderSpaceCharCode&&this.stopRenderingLineAfter===t.stopRenderingLineAfter&&this.renderWhitespace===t.renderWhitespace&&this.renderControlCharacters===t.renderControlCharacters&&this.fontLigatures===t.fontLigatures&&rm.equalsArr(this.lineDecorations,t.lineDecorations)&&this.lineTokens.equals(t.lineTokens)&&this.sameSelection(t.selectionsOnLine)}}class dm{constructor(t,i){this.partIndex=t,this.charIndex=i}}class fm{static getPartIndex(t){return(4294901760&t)>>>16}static getCharIndex(t){return(65535&t)>>>0}constructor(t,i){this.length=t,this._data=new Uint32Array(this.length),this._horizontalOffset=new Uint32Array(this.length)}setColumnInfo(t,i,e,s){const n=(i<<16|e)>>>0;this._data[t-1]=n,this._horizontalOffset[t-1]=s}getHorizontalOffset(t){return this._horizontalOffset.length===0?0:this._horizontalOffset[t-1]}charOffsetToPartData(t){return this.length===0?0:t<0?this._data[0]:t>=this.length?this._data[this.length-1]:this._data[t]}getDomPosition(t){const i=this.charOffsetToPartData(t-1),e=fm.getPartIndex(i),s=fm.getCharIndex(i);return new dm(e,s)}getColumn(t,i){return this.partDataToCharOffset(t.partIndex,i,t.charIndex)+1}partDataToCharOffset(t,i,e){if(this.length===0)return 0;const s=(t<<16|e)>>>0;let n=0,r=this.length-1;for(;n+1<r;){const t=n+r>>>1,i=this._data[t];if(i===s)return t;i>s?r=t:n=t}if(n===r)return n;const o=this._data[n],h=this._data[r];if(o===s)return n;if(h===s)return r;const c=fm.getPartIndex(o),l=fm.getCharIndex(o);let a;return a=c!==fm.getPartIndex(h)?i:fm.getCharIndex(h),e-l<=a-e?n:r}}class gm{constructor(t,i,e){this._renderLineOutputBrand=void 0,this.characterMapping=t,this.containsRTL=i,this.containsForeignElements=e}}function pm(t,i){if(t.lineContent.length===0){if(t.lineDecorations.length>0){i.appendString("<span>");let e=0,s=0,n=0;for(const r of t.lineDecorations)r.type!==1&&r.type!==2||(i.appendString('<span class="'),i.appendString(r.className),i.appendString('"></span>'),r.type===1&&(n|=1,e++),r.type===2&&(n|=2,s++));i.appendString("</span>");const r=new fm(1,e+s);return r.setColumnInfo(1,e,0,0),new gm(r,!1,n)}return i.appendString("<span><span></span></span>"),new gm(new fm(0,0),!1,0)}return function(t,i){const e=t.fontIsMonospace,s=t.canUseHalfwidthRightwardsArrow,n=t.containsForeignElements,r=t.lineContent,o=t.len,h=t.isOverflowing,c=t.overflowingCharCount,l=t.parts,a=t.fauxIndentLength,u=t.tabSize,d=t.startVisibleColumn,f=t.containsRTL,g=t.spaceWidth,p=t.renderSpaceCharCode,m=t.renderWhitespace,w=t.renderControlCharacters,v=new fm(o+1,l.length);let b=!1,y=0,k=d,C=0,S=0,x=0;f?i.appendString('<span dir="ltr">'):i.appendString("<span>");for(let t=0,h=l.length;t<h;t++){const h=l[t],c=h.endIndex,d=h.type,f=h.containsRTL,D=m!==0&&h.isWhitespace(),E=D&&!e&&(d==="mtkw"||!n),A=y===c&&h.isPseudoAfter();if(C=0,i.appendString("<span "),f&&i.appendString('style="unicode-bidi:isolate" '),i.appendString('class="'),i.appendString(E?"mtkz":d),i.appendASCIICharCode(34),D){let e=0;{let t=y,i=k;for(;t<c;t++){const s=0|(r.charCodeAt(t)===9?u-i%u:1);e+=s,t>=a&&(i+=s)}}for(E&&(i.appendString(' style="width:'),i.appendString(String(g*e)),i.appendString('px"')),i.appendASCIICharCode(62);y<c;y++){v.setColumnInfo(y+1,t-x,C,S),x=0;let e,n;if(r.charCodeAt(y)===9){e=u-k%u|0,n=e,!s||n>1?i.appendCharCode(8594):i.appendCharCode(65515);for(let t=2;t<=n;t++)i.appendCharCode(160)}else e=2,n=1,i.appendCharCode(p),i.appendCharCode(8204);C+=e,S+=n,y>=a&&(k+=n)}}else for(i.appendASCIICharCode(62);y<c;y++){v.setColumnInfo(y+1,t-x,C,S),x=0;const e=r.charCodeAt(y);let s=1,n=1;switch(e){case 9:s=u-k%u,n=s;for(let t=1;t<=s;t++)i.appendCharCode(160);break;case 32:i.appendCharCode(160);break;case 60:i.appendString("&lt;");break;case 62:i.appendString("&gt;");break;case 38:i.appendString("&amp;");break;case 0:w?i.appendCharCode(9216):i.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:i.appendCharCode(65533);break;default:Mr(e)&&n++,w&&e<32?i.appendCharCode(9216+e):w&&e===127?i.appendCharCode(9249):w&&bm(e)?(i.appendString("[U+"),i.appendString(ym(e)),i.appendString("]"),s=8,n=s):i.appendCharCode(e)}C+=s,S+=n,y>=a&&(k+=n)}A?x++:x=0,y>=o&&!b&&h.isPseudoAfter()&&(b=!0,v.setColumnInfo(y+1,t,C,S)),i.appendString("</span>")}return b||v.setColumnInfo(o+1,l.length-1,C,S),h&&(i.appendString('<span class="mtkoverflow">'),i.appendString(tt(0,"Show more ({0})",function(t){return t<1024?tt(0,"{0} chars",t):t<1048576?`${(t/1024).toFixed(1)} KB`:`${(t/1024/1024).toFixed(1)} MB`}(c))),i.appendString("</span>")),i.appendString("</span>"),new gm(v,f,n)}(function(t){const i=t.lineContent;let e,s,n;t.stopRenderingLineAfter!==-1&&t.stopRenderingLineAfter<i.length?(e=!0,s=i.length-t.stopRenderingLineAfter,n=t.stopRenderingLineAfter):(e=!1,s=0,n=i.length);let r=function(t,i,e,s,n){const r=[];let o=0;s>0&&(r[o++]=new lm(s,"",0,!1));let h=s;for(let c=0,l=e.getCount();c<l;c++){const l=e.getEndOffset(c);if(l<=s)continue;const a=e.getClassName(c);if(l>=n){const e=!!i&&Sr(t.substring(h,n));r[o++]=new lm(n,a,0,e);break}const u=!!i&&Sr(t.substring(h,l));r[o++]=new lm(l,a,0,u),h=l}return r}(i,t.containsRTL,t.lineTokens,t.fauxIndentLength,n);t.renderControlCharacters&&!t.isBasicASCII&&(r=function(t,i){const e=[];let s=new lm(0,"",0,!1),n=0;for(const r of i){const i=r.endIndex;for(;n<i;n++)bm(t.charCodeAt(n))&&(n>s.endIndex&&(s=new lm(n,r.type,r.metadata,r.containsRTL),e.push(s)),s=new lm(n+1,"mtkcontrol",r.metadata,!1),e.push(s));n>s.endIndex&&(s=new lm(i,r.type,r.metadata,r.containsRTL),e.push(s))}return e}(i,r)),(t.renderWhitespace===4||t.renderWhitespace===1||t.renderWhitespace===2&&t.selectionsOnLine||t.renderWhitespace===3&&!t.continuesWithWrappedLine)&&(r=function(t,i,e,s){const n=t.continuesWithWrappedLine,r=t.fauxIndentLength,o=t.tabSize,h=t.startVisibleColumn,c=t.useMonospaceOptimizations,l=t.selectionsOnLine,a=t.renderWhitespace===1,u=t.renderWhitespace===3,d=t.renderSpaceWidth!==t.spaceWidth,f=[];let g=0,p=0,m=s[p].type,w=s[p].containsRTL,v=s[p].endIndex;const b=s.length;let y,k=!1,C=tr(i);C===-1?(k=!0,C=e,y=e):y=er(i);let S=!1,x=0,D=l&&l[x],E=h%o;for(let t=r;t<e;t++){const n=i.charCodeAt(t);let h;if(D&&t>=D.endOffset&&(x++,D=l&&l[x]),t<C||t>y)h=!0;else if(n===9)h=!0;else if(n===32)if(a)if(S)h=!0;else{const s=t+1<e?i.charCodeAt(t+1):0;h=s===32||s===9}else h=!0;else h=!1;if(h&&l&&(h=!!D&&D.startOffset<=t&&D.endOffset>t),h&&u&&(h=k||t>y),h&&w&&t>=C&&t<=y&&(h=!1),S){if(!h||!c&&E>=o){if(d)for(let i=(g>0?f[g-1].endIndex:r)+1;i<=t;i++)f[g++]=new lm(i,"mtkw",1,!1);else f[g++]=new lm(t,"mtkw",1,!1);E%=o}}else(t===v||h&&t>r)&&(f[g++]=new lm(t,m,0,w),E%=o);for(n===9?E=o:Mr(n)?E+=2:E++,S=h;t===v&&(p++,p<b);)m=s[p].type,w=s[p].containsRTL,v=s[p].endIndex}let A=!1;if(S)if(n&&a){const t=e>0?i.charCodeAt(e-1):0,s=e>1?i.charCodeAt(e-2):0;t===32&&s!==32&&s!==9||(A=!0)}else A=!0;if(A)if(d)for(let t=(g>0?f[g-1].endIndex:r)+1;t<=e;t++)f[g++]=new lm(t,"mtkw",1,!1);else f[g++]=new lm(e,"mtkw",1,!1);else f[g++]=new lm(e,m,0,w);return f}(t,i,n,r));let o=0;if(t.lineDecorations.length>0){for(let i=0,e=t.lineDecorations.length;i<e;i++){const e=t.lineDecorations[i];e.type===3||e.type===1?o|=1:e.type===2&&(o|=2)}r=function(t,i,e,s){s.sort(rm.compare);const n=cm.normalize(t,s),r=n.length;let o=0;const h=[];let c=0,l=0;for(let t=0,i=e.length;t<i;t++){const i=e[t],s=i.endIndex,a=i.type,u=i.metadata,d=i.containsRTL;for(;o<r&&n[o].startOffset<s;){const t=n[o];if(t.startOffset>l&&(l=t.startOffset,h[c++]=new lm(l,a,u,d)),!(t.endOffset+1<=s)){l=s,h[c++]=new lm(l,a+" "+t.className,u|t.metadata,d);break}l=t.endOffset+1,h[c++]=new lm(l,a+" "+t.className,u|t.metadata,d),o++}s>l&&(l=s,h[c++]=new lm(l,a,u,d))}const a=e[e.length-1].endIndex;if(o<r&&n[o].startOffset===a)for(;o<r&&n[o].startOffset===a;){const t=n[o];h[c++]=new lm(l,t.className,t.metadata,!1),o++}return h}(i,0,r,t.lineDecorations)}return t.containsRTL||(r=function(t,i,e){let s=0;const n=[];let r=0;if(e)for(let e=0,o=i.length;e<o;e++){const o=i[e],h=o.endIndex;if(s+50<h){const i=o.type,e=o.metadata,c=o.containsRTL;let l=-1,a=s;for(let o=s;o<h;o++)t.charCodeAt(o)===32&&(l=o),l!==-1&&o-a>=50&&(n[r++]=new lm(l+1,i,e,c),a=l+1,l=-1);a!==h&&(n[r++]=new lm(h,i,e,c))}else n[r++]=o;s=h}else for(let t=0,e=i.length;t<e;t++){const e=i[t],o=e.endIndex,h=o-s;if(h>50){const t=e.type,i=e.metadata,c=e.containsRTL,l=Math.ceil(h/50);for(let e=1;e<l;e++){const o=s+50*e;n[r++]=new lm(o,t,i,c)}n[r++]=new lm(o,t,i,c)}else n[r++]=e;s=o}return n}(i,r,!t.isBasicASCII||t.fontLigatures)),new vm(t.useMonospaceOptimizations,t.canUseHalfwidthRightwardsArrow,i,n,e,s,r,o,t.fauxIndentLength,t.tabSize,t.startVisibleColumn,t.containsRTL,t.spaceWidth,t.renderSpaceCharCode,t.renderWhitespace,t.renderControlCharacters)}(t),i)}class mm{constructor(t,i,e,s){this.characterMapping=t,this.html=i,this.containsRTL=e,this.containsForeignElements=s}}function wm(t){const i=new gd(1e4),e=pm(t,i);return new mm(e.characterMapping,i.build(),e.containsRTL,e.containsForeignElements)}class vm{constructor(t,i,e,s,n,r,o,h,c,l,a,u,d,f,g,p){this.fontIsMonospace=t,this.canUseHalfwidthRightwardsArrow=i,this.lineContent=e,this.len=s,this.isOverflowing=n,this.overflowingCharCount=r,this.parts=o,this.containsForeignElements=h,this.fauxIndentLength=c,this.tabSize=l,this.startVisibleColumn=a,this.containsRTL=u,this.spaceWidth=d,this.renderSpaceCharCode=f,this.renderWhitespace=g,this.renderControlCharacters=p}}function bm(t){return t<32?t!==9:t===127||t>=8234&&t<=8238||t>=8294&&t<=8297||t>=8206&&t<=8207||t===1564}function ym(t){return t.toString(16).toUpperCase().padStart(4,"0")}class km{constructor(t,i,e,s){this._viewportBrand=void 0,this.top=0|t,this.left=0|i,this.width=0|e,this.height=0|s}}class Cm{constructor(t,i){this.tabSize=t,this.data=i}}class Sm{constructor(t,i,e,s,n,r,o){this._viewLineDataBrand=void 0,this.content=t,this.continuesWithWrappedLine=i,this.minColumn=e,this.maxColumn=s,this.startVisibleColumn=n,this.tokens=r,this.inlineDecorations=o}}class xm{constructor(t,i,e,s,n,r,o,h,c,l){this.minColumn=t,this.maxColumn=i,this.content=e,this.continuesWithWrappedLine=s,this.isBasicASCII=xm.isBasicASCII(e,r),this.containsRTL=xm.containsRTL(e,this.isBasicASCII,n),this.tokens=o,this.inlineDecorations=h,this.tabSize=c,this.startVisibleColumn=l}static isBasicASCII(t,i){return!i||Dr(t)}static containsRTL(t,i,e){return!(i||!e)&&Sr(t)}}class Dm{constructor(t,i,e){this.range=t,this.inlineClassName=i,this.type=e}}class Em{constructor(t,i,e,s){this.startOffset=t,this.endOffset=i,this.inlineClassName=e,this.inlineClassNameAffectsLetterSpacing=s}toInlineDecoration(t){return new Dm(new Cs(t,this.startOffset+1,t,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}}class Am{constructor(t,i){this._viewModelDecorationBrand=void 0,this.range=t,this.options=i}}class Mm{constructor(t,i,e){this.color=t,this.zIndex=i,this.data=e}static compareByRenderingProps(t,i){return t.zIndex===i.zIndex?t.color<i.color?-1:t.color>i.color?1:0:t.zIndex-i.zIndex}static equals(t,i){return t.color===i.color&&t.zIndex===i.zIndex&&n(t.data,i.data)}static equalsArr(t,i){return n(t,i,Mm.equals)}}function Lm(t){return!function(t){return Array.isArray(t)}(t)}function Fm(t){return typeof t=="string"}function Tm(t){return!Fm(t)}function Rm(t){return!t}function Om(t,i){return t.ignoreCase&&i?i.toLowerCase():i}function Im(t){return t.replace(/[&<>'"_]/g,"-")}function _m(t,i){return new Error(`${t.languageId}: ${i}`)}function Pm(t,i,e,s,n){let r=null;return i.replace(/\$((\$)|(#)|(\d\d?)|[sS](\d\d?)|@(\w+))/g,(function(i,o,h,c,l,a,u,d,f){return Rm(h)?Rm(c)?!Rm(l)&&l<s.length?Om(t,s[l]):!Rm(u)&&t&&typeof t[u]=="string"?t[u]:(r===null&&(r=n.split("."),r.unshift(n)),!Rm(a)&&a<r.length?Om(t,r[a]):""):Om(t,e):"$"}))}function Nm(t,i){let e=i;for(;e&&e.length>0;){const i=t.tokenizer[e];if(i)return i;const s=e.lastIndexOf(".");e=s<0?null:e.substr(0,s)}return null}var Bm,$m=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Wm=function(t,i){return function(e,s){i(e,s,t)}};class jm{static create(t,i){return this._INSTANCE.create(t,i)}constructor(t){this._maxCacheDepth=t,this._entries=Object.create(null)}create(t,i){if(t!==null&&t.depth>=this._maxCacheDepth)return new Hm(t,i);let e=Hm.getStackElementId(t);e.length>0&&(e+="|"),e+=i;let s=this._entries[e];return s||(s=new Hm(t,i),this._entries[e]=s,s)}}jm._INSTANCE=new jm(5);class Hm{constructor(t,i){this.parent=t,this.state=i,this.depth=(this.parent?this.parent.depth:0)+1}static getStackElementId(t){let i="";for(;t!==null;)i.length>0&&(i+="|"),i+=t.state,t=t.parent;return i}static _equals(t,i){for(;t!==null&&i!==null;){if(t===i)return!0;if(t.state!==i.state)return!1;t=t.parent,i=i.parent}return t===null&&i===null}equals(t){return Hm._equals(this,t)}push(t){return jm.create(this,t)}pop(){return this.parent}popall(){let t=this;for(;t.parent;)t=t.parent;return t}switchTo(t){return jm.create(this.parent,t)}}class Vm{constructor(t,i){this.languageId=t,this.state=i}equals(t){return this.languageId===t.languageId&&this.state.equals(t.state)}clone(){return this.state.clone()===this.state?this:new Vm(this.languageId,this.state)}}class zm{static create(t,i){return this._INSTANCE.create(t,i)}constructor(t){this._maxCacheDepth=t,this._entries=Object.create(null)}create(t,i){if(i!==null)return new Um(t,i);if(t!==null&&t.depth>=this._maxCacheDepth)return new Um(t,i);const e=Hm.getStackElementId(t);let s=this._entries[e];return s||(s=new Um(t,null),this._entries[e]=s,s)}}zm._INSTANCE=new zm(5);class Um{constructor(t,i){this.stack=t,this.embeddedLanguageData=i}clone(){return(this.embeddedLanguageData?this.embeddedLanguageData.clone():null)===this.embeddedLanguageData?this:zm.create(this.stack,this.embeddedLanguageData)}equals(t){return t instanceof Um&&!!this.stack.equals(t.stack)&&(this.embeddedLanguageData===null&&t.embeddedLanguageData===null||this.embeddedLanguageData!==null&&t.embeddedLanguageData!==null&&this.embeddedLanguageData.equals(t.embeddedLanguageData))}}class Km{constructor(){this._tokens=[],this._languageId=null,this._lastTokenType=null,this._lastTokenLanguage=null}enterLanguage(t){this._languageId=t}emit(t,i){this._lastTokenType===i&&this._lastTokenLanguage===this._languageId||(this._lastTokenType=i,this._lastTokenLanguage=this._languageId,this._tokens.push(new Ls(t,i,this._languageId)))}nestedLanguageTokenize(t,i,e,s){const n=e.languageId,r=e.state,o=Us.get(n);if(!o)return this.enterLanguage(n),this.emit(s,""),r;const h=o.tokenize(t,i,r);if(s!==0)for(const t of h.tokens)this._tokens.push(new Ls(t.offset+s,t.type,t.language));else this._tokens=this._tokens.concat(h.tokens);return this._lastTokenType=null,this._lastTokenLanguage=null,this._languageId=null,h.endState}finalize(t){return new Fs(this._tokens,t)}}class qm{constructor(t,i){this._languageService=t,this._theme=i,this._prependTokens=null,this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0}enterLanguage(t){this._currentLanguageId=this._languageService.languageIdCodec.encodeLanguageId(t)}emit(t,i){const e=1024|this._theme.match(this._currentLanguageId,i);this._lastTokenMetadata!==e&&(this._lastTokenMetadata=e,this._tokens.push(t),this._tokens.push(e))}static _merge(t,i,e){const s=t!==null?t.length:0,n=i.length,r=e!==null?e.length:0;if(s===0&&n===0&&r===0)return new Uint32Array(0);if(s===0&&n===0)return e;if(n===0&&r===0)return t;const o=new Uint32Array(s+n+r);t!==null&&o.set(t);for(let t=0;t<n;t++)o[s+t]=i[t];return e!==null&&o.set(e,s+n),o}nestedLanguageTokenize(t,i,e,s){const n=e.languageId,r=e.state,o=Us.get(n);if(!o)return this.enterLanguage(n),this.emit(s,""),r;const h=o.tokenizeEncoded(t,i,r);if(s!==0)for(let t=0,i=h.tokens.length;t<i;t+=2)h.tokens[t]+=s;return this._prependTokens=qm._merge(this._prependTokens,this._tokens,h.tokens),this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0,h.endState}finalize(t){return new Ts(qm._merge(this._prependTokens,this._tokens,null),t)}}let Gm=Bm=class extends Qi{constructor(t,i,e,s,n){super(),this._configurationService=n,this._languageService=t,this._standaloneThemeService=i,this._languageId=e,this._lexer=s,this._embeddedLanguages=Object.create(null),this.embeddedLoaded=Promise.resolve(void 0);let r=!1;this._register(Us.onDidChange((t=>{if(r)return;let i=!1;for(let e=0,s=t.changedLanguages.length;e<s;e++){const s=t.changedLanguages[e];if(this._embeddedLanguages[s]){i=!0;break}}i&&(r=!0,Us.handleChange([this._languageId]),r=!1)}))),this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}),this._register(this._configurationService.onDidChangeConfiguration((t=>{t.affectsConfiguration("editor.maxTokenizationLineLength")&&(this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}))})))}getLoadStatus(){const t=[];for(const i in this._embeddedLanguages){const e=Us.get(i);if(e){if(e instanceof Bm){const i=e.getLoadStatus();i.loaded===!1&&t.push(i.promise)}}else Us.isResolved(i)||t.push(Us.getOrCreate(i))}return t.length===0?{loaded:!0}:{loaded:!1,promise:Promise.all(t).then((t=>{}))}}getInitialState(){const t=jm.create(null,this._lexer.start);return zm.create(t,null)}tokenize(t,i,e){if(t.length>=this._maxTokenizationLineLength)return tm(this._languageId,e);const s=new Km,n=this._tokenize(t,i,e,s);return s.finalize(n)}tokenizeEncoded(t,i,e){if(t.length>=this._maxTokenizationLineLength)return im(this._languageService.languageIdCodec.encodeLanguageId(this._languageId),e);const s=new qm(this._languageService,this._standaloneThemeService.getColorTheme().tokenTheme),n=this._tokenize(t,i,e,s);return s.finalize(n)}_tokenize(t,i,e,s){return e.embeddedLanguageData?this._nestedTokenize(t,i,e,0,s):this._myTokenize(t,i,e,0,s)}_findLeavingNestedLanguageOffset(t,i){let e=this._lexer.tokenizer[i.stack.state];if(!e&&(e=Nm(this._lexer,i.stack.state),!e))throw _m(this._lexer,"tokenizer state is not defined: "+i.stack.state);let s=-1,n=!1;for(const r of e){if(!Tm(r.action)||r.action.nextEmbedded!=="@pop")continue;n=!0;let e=r.resolveRegex(i.stack.state);const o=e.source;if(o.substr(0,4)==="^(?:"&&o.substr(o.length-1,1)===")"){const t=(e.ignoreCase?"i":"")+(e.unicode?"u":"");e=new RegExp(o.substr(4,o.length-5),t)}const h=t.search(e);h===-1||h!==0&&r.matchOnlyAtLineStart||(s===-1||h<s)&&(s=h)}if(!n)throw _m(this._lexer,'no rule containing nextEmbedded: "@pop" in tokenizer embedded state: '+i.stack.state);return s}_nestedTokenize(t,i,e,s,n){const r=this._findLeavingNestedLanguageOffset(t,e);if(r===-1){const r=n.nestedLanguageTokenize(t,i,e.embeddedLanguageData,s);return zm.create(e.stack,new Vm(e.embeddedLanguageData.languageId,r))}const o=t.substring(0,r);o.length>0&&n.nestedLanguageTokenize(o,!1,e.embeddedLanguageData,s);const h=t.substring(r);return this._myTokenize(h,i,e,s+r,n)}_safeRuleName(t){return t?t.name:"(unknown)"}_myTokenize(t,i,e,s,n){n.enterLanguage(this._languageId);const r=t.length,o=i&&this._lexer.includeLF?t+`\n`:t,h=o.length;let c=e.embeddedLanguageData,l=e.stack,a=0,u=null,d=!0;for(;d||a<h;){const e=a,p=l.depth,m=u?u.groups.length:0,w=l.state;let v=null,b=null,y=null,k=null,C=null;if(u){v=u.matches;const t=u.groups.shift();b=t.matched,y=t.action,k=u.rule,u.groups.length===0&&(u=null)}else{if(!d&&a>=h)break;d=!1;let t=this._lexer.tokenizer[w];if(!t&&(t=Nm(this._lexer,w),!t))throw _m(this._lexer,"tokenizer state is not defined: "+w);const i=o.substr(a);for(const e of t)if((a===0||!e.matchOnlyAtLineStart)&&(v=i.match(e.resolveRegex(w)),v)){b=v[0],y=e.action;break}}if(v||(v=[""],b=""),y||(a<h&&(v=[o.charAt(a)],b=v[0]),y=this._lexer.defaultToken),b===null)break;for(a+=b.length;Lm(y)&&Tm(y)&&y.test;)y=y.test(b,v,w,a===h);let S=null;if(typeof y=="string"||Array.isArray(y))S=y;else if(y.group)S=y.group;else if(y.token!==null&&y.token!==void 0){if(S=y.tokenSubst?Pm(this._lexer,y.token,b,v,w):y.token,y.nextEmbedded)if(y.nextEmbedded==="@pop"){if(!c)throw _m(this._lexer,"cannot pop embedded language if not inside one");c=null}else{if(c)throw _m(this._lexer,"cannot enter embedded language from within an embedded language");C=Pm(this._lexer,y.nextEmbedded,b,v,w)}if(y.goBack&&(a=Math.max(0,a-y.goBack)),y.switchTo&&typeof y.switchTo=="string"){let t=Pm(this._lexer,y.switchTo,b,v,w);if(t[0]==="@"&&(t=t.substr(1)),!Nm(this._lexer,t))throw _m(this._lexer,"trying to switch to a state '"+t+"' that is undefined in rule: "+this._safeRuleName(k));l=l.switchTo(t)}else{if(y.transform&&typeof y.transform=="function")throw _m(this._lexer,"action.transform not supported");if(y.next)if(y.next==="@push"){if(l.depth>=this._lexer.maxStack)throw _m(this._lexer,"maximum tokenizer stack size reached: ["+l.state+","+l.parent.state+",...]");l=l.push(w)}else if(y.next==="@pop"){if(l.depth<=1)throw _m(this._lexer,"trying to pop an empty stack in rule: "+this._safeRuleName(k));l=l.pop()}else if(y.next==="@popall")l=l.popall();else{let t=Pm(this._lexer,y.next,b,v,w);if(t[0]==="@"&&(t=t.substr(1)),!Nm(this._lexer,t))throw _m(this._lexer,"trying to set a next state '"+t+"' that is undefined in rule: "+this._safeRuleName(k));l=l.push(t)}}y.log&&typeof y.log=="string"&&(f=this._lexer,g=this._lexer.languageId+": "+Pm(this._lexer,y.log,b,v,w),console.log(`${f.languageId}: ${g}`))}if(S===null)throw _m(this._lexer,"lexer rule has no well-defined action in rule: "+this._safeRuleName(k));const x=e=>{const r=this._languageService.getLanguageIdByLanguageName(e)||this._languageService.getLanguageIdByMimeType(e)||e,o=this._getNestedEmbeddedLanguageData(r);if(a<h){const e=t.substr(a);return this._nestedTokenize(e,i,zm.create(l,o),s+a,n)}return zm.create(l,o)};if(Array.isArray(S)){if(u&&u.groups.length>0)throw _m(this._lexer,"groups cannot be nested: "+this._safeRuleName(k));if(v.length!==S.length+1)throw _m(this._lexer,"matched number of groups does not match the number of actions in rule: "+this._safeRuleName(k));let t=0;for(let i=1;i<v.length;i++)t+=v[i].length;if(t!==b.length)throw _m(this._lexer,"with groups, all characters should be matched in consecutive groups in rule: "+this._safeRuleName(k));u={rule:k,matches:v,groups:[]};for(let t=0;t<S.length;t++)u.groups[t]={action:S[t],matched:v[t+1]};a-=b.length}else{{if(S==="@rematch"&&(a-=b.length,b="",v=null,S="",C!==null))return x(C);if(b.length===0){if(h===0||p!==l.depth||w!==l.state||(u?u.groups.length:0)!==m)continue;throw _m(this._lexer,"no progress in tokenizer in rule: "+this._safeRuleName(k))}let t=null;if(Fm(S)&&S.indexOf("@brackets")===0){const i=S.substr(9),e=Zm(this._lexer,b);if(!e)throw _m(this._lexer,"@brackets token returned but no bracket defined as: "+b);t=Im(e.token+i)}else t=Im(S===""?"":S+this._lexer.tokenPostfix);e<r&&n.emit(e+s,t)}if(C!==null)return x(C)}}var f,g;return zm.create(l,c)}_getNestedEmbeddedLanguageData(t){if(!this._languageService.isRegisteredLanguageId(t))return new Vm(t,Xp);t!==this._languageId&&(this._languageService.requestBasicLanguageFeatures(t),Us.getOrCreate(t),this._embeddedLanguages[t]=!0);const i=Us.get(t);return new Vm(t,i?i.getInitialState():Xp)}};function Zm(t,i){if(!i)return null;i=Om(t,i);const e=t.brackets;for(const t of e){if(t.open===i)return{token:t.token,bracketType:1};if(t.close===i)return{token:t.token,bracketType:-1}}return null}Gm=Bm=$m([Wm(4,Md)],Gm);const Jm=ju("standaloneColorizer",{createHTML:t=>t});class Qm{static colorizeElement(t,i,e,s){const n=(s=s||{}).theme||"vs",r=s.mimeType||e.getAttribute("lang")||e.getAttribute("data-lang");if(!r)return console.error("Mode not detected"),Promise.resolve();const o=i.getLanguageIdByMimeType(r)||r;t.setTheme(n);const h=e.firstChild?e.firstChild.nodeValue:"";return e.className+=" "+n,this.colorize(i,h||"",o,s).then((t=>{var i;const s=(i=Jm==null?void 0:Jm.createHTML(t))!==null&&i!==void 0?i:t;e.innerHTML=s}),(t=>console.error(t)))}static async colorize(t,i,e,s){const n=t.languageIdCodec;let r=4;s&&typeof s.tabSize=="number"&&(r=s.tabSize),Tr(i)&&(i=i.substr(1));const o=Xn(i);if(!t.isRegisteredLanguageId(e))return Ym(o,r,n);const h=await Us.getOrCreate(e);return h?function(t,i,e,s){return new Promise(((n,r)=>{const o=()=>{const h=function(t,i,e,s){let n=[],r=e.getInitialState();for(let o=0,h=t.length;o<h;o++){const h=t[o],c=e.tokenizeEncoded(h,!0,r);sm.convertToEndOffset(c.tokens,h.length);const l=new sm(c.tokens,h,s),a=xm.isBasicASCII(h,!0),u=xm.containsRTL(h,a,!0),d=wm(new um(!1,!0,h,!1,a,u,0,l.inflate(),[],i,0,0,0,0,-1,"none",!1,!1,null));n=n.concat(d.html),n.push("<br/>"),r=c.endState}return n.join("")}(t,i,e,s);if(e instanceof Gm){const t=e.getLoadStatus();if(t.loaded===!1)return void t.promise.then(o,r)}n(h)};o()}))}(o,r,h,n):Ym(o,r,n)}static colorizeLine(t,i,e,s,n=4){const r=xm.isBasicASCII(t,i),o=xm.containsRTL(t,r,e);return wm(new um(!1,!0,t,!1,r,o,0,s,[],n,0,0,0,0,-1,"none",!1,!1,null)).html}static colorizeModelLine(t,i,e=4){const s=t.getLineContent(i);t.tokenization.forceTokenization(i);const n=t.tokenization.getLineTokens(i).inflate();return this.colorizeLine(s,t.mightContainNonBasicASCII(),t.mightContainRTL(),n,e)}}function Ym(t,i,e){let s=[];const n=new Uint32Array(2);n[0]=0,n[1]=33587200;for(let r=0,o=t.length;r<o;r++){const o=t[r];n[0]=o.length;const h=new sm(n,o,e),c=xm.isBasicASCII(o,!0),l=xm.containsRTL(o,c,!0),a=wm(new um(!1,!0,o,!1,c,l,0,h,[],i,0,0,0,0,-1,"none",!1,!1,null));s=s.concat(a.html),s.push("<br/>")}return s.join("")}const Xm=2e4;let tw,iw,ew,sw,nw;function rw(t){tw&&(iw.textContent!==t?(ic(ew),hw(iw,t)):(ic(iw),hw(ew,t)))}function ow(t){tw&&(sw.textContent!==t?(ic(nw),hw(sw,t)):(ic(sw),hw(nw,t)))}function hw(t,i){ic(t),i.length>Xm&&(i=i.substr(0,Xm)),t.textContent=i,t.style.visibility="hidden",t.style.visibility="visible"}const cw=_l("markerDecorationsService");var lw=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},aw=function(t,i){return function(e,s){i(e,s,t)}};let uw=class{constructor(t,i){}dispose(){}};uw.ID="editor.contrib.markerDecorations",uw=lw([aw(1,cw)],uw),Su(uw.ID,uw,0);class dw extends Qi{constructor(t,i){super(),this._onDidChange=this._register(new le),this.onDidChange=this._onDidChange.event,this._referenceDomElement=t,this._width=-1,this._height=-1,this._resizeObserver=null,this.measureReferenceDomElement(!1,i)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this._width}getHeight(){return this._height}startObserving(){if(!this._resizeObserver&&this._referenceDomElement){let t=null;const i=()=>{t?this.observe({width:t.width,height:t.height}):this.observe()};let e=!1,s=!1;const n=()=>{if(e&&!s)try{e=!1,s=!0,i()}finally{ac(Uh(this._referenceDomElement),(()=>{s=!1,n()}))}};this._resizeObserver=new ResizeObserver((i=>{t=i&&i[0]&&i[0].contentRect?{width:i[0].contentRect.width,height:i[0].contentRect.height}:null,e=!0,n()})),this._resizeObserver.observe(this._referenceDomElement)}}stopObserving(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}observe(t){this.measureReferenceDomElement(!0,t)}measureReferenceDomElement(t,i){let e=0,s=0;i?(e=i.width,s=i.height):this._referenceDomElement&&(e=this._referenceDomElement.clientWidth,s=this._referenceDomElement.clientHeight),e=Math.max(5,e),s=Math.max(5,s),this._width===e&&this._height===s||(this._width=e,this._height=s,t&&this._onDidChange.fire())}}class fw{constructor(t,i){this.key=t,this.migrate=i}apply(t){const i=fw._read(t,this.key);this.migrate(i,(i=>fw._read(t,i)),((i,e)=>fw._write(t,i,e)))}static _read(t,i){if(t===void 0)return;const e=i.indexOf(".");if(e>=0){const s=i.substring(0,e);return this._read(t[s],i.substring(e+1))}return t[i]}static _write(t,i,e){const s=i.indexOf(".");if(s>=0){const n=i.substring(0,s);return t[n]=t[n]||{},void this._write(t[n],i.substring(s+1),e)}t[i]=e}}function gw(t,i){fw.items.push(new fw(t,i))}function pw(t,i){gw(t,((e,s,n)=>{if(e!==void 0){for(const[s,r]of i)if(e===s)return void n(t,r)}}))}fw.items=[],pw("wordWrap",[[!0,"on"],[!1,"off"]]),pw("lineNumbers",[[!0,"on"],[!1,"off"]]),pw("cursorBlinking",[["visible","solid"]]),pw("renderWhitespace",[[!0,"boundary"],[!1,"none"]]),pw("renderLineHighlight",[[!0,"line"],[!1,"none"]]),pw("acceptSuggestionOnEnter",[[!0,"on"],[!1,"off"]]),pw("tabCompletion",[[!1,"off"],[!0,"onlySnippets"]]),pw("hover",[[!0,{enabled:!0}],[!1,{enabled:!1}]]),pw("parameterHints",[[!0,{enabled:!0}],[!1,{enabled:!1}]]),pw("autoIndent",[[!1,"advanced"],[!0,"full"]]),pw("matchBrackets",[[!0,"always"],[!1,"never"]]),pw("renderFinalNewline",[[!0,"on"],[!1,"off"]]),pw("cursorSmoothCaretAnimation",[[!0,"on"],[!1,"off"]]),pw("occurrencesHighlight",[[!0,"singleFile"],[!1,"off"]]),pw("wordBasedSuggestions",[[!0,"matchingDocuments"],[!1,"off"]]),gw("autoClosingBrackets",((t,i,e)=>{t===!1&&(e("autoClosingBrackets","never"),i("autoClosingQuotes")===void 0&&e("autoClosingQuotes","never"),i("autoSurround")===void 0&&e("autoSurround","never"))})),gw("renderIndentGuides",((t,i,e)=>{t!==void 0&&(e("renderIndentGuides",void 0),i("guides.indentation")===void 0&&e("guides.indentation",!!t))})),gw("highlightActiveIndentGuide",((t,i,e)=>{t!==void 0&&(e("highlightActiveIndentGuide",void 0),i("guides.highlightActiveIndentation")===void 0&&e("guides.highlightActiveIndentation",!!t))}));const mw={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};gw("suggest.filteredTypes",((t,i,e)=>{if(t&&typeof t=="object"){for(const s of Object.entries(mw))t[s[0]]===!1&&i(`suggest.${s[1]}`)===void 0&&e(`suggest.${s[1]}`,!1);e("suggest.filteredTypes",void 0)}})),gw("quickSuggestions",((t,i,e)=>{if(typeof t=="boolean"){const i=t?"on":"off";e("quickSuggestions",{comments:i,strings:i,other:i})}})),gw("experimental.stickyScroll.enabled",((t,i,e)=>{typeof t=="boolean"&&(e("experimental.stickyScroll.enabled",void 0),i("stickyScroll.enabled")===void 0&&e("stickyScroll.enabled",t))})),gw("experimental.stickyScroll.maxLineCount",((t,i,e)=>{typeof t=="number"&&(e("experimental.stickyScroll.maxLineCount",void 0),i("stickyScroll.maxLineCount")===void 0&&e("stickyScroll.maxLineCount",t))})),gw("codeActionsOnSave",((t,i,e)=>{if(t&&typeof t=="object"){let i=!1;const s={};for(const e of Object.entries(t))typeof e[1]=="boolean"?(i=!0,s[e[0]]=e[1]?"explicit":"never"):s[e[0]]=e[1];i&&e("codeActionsOnSave",s)}})),gw("codeActionWidget.includeNearbyQuickfixes",((t,i,e)=>{typeof t=="boolean"&&(e("codeActionWidget.includeNearbyQuickfixes",void 0),i("codeActionWidget.includeNearbyQuickFixes")===void 0&&e("codeActionWidget.includeNearbyQuickFixes",t))})),gw("lightbulb.enabled",((t,i,e)=>{typeof t=="boolean"&&e("lightbulb.enabled",t?void 0:"off")}));const ww=new class{constructor(){this._tabFocus=!1,this._onDidChangeTabFocus=new le,this.onDidChangeTabFocus=this._onDidChangeTabFocus.event}getTabFocusMode(){return this._tabFocus}setTabFocusMode(t){this._tabFocus=t,this._onDidChangeTabFocus.fire(this._tabFocus)}},vw=_l("accessibilityService"),bw=new Ta("accessibilityModeEnabled",!1);var yw=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},kw=function(t,i){return function(e,s){i(e,s,t)}};let Cw=class extends Qi{constructor(t,i,e,s){super(),this._accessibilityService=s,this._onDidChange=this._register(new le),this.onDidChange=this._onDidChange.event,this._onDidChangeFast=this._register(new le),this.onDidChangeFast=this._onDidChangeFast.event,this._isDominatedByLongLines=!1,this._viewLineCount=1,this._lineNumbersDigitCount=1,this._reservedHeight=0,this._glyphMarginDecorationLaneCount=1,this._computeOptionsMemory=new Jt,this.isSimpleWidget=t,this._containerObserver=this._register(new dw(e,i.dimension)),this._targetWindowId=Uh(e).vscodeWindowId,this._rawOptions=Aw(i),this._validatedOptions=Ew.validateOptions(this._rawOptions),this.options=this._computeOptions(),this.options.get(13)&&this._containerObserver.startObserving(),this._register(Al.onDidChangeZoomLevel((()=>this._recomputeOptions()))),this._register(ww.onDidChangeTabFocus((()=>this._recomputeOptions()))),this._register(this._containerObserver.onDidChange((()=>this._recomputeOptions()))),this._register(Rl.onDidChange((()=>this._recomputeOptions()))),this._register(yl.getInstance(Uh(e)).onDidChange((()=>this._recomputeOptions()))),this._register(this._accessibilityService.onDidChangeScreenReaderOptimized((()=>this._recomputeOptions())))}_recomputeOptions(){const t=this._computeOptions(),i=Ew.checkEquals(this.options,t);i!==null&&(this.options=t,this._onDidChangeFast.fire(i),this._onDidChange.fire(i))}_computeOptions(){const t=this._readEnvConfiguration(),i=Ll.createFromValidatedSettings(this._validatedOptions,t.pixelRatio,this.isSimpleWidget),e=this._readFontInfo(i),s={memory:this._computeOptionsMemory,outerWidth:t.outerWidth,outerHeight:t.outerHeight-this._reservedHeight,fontInfo:e,extraEditorClassName:t.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:t.emptySelectionClipboard,pixelRatio:t.pixelRatio,tabFocusMode:ww.getTabFocusMode(),accessibilitySupport:t.accessibilitySupport,glyphMarginDecorationLaneCount:this._glyphMarginDecorationLaneCount};return Ew.computeOptions(this._validatedOptions,s)}_readEnvConfiguration(){return{extraEditorClassName:Sw(),outerWidth:this._containerObserver.getWidth(),outerHeight:this._containerObserver.getHeight(),emptySelectionClipboard:Vr||Hr,pixelRatio:yl.getInstance(Jh(this._targetWindowId,!0).window).value,accessibilitySupport:this._accessibilityService.isScreenReaderOptimized()?2:this._accessibilityService.getAccessibilitySupport()}}_readFontInfo(t){return Rl.readFontInfo(Jh(this._targetWindowId,!0).window,t)}getRawOptions(){return this._rawOptions}updateOptions(t){const i=Aw(t);Ew.applyUpdate(this._rawOptions,i)&&(this._validatedOptions=Ew.validateOptions(this._rawOptions),this._recomputeOptions())}observeContainer(t){this._containerObserver.observe(t)}setIsDominatedByLongLines(t){this._isDominatedByLongLines!==t&&(this._isDominatedByLongLines=t,this._recomputeOptions())}setModelLineCount(t){const i=function(t){let i=0;for(;t;)t=Math.floor(t/10),i++;return i||1}(t);this._lineNumbersDigitCount!==i&&(this._lineNumbersDigitCount=i,this._recomputeOptions())}setViewLineCount(t){this._viewLineCount!==t&&(this._viewLineCount=t,this._recomputeOptions())}setReservedHeight(t){this._reservedHeight!==t&&(this._reservedHeight=t,this._recomputeOptions())}setGlyphMarginDecorationLaneCount(t){this._glyphMarginDecorationLaneCount!==t&&(this._glyphMarginDecorationLaneCount=t,this._recomputeOptions())}};function Sw(){let t="";return Ur||Kr||(t+="no-user-select "),Ur&&(t+="no-minimap-shadow ",t+="enable-user-select "),bt&&(t+="mac "),t}Cw=yw([kw(3,vw)],Cw);class xw{constructor(){this._values=[]}_read(t){return this._values[t]}get(t){return this._values[t]}_write(t,i){this._values[t]=i}}class Dw{constructor(){this._values=[]}_read(t){if(t>=this._values.length)throw new Error("Cannot read uninitialized value");return this._values[t]}get(t){return this._read(t)}_write(t,i){this._values[t]=i}}class Ew{static validateOptions(t){const i=new xw;for(const e of Fi){const s=e.name==="_never_"?void 0:t[e.name];i._write(e.id,e.validate(s))}return i}static computeOptions(t,i){const e=new Dw;for(const s of Fi)e._write(s.id,s.compute(i,e,t._read(s.id)));return e}static _deepEquals(t,i){if(typeof t!="object"||typeof i!="object"||!t||!i)return t===i;if(Array.isArray(t)||Array.isArray(i))return!(!Array.isArray(t)||!Array.isArray(i))&&n(t,i);if(Object.keys(t).length!==Object.keys(i).length)return!1;for(const e in t)if(!Ew._deepEquals(t[e],i[e]))return!1;return!0}static checkEquals(t,i){const e=[];let s=!1;for(const n of Fi){const r=!Ew._deepEquals(t._read(n.id),i._read(n.id));e[n.id]=r,r&&(s=!0)}return s?new Zt(e):null}static applyUpdate(t,i){let e=!1;for(const s of Fi)if(i.hasOwnProperty(s.name)){const n=s.applyUpdate(t[s.name],i[s.name]);t[s.name]=n.newValue,e=e||n.didChange}return e}}function Aw(t){const i=U(t);return function(t){fw.items.forEach((i=>i.apply(t)))}(i),i}var Mw;(function(t){const i={total:0,min:Number.MAX_VALUE,max:0},e={...i},s={...i},n={...i};let r=0;const o={keydown:0,input:0,render:0};function h(){o.keydown===1&&(performance.mark("keydown/end"),o.keydown=2)}function c(){performance.mark("input/start"),o.input=1,u()}function l(){o.input===1&&(performance.mark("input/end"),o.input=2)}function a(){o.render===1&&(performance.mark("render/end"),o.render=2)}function u(){setTimeout(d)}function d(){o.keydown===2&&o.input===2&&o.render===2&&(performance.mark("inputlatency/end"),performance.measure("keydown","keydown/start","keydown/end"),performance.measure("input","input/start","input/end"),performance.measure("render","render/start","render/end"),performance.measure("inputlatency","inputlatency/start","inputlatency/end"),f("keydown",i),f("input",e),f("render",s),f("inputlatency",n),r++,performance.clearMarks("keydown/start"),performance.clearMarks("keydown/end"),performance.clearMarks("input/start"),performance.clearMarks("input/end"),performance.clearMarks("render/start"),performance.clearMarks("render/end"),performance.clearMarks("inputlatency/start"),performance.clearMarks("inputlatency/end"),performance.clearMeasures("keydown"),performance.clearMeasures("input"),performance.clearMeasures("render"),performance.clearMeasures("inputlatency"),o.keydown=0,o.input=0,o.render=0)}function f(t,i){const e=performance.getEntriesByName(t)[0].duration;i.total+=e,i.min=Math.min(i.min,e),i.max=Math.max(i.max,e)}function g(t){return{average:t.total/r,max:t.max,min:t.min}}function p(t){t.total=0,t.min=Number.MAX_VALUE,t.max=0}t.onKeyDown=function(){d(),performance.mark("inputlatency/start"),performance.mark("keydown/start"),o.keydown=1,queueMicrotask(h)},t.onBeforeInput=c,t.onInput=function(){o.input===0&&c(),queueMicrotask(l)},t.onKeyUp=function(){d()},t.onSelectionChange=function(){d()},t.onRenderStart=function(){o.keydown===2&&o.input===2&&o.render===0&&(performance.mark("render/start"),o.render=1,queueMicrotask(a),u())},t.getAndClearMeasurements=function(){if(r===0)return;const t={keydown:g(i),input:g(e),render:g(s),total:g(n),sampleCount:r};return p(i),p(e),p(s),p(n),r=0,t}})(Mw||(Mw={}));class Lw{constructor(){this._hooks=new Ji,this._pointerMoveCallback=null,this._onStopCallback=null}dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(t,i){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;const e=this._onStopCallback;this._onStopCallback=null,t&&e&&e(i)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(t,i,e,s,n){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=s,this._onStopCallback=n;let r=t;try{t.setPointerCapture(i),this._hooks.add(Zi((()=>{try{t.releasePointerCapture(i)}catch{}})))}catch{r=Uh(t)}this._hooks.add(sc(r,qc.POINTER_MOVE,(t=>{t.buttons===e?(t.preventDefault(),this._pointerMoveCallback(t)):this.stopMonitoring(!0)}))),this._hooks.add(sc(r,qc.POINTER_UP,(t=>this.stopMonitoring(!0))))}}function Fw(t){return`--vscode-${t.replace(/\./g,"-")}`}function Tw(t){return`var(${Fw(t)})`}const Rw="base.contributions.colors",Ow=new class{constructor(){this._onDidChangeSchema=new le,this.onDidChangeSchema=this._onDidChangeSchema.event,this.colorSchema={type:"object",properties:{}},this.colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]},this.colorsById={}}registerColor(t,i,e,s=!1,n){const r={id:t,description:e,defaults:i,needsTransparency:s,deprecationMessage:n};this.colorsById[t]=r;const o={type:"string",description:e,format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return n&&(o.deprecationMessage=n),s&&(o.pattern="^#(?:(?<rgba>[0-9a-fA-f]{3}[0-9a-eA-E])|(?:[0-9a-fA-F]{6}(?:(?![fF]{2})(?:[0-9a-fA-F]{2}))))?$",o.patternErrorMessage="This color must be transparent or it will obscure content"),this.colorSchema.properties[t]=o,this.colorReferenceSchema.enum.push(t),this.colorReferenceSchema.enumDescriptions.push(e),this._onDidChangeSchema.fire(),t}getColors(){return Object.keys(this.colorsById).map((t=>this.colorsById[t]))}resolveDefaultColor(t,i){const e=this.colorsById[t];if(e&&e.defaults)return Ww(e.defaults[i.type],i)}getColorSchema(){return this.colorSchema}toString(){return Object.keys(this.colorsById).sort(((t,i)=>{const e=t.indexOf(".")===-1?0:1,s=i.indexOf(".")===-1?0:1;return e!==s?e-s:t.localeCompare(i)})).map((t=>`- \`${t}\`: ${this.colorsById[t].description}`)).join(`\n`)}};function Iw(t,i,e,s,n){return Ow.registerColor(t,i,e,s,n)}function _w(t,i){return{op:0,value:t,factor:i}}function Pw(t,i){return{op:1,value:t,factor:i}}function Nw(t,i){return{op:2,value:t,factor:i}}function Bw(...t){return{op:4,values:t}}function $w(t,i,e,s){return{op:5,value:t,background:i,factor:e,transparency:s}}function Ww(t,i){if(t!==null)return typeof t=="string"?t[0]==="#"?kp.fromHex(t):i.getColor(t):t instanceof kp?t:typeof t=="object"?function(t,i){var e,s,n,r;switch(t.op){case 0:return(e=Ww(t.value,i))===null||e===void 0?void 0:e.darken(t.factor);case 1:return(s=Ww(t.value,i))===null||s===void 0?void 0:s.lighten(t.factor);case 2:return(n=Ww(t.value,i))===null||n===void 0?void 0:n.transparent(t.factor);case 3:{const e=Ww(t.background,i);return e?(r=Ww(t.value,i))===null||r===void 0?void 0:r.makeOpaque(e):Ww(t.value,i)}case 4:for(const e of t.values){const t=Ww(e,i);if(t)return t}return;case 6:return Ww(i.defines(t.if)?t.then:t.else,i);case 5:{const e=Ww(t.value,i);if(!e)return;const s=Ww(t.background,i);return s?e.isDarkerThan(s)?kp.getLighterColor(e,s,t.factor).transparent(t.transparency):kp.getDarkerColor(e,s,t.factor).transparent(t.transparency):e.transparent(t.factor*t.transparency)}default:throw $a()}}(t,i):void 0}Va.add(Rw,Ow);const jw="vscode://schemas/workbench-colors",Hw=Va.as(Wd);Hw.registerSchema(jw,Ow.getColorSchema());const Vw=new Co((()=>Hw.notifySchemaChanged(jw)),200);Ow.onDidChangeSchema((()=>{Vw.isScheduled()||Vw.schedule()}));const zw=Iw("foreground",{dark:"#CCCCCC",light:"#616161",hcDark:"#FFFFFF",hcLight:"#292929"},tt(0,"Overall foreground color. This color is only used if not overridden by a component."));Iw("disabledForeground",{dark:"#CCCCCC80",light:"#61616180",hcDark:"#A5A5A5",hcLight:"#7F7F7F"},tt(0,"Overall foreground for disabled elements. This color is only used if not overridden by a component.")),Iw("errorForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#B5200D"},tt(0,"Overall foreground color for error messages. This color is only used if not overridden by a component.")),Iw("descriptionForeground",{light:"#717171",dark:Nw(zw,.7),hcDark:Nw(zw,.7),hcLight:Nw(zw,.7)},tt(0,"Foreground color for description text providing additional information, for example for a label."));const Uw=Iw("icon.foreground",{dark:"#C5C5C5",light:"#424242",hcDark:"#FFFFFF",hcLight:"#292929"},tt(0,"The default color for icons in the workbench.")),Kw=Iw("focusBorder",{dark:"#007FD4",light:"#0090F1",hcDark:"#F38518",hcLight:"#006BBD"},tt(0,"Overall border color for focused elements. This color is only used if not overridden by a component.")),qw=Iw("contrastBorder",{light:null,dark:null,hcDark:"#6FC3DF",hcLight:"#0F4A85"},tt(0,"An extra border around elements to separate them from others for greater contrast.")),Gw=Iw("contrastActiveBorder",{light:null,dark:null,hcDark:Kw,hcLight:Kw},tt(0,"An extra border around active elements to separate them from others for greater contrast."));Iw("selection.background",{light:null,dark:null,hcDark:null,hcLight:null},tt(0,"The background color of text selections in the workbench (e.g. for input fields or text areas). Note that this does not apply to selections within the editor."));const Zw=Iw("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},tt(0,"Foreground color for links in text."));Iw("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},tt(0,"Foreground color for links in text when clicked on and on mouse hover.")),Iw("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hcDark:kp.black,hcLight:"#292929"},tt(0,"Color for text separators.")),Iw("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hcDark:"#000000",hcLight:"#FFFFFF"},tt(0,"Foreground color for preformatted text segments.")),Iw("textPreformat.background",{light:"#0000001A",dark:"#FFFFFF1A",hcDark:"#FFFFFF",hcLight:"#09345f"},tt(0,"Background color for preformatted text segments.")),Iw("textBlockQuote.background",{light:"#f2f2f2",dark:"#222222",hcDark:null,hcLight:"#F2F2F2"},tt(0,"Background color for block quotes in text.")),Iw("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hcDark:kp.white,hcLight:"#292929"},tt(0,"Border color for block quotes in text.")),Iw("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hcDark:kp.black,hcLight:"#F2F2F2"},tt(0,"Background color for code blocks in text.")),Iw("sash.hoverBorder",{dark:Kw,light:Kw,hcDark:Kw,hcLight:Kw},tt(0,"Border color of active sashes."));const Jw=Iw("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:kp.black,hcLight:"#0F4A85"},tt(0,"Badge background color. Badges are small information labels, e.g. for search results count.")),Qw=Iw("badge.foreground",{dark:kp.white,light:"#333",hcDark:kp.white,hcLight:kp.white},tt(0,"Badge foreground color. Badges are small information labels, e.g. for search results count.")),Yw=Iw("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hcDark:null,hcLight:null},tt(0,"Scrollbar shadow to indicate that the view is scrolled.")),Xw=Iw("scrollbarSlider.background",{dark:kp.fromHex("#797979").transparent(.4),light:kp.fromHex("#646464").transparent(.4),hcDark:Nw(qw,.6),hcLight:Nw(qw,.4)},tt(0,"Scrollbar slider background color.")),tv=Iw("scrollbarSlider.hoverBackground",{dark:kp.fromHex("#646464").transparent(.7),light:kp.fromHex("#646464").transparent(.7),hcDark:Nw(qw,.8),hcLight:Nw(qw,.8)},tt(0,"Scrollbar slider background color when hovering.")),iv=Iw("scrollbarSlider.activeBackground",{dark:kp.fromHex("#BFBFBF").transparent(.4),light:kp.fromHex("#000000").transparent(.6),hcDark:qw,hcLight:qw},tt(0,"Scrollbar slider background color when clicked on.")),ev=Iw("progressBar.background",{dark:kp.fromHex("#0E70C0"),light:kp.fromHex("#0E70C0"),hcDark:qw,hcLight:qw},tt(0,"Background color of the progress bar that can show for long running operations.")),sv=Iw("editor.background",{light:"#ffffff",dark:"#1E1E1E",hcDark:kp.black,hcLight:kp.white},tt(0,"Editor background color.")),nv=Iw("editor.foreground",{light:"#333333",dark:"#BBBBBB",hcDark:kp.white,hcLight:zw},tt(0,"Editor default foreground color."));Iw("editorStickyScroll.background",{light:sv,dark:sv,hcDark:sv,hcLight:sv},tt(0,"Background color of sticky scroll in the editor")),Iw("editorStickyScrollHover.background",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:null,hcLight:kp.fromHex("#0F4A85").transparent(.1)},tt(0,"Background color of sticky scroll on hover in the editor")),Iw("editorStickyScroll.border",{dark:null,light:null,hcDark:qw,hcLight:qw},tt(0,"Border color of sticky scroll in the editor")),Iw("editorStickyScroll.shadow",{dark:Yw,light:Yw,hcDark:Yw,hcLight:Yw},tt(0," Shadow color of sticky scroll in the editor"));const rv=Iw("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#0C141F",hcLight:kp.white},tt(0,"Background color of editor widgets, such as find/replace.")),ov=Iw("editorWidget.foreground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"Foreground color of editor widgets, such as find/replace.")),hv=Iw("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hcDark:qw,hcLight:qw},tt(0,"Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget."));Iw("editorWidget.resizeBorder",{light:null,dark:null,hcDark:null,hcLight:null},tt(0,"Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget.")),Iw("editorError.background",{dark:null,light:null,hcDark:null,hcLight:null},tt(0,"Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const cv=Iw("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hcDark:"#F48771",hcLight:"#B5200D"},tt(0,"Foreground color of error squigglies in the editor.")),lv=Iw("editorError.border",{dark:null,light:null,hcDark:kp.fromHex("#E47777").transparent(.8),hcLight:"#B5200D"},tt(0,"If set, color of double underlines for errors in the editor.")),av=Iw("editorWarning.background",{dark:null,light:null,hcDark:null,hcLight:null},tt(0,"Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),uv=Iw("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hcDark:"#FFD370",hcLight:"#895503"},tt(0,"Foreground color of warning squigglies in the editor.")),dv=Iw("editorWarning.border",{dark:null,light:null,hcDark:kp.fromHex("#FFCC00").transparent(.8),hcLight:kp.fromHex("#FFCC00").transparent(.8)},tt(0,"If set, color of double underlines for warnings in the editor."));Iw("editorInfo.background",{dark:null,light:null,hcDark:null,hcLight:null},tt(0,"Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const fv=Iw("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hcDark:"#3794FF",hcLight:"#1a85ff"},tt(0,"Foreground color of info squigglies in the editor.")),gv=Iw("editorInfo.border",{dark:null,light:null,hcDark:kp.fromHex("#3794FF").transparent(.8),hcLight:"#292929"},tt(0,"If set, color of double underlines for infos in the editor.")),pv=Iw("editorHint.foreground",{dark:kp.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hcDark:null,hcLight:null},tt(0,"Foreground color of hint squigglies in the editor."));Iw("editorHint.border",{dark:null,light:null,hcDark:kp.fromHex("#eeeeee").transparent(.8),hcLight:"#292929"},tt(0,"If set, color of double underlines for hints in the editor."));const mv=Iw("editorLink.activeForeground",{dark:"#4E94CE",light:kp.blue,hcDark:kp.cyan,hcLight:"#292929"},tt(0,"Color of active links.")),wv=Iw("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hcDark:"#f3f518",hcLight:"#0F4A85"},tt(0,"Color of the editor selection.")),vv=Iw("editor.selectionForeground",{light:null,dark:null,hcDark:"#000000",hcLight:kp.white},tt(0,"Color of the selected text for high contrast.")),bv=Iw("editor.inactiveSelectionBackground",{light:Nw(wv,.5),dark:Nw(wv,.5),hcDark:Nw(wv,.7),hcLight:Nw(wv,.5)},tt(0,"Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),yv=Iw("editor.selectionHighlightBackground",{light:$w(wv,sv,.3,.6),dark:$w(wv,sv,.3,.6),hcDark:null,hcLight:null},tt(0,"Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0);Iw("editor.selectionHighlightBorder",{light:null,dark:null,hcDark:Gw,hcLight:Gw},tt(0,"Border color for regions with the same content as the selection.")),Iw("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hcDark:null,hcLight:null},tt(0,"Color of the current search match."));const kv=Iw("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hcDark:null,hcLight:null},tt(0,"Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0);Iw("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hcDark:null,hcLight:null},tt(0,"Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),Iw("editor.findMatchBorder",{light:null,dark:null,hcDark:Gw,hcLight:Gw},tt(0,"Border color of the current search match."));const Cv=Iw("editor.findMatchHighlightBorder",{light:null,dark:null,hcDark:Gw,hcLight:Gw},tt(0,"Border color of the other search matches.")),Sv=Iw("editor.findRangeHighlightBorder",{dark:null,light:null,hcDark:Nw(Gw,.4),hcLight:Nw(Gw,.4)},tt(0,"Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0);Iw("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hcDark:"#ADD6FF26",hcLight:null},tt(0,"Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0);const xv=Iw("editorHoverWidget.background",{light:rv,dark:rv,hcDark:rv,hcLight:rv},tt(0,"Background color of the editor hover."));Iw("editorHoverWidget.foreground",{light:ov,dark:ov,hcDark:ov,hcLight:ov},tt(0,"Foreground color of the editor hover."));const Dv=Iw("editorHoverWidget.border",{light:hv,dark:hv,hcDark:hv,hcLight:hv},tt(0,"Border color of the editor hover."));Iw("editorHoverWidget.statusBarBackground",{dark:Pw(xv,.2),light:_w(xv,.05),hcDark:rv,hcLight:rv},tt(0,"Background color of the editor hover status bar."));const Ev=Iw("editorInlayHint.foreground",{dark:"#969696",light:"#969696",hcDark:kp.white,hcLight:kp.black},tt(0,"Foreground color of inline hints")),Av=Iw("editorInlayHint.background",{dark:Nw(Jw,.1),light:Nw(Jw,.1),hcDark:Nw(kp.white,.1),hcLight:Nw(Jw,.1)},tt(0,"Background color of inline hints")),Mv=Iw("editorInlayHint.typeForeground",{dark:Ev,light:Ev,hcDark:Ev,hcLight:Ev},tt(0,"Foreground color of inline hints for types")),Lv=Iw("editorInlayHint.typeBackground",{dark:Av,light:Av,hcDark:Av,hcLight:Av},tt(0,"Background color of inline hints for types")),Fv=Iw("editorInlayHint.parameterForeground",{dark:Ev,light:Ev,hcDark:Ev,hcLight:Ev},tt(0,"Foreground color of inline hints for parameters")),Tv=Iw("editorInlayHint.parameterBackground",{dark:Av,light:Av,hcDark:Av,hcLight:Av},tt(0,"Background color of inline hints for parameters")),Rv=Iw("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hcDark:"#FFCC00",hcLight:"#007ACC"},tt(0,"The color used for the lightbulb actions icon."));Iw("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},tt(0,"The color used for the lightbulb auto fix actions icon.")),Iw("editorLightBulbAi.foreground",{dark:Rv,light:Rv,hcDark:Rv,hcLight:Rv},tt(0,"The color used for the lightbulb AI icon.")),Iw("editor.snippetTabstopHighlightBackground",{dark:new kp(new vp(124,124,124,.3)),light:new kp(new vp(10,50,100,.2)),hcDark:new kp(new vp(124,124,124,.3)),hcLight:new kp(new vp(10,50,100,.2))},tt(0,"Highlight background color of a snippet tabstop.")),Iw("editor.snippetTabstopHighlightBorder",{dark:null,light:null,hcDark:null,hcLight:null},tt(0,"Highlight border color of a snippet tabstop.")),Iw("editor.snippetFinalTabstopHighlightBackground",{dark:null,light:null,hcDark:null,hcLight:null},tt(0,"Highlight background color of the final tabstop of a snippet.")),Iw("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new kp(new vp(10,50,100,.5)),hcDark:"#525252",hcLight:"#292929"},tt(0,"Highlight border color of the final tabstop of a snippet."));const Ov=new kp(new vp(155,185,85,.2)),Iv=new kp(new vp(255,0,0,.2)),_v=Iw("diffEditor.insertedTextBackground",{dark:"#9ccc2c33",light:"#9ccc2c40",hcDark:null,hcLight:null},tt(0,"Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),Pv=Iw("diffEditor.removedTextBackground",{dark:"#ff000033",light:"#ff000033",hcDark:null,hcLight:null},tt(0,"Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0);Iw("diffEditor.insertedLineBackground",{dark:Ov,light:Ov,hcDark:null,hcLight:null},tt(0,"Background color for lines that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),Iw("diffEditor.removedLineBackground",{dark:Iv,light:Iv,hcDark:null,hcLight:null},tt(0,"Background color for lines that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),Iw("diffEditorGutter.insertedLineBackground",{dark:null,light:null,hcDark:null,hcLight:null},tt(0,"Background color for the margin where lines got inserted.")),Iw("diffEditorGutter.removedLineBackground",{dark:null,light:null,hcDark:null,hcLight:null},tt(0,"Background color for the margin where lines got removed."));const Nv=Iw("diffEditorOverview.insertedForeground",{dark:null,light:null,hcDark:null,hcLight:null},tt(0,"Diff overview ruler foreground for inserted content.")),Bv=Iw("diffEditorOverview.removedForeground",{dark:null,light:null,hcDark:null,hcLight:null},tt(0,"Diff overview ruler foreground for removed content."));Iw("diffEditor.insertedTextBorder",{dark:null,light:null,hcDark:"#33ff2eff",hcLight:"#374E06"},tt(0,"Outline color for the text that got inserted.")),Iw("diffEditor.removedTextBorder",{dark:null,light:null,hcDark:"#FF008F",hcLight:"#AD0707"},tt(0,"Outline color for text that got removed.")),Iw("diffEditor.border",{dark:null,light:null,hcDark:qw,hcLight:qw},tt(0,"Border color between the two text editors.")),Iw("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hcDark:null,hcLight:null},tt(0,"Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views.")),Iw("diffEditor.unchangedRegionBackground",{dark:"sideBar.background",light:"sideBar.background",hcDark:"sideBar.background",hcLight:"sideBar.background"},tt(0,"The background color of unchanged blocks in the diff editor.")),Iw("diffEditor.unchangedRegionForeground",{dark:"foreground",light:"foreground",hcDark:"foreground",hcLight:"foreground"},tt(0,"The foreground color of unchanged blocks in the diff editor.")),Iw("diffEditor.unchangedCodeBackground",{dark:"#74747429",light:"#b8b8b829",hcDark:null,hcLight:null},tt(0,"The background color of unchanged code in the diff editor."));const $v=Iw("widget.shadow",{dark:Nw(kp.black,.36),light:Nw(kp.black,.16),hcDark:null,hcLight:null},tt(0,"Shadow color of widgets such as find/replace inside the editor.")),Wv=Iw("widget.border",{dark:null,light:null,hcDark:qw,hcLight:qw},tt(0,"Border color of widgets such as find/replace inside the editor.")),jv=Iw("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hcDark:null,hcLight:null},tt(0,"Toolbar background when hovering over actions using the mouse"));Iw("toolbar.hoverOutline",{dark:null,light:null,hcDark:Gw,hcLight:Gw},tt(0,"Toolbar outline when hovering over actions using the mouse")),Iw("toolbar.activeBackground",{dark:Pw(jv,.1),light:_w(jv,.1),hcDark:null,hcLight:null},tt(0,"Toolbar background when holding the mouse over actions"));const Hv=Iw("breadcrumb.foreground",{light:Nw(zw,.8),dark:Nw(zw,.8),hcDark:Nw(zw,.8),hcLight:Nw(zw,.8)},tt(0,"Color of focused breadcrumb items.")),Vv=Iw("breadcrumb.background",{light:sv,dark:sv,hcDark:sv,hcLight:sv},tt(0,"Background color of breadcrumb items.")),zv=Iw("breadcrumb.focusForeground",{light:_w(zw,.2),dark:Pw(zw,.1),hcDark:Pw(zw,.1),hcLight:Pw(zw,.1)},tt(0,"Color of focused breadcrumb items.")),Uv=Iw("breadcrumb.activeSelectionForeground",{light:_w(zw,.2),dark:Pw(zw,.1),hcDark:Pw(zw,.1),hcLight:Pw(zw,.1)},tt(0,"Color of selected breadcrumb items."));Iw("breadcrumbPicker.background",{light:rv,dark:rv,hcDark:rv,hcLight:rv},tt(0,"Background color of breadcrumb item picker."));const Kv=kp.fromHex("#40C8AE").transparent(.5),qv=kp.fromHex("#40A6FF").transparent(.5),Gv=kp.fromHex("#606060").transparent(.4),Zv=.4,Jv=Iw("merge.currentHeaderBackground",{dark:Kv,light:Kv,hcDark:null,hcLight:null},tt(0,"Current header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);Iw("merge.currentContentBackground",{dark:Nw(Jv,Zv),light:Nw(Jv,Zv),hcDark:Nw(Jv,Zv),hcLight:Nw(Jv,Zv)},tt(0,"Current content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const Qv=Iw("merge.incomingHeaderBackground",{dark:qv,light:qv,hcDark:null,hcLight:null},tt(0,"Incoming header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);Iw("merge.incomingContentBackground",{dark:Nw(Qv,Zv),light:Nw(Qv,Zv),hcDark:Nw(Qv,Zv),hcLight:Nw(Qv,Zv)},tt(0,"Incoming content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const Yv=Iw("merge.commonHeaderBackground",{dark:Gv,light:Gv,hcDark:null,hcLight:null},tt(0,"Common ancestor header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);Iw("merge.commonContentBackground",{dark:Nw(Yv,Zv),light:Nw(Yv,Zv),hcDark:Nw(Yv,Zv),hcLight:Nw(Yv,Zv)},tt(0,"Common ancestor content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const Xv=Iw("merge.border",{dark:null,light:null,hcDark:"#C3DF6F",hcLight:"#007ACC"},tt(0,"Border color on headers and the splitter in inline merge-conflicts."));Iw("editorOverviewRuler.currentContentForeground",{dark:Nw(Jv,1),light:Nw(Jv,1),hcDark:Xv,hcLight:Xv},tt(0,"Current overview ruler foreground for inline merge-conflicts.")),Iw("editorOverviewRuler.incomingContentForeground",{dark:Nw(Qv,1),light:Nw(Qv,1),hcDark:Xv,hcLight:Xv},tt(0,"Incoming overview ruler foreground for inline merge-conflicts.")),Iw("editorOverviewRuler.commonContentForeground",{dark:Nw(Yv,1),light:Nw(Yv,1),hcDark:Xv,hcLight:Xv},tt(0,"Common ancestor overview ruler foreground for inline merge-conflicts."));const tb=Iw("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hcDark:"#AB5A00",hcLight:""},tt(0,"Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0),ib=Iw("editorOverviewRuler.selectionHighlightForeground",{dark:"#A0A0A0CC",light:"#A0A0A0CC",hcDark:"#A0A0A0CC",hcLight:"#A0A0A0CC"},tt(0,"Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0),eb=Iw("problemsErrorIcon.foreground",{dark:cv,light:cv,hcDark:cv,hcLight:cv},tt(0,"The color used for the problems error icon.")),sb=Iw("problemsWarningIcon.foreground",{dark:uv,light:uv,hcDark:uv,hcLight:uv},tt(0,"The color used for the problems warning icon.")),nb=Iw("problemsInfoIcon.foreground",{dark:fv,light:fv,hcDark:fv,hcLight:fv},tt(0,"The color used for the problems info icon.")),rb=Iw("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hcDark:"#AB5A00",hcLight:"#0F4A85"},tt(0,"Minimap marker color for find matches."),!0),ob=Iw("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hcDark:"#ffffff",hcLight:"#0F4A85"},tt(0,"Minimap marker color for repeating editor selections."),!0),hb=Iw("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hcDark:"#ffffff",hcLight:"#0F4A85"},tt(0,"Minimap marker color for the editor selection."),!0),cb=Iw("minimap.infoHighlight",{dark:fv,light:fv,hcDark:gv,hcLight:gv},tt(0,"Minimap marker color for infos.")),lb=Iw("minimap.warningHighlight",{dark:uv,light:uv,hcDark:dv,hcLight:dv},tt(0,"Minimap marker color for warnings.")),ab=Iw("minimap.errorHighlight",{dark:new kp(new vp(255,18,18,.7)),light:new kp(new vp(255,18,18,.7)),hcDark:new kp(new vp(255,50,50,1)),hcLight:"#B5200D"},tt(0,"Minimap marker color for errors.")),ub=Iw("minimap.background",{dark:null,light:null,hcDark:null,hcLight:null},tt(0,"Minimap background color.")),db=Iw("minimap.foregroundOpacity",{dark:kp.fromHex("#000f"),light:kp.fromHex("#000f"),hcDark:kp.fromHex("#000f"),hcLight:kp.fromHex("#000f")},tt(0,'Opacity of foreground elements rendered in the minimap. For example, "#000000c0" will render the elements with 75% opacity.'));Iw("minimapSlider.background",{light:Nw(Xw,.5),dark:Nw(Xw,.5),hcDark:Nw(Xw,.5),hcLight:Nw(Xw,.5)},tt(0,"Minimap slider background color.")),Iw("minimapSlider.hoverBackground",{light:Nw(tv,.5),dark:Nw(tv,.5),hcDark:Nw(tv,.5),hcLight:Nw(tv,.5)},tt(0,"Minimap slider background color when hovering.")),Iw("minimapSlider.activeBackground",{light:Nw(iv,.5),dark:Nw(iv,.5),hcDark:Nw(iv,.5),hcLight:Nw(iv,.5)},tt(0,"Minimap slider background color when clicked on.")),Iw("charts.foreground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color used in charts.")),Iw("charts.lines",{dark:Nw(zw,.5),light:Nw(zw,.5),hcDark:Nw(zw,.5),hcLight:Nw(zw,.5)},tt(0,"The color used for horizontal lines in charts.")),Iw("charts.red",{dark:cv,light:cv,hcDark:cv,hcLight:cv},tt(0,"The red color used in chart visualizations.")),Iw("charts.blue",{dark:fv,light:fv,hcDark:fv,hcLight:fv},tt(0,"The blue color used in chart visualizations.")),Iw("charts.yellow",{dark:uv,light:uv,hcDark:uv,hcLight:uv},tt(0,"The yellow color used in chart visualizations.")),Iw("charts.orange",{dark:rb,light:rb,hcDark:rb,hcLight:rb},tt(0,"The orange color used in chart visualizations.")),Iw("charts.green",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#374e06"},tt(0,"The green color used in chart visualizations.")),Iw("charts.purple",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},tt(0,"The purple color used in chart visualizations."));const fb=Iw("input.background",{dark:"#3C3C3C",light:kp.white,hcDark:kp.black,hcLight:kp.white},tt(0,"Input box background.")),gb=Iw("input.foreground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"Input box foreground.")),pb=Iw("input.border",{dark:null,light:null,hcDark:qw,hcLight:qw},tt(0,"Input box border.")),mb=Iw("inputOption.activeBorder",{dark:"#007ACC",light:"#007ACC",hcDark:qw,hcLight:qw},tt(0,"Border color of activated options in input fields."));Iw("inputOption.hoverBackground",{dark:"#5a5d5e80",light:"#b8b8b850",hcDark:null,hcLight:null},tt(0,"Background color of activated options in input fields."));const wb=Iw("inputOption.activeBackground",{dark:Nw(Kw,.4),light:Nw(Kw,.2),hcDark:kp.transparent,hcLight:kp.transparent},tt(0,"Background hover color of options in input fields.")),vb=Iw("inputOption.activeForeground",{dark:kp.white,light:kp.black,hcDark:zw,hcLight:zw},tt(0,"Foreground color of activated options in input fields."));Iw("input.placeholderForeground",{light:Nw(zw,.5),dark:Nw(zw,.5),hcDark:Nw(zw,.7),hcLight:Nw(zw,.7)},tt(0,"Input box foreground color for placeholder text."));const bb=Iw("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hcDark:kp.black,hcLight:kp.white},tt(0,"Input validation background color for information severity.")),yb=Iw("inputValidation.infoForeground",{dark:null,light:null,hcDark:null,hcLight:zw},tt(0,"Input validation foreground color for information severity.")),kb=Iw("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hcDark:qw,hcLight:qw},tt(0,"Input validation border color for information severity.")),Cb=Iw("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hcDark:kp.black,hcLight:kp.white},tt(0,"Input validation background color for warning severity.")),Sb=Iw("inputValidation.warningForeground",{dark:null,light:null,hcDark:null,hcLight:zw},tt(0,"Input validation foreground color for warning severity.")),xb=Iw("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hcDark:qw,hcLight:qw},tt(0,"Input validation border color for warning severity.")),Db=Iw("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hcDark:kp.black,hcLight:kp.white},tt(0,"Input validation background color for error severity.")),Eb=Iw("inputValidation.errorForeground",{dark:null,light:null,hcDark:null,hcLight:zw},tt(0,"Input validation foreground color for error severity.")),Ab=Iw("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hcDark:qw,hcLight:qw},tt(0,"Input validation border color for error severity.")),Mb=Iw("dropdown.background",{dark:"#3C3C3C",light:kp.white,hcDark:kp.black,hcLight:kp.white},tt(0,"Dropdown background.")),Lb=Iw("dropdown.listBackground",{dark:null,light:null,hcDark:kp.black,hcLight:kp.white},tt(0,"Dropdown list background.")),Fb=Iw("dropdown.foreground",{dark:"#F0F0F0",light:zw,hcDark:kp.white,hcLight:zw},tt(0,"Dropdown foreground.")),Tb=Iw("dropdown.border",{dark:Mb,light:"#CECECE",hcDark:qw,hcLight:qw},tt(0,"Dropdown border.")),Rb=Iw("button.foreground",{dark:kp.white,light:kp.white,hcDark:kp.white,hcLight:kp.white},tt(0,"Button foreground color.")),Ob=Iw("button.separator",{dark:Nw(Rb,.4),light:Nw(Rb,.4),hcDark:Nw(Rb,.4),hcLight:Nw(Rb,.4)},tt(0,"Button separator color.")),Ib=Iw("button.background",{dark:"#0E639C",light:"#007ACC",hcDark:null,hcLight:"#0F4A85"},tt(0,"Button background color.")),_b=Iw("button.hoverBackground",{dark:Pw(Ib,.2),light:_w(Ib,.2),hcDark:Ib,hcLight:Ib},tt(0,"Button background color when hovering.")),Pb=Iw("button.border",{dark:qw,light:qw,hcDark:qw,hcLight:qw},tt(0,"Button border color.")),Nb=Iw("button.secondaryForeground",{dark:kp.white,light:kp.white,hcDark:kp.white,hcLight:zw},tt(0,"Secondary button foreground color.")),Bb=Iw("button.secondaryBackground",{dark:"#3A3D41",light:"#5F6A79",hcDark:null,hcLight:kp.white},tt(0,"Secondary button background color.")),$b=Iw("button.secondaryHoverBackground",{dark:Pw(Bb,.2),light:_w(Bb,.2),hcDark:null,hcLight:null},tt(0,"Secondary button background color when hovering.")),Wb=Iw("checkbox.background",{dark:Mb,light:Mb,hcDark:Mb,hcLight:Mb},tt(0,"Background color of checkbox widget."));Iw("checkbox.selectBackground",{dark:rv,light:rv,hcDark:rv,hcLight:rv},tt(0,"Background color of checkbox widget when the element it's in is selected."));const jb=Iw("checkbox.foreground",{dark:Fb,light:Fb,hcDark:Fb,hcLight:Fb},tt(0,"Foreground color of checkbox widget.")),Hb=Iw("checkbox.border",{dark:Tb,light:Tb,hcDark:Tb,hcLight:Tb},tt(0,"Border color of checkbox widget."));Iw("checkbox.selectBorder",{dark:Uw,light:Uw,hcDark:Uw,hcLight:Uw},tt(0,"Border color of checkbox widget when the element it's in is selected."));const Vb=Iw("keybindingLabel.background",{dark:new kp(new vp(128,128,128,.17)),light:new kp(new vp(221,221,221,.4)),hcDark:kp.transparent,hcLight:kp.transparent},tt(0,"Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),zb=Iw("keybindingLabel.foreground",{dark:kp.fromHex("#CCCCCC"),light:kp.fromHex("#555555"),hcDark:kp.white,hcLight:zw},tt(0,"Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),Ub=Iw("keybindingLabel.border",{dark:new kp(new vp(51,51,51,.6)),light:new kp(new vp(204,204,204,.4)),hcDark:new kp(new vp(111,195,223)),hcLight:qw},tt(0,"Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),Kb=Iw("keybindingLabel.bottomBorder",{dark:new kp(new vp(68,68,68,.6)),light:new kp(new vp(187,187,187,.4)),hcDark:new kp(new vp(111,195,223)),hcLight:zw},tt(0,"Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut.")),qb=Iw("list.focusBackground",{dark:null,light:null,hcDark:null,hcLight:null},tt(0,"List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Gb=Iw("list.focusForeground",{dark:null,light:null,hcDark:null,hcLight:null},tt(0,"List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Zb=Iw("list.focusOutline",{dark:Kw,light:Kw,hcDark:Gw,hcLight:Gw},tt(0,"List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Jb=Iw("list.focusAndSelectionOutline",{dark:null,light:null,hcDark:null,hcLight:null},tt(0,"List/Tree outline color for the focused item when the list/tree is active and selected. An active list/tree has keyboard focus, an inactive does not.")),Qb=Iw("list.activeSelectionBackground",{dark:"#04395E",light:"#0060C0",hcDark:null,hcLight:kp.fromHex("#0F4A85").transparent(.1)},tt(0,"List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Yb=Iw("list.activeSelectionForeground",{dark:kp.white,light:kp.white,hcDark:null,hcLight:null},tt(0,"List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Xb=Iw("list.activeSelectionIconForeground",{dark:null,light:null,hcDark:null,hcLight:null},tt(0,"List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),ty=Iw("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hcDark:null,hcLight:kp.fromHex("#0F4A85").transparent(.1)},tt(0,"List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),iy=Iw("list.inactiveSelectionForeground",{dark:null,light:null,hcDark:null,hcLight:null},tt(0,"List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),ey=Iw("list.inactiveSelectionIconForeground",{dark:null,light:null,hcDark:null,hcLight:null},tt(0,"List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),sy=Iw("list.inactiveFocusBackground",{dark:null,light:null,hcDark:null,hcLight:null},tt(0,"List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),ny=Iw("list.inactiveFocusOutline",{dark:null,light:null,hcDark:null,hcLight:null},tt(0,"List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),ry=Iw("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:kp.white.transparent(.1),hcLight:kp.fromHex("#0F4A85").transparent(.1)},tt(0,"List/Tree background when hovering over items using the mouse.")),oy=Iw("list.hoverForeground",{dark:null,light:null,hcDark:null,hcLight:null},tt(0,"List/Tree foreground when hovering over items using the mouse.")),hy=Iw("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hcDark:null,hcLight:null},tt(0,"List/Tree drag and drop background when moving items over other items when using the mouse.")),cy=Iw("list.dropBetweenBackground",{dark:Uw,light:Uw,hcDark:null,hcLight:null},tt(0,"List/Tree drag and drop border color when moving items between items when using the mouse.")),ly=Iw("list.highlightForeground",{dark:"#2AAAFF",light:"#0066BF",hcDark:Kw,hcLight:Kw},tt(0,"List/Tree foreground color of the match highlights when searching inside the list/tree.")),ay=Iw("list.focusHighlightForeground",{dark:ly,light:(uy=Qb,dy=ly,fy="#BBE7FF",{op:6,if:uy,then:dy,else:fy}),hcDark:ly,hcLight:ly},tt(0,"List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree."));var uy,dy,fy;Iw("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hcDark:"#B89500",hcLight:"#B5200D"},tt(0,"List/Tree foreground color for invalid items, for example an unresolved root in explorer.")),Iw("list.errorForeground",{dark:"#F88070",light:"#B01011",hcDark:null,hcLight:null},tt(0,"Foreground color of list items containing errors.")),Iw("list.warningForeground",{dark:"#CCA700",light:"#855F00",hcDark:null,hcLight:null},tt(0,"Foreground color of list items containing warnings."));const gy=Iw("listFilterWidget.background",{light:_w(rv,0),dark:Pw(rv,0),hcDark:rv,hcLight:rv},tt(0,"Background color of the type filter widget in lists and trees.")),py=Iw("listFilterWidget.outline",{dark:kp.transparent,light:kp.transparent,hcDark:"#f38518",hcLight:"#007ACC"},tt(0,"Outline color of the type filter widget in lists and trees.")),my=Iw("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hcDark:qw,hcLight:qw},tt(0,"Outline color of the type filter widget in lists and trees, when there are no matches.")),wy=Iw("listFilterWidget.shadow",{dark:$v,light:$v,hcDark:$v,hcLight:$v},tt(0,"Shadow color of the type filter widget in lists and trees."));Iw("list.filterMatchBackground",{dark:kv,light:kv,hcDark:null,hcLight:null},tt(0,"Background color of the filtered match.")),Iw("list.filterMatchBorder",{dark:Cv,light:Cv,hcDark:qw,hcLight:Gw},tt(0,"Border color of the filtered match.")),Iw("list.deemphasizedForeground",{dark:"#8C8C8C",light:"#8E8E90",hcDark:"#A7A8A9",hcLight:"#666666"},tt(0,"List/Tree foreground color for items that are deemphasized."));const vy=Iw("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hcDark:"#a9a9a9",hcLight:"#a5a5a5"},tt(0,"Tree stroke color for the indentation guides.")),by=Iw("tree.inactiveIndentGuidesStroke",{dark:Nw(vy,.4),light:Nw(vy,.4),hcDark:Nw(vy,.4),hcLight:Nw(vy,.4)},tt(0,"Tree stroke color for the indentation guides that are not active.")),yy=Iw("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hcDark:null,hcLight:null},tt(0,"Table border color between columns.")),ky=Iw("tree.tableOddRowsBackground",{dark:Nw(zw,.04),light:Nw(zw,.04),hcDark:null,hcLight:null},tt(0,"Background color for odd table rows.")),Cy=Iw("menu.border",{dark:null,light:null,hcDark:qw,hcLight:qw},tt(0,"Border color of menus.")),Sy=Iw("menu.foreground",{dark:Fb,light:Fb,hcDark:Fb,hcLight:Fb},tt(0,"Foreground color of menu items.")),xy=Iw("menu.background",{dark:Mb,light:Mb,hcDark:Mb,hcLight:Mb},tt(0,"Background color of menu items.")),Dy=Iw("menu.selectionForeground",{dark:Yb,light:Yb,hcDark:Yb,hcLight:Yb},tt(0,"Foreground color of the selected menu item in menus.")),Ey=Iw("menu.selectionBackground",{dark:Qb,light:Qb,hcDark:Qb,hcLight:Qb},tt(0,"Background color of the selected menu item in menus.")),Ay=Iw("menu.selectionBorder",{dark:null,light:null,hcDark:Gw,hcLight:Gw},tt(0,"Border color of the selected menu item in menus.")),My=Iw("menu.separatorBackground",{dark:"#606060",light:"#D4D4D4",hcDark:qw,hcLight:qw},tt(0,"Color of a separator menu item in menus.")),Ly=Iw("quickInput.background",{dark:rv,light:rv,hcDark:rv,hcLight:rv},tt(0,"Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),Fy=Iw("quickInput.foreground",{dark:ov,light:ov,hcDark:ov,hcLight:ov},tt(0,"Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),Ty=Iw("quickInputTitle.background",{dark:new kp(new vp(255,255,255,.105)),light:new kp(new vp(0,0,0,.06)),hcDark:"#000000",hcLight:kp.white},tt(0,"Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),Ry=Iw("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hcDark:kp.white,hcLight:"#0F4A85"},tt(0,"Quick picker color for grouping labels.")),Oy=Iw("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hcDark:kp.white,hcLight:"#0F4A85"},tt(0,"Quick picker color for grouping borders.")),Iy=Iw("quickInput.list.focusBackground",{dark:null,light:null,hcDark:null,hcLight:null},"",void 0,tt(0,"Please use quickInputList.focusBackground instead")),_y=Iw("quickInputList.focusForeground",{dark:Yb,light:Yb,hcDark:Yb,hcLight:Yb},tt(0,"Quick picker foreground color for the focused item.")),Py=Iw("quickInputList.focusIconForeground",{dark:Xb,light:Xb,hcDark:Xb,hcLight:Xb},tt(0,"Quick picker icon foreground color for the focused item.")),Ny=Iw("quickInputList.focusBackground",{dark:Bw(Iy,Qb),light:Bw(Iy,Qb),hcDark:null,hcLight:null},tt(0,"Quick picker background color for the focused item."));Iw("search.resultsInfoForeground",{light:zw,dark:Nw(zw,.65),hcDark:zw,hcLight:zw},tt(0,"Color of the text in the search viewlet's completion message.")),Iw("searchEditor.findMatchBackground",{light:Nw(kv,.66),dark:Nw(kv,.66),hcDark:kv,hcLight:kv},tt(0,"Color of the Search Editor query matches.")),Iw("searchEditor.findMatchBorder",{light:Nw(Cv,.66),dark:Nw(Cv,.66),hcDark:Cv,hcLight:Cv},tt(0,"Border color of the Search Editor query matches."));class By{constructor(t,i){this.x=t,this.y=i,this._pageCoordinatesBrand=void 0}toClientCoordinates(t){return new $y(this.x-t.scrollX,this.y-t.scrollY)}}class $y{constructor(t,i){this.clientX=t,this.clientY=i,this._clientCoordinatesBrand=void 0}toPageCoordinates(t){return new By(this.clientX+t.scrollX,this.clientY+t.scrollY)}}class Wy{constructor(t,i,e,s){this.x=t,this.y=i,this.width=e,this.height=s,this._editorPagePositionBrand=void 0}}class jy{constructor(t,i){this.x=t,this.y=i,this._positionRelativeToEditorBrand=void 0}}function Hy(t){const i=vc(t);return new Wy(i.left,i.top,i.width,i.height)}function Vy(t,i,e){const s=i.width/t.offsetWidth,n=i.height/t.offsetHeight,r=(e.x-i.x)/s,o=(e.y-i.y)/n;return new jy(r,o)}class zy extends ho{constructor(t,i,e){super(Uh(e),t),this._editorMouseEventBrand=void 0,this.isFromPointerCapture=i,this.pos=new By(this.posx,this.posy),this.editorPos=Hy(e),this.relativePos=Vy(e,this.editorPos,this.pos)}}class Uy{constructor(t){this._editorViewDomNode=t}_create(t){return new zy(t,!1,this._editorViewDomNode)}onContextMenu(t,i){return sc(t,"contextmenu",(t=>{i(this._create(t))}))}onMouseUp(t,i){return sc(t,"mouseup",(t=>{i(this._create(t))}))}onMouseDown(t,i){return sc(t,qc.MOUSE_DOWN,(t=>{i(this._create(t))}))}onPointerDown(t,i){return sc(t,qc.POINTER_DOWN,(t=>{i(this._create(t),t.pointerId)}))}onMouseLeave(t,i){return sc(t,qc.MOUSE_LEAVE,(t=>{i(this._create(t))}))}onMouseMove(t,i){return sc(t,"mousemove",(t=>i(this._create(t))))}}class Ky{constructor(t){this._editorViewDomNode=t}_create(t){return new zy(t,!1,this._editorViewDomNode)}onPointerUp(t,i){return sc(t,"pointerup",(t=>{i(this._create(t))}))}onPointerDown(t,i){return sc(t,qc.POINTER_DOWN,(t=>{i(this._create(t),t.pointerId)}))}onPointerLeave(t,i){return sc(t,qc.POINTER_LEAVE,(t=>{i(this._create(t))}))}onPointerMove(t,i){return sc(t,"pointermove",(t=>i(this._create(t))))}}class qy extends Qi{constructor(t){super(),this._editorViewDomNode=t,this._globalPointerMoveMonitor=this._register(new Lw),this._keydownListener=null}startMonitoring(t,i,e,s,n){this._keydownListener=rc(t.ownerDocument,"keydown",(t=>{t.toKeyCodeChord().isModifierKey()||this._globalPointerMoveMonitor.stopMonitoring(!0,t.browserEvent)}),!0),this._globalPointerMoveMonitor.startMonitoring(t,i,e,(t=>{s(new zy(t,!0,this._editorViewDomNode))}),(t=>{this._keydownListener.dispose(),n(t)}))}stopMonitoring(){this._globalPointerMoveMonitor.stopMonitoring(!0)}}class Gy{constructor(t){this._editor=t,this._instanceId=++Gy._idPool,this._counter=0,this._rules=new Map,this._garbageCollectionScheduler=new Co((()=>this.garbageCollect()),1e3)}createClassNameRef(t){const i=this.getOrCreateRule(t);return i.increaseRefCount(),{className:i.className,dispose:()=>{i.decreaseRefCount(),this._garbageCollectionScheduler.schedule()}}}getOrCreateRule(t){const i=this.computeUniqueKey(t);let e=this._rules.get(i);if(!e){const s=this._counter++;e=new Zy(i,`dyn-rule-${this._instanceId}-${s}`,Ac(this._editor.getContainerDomNode())?this._editor.getContainerDomNode():void 0,t),this._rules.set(i,e)}return e}computeUniqueKey(t){return JSON.stringify(t)}garbageCollect(){for(const t of this._rules.values())t.hasReferences()||(this._rules.delete(t.key),t.dispose())}}Gy._idPool=0;class Zy{constructor(t,i,e,s){this.key=t,this.className=i,this.properties=s,this._referenceCount=0,this._styleElementDisposables=new Ji,this._styleElement=Pc(e,void 0,this._styleElementDisposables),this._styleElement.textContent=this.getCssText(this.className,this.properties)}getCssText(t,i){let e=`.${t} {`;for(const t in i){const s=i[t];let n;n=typeof s=="object"?Tw(s.id):s,e+=`\n\t${Jy(t)}: ${n};`}return e+=`\n}`,e}dispose(){this._styleElementDisposables.dispose(),this._styleElement=void 0}increaseRefCount(){this._referenceCount++}decreaseRefCount(){this._referenceCount--}hasReferences(){return this._referenceCount>0}}function Jy(t){return t.replace(/(^[A-Z])/,(([t])=>t.toLowerCase())).replace(/([A-Z])/g,(([t])=>`-${t.toLowerCase()}`))}class Qy extends Qi{constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(t){return!1}onCompositionEnd(t){return!1}onConfigurationChanged(t){return!1}onCursorStateChanged(t){return!1}onDecorationsChanged(t){return!1}onFlushed(t){return!1}onFocusChanged(t){return!1}onLanguageConfigurationChanged(t){return!1}onLineMappingChanged(t){return!1}onLinesChanged(t){return!1}onLinesDeleted(t){return!1}onLinesInserted(t){return!1}onRevealRangeRequest(t){return!1}onScrollChanged(t){return!1}onThemeChanged(t){return!1}onTokensChanged(t){return!1}onTokensColorsChanged(t){return!1}onZonesChanged(t){return!1}handleEvents(t){let i=!1;for(let e=0,s=t.length;e<s;e++){const s=t[e];switch(s.type){case 0:this.onCompositionStart(s)&&(i=!0);break;case 1:this.onCompositionEnd(s)&&(i=!0);break;case 2:this.onConfigurationChanged(s)&&(i=!0);break;case 3:this.onCursorStateChanged(s)&&(i=!0);break;case 4:this.onDecorationsChanged(s)&&(i=!0);break;case 5:this.onFlushed(s)&&(i=!0);break;case 6:this.onFocusChanged(s)&&(i=!0);break;case 7:this.onLanguageConfigurationChanged(s)&&(i=!0);break;case 8:this.onLineMappingChanged(s)&&(i=!0);break;case 9:this.onLinesChanged(s)&&(i=!0);break;case 10:this.onLinesDeleted(s)&&(i=!0);break;case 11:this.onLinesInserted(s)&&(i=!0);break;case 12:this.onRevealRangeRequest(s)&&(i=!0);break;case 13:this.onScrollChanged(s)&&(i=!0);break;case 15:this.onTokensChanged(s)&&(i=!0);break;case 14:this.onThemeChanged(s)&&(i=!0);break;case 16:this.onTokensColorsChanged(s)&&(i=!0);break;case 17:this.onZonesChanged(s)&&(i=!0);break;default:console.info("View received unknown event: "),console.info(s)}}i&&(this._shouldRender=!0)}}class Yy extends Qy{constructor(t){super(),this._context=t,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}}class Xy{static write(t,i){t.setAttribute("data-mprt",String(i))}static read(t){const i=t.getAttribute("data-mprt");return i===null?0:parseInt(i,10)}static collect(t,i){const e=[];let s=0;for(;t&&t!==t.ownerDocument.body&&t!==i;)t.nodeType===t.ELEMENT_NODE&&(e[s++]=this.read(t)),t=t.parentElement;const n=new Uint8Array(s);for(let t=0;t<s;t++)n[t]=e[s-t-1];return n}}class tk{constructor(t,i){this._restrictedRenderingContextBrand=void 0,this._viewLayout=t,this.viewportData=i,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;const e=this._viewLayout.getCurrentViewport();this.scrollTop=e.top,this.scrollLeft=e.left,this.viewportWidth=e.width,this.viewportHeight=e.height}getScrolledTopFromAbsoluteTop(t){return t-this.scrollTop}getVerticalOffsetForLineNumber(t,i){return this._viewLayout.getVerticalOffsetForLineNumber(t,i)}getVerticalOffsetAfterLineNumber(t,i){return this._viewLayout.getVerticalOffsetAfterLineNumber(t,i)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}}class ik extends tk{constructor(t,i,e){super(t,i),this._renderingContextBrand=void 0,this._viewLines=e}linesVisibleRangesForRange(t,i){return this._viewLines.linesVisibleRangesForRange(t,i)}visibleRangeForPosition(t){return this._viewLines.visibleRangeForPosition(t)}}class ek{constructor(t,i,e,s){this.outsideRenderedLine=t,this.lineNumber=i,this.ranges=e,this.continuesOnNextLine=s}}class sk{static from(t){const i=new Array(t.length);for(let e=0,s=t.length;e<s;e++){const s=t[e];i[e]=new sk(s.left,s.width)}return i}constructor(t,i){this._horizontalRangeBrand=void 0,this.left=Math.round(t),this.width=Math.round(i)}toString(){return`[${this.left},${this.width}]`}}class nk{constructor(t,i){this._floatHorizontalRangeBrand=void 0,this.left=t,this.width=i}toString(){return`[${this.left},${this.width}]`}static compare(t,i){return t.left-i.left}}class rk{constructor(t,i){this.outsideRenderedLine=t,this.originalLeft=i,this.left=Math.round(this.originalLeft)}}class ok{constructor(t,i){this.outsideRenderedLine=t,this.ranges=i}}class hk{static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(t,i){t.selectNodeContents(i)}static _readClientRects(t,i,e,s,n){const r=this._createRange();try{return r.setStart(t,i),r.setEnd(e,s),r.getClientRects()}catch{return null}finally{this._detachRange(r,n)}}static _mergeAdjacentRanges(t){if(t.length===1)return t;t.sort(nk.compare);const i=[];let e=0,s=t[0];for(let n=1,r=t.length;n<r;n++){const r=t[n];s.left+s.width+.9>=r.left?s.width=Math.max(s.width,r.left+r.width-s.left):(i[e++]=s,s=r)}return i[e++]=s,i}static _createHorizontalRangesFromClientRects(t,i,e){if(!t||t.length===0)return null;const s=[];for(let n=0,r=t.length;n<r;n++){const r=t[n];s[n]=new nk(Math.max(0,(r.left-i)/e),r.width/e)}return this._mergeAdjacentRanges(s)}static readHorizontalRanges(t,i,e,s,n,r){const o=t.children.length-1;if(0>o)return null;if((i=Math.min(o,Math.max(0,i)))===(s=Math.min(o,Math.max(0,s)))&&e===n&&e===0&&!t.children[i].firstChild){const e=t.children[i].getClientRects();return r.markDidDomLayout(),this._createHorizontalRangesFromClientRects(e,r.clientRectDeltaLeft,r.clientRectScale)}i!==s&&s>0&&n===0&&(s--,n=1073741824);let h=t.children[i].firstChild,c=t.children[s].firstChild;if(h&&c||(!h&&e===0&&i>0&&(h=t.children[i-1].firstChild,e=1073741824),!c&&n===0&&s>0&&(c=t.children[s-1].firstChild,n=1073741824)),!h||!c)return null;e=Math.min(h.textContent.length,Math.max(0,e)),n=Math.min(c.textContent.length,Math.max(0,n));const l=this._readClientRects(h,e,c,n,r.endNode);return r.markDidDomLayout(),this._createHorizontalRangesFromClientRects(l,r.clientRectDeltaLeft,r.clientRectScale)}}var ck;function lk(t){return t===ck.HIGH_CONTRAST_DARK||t===ck.HIGH_CONTRAST_LIGHT}function ak(t){return t===ck.DARK||t===ck.HIGH_CONTRAST_DARK}(function(t){t.DARK="dark",t.LIGHT="light",t.HIGH_CONTRAST_DARK="hcDark",t.HIGH_CONTRAST_LIGHT="hcLight"})(ck||(ck={}));const uk=!!kt||!(yt||Hr||Ur);let dk=!0;class fk{constructor(t,i){this.themeType=i;const e=t.options,s=e.get(50),n=e.get(38);this.renderWhitespace=n==="off"?e.get(99):"none",this.renderControlCharacters=e.get(94),this.spaceWidth=s.spaceWidth,this.middotWidth=s.middotWidth,this.wsmiddotWidth=s.wsmiddotWidth,this.useMonospaceOptimizations=s.isMonospace&&!e.get(33),this.canUseHalfwidthRightwardsArrow=s.canUseHalfwidthRightwardsArrow,this.lineHeight=e.get(67),this.stopRenderingLineAfter=e.get(117),this.fontLigatures=e.get(51)}equals(t){return this.themeType===t.themeType&&this.renderWhitespace===t.renderWhitespace&&this.renderControlCharacters===t.renderControlCharacters&&this.spaceWidth===t.spaceWidth&&this.middotWidth===t.middotWidth&&this.wsmiddotWidth===t.wsmiddotWidth&&this.useMonospaceOptimizations===t.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===t.canUseHalfwidthRightwardsArrow&&this.lineHeight===t.lineHeight&&this.stopRenderingLineAfter===t.stopRenderingLineAfter&&this.fontLigatures===t.fontLigatures}}class gk{constructor(t){this._options=t,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(t){if(!this._renderedViewLine)throw new Error("I have no rendered view line to set the dom node to...");this._renderedViewLine.domNode=Sl(t)}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(t){this._isMaybeInvalid=!0,this._options=t}onSelectionChanged(){return!(!lk(this._options.themeType)&&this._options.renderWhitespace!=="selection")&&(this._isMaybeInvalid=!0,!0)}renderLine(t,i,e,s,n){if(this._isMaybeInvalid===!1)return!1;this._isMaybeInvalid=!1;const r=s.getViewLineRenderingData(t),o=this._options,h=rm.filter(r.inlineDecorations,t,r.minColumn,r.maxColumn);let c=null;if(lk(o.themeType)||this._options.renderWhitespace==="selection"){const i=s.selections;for(const e of i){if(e.endLineNumber<t||e.startLineNumber>t)continue;const i=e.startLineNumber===t?e.startColumn:r.minColumn,s=e.endLineNumber===t?e.endColumn:r.maxColumn;i<s&&(lk(o.themeType)&&h.push(new rm(i,s,"inline-selected-text",0)),this._options.renderWhitespace==="selection"&&(c||(c=[]),c.push(new am(i-1,s-1))))}}const l=new um(o.useMonospaceOptimizations,o.canUseHalfwidthRightwardsArrow,r.content,r.continuesWithWrappedLine,r.isBasicASCII,r.containsRTL,r.minColumn-1,r.tokens,h,r.tabSize,r.startVisibleColumn,o.spaceWidth,o.middotWidth,o.wsmiddotWidth,o.stopRenderingLineAfter,o.renderWhitespace,o.renderControlCharacters,o.fontLigatures!==gi.OFF,c);if(this._renderedViewLine&&this._renderedViewLine.input.equals(l))return!1;n.appendString('<div style="top:'),n.appendString(String(i)),n.appendString("px;height:"),n.appendString(String(e)),n.appendString('px;" class="'),n.appendString(gk.CLASS_NAME),n.appendString('">');const a=pm(l,n);n.appendString("</div>");let u=null;return dk&&uk&&r.isBasicASCII&&o.useMonospaceOptimizations&&a.containsForeignElements===0&&(u=new pk(this._renderedViewLine?this._renderedViewLine.domNode:null,l,a.characterMapping)),u||(u=vk(this._renderedViewLine?this._renderedViewLine.domNode:null,l,a.characterMapping,a.containsRTL,a.containsForeignElements)),this._renderedViewLine=u,!0}layoutLine(t,i,e){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(i),this._renderedViewLine.domNode.setHeight(e))}getWidth(t){return this._renderedViewLine?this._renderedViewLine.getWidth(t):0}getWidthIsFast(){return!this._renderedViewLine||this._renderedViewLine.getWidthIsFast()}needsMonospaceFontCheck(){return!!this._renderedViewLine&&this._renderedViewLine instanceof pk}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof pk?this._renderedViewLine.monospaceAssumptionsAreValid():dk}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof pk&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(t,i,e,s){if(!this._renderedViewLine)return null;i=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,i)),e=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,e));const n=this._renderedViewLine.input.stopRenderingLineAfter;if(n!==-1&&i>n+1&&e>n+1)return new ok(!0,[new nk(this.getWidth(s),0)]);n!==-1&&i>n+1&&(i=n+1),n!==-1&&e>n+1&&(e=n+1);const r=this._renderedViewLine.getVisibleRangesForRange(t,i,e,s);return r&&r.length>0?new ok(!1,r):null}getColumnOfNodeOffset(t,i){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(t,i):1}}gk.CLASS_NAME="view-line";class pk{constructor(t,i,e){this._cachedWidth=-1,this.domNode=t,this.input=i;const s=Math.floor(i.lineContent.length/300);if(s>0){this._keyColumnPixelOffsetCache=new Float32Array(s);for(let t=0;t<s;t++)this._keyColumnPixelOffsetCache[t]=-1}else this._keyColumnPixelOffsetCache=null;this._characterMapping=e,this._charWidth=i.spaceWidth}getWidth(t){if(!this.domNode||this.input.lineContent.length<300){const t=this._characterMapping.getHorizontalOffset(this._characterMapping.length);return Math.round(this._charWidth*t)}return this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,t==null||t.markDidDomLayout()),this._cachedWidth}getWidthIsFast(){return this.input.lineContent.length<300||this._cachedWidth!==-1}monospaceAssumptionsAreValid(){if(!this.domNode)return dk;if(this.input.lineContent.length<300){const t=this.getWidth(null),i=this.domNode.domNode.firstChild.offsetWidth;Math.abs(t-i)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),dk=!1)}return dk}toSlowRenderedLine(){return vk(this.domNode,this.input,this._characterMapping,!1,0)}getVisibleRangesForRange(t,i,e,s){const n=this._getColumnPixelOffset(t,i,s),r=this._getColumnPixelOffset(t,e,s);return[new nk(n,r-n)]}_getColumnPixelOffset(t,i,e){if(i<=300){const t=this._characterMapping.getHorizontalOffset(i);return this._charWidth*t}const s=Math.floor((i-1)/300)-1,n=300*(s+1)+1;let r=-1;if(this._keyColumnPixelOffsetCache&&(r=this._keyColumnPixelOffsetCache[s],r===-1&&(r=this._actualReadPixelOffset(t,n,e),this._keyColumnPixelOffsetCache[s]=r)),r===-1){const t=this._characterMapping.getHorizontalOffset(i);return this._charWidth*t}const o=this._characterMapping.getHorizontalOffset(n),h=this._characterMapping.getHorizontalOffset(i);return r+this._charWidth*(h-o)}_getReadingTarget(t){return t.domNode.firstChild}_actualReadPixelOffset(t,i,e){if(!this.domNode)return-1;const s=this._characterMapping.getDomPosition(i),n=hk.readHorizontalRanges(this._getReadingTarget(this.domNode),s.partIndex,s.charIndex,s.partIndex,s.charIndex,e);return n&&n.length!==0?n[0].left:-1}getColumnOfNodeOffset(t,i){return kk(this._characterMapping,t,i)}}class mk{constructor(t,i,e,s,n){if(this.domNode=t,this.input=i,this._characterMapping=e,this._isWhitespaceOnly=/^\s*$/.test(i.lineContent),this._containsForeignElements=n,this._cachedWidth=-1,this._pixelOffsetCache=null,!s||this._characterMapping.length===0){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let t=0,i=this._characterMapping.length;t<=i;t++)this._pixelOffsetCache[t]=-1}}_getReadingTarget(t){return t.domNode.firstChild}getWidth(t){return this.domNode?(this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,t==null||t.markDidDomLayout()),this._cachedWidth):0}getWidthIsFast(){return this._cachedWidth!==-1}getVisibleRangesForRange(t,i,e,s){if(!this.domNode)return null;if(this._pixelOffsetCache!==null){const n=this._readPixelOffset(this.domNode,t,i,s);if(n===-1)return null;const r=this._readPixelOffset(this.domNode,t,e,s);return r===-1?null:[new nk(n,r-n)]}return this._readVisibleRangesForRange(this.domNode,t,i,e,s)}_readVisibleRangesForRange(t,i,e,s,n){if(e===s){const s=this._readPixelOffset(t,i,e,n);return s===-1?null:[new nk(s,0)]}return this._readRawVisibleRangesForRange(t,e,s,n)}_readPixelOffset(t,i,e,s){if(this._characterMapping.length===0){if(this._containsForeignElements===0||this._containsForeignElements===2)return 0;if(this._containsForeignElements===1)return this.getWidth(s);const i=this._getReadingTarget(t);return i.firstChild?(s.markDidDomLayout(),i.firstChild.offsetWidth):0}if(this._pixelOffsetCache!==null){const n=this._pixelOffsetCache[e];if(n!==-1)return n;const r=this._actualReadPixelOffset(t,i,e,s);return this._pixelOffsetCache[e]=r,r}return this._actualReadPixelOffset(t,i,e,s)}_actualReadPixelOffset(t,i,e,s){if(this._characterMapping.length===0){const i=hk.readHorizontalRanges(this._getReadingTarget(t),0,0,0,0,s);return i&&i.length!==0?i[0].left:-1}if(e===this._characterMapping.length&&this._isWhitespaceOnly&&this._containsForeignElements===0)return this.getWidth(s);const n=this._characterMapping.getDomPosition(e),r=hk.readHorizontalRanges(this._getReadingTarget(t),n.partIndex,n.charIndex,n.partIndex,n.charIndex,s);if(!r||r.length===0)return-1;const o=r[0].left;if(this.input.isBasicASCII){const t=this._characterMapping.getHorizontalOffset(e),i=Math.round(this.input.spaceWidth*t);if(Math.abs(i-o)<=1)return i}return o}_readRawVisibleRangesForRange(t,i,e,s){if(i===1&&e===this._characterMapping.length)return[new nk(0,this.getWidth(s))];const n=this._characterMapping.getDomPosition(i),r=this._characterMapping.getDomPosition(e);return hk.readHorizontalRanges(this._getReadingTarget(t),n.partIndex,n.charIndex,r.partIndex,r.charIndex,s)}getColumnOfNodeOffset(t,i){return kk(this._characterMapping,t,i)}}class wk extends mk{_readVisibleRangesForRange(t,i,e,s,n){const r=super._readVisibleRangesForRange(t,i,e,s,n);if(!r||r.length===0||e===s||e===1&&s===this._characterMapping.length)return r;if(!this.input.containsRTL){const e=this._readPixelOffset(t,i,s,n);if(e!==-1){const t=r[r.length-1];t.left<e&&(t.width=e-t.left)}}return r}}const vk=Vr?bk:yk;function bk(t,i,e,s,n){return new wk(t,i,e,s,n)}function yk(t,i,e,s,n){return new mk(t,i,e,s,n)}function kk(t,i,e){const s=i.textContent.length;let n=-1;for(;i;)i=i.previousSibling,n++;return t.getColumn(new dm(n,e),s)}class Ck{static _nextVisibleColumn(t,i,e){return t===9?Ck.nextRenderTabStop(i,e):Mr(t)||Lr(t)?i+2:i+1}static visibleColumnFromColumn(t,i,e){const s=Math.min(i-1,t.length),n=t.substring(0,s),r=new br(n);let o=0;for(;!r.eol();){const t=wr(n,s,r.offset);r.nextGraphemeLength(),o=this._nextVisibleColumn(t,o,e)}return o}static columnFromVisibleColumn(t,i,e){if(i<=0)return 1;const s=t.length,n=new br(t);let r=0,o=1;for(;!n.eol();){const h=wr(t,s,n.offset);n.nextGraphemeLength();const c=this._nextVisibleColumn(h,r,e),l=n.offset+1;if(c>=i)return c-i<i-r?l:o;r=c,o=l}return s+1}static nextRenderTabStop(t,i){return t+i-t%i}static nextIndentTabStop(t,i){return t+i-t%i}static prevRenderTabStop(t,i){return Math.max(0,t-1-(t-1)%i)}static prevIndentTabStop(t,i){return Math.max(0,t-1-(t-1)%i)}}class Sk{static whitespaceVisibleColumn(t,i,e){const s=t.length;let n=0,r=-1,o=-1;for(let h=0;h<s;h++){if(h===i)return[r,o,n];switch(n%e==0&&(r=h,o=n),t.charCodeAt(h)){case 32:n+=1;break;case 9:n=Ck.nextRenderTabStop(n,e);break;default:return[-1,-1,-1]}}return i===s?[r,o,n]:[-1,-1,-1]}static atomicPosition(t,i,e,s){const n=t.length,[r,o,h]=Sk.whitespaceVisibleColumn(t,i,e);if(h===-1)return-1;let c;switch(s){case 0:c=!0;break;case 1:c=!1;break;case 2:if(h%e==0)return i;c=h%e<=e/2}if(c){if(r===-1)return-1;let i=o;for(let s=r;s<n;++s){if(i===o+e)return r;switch(t.charCodeAt(s)){case 32:i+=1;break;case 9:i=Ck.nextRenderTabStop(i,e);break;default:return-1}}return i===o+e?r:-1}const l=Ck.nextRenderTabStop(h,e);let a=h;for(let s=i;s<n;s++){if(a===l)return s;switch(t.charCodeAt(s)){case 32:a+=1;break;case 9:a=Ck.nextRenderTabStop(a,e);break;default:return-1}}return a===l?n:-1}}class xk{constructor(t=null){this.hitTarget=t,this.type=0}}class Dk{get hitTarget(){return this.spanNode}constructor(t,i,e){this.position=t,this.spanNode=i,this.injectedText=e,this.type=1}}var Ek;(function(t){t.createFromDOMInfo=function(t,i,e){const s=t.getPositionFromDOMInfo(i,e);return s?new Dk(s,i,null):new xk(i)}})(Ek||(Ek={}));class Ak{constructor(t,i){this.lastViewCursorsRenderData=t,this.lastTextareaPosition=i}}class Mk{static _deduceRage(t,i=null){return!i&&t?new Cs(t.lineNumber,t.column,t.lineNumber,t.column):i??null}static createUnknown(t,i,e){return{type:0,element:t,mouseColumn:i,position:e,range:this._deduceRage(e)}}static createTextarea(t,i){return{type:1,element:t,mouseColumn:i,position:null,range:null}}static createMargin(t,i,e,s,n,r){return{type:t,element:i,mouseColumn:e,position:s,range:n,detail:r}}static createViewZone(t,i,e,s,n){return{type:t,element:i,mouseColumn:e,position:s,range:this._deduceRage(s),detail:n}}static createContentText(t,i,e,s,n){return{type:6,element:t,mouseColumn:i,position:e,range:this._deduceRage(e,s),detail:n}}static createContentEmpty(t,i,e,s){return{type:7,element:t,mouseColumn:i,position:e,range:this._deduceRage(e),detail:s}}static createContentWidget(t,i,e){return{type:9,element:t,mouseColumn:i,position:null,range:null,detail:e}}static createScrollbar(t,i,e){return{type:11,element:t,mouseColumn:i,position:e,range:this._deduceRage(e)}}static createOverlayWidget(t,i,e){return{type:12,element:t,mouseColumn:i,position:null,range:null,detail:e}}static createOutsideEditor(t,i,e,s){return{type:13,element:null,mouseColumn:t,position:i,range:this._deduceRage(i),outsidePosition:e,outsideDistance:s}}static _typeToString(t){return t===1?"TEXTAREA":t===2?"GUTTER_GLYPH_MARGIN":t===3?"GUTTER_LINE_NUMBERS":t===4?"GUTTER_LINE_DECORATIONS":t===5?"GUTTER_VIEW_ZONE":t===6?"CONTENT_TEXT":t===7?"CONTENT_EMPTY":t===8?"CONTENT_VIEW_ZONE":t===9?"CONTENT_WIDGET":t===10?"OVERVIEW_RULER":t===11?"SCROLLBAR":t===12?"OVERLAY_WIDGET":"UNKNOWN"}static toString(t){return this._typeToString(t.type)+": "+t.position+" - "+t.range+" - "+JSON.stringify(t.detail)}}class Lk{static isTextArea(t){return t.length===2&&t[0]===3&&t[1]===7}static isChildOfViewLines(t){return t.length>=4&&t[0]===3&&t[3]===8}static isStrictChildOfViewLines(t){return t.length>4&&t[0]===3&&t[3]===8}static isChildOfScrollableElement(t){return t.length>=2&&t[0]===3&&t[1]===6}static isChildOfMinimap(t){return t.length>=2&&t[0]===3&&t[1]===9}static isChildOfContentWidgets(t){return t.length>=4&&t[0]===3&&t[3]===1}static isChildOfOverflowGuard(t){return t.length>=1&&t[0]===3}static isChildOfOverflowingContentWidgets(t){return t.length>=1&&t[0]===2}static isChildOfOverlayWidgets(t){return t.length>=2&&t[0]===3&&t[1]===4}static isChildOfOverflowingOverlayWidgets(t){return t.length>=1&&t[0]===5}}class Fk{constructor(t,i,e){this.viewModel=t.viewModel;const s=t.configuration.options;this.layoutInfo=s.get(145),this.viewDomNode=i.viewDomNode,this.lineHeight=s.get(67),this.stickyTabStops=s.get(116),this.typicalHalfwidthCharacterWidth=s.get(50).typicalHalfwidthCharacterWidth,this.lastRenderData=e,this._context=t,this._viewHelper=i}getZoneAtCoord(t){return Fk.getZoneAtCoord(this._context,t)}static getZoneAtCoord(t,i){const e=t.viewLayout.getWhitespaceAtVerticalOffset(i);if(e){const s=e.verticalOffset+e.height/2,n=t.viewModel.getLineCount();let r,o=null,h=null;return e.afterLineNumber!==n&&(h=new ks(e.afterLineNumber+1,1)),e.afterLineNumber>0&&(o=new ks(e.afterLineNumber,t.viewModel.getLineMaxColumn(e.afterLineNumber))),r=h===null?o:o===null?h:i<s?o:h,{viewZoneId:e.id,afterLineNumber:e.afterLineNumber,positionBefore:o,positionAfter:h,position:r}}return null}getFullLineRangeAtCoord(t){if(this._context.viewLayout.isAfterLines(t)){const t=this._context.viewModel.getLineCount(),i=this._context.viewModel.getLineMaxColumn(t);return{range:new Cs(t,i,t,i),isAfterLines:!0}}const i=this._context.viewLayout.getLineNumberAtVerticalOffset(t),e=this._context.viewModel.getLineMaxColumn(i);return{range:new Cs(i,1,i,e),isAfterLines:!1}}getLineNumberAtVerticalOffset(t){return this._context.viewLayout.getLineNumberAtVerticalOffset(t)}isAfterLines(t){return this._context.viewLayout.isAfterLines(t)}isInTopPadding(t){return this._context.viewLayout.isInTopPadding(t)}isInBottomPadding(t){return this._context.viewLayout.isInBottomPadding(t)}getVerticalOffsetForLineNumber(t){return this._context.viewLayout.getVerticalOffsetForLineNumber(t)}findAttribute(t,i){return Fk._findAttribute(t,i,this._viewHelper.viewDomNode)}static _findAttribute(t,i,e){for(;t&&t!==t.ownerDocument.body;){if(t.hasAttribute&&t.hasAttribute(i))return t.getAttribute(i);if(t===e)return null;t=t.parentNode}return null}getLineWidth(t){return this._viewHelper.getLineWidth(t)}visibleRangeForPosition(t,i){return this._viewHelper.visibleRangeForPosition(t,i)}getPositionFromDOMInfo(t,i){return this._viewHelper.getPositionFromDOMInfo(t,i)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}}class Tk{constructor(t,i,e,s){this.editorPos=i,this.pos=e,this.relativePos=s,this.mouseVerticalOffset=Math.max(0,t.getCurrentScrollTop()+this.relativePos.y),this.mouseContentHorizontalOffset=t.getCurrentScrollLeft()+this.relativePos.x-t.layoutInfo.contentLeft,this.isInMarginArea=this.relativePos.x<t.layoutInfo.contentLeft&&this.relativePos.x>=t.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,_k._getMouseColumn(this.mouseContentHorizontalOffset,t.typicalHalfwidthCharacterWidth))}}class Rk extends Tk{get target(){return this._useHitTestTarget?this.hitTestResult.value.hitTarget:this._eventTarget}get targetPath(){return this._targetPathCacheElement!==this.target&&(this._targetPathCacheElement=this.target,this._targetPathCacheValue=Xy.collect(this.target,this._ctx.viewDomNode)),this._targetPathCacheValue}constructor(t,i,e,s,n){super(t,i,e,s),this.hitTestResult=new Hn((()=>_k.doHitTest(this._ctx,this))),this._targetPathCacheElement=null,this._targetPathCacheValue=new Uint8Array(0),this._ctx=t,this._eventTarget=n;const r=!!this._eventTarget;this._useHitTestTarget=!r}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}\n\ttarget: ${this.target?this.target.outerHTML:null}`}get wouldBenefitFromHitTestTargetSwitch(){return!this._useHitTestTarget&&this.hitTestResult.value.hitTarget!==null&&this.target!==this.hitTestResult.value.hitTarget}switchToHitTestTarget(){this._useHitTestTarget=!0}_getMouseColumn(t=null){return t&&t.column<this._ctx.viewModel.getLineMaxColumn(t.lineNumber)?Ck.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(t.lineNumber),t.column,this._ctx.viewModel.model.getOptions().tabSize)+1:this.mouseColumn}fulfillUnknown(t=null){return Mk.createUnknown(this.target,this._getMouseColumn(t),t)}fulfillTextarea(){return Mk.createTextarea(this.target,this._getMouseColumn())}fulfillMargin(t,i,e,s){return Mk.createMargin(t,this.target,this._getMouseColumn(i),i,e,s)}fulfillViewZone(t,i,e){return Mk.createViewZone(t,this.target,this._getMouseColumn(i),i,e)}fulfillContentText(t,i,e){return Mk.createContentText(this.target,this._getMouseColumn(t),t,i,e)}fulfillContentEmpty(t,i){return Mk.createContentEmpty(this.target,this._getMouseColumn(t),t,i)}fulfillContentWidget(t){return Mk.createContentWidget(this.target,this._getMouseColumn(),t)}fulfillScrollbar(t){return Mk.createScrollbar(this.target,this._getMouseColumn(t),t)}fulfillOverlayWidget(t){return Mk.createOverlayWidget(this.target,this._getMouseColumn(),t)}}const Ok={isAfterLines:!0};function Ik(t){return{isAfterLines:!1,horizontalDistanceToText:t}}class _k{constructor(t,i){this._context=t,this._viewHelper=i}mouseTargetIsWidget(t){const i=t.target,e=Xy.collect(i,this._viewHelper.viewDomNode);return!(!Lk.isChildOfContentWidgets(e)&&!Lk.isChildOfOverflowingContentWidgets(e))||!(!Lk.isChildOfOverlayWidgets(e)&&!Lk.isChildOfOverflowingOverlayWidgets(e))}createMouseTarget(t,i,e,s,n){const r=new Fk(this._context,this._viewHelper,t),o=new Rk(r,i,e,s,n);try{const t=_k._createMouseTarget(r,o);if(t.type===6&&r.stickyTabStops&&t.position!==null){const i=_k._snapToSoftTabBoundary(t.position,r.viewModel),e=Cs.fromPositions(i,i).plusRange(t.range);return o.fulfillContentText(i,e,t.detail)}return t}catch{return o.fulfillUnknown()}}static _createMouseTarget(t,i){if(i.target===null)return i.fulfillUnknown();const e=i;let s=null;return Lk.isChildOfOverflowGuard(i.targetPath)||Lk.isChildOfOverflowingContentWidgets(i.targetPath)||Lk.isChildOfOverflowingOverlayWidgets(i.targetPath)||(s=s||i.fulfillUnknown()),s=s||_k._hitTestContentWidget(t,e),s=s||_k._hitTestOverlayWidget(t,e),s=s||_k._hitTestMinimap(t,e),s=s||_k._hitTestScrollbarSlider(t,e),s=s||_k._hitTestViewZone(t,e),s=s||_k._hitTestMargin(t,e),s=s||_k._hitTestViewCursor(t,e),s=s||_k._hitTestTextArea(t,e),s=s||_k._hitTestViewLines(t,e),s=s||_k._hitTestScrollbar(t,e),s||i.fulfillUnknown()}static _hitTestContentWidget(t,i){if(Lk.isChildOfContentWidgets(i.targetPath)||Lk.isChildOfOverflowingContentWidgets(i.targetPath)){const e=t.findAttribute(i.target,"widgetId");return e?i.fulfillContentWidget(e):i.fulfillUnknown()}return null}static _hitTestOverlayWidget(t,i){if(Lk.isChildOfOverlayWidgets(i.targetPath)||Lk.isChildOfOverflowingOverlayWidgets(i.targetPath)){const e=t.findAttribute(i.target,"widgetId");return e?i.fulfillOverlayWidget(e):i.fulfillUnknown()}return null}static _hitTestViewCursor(t,i){if(i.target){const e=t.lastRenderData.lastViewCursorsRenderData;for(const t of e)if(i.target===t.domNode)return i.fulfillContentText(t.position,null,{mightBeForeignElement:!1,injectedText:null})}if(i.isInContentArea){const e=t.lastRenderData.lastViewCursorsRenderData,s=i.mouseContentHorizontalOffset,n=i.mouseVerticalOffset;for(const r of e){if(s<r.contentLeft||s>r.contentLeft+r.width)continue;const e=t.getVerticalOffsetForLineNumber(r.position.lineNumber);if(e<=n&&n<=e+r.height)return i.fulfillContentText(r.position,null,{mightBeForeignElement:!1,injectedText:null})}}return null}static _hitTestViewZone(t,i){const e=t.getZoneAtCoord(i.mouseVerticalOffset);if(e){const t=i.isInContentArea?8:5;return i.fulfillViewZone(t,e.position,e)}return null}static _hitTestTextArea(t,i){return Lk.isTextArea(i.targetPath)?t.lastRenderData.lastTextareaPosition?i.fulfillContentText(t.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1,injectedText:null}):i.fulfillTextarea():null}static _hitTestMargin(t,i){if(i.isInMarginArea){const e=t.getFullLineRangeAtCoord(i.mouseVerticalOffset),s=e.range.getStartPosition();let n=Math.abs(i.relativePos.x);const r={isAfterLines:e.isAfterLines,glyphMarginLeft:t.layoutInfo.glyphMarginLeft,glyphMarginWidth:t.layoutInfo.glyphMarginWidth,lineNumbersWidth:t.layoutInfo.lineNumbersWidth,offsetX:n};if(n-=t.layoutInfo.glyphMarginLeft,n<=t.layoutInfo.glyphMarginWidth){const o=t.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e.range.getStartPosition()),h=t.viewModel.glyphLanes.getLanesAtLine(o.lineNumber);return r.glyphMarginLane=h[Math.floor(n/t.lineHeight)],i.fulfillMargin(2,s,e.range,r)}return n-=t.layoutInfo.glyphMarginWidth,n<=t.layoutInfo.lineNumbersWidth?i.fulfillMargin(3,s,e.range,r):(n-=t.layoutInfo.lineNumbersWidth,i.fulfillMargin(4,s,e.range,r))}return null}static _hitTestViewLines(t,i){if(!Lk.isChildOfViewLines(i.targetPath))return null;if(t.isInTopPadding(i.mouseVerticalOffset))return i.fulfillContentEmpty(new ks(1,1),Ok);if(t.isAfterLines(i.mouseVerticalOffset)||t.isInBottomPadding(i.mouseVerticalOffset)){const e=t.viewModel.getLineCount(),s=t.viewModel.getLineMaxColumn(e);return i.fulfillContentEmpty(new ks(e,s),Ok)}if(Lk.isStrictChildOfViewLines(i.targetPath)){const e=t.getLineNumberAtVerticalOffset(i.mouseVerticalOffset);if(t.viewModel.getLineLength(e)===0){const s=t.getLineWidth(e),n=Ik(i.mouseContentHorizontalOffset-s);return i.fulfillContentEmpty(new ks(e,1),n)}const s=t.getLineWidth(e);if(i.mouseContentHorizontalOffset>=s){const n=Ik(i.mouseContentHorizontalOffset-s),r=new ks(e,t.viewModel.getLineMaxColumn(e));return i.fulfillContentEmpty(r,n)}}const e=i.hitTestResult.value;return e.type===1?_k.createMouseTargetFromHitTestPosition(t,i,e.spanNode,e.position,e.injectedText):i.wouldBenefitFromHitTestTargetSwitch?(i.switchToHitTestTarget(),this._createMouseTarget(t,i)):i.fulfillUnknown()}static _hitTestMinimap(t,i){if(Lk.isChildOfMinimap(i.targetPath)){const e=t.getLineNumberAtVerticalOffset(i.mouseVerticalOffset),s=t.viewModel.getLineMaxColumn(e);return i.fulfillScrollbar(new ks(e,s))}return null}static _hitTestScrollbarSlider(t,i){if(Lk.isChildOfScrollableElement(i.targetPath)&&i.target&&i.target.nodeType===1){const e=i.target.className;if(e&&/\b(slider|scrollbar)\b/.test(e)){const e=t.getLineNumberAtVerticalOffset(i.mouseVerticalOffset),s=t.viewModel.getLineMaxColumn(e);return i.fulfillScrollbar(new ks(e,s))}}return null}static _hitTestScrollbar(t,i){if(Lk.isChildOfScrollableElement(i.targetPath)){const e=t.getLineNumberAtVerticalOffset(i.mouseVerticalOffset),s=t.viewModel.getLineMaxColumn(e);return i.fulfillScrollbar(new ks(e,s))}return null}getMouseColumn(t){const i=this._context.configuration.options,e=i.get(145),s=this._context.viewLayout.getCurrentScrollLeft()+t.x-e.contentLeft;return _k._getMouseColumn(s,i.get(50).typicalHalfwidthCharacterWidth)}static _getMouseColumn(t,i){return t<0?1:Math.round(t/i)+1}static createMouseTargetFromHitTestPosition(t,i,e,s,n){const r=s.lineNumber,o=s.column,h=t.getLineWidth(r);if(i.mouseContentHorizontalOffset>h){const t=Ik(i.mouseContentHorizontalOffset-h);return i.fulfillContentEmpty(s,t)}const c=t.visibleRangeForPosition(r,o);if(!c)return i.fulfillUnknown(s);const l=c.left;if(Math.abs(i.mouseContentHorizontalOffset-l)<1)return i.fulfillContentText(s,null,{mightBeForeignElement:!!n,injectedText:n});const a=[];if(a.push({offset:c.left,column:o}),o>1){const i=t.visibleRangeForPosition(r,o-1);i&&a.push({offset:i.left,column:o-1})}if(o<t.viewModel.getLineMaxColumn(r)){const i=t.visibleRangeForPosition(r,o+1);i&&a.push({offset:i.left,column:o+1})}a.sort(((t,i)=>t.offset-i.offset));const u=i.pos.toClientCoordinates(Uh(t.viewDomNode)),d=e.getBoundingClientRect(),f=d.left<=u.clientX&&u.clientX<=d.right;let g=null;for(let t=1;t<a.length;t++){const e=a[t-1],n=a[t];if(e.offset<=i.mouseContentHorizontalOffset&&i.mouseContentHorizontalOffset<=n.offset){g=new Cs(r,e.column,r,n.column);const t=Math.abs(e.offset-i.mouseContentHorizontalOffset),o=Math.abs(n.offset-i.mouseContentHorizontalOffset);s=new ks(r,t<o?e.column:n.column);break}}return i.fulfillContentText(s,g,{mightBeForeignElement:!f||!!n,injectedText:n})}static _doHitTestWithCaretRangeFromPoint(t,i){const e=t.getLineNumberAtVerticalOffset(i.mouseVerticalOffset),s=t.getVerticalOffsetForLineNumber(e),n=s+t.lineHeight;if(!(e===t.viewModel.getLineCount()&&i.mouseVerticalOffset>n)){const e=Math.floor((s+n)/2);let r=i.pos.y+(e-i.mouseVerticalOffset);r<=i.editorPos.y&&(r=i.editorPos.y+1),r>=i.editorPos.y+i.editorPos.height&&(r=i.editorPos.y+i.editorPos.height-1);const o=new By(i.pos.x,r),h=this._actualDoHitTestWithCaretRangeFromPoint(t,o.toClientCoordinates(Uh(t.viewDomNode)));if(h.type===1)return h}return this._actualDoHitTestWithCaretRangeFromPoint(t,i.pos.toClientCoordinates(Uh(t.viewDomNode)))}static _actualDoHitTestWithCaretRangeFromPoint(t,i){const e=Mc(t.viewDomNode);let s;if(s=e?e.caretRangeFromPoint===void 0?function(t,i,e){const s=document.createRange();let n=t.elementFromPoint(i,e);if(n!==null){for(;n&&n.firstChild&&n.firstChild.nodeType!==n.firstChild.TEXT_NODE&&n.lastChild&&n.lastChild.firstChild;)n=n.lastChild;const t=n.getBoundingClientRect(),e=Uh(n),r=`${e.getComputedStyle(n,null).getPropertyValue("font-style")} ${e.getComputedStyle(n,null).getPropertyValue("font-variant")} ${e.getComputedStyle(n,null).getPropertyValue("font-weight")} ${e.getComputedStyle(n,null).getPropertyValue("font-size")}/${e.getComputedStyle(n,null).getPropertyValue("line-height")} ${e.getComputedStyle(n,null).getPropertyValue("font-family")}`,o=n.innerText;let h,c=t.left,l=0;if(i>t.left+t.width)l=o.length;else{const t=Pk.getInstance();for(let e=0;e<o.length+1;e++){if(h=t.getCharWidth(o.charAt(e),r)/2,c+=h,i<c){l=e;break}c+=h}}s.setStart(n.firstChild,l),s.setEnd(n.firstChild,l)}return s}(e,i.clientX,i.clientY):e.caretRangeFromPoint(i.clientX,i.clientY):t.viewDomNode.ownerDocument.caretRangeFromPoint(i.clientX,i.clientY),!s||!s.startContainer)return new xk;const n=s.startContainer;if(n.nodeType===n.TEXT_NODE){const i=n.parentNode,e=i?i.parentNode:null,r=e?e.parentNode:null;return(r&&r.nodeType===r.ELEMENT_NODE?r.className:null)===gk.CLASS_NAME?Ek.createFromDOMInfo(t,i,s.startOffset):new xk(n.parentNode)}if(n.nodeType===n.ELEMENT_NODE){const i=n.parentNode,e=i?i.parentNode:null;return(e&&e.nodeType===e.ELEMENT_NODE?e.className:null)===gk.CLASS_NAME?Ek.createFromDOMInfo(t,n,n.textContent.length):new xk(n)}return new xk}static _doHitTestWithCaretPositionFromPoint(t,i){const e=t.viewDomNode.ownerDocument.caretPositionFromPoint(i.clientX,i.clientY);if(e.offsetNode.nodeType===e.offsetNode.TEXT_NODE){const i=e.offsetNode.parentNode,s=i?i.parentNode:null,n=s?s.parentNode:null;return(n&&n.nodeType===n.ELEMENT_NODE?n.className:null)===gk.CLASS_NAME?Ek.createFromDOMInfo(t,e.offsetNode.parentNode,e.offset):new xk(e.offsetNode.parentNode)}if(e.offsetNode.nodeType===e.offsetNode.ELEMENT_NODE){const i=e.offsetNode.parentNode,s=i&&i.nodeType===i.ELEMENT_NODE?i.className:null,n=i?i.parentNode:null,r=n&&n.nodeType===n.ELEMENT_NODE?n.className:null;if(s===gk.CLASS_NAME){const i=e.offsetNode.childNodes[Math.min(e.offset,e.offsetNode.childNodes.length-1)];if(i)return Ek.createFromDOMInfo(t,i,0)}else if(r===gk.CLASS_NAME)return Ek.createFromDOMInfo(t,e.offsetNode,0)}return new xk(e.offsetNode)}static _snapToSoftTabBoundary(t,i){const e=i.getLineContent(t.lineNumber),{tabSize:s}=i.model.getOptions(),n=Sk.atomicPosition(e,t.column-1,s,2);return n!==-1?new ks(t.lineNumber,n+1):t}static doHitTest(t,i){let e=new xk;if(typeof t.viewDomNode.ownerDocument.caretRangeFromPoint=="function"?e=this._doHitTestWithCaretRangeFromPoint(t,i):t.viewDomNode.ownerDocument.caretPositionFromPoint&&(e=this._doHitTestWithCaretPositionFromPoint(t,i.pos.toClientCoordinates(Uh(t.viewDomNode)))),e.type===1){const i=t.viewModel.getInjectedTextAt(e.position),s=t.viewModel.normalizePosition(e.position,2);!i&&s.equals(e.position)||(e=new Dk(s,e.spanNode,i))}return e}}class Pk{static getInstance(){return Pk._INSTANCE||(Pk._INSTANCE=new Pk),Pk._INSTANCE}constructor(){this._cache={},this._canvas=document.createElement("canvas")}getCharWidth(t,i){const e=t+i;if(this._cache[e])return this._cache[e];const s=this._canvas.getContext("2d");s.font=i;const n=s.measureText(t).width;return this._cache[e]=n,n}}function Nk(t,i,e){let s=null,n=null;if(typeof e.value=="function"?(s="value",n=e.value,n.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof e.get=="function"&&(s="get",n=e.get),!n)throw new Error("not supported");const r=`$memoize$${i}`;e[s]=function(...t){return this.hasOwnProperty(r)||Object.defineProperty(this,r,{configurable:!1,enumerable:!1,writable:!1,value:n.apply(this,t)}),this[r]}}Pk._INSTANCE=null;var Bk,$k=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o};(function(t){t.Tap="-monaco-gesturetap",t.Change="-monaco-gesturechange",t.Start="-monaco-gesturestart",t.End="-monaco-gesturesend",t.Contextmenu="-monaco-gesturecontextmenu"})(Bk||(Bk={}));class Wk extends Qi{constructor(){super(),this.dispatched=!1,this.targets=new Ht,this.ignoreTargets=new Ht,this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(ne.runAndSubscribe(Yh,(({window:t,disposables:i})=>{i.add(sc(t.document,"touchstart",(t=>this.onTouchStart(t)),{passive:!1})),i.add(sc(t.document,"touchend",(i=>this.onTouchEnd(t,i)))),i.add(sc(t.document,"touchmove",(t=>this.onTouchMove(t)),{passive:!1}))}),{window:Wn,disposables:this._store}))}static addTarget(t){return Wk.isTouchDevice()?(Wk.INSTANCE||(Wk.INSTANCE=new Wk),Zi(Wk.INSTANCE.targets.push(t))):Qi.None}static ignoreTarget(t){return Wk.isTouchDevice()?(Wk.INSTANCE||(Wk.INSTANCE=new Wk),Zi(Wk.INSTANCE.ignoreTargets.push(t))):Qi.None}static isTouchDevice(){return"ontouchstart"in Wn||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(t){const i=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let e=0,s=t.targetTouches.length;e<s;e++){const s=t.targetTouches.item(e);this.activeTouches[s.identifier]={id:s.identifier,initialTarget:s.target,initialTimeStamp:i,initialPageX:s.pageX,initialPageY:s.pageY,rollingTimestamps:[i],rollingPageX:[s.pageX],rollingPageY:[s.pageY]};const n=this.newGestureEvent(Bk.Start,s.target);n.pageX=s.pageX,n.pageY=s.pageY,this.dispatchEvent(n)}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}onTouchEnd(t,i){const e=Date.now(),n=Object.keys(this.activeTouches).length;for(let r=0,o=i.changedTouches.length;r<o;r++){const o=i.changedTouches.item(r);if(!this.activeTouches.hasOwnProperty(String(o.identifier))){console.warn("move of an UNKNOWN touch",o);continue}const h=this.activeTouches[o.identifier],c=Date.now()-h.initialTimeStamp;if(c<Wk.HOLD_DELAY&&Math.abs(h.initialPageX-s(h.rollingPageX))<30&&Math.abs(h.initialPageY-s(h.rollingPageY))<30){const t=this.newGestureEvent(Bk.Tap,h.initialTarget);t.pageX=s(h.rollingPageX),t.pageY=s(h.rollingPageY),this.dispatchEvent(t)}else if(c>=Wk.HOLD_DELAY&&Math.abs(h.initialPageX-s(h.rollingPageX))<30&&Math.abs(h.initialPageY-s(h.rollingPageY))<30){const t=this.newGestureEvent(Bk.Contextmenu,h.initialTarget);t.pageX=s(h.rollingPageX),t.pageY=s(h.rollingPageY),this.dispatchEvent(t)}else if(n===1){const i=s(h.rollingPageX),n=s(h.rollingPageY),r=s(h.rollingTimestamps)-h.rollingTimestamps[0],o=i-h.rollingPageX[0],c=n-h.rollingPageY[0],l=[...this.targets].filter((t=>h.initialTarget instanceof Node&&t.contains(h.initialTarget)));this.inertia(t,l,e,Math.abs(o)/r,o>0?1:-1,i,Math.abs(c)/r,c>0?1:-1,n)}this.dispatchEvent(this.newGestureEvent(Bk.End,h.initialTarget)),delete this.activeTouches[o.identifier]}this.dispatched&&(i.preventDefault(),i.stopPropagation(),this.dispatched=!1)}newGestureEvent(t,i){const e=document.createEvent("CustomEvent");return e.initEvent(t,!1,!0),e.initialTarget=i,e.tapCount=0,e}dispatchEvent(t){if(t.type===Bk.Tap){const i=(new Date).getTime();let e=0;e=i-this._lastSetTapCountTime>Wk.CLEAR_TAP_COUNT_TIME?1:2,this._lastSetTapCountTime=i,t.tapCount=e}else t.type!==Bk.Change&&t.type!==Bk.Contextmenu||(this._lastSetTapCountTime=0);if(t.initialTarget instanceof Node){for(const i of this.ignoreTargets)if(i.contains(t.initialTarget))return;const i=[];for(const e of this.targets)if(e.contains(t.initialTarget)){let s=0,n=t.initialTarget;for(;n&&n!==e;)s++,n=n.parentElement;i.push([s,e])}i.sort(((t,i)=>t[0]-i[0]));for(const[e,s]of i)s.dispatchEvent(t),this.dispatched=!0}}inertia(t,i,e,s,n,r,o,h,c){this.handle=ac(t,(()=>{const l=Date.now(),a=l-e;let u=0,d=0,f=!0;s+=Wk.SCROLL_FRICTION*a,o+=Wk.SCROLL_FRICTION*a,s>0&&(f=!1,u=n*s*a),o>0&&(f=!1,d=h*o*a);const g=this.newGestureEvent(Bk.Change);g.translationX=u,g.translationY=d,i.forEach((t=>t.dispatchEvent(g))),f||this.inertia(t,i,l,s,n,r+u,o,h,c+d)}))}onTouchMove(t){const i=Date.now();for(let e=0,n=t.changedTouches.length;e<n;e++){const n=t.changedTouches.item(e);if(!this.activeTouches.hasOwnProperty(String(n.identifier))){console.warn("end of an UNKNOWN touch",n);continue}const r=this.activeTouches[n.identifier],o=this.newGestureEvent(Bk.Change,r.initialTarget);o.translationX=n.pageX-s(r.rollingPageX),o.translationY=n.pageY-s(r.rollingPageY),o.pageX=n.pageX,o.pageY=n.pageY,this.dispatchEvent(o),r.rollingPageX.length>3&&(r.rollingPageX.shift(),r.rollingPageY.shift(),r.rollingTimestamps.shift()),r.rollingPageX.push(n.pageX),r.rollingPageY.push(n.pageY),r.rollingTimestamps.push(i)}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}}Wk.SCROLL_FRICTION=-.005,Wk.HOLD_DELAY=700,Wk.CLEAR_TAP_COUNT_TIME=400,$k([Nk],Wk,"isTouchDevice",null);let jk=class extends Qi{onclick(t,i){this._register(sc(t,qc.CLICK,(e=>i(new ho(Uh(t),e)))))}onmousedown(t,i){this._register(sc(t,qc.MOUSE_DOWN,(e=>i(new ho(Uh(t),e)))))}onmouseover(t,i){this._register(sc(t,qc.MOUSE_OVER,(e=>i(new ho(Uh(t),e)))))}onmouseleave(t,i){this._register(sc(t,qc.MOUSE_LEAVE,(e=>i(new ho(Uh(t),e)))))}onkeydown(t,i){this._register(sc(t,qc.KEY_DOWN,(t=>i(new so(t)))))}onkeyup(t,i){this._register(sc(t,qc.KEY_UP,(t=>i(new so(t)))))}oninput(t,i){this._register(sc(t,qc.INPUT,i))}onblur(t,i){this._register(sc(t,qc.BLUR,i))}onfocus(t,i){this._register(sc(t,qc.FOCUS,i))}ignoreGesture(t){return Wk.ignoreTarget(t)}};const Hk=11;class Vk extends jk{constructor(t){super(),this._onActivate=t.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=t.bgWidth+"px",this.bgDomNode.style.height=t.bgHeight+"px",t.top!==void 0&&(this.bgDomNode.style.top="0px"),t.left!==void 0&&(this.bgDomNode.style.left="0px"),t.bottom!==void 0&&(this.bgDomNode.style.bottom="0px"),t.right!==void 0&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=t.className,this.domNode.classList.add(...Kl.asClassNameArray(t.icon)),this.domNode.style.position="absolute",this.domNode.style.width="11px",this.domNode.style.height="11px",t.top!==void 0&&(this.domNode.style.top=t.top+"px"),t.left!==void 0&&(this.domNode.style.left=t.left+"px"),t.bottom!==void 0&&(this.domNode.style.bottom=t.bottom+"px"),t.right!==void 0&&(this.domNode.style.right=t.right+"px"),this._pointerMoveMonitor=this._register(new Lw),this._register(rc(this.bgDomNode,qc.POINTER_DOWN,(t=>this._arrowPointerDown(t)))),this._register(rc(this.domNode,qc.POINTER_DOWN,(t=>this._arrowPointerDown(t)))),this._pointerdownRepeatTimer=this._register(new uc),this._pointerdownScheduleRepeatTimer=this._register(new yo)}_arrowPointerDown(t){t.target&&t.target instanceof Element&&(this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet((()=>{this._pointerdownRepeatTimer.cancelAndSet((()=>this._onActivate()),1e3/24,Uh(t))}),200),this._pointerMoveMonitor.startMonitoring(t.target,t.pointerId,t.buttons,(t=>{}),(()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()})),t.preventDefault())}}class zk extends Qi{constructor(t,i,e){super(),this._visibility=t,this._visibleClassName=i,this._invisibleClassName=e,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new yo)}setVisibility(t){this._visibility!==t&&(this._visibility=t,this._updateShouldBeVisible())}setShouldBeVisible(t){this._rawShouldBeVisible=t,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility!==2&&(this._visibility===3||this._rawShouldBeVisible)}_updateShouldBeVisible(){const t=this._applyVisibilitySetting();this._shouldBeVisible!==t&&(this._shouldBeVisible=t,this.ensureVisibility())}setIsNeeded(t){this._isNeeded!==t&&(this._isNeeded=t,this.ensureVisibility())}setDomNode(t){this._domNode=t,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){this._isNeeded?this._shouldBeVisible?this._reveal():this._hide(!0):this._hide(!1)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet((()=>{var t;(t=this._domNode)===null||t===void 0||t.setClassName(this._visibleClassName)}),0))}_hide(t){var i;this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,(i=this._domNode)===null||i===void 0||i.setClassName(this._invisibleClassName+(t?" fade":"")))}}class Uk extends jk{constructor(t){super(),this._lazyRender=t.lazyRender,this._host=t.host,this._scrollable=t.scrollable,this._scrollByPage=t.scrollByPage,this._scrollbarState=t.scrollbarState,this._visibilityController=this._register(new zk(t.visibility,"visible scrollbar "+t.extraScrollbarClassName,"invisible scrollbar "+t.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new Lw),this._shouldRender=!0,this.domNode=Sl(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(sc(this.domNode.domNode,qc.POINTER_DOWN,(t=>this._domNodePointerDown(t))))}_createArrow(t){const i=this._register(new Vk(t));this.domNode.domNode.appendChild(i.bgDomNode),this.domNode.domNode.appendChild(i.domNode)}_createSlider(t,i,e,s){this.slider=Sl(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(t),this.slider.setLeft(i),typeof e=="number"&&this.slider.setWidth(e),typeof s=="number"&&this.slider.setHeight(s),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(sc(this.slider.domNode,qc.POINTER_DOWN,(t=>{t.button===0&&(t.preventDefault(),this._sliderPointerDown(t))}))),this.onclick(this.slider.domNode,(t=>{t.leftButton&&t.stopPropagation()}))}_onElementSize(t){return this._scrollbarState.setVisibleSize(t)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(t){return this._scrollbarState.setScrollSize(t)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(t){return this._scrollbarState.setScrollPosition(t)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(t){t.target===this.domNode.domNode&&this._onPointerDown(t)}delegatePointerDown(t){const i=this.domNode.domNode.getClientRects()[0].top,e=i+this._scrollbarState.getSliderPosition(),s=i+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),n=this._sliderPointerPosition(t);e<=n&&n<=s?t.button===0&&(t.preventDefault(),this._sliderPointerDown(t)):this._onPointerDown(t)}_onPointerDown(t){let i,e;if(t.target===this.domNode.domNode&&typeof t.offsetX=="number"&&typeof t.offsetY=="number")i=t.offsetX,e=t.offsetY;else{const s=vc(this.domNode.domNode);i=t.pageX-s.left,e=t.pageY-s.top}const s=this._pointerDownRelativePosition(i,e);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(s):this._scrollbarState.getDesiredScrollPositionFromOffset(s)),t.button===0&&(t.preventDefault(),this._sliderPointerDown(t))}_sliderPointerDown(t){if(!(t.target&&t.target instanceof Element))return;const i=this._sliderPointerPosition(t),e=this._sliderOrthogonalPointerPosition(t),s=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(t.target,t.pointerId,t.buttons,(t=>{const n=this._sliderOrthogonalPointerPosition(t),r=Math.abs(n-e);if(vt&&r>140)return void this._setDesiredScrollPositionNow(s.getScrollPosition());const o=this._sliderPointerPosition(t)-i;this._setDesiredScrollPositionNow(s.getDesiredScrollPositionFromDelta(o))}),(()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()})),this._host.onDragStart()}_setDesiredScrollPositionNow(t){const i={};this.writeScrollPosition(i,t),this._scrollable.setScrollPositionNow(i)}updateScrollbarSize(t){this._updateScrollbarSize(t),this._scrollbarState.setScrollbarSize(t),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}}class Kk{constructor(t,i,e,s,n,r){this._scrollbarSize=Math.round(i),this._oppositeScrollbarSize=Math.round(e),this._arrowSize=Math.round(t),this._visibleSize=s,this._scrollSize=n,this._scrollPosition=r,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new Kk(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(t){const i=Math.round(t);return this._visibleSize!==i&&(this._visibleSize=i,this._refreshComputedValues(),!0)}setScrollSize(t){const i=Math.round(t);return this._scrollSize!==i&&(this._scrollSize=i,this._refreshComputedValues(),!0)}setScrollPosition(t){const i=Math.round(t);return this._scrollPosition!==i&&(this._scrollPosition=i,this._refreshComputedValues(),!0)}setScrollbarSize(t){this._scrollbarSize=Math.round(t)}setOppositeScrollbarSize(t){this._oppositeScrollbarSize=Math.round(t)}static _computeValues(t,i,e,s,n){const r=Math.max(0,e-t),o=Math.max(0,r-2*i),h=s>0&&s>e;if(!h)return{computedAvailableSize:Math.round(r),computedIsNeeded:h,computedSliderSize:Math.round(o),computedSliderRatio:0,computedSliderPosition:0};const c=Math.round(Math.max(20,Math.floor(e*o/s))),l=(o-c)/(s-e),a=n*l;return{computedAvailableSize:Math.round(r),computedIsNeeded:h,computedSliderSize:Math.round(c),computedSliderRatio:l,computedSliderPosition:Math.round(a)}}_refreshComputedValues(){const t=Kk._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=t.computedAvailableSize,this._computedIsNeeded=t.computedIsNeeded,this._computedSliderSize=t.computedSliderSize,this._computedSliderRatio=t.computedSliderRatio,this._computedSliderPosition=t.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(t){if(!this._computedIsNeeded)return 0;const i=t-this._arrowSize-this._computedSliderSize/2;return Math.round(i/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(t){if(!this._computedIsNeeded)return 0;const i=t-this._arrowSize;let e=this._scrollPosition;return i<this._computedSliderPosition?e-=this._visibleSize:e+=this._visibleSize,e}getDesiredScrollPositionFromDelta(t){if(!this._computedIsNeeded)return 0;const i=this._computedSliderPosition+t;return Math.round(i/this._computedSliderRatio)}}class qk extends Uk{constructor(t,i,e){const s=t.getScrollDimensions(),n=t.getCurrentScrollPosition();if(super({lazyRender:i.lazyRender,host:e,scrollbarState:new Kk(i.horizontalHasArrows?i.arrowSize:0,i.horizontal===2?0:i.horizontalScrollbarSize,i.vertical===2?0:i.verticalScrollbarSize,s.width,s.scrollWidth,n.scrollLeft),visibility:i.horizontal,extraScrollbarClassName:"horizontal",scrollable:t,scrollByPage:i.scrollByPage}),i.horizontalHasArrows){const t=(i.arrowSize-Hk)/2,e=(i.horizontalScrollbarSize-Hk)/2;this._createArrow({className:"scra",icon:As.scrollbarButtonLeft,top:e,left:t,bottom:void 0,right:void 0,bgWidth:i.arrowSize,bgHeight:i.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new co(null,1,0))}),this._createArrow({className:"scra",icon:As.scrollbarButtonRight,top:e,left:void 0,bottom:void 0,right:t,bgWidth:i.arrowSize,bgHeight:i.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new co(null,-1,0))})}this._createSlider(Math.floor((i.horizontalScrollbarSize-i.horizontalSliderSize)/2),0,void 0,i.horizontalSliderSize)}_updateSlider(t,i){this.slider.setWidth(t),this.slider.setLeft(i)}_renderDomNode(t,i){this.domNode.setWidth(t),this.domNode.setHeight(i),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(t){return this._shouldRender=this._onElementScrollSize(t.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(t.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(t.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(t,i){return t}_sliderPointerPosition(t){return t.pageX}_sliderOrthogonalPointerPosition(t){return t.pageY}_updateScrollbarSize(t){this.slider.setHeight(t)}writeScrollPosition(t,i){t.scrollLeft=i}updateOptions(t){this.updateScrollbarSize(t.horizontal===2?0:t.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(t.vertical===2?0:t.verticalScrollbarSize),this._visibilityController.setVisibility(t.horizontal),this._scrollByPage=t.scrollByPage}}class Gk extends Uk{constructor(t,i,e){const s=t.getScrollDimensions(),n=t.getCurrentScrollPosition();if(super({lazyRender:i.lazyRender,host:e,scrollbarState:new Kk(i.verticalHasArrows?i.arrowSize:0,i.vertical===2?0:i.verticalScrollbarSize,0,s.height,s.scrollHeight,n.scrollTop),visibility:i.vertical,extraScrollbarClassName:"vertical",scrollable:t,scrollByPage:i.scrollByPage}),i.verticalHasArrows){const t=(i.arrowSize-Hk)/2,e=(i.verticalScrollbarSize-Hk)/2;this._createArrow({className:"scra",icon:As.scrollbarButtonUp,top:t,left:e,bottom:void 0,right:void 0,bgWidth:i.verticalScrollbarSize,bgHeight:i.arrowSize,onActivate:()=>this._host.onMouseWheel(new co(null,0,1))}),this._createArrow({className:"scra",icon:As.scrollbarButtonDown,top:void 0,left:e,bottom:t,right:void 0,bgWidth:i.verticalScrollbarSize,bgHeight:i.arrowSize,onActivate:()=>this._host.onMouseWheel(new co(null,0,-1))})}this._createSlider(0,Math.floor((i.verticalScrollbarSize-i.verticalSliderSize)/2),i.verticalSliderSize,void 0)}_updateSlider(t,i){this.slider.setHeight(t),this.slider.setTop(i)}_renderDomNode(t,i){this.domNode.setWidth(i),this.domNode.setHeight(t),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(t){return this._shouldRender=this._onElementScrollSize(t.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(t.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(t.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(t,i){return i}_sliderPointerPosition(t){return t.pageY}_sliderOrthogonalPointerPosition(t){return t.pageX}_updateScrollbarSize(t){this.slider.setWidth(t)}writeScrollPosition(t,i){t.scrollTop=i}updateOptions(t){this.updateScrollbarSize(t.vertical===2?0:t.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(t.vertical),this._scrollByPage=t.scrollByPage}}class Zk{constructor(t,i,e,s,n,r,o){this._forceIntegerValues=t,this._scrollStateBrand=void 0,this._forceIntegerValues&&(i|=0,e|=0,s|=0,n|=0,r|=0,o|=0),this.rawScrollLeft=s,this.rawScrollTop=o,i<0&&(i=0),s+i>e&&(s=e-i),s<0&&(s=0),n<0&&(n=0),o+n>r&&(o=r-n),o<0&&(o=0),this.width=i,this.scrollWidth=e,this.scrollLeft=s,this.height=n,this.scrollHeight=r,this.scrollTop=o}equals(t){return this.rawScrollLeft===t.rawScrollLeft&&this.rawScrollTop===t.rawScrollTop&&this.width===t.width&&this.scrollWidth===t.scrollWidth&&this.scrollLeft===t.scrollLeft&&this.height===t.height&&this.scrollHeight===t.scrollHeight&&this.scrollTop===t.scrollTop}withScrollDimensions(t,i){return new Zk(this._forceIntegerValues,t.width!==void 0?t.width:this.width,t.scrollWidth!==void 0?t.scrollWidth:this.scrollWidth,i?this.rawScrollLeft:this.scrollLeft,t.height!==void 0?t.height:this.height,t.scrollHeight!==void 0?t.scrollHeight:this.scrollHeight,i?this.rawScrollTop:this.scrollTop)}withScrollPosition(t){return new Zk(this._forceIntegerValues,this.width,this.scrollWidth,t.scrollLeft!==void 0?t.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,t.scrollTop!==void 0?t.scrollTop:this.rawScrollTop)}createScrollEvent(t,i){const e=this.width!==t.width,s=this.scrollWidth!==t.scrollWidth,n=this.scrollLeft!==t.scrollLeft,r=this.height!==t.height,o=this.scrollHeight!==t.scrollHeight,h=this.scrollTop!==t.scrollTop;return{inSmoothScrolling:i,oldWidth:t.width,oldScrollWidth:t.scrollWidth,oldScrollLeft:t.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:t.height,oldScrollHeight:t.scrollHeight,oldScrollTop:t.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:e,scrollWidthChanged:s,scrollLeftChanged:n,heightChanged:r,scrollHeightChanged:o,scrollTopChanged:h}}}class Jk extends Qi{constructor(t){super(),this._scrollableBrand=void 0,this._onScroll=this._register(new le),this.onScroll=this._onScroll.event,this._smoothScrollDuration=t.smoothScrollDuration,this._scheduleAtNextAnimationFrame=t.scheduleAtNextAnimationFrame,this._state=new Zk(t.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(t){this._smoothScrollDuration=t}validateScrollPosition(t){return this._state.withScrollPosition(t)}getScrollDimensions(){return this._state}setScrollDimensions(t,i){var e;const s=this._state.withScrollDimensions(t,i);this._setState(s,!!this._smoothScrolling),(e=this._smoothScrolling)===null||e===void 0||e.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(t){const i=this._state.withScrollPosition(t);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(i,!1)}setScrollPositionSmooth(t,i){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(t);if(this._smoothScrolling){t={scrollLeft:t.scrollLeft===void 0?this._smoothScrolling.to.scrollLeft:t.scrollLeft,scrollTop:t.scrollTop===void 0?this._smoothScrolling.to.scrollTop:t.scrollTop};const e=this._state.withScrollPosition(t);if(this._smoothScrolling.to.scrollLeft===e.scrollLeft&&this._smoothScrolling.to.scrollTop===e.scrollTop)return;let s;s=i?new Xk(this._smoothScrolling.from,e,this._smoothScrolling.startTime,this._smoothScrolling.duration):this._smoothScrolling.combine(this._state,e,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=s}else{const i=this._state.withScrollPosition(t);this._smoothScrolling=Xk.start(this._state,i,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame((()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())}))}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;const t=this._smoothScrolling.tick(),i=this._state.withScrollPosition(t);return this._setState(i,!0),this._smoothScrolling?t.isDone?(this._smoothScrolling.dispose(),void(this._smoothScrolling=null)):void(this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame((()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())}))):void 0}_setState(t,i){const e=this._state;e.equals(t)||(this._state=t,this._onScroll.fire(this._state.createScrollEvent(e,i)))}}class Qk{constructor(t,i,e){this.scrollLeft=t,this.scrollTop=i,this.isDone=e}}function Yk(t,i){const e=i-t;return function(i){return t+e*(1-function(t){return Math.pow(t,3)}(1-i))}}class Xk{constructor(t,i,e,s){this.from=t,this.to=i,this.duration=s,this.startTime=e,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(t,i,e){if(Math.abs(t-i)>2.5*e){let o,h;return t<i?(o=t+.75*e,h=i-.75*e):(o=t-.75*e,h=i+.75*e),s=Yk(t,o),n=Yk(h,i),r=.33,function(t){return t<r?s(t/r):n((t-r)/(1-r))}}var s,n,r;return Yk(t,i)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(t){this.to=t.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(t){const i=(t-this.startTime)/this.duration;if(i<1){const t=this.scrollLeft(i),e=this.scrollTop(i);return new Qk(t,e,!1)}return new Qk(this.to.scrollLeft,this.to.scrollTop,!0)}combine(t,i,e){return Xk.start(t,i,e)}static start(t,i,e){e+=10;const s=Date.now()-10;return new Xk(t,i,s,e)}}class tC{constructor(t,i,e){this.timestamp=t,this.deltaX=i,this.deltaY=e,this.score=0}}class iC{constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let t=1,i=0,e=1,s=this._rear;for(;;){const n=s===this._front?t:Math.pow(2,-e);if(t-=n,i+=this._memory[s].score*n,s===this._front)break;s=(this._capacity+s-1)%this._capacity,e++}return i<=.5}acceptStandardWheelEvent(t){if(zr){const i=function(t){return $r.INSTANCE.getZoomFactor(t)}(Uh(t.browserEvent));this.accept(Date.now(),t.deltaX*i,t.deltaY*i)}else this.accept(Date.now(),t.deltaX,t.deltaY)}accept(t,i,e){let s=null;const n=new tC(t,i,e);this._front===-1&&this._rear===-1?(this._memory[0]=n,this._front=0,this._rear=0):(s=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=n),n.score=this._computeScore(n,s)}_computeScore(t,i){if(Math.abs(t.deltaX)>0&&Math.abs(t.deltaY)>0)return 1;let e=.5;if(this._isAlmostInt(t.deltaX)&&this._isAlmostInt(t.deltaY)||(e+=.25),i){const s=Math.abs(t.deltaX),n=Math.abs(t.deltaY),r=Math.abs(i.deltaX),o=Math.abs(i.deltaY),h=Math.max(Math.min(s,r),1),c=Math.max(Math.min(n,o),1),l=Math.max(s,r),a=Math.max(n,o);l%h==0&&a%c==0&&(e-=.5)}return Math.min(Math.max(e,0),1)}_isAlmostInt(t){return Math.abs(Math.round(t)-t)<.01}}iC.INSTANCE=new iC;class eC extends jk{get options(){return this._options}constructor(t,i,e){super(),this._onScroll=this._register(new le),this.onScroll=this._onScroll.event,this._onWillScroll=this._register(new le),t.style.overflow="hidden",this._options=function(t){const i={lazyRender:t.lazyRender!==void 0&&t.lazyRender,className:t.className!==void 0?t.className:"",useShadows:t.useShadows===void 0||t.useShadows,handleMouseWheel:t.handleMouseWheel===void 0||t.handleMouseWheel,flipAxes:t.flipAxes!==void 0&&t.flipAxes,consumeMouseWheelIfScrollbarIsNeeded:t.consumeMouseWheelIfScrollbarIsNeeded!==void 0&&t.consumeMouseWheelIfScrollbarIsNeeded,alwaysConsumeMouseWheel:t.alwaysConsumeMouseWheel!==void 0&&t.alwaysConsumeMouseWheel,scrollYToX:t.scrollYToX!==void 0&&t.scrollYToX,mouseWheelScrollSensitivity:t.mouseWheelScrollSensitivity!==void 0?t.mouseWheelScrollSensitivity:1,fastScrollSensitivity:t.fastScrollSensitivity!==void 0?t.fastScrollSensitivity:5,scrollPredominantAxis:t.scrollPredominantAxis===void 0||t.scrollPredominantAxis,mouseWheelSmoothScroll:t.mouseWheelSmoothScroll===void 0||t.mouseWheelSmoothScroll,arrowSize:t.arrowSize!==void 0?t.arrowSize:11,listenOnDomNode:t.listenOnDomNode!==void 0?t.listenOnDomNode:null,horizontal:t.horizontal!==void 0?t.horizontal:1,horizontalScrollbarSize:t.horizontalScrollbarSize!==void 0?t.horizontalScrollbarSize:10,horizontalSliderSize:t.horizontalSliderSize!==void 0?t.horizontalSliderSize:0,horizontalHasArrows:t.horizontalHasArrows!==void 0&&t.horizontalHasArrows,vertical:t.vertical!==void 0?t.vertical:1,verticalScrollbarSize:t.verticalScrollbarSize!==void 0?t.verticalScrollbarSize:10,verticalHasArrows:t.verticalHasArrows!==void 0&&t.verticalHasArrows,verticalSliderSize:t.verticalSliderSize!==void 0?t.verticalSliderSize:0,scrollByPage:t.scrollByPage!==void 0&&t.scrollByPage};return i.horizontalSliderSize=t.horizontalSliderSize!==void 0?t.horizontalSliderSize:i.horizontalScrollbarSize,i.verticalSliderSize=t.verticalSliderSize!==void 0?t.verticalSliderSize:i.verticalScrollbarSize,bt&&(i.className+=" mac"),i}(i),this._scrollable=e,this._register(this._scrollable.onScroll((t=>{this._onWillScroll.fire(t),this._onDidScroll(t),this._onScroll.fire(t)})));const s={onMouseWheel:t=>this._onMouseWheel(t),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new Gk(this._scrollable,this._options,s)),this._horizontalScrollbar=this._register(new qk(this._scrollable,this._options,s)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(t),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=Sl(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=Sl(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=Sl(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,(t=>this._onMouseOver(t))),this.onmouseleave(this._listenOnDomNode,(t=>this._onMouseLeave(t))),this._hideTimeout=this._register(new yo),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=qi(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(t){this._verticalScrollbar.delegatePointerDown(t)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(t){this._scrollable.setScrollDimensions(t,!1)}updateClassName(t){this._options.className=t,bt&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(t){t.handleMouseWheel!==void 0&&(this._options.handleMouseWheel=t.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),t.mouseWheelScrollSensitivity!==void 0&&(this._options.mouseWheelScrollSensitivity=t.mouseWheelScrollSensitivity),t.fastScrollSensitivity!==void 0&&(this._options.fastScrollSensitivity=t.fastScrollSensitivity),t.scrollPredominantAxis!==void 0&&(this._options.scrollPredominantAxis=t.scrollPredominantAxis),t.horizontal!==void 0&&(this._options.horizontal=t.horizontal),t.vertical!==void 0&&(this._options.vertical=t.vertical),t.horizontalScrollbarSize!==void 0&&(this._options.horizontalScrollbarSize=t.horizontalScrollbarSize),t.verticalScrollbarSize!==void 0&&(this._options.verticalScrollbarSize=t.verticalScrollbarSize),t.scrollByPage!==void 0&&(this._options.scrollByPage=t.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}delegateScrollFromMouseWheelEvent(t){this._onMouseWheel(new co(t))}_setListeningToMouseWheel(t){if(this._mouseWheelToDispose.length>0!==t&&(this._mouseWheelToDispose=qi(this._mouseWheelToDispose),t)){const t=t=>{this._onMouseWheel(new co(t))};this._mouseWheelToDispose.push(sc(this._listenOnDomNode,qc.MOUSE_WHEEL,t,{passive:!1}))}}_onMouseWheel(t){var i;if(!((i=t.browserEvent)===null||i===void 0)&&i.defaultPrevented)return;const e=iC.INSTANCE;e.acceptStandardWheelEvent(t);let s=!1;if(t.deltaY||t.deltaX){let i=t.deltaY*this._options.mouseWheelScrollSensitivity,n=t.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&n+i===0?n=i=0:Math.abs(i)>=Math.abs(n)?n=0:i=0),this._options.flipAxes&&([i,n]=[n,i]);const r=!bt&&t.browserEvent&&t.browserEvent.shiftKey;!this._options.scrollYToX&&!r||n||(n=i,i=0),t.browserEvent&&t.browserEvent.altKey&&(n*=this._options.fastScrollSensitivity,i*=this._options.fastScrollSensitivity);const o=this._scrollable.getFutureScrollPosition();let h={};if(i){const t=50*i,e=o.scrollTop-(t<0?Math.floor(t):Math.ceil(t));this._verticalScrollbar.writeScrollPosition(h,e)}if(n){const t=50*n,i=o.scrollLeft-(t<0?Math.floor(t):Math.ceil(t));this._horizontalScrollbar.writeScrollPosition(h,i)}h=this._scrollable.validateScrollPosition(h),(o.scrollLeft!==h.scrollLeft||o.scrollTop!==h.scrollTop)&&(this._options.mouseWheelSmoothScroll&&e.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(h):this._scrollable.setScrollPositionNow(h),s=!0)}let n=s;!n&&this._options.alwaysConsumeMouseWheel&&(n=!0),!n&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(n=!0),n&&(t.preventDefault(),t.stopPropagation())}_onDidScroll(t){this._shouldRender=this._horizontalScrollbar.onDidScroll(t)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(t)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){const t=this._scrollable.getCurrentScrollPosition(),i=t.scrollTop>0,e=t.scrollLeft>0,s=e?" left":"",n=i?" top":"",r=e||i?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${s}`),this._topShadowDomNode.setClassName(`shadow${n}`),this._topLeftShadowDomNode.setClassName(`shadow${r}${n}${s}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(t){this._mouseIsOver=!1,this._hide()}_onMouseOver(t){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){this._mouseIsOver||this._isDragging||(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){this._mouseIsOver||this._isDragging||this._hideTimeout.cancelAndSet((()=>this._hide()),500)}}class sC extends eC{constructor(t,i){(i=i||{}).mouseWheelSmoothScroll=!1;const e=new Jk({forceIntegerValues:!0,smoothScrollDuration:0,scheduleAtNextAnimationFrame:i=>ac(Uh(t),i)});super(t,i,e),this._register(e)}setScrollPosition(t){this._scrollable.setScrollPositionNow(t)}}class nC extends eC{constructor(t,i,e){super(t,i,e)}setScrollPosition(t){t.reuseAnimation?this._scrollable.setScrollPositionSmooth(t,t.reuseAnimation):this._scrollable.setScrollPositionNow(t)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}}class rC extends eC{constructor(t,i){(i=i||{}).mouseWheelSmoothScroll=!1;const e=new Jk({forceIntegerValues:!1,smoothScrollDuration:0,scheduleAtNextAnimationFrame:i=>ac(Uh(t),i)});super(t,i,e),this._register(e),this._element=t,this._register(this.onScroll((t=>{t.scrollTopChanged&&(this._element.scrollTop=t.scrollTop),t.scrollLeftChanged&&(this._element.scrollLeft=t.scrollLeft)}))),this.scanDomNode()}setScrollPosition(t){this._scrollable.setScrollPositionNow(t)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}}class oC extends Qy{constructor(t,i,e){super(),this._mouseLeaveMonitor=null,this._context=t,this.viewController=i,this.viewHelper=e,this.mouseTargetFactory=new _k(this._context,e),this._mouseDownOperation=this._register(new hC(this._context,this.viewController,this.viewHelper,this.mouseTargetFactory,((t,i)=>this._createMouseTarget(t,i)),(t=>this._getMouseColumn(t)))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(145).height;const s=new Uy(this.viewHelper.viewDomNode);this._register(s.onContextMenu(this.viewHelper.viewDomNode,(t=>this._onContextMenu(t,!0)))),this._register(s.onMouseMove(this.viewHelper.viewDomNode,(t=>{this._onMouseMove(t),this._mouseLeaveMonitor||(this._mouseLeaveMonitor=sc(this.viewHelper.viewDomNode.ownerDocument,"mousemove",(t=>{this.viewHelper.viewDomNode.contains(t.target)||this._onMouseLeave(new zy(t,!1,this.viewHelper.viewDomNode))})))}))),this._register(s.onMouseUp(this.viewHelper.viewDomNode,(t=>this._onMouseUp(t)))),this._register(s.onMouseLeave(this.viewHelper.viewDomNode,(t=>this._onMouseLeave(t))));let n=0;this._register(s.onPointerDown(this.viewHelper.viewDomNode,((t,i)=>{n=i}))),this._register(sc(this.viewHelper.viewDomNode,qc.POINTER_UP,(t=>{this._mouseDownOperation.onPointerUp()}))),this._register(s.onMouseDown(this.viewHelper.viewDomNode,(t=>this._onMouseDown(t,n)))),this._setupMouseWheelZoomListener(),this._context.addEventHandler(this)}_setupMouseWheelZoomListener(){const t=iC.INSTANCE;let i=0,e=Al.getZoomLevel(),s=!1,n=0;function r(t){return bt?(t.metaKey||t.ctrlKey)&&!t.shiftKey&&!t.altKey:t.ctrlKey&&!t.metaKey&&!t.shiftKey&&!t.altKey}this._register(sc(this.viewHelper.viewDomNode,qc.MOUSE_WHEEL,(o=>{if(this.viewController.emitMouseWheel(o),!this._context.configuration.options.get(76))return;const h=new co(o);if(t.acceptStandardWheelEvent(h),t.isPhysicalMouseWheel()){if(r(o)){const t=Al.getZoomLevel(),i=h.deltaY>0?1:-1;Al.setZoomLevel(t+i),h.preventDefault(),h.stopPropagation()}}else Date.now()-i>50&&(e=Al.getZoomLevel(),s=r(o),n=0),i=Date.now(),n+=h.deltaY,s&&(Al.setZoomLevel(e+n/5),h.preventDefault(),h.stopPropagation())}),{capture:!0,passive:!1}))}dispose(){this._context.removeEventHandler(this),this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),super.dispose()}onConfigurationChanged(t){if(t.hasChanged(145)){const t=this._context.configuration.options.get(145).height;this._height!==t&&(this._height=t,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(t){return this._mouseDownOperation.onCursorStateChanged(t),!1}onFocusChanged(t){return!1}getTargetAtClientPoint(t,i){const e=new $y(t,i).toPageCoordinates(Uh(this.viewHelper.viewDomNode)),s=Hy(this.viewHelper.viewDomNode);if(e.y<s.y||e.y>s.y+s.height||e.x<s.x||e.x>s.x+s.width)return null;const n=Vy(this.viewHelper.viewDomNode,s,e);return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),s,e,n,null)}_createMouseTarget(t,i){let e=t.target;if(!this.viewHelper.viewDomNode.contains(e)){const i=Mc(this.viewHelper.viewDomNode);i&&(e=i.elementsFromPoint(t.posx,t.posy).find((t=>this.viewHelper.viewDomNode.contains(t))))}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),t.editorPos,t.pos,t.relativePos,i?e:null)}_getMouseColumn(t){return this.mouseTargetFactory.getMouseColumn(t.relativePos)}_onContextMenu(t,i){this.viewController.emitContextMenu({event:t,target:this._createMouseTarget(t,i)})}_onMouseMove(t){this.mouseTargetFactory.mouseTargetIsWidget(t)||t.preventDefault(),!this._mouseDownOperation.isActive()&&(t.timestamp<this.lastMouseLeaveTime||this.viewController.emitMouseMove({event:t,target:this._createMouseTarget(t,!0)}))}_onMouseLeave(t){this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),this.lastMouseLeaveTime=(new Date).getTime(),this.viewController.emitMouseLeave({event:t,target:null})}_onMouseUp(t){this.viewController.emitMouseUp({event:t,target:this._createMouseTarget(t,!0)})}_onMouseDown(t,i){const e=this._createMouseTarget(t,!0),s=e.type===6||e.type===7,n=e.type===2||e.type===3||e.type===4,r=e.type===3,o=this._context.configuration.options.get(109),h=e.type===8||e.type===5,c=e.type===9;let l=t.leftButton||t.middleButton;bt&&t.leftButton&&t.ctrlKey&&(l=!1);const a=()=>{t.preventDefault(),this.viewHelper.focusTextArea()};if(l&&(s||r&&o))a(),this._mouseDownOperation.start(e.type,t,i);else if(n)t.preventDefault();else if(h){const s=e.detail;l&&this.viewHelper.shouldSuppressMouseDownOnViewZone(s.viewZoneId)&&(a(),this._mouseDownOperation.start(e.type,t,i),t.preventDefault())}else c&&this.viewHelper.shouldSuppressMouseDownOnWidget(e.detail)&&(a(),t.preventDefault());this.viewController.emitMouseDown({event:t,target:e})}}class hC extends Qi{constructor(t,i,e,s,n,r){super(),this._context=t,this._viewController=i,this._viewHelper=e,this._mouseTargetFactory=s,this._createMouseTarget=n,this._getMouseColumn=r,this._mouseMoveMonitor=this._register(new qy(this._viewHelper.viewDomNode)),this._topBottomDragScrolling=this._register(new cC(this._context,this._viewHelper,this._mouseTargetFactory,((t,i,e)=>this._dispatchMouse(t,i,e)))),this._mouseState=new aC,this._currentSelection=new Ss(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(t){this._lastMouseEvent=t,this._mouseState.setModifiers(t);const i=this._findMousePosition(t,!1);i&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:t,target:i}):i.type!==13||i.outsidePosition!=="above"&&i.outsidePosition!=="below"?(this._topBottomDragScrolling.stop(),this._dispatchMouse(i,!0,1)):this._topBottomDragScrolling.start(i,t))}start(t,i,e){this._lastMouseEvent=i,this._mouseState.setStartedOnLineNumbers(t===3),this._mouseState.setStartButtons(i),this._mouseState.setModifiers(i);const s=this._findMousePosition(i,!0);if(!s||!s.position)return;this._mouseState.trySetCount(i.detail,s.position),i.detail=this._mouseState.count;const n=this._context.configuration.options;if(!n.get(91)&&n.get(35)&&!n.get(22)&&!this._mouseState.altKey&&i.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&s.type===6&&s.position&&this._currentSelection.containsPosition(s.position))return this._mouseState.isDragAndDrop=!0,this._isActive=!0,void this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,e,i.buttons,(t=>this._onMouseDownThenMove(t)),(t=>{const i=this._findMousePosition(this._lastMouseEvent,!1);Kc(t)?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:i?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()}));this._mouseState.isDragAndDrop=!1,this._dispatchMouse(s,i.shiftKey,1),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,e,i.buttons,(t=>this._onMouseDownThenMove(t)),(()=>this._stop())))}_stop(){this._isActive=!1,this._topBottomDragScrolling.stop()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onPointerUp(){this._mouseMoveMonitor.stopMonitoring()}onCursorStateChanged(t){this._currentSelection=t.selections[0]}_getPositionOutsideEditor(t){const i=t.editorPos,e=this._context.viewModel,s=this._context.viewLayout,n=this._getMouseColumn(t);if(t.posy<i.y){const e=i.y-t.posy,r=Math.max(s.getCurrentScrollTop()-e,0),o=Fk.getZoneAtCoord(this._context,r);if(o){const t=this._helpPositionJumpOverViewZone(o);if(t)return Mk.createOutsideEditor(n,t,"above",e)}const h=s.getLineNumberAtVerticalOffset(r);return Mk.createOutsideEditor(n,new ks(h,1),"above",e)}if(t.posy>i.y+i.height){const r=t.posy-i.y-i.height,o=s.getCurrentScrollTop()+t.relativePos.y,h=Fk.getZoneAtCoord(this._context,o);if(h){const t=this._helpPositionJumpOverViewZone(h);if(t)return Mk.createOutsideEditor(n,t,"below",r)}const c=s.getLineNumberAtVerticalOffset(o);return Mk.createOutsideEditor(n,new ks(c,e.getLineMaxColumn(c)),"below",r)}const r=s.getLineNumberAtVerticalOffset(s.getCurrentScrollTop()+t.relativePos.y);if(t.posx<i.x){const e=i.x-t.posx;return Mk.createOutsideEditor(n,new ks(r,1),"left",e)}if(t.posx>i.x+i.width){const s=t.posx-i.x-i.width;return Mk.createOutsideEditor(n,new ks(r,e.getLineMaxColumn(r)),"right",s)}return null}_findMousePosition(t,i){const e=this._getPositionOutsideEditor(t);if(e)return e;const s=this._createMouseTarget(t,i);if(!s.position)return null;if(s.type===8||s.type===5){const t=this._helpPositionJumpOverViewZone(s.detail);if(t)return Mk.createViewZone(s.type,s.element,s.mouseColumn,t,s.detail)}return s}_helpPositionJumpOverViewZone(t){const i=new ks(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),e=t.positionBefore,s=t.positionAfter;return e&&s?e.isBefore(i)?e:s:null}_dispatchMouse(t,i,e){t.position&&this._viewController.dispatchMouse({position:t.position,mouseColumn:t.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,revealType:e,inSelectionMode:i,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton,onInjectedText:t.type===6&&t.detail.injectedText!==null})}}class cC extends Qi{constructor(t,i,e,s){super(),this._context=t,this._viewHelper=i,this._mouseTargetFactory=e,this._dispatchMouse=s,this._operation=null}dispose(){super.dispose(),this.stop()}start(t,i){this._operation?this._operation.setPosition(t,i):this._operation=new lC(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,t,i)}stop(){this._operation&&(this._operation.dispose(),this._operation=null)}}class lC extends Qi{constructor(t,i,e,s,n,r){super(),this._context=t,this._viewHelper=i,this._mouseTargetFactory=e,this._dispatchMouse=s,this._position=n,this._mouseEvent=r,this._lastTime=Date.now(),this._animationFrameDisposable=ac(Uh(r.browserEvent),(()=>this._execute()))}dispose(){this._animationFrameDisposable.dispose(),super.dispose()}setPosition(t,i){this._position=t,this._mouseEvent=i}_tick(){const t=Date.now(),i=t-this._lastTime;return this._lastTime=t,i}_getScrollSpeed(){const t=this._context.configuration.options.get(67),i=this._context.configuration.options.get(145).height/t,e=this._position.outsideDistance/t;return e<=1.5?Math.max(30,i*(1+e)):e<=3?Math.max(60,i*(2+e)):Math.max(200,i*(7+e))}_execute(){const t=this._context.configuration.options.get(67),i=this._getScrollSpeed()*(this._tick()/1e3)*t,e=this._position.outsidePosition==="above"?-i:i;this._context.viewModel.viewLayout.deltaScrollNow(0,e),this._viewHelper.renderNow();const s=this._context.viewLayout.getLinesViewportData(),n=this._position.outsidePosition==="above"?s.startLineNumber:s.endLineNumber;let r;{const t=Hy(this._viewHelper.viewDomNode),i=this._context.configuration.options.get(145).horizontalScrollbarHeight,e=new By(this._mouseEvent.pos.x,t.y+t.height-i-.1),s=Vy(this._viewHelper.viewDomNode,t,e);r=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),t,e,s,null)}r.position&&r.position.lineNumber===n||(r=this._position.outsidePosition==="above"?Mk.createOutsideEditor(this._position.mouseColumn,new ks(n,1),"above",this._position.outsideDistance):Mk.createOutsideEditor(this._position.mouseColumn,new ks(n,this._context.viewModel.getLineMaxColumn(n)),"below",this._position.outsideDistance)),this._dispatchMouse(r,!0,2),this._animationFrameDisposable=ac(Uh(r.element),(()=>this._execute()))}}class aC{get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get metaKey(){return this._metaKey}get shiftKey(){return this._shiftKey}get leftButton(){return this._leftButton}get middleButton(){return this._middleButton}get startedOnLineNumbers(){return this._startedOnLineNumbers}constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get count(){return this._lastMouseDownCount}setModifiers(t){this._altKey=t.altKey,this._ctrlKey=t.ctrlKey,this._metaKey=t.metaKey,this._shiftKey=t.shiftKey}setStartButtons(t){this._leftButton=t.leftButton,this._middleButton=t.middleButton}setStartedOnLineNumbers(t){this._startedOnLineNumbers=t}trySetCount(t,i){const e=(new Date).getTime();e-this._lastSetMouseDownCountTime>aC.CLEAR_MOUSE_DOWN_COUNT_TIME&&(t=1),this._lastSetMouseDownCountTime=e,t>this._lastMouseDownCount+1&&(t=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(i)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=i,this._lastMouseDownCount=Math.min(t,this._lastMouseDownPositionEqualCount)}}aC.CLEAR_MOUSE_DOWN_COUNT_TIME=400;class uC{get event(){return this.emitter.event}constructor(t,i,e){const s=t=>this.emitter.fire(t);this.emitter=new le({onWillAddFirstListener:()=>t.addEventListener(i,s,e),onDidRemoveLastListener:()=>t.removeEventListener(i,s,e)})}dispose(){this.emitter.dispose()}}class dC{constructor(t,i,e,s,n){this.value=t,this.selectionStart=i,this.selectionEnd=e,this.selection=s,this.newlineCountBeforeSelection=n}toString(){return`[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`}static readFromTextArea(t,i){const e=t.getValue(),s=t.getSelectionStart(),n=t.getSelectionEnd();let r;return i&&e.substring(0,s)===i.value.substring(0,i.selectionStart)&&(r=i.newlineCountBeforeSelection),new dC(e,s,n,null,r)}collapseSelection(){return this.selectionStart===this.value.length?this:new dC(this.value,this.value.length,this.value.length,null,void 0)}writeToTextArea(t,i,e){i.setValue(t,this.value),e&&i.setSelectionRange(t,this.selectionStart,this.selectionEnd)}deduceEditorPosition(t){var i,e,s,n,r,o,h,c;if(t<=this.selectionStart){const s=this.value.substring(t,this.selectionStart);return this._finishDeduceEditorPosition((e=(i=this.selection)===null||i===void 0?void 0:i.getStartPosition())!==null&&e!==void 0?e:null,s,-1)}if(t>=this.selectionEnd){const i=this.value.substring(this.selectionEnd,t);return this._finishDeduceEditorPosition((n=(s=this.selection)===null||s===void 0?void 0:s.getEndPosition())!==null&&n!==void 0?n:null,i,1)}const l=this.value.substring(this.selectionStart,t);if(l.indexOf("…")===-1)return this._finishDeduceEditorPosition((o=(r=this.selection)===null||r===void 0?void 0:r.getStartPosition())!==null&&o!==void 0?o:null,l,1);const a=this.value.substring(t,this.selectionEnd);return this._finishDeduceEditorPosition((c=(h=this.selection)===null||h===void 0?void 0:h.getEndPosition())!==null&&c!==void 0?c:null,a,-1)}_finishDeduceEditorPosition(t,i,e){let s=0,n=-1;for(;(n=i.indexOf(`\n`,n+1))!==-1;)s++;return[t,e*i.length,s]}static deduceInput(t,i,e){if(!t)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};const s=Math.min(dr(t.value,i.value),t.selectionStart,i.selectionStart),n=Math.min(fr(t.value,i.value),t.value.length-t.selectionEnd,i.value.length-i.selectionEnd);t.value.substring(s,t.value.length-n);const r=i.value.substring(s,i.value.length-n),o=t.selectionStart-s,h=t.selectionEnd-s;return i.selectionStart-s===i.selectionEnd-s?{text:r,replacePrevCharCnt:t.selectionStart-s,replaceNextCharCnt:0,positionDelta:0}:{text:r,replacePrevCharCnt:h-o,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(t,i){if(!t)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(t.value===i.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:i.selectionEnd-t.selectionEnd};const e=Math.min(dr(t.value,i.value),t.selectionEnd),s=Math.min(fr(t.value,i.value),t.value.length-t.selectionEnd),n=t.value.substring(e,t.value.length-s),r=i.value.substring(e,i.value.length-s);const o=t.selectionEnd-e;const h=i.selectionEnd-e;return{text:r,replacePrevCharCnt:o,replaceNextCharCnt:n.length-o,positionDelta:h-r.length}}}dC.EMPTY=new dC("",0,0,null,void 0);class fC{static _getPageOfLine(t,i){return Math.floor((t-1)/i)}static _getRangeForPage(t,i){const e=t*i;return new Cs(e+1,1,e+i+1,1)}static fromEditorSelection(t,i,e,s){const n=fC._getPageOfLine(i.startLineNumber,e),r=fC._getRangeForPage(n,e),o=fC._getPageOfLine(i.endLineNumber,e),h=fC._getRangeForPage(o,e);let c=r.intersectRanges(new Cs(1,1,i.startLineNumber,i.startColumn));if(s&&t.getValueLengthInRange(c,1)>500){const i=t.modifyPosition(c.getEndPosition(),-500);c=Cs.fromPositions(i,c.getEndPosition())}const l=t.getValueInRange(c,1),a=t.getLineCount(),u=t.getLineMaxColumn(a);let d=h.intersectRanges(new Cs(i.endLineNumber,i.endColumn,a,u));if(s&&t.getValueLengthInRange(d,1)>500){const i=t.modifyPosition(d.getStartPosition(),500);d=Cs.fromPositions(d.getStartPosition(),i)}const f=t.getValueInRange(d,1);let g;if(n===o||n+1===o)g=t.getValueInRange(i,1);else{const e=r.intersectRanges(i),s=h.intersectRanges(i);g=t.getValueInRange(e,1)+"…"+t.getValueInRange(s,1)}return s&&g.length>1e3&&(g=g.substring(0,500)+"…"+g.substring(g.length-500,g.length)),new dC(l+g+f,l.length,l.length+g.length,i,c.endLineNumber-c.startLineNumber)}}var gC,pC=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},mC=function(t,i){return function(e,s){i(e,s,t)}};(function(t){t.Tap="-monaco-textarea-synthetic-tap"})(gC||(gC={}));const wC={forceCopyWithSyntaxHighlighting:!1};class vC{constructor(){this._lastState=null}set(t,i){this._lastState={lastCopiedValue:t,data:i}}get(t){return this._lastState&&this._lastState.lastCopiedValue===t?this._lastState.data:(this._lastState=null,null)}}vC.INSTANCE=new vC;class bC{constructor(){this._lastTypeTextLength=0}handleCompositionUpdate(t){const i={text:t=t||"",replacePrevCharCnt:this._lastTypeTextLength,replaceNextCharCnt:0,positionDelta:0};return this._lastTypeTextLength=t.length,i}}let yC=class extends Qi{get textAreaState(){return this._textAreaState}constructor(t,i,e,s,n,r){super(),this._host=t,this._textArea=i,this._OS=e,this._browser=s,this._accessibilityService=n,this._logService=r,this._onFocus=this._register(new le),this.onFocus=this._onFocus.event,this._onBlur=this._register(new le),this.onBlur=this._onBlur.event,this._onKeyDown=this._register(new le),this.onKeyDown=this._onKeyDown.event,this._onKeyUp=this._register(new le),this.onKeyUp=this._onKeyUp.event,this._onCut=this._register(new le),this.onCut=this._onCut.event,this._onPaste=this._register(new le),this.onPaste=this._onPaste.event,this._onType=this._register(new le),this.onType=this._onType.event,this._onCompositionStart=this._register(new le),this.onCompositionStart=this._onCompositionStart.event,this._onCompositionUpdate=this._register(new le),this.onCompositionUpdate=this._onCompositionUpdate.event,this._onCompositionEnd=this._register(new le),this.onCompositionEnd=this._onCompositionEnd.event,this._onSelectionChangeRequest=this._register(new le),this.onSelectionChangeRequest=this._onSelectionChangeRequest.event,this._asyncFocusGainWriteScreenReaderContent=this._register(new Yi),this._asyncTriggerCut=this._register(new Co((()=>this._onCut.fire()),0)),this._textAreaState=dC.EMPTY,this._selectionChangeListener=null,this._accessibilityService.isScreenReaderOptimized()&&this.writeNativeTextAreaContent("ctor"),this._register(ne.runAndSubscribe(this._accessibilityService.onDidChangeScreenReaderOptimized,(()=>{this._accessibilityService.isScreenReaderOptimized()&&!this._asyncFocusGainWriteScreenReaderContent.value?this._asyncFocusGainWriteScreenReaderContent.value=this._register(new Co((()=>this.writeNativeTextAreaContent("asyncFocusGain")),0)):this._asyncFocusGainWriteScreenReaderContent.clear()}))),this._hasFocus=!1,this._currentComposition=null;let o=null;this._register(this._textArea.onKeyDown((t=>{const i=new so(t);(i.keyCode===114||this._currentComposition&&i.keyCode===1)&&i.stopPropagation(),i.equals(9)&&i.preventDefault(),o=i,this._onKeyDown.fire(i)}))),this._register(this._textArea.onKeyUp((t=>{const i=new so(t);this._onKeyUp.fire(i)}))),this._register(this._textArea.onCompositionStart((t=>{const i=new bC;if(this._currentComposition)this._currentComposition=i;else{if(this._currentComposition=i,this._OS===2&&o&&o.equals(114)&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===t.data&&(o.code==="ArrowRight"||o.code==="ArrowLeft"))return i.handleCompositionUpdate("x"),void this._onCompositionStart.fire({data:t.data});this._onCompositionStart.fire({data:t.data})}}))),this._register(this._textArea.onCompositionUpdate((t=>{const i=this._currentComposition;if(!i)return;if(this._browser.isAndroid){const i=dC.readFromTextArea(this._textArea,this._textAreaState),e=dC.deduceAndroidCompositionInput(this._textAreaState,i);return this._textAreaState=i,this._onType.fire(e),void this._onCompositionUpdate.fire(t)}const e=i.handleCompositionUpdate(t.data);this._textAreaState=dC.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(e),this._onCompositionUpdate.fire(t)}))),this._register(this._textArea.onCompositionEnd((t=>{const i=this._currentComposition;if(!i)return;if(this._currentComposition=null,this._browser.isAndroid){const t=dC.readFromTextArea(this._textArea,this._textAreaState),i=dC.deduceAndroidCompositionInput(this._textAreaState,t);return this._textAreaState=t,this._onType.fire(i),void this._onCompositionEnd.fire()}const e=i.handleCompositionUpdate(t.data);this._textAreaState=dC.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(e),this._onCompositionEnd.fire()}))),this._register(this._textArea.onInput((t=>{if(this._textArea.setIgnoreSelectionChangeTime("received input event"),this._currentComposition)return;const i=dC.readFromTextArea(this._textArea,this._textAreaState),e=dC.deduceInput(this._textAreaState,i,this._OS===2);(e.replacePrevCharCnt!==0||e.text.length!==1||!gr(e.text.charCodeAt(0))&&e.text.charCodeAt(0)!==127)&&(this._textAreaState=i,e.text===""&&e.replacePrevCharCnt===0&&e.replaceNextCharCnt===0&&e.positionDelta===0||this._onType.fire(e))}))),this._register(this._textArea.onCut((t=>{this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(t),this._asyncTriggerCut.schedule()}))),this._register(this._textArea.onCopy((t=>{this._ensureClipboardGetsEditorSelection(t)}))),this._register(this._textArea.onPaste((t=>{if(this._textArea.setIgnoreSelectionChangeTime("received paste event"),t.preventDefault(),!t.clipboardData)return;let[i,e]=kC.getTextData(t.clipboardData);i&&(e=e||vC.INSTANCE.get(i),this._onPaste.fire({text:i,metadata:e}))}))),this._register(this._textArea.onFocus((()=>{const t=this._hasFocus;this._setHasFocus(!0),this._accessibilityService.isScreenReaderOptimized()&&this._browser.isSafari&&!t&&this._hasFocus&&(this._asyncFocusGainWriteScreenReaderContent.value||(this._asyncFocusGainWriteScreenReaderContent.value=new Co((()=>this.writeNativeTextAreaContent("asyncFocusGain")),0)),this._asyncFocusGainWriteScreenReaderContent.value.schedule())}))),this._register(this._textArea.onBlur((()=>{this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)}))),this._register(this._textArea.onSyntheticTap((()=>{this._browser.isAndroid&&this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())})))}_installSelectionChangeListener(){let t=0;return sc(this._textArea.ownerDocument,"selectionchange",(i=>{if(Mw.onSelectionChange(),!this._hasFocus||this._currentComposition||!this._browser.isChrome)return;const e=Date.now(),s=e-t;if(t=e,s<5)return;const n=e-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),n<100||!this._textAreaState.selection)return;const r=this._textArea.getValue();if(this._textAreaState.value!==r)return;const o=this._textArea.getSelectionStart(),h=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===o&&this._textAreaState.selectionEnd===h)return;const c=this._textAreaState.deduceEditorPosition(o),l=this._host.deduceModelPosition(c[0],c[1],c[2]),a=this._textAreaState.deduceEditorPosition(h),u=this._host.deduceModelPosition(a[0],a[1],a[2]),d=new Ss(l.lineNumber,l.column,u.lineNumber,u.column);this._onSelectionChangeRequest.fire(d)}))}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){this._setHasFocus(this._textArea.hasFocus())}_setHasFocus(t){this._hasFocus!==t&&(this._hasFocus=t,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeNativeTextAreaContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(t,i){this._hasFocus||(i=i.collapseSelection()),i.writeToTextArea(t,this._textArea,this._hasFocus),this._textAreaState=i}writeNativeTextAreaContent(t){!this._accessibilityService.isScreenReaderOptimized()&&t==="render"||this._currentComposition||(this._logService.trace(`writeTextAreaState(reason: ${t})`),this._setAndWriteTextAreaState(t,this._host.getScreenReaderContent()))}_ensureClipboardGetsEditorSelection(t){const i=this._host.getDataToCopy(),e={version:1,isFromEmptySelection:i.isFromEmptySelection,multicursorText:i.multicursorText,mode:i.mode};vC.INSTANCE.set(this._browser.isFirefox?i.text.replace(/\r\n/g,`\n`):i.text,e),t.preventDefault(),t.clipboardData&&kC.setTextData(t.clipboardData,i.text,i.html,e)}};yC=pC([mC(4,vw),mC(5,ou)],yC);const kC={getTextData(t){const i=t.getData($d.text);let e=null;const s=t.getData("vscode-editor-data");if(typeof s=="string")try{e=JSON.parse(s),e.version!==1&&(e=null)}catch{}return i.length===0&&e===null&&t.files.length>0?[Array.prototype.slice.call(t.files,0).map((t=>t.name)).join(`\n`),null]:[i,e]},setTextData(t,i,e,s){t.setData($d.text,i),typeof e=="string"&&t.setData("text/html",e),t.setData("vscode-editor-data",JSON.stringify(s))}};class CC extends Qi{get ownerDocument(){return this._actual.ownerDocument}constructor(t){super(),this._actual=t,this.onKeyDown=this._register(new uC(this._actual,"keydown")).event,this.onKeyUp=this._register(new uC(this._actual,"keyup")).event,this.onCompositionStart=this._register(new uC(this._actual,"compositionstart")).event,this.onCompositionUpdate=this._register(new uC(this._actual,"compositionupdate")).event,this.onCompositionEnd=this._register(new uC(this._actual,"compositionend")).event,this.onBeforeInput=this._register(new uC(this._actual,"beforeinput")).event,this.onInput=this._register(new uC(this._actual,"input")).event,this.onCut=this._register(new uC(this._actual,"cut")).event,this.onCopy=this._register(new uC(this._actual,"copy")).event,this.onPaste=this._register(new uC(this._actual,"paste")).event,this.onFocus=this._register(new uC(this._actual,"focus")).event,this.onBlur=this._register(new uC(this._actual,"blur")).event,this._onSyntheticTap=this._register(new le),this.onSyntheticTap=this._onSyntheticTap.event,this._ignoreSelectionChangeTime=0,this._register(this.onKeyDown((()=>Mw.onKeyDown()))),this._register(this.onBeforeInput((()=>Mw.onBeforeInput()))),this._register(this.onInput((()=>Mw.onInput()))),this._register(this.onKeyUp((()=>Mw.onKeyUp()))),this._register(sc(this._actual,gC.Tap,(()=>this._onSyntheticTap.fire())))}hasFocus(){const t=Mc(this._actual);return t?t.activeElement===this._actual:!!this._actual.isConnected&&Lc()===this._actual}setIgnoreSelectionChangeTime(t){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.value}setValue(t,i){const e=this._actual;e.value!==i&&(this.setIgnoreSelectionChangeTime("setValue"),e.value=i)}getSelectionStart(){return this._actual.selectionDirection==="backward"?this._actual.selectionEnd:this._actual.selectionStart}getSelectionEnd(){return this._actual.selectionDirection==="backward"?this._actual.selectionStart:this._actual.selectionEnd}setSelectionRange(t,i,e){const s=this._actual;let n=null;const r=Mc(s);n=r?r.activeElement:Lc();const o=Uh(n),h=n===s,c=s.selectionStart,l=s.selectionEnd;if(h&&c===i&&l===e)Hr&&o.parent!==o&&s.focus();else{if(h)return this.setIgnoreSelectionChangeTime("setSelectionRange"),s.setSelectionRange(i,e),void(Hr&&o.parent!==o&&s.focus());try{const t=function(t){const i=[];for(let e=0;t&&t.nodeType===t.ELEMENT_NODE;e++)i[e]=t.scrollTop,t=t.parentNode;return i}(s);this.setIgnoreSelectionChangeTime("setSelectionRange"),s.focus(),s.setSelectionRange(i,e),function(t,i){for(let e=0;t&&t.nodeType===t.ELEMENT_NODE;e++)t.scrollTop!==i[e]&&(t.scrollTop=i[e]),t=t.parentNode}(s,t)}catch{}}}}class SC extends oC{constructor(t,i,e){super(t,i,e),this._register(Wk.addTarget(this.viewHelper.linesContentDomNode)),this._register(sc(this.viewHelper.linesContentDomNode,Bk.Tap,(t=>this.onTap(t)))),this._register(sc(this.viewHelper.linesContentDomNode,Bk.Change,(t=>this.onChange(t)))),this._register(sc(this.viewHelper.linesContentDomNode,Bk.Contextmenu,(t=>this._onContextMenu(new zy(t,!1,this.viewHelper.viewDomNode),!1)))),this._lastPointerType="mouse",this._register(sc(this.viewHelper.linesContentDomNode,"pointerdown",(t=>{const i=t.pointerType;this._lastPointerType=i!=="mouse"?i==="touch"?"touch":"pen":"mouse"})));const s=new Ky(this.viewHelper.viewDomNode);this._register(s.onPointerMove(this.viewHelper.viewDomNode,(t=>this._onMouseMove(t)))),this._register(s.onPointerUp(this.viewHelper.viewDomNode,(t=>this._onMouseUp(t)))),this._register(s.onPointerLeave(this.viewHelper.viewDomNode,(t=>this._onMouseLeave(t)))),this._register(s.onPointerDown(this.viewHelper.viewDomNode,((t,i)=>this._onMouseDown(t,i))))}onTap(t){t.initialTarget&&this.viewHelper.linesContentDomNode.contains(t.initialTarget)&&(t.preventDefault(),this.viewHelper.focusTextArea(),this._dispatchGesture(t,!1))}onChange(t){this._lastPointerType==="touch"&&this._context.viewModel.viewLayout.deltaScrollNow(-t.translationX,-t.translationY),this._lastPointerType==="pen"&&this._dispatchGesture(t,!0)}_dispatchGesture(t,i){const e=this._createMouseTarget(new zy(t,!1,this.viewHelper.viewDomNode),!1);e.position&&this.viewController.dispatchMouse({position:e.position,mouseColumn:e.position.column,startedOnLineNumbers:!1,revealType:1,mouseDownCount:t.tapCount,inSelectionMode:i,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1,onInjectedText:e.type===6&&e.detail.injectedText!==null})}_onMouseDown(t,i){t.browserEvent.pointerType!=="touch"&&super._onMouseDown(t,i)}}class xC extends oC{constructor(t,i,e){super(t,i,e),this._register(Wk.addTarget(this.viewHelper.linesContentDomNode)),this._register(sc(this.viewHelper.linesContentDomNode,Bk.Tap,(t=>this.onTap(t)))),this._register(sc(this.viewHelper.linesContentDomNode,Bk.Change,(t=>this.onChange(t)))),this._register(sc(this.viewHelper.linesContentDomNode,Bk.Contextmenu,(t=>this._onContextMenu(new zy(t,!1,this.viewHelper.viewDomNode),!1))))}onTap(t){t.preventDefault(),this.viewHelper.focusTextArea();const i=this._createMouseTarget(new zy(t,!1,this.viewHelper.viewDomNode),!1);if(i.position){const t=document.createEvent("CustomEvent");t.initEvent(gC.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(t),this.viewController.moveTo(i.position,1)}}onChange(t){this._context.viewModel.viewLayout.deltaScrollNow(-t.translationX,-t.translationY)}}class DC extends Qi{constructor(t,i,e){super(),(xt||Bt&&Dt)&&Gr?this.handler=this._register(new SC(t,i,e)):Wn.TouchEvent?this.handler=this._register(new xC(t,i,e)):this.handler=this._register(new oC(t,i,e))}getTargetAtClientPoint(t,i){return this.handler.getTargetAtClientPoint(t,i)}}class EC extends Qy{}const AC=_l("themeService");function MC(t){return{id:t}}function LC(t){switch(t){case ck.DARK:return"vs-dark";case ck.HIGH_CONTRAST_DARK:return"hc-black";case ck.HIGH_CONTRAST_LIGHT:return"hc-light";default:return"vs"}}const FC="base.contributions.theming",TC=new class{constructor(){this.themingParticipants=[],this.themingParticipants=[],this.onThemingParticipantAddedEmitter=new le}onColorThemeChange(t){return this.themingParticipants.push(t),this.onThemingParticipantAddedEmitter.fire(t),Zi((()=>{const i=this.themingParticipants.indexOf(t);this.themingParticipants.splice(i,1)}))}getThemingParticipants(){return this.themingParticipants}};function RC(t){return TC.onColorThemeChange(t)}Va.add(FC,TC);class OC extends Qi{constructor(t){super(),this.themeService=t,this.theme=t.getColorTheme(),this._register(this.themeService.onDidColorThemeChange((t=>this.onThemeChange(t))))}onThemeChange(t){this.theme=t,this.updateStyles()}updateStyles(){}}const IC=Iw("editor.lineHighlightBackground",{dark:null,light:null,hcDark:null,hcLight:null},tt(0,"Background color for the highlight of line at the cursor position.")),_C=Iw("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hcDark:"#f38518",hcLight:qw},tt(0,"Background color for the border around the line at the cursor position."));Iw("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hcDark:null,hcLight:null},tt(0,"Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0),Iw("editor.rangeHighlightBorder",{dark:null,light:null,hcDark:Gw,hcLight:Gw},tt(0,"Background color of the border around highlighted ranges."),!0),Iw("editor.symbolHighlightBackground",{dark:kv,light:kv,hcDark:null,hcLight:null},tt(0,"Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0),Iw("editor.symbolHighlightBorder",{dark:null,light:null,hcDark:Gw,hcLight:Gw},tt(0,"Background color of the border around highlighted symbols."),!0);const PC=Iw("editorCursor.foreground",{dark:"#AEAFAD",light:kp.black,hcDark:kp.white,hcLight:"#0F4A85"},tt(0,"Color of the editor cursor.")),NC=Iw("editorCursor.background",null,tt(0,"The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),BC=Iw("editorMultiCursor.primary.foreground",{dark:PC,light:PC,hcDark:PC,hcLight:PC},tt(0,"Color of the primary editor cursor when multiple cursors are present.")),$C=Iw("editorMultiCursor.primary.background",{dark:NC,light:NC,hcDark:NC,hcLight:NC},tt(0,"The background color of the primary editor cursor when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),WC=Iw("editorMultiCursor.secondary.foreground",{dark:PC,light:PC,hcDark:PC,hcLight:PC},tt(0,"Color of secondary editor cursors when multiple cursors are present.")),jC=Iw("editorMultiCursor.secondary.background",{dark:NC,light:NC,hcDark:NC,hcLight:NC},tt(0,"The background color of secondary editor cursors when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),HC=Iw("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hcDark:"#e3e4e229",hcLight:"#CCCCCC"},tt(0,"Color of whitespace characters in the editor.")),VC=Iw("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hcDark:kp.white,hcLight:"#292929"},tt(0,"Color of editor line numbers.")),zC=Iw("editorIndentGuide.background",{dark:HC,light:HC,hcDark:HC,hcLight:HC},tt(0,"Color of the editor indentation guides."),!1,tt(0,"'editorIndentGuide.background' is deprecated. Use 'editorIndentGuide.background1' instead.")),UC=Iw("editorIndentGuide.activeBackground",{dark:HC,light:HC,hcDark:HC,hcLight:HC},tt(0,"Color of the active editor indentation guides."),!1,tt(0,"'editorIndentGuide.activeBackground' is deprecated. Use 'editorIndentGuide.activeBackground1' instead.")),KC=Iw("editorIndentGuide.background1",{dark:zC,light:zC,hcDark:zC,hcLight:zC},tt(0,"Color of the editor indentation guides (1).")),qC=Iw("editorIndentGuide.background2",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Color of the editor indentation guides (2).")),GC=Iw("editorIndentGuide.background3",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Color of the editor indentation guides (3).")),ZC=Iw("editorIndentGuide.background4",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Color of the editor indentation guides (4).")),JC=Iw("editorIndentGuide.background5",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Color of the editor indentation guides (5).")),QC=Iw("editorIndentGuide.background6",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Color of the editor indentation guides (6).")),YC=Iw("editorIndentGuide.activeBackground1",{dark:UC,light:UC,hcDark:UC,hcLight:UC},tt(0,"Color of the active editor indentation guides (1).")),XC=Iw("editorIndentGuide.activeBackground2",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Color of the active editor indentation guides (2).")),tS=Iw("editorIndentGuide.activeBackground3",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Color of the active editor indentation guides (3).")),iS=Iw("editorIndentGuide.activeBackground4",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Color of the active editor indentation guides (4).")),eS=Iw("editorIndentGuide.activeBackground5",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Color of the active editor indentation guides (5).")),sS=Iw("editorIndentGuide.activeBackground6",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Color of the active editor indentation guides (6).")),nS=Iw("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hcDark:Gw,hcLight:Gw},tt(0,"Color of editor active line number"),!1,tt(0,"Id is deprecated. Use 'editorLineNumber.activeForeground' instead."));Iw("editorLineNumber.activeForeground",{dark:nS,light:nS,hcDark:nS,hcLight:nS},tt(0,"Color of editor active line number"));const rS=Iw("editorLineNumber.dimmedForeground",{dark:null,light:null,hcDark:null,hcLight:null},tt(0,"Color of the final editor line when editor.renderFinalNewline is set to dimmed."));Iw("editorRuler.foreground",{dark:"#5A5A5A",light:kp.lightgrey,hcDark:kp.white,hcLight:"#292929"},tt(0,"Color of the editor rulers.")),Iw("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hcDark:"#999999",hcLight:"#292929"},tt(0,"Foreground color of editor CodeLens")),Iw("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hcDark:"#0064001a",hcLight:"#0000"},tt(0,"Background color behind matching brackets")),Iw("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hcDark:qw,hcLight:qw},tt(0,"Color for matching brackets boxes"));const oS=Iw("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hcDark:"#7f7f7f4d",hcLight:"#666666"},tt(0,"Color of the overview ruler border.")),hS=Iw("editorOverviewRuler.background",null,tt(0,"Background color of the editor overview ruler."));Iw("editorGutter.background",{dark:sv,light:sv,hcDark:sv,hcLight:sv},tt(0,"Background color of the editor gutter. The gutter contains the glyph margins and the line numbers.")),Iw("editorUnnecessaryCode.border",{dark:null,light:null,hcDark:kp.fromHex("#fff").transparent(.8),hcLight:qw},tt(0,"Border color of unnecessary (unused) source code in the editor."));const cS=Iw("editorUnnecessaryCode.opacity",{dark:kp.fromHex("#000a"),light:kp.fromHex("#0007"),hcDark:null,hcLight:null},tt(0,`Opacity of unnecessary (unused) source code in the editor. For example, "#000000c0" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.`));Iw("editorGhostText.border",{dark:null,light:null,hcDark:kp.fromHex("#fff").transparent(.8),hcLight:kp.fromHex("#292929").transparent(.8)},tt(0,"Border color of ghost text in the editor.")),Iw("editorGhostText.foreground",{dark:kp.fromHex("#ffffff56"),light:kp.fromHex("#0007"),hcDark:null,hcLight:null},tt(0,"Foreground color of the ghost text in the editor.")),Iw("editorGhostText.background",{dark:null,light:null,hcDark:null,hcLight:null},tt(0,"Background color of the ghost text in the editor."));const lS=new kp(new vp(0,122,204,.6)),aS=Iw("editorOverviewRuler.rangeHighlightForeground",{dark:lS,light:lS,hcDark:lS,hcLight:lS},tt(0,"Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0),uS=Iw("editorOverviewRuler.errorForeground",{dark:new kp(new vp(255,18,18,.7)),light:new kp(new vp(255,18,18,.7)),hcDark:new kp(new vp(255,50,50,1)),hcLight:"#B5200D"},tt(0,"Overview ruler marker color for errors.")),dS=Iw("editorOverviewRuler.warningForeground",{dark:uv,light:uv,hcDark:dv,hcLight:dv},tt(0,"Overview ruler marker color for warnings.")),fS=Iw("editorOverviewRuler.infoForeground",{dark:fv,light:fv,hcDark:gv,hcLight:gv},tt(0,"Overview ruler marker color for infos.")),gS=Iw("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hcDark:"#FFD700",hcLight:"#0431FAFF"},tt(0,"Foreground color of brackets (1). Requires enabling bracket pair colorization.")),pS=Iw("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hcDark:"#DA70D6",hcLight:"#319331FF"},tt(0,"Foreground color of brackets (2). Requires enabling bracket pair colorization.")),mS=Iw("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hcDark:"#87CEFA",hcLight:"#7B3814FF"},tt(0,"Foreground color of brackets (3). Requires enabling bracket pair colorization.")),wS=Iw("editorBracketHighlight.foreground4",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Foreground color of brackets (4). Requires enabling bracket pair colorization.")),vS=Iw("editorBracketHighlight.foreground5",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Foreground color of brackets (5). Requires enabling bracket pair colorization.")),bS=Iw("editorBracketHighlight.foreground6",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Foreground color of brackets (6). Requires enabling bracket pair colorization.")),yS=Iw("editorBracketHighlight.unexpectedBracket.foreground",{dark:new kp(new vp(255,18,18,.8)),light:new kp(new vp(255,18,18,.8)),hcDark:new kp(new vp(255,50,50,1)),hcLight:""},tt(0,"Foreground color of unexpected brackets.")),kS=Iw("editorBracketPairGuide.background1",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Background color of inactive bracket pair guides (1). Requires enabling bracket pair guides.")),CS=Iw("editorBracketPairGuide.background2",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Background color of inactive bracket pair guides (2). Requires enabling bracket pair guides.")),SS=Iw("editorBracketPairGuide.background3",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Background color of inactive bracket pair guides (3). Requires enabling bracket pair guides.")),xS=Iw("editorBracketPairGuide.background4",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Background color of inactive bracket pair guides (4). Requires enabling bracket pair guides.")),DS=Iw("editorBracketPairGuide.background5",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Background color of inactive bracket pair guides (5). Requires enabling bracket pair guides.")),ES=Iw("editorBracketPairGuide.background6",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Background color of inactive bracket pair guides (6). Requires enabling bracket pair guides.")),AS=Iw("editorBracketPairGuide.activeBackground1",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Background color of active bracket pair guides (1). Requires enabling bracket pair guides.")),MS=Iw("editorBracketPairGuide.activeBackground2",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Background color of active bracket pair guides (2). Requires enabling bracket pair guides.")),LS=Iw("editorBracketPairGuide.activeBackground3",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Background color of active bracket pair guides (3). Requires enabling bracket pair guides.")),FS=Iw("editorBracketPairGuide.activeBackground4",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Background color of active bracket pair guides (4). Requires enabling bracket pair guides.")),TS=Iw("editorBracketPairGuide.activeBackground5",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Background color of active bracket pair guides (5). Requires enabling bracket pair guides.")),RS=Iw("editorBracketPairGuide.activeBackground6",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},tt(0,"Background color of active bracket pair guides (6). Requires enabling bracket pair guides."));Iw("editorUnicodeHighlight.border",{dark:uv,light:uv,hcDark:uv,hcLight:uv},tt(0,"Border color used to highlight unicode characters.")),Iw("editorUnicodeHighlight.background",{dark:av,light:av,hcDark:av,hcLight:av},tt(0,"Background color used to highlight unicode characters.")),RC(((t,i)=>{const e=t.getColor(sv),s=t.getColor(IC),n=s&&!s.isTransparent()?s:e;n&&i.addRule(`.monaco-editor .inputarea.ime-input { background-color: ${n}; }`)}));class OS extends EC{constructor(t){super(),this._context=t,this._readConfig(),this._lastCursorModelPosition=new ks(1,1),this._renderResult=null,this._activeLineNumber=1,this._context.addEventHandler(this)}_readConfig(){const t=this._context.configuration.options;this._lineHeight=t.get(67);const i=t.get(68);this._renderLineNumbers=i.renderType,this._renderCustomLineNumbers=i.renderFn,this._renderFinalNewline=t.get(95);const e=t.get(145);this._lineNumbersLeft=e.lineNumbersLeft,this._lineNumbersWidth=e.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(t){return this._readConfig(),!0}onCursorStateChanged(t){const i=t.selections[0].getPosition();this._lastCursorModelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(i);let e=!1;return this._activeLineNumber!==i.lineNumber&&(this._activeLineNumber=i.lineNumber,e=!0),this._renderLineNumbers!==2&&this._renderLineNumbers!==3||(e=!0),e}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged}onZonesChanged(t){return!0}onDecorationsChanged(t){return t.affectsLineNumber}_getLineRenderLineNumber(t){const i=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new ks(t,1));if(i.column!==1)return"";const e=i.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(e);if(this._renderLineNumbers===2){const t=Math.abs(this._lastCursorModelPosition.lineNumber-e);return t===0?'<span class="relative-current-line-number">'+e+"</span>":String(t)}return this._renderLineNumbers===3?this._lastCursorModelPosition.lineNumber===e||e%10==0||e===this._context.viewModel.getLineCount()?String(e):"":String(e)}prepareRender(t){if(this._renderLineNumbers===0)return void(this._renderResult=null);const i=yt?this._lineHeight%2==0?" lh-even":" lh-odd":"",e=t.visibleRange.startLineNumber,s=t.visibleRange.endLineNumber,n=this._context.viewModel.getDecorationsInViewport(t.visibleRange).filter((t=>!!t.options.lineNumberClassName));n.sort(((t,i)=>Cs.compareRangesUsingEnds(t.range,i.range)));let r=0;const o=this._context.viewModel.getLineCount(),h=[];for(let t=e;t<=s;t++){const s=t-e;let c=this._getLineRenderLineNumber(t),l="";for(;r<n.length&&n[r].range.endLineNumber<t;)r++;for(let i=r;i<n.length;i++){const{range:e,options:s}=n[i];e.startLineNumber<=t&&(l+=" "+s.lineNumberClassName)}c||l?(t===o&&this._context.viewModel.getLineLength(t)===0&&(this._renderFinalNewline==="off"&&(c=""),this._renderFinalNewline==="dimmed"&&(l+=" dimmed-line-number")),t===this._activeLineNumber&&(l+=" active-line-number"),h[s]=`<div class="${OS.CLASS_NAME}${i}${l}" style="left:${this._lineNumbersLeft}px;width:${this._lineNumbersWidth}px;">${c}</div>`):h[s]=""}this._renderResult=h}render(t,i){if(!this._renderResult)return"";const e=i-t;return e<0||e>=this._renderResult.length?"":this._renderResult[e]}}OS.CLASS_NAME="line-numbers",RC(((t,i)=>{const e=t.getColor(VC),s=t.getColor(rS);s?i.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${s}; }`):e&&i.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${e.transparent(.4)}; }`)}));class IS extends Yy{constructor(t){super(t);const i=this._context.configuration.options,e=i.get(145);this._canUseLayerHinting=!i.get(32),this._contentLeft=e.contentLeft,this._glyphMarginLeft=e.glyphMarginLeft,this._glyphMarginWidth=e.glyphMarginWidth,this._domNode=Sl(document.createElement("div")),this._domNode.setClassName(IS.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=Sl(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(IS.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(t){const i=this._context.configuration.options,e=i.get(145);return this._canUseLayerHinting=!i.get(32),this._contentLeft=e.contentLeft,this._glyphMarginLeft=e.glyphMarginLeft,this._glyphMarginWidth=e.glyphMarginWidth,!0}onScrollChanged(t){return super.onScrollChanged(t)||t.scrollTopChanged}prepareRender(t){}render(t){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");const i=t.scrollTop-t.bigNumbersDelta;this._domNode.setTop(-i);const e=Math.min(t.scrollHeight,1e6);this._domNode.setHeight(e),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(e)}}IS.CLASS_NAME="glyph-margin",IS.OUTER_CLASS_NAME="margin";const _S="monaco-mouse-cursor-text",PS=new class{constructor(){this._onDidChange=new le,this.onDidChange=this._onDidChange.event,this._enabled=!0}get enabled(){return this._enabled}enable(){this._enabled=!0,this._onDidChange.fire()}disable(){this._enabled=!1,this._onDidChange.fire()}},NS=_l("keybindingService");var BS=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},$S=function(t,i){return function(e,s){i(e,s,t)}};class WS{constructor(t,i,e,s,n){this._context=t,this.modelLineNumber=i,this.distanceToModelLineStart=e,this.widthOfHiddenLineTextBefore=s,this.distanceToModelLineEnd=n,this._visibleTextAreaBrand=void 0,this.startPosition=null,this.endPosition=null,this.visibleTextareaStart=null,this.visibleTextareaEnd=null,this._previousPresentation=null}prepareRender(t){const i=new ks(this.modelLineNumber,this.distanceToModelLineStart+1),e=new ks(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(e),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=t.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=t.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(t){return this._previousPresentation||(this._previousPresentation=t||{foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}}const jS=Hr;let HS=class extends Yy{constructor(t,i,e,s,n){super(t),this._keybindingService=s,this._instantiationService=n,this._primaryCursorPosition=new ks(1,1),this._primaryCursorVisibleRange=null,this._viewController=i,this._visibleRangeProvider=e,this._scrollLeft=0,this._scrollTop=0;const r=this._context.configuration.options,o=r.get(145);this._setAccessibilityOptions(r),this._contentLeft=o.contentLeft,this._contentWidth=o.contentWidth,this._contentHeight=o.height,this._fontInfo=r.get(50),this._lineHeight=r.get(67),this._emptySelectionClipboard=r.get(37),this._copyWithSyntaxHighlighting=r.get(25),this._visibleTextArea=null,this._selections=[new Ss(1,1,1,1)],this._modelSelections=[new Ss(1,1,1,1)],this._lastRenderPosition=null,this.textArea=Sl(document.createElement("textarea")),Xy.write(this.textArea,7),this.textArea.setClassName(`inputarea ${_S}`),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");const{tabSize:h}=this._context.viewModel.model.getOptions();this.textArea.domNode.style.tabSize=h*this._fontInfo.spaceWidth+"px",this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",this._getAriaLabel(r)),this.textArea.setAttribute("aria-required",r.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(r.get(124))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",tt(0,"editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-autocomplete",r.get(91)?"none":"both"),this._ensureReadOnlyAttribute(),this.textAreaCover=Sl(document.createElement("div")),this.textAreaCover.setPosition("absolute");const c={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:t=>this._context.viewModel.getLineMaxColumn(t),getValueInRange:(t,i)=>this._context.viewModel.getValueInRange(t,i),getValueLengthInRange:(t,i)=>this._context.viewModel.getValueLengthInRange(t,i),modifyPosition:(t,i)=>this._context.viewModel.modifyPosition(t,i)},l={getDataToCopy:()=>{const t=this._context.viewModel.getPlainTextToCopy(this._modelSelections,this._emptySelectionClipboard,vt),i=this._context.viewModel.model.getEOL(),e=this._emptySelectionClipboard&&this._modelSelections.length===1&&this._modelSelections[0].isEmpty(),s=Array.isArray(t)?t:null,n=Array.isArray(t)?t.join(i):t;let r,o=null;if(wC.forceCopyWithSyntaxHighlighting||this._copyWithSyntaxHighlighting&&n.length<65536){const t=this._context.viewModel.getRichTextToCopy(this._modelSelections,this._emptySelectionClipboard);t&&(r=t.html,o=t.mode)}return{isFromEmptySelection:e,multicursorText:s,text:n,html:r,mode:o}},getScreenReaderContent:()=>{if(this._accessibilitySupport===1){const t=this._selections[0];if(bt&&t.isEmpty()){const i=t.getStartPosition();let e=this._getWordBeforePosition(i);if(e.length===0&&(e=this._getCharacterBeforePosition(i)),e.length>0)return new dC(e,e.length,e.length,Cs.fromPositions(i),0)}if(bt&&!t.isEmpty()&&c.getValueLengthInRange(t,0)<500){const i=c.getValueInRange(t,0);return new dC(i,0,i.length,t,0)}if(Ur&&!t.isEmpty()){const t="vscode-placeholder";return new dC(t,0,t.length,null,void 0)}return dC.EMPTY}if(qr){const t=this._selections[0];if(t.isEmpty()){const i=t.getStartPosition(),[e,s]=this._getAndroidWordAtPosition(i);if(e.length>0)return new dC(e,s,s,Cs.fromPositions(i),0)}return dC.EMPTY}return fC.fromEditorSelection(c,this._selections[0],this._accessibilityPageSize,this._accessibilitySupport===0)},deduceModelPosition:(t,i,e)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(t,i,e)},a=this._register(new CC(this.textArea.domNode));this._textAreaInput=this._register(this._instantiationService.createInstance(yC,l,a,Ft,{isAndroid:qr,isChrome:zr,isFirefox:Hr,isSafari:Ur})),this._register(this._textAreaInput.onKeyDown((t=>{this._viewController.emitKeyDown(t)}))),this._register(this._textAreaInput.onKeyUp((t=>{this._viewController.emitKeyUp(t)}))),this._register(this._textAreaInput.onPaste((t=>{let i=!1,e=null,s=null;t.metadata&&(i=this._emptySelectionClipboard&&!!t.metadata.isFromEmptySelection,e=t.metadata.multicursorText!==void 0?t.metadata.multicursorText:null,s=t.metadata.mode),this._viewController.paste(t.text,i,e,s)}))),this._register(this._textAreaInput.onCut((()=>{this._viewController.cut()}))),this._register(this._textAreaInput.onType((t=>{t.replacePrevCharCnt||t.replaceNextCharCnt||t.positionDelta?this._viewController.compositionType(t.text,t.replacePrevCharCnt,t.replaceNextCharCnt,t.positionDelta):this._viewController.type(t.text)}))),this._register(this._textAreaInput.onSelectionChangeRequest((t=>{this._viewController.setSelection(t)}))),this._register(this._textAreaInput.onCompositionStart((t=>{const i=this.textArea.domNode,e=this._modelSelections[0],{distanceToModelLineStart:s,widthOfHiddenTextBefore:n}=(()=>{const t=i.value.substring(0,Math.min(i.selectionStart,i.selectionEnd)),s=t.lastIndexOf(`\n`),n=t.substring(s+1),r=n.lastIndexOf("\t"),o=n.length-r-1,h=e.getStartPosition(),c=Math.min(h.column-1,o),l=h.column-1-c,a=n.substring(0,n.length-c),{tabSize:u}=this._context.viewModel.model.getOptions(),d=function(t,i,e,s){if(i.length===0)return 0;const n=t.createElement("div");n.style.position="absolute",n.style.top="-50000px",n.style.width="50000px";const r=t.createElement("span");xl(r,e),r.style.whiteSpace="pre",r.style.tabSize=s*e.spaceWidth+"px",r.append(i),n.appendChild(r),t.body.appendChild(n);const o=r.offsetWidth;return t.body.removeChild(n),o}(this.textArea.domNode.ownerDocument,a,this._fontInfo,u);return{distanceToModelLineStart:l,widthOfHiddenTextBefore:d}})(),{distanceToModelLineEnd:r}=(()=>{const t=i.value.substring(Math.max(i.selectionStart,i.selectionEnd)),s=t.indexOf(`\n`),n=s===-1?t:t.substring(0,s),r=n.indexOf("\t"),o=r===-1?n.length:n.length-r-1,h=e.getEndPosition(),c=Math.min(this._context.viewModel.model.getLineMaxColumn(h.lineNumber)-h.column,o);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(h.lineNumber)-h.column-c}})();this._context.viewModel.revealRange("keyboard",!0,Cs.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new WS(this._context,e.startLineNumber,s,n,r),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${_S} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()}))),this._register(this._textAreaInput.onCompositionUpdate((t=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())}))),this._register(this._textAreaInput.onCompositionEnd((()=>{this._visibleTextArea=null,this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._render(),this.textArea.setClassName(`inputarea ${_S}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()}))),this._register(this._textAreaInput.onFocus((()=>{this._context.viewModel.setHasFocus(!0)}))),this._register(this._textAreaInput.onBlur((()=>{this._context.viewModel.setHasFocus(!1)}))),this._register(PS.onDidChange((()=>{this._ensureReadOnlyAttribute()})))}writeScreenReaderContent(t){this._textAreaInput.writeNativeTextAreaContent(t)}dispose(){super.dispose()}_getAndroidWordAtPosition(t){const i=this._context.viewModel.getLineContent(t.lineNumber),e=Qf('`~!@#$%^&*()-=+[{]}\\|;:",.<>/?',[]);let s=!0,n=t.column,r=!0,o=t.column,h=0;for(;h<50&&(s||r);){if(s&&n<=1&&(s=!1),s){const t=i.charCodeAt(n-2);e.get(t)!==0?s=!1:n--}if(r&&o>i.length&&(r=!1),r){const t=i.charCodeAt(o-1);e.get(t)!==0?r=!1:o++}h++}return[i.substring(n-1,o-1),t.column-n]}_getWordBeforePosition(t){const i=this._context.viewModel.getLineContent(t.lineNumber),e=Qf(this._context.configuration.options.get(131),[]);let s=t.column,n=0;for(;s>1;){const r=i.charCodeAt(s-2);if(e.get(r)!==0||n>50)return i.substring(s-1,t.column-1);n++,s--}return i.substring(0,t.column-1)}_getCharacterBeforePosition(t){if(t.column>1){const i=this._context.viewModel.getLineContent(t.lineNumber).charAt(t.column-2);if(!gr(i.charCodeAt(0)))return i}return""}_getAriaLabel(t){var i,e,s;if(t.get(2)===1){const t=(i=this._keybindingService.lookupKeybinding("editor.action.toggleScreenReaderAccessibilityMode"))===null||i===void 0?void 0:i.getAriaLabel(),n=(e=this._keybindingService.lookupKeybinding("workbench.action.showCommands"))===null||e===void 0?void 0:e.getAriaLabel(),r=(s=this._keybindingService.lookupKeybinding("workbench.action.openGlobalKeybindings"))===null||s===void 0?void 0:s.getAriaLabel(),o=tt(0,"The editor is not accessible at this time.");return t?tt(0,"{0} To enable screen reader optimized mode, use {1}",o,t):n?tt(0,"{0} To enable screen reader optimized mode, open the quick pick with {1} and run the command Toggle Screen Reader Accessibility Mode, which is currently not triggerable via keyboard.",o,n):r?tt(0,"{0} Please assign a keybinding for the command Toggle Screen Reader Accessibility Mode by accessing the keybindings editor with {1} and run it.",o,r):o}return t.get(4)}_setAccessibilityOptions(t){this._accessibilitySupport=t.get(2);const i=t.get(3);this._accessibilitySupport===2&&i===Ri.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=i;const e=t.get(145).wrappingColumn;if(e!==-1&&this._accessibilitySupport!==1){const i=t.get(50);this._textAreaWrapping=!0,this._textAreaWidth=Math.round(e*i.typicalHalfwidthCharacterWidth)}else this._textAreaWrapping=!1,this._textAreaWidth=jS?0:1}onConfigurationChanged(t){const i=this._context.configuration.options,e=i.get(145);this._setAccessibilityOptions(i),this._contentLeft=e.contentLeft,this._contentWidth=e.contentWidth,this._contentHeight=e.height,this._fontInfo=i.get(50),this._lineHeight=i.get(67),this._emptySelectionClipboard=i.get(37),this._copyWithSyntaxHighlighting=i.get(25),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");const{tabSize:s}=this._context.viewModel.model.getOptions();return this.textArea.domNode.style.tabSize=s*this._fontInfo.spaceWidth+"px",this.textArea.setAttribute("aria-label",this._getAriaLabel(i)),this.textArea.setAttribute("aria-required",i.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(i.get(124))),(t.hasChanged(34)||t.hasChanged(91))&&this._ensureReadOnlyAttribute(),t.hasChanged(2)&&this._textAreaInput.writeNativeTextAreaContent("strategy changed"),!0}onCursorStateChanged(t){return this._selections=t.selections.slice(0),this._modelSelections=t.modelSelections.slice(0),this._textAreaInput.writeNativeTextAreaContent("selection changed"),!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return this._scrollLeft=t.scrollLeft,this._scrollTop=t.scrollTop,!0}onZonesChanged(t){return!0}isFocused(){return this._textAreaInput.isFocused()}focusTextArea(){this._textAreaInput.focusTextArea()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(t){t.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",t.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),t.role&&this.textArea.setAttribute("role",t.role)}_ensureReadOnlyAttribute(){const t=this._context.configuration.options;!PS.enabled||t.get(34)&&t.get(91)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")}prepareRender(t){var i;this._primaryCursorPosition=new ks(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=t.visibleRangeForPosition(this._primaryCursorPosition),(i=this._visibleTextArea)===null||i===void 0||i.prepareRender(t)}render(t){this._textAreaInput.writeNativeTextAreaContent("render"),this._render()}_render(){var t;if(this._visibleTextArea){const t=this._visibleTextArea.visibleTextareaStart,i=this._visibleTextArea.visibleTextareaEnd,e=this._visibleTextArea.startPosition,s=this._visibleTextArea.endPosition;if(e&&s&&t&&i&&i.left>=this._scrollLeft&&t.left<=this._scrollLeft+this._contentWidth){const n=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,r=this._newlinecount(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));let o=this._visibleTextArea.widthOfHiddenLineTextBefore,h=this._contentLeft+t.left-this._scrollLeft,c=i.left-t.left+1;if(h<this._contentLeft){const t=this._contentLeft-h;h+=t,o+=t,c-=t}c>this._contentWidth&&(c=this._contentWidth);const l=this._context.viewModel.getViewLineData(e.lineNumber),a=l.tokens.findTokenIndexAtOffset(e.column-1),u=a===l.tokens.findTokenIndexAtOffset(s.column-1),d=this._visibleTextArea.definePresentation(u?l.tokens.getPresentation(a):null);this.textArea.domNode.scrollTop=r*this._lineHeight,this.textArea.domNode.scrollLeft=o,this._doRender({lastRenderPosition:null,top:n,left:h,width:c,height:this._lineHeight,useCover:!1,color:(Us.getColorMap()||[])[d.foreground],italic:d.italic,bold:d.bold,underline:d.underline,strikethrough:d.strikethrough})}return}if(!this._primaryCursorVisibleRange)return void this._renderAtTopLeft();const i=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(i<this._contentLeft||i>this._contentLeft+this._contentWidth)return void this._renderAtTopLeft();const e=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(e<0||e>this._contentHeight)this._renderAtTopLeft();else if(bt||this._accessibilitySupport===2){this._doRender({lastRenderPosition:this._primaryCursorPosition,top:e,left:this._textAreaWrapping?this._contentLeft:i,width:this._textAreaWidth,height:this._lineHeight,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;const s=(t=this._textAreaInput.textAreaState.newlineCountBeforeSelection)!==null&&t!==void 0?t:this._newlinecount(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=s*this._lineHeight}else this._doRender({lastRenderPosition:this._primaryCursorPosition,top:e,left:this._textAreaWrapping?this._contentLeft:i,width:this._textAreaWidth,height:jS?0:1,useCover:!1})}_newlinecount(t){let i=0,e=-1;for(;e=t.indexOf(`\n`,e+1),e!==-1;)i++;return i}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:this._textAreaWidth,height:jS?0:1,useCover:!0})}_doRender(t){this._lastRenderPosition=t.lastRenderPosition;const i=this.textArea,e=this.textAreaCover;xl(i,this._fontInfo),i.setTop(t.top),i.setLeft(t.left),i.setWidth(t.width),i.setHeight(t.height),i.setColor(t.color?kp.Format.CSS.formatHex(t.color):""),i.setFontStyle(t.italic?"italic":""),t.bold&&i.setFontWeight("bold"),i.setTextDecoration(`${t.underline?" underline":""}${t.strikethrough?" line-through":""}`),e.setTop(t.useCover?t.top:0),e.setLeft(t.useCover?t.left:0),e.setWidth(t.useCover?t.width:0),e.setHeight(t.useCover?t.height:0);const s=this._context.configuration.options;s.get(57)?e.setClassName("monaco-editor-background textAreaCover "+IS.OUTER_CLASS_NAME):s.get(68).renderType!==0?e.setClassName("monaco-editor-background textAreaCover "+OS.CLASS_NAME):e.setClassName("monaco-editor-background textAreaCover")}};function VS(t,i,e){let s=tr(t);return s===-1&&(s=t.length),function(t,i,e){let s=0;for(let e=0;e<t.length;e++)t.charAt(e)==="\t"?s=Ck.nextIndentTabStop(s,i):s++;let n="";if(!e){const t=Math.floor(s/i);s%=i;for(let i=0;i<t;i++)n+="\t"}for(let t=0;t<s;t++)n+=" ";return n}(t.substring(0,s),i,e)+t.substring(s)}HS=BS([$S(3,NS),$S(4,Il)],HS);const zS=()=>!0,US=()=>!1,KS=t=>t===" "||t==="\t";class qS{static shouldRecreate(t){return t.hasChanged(145)||t.hasChanged(131)||t.hasChanged(37)||t.hasChanged(77)||t.hasChanged(79)||t.hasChanged(80)||t.hasChanged(6)||t.hasChanged(7)||t.hasChanged(11)||t.hasChanged(9)||t.hasChanged(10)||t.hasChanged(14)||t.hasChanged(128)||t.hasChanged(50)||t.hasChanged(91)||t.hasChanged(130)}constructor(t,i,e,s){var n;this.languageConfigurationService=s,this._cursorMoveConfigurationBrand=void 0,this._languageId=t;const r=e.options,o=r.get(145),h=r.get(50);this.readOnly=r.get(91),this.tabSize=i.tabSize,this.indentSize=i.indentSize,this.insertSpaces=i.insertSpaces,this.stickyTabStops=r.get(116),this.lineHeight=h.lineHeight,this.typicalHalfwidthCharacterWidth=h.typicalHalfwidthCharacterWidth,this.pageSize=Math.max(1,Math.floor(o.height/this.lineHeight)-2),this.useTabStops=r.get(128),this.wordSeparators=r.get(131),this.emptySelectionClipboard=r.get(37),this.copyWithSyntaxHighlighting=r.get(25),this.multiCursorMergeOverlapping=r.get(77),this.multiCursorPaste=r.get(79),this.multiCursorLimit=r.get(80),this.autoClosingBrackets=r.get(6),this.autoClosingComments=r.get(7),this.autoClosingQuotes=r.get(11),this.autoClosingDelete=r.get(9),this.autoClosingOvertype=r.get(10),this.autoSurround=r.get(14),this.autoIndent=r.get(12),this.wordSegmenterLocales=r.get(130),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:this._getShouldAutoClose(t,this.autoClosingQuotes,!0),comment:this._getShouldAutoClose(t,this.autoClosingComments,!1),bracket:this._getShouldAutoClose(t,this.autoClosingBrackets,!1)},this.autoClosingPairs=this.languageConfigurationService.getLanguageConfiguration(t).getAutoClosingPairs();const c=this.languageConfigurationService.getLanguageConfiguration(t).getSurroundingPairs();if(c)for(const t of c)this.surroundingPairs[t.open]=t.close;const l=this.languageConfigurationService.getLanguageConfiguration(t).comments;this.blockCommentStartToken=(n=l==null?void 0:l.blockCommentStartToken)!==null&&n!==void 0?n:null}get electricChars(){var t;if(!this._electricChars){this._electricChars={};const i=(t=this.languageConfigurationService.getLanguageConfiguration(this._languageId).electricCharacter)===null||t===void 0?void 0:t.getElectricCharacters();if(i)for(const t of i)this._electricChars[t]=!0}return this._electricChars}onElectricCharacter(t,i,e){const s=Zu(i,e-1),n=this.languageConfigurationService.getLanguageConfiguration(s.languageId).electricCharacter;return n?n.onElectricCharacter(t,s,e-s.firstCharOffset):null}normalizeIndentation(t){return VS(t,this.indentSize,this.insertSpaces)}_getShouldAutoClose(t,i,e){switch(i){case"beforeWhitespace":return KS;case"languageDefined":return this._getLanguageDefinedShouldAutoClose(t,e);case"always":return zS;case"never":return US}}_getLanguageDefinedShouldAutoClose(t,i){const e=this.languageConfigurationService.getLanguageConfiguration(t).getAutoCloseBeforeSet(i);return t=>e.indexOf(t)!==-1}visibleColumnFromColumn(t,i){return Ck.visibleColumnFromColumn(t.getLineContent(i.lineNumber),i.column,this.tabSize)}columnFromVisibleColumn(t,i,e){const s=Ck.columnFromVisibleColumn(t.getLineContent(i),e,this.tabSize),n=t.getLineMinColumn(i);if(s<n)return n;const r=t.getLineMaxColumn(i);return s>r?r:s}}let GS=class t{static fromModelState(t){return new ZS(t)}static fromViewState(t){return new JS(t)}static fromModelSelection(i){const e=Ss.liftSelection(i),s=new QS(Cs.fromPositions(e.getSelectionStart()),0,0,e.getPosition(),0);return t.fromModelState(s)}static fromModelSelections(t){const i=[];for(let e=0,s=t.length;e<s;e++)i[e]=this.fromModelSelection(t[e]);return i}constructor(t,i){this._cursorStateBrand=void 0,this.modelState=t,this.viewState=i}equals(t){return this.viewState.equals(t.viewState)&&this.modelState.equals(t.modelState)}};class ZS{constructor(t){this.modelState=t,this.viewState=null}}class JS{constructor(t){this.modelState=null,this.viewState=t}}class QS{constructor(t,i,e,s,n){this.selectionStart=t,this.selectionStartKind=i,this.selectionStartLeftoverVisibleColumns=e,this.position=s,this.leftoverVisibleColumns=n,this._singleCursorStateBrand=void 0,this.selection=QS._computeSelection(this.selectionStart,this.position)}equals(t){return this.selectionStartLeftoverVisibleColumns===t.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===t.leftoverVisibleColumns&&this.selectionStartKind===t.selectionStartKind&&this.position.equals(t.position)&&this.selectionStart.equalsRange(t.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(t,i,e,s){return t?new QS(this.selectionStart,this.selectionStartKind,this.selectionStartLeftoverVisibleColumns,new ks(i,e),s):new QS(new Cs(i,e,i,e),0,s,new ks(i,e),s)}static _computeSelection(t,i){return t.isEmpty()||!i.isBeforeOrEqual(t.getStartPosition())?Ss.fromPositions(t.getStartPosition(),i):Ss.fromPositions(t.getEndPosition(),i)}}class YS{constructor(t,i,e){this._editOperationResultBrand=void 0,this.type=t,this.commands=i,this.shouldPushStackElementBefore=e.shouldPushStackElementBefore,this.shouldPushStackElementAfter=e.shouldPushStackElementAfter}}function XS(t){return t==="'"||t==='"'||t==="`"}class tx{static columnSelect(t,i,e,s,n,r){const o=Math.abs(n-e)+1,h=e>n,c=s>r,l=s<r,a=[];for(let n=0;n<o;n++){const o=e+(h?-n:n),u=t.columnFromVisibleColumn(i,o,s),d=t.columnFromVisibleColumn(i,o,r),f=t.visibleColumnFromColumn(i,new ks(o,u)),g=t.visibleColumnFromColumn(i,new ks(o,d));l&&(f>r||g<s)||c&&(g>s||f<r)||a.push(new QS(new Cs(o,u,o,u),0,0,new ks(o,d),0))}if(a.length===0)for(let t=0;t<o;t++){const s=e+(h?-t:t),n=i.getLineMaxColumn(s);a.push(new QS(new Cs(s,n,s,n),0,0,new ks(s,n),0))}return{viewStates:a,reversed:h,fromLineNumber:e,fromVisualColumn:s,toLineNumber:n,toVisualColumn:r}}static columnSelectLeft(t,i,e){let s=e.toViewVisualColumn;return s>0&&s--,tx.columnSelect(t,i,e.fromViewLineNumber,e.fromViewVisualColumn,e.toViewLineNumber,s)}static columnSelectRight(t,i,e){let s=0;const n=Math.min(e.fromViewLineNumber,e.toViewLineNumber),r=Math.max(e.fromViewLineNumber,e.toViewLineNumber);for(let e=n;e<=r;e++){const n=i.getLineMaxColumn(e),r=t.visibleColumnFromColumn(i,new ks(e,n));s=Math.max(s,r)}let o=e.toViewVisualColumn;return o<s&&o++,this.columnSelect(t,i,e.fromViewLineNumber,e.fromViewVisualColumn,e.toViewLineNumber,o)}static columnSelectUp(t,i,e,s){const n=s?t.pageSize:1,r=Math.max(1,e.toViewLineNumber-n);return this.columnSelect(t,i,e.fromViewLineNumber,e.fromViewVisualColumn,r,e.toViewVisualColumn)}static columnSelectDown(t,i,e,s){const n=s?t.pageSize:1,r=Math.min(i.getLineCount(),e.toViewLineNumber+n);return this.columnSelect(t,i,e.fromViewLineNumber,e.fromViewVisualColumn,r,e.toViewVisualColumn)}}class ix{constructor(t,i,e=!1){this._range=t,this._text=i,this.insertsAutoWhitespace=e}getEditOperations(t,i){i.addTrackedEditOperation(this._range,this._text)}computeCursorState(t,i){const e=i.getInverseEditOperations()[0].range;return Ss.fromPositions(e.getEndPosition())}}class ex{constructor(t,i){this._range=t,this._text=i}getEditOperations(t,i){i.addTrackedEditOperation(this._range,this._text)}computeCursorState(t,i){const e=i.getInverseEditOperations()[0].range;return Ss.fromRange(e,0)}}class sx{constructor(t,i,e=!1){this._range=t,this._text=i,this.insertsAutoWhitespace=e}getEditOperations(t,i){i.addTrackedEditOperation(this._range,this._text)}computeCursorState(t,i){const e=i.getInverseEditOperations()[0].range;return Ss.fromPositions(e.getStartPosition())}}class nx{constructor(t,i,e,s,n=!1){this._range=t,this._text=i,this._columnDeltaOffset=s,this._lineNumberDeltaOffset=e,this.insertsAutoWhitespace=n}getEditOperations(t,i){i.addTrackedEditOperation(this._range,this._text)}computeCursorState(t,i){const e=i.getInverseEditOperations()[0].range;return Ss.fromPositions(e.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}}class rx{constructor(t,i,e,s=!1){this._range=t,this._text=i,this._initialSelection=e,this._forceMoveMarkers=s,this._selectionId=null}getEditOperations(t,i){i.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=i.trackSelection(this._initialSelection)}computeCursorState(t,i){return i.getTrackedSelection(this._selectionId)}}class ox{constructor(t,i,e){this._cursorPositionBrand=void 0,this.lineNumber=t,this.column=i,this.leftoverVisibleColumns=e}}class hx{static leftPosition(t,i){if(i.column>t.getLineMinColumn(i.lineNumber))return i.delta(void 0,-kr(t.getLineContent(i.lineNumber),i.column-1));if(i.lineNumber>1){const e=i.lineNumber-1;return new ks(e,t.getLineMaxColumn(e))}return i}static leftPositionAtomicSoftTabs(t,i,e){if(i.column<=t.getLineIndentColumn(i.lineNumber)){const s=t.getLineMinColumn(i.lineNumber),n=t.getLineContent(i.lineNumber),r=Sk.atomicPosition(n,i.column-1,e,0);if(r!==-1&&r+1>=s)return new ks(i.lineNumber,r+1)}return this.leftPosition(t,i)}static left(t,i,e){const s=t.stickyTabStops?hx.leftPositionAtomicSoftTabs(i,e,t.tabSize):hx.leftPosition(i,e);return new ox(s.lineNumber,s.column,0)}static moveLeft(t,i,e,s,n){let r,o;if(e.hasSelection()&&!s)r=e.selection.startLineNumber,o=e.selection.startColumn;else{const s=e.position.delta(void 0,-(n-1)),h=i.normalizePosition(hx.clipPositionColumn(s,i),0),c=hx.left(t,i,h);r=c.lineNumber,o=c.column}return e.move(s,r,o,0)}static clipPositionColumn(t,i){return new ks(t.lineNumber,hx.clipRange(t.column,i.getLineMinColumn(t.lineNumber),i.getLineMaxColumn(t.lineNumber)))}static clipRange(t,i,e){return t<i?i:t>e?e:t}static rightPosition(t,i,e){return e<t.getLineMaxColumn(i)?e+=yr(t.getLineContent(i),e-1):i<t.getLineCount()&&(i+=1,e=t.getLineMinColumn(i)),new ks(i,e)}static rightPositionAtomicSoftTabs(t,i,e,s,n){if(e<t.getLineIndentColumn(i)){const n=t.getLineContent(i),r=Sk.atomicPosition(n,e-1,s,1);if(r!==-1)return new ks(i,r+1)}return this.rightPosition(t,i,e)}static right(t,i,e){const s=t.stickyTabStops?hx.rightPositionAtomicSoftTabs(i,e.lineNumber,e.column,t.tabSize,t.indentSize):hx.rightPosition(i,e.lineNumber,e.column);return new ox(s.lineNumber,s.column,0)}static moveRight(t,i,e,s,n){let r,o;if(e.hasSelection()&&!s)r=e.selection.endLineNumber,o=e.selection.endColumn;else{const s=e.position.delta(void 0,n-1),h=i.normalizePosition(hx.clipPositionColumn(s,i),1),c=hx.right(t,i,h);r=c.lineNumber,o=c.column}return e.move(s,r,o,0)}static vertical(t,i,e,s,n,r,o,h){const c=Ck.visibleColumnFromColumn(i.getLineContent(e),s,t.tabSize)+n,l=i.getLineCount(),a=e===1&&s===1,u=e===l&&s===i.getLineMaxColumn(e),d=r<e?a:u;if((e=r)<1?(e=1,s=o?i.getLineMinColumn(e):Math.min(i.getLineMaxColumn(e),s)):e>l?(e=l,s=o?i.getLineMaxColumn(e):Math.min(i.getLineMaxColumn(e),s)):s=t.columnFromVisibleColumn(i,e,c),n=d?0:c-Ck.visibleColumnFromColumn(i.getLineContent(e),s,t.tabSize),h!==void 0){const t=new ks(e,s),r=i.normalizePosition(t,h);n+=s-r.column,e=r.lineNumber,s=r.column}return new ox(e,s,n)}static down(t,i,e,s,n,r,o){return this.vertical(t,i,e,s,n,e+r,o,4)}static moveDown(t,i,e,s,n){let r,o;e.hasSelection()&&!s?(r=e.selection.endLineNumber,o=e.selection.endColumn):(r=e.position.lineNumber,o=e.position.column);let h,c=0;do{if(h=hx.down(t,i,r+c,o,e.leftoverVisibleColumns,n,!0),i.normalizePosition(new ks(h.lineNumber,h.column),2).lineNumber>r)break}while(c++<10&&r+c<i.getLineCount());return e.move(s,h.lineNumber,h.column,h.leftoverVisibleColumns)}static translateDown(t,i,e){const s=e.selection,n=hx.down(t,i,s.selectionStartLineNumber,s.selectionStartColumn,e.selectionStartLeftoverVisibleColumns,1,!1),r=hx.down(t,i,s.positionLineNumber,s.positionColumn,e.leftoverVisibleColumns,1,!1);return new QS(new Cs(n.lineNumber,n.column,n.lineNumber,n.column),0,n.leftoverVisibleColumns,new ks(r.lineNumber,r.column),r.leftoverVisibleColumns)}static up(t,i,e,s,n,r,o){return this.vertical(t,i,e,s,n,e-r,o,3)}static moveUp(t,i,e,s,n){let r,o;e.hasSelection()&&!s?(r=e.selection.startLineNumber,o=e.selection.startColumn):(r=e.position.lineNumber,o=e.position.column);const h=hx.up(t,i,r,o,e.leftoverVisibleColumns,n,!0);return e.move(s,h.lineNumber,h.column,h.leftoverVisibleColumns)}static translateUp(t,i,e){const s=e.selection,n=hx.up(t,i,s.selectionStartLineNumber,s.selectionStartColumn,e.selectionStartLeftoverVisibleColumns,1,!1),r=hx.up(t,i,s.positionLineNumber,s.positionColumn,e.leftoverVisibleColumns,1,!1);return new QS(new Cs(n.lineNumber,n.column,n.lineNumber,n.column),0,n.leftoverVisibleColumns,new ks(r.lineNumber,r.column),r.leftoverVisibleColumns)}static _isBlankLine(t,i){return t.getLineFirstNonWhitespaceColumn(i)===0}static moveToPrevBlankLine(t,i,e,s){let n=e.position.lineNumber;for(;n>1&&this._isBlankLine(i,n);)n--;for(;n>1&&!this._isBlankLine(i,n);)n--;return e.move(s,n,i.getLineMinColumn(n),0)}static moveToNextBlankLine(t,i,e,s){const n=i.getLineCount();let r=e.position.lineNumber;for(;r<n&&this._isBlankLine(i,r);)r++;for(;r<n&&!this._isBlankLine(i,r);)r++;return e.move(s,r,i.getLineMinColumn(r),0)}static moveToBeginningOfLine(t,i,e,s){const n=e.position.lineNumber,r=i.getLineMinColumn(n),o=i.getLineFirstNonWhitespaceColumn(n)||r;let h;return h=e.position.column===o?r:o,e.move(s,n,h,0)}static moveToEndOfLine(t,i,e,s,n){const r=e.position.lineNumber,o=i.getLineMaxColumn(r);return e.move(s,r,o,n?1073741824-o:0)}static moveToBeginningOfBuffer(t,i,e,s){return e.move(s,1,1,0)}static moveToEndOfBuffer(t,i,e,s){const n=i.getLineCount(),r=i.getLineMaxColumn(n);return e.move(s,n,r,0)}}class cx{static deleteRight(t,i,e,s){const n=[];let r=t!==3;for(let t=0,o=s.length;t<o;t++){const o=s[t];let h=o;if(h.isEmpty()){const t=o.getPosition(),s=hx.right(i,e,t);h=new Cs(s.lineNumber,s.column,t.lineNumber,t.column)}h.isEmpty()?n[t]=null:(h.startLineNumber!==h.endLineNumber&&(r=!0),n[t]=new ix(h,""))}return[r,n]}static isAutoClosingPairDelete(t,i,e,s,n,r,o){if(i==="never"&&e==="never"||t==="never")return!1;for(let h=0,c=r.length;h<c;h++){const c=r[h],l=c.getPosition();if(!c.isEmpty())return!1;const a=n.getLineContent(l.lineNumber);if(l.column<2||l.column>=a.length+1)return!1;const u=a.charAt(l.column-2),d=s.get(u);if(!d)return!1;if(XS(u)){if(e==="never")return!1}else if(i==="never")return!1;const f=a.charAt(l.column-1);let g=!1;for(const t of d)t.open===u&&t.close===f&&(g=!0);if(!g)return!1;if(t==="auto"){let t=!1;for(let i=0,e=o.length;i<e;i++){const e=o[i];if(l.lineNumber===e.startLineNumber&&l.column===e.startColumn){t=!0;break}}if(!t)return!1}}return!0}static _runAutoClosingPairDelete(t,i,e){const s=[];for(let t=0,i=e.length;t<i;t++){const i=e[t].getPosition(),n=new Cs(i.lineNumber,i.column-1,i.lineNumber,i.column+1);s[t]=new ix(n,"")}return[!0,s]}static deleteLeft(t,i,e,s,n){if(this.isAutoClosingPairDelete(i.autoClosingDelete,i.autoClosingBrackets,i.autoClosingQuotes,i.autoClosingPairs.autoClosingPairsOpenByEnd,e,s,n))return this._runAutoClosingPairDelete(i,e,s);const r=[];let o=t!==2;for(let t=0,n=s.length;t<n;t++){const n=cx.getDeleteRange(s[t],e,i);n.isEmpty()?r[t]=null:(n.startLineNumber!==n.endLineNumber&&(o=!0),r[t]=new ix(n,""))}return[o,r]}static getDeleteRange(t,i,e){if(!t.isEmpty())return t;const s=t.getPosition();if(e.useTabStops&&s.column>1){const t=i.getLineContent(s.lineNumber),n=tr(t),r=n===-1?t.length+1:n+1;if(s.column<=r){const t=e.visibleColumnFromColumn(i,s),n=Ck.prevIndentTabStop(t,e.indentSize),r=e.columnFromVisibleColumn(i,s.lineNumber,n);return new Cs(s.lineNumber,r,s.lineNumber,s.column)}}return Cs.fromPositions(cx.getPositionAfterDeleteLeft(s,i),s)}static getPositionAfterDeleteLeft(t,i){if(t.column>1){const e=_r(t.column-1,i.getLineContent(t.lineNumber));return t.with(void 0,e+1)}if(t.lineNumber>1){const e=t.lineNumber-1;return new ks(e,i.getLineMaxColumn(e))}return t}static cut(t,i,e){const s=[];let n=null;e.sort(((t,i)=>ks.compare(t.getStartPosition(),i.getEndPosition())));for(let r=0,o=e.length;r<o;r++){const o=e[r];if(o.isEmpty())if(t.emptySelectionClipboard){const t=o.getPosition();let e,h,c,l;t.lineNumber<i.getLineCount()?(e=t.lineNumber,h=1,c=t.lineNumber+1,l=1):t.lineNumber>1&&(n==null?void 0:n.endLineNumber)!==t.lineNumber?(e=t.lineNumber-1,h=i.getLineMaxColumn(t.lineNumber-1),c=t.lineNumber,l=i.getLineMaxColumn(t.lineNumber)):(e=t.lineNumber,h=1,c=t.lineNumber,l=i.getLineMaxColumn(t.lineNumber));const a=new Cs(e,h,c,l);n=a,a.isEmpty()?s[r]=null:s[r]=new ix(a,"")}else s[r]=null;else s[r]=new ix(o,"")}return new YS(0,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}class lx{static _createWord(t,i,e,s,n){return{start:s,end:n,wordType:i,nextCharClass:e}}static _createIntlWord(t,i){return{start:t.index,end:t.index+t.segment.length,wordType:1,nextCharClass:i}}static _findPreviousWordOnLine(t,i,e){const s=i.getLineContent(e.lineNumber);return this._doFindPreviousWordOnLine(s,t,e)}static _doFindPreviousWordOnLine(t,i,e){let s=0;const n=i.findPrevIntlWordBeforeOrAtOffset(t,e.column-2);for(let r=e.column-2;r>=0;r--){const e=t.charCodeAt(r),o=i.get(e);if(n&&r===n.index)return this._createIntlWord(n,o);if(o===0){if(s===2)return this._createWord(t,s,o,r+1,this._findEndOfWord(t,i,s,r+1));s=1}else if(o===2){if(s===1)return this._createWord(t,s,o,r+1,this._findEndOfWord(t,i,s,r+1));s=2}else if(o===1&&s!==0)return this._createWord(t,s,o,r+1,this._findEndOfWord(t,i,s,r+1))}return s!==0?this._createWord(t,s,1,0,this._findEndOfWord(t,i,s,0)):null}static _findEndOfWord(t,i,e,s){const n=i.findNextIntlWordAtOrAfterOffset(t,s),r=t.length;for(let o=s;o<r;o++){const s=t.charCodeAt(o),r=i.get(s);if(n&&o===n.index+n.segment.length||r===1||e===1&&r===2||e===2&&r===0)return o}return r}static _findNextWordOnLine(t,i,e){const s=i.getLineContent(e.lineNumber);return this._doFindNextWordOnLine(s,t,e)}static _doFindNextWordOnLine(t,i,e){let s=0;const n=t.length,r=i.findNextIntlWordAtOrAfterOffset(t,e.column-1);for(let o=e.column-1;o<n;o++){const e=t.charCodeAt(o),n=i.get(e);if(r&&o===r.index)return this._createIntlWord(r,n);if(n===0){if(s===2)return this._createWord(t,s,n,this._findStartOfWord(t,i,s,o-1),o);s=1}else if(n===2){if(s===1)return this._createWord(t,s,n,this._findStartOfWord(t,i,s,o-1),o);s=2}else if(n===1&&s!==0)return this._createWord(t,s,n,this._findStartOfWord(t,i,s,o-1),o)}return s!==0?this._createWord(t,s,1,this._findStartOfWord(t,i,s,n-1),n):null}static _findStartOfWord(t,i,e,s){const n=i.findPrevIntlWordBeforeOrAtOffset(t,s);for(let r=s;r>=0;r--){const s=t.charCodeAt(r),o=i.get(s);if(n&&r===n.index)return r;if(o===1||e===1&&o===2||e===2&&o===0)return r+1}return 0}static moveWordLeft(t,i,e,s){let n=e.lineNumber,r=e.column;r===1&&n>1&&(n-=1,r=i.getLineMaxColumn(n));let o=lx._findPreviousWordOnLine(t,i,new ks(n,r));if(s===0)return new ks(n,o?o.start+1:1);if(s===1)return o&&o.wordType===2&&o.end-o.start==1&&o.nextCharClass===0&&(o=lx._findPreviousWordOnLine(t,i,new ks(n,o.start+1))),new ks(n,o?o.start+1:1);if(s===3){for(;o&&o.wordType===2;)o=lx._findPreviousWordOnLine(t,i,new ks(n,o.start+1));return new ks(n,o?o.start+1:1)}return o&&r<=o.end+1&&(o=lx._findPreviousWordOnLine(t,i,new ks(n,o.start+1))),new ks(n,o?o.end+1:1)}static _moveWordPartLeft(t,i){const e=i.lineNumber,s=t.getLineMaxColumn(e);if(i.column===1)return e>1?new ks(e-1,t.getLineMaxColumn(e-1)):i;const n=t.getLineContent(e);for(let t=i.column-1;t>1;t--){const i=n.charCodeAt(t-2),r=n.charCodeAt(t-1);if(i===95&&r!==95)return new ks(e,t);if(i===45&&r!==45)return new ks(e,t);if((cr(i)||hr(i))&&lr(r))return new ks(e,t);if(lr(i)&&lr(r)&&t+1<s){const i=n.charCodeAt(t);if(cr(i)||hr(i))return new ks(e,t)}}return new ks(e,1)}static moveWordRight(t,i,e,s){let n=e.lineNumber,r=e.column,o=!1;r===i.getLineMaxColumn(n)&&n<i.getLineCount()&&(o=!0,n+=1,r=1);let h=lx._findNextWordOnLine(t,i,new ks(n,r));if(s===2)h&&h.wordType===2&&h.end-h.start==1&&h.nextCharClass===0&&(h=lx._findNextWordOnLine(t,i,new ks(n,h.end+1))),r=h?h.end+1:i.getLineMaxColumn(n);else if(s===3){for(o&&(r=0);h&&(h.wordType===2||h.start+1<=r);)h=lx._findNextWordOnLine(t,i,new ks(n,h.end+1));r=h?h.start+1:i.getLineMaxColumn(n)}else h&&!o&&r>=h.start+1&&(h=lx._findNextWordOnLine(t,i,new ks(n,h.end+1))),r=h?h.start+1:i.getLineMaxColumn(n);return new ks(n,r)}static _moveWordPartRight(t,i){const e=i.lineNumber,s=t.getLineMaxColumn(e);if(i.column===s)return e<t.getLineCount()?new ks(e+1,1):i;const n=t.getLineContent(e);for(let t=i.column+1;t<s;t++){const i=n.charCodeAt(t-2),r=n.charCodeAt(t-1);if(i!==95&&r===95)return new ks(e,t);if(i!==45&&r===45)return new ks(e,t);if((cr(i)||hr(i))&&lr(r))return new ks(e,t);if(lr(i)&&lr(r)&&t+1<s){const i=n.charCodeAt(t);if(cr(i)||hr(i))return new ks(e,t)}}return new ks(e,s)}static _deleteWordLeftWhitespace(t,i){const e=t.getLineContent(i.lineNumber),s=i.column-2,n=er(e,s);return n+1<s?new Cs(i.lineNumber,n+2,i.lineNumber,i.column):null}static deleteWordLeft(t,i){const e=t.wordSeparators,s=t.model,n=t.selection,r=t.whitespaceHeuristics;if(!n.isEmpty())return n;if(cx.isAutoClosingPairDelete(t.autoClosingDelete,t.autoClosingBrackets,t.autoClosingQuotes,t.autoClosingPairs.autoClosingPairsOpenByEnd,t.model,[t.selection],t.autoClosedCharacters)){const i=t.selection.getPosition();return new Cs(i.lineNumber,i.column-1,i.lineNumber,i.column+1)}const o=new ks(n.positionLineNumber,n.positionColumn);let h=o.lineNumber,c=o.column;if(h===1&&c===1)return null;if(r){const t=this._deleteWordLeftWhitespace(s,o);if(t)return t}let l=lx._findPreviousWordOnLine(e,s,o);return i===0?l?c=l.start+1:c>1?c=1:(h--,c=s.getLineMaxColumn(h)):(l&&c<=l.end+1&&(l=lx._findPreviousWordOnLine(e,s,new ks(h,l.start+1))),l?c=l.end+1:c>1?c=1:(h--,c=s.getLineMaxColumn(h))),new Cs(h,c,o.lineNumber,o.column)}static deleteInsideWord(t,i,e){if(!e.isEmpty())return e;const s=new ks(e.positionLineNumber,e.positionColumn);return this._deleteInsideWordWhitespace(i,s)||this._deleteInsideWordDetermineDeleteRange(t,i,s)}static _charAtIsWhitespace(t,i){const e=t.charCodeAt(i);return e===32||e===9}static _deleteInsideWordWhitespace(t,i){const e=t.getLineContent(i.lineNumber),s=e.length;if(s===0)return null;let n=Math.max(i.column-2,0);if(!this._charAtIsWhitespace(e,n))return null;let r=Math.min(i.column-1,s-1);if(!this._charAtIsWhitespace(e,r))return null;for(;n>0&&this._charAtIsWhitespace(e,n-1);)n--;for(;r+1<s&&this._charAtIsWhitespace(e,r+1);)r++;return new Cs(i.lineNumber,n+1,i.lineNumber,r+2)}static _deleteInsideWordDetermineDeleteRange(t,i,e){const s=i.getLineContent(e.lineNumber),n=s.length;if(n===0)return e.lineNumber>1?new Cs(e.lineNumber-1,i.getLineMaxColumn(e.lineNumber-1),e.lineNumber,1):e.lineNumber<i.getLineCount()?new Cs(e.lineNumber,1,e.lineNumber+1,1):new Cs(e.lineNumber,1,e.lineNumber,1);const r=t=>t.start+1<=e.column&&e.column<=t.end+1,o=(t,i)=>(t=Math.min(t,e.column),i=Math.max(i,e.column),new Cs(e.lineNumber,t,e.lineNumber,i)),h=t=>{let i=t.start+1,e=t.end+1,r=!1;for(;e-1<n&&this._charAtIsWhitespace(s,e-1);)r=!0,e++;if(!r)for(;i>1&&this._charAtIsWhitespace(s,i-2);)i--;return o(i,e)},c=lx._findPreviousWordOnLine(t,i,e);if(c&&r(c))return h(c);const l=lx._findNextWordOnLine(t,i,e);return l&&r(l)?h(l):c&&l?o(c.end+1,l.start+1):c?o(c.start+1,c.end+1):l?o(l.start+1,l.end+1):o(1,n+1)}static _deleteWordPartLeft(t,i){if(!i.isEmpty())return i;const e=i.getPosition(),s=lx._moveWordPartLeft(t,e);return new Cs(e.lineNumber,e.column,s.lineNumber,s.column)}static _findFirstNonWhitespaceChar(t,i){const e=t.length;for(let s=i;s<e;s++){const i=t.charAt(s);if(i!==" "&&i!=="\t")return s}return e}static _deleteWordRightWhitespace(t,i){const e=t.getLineContent(i.lineNumber),s=i.column-1,n=this._findFirstNonWhitespaceChar(e,s);return s+1<n?new Cs(i.lineNumber,i.column,i.lineNumber,n+1):null}static deleteWordRight(t,i){const e=t.wordSeparators,s=t.model,n=t.selection,r=t.whitespaceHeuristics;if(!n.isEmpty())return n;const o=new ks(n.positionLineNumber,n.positionColumn);let h=o.lineNumber,c=o.column;const l=s.getLineCount(),a=s.getLineMaxColumn(h);if(h===l&&c===a)return null;if(r){const t=this._deleteWordRightWhitespace(s,o);if(t)return t}let u=lx._findNextWordOnLine(e,s,o);return i===2?u?c=u.end+1:c<a||h===l?c=a:(h++,u=lx._findNextWordOnLine(e,s,new ks(h,1)),c=u?u.start+1:s.getLineMaxColumn(h)):(u&&c>=u.start+1&&(u=lx._findNextWordOnLine(e,s,new ks(h,u.end+1))),u?c=u.start+1:c<a||h===l?c=a:(h++,u=lx._findNextWordOnLine(e,s,new ks(h,1)),c=u?u.start+1:s.getLineMaxColumn(h))),new Cs(h,c,o.lineNumber,o.column)}static _deleteWordPartRight(t,i){if(!i.isEmpty())return i;const e=i.getPosition(),s=lx._moveWordPartRight(t,e);return new Cs(e.lineNumber,e.column,s.lineNumber,s.column)}static _createWordAtPosition(t,i,e){const s=new Cs(i,e.start+1,i,e.end+1);return{word:t.getValueInRange(s),startColumn:s.startColumn,endColumn:s.endColumn}}static getWordAtPosition(t,i,e,s){const n=Qf(i,e),r=lx._findPreviousWordOnLine(n,t,s);if(r&&r.wordType===1&&r.start<=s.column-1&&s.column-1<=r.end)return lx._createWordAtPosition(t,s.lineNumber,r);const o=lx._findNextWordOnLine(n,t,s);return o&&o.wordType===1&&o.start<=s.column-1&&s.column-1<=o.end?lx._createWordAtPosition(t,s.lineNumber,o):null}static word(t,i,e,s,n){const r=Qf(t.wordSeparators,t.wordSegmenterLocales),o=lx._findPreviousWordOnLine(r,i,n),h=lx._findNextWordOnLine(r,i,n);if(!s){let t,e;return o&&o.wordType===1&&o.start<=n.column-1&&n.column-1<=o.end?(t=o.start+1,e=o.end+1):h&&h.wordType===1&&h.start<=n.column-1&&n.column-1<=h.end?(t=h.start+1,e=h.end+1):(t=o?o.end+1:1,e=h?h.start+1:i.getLineMaxColumn(n.lineNumber)),new QS(new Cs(n.lineNumber,t,n.lineNumber,e),1,0,new ks(n.lineNumber,e),0)}let c,l;o&&o.wordType===1&&o.start<n.column-1&&n.column-1<o.end?(c=o.start+1,l=o.end+1):h&&h.wordType===1&&h.start<n.column-1&&n.column-1<h.end?(c=h.start+1,l=h.end+1):(c=n.column,l=n.column);const a=n.lineNumber;let u;if(e.selectionStart.containsPosition(n))u=e.selectionStart.endColumn;else if(n.isBeforeOrEqual(e.selectionStart.getStartPosition())){u=c;const t=new ks(a,u);e.selectionStart.containsPosition(t)&&(u=e.selectionStart.endColumn)}else{u=l;const t=new ks(a,u);e.selectionStart.containsPosition(t)&&(u=e.selectionStart.startColumn)}return e.move(!0,a,u,0)}}class ax extends lx{static deleteWordPartLeft(t){const i=ux([lx.deleteWordLeft(t,0),lx.deleteWordLeft(t,2),lx._deleteWordPartLeft(t.model,t.selection)]);return i.sort(Cs.compareRangesUsingEnds),i[2]}static deleteWordPartRight(t){const i=ux([lx.deleteWordRight(t,0),lx.deleteWordRight(t,2),lx._deleteWordPartRight(t.model,t.selection)]);return i.sort(Cs.compareRangesUsingStarts),i[0]}static moveWordPartLeft(t,i,e){const s=ux([lx.moveWordLeft(t,i,e,0),lx.moveWordLeft(t,i,e,2),lx._moveWordPartLeft(i,e)]);return s.sort(ks.compare),s[2]}static moveWordPartRight(t,i,e){const s=ux([lx.moveWordRight(t,i,e,0),lx.moveWordRight(t,i,e,2),lx._moveWordPartRight(i,e)]);return s.sort(ks.compare),s[0]}}function ux(t){return t.filter((t=>!!t))}class dx{static addCursorDown(t,i,e){const s=[];let n=0;for(let r=0,o=i.length;r<o;r++){const o=i[r];s[n++]=new GS(o.modelState,o.viewState),s[n++]=e?GS.fromModelState(hx.translateDown(t.cursorConfig,t.model,o.modelState)):GS.fromViewState(hx.translateDown(t.cursorConfig,t,o.viewState))}return s}static addCursorUp(t,i,e){const s=[];let n=0;for(let r=0,o=i.length;r<o;r++){const o=i[r];s[n++]=new GS(o.modelState,o.viewState),s[n++]=e?GS.fromModelState(hx.translateUp(t.cursorConfig,t.model,o.modelState)):GS.fromViewState(hx.translateUp(t.cursorConfig,t,o.viewState))}return s}static moveToBeginningOfLine(t,i,e){const s=[];for(let n=0,r=i.length;n<r;n++){const r=i[n];s[n]=this._moveToLineStart(t,r,e)}return s}static _moveToLineStart(t,i,e){const s=i.viewState.position.column,n=s===i.modelState.position.column,r=i.viewState.position.lineNumber,o=t.getLineFirstNonWhitespaceColumn(r);return n||s===o?this._moveToLineStartByModel(t,i,e):this._moveToLineStartByView(t,i,e)}static _moveToLineStartByView(t,i,e){return GS.fromViewState(hx.moveToBeginningOfLine(t.cursorConfig,t,i.viewState,e))}static _moveToLineStartByModel(t,i,e){return GS.fromModelState(hx.moveToBeginningOfLine(t.cursorConfig,t.model,i.modelState,e))}static moveToEndOfLine(t,i,e,s){const n=[];for(let r=0,o=i.length;r<o;r++){const o=i[r];n[r]=this._moveToLineEnd(t,o,e,s)}return n}static _moveToLineEnd(t,i,e,s){const n=i.viewState.position,r=t.getLineMaxColumn(n.lineNumber),o=n.column===r,h=i.modelState.position,c=t.model.getLineMaxColumn(h.lineNumber),l=r-n.column==c-h.column;return o||l?this._moveToLineEndByModel(t,i,e,s):this._moveToLineEndByView(t,i,e,s)}static _moveToLineEndByView(t,i,e,s){return GS.fromViewState(hx.moveToEndOfLine(t.cursorConfig,t,i.viewState,e,s))}static _moveToLineEndByModel(t,i,e,s){return GS.fromModelState(hx.moveToEndOfLine(t.cursorConfig,t.model,i.modelState,e,s))}static expandLineSelection(t,i){const e=[];for(let s=0,n=i.length;s<n;s++){const n=i[s],r=n.modelState.selection.startLineNumber,o=t.model.getLineCount();let h,c=n.modelState.selection.endLineNumber;c===o?h=t.model.getLineMaxColumn(o):(c++,h=1),e[s]=GS.fromModelState(new QS(new Cs(r,1,r,1),0,0,new ks(c,h),0))}return e}static moveToBeginningOfBuffer(t,i,e){const s=[];for(let n=0,r=i.length;n<r;n++){const r=i[n];s[n]=GS.fromModelState(hx.moveToBeginningOfBuffer(t.cursorConfig,t.model,r.modelState,e))}return s}static moveToEndOfBuffer(t,i,e){const s=[];for(let n=0,r=i.length;n<r;n++){const r=i[n];s[n]=GS.fromModelState(hx.moveToEndOfBuffer(t.cursorConfig,t.model,r.modelState,e))}return s}static selectAll(t,i){const e=t.model.getLineCount(),s=t.model.getLineMaxColumn(e);return GS.fromModelState(new QS(new Cs(1,1,1,1),0,0,new ks(e,s),0))}static line(t,i,e,s,n){const r=t.model.validatePosition(s),o=n?t.coordinatesConverter.validateViewPosition(new ks(n.lineNumber,n.column),r):t.coordinatesConverter.convertModelPositionToViewPosition(r);if(!e){const i=t.model.getLineCount();let e=r.lineNumber+1,s=1;return e>i&&(e=i,s=t.model.getLineMaxColumn(e)),GS.fromModelState(new QS(new Cs(r.lineNumber,1,e,s),2,0,new ks(e,s),0))}const h=i.modelState.selectionStart.getStartPosition().lineNumber;if(r.lineNumber<h)return GS.fromViewState(i.viewState.move(!0,o.lineNumber,1,0));if(r.lineNumber>h){const e=t.getLineCount();let s=o.lineNumber+1,n=1;return s>e&&(s=e,n=t.getLineMaxColumn(s)),GS.fromViewState(i.viewState.move(!0,s,n,0))}{const t=i.modelState.selectionStart.getEndPosition();return GS.fromModelState(i.modelState.move(!0,t.lineNumber,t.column,0))}}static word(t,i,e,s){const n=t.model.validatePosition(s);return GS.fromModelState(lx.word(t.cursorConfig,t.model,i.modelState,e,n))}static cancelSelection(t,i){if(!i.modelState.hasSelection())return new GS(i.modelState,i.viewState);const e=i.viewState.position.lineNumber,s=i.viewState.position.column;return GS.fromViewState(new QS(new Cs(e,s,e,s),0,0,new ks(e,s),0))}static moveTo(t,i,e,s,n){if(e){if(i.modelState.selectionStartKind===1)return this.word(t,i,e,s);if(i.modelState.selectionStartKind===2)return this.line(t,i,e,s,n)}const r=t.model.validatePosition(s),o=n?t.coordinatesConverter.validateViewPosition(new ks(n.lineNumber,n.column),r):t.coordinatesConverter.convertModelPositionToViewPosition(r);return GS.fromViewState(i.viewState.move(e,o.lineNumber,o.column,0))}static simpleMove(t,i,e,s,n,r){switch(e){case 0:return r===4?this._moveHalfLineLeft(t,i,s):this._moveLeft(t,i,s,n);case 1:return r===4?this._moveHalfLineRight(t,i,s):this._moveRight(t,i,s,n);case 2:return r===2?this._moveUpByViewLines(t,i,s,n):this._moveUpByModelLines(t,i,s,n);case 3:return r===2?this._moveDownByViewLines(t,i,s,n):this._moveDownByModelLines(t,i,s,n);case 4:return r===2?i.map((i=>GS.fromViewState(hx.moveToPrevBlankLine(t.cursorConfig,t,i.viewState,s)))):i.map((i=>GS.fromModelState(hx.moveToPrevBlankLine(t.cursorConfig,t.model,i.modelState,s))));case 5:return r===2?i.map((i=>GS.fromViewState(hx.moveToNextBlankLine(t.cursorConfig,t,i.viewState,s)))):i.map((i=>GS.fromModelState(hx.moveToNextBlankLine(t.cursorConfig,t.model,i.modelState,s))));case 6:return this._moveToViewMinColumn(t,i,s);case 7:return this._moveToViewFirstNonWhitespaceColumn(t,i,s);case 8:return this._moveToViewCenterColumn(t,i,s);case 9:return this._moveToViewMaxColumn(t,i,s);case 10:return this._moveToViewLastNonWhitespaceColumn(t,i,s);default:return null}}static viewportMove(t,i,e,s,n){const r=t.getCompletelyVisibleViewRange(),o=t.coordinatesConverter.convertViewRangeToModelRange(r);switch(e){case 11:{const e=this._firstLineNumberInRange(t.model,o,n),r=t.model.getLineFirstNonWhitespaceColumn(e);return[this._moveToModelPosition(t,i[0],s,e,r)]}case 13:{const e=this._lastLineNumberInRange(t.model,o,n),r=t.model.getLineFirstNonWhitespaceColumn(e);return[this._moveToModelPosition(t,i[0],s,e,r)]}case 12:{const e=Math.round((o.startLineNumber+o.endLineNumber)/2),n=t.model.getLineFirstNonWhitespaceColumn(e);return[this._moveToModelPosition(t,i[0],s,e,n)]}case 14:{const e=[];for(let n=0,o=i.length;n<o;n++){const o=i[n];e[n]=this.findPositionInViewportIfOutside(t,o,r,s)}return e}default:return null}}static findPositionInViewportIfOutside(t,i,e,s){const n=i.viewState.position.lineNumber;if(e.startLineNumber<=n&&n<=e.endLineNumber-1)return new GS(i.modelState,i.viewState);{let r;r=n>e.endLineNumber-1?e.endLineNumber-1:n<e.startLineNumber?e.startLineNumber:n;const o=hx.vertical(t.cursorConfig,t,n,i.viewState.position.column,i.viewState.leftoverVisibleColumns,r,!1);return GS.fromViewState(i.viewState.move(s,o.lineNumber,o.column,o.leftoverVisibleColumns))}}static _firstLineNumberInRange(t,i,e){let s=i.startLineNumber;return i.startColumn!==t.getLineMinColumn(s)&&s++,Math.min(i.endLineNumber,s+e-1)}static _lastLineNumberInRange(t,i,e){let s=i.startLineNumber;return i.startColumn!==t.getLineMinColumn(s)&&s++,Math.max(s,i.endLineNumber-e+1)}static _moveLeft(t,i,e,s){return i.map((i=>GS.fromViewState(hx.moveLeft(t.cursorConfig,t,i.viewState,e,s))))}static _moveHalfLineLeft(t,i,e){const s=[];for(let n=0,r=i.length;n<r;n++){const r=i[n],o=r.viewState.position.lineNumber,h=Math.round(t.getLineLength(o)/2);s[n]=GS.fromViewState(hx.moveLeft(t.cursorConfig,t,r.viewState,e,h))}return s}static _moveRight(t,i,e,s){return i.map((i=>GS.fromViewState(hx.moveRight(t.cursorConfig,t,i.viewState,e,s))))}static _moveHalfLineRight(t,i,e){const s=[];for(let n=0,r=i.length;n<r;n++){const r=i[n],o=r.viewState.position.lineNumber,h=Math.round(t.getLineLength(o)/2);s[n]=GS.fromViewState(hx.moveRight(t.cursorConfig,t,r.viewState,e,h))}return s}static _moveDownByViewLines(t,i,e,s){const n=[];for(let r=0,o=i.length;r<o;r++){const o=i[r];n[r]=GS.fromViewState(hx.moveDown(t.cursorConfig,t,o.viewState,e,s))}return n}static _moveDownByModelLines(t,i,e,s){const n=[];for(let r=0,o=i.length;r<o;r++){const o=i[r];n[r]=GS.fromModelState(hx.moveDown(t.cursorConfig,t.model,o.modelState,e,s))}return n}static _moveUpByViewLines(t,i,e,s){const n=[];for(let r=0,o=i.length;r<o;r++){const o=i[r];n[r]=GS.fromViewState(hx.moveUp(t.cursorConfig,t,o.viewState,e,s))}return n}static _moveUpByModelLines(t,i,e,s){const n=[];for(let r=0,o=i.length;r<o;r++){const o=i[r];n[r]=GS.fromModelState(hx.moveUp(t.cursorConfig,t.model,o.modelState,e,s))}return n}static _moveToViewPosition(t,i,e,s,n){return GS.fromViewState(i.viewState.move(e,s,n,0))}static _moveToModelPosition(t,i,e,s,n){return GS.fromModelState(i.modelState.move(e,s,n,0))}static _moveToViewMinColumn(t,i,e){const s=[];for(let n=0,r=i.length;n<r;n++){const r=i[n],o=r.viewState.position.lineNumber,h=t.getLineMinColumn(o);s[n]=this._moveToViewPosition(t,r,e,o,h)}return s}static _moveToViewFirstNonWhitespaceColumn(t,i,e){const s=[];for(let n=0,r=i.length;n<r;n++){const r=i[n],o=r.viewState.position.lineNumber,h=t.getLineFirstNonWhitespaceColumn(o);s[n]=this._moveToViewPosition(t,r,e,o,h)}return s}static _moveToViewCenterColumn(t,i,e){const s=[];for(let n=0,r=i.length;n<r;n++){const r=i[n],o=r.viewState.position.lineNumber,h=Math.round((t.getLineMaxColumn(o)+t.getLineMinColumn(o))/2);s[n]=this._moveToViewPosition(t,r,e,o,h)}return s}static _moveToViewMaxColumn(t,i,e){const s=[];for(let n=0,r=i.length;n<r;n++){const r=i[n],o=r.viewState.position.lineNumber,h=t.getLineMaxColumn(o);s[n]=this._moveToViewPosition(t,r,e,o,h)}return s}static _moveToViewLastNonWhitespaceColumn(t,i,e){const s=[];for(let n=0,r=i.length;n<r;n++){const r=i[n],o=r.viewState.position.lineNumber,h=t.getLineLastNonWhitespaceColumn(o);s[n]=this._moveToViewPosition(t,r,e,o,h)}return s}}var fx;function gx(t,i,e,s){const n=ff(i,e.startLineNumber,e.startColumn),r=s.getLanguageConfiguration(n.languageId);if(!r)return null;const o=n.getLineContent(),h=o.substr(0,e.startColumn-1-n.firstCharOffset);let c;e.isEmpty()?c=o.substr(e.startColumn-1-n.firstCharOffset):c=ff(i,e.endLineNumber,e.endColumn).getLineContent().substr(e.endColumn-1-n.firstCharOffset);let l="";if(e.startLineNumber>1&&n.firstCharOffset===0){const t=ff(i,e.startLineNumber-1);t.languageId===n.languageId&&(l=t.getLineContent())}const a=r.onEnter(t,l,h,c);if(!a)return null;const u=a.indentAction;let d=a.appendText;const f=a.removeText||0;d?u===Uu.Indent&&(d="\t"+d):d=u===Uu.Indent||u===Uu.IndentOutdent?"\t":"";let g=df(i,e.startLineNumber,e.startColumn);return f&&(g=g.substring(0,g.length-f)),{indentAction:u,appendText:d,removeText:f,indentation:g}}(function(t){t.metadata={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:`Property-value pairs that can be passed through this argument:\n\t\t\t\t\t* 'to': A mandatory logical position value providing where to move the cursor.\n\t\t\t\t\t\t\`\`\`\n\t\t\t\t\t\t'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',\n\t\t\t\t\t\t'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'\n\t\t\t\t\t\t'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'\n\t\t\t\t\t\t'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'\n\t\t\t\t\t\t\`\`\`\n\t\t\t\t\t* 'by': Unit to move. Default is computed based on 'to' value.\n\t\t\t\t\t\t\`\`\`\n\t\t\t\t\t\t'line', 'wrappedLine', 'character', 'halfLine'\n\t\t\t\t\t\t\`\`\`\n\t\t\t\t\t* 'value': Number of units to move. Default is '1'.\n\t\t\t\t\t* 'select': If 'true' makes the selection. Default is 'false'.\n\t\t\t\t`,constraint:function(t){if(!O(t))return!1;const i=t;return!!R(i.to)&&!(!B(i.select)&&!N(i.select))&&!(!B(i.by)&&!R(i.by))&&!(!B(i.value)&&!_(i.value))},schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1}}}}]},t.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},t.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"},t.parse=function(i){if(!i.to)return null;let e;switch(i.to){case t.RawDirection.Left:e=0;break;case t.RawDirection.Right:e=1;break;case t.RawDirection.Up:e=2;break;case t.RawDirection.Down:e=3;break;case t.RawDirection.PrevBlankLine:e=4;break;case t.RawDirection.NextBlankLine:e=5;break;case t.RawDirection.WrappedLineStart:e=6;break;case t.RawDirection.WrappedLineFirstNonWhitespaceCharacter:e=7;break;case t.RawDirection.WrappedLineColumnCenter:e=8;break;case t.RawDirection.WrappedLineEnd:e=9;break;case t.RawDirection.WrappedLineLastNonWhitespaceCharacter:e=10;break;case t.RawDirection.ViewPortTop:e=11;break;case t.RawDirection.ViewPortBottom:e=13;break;case t.RawDirection.ViewPortCenter:e=12;break;case t.RawDirection.ViewPortIfOutside:e=14;break;default:return null}let s=0;switch(i.by){case t.RawUnit.Line:s=1;break;case t.RawUnit.WrappedLine:s=2;break;case t.RawUnit.Character:s=3;break;case t.RawUnit.HalfLine:s=4}return{direction:e,unit:s,select:!!i.select,value:i.value||1}}})(fx||(fx={}));var px,mx=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},wx=function(t,i){return function(e,s){i(e,s,t)}};const vx=Object.create(null);function bx(t,i){if(i<=0)return"";vx[t]||(vx[t]=["",t]);const e=vx[t];for(let s=e.length;s<=i;s++)e[s]=e[s-1]+t;return e[i]}let yx=px=class{static unshiftIndent(t,i,e,s,n){const r=Ck.visibleColumnFromColumn(t,i,e);if(n){const t=bx(" ",s);return bx(t,Ck.prevIndentTabStop(r,s)/s)}return bx("\t",Ck.prevRenderTabStop(r,e)/e)}static shiftIndent(t,i,e,s,n){const r=Ck.visibleColumnFromColumn(t,i,e);if(n){const t=bx(" ",s);return bx(t,Ck.nextIndentTabStop(r,s)/s)}return bx("\t",Ck.nextRenderTabStop(r,e)/e)}constructor(t,i,e){this._languageConfigurationService=e,this._opts=i,this._selection=t,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}_addEditOperation(t,i,e){this._useLastEditRangeForCursorEndPosition?t.addTrackedEditOperation(i,e):t.addEditOperation(i,e)}getEditOperations(t,i){const e=this._selection.startLineNumber;let s=this._selection.endLineNumber;this._selection.endColumn===1&&e!==s&&(s-=1);const{tabSize:n,indentSize:r,insertSpaces:o}=this._opts,h=e===s;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(t.getLineContent(e))&&(this._useLastEditRangeForCursorEndPosition=!0);let c=0,l=0;for(let a=e;a<=s;a++,c=l){l=0;const s=t.getLineContent(a);let u,d=tr(s);if((!this._opts.isUnshift||s.length!==0&&d!==0)&&(h||this._opts.isUnshift||s.length!==0)){if(d===-1&&(d=s.length),a>1&&Ck.visibleColumnFromColumn(s,d+1,n)%r!=0&&t.tokenization.isCheapToTokenize(a-1)){const i=gx(this._opts.autoIndent,t,new Cs(a-1,t.getLineMaxColumn(a-1),a-1,t.getLineMaxColumn(a-1)),this._languageConfigurationService);if(i){if(l=c,i.appendText)for(let t=0,e=i.appendText.length;t<e&&l<r&&i.appendText.charCodeAt(t)===32;t++)l++;i.removeText&&(l=Math.max(0,l-i.removeText));for(let t=0;t<l&&d!==0&&s.charCodeAt(d-1)===32;t++)d--}}this._opts.isUnshift&&d===0||(u=this._opts.isUnshift?px.unshiftIndent(s,d+1,n,r,o):px.shiftIndent(s,d+1,n,r,o),this._addEditOperation(i,new Cs(a,1,a,d+1),u),a!==e||this._selection.isEmpty()||(this._selectionStartColumnStaysPut=this._selection.startColumn<=d+1))}}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&t.getLineLength(e)===0&&(this._useLastEditRangeForCursorEndPosition=!0);const n=o?bx(" ",r):"\t";for(let o=e;o<=s;o++){const s=t.getLineContent(o);let c=tr(s);if((!this._opts.isUnshift||s.length!==0&&c!==0)&&(h||this._opts.isUnshift||s.length!==0)&&(c===-1&&(c=s.length),!this._opts.isUnshift||c!==0))if(this._opts.isUnshift){c=Math.min(c,r);for(let t=0;t<c;t++)if(s.charCodeAt(t)===9){c=t+1;break}this._addEditOperation(i,new Cs(o,1,o,c+1),"")}else this._addEditOperation(i,new Cs(o,1,o,1),n),o!==e||this._selection.isEmpty()||(this._selectionStartColumnStaysPut=this._selection.startColumn===1)}}this._selectionId=i.trackSelection(this._selection)}computeCursorState(t,i){if(this._useLastEditRangeForCursorEndPosition){const t=i.getInverseEditOperations()[0];return new Ss(t.range.endLineNumber,t.range.endColumn,t.range.endLineNumber,t.range.endColumn)}const e=i.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){const t=this._selection.startColumn;return e.startColumn<=t?e:e.getDirection()===0?new Ss(e.startLineNumber,t,e.endLineNumber,e.endColumn):new Ss(e.endLineNumber,e.endColumn,e.startLineNumber,t)}return e}};yx=px=mx([wx(2,cf)],yx);class kx{constructor(t,i,e){this._range=t,this._charBeforeSelection=i,this._charAfterSelection=e}getEditOperations(t,i){i.addTrackedEditOperation(new Cs(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),i.addTrackedEditOperation(new Cs(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(t,i){const e=i.getInverseEditOperations(),s=e[0].range,n=e[1].range;return new Ss(s.endLineNumber,s.endColumn,n.endLineNumber,n.endColumn-this._charAfterSelection.length)}}class Cx{constructor(t,i,e){this._position=t,this._text=i,this._charAfter=e}getEditOperations(t,i){i.addTrackedEditOperation(new Cs(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column),this._text+this._charAfter)}computeCursorState(t,i){const e=i.getInverseEditOperations()[0].range;return new Ss(e.endLineNumber,e.startColumn,e.endLineNumber,e.endColumn-this._charAfter.length)}}function Sx(t,i,e,s=!0,n){if(t<4)return null;const r=n.getLanguageConfiguration(i.tokenization.getLanguageId()).indentRulesSupport;if(!r)return null;if(e<=1)return{indentation:"",action:null};for(let t=e-1;t>0&&i.getLineContent(t)==="";t--)if(t===1)return{indentation:"",action:null};const o=function(t,i,e){const s=t.tokenization.getLanguageIdAtPosition(i,0);if(i>1){let n,r=-1;for(n=i-1;n>=1;n--){if(t.tokenization.getLanguageIdAtPosition(n,0)!==s)return r;const i=t.getLineContent(n);if(!e.shouldIgnore(i)&&!/^\s+$/.test(i)&&i!=="")return n;r=n}}return-1}(i,e,r);if(o<0)return null;if(o<1)return{indentation:"",action:null};const h=i.getLineContent(o);if(r.shouldIncrease(h)||r.shouldIndentNextLine(h))return{indentation:ir(h),action:Uu.Indent,line:o};if(r.shouldDecrease(h))return{indentation:ir(h),action:null,line:o};{if(o===1)return{indentation:ir(i.getLineContent(o)),action:null,line:o};const t=o-1,e=r.getIndentMetadata(i.getLineContent(t));if(!(3&e)&&4&e){let e=0;for(let s=t-1;s>0;s--)if(!r.shouldIndentNextLine(i.getLineContent(s))){e=s;break}return{indentation:ir(i.getLineContent(e+1)),action:null,line:e+1}}if(s)return{indentation:ir(i.getLineContent(o)),action:null,line:o};for(let t=o;t>0;t--){const e=i.getLineContent(t);if(r.shouldIncrease(e))return{indentation:ir(e),action:Uu.Indent,line:t};if(r.shouldIndentNextLine(e)){let e=0;for(let s=t-1;s>0;s--)if(!r.shouldIndentNextLine(i.getLineContent(t))){e=s;break}return{indentation:ir(i.getLineContent(e+1)),action:null,line:e+1}}if(r.shouldDecrease(e))return{indentation:ir(e),action:null,line:t}}return{indentation:ir(i.getLineContent(1)),action:null,line:1}}}function xx(t,i,e,s,n,r){if(t<4)return null;const o=r.getLanguageConfiguration(e);if(!o)return null;const h=r.getLanguageConfiguration(e).indentRulesSupport;if(!h)return null;const c=Sx(t,i,s,void 0,r),l=i.getLineContent(s);if(c){const e=c.line;if(e!==void 0){let r=!0;for(let t=e;t<s-1;t++)if(!/^\s*$/.test(i.getLineContent(t))){r=!1;break}if(r){const s=o.onEnter(t,"",i.getLineContent(e),"");if(s){let t=ir(i.getLineContent(e));return s.removeText&&(t=t.substring(0,t.length-s.removeText)),s.indentAction===Uu.Indent||s.indentAction===Uu.IndentOutdent?t=n.shiftIndent(t):s.indentAction===Uu.Outdent&&(t=n.unshiftIndent(t)),h.shouldDecrease(l)&&(t=n.unshiftIndent(t)),s.appendText&&(t+=s.appendText),ir(t)}}}return h.shouldDecrease(l)?c.action===Uu.Indent?c.indentation:n.unshiftIndent(c.indentation):c.action===Uu.Indent?n.shiftIndent(c.indentation):c.indentation}return null}function Dx(t,i,e){const s=e.getLanguageConfiguration(t.getLanguageId()).indentRulesSupport;return s?i<1||i>t.getLineCount()?null:s.getIndentMetadata(t.getLineContent(i)):null}class Ex{static indent(t,i,e){if(i===null||e===null)return[];const s=[];for(let i=0,n=e.length;i<n;i++)s[i]=new yx(e[i],{isUnshift:!1,tabSize:t.tabSize,indentSize:t.indentSize,insertSpaces:t.insertSpaces,useTabStops:t.useTabStops,autoIndent:t.autoIndent},t.languageConfigurationService);return s}static outdent(t,i,e){const s=[];for(let i=0,n=e.length;i<n;i++)s[i]=new yx(e[i],{isUnshift:!0,tabSize:t.tabSize,indentSize:t.indentSize,insertSpaces:t.insertSpaces,useTabStops:t.useTabStops,autoIndent:t.autoIndent},t.languageConfigurationService);return s}static shiftIndent(t,i,e){return e=e||1,yx.shiftIndent(i,i.length+e,t.tabSize,t.indentSize,t.insertSpaces)}static unshiftIndent(t,i,e){return e=e||1,yx.unshiftIndent(i,i.length+e,t.tabSize,t.indentSize,t.insertSpaces)}static _distributedPaste(t,i,e,s){const n=[];for(let t=0,i=e.length;t<i;t++)n[t]=new ix(e[t],s[t]);return new YS(0,n,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(t,i,e,s,n){const r=[];for(let t=0,i=e.length;t<i;t++){const i=e[t],o=i.getPosition();if(n&&!i.isEmpty()&&(n=!1),n&&s.indexOf(`\n`)!==s.length-1&&(n=!1),n){const e=new Cs(o.lineNumber,1,o.lineNumber,1);r[t]=new rx(e,s,i,!0)}else r[t]=new ix(i,s)}return new YS(0,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _distributePasteToCursors(t,i,e,s,n){if(s||i.length===1)return null;if(n&&n.length===i.length)return n;if(t.multiCursorPaste==="spread"){e.charCodeAt(e.length-1)===10&&(e=e.substr(0,e.length-1)),e.charCodeAt(e.length-1)===13&&(e=e.substr(0,e.length-1));const t=Xn(e);if(t.length===i.length)return t}return null}static paste(t,i,e,s,n,r){const o=this._distributePasteToCursors(t,e,s,n,r);return o?(e=e.sort(Cs.compareRangesUsingStarts),this._distributedPaste(t,i,e,o)):this._simplePaste(t,i,e,s,n)}static _goodIndentForLine(t,i,e){let s=null,n="";const r=Sx(t.autoIndent,i,e,!1,t.languageConfigurationService);if(r)s=r.action,n=r.indentation;else if(e>1){let s;for(s=e-1;s>=1&&!(er(i.getLineContent(s))>=0);s--);if(s<1)return null;const r=i.getLineMaxColumn(s),o=gx(t.autoIndent,i,new Cs(s,r,s,r),t.languageConfigurationService);o&&(n=o.indentation+o.appendText)}return s&&(s===Uu.Indent&&(n=Ex.shiftIndent(t,n)),s===Uu.Outdent&&(n=Ex.unshiftIndent(t,n)),n=t.normalizeIndentation(n)),n||null}static _replaceJumpToNextIndent(t,i,e,s){let n="";const r=e.getStartPosition();if(t.insertSpaces){const e=t.visibleColumnFromColumn(i,r),s=t.indentSize,o=s-e%s;for(let t=0;t<o;t++)n+=" "}else n="\t";return new ix(e,n,s)}static tab(t,i,e){const s=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.isEmpty()){const e=i.getLineContent(r.startLineNumber);if(/^\s*$/.test(e)&&i.tokenization.isCheapToTokenize(r.startLineNumber)){let o=this._goodIndentForLine(t,i,r.startLineNumber);o=o||"\t";const h=t.normalizeIndentation(o);if(!e.startsWith(h)){s[n]=new ix(new Cs(r.startLineNumber,1,r.startLineNumber,e.length+1),h,!0);continue}}s[n]=this._replaceJumpToNextIndent(t,i,r,!0)}else{if(r.startLineNumber===r.endLineNumber){const e=i.getLineMaxColumn(r.startLineNumber);if(r.startColumn!==1||r.endColumn!==e){s[n]=this._replaceJumpToNextIndent(t,i,r,!1);continue}}s[n]=new yx(r,{isUnshift:!1,tabSize:t.tabSize,indentSize:t.indentSize,insertSpaces:t.insertSpaces,useTabStops:t.useTabStops,autoIndent:t.autoIndent},t.languageConfigurationService)}}return s}static compositionType(t,i,e,s,n,r,o,h){const c=s.map((t=>this._compositionType(e,t,n,r,o,h)));return new YS(4,c,{shouldPushStackElementBefore:Fx(t,4),shouldPushStackElementAfter:!1})}static _compositionType(t,i,e,s,n,r){if(!i.isEmpty())return null;const o=i.getPosition(),h=Math.max(1,o.column-s),c=Math.min(t.getLineMaxColumn(o.lineNumber),o.column+n),l=new Cs(o.lineNumber,h,o.lineNumber,c);return t.getValueInRange(l)===e&&r===0?null:new nx(l,e,0,r)}static _typeCommand(t,i,e){return e?new sx(t,i,!0):new ix(t,i,!0)}static _enter(t,i,e,s){if(t.autoIndent===0)return Ex._typeCommand(s,`\n`,e);if(!i.tokenization.isCheapToTokenize(s.getStartPosition().lineNumber)||t.autoIndent===1){const n=ir(i.getLineContent(s.startLineNumber)).substring(0,s.startColumn-1);return Ex._typeCommand(s,`\n`+t.normalizeIndentation(n),e)}const n=gx(t.autoIndent,i,s,t.languageConfigurationService);if(n){if(n.indentAction===Uu.None||n.indentAction===Uu.Indent)return Ex._typeCommand(s,`\n`+t.normalizeIndentation(n.indentation+n.appendText),e);if(n.indentAction===Uu.IndentOutdent){const i=t.normalizeIndentation(n.indentation),r=t.normalizeIndentation(n.indentation+n.appendText),o=`\n`+r+`\n`+i;return e?new sx(s,o,!0):new nx(s,o,-1,r.length-i.length,!0)}if(n.indentAction===Uu.Outdent){const i=Ex.unshiftIndent(t,n.indentation);return Ex._typeCommand(s,`\n`+t.normalizeIndentation(i+n.appendText),e)}}const r=ir(i.getLineContent(s.startLineNumber)).substring(0,s.startColumn-1);if(t.autoIndent>=4){const n=function(t,i,e,s,n){if(t<4)return null;i.tokenization.forceTokenization(e.startLineNumber);const r=i.tokenization.getLineTokens(e.startLineNumber),o=Zu(r,e.startColumn-1),h=o.getLineContent();let c,l,a=!1;o.firstCharOffset>0&&r.getLanguageId(0)!==o.languageId?(a=!0,c=h.substr(0,e.startColumn-1-o.firstCharOffset)):c=r.getLineContent().substring(0,e.startColumn-1),l=e.isEmpty()?h.substr(e.startColumn-1-o.firstCharOffset):ff(i,e.endLineNumber,e.endColumn).getLineContent().substr(e.endColumn-1-o.firstCharOffset);const u=n.getLanguageConfiguration(o.languageId).indentRulesSupport;if(!u)return null;const d=c,f=ir(c),g={tokenization:{getLineTokens:t=>i.tokenization.getLineTokens(t),getLanguageId:()=>i.getLanguageId(),getLanguageIdAtPosition:(t,e)=>i.getLanguageIdAtPosition(t,e)},getLineContent:t=>t===e.startLineNumber?d:i.getLineContent(t)},p=ir(r.getLineContent()),m=Sx(t,g,e.startLineNumber+1,void 0,n);if(!m){const t=a?p:f;return{beforeEnter:t,afterEnter:t}}let w=a?p:m.indentation;return m.action===Uu.Indent&&(w=s.shiftIndent(w)),u.shouldDecrease(l)&&(w=s.unshiftIndent(w)),{beforeEnter:a?p:f,afterEnter:w}}(t.autoIndent,i,s,{unshiftIndent:i=>Ex.unshiftIndent(t,i),shiftIndent:i=>Ex.shiftIndent(t,i),normalizeIndentation:i=>t.normalizeIndentation(i)},t.languageConfigurationService);if(n){let r=t.visibleColumnFromColumn(i,s.getEndPosition());const o=s.endColumn,h=tr(i.getLineContent(s.endLineNumber));if(s=h>=0?s.setEndPosition(s.endLineNumber,Math.max(s.endColumn,h+1)):s.setEndPosition(s.endLineNumber,i.getLineMaxColumn(s.endLineNumber)),e)return new sx(s,`\n`+t.normalizeIndentation(n.afterEnter),!0);{let i=0;return o<=h+1&&(t.insertSpaces||(r=Math.ceil(r/t.indentSize)),i=Math.min(r+1-t.normalizeIndentation(n.afterEnter).length-1,0)),new nx(s,`\n`+t.normalizeIndentation(n.afterEnter),0,i,!0)}}}return Ex._typeCommand(s,`\n`+t.normalizeIndentation(r),e)}static _isAutoIndentType(t,i,e){if(t.autoIndent<4)return!1;for(let t=0,s=e.length;t<s;t++)if(!i.tokenization.isCheapToTokenize(e[t].getEndPosition().lineNumber))return!1;return!0}static _runAutoIndentType(t,i,e,s){const n=df(i,e.startLineNumber,e.startColumn),r=function(t,i,e,s,n,r){if(t<4)return null;const o=ff(i,e.startLineNumber,e.startColumn);if(o.firstCharOffset)return null;const h=r.getLanguageConfiguration(o.languageId).indentRulesSupport;if(!h)return null;const c=o.getLineContent(),l=c.substr(0,e.startColumn-1-o.firstCharOffset);let a;if(a=e.isEmpty()?c.substr(e.startColumn-1-o.firstCharOffset):ff(i,e.endLineNumber,e.endColumn).getLineContent().substr(e.endColumn-1-o.firstCharOffset),!h.shouldDecrease(l+a)&&h.shouldDecrease(l+s+a)){const s=Sx(t,i,e.startLineNumber,!1,r);if(!s)return null;let o=s.indentation;return s.action!==Uu.Indent&&(o=n.unshiftIndent(o)),o}return null}(t.autoIndent,i,e,s,{shiftIndent:i=>Ex.shiftIndent(t,i),unshiftIndent:i=>Ex.unshiftIndent(t,i)},t.languageConfigurationService);if(r===null)return null;if(r!==t.normalizeIndentation(n)){const n=i.getLineFirstNonWhitespaceColumn(e.startLineNumber);return n===0?Ex._typeCommand(new Cs(e.startLineNumber,1,e.endLineNumber,e.endColumn),t.normalizeIndentation(r)+s,!1):Ex._typeCommand(new Cs(e.startLineNumber,1,e.endLineNumber,e.endColumn),t.normalizeIndentation(r)+i.getLineContent(e.startLineNumber).substring(n-1,e.startColumn-1)+s,!1)}return null}static _isAutoClosingOvertype(t,i,e,s,n){if(t.autoClosingOvertype==="never"||!t.autoClosingPairs.autoClosingPairsCloseSingleChar.has(n))return!1;for(let r=0,o=e.length;r<o;r++){const o=e[r];if(!o.isEmpty())return!1;const h=o.getPosition(),c=i.getLineContent(h.lineNumber);if(c.charAt(h.column-1)!==n)return!1;const l=XS(n);if((h.column>2?c.charCodeAt(h.column-2):0)===92&&l)return!1;if(t.autoClosingOvertype==="auto"){let t=!1;for(let i=0,e=s.length;i<e;i++){const e=s[i];if(h.lineNumber===e.startLineNumber&&h.column===e.startColumn){t=!0;break}}if(!t)return!1}}return!0}static _runAutoClosingOvertype(t,i,e,s,n){const r=[];for(let t=0,i=s.length;t<i;t++){const i=s[t].getPosition(),e=new Cs(i.lineNumber,i.column,i.lineNumber,i.column+1);r[t]=new ix(e,n)}return new YS(4,r,{shouldPushStackElementBefore:Fx(t,4),shouldPushStackElementAfter:!1})}static _isBeforeClosingBrace(t,i){const e=i.charAt(0),s=t.autoClosingPairs.autoClosingPairsOpenByStart.get(e)||[],n=t.autoClosingPairs.autoClosingPairsCloseByStart.get(e)||[],r=s.some((t=>i.startsWith(t.open))),o=n.some((t=>i.startsWith(t.close)));return!r&&o}static _findAutoClosingPairOpen(t,i,e,s){const n=t.autoClosingPairs.autoClosingPairsOpenByEnd.get(s);if(!n)return null;let r=null;for(const t of n)if(r===null||t.open.length>r.open.length){let n=!0;for(const r of e)if(i.getValueInRange(new Cs(r.lineNumber,r.column-t.open.length+1,r.lineNumber,r.column))+s!==t.open){n=!1;break}n&&(r=t)}return r}static _findContainedAutoClosingPair(t,i){if(i.open.length<=1)return null;const e=i.close.charAt(i.close.length-1),s=t.autoClosingPairs.autoClosingPairsCloseByEnd.get(e)||[];let n=null;for(const t of s)t.open!==i.open&&i.open.includes(t.open)&&i.close.endsWith(t.close)&&(!n||t.open.length>n.open.length)&&(n=t);return n}static _getAutoClosingPairClose(t,i,e,s,n){for(const t of e)if(!t.isEmpty())return null;const r=e.map((t=>{const i=t.getPosition();return n?{lineNumber:i.lineNumber,beforeColumn:i.column-s.length,afterColumn:i.column}:{lineNumber:i.lineNumber,beforeColumn:i.column,afterColumn:i.column}})),o=this._findAutoClosingPairOpen(t,i,r.map((t=>new ks(t.lineNumber,t.beforeColumn))),s);if(!o)return null;let h,c;if(XS(s)?(h=t.autoClosingQuotes,c=t.shouldAutoCloseBefore.quote):t.blockCommentStartToken&&o.open.includes(t.blockCommentStartToken)?(h=t.autoClosingComments,c=t.shouldAutoCloseBefore.comment):(h=t.autoClosingBrackets,c=t.shouldAutoCloseBefore.bracket),h==="never")return null;const l=this._findContainedAutoClosingPair(t,o),a=l?l.close:"";let u=!0;for(const e of r){const{lineNumber:n,beforeColumn:r,afterColumn:l}=e,d=i.getLineContent(n),f=d.substring(0,r-1),g=d.substring(l-1);if(g.startsWith(a)||(u=!1),g.length>0){const i=g.charAt(0);if(!Ex._isBeforeClosingBrace(t,g)&&!c(i))return null}if(o.open.length===1&&(s==="'"||s==='"')&&h!=="always"){const i=Qf(t.wordSeparators,[]);if(f.length>0){const t=f.charCodeAt(f.length-1);if(i.get(t)===0)return null}}if(!i.tokenization.isCheapToTokenize(n))return null;i.tokenization.forceTokenization(n);const p=Zu(i.tokenization.getLineTokens(n),r-1);if(!o.shouldAutoClose(p,r-p.firstCharOffset))return null;const m=o.findNeutralCharacter();if(m){const t=i.tokenization.getTokenTypeIfInsertingCharacter(n,r,m);if(!o.isOK(t))return null}}return u?o.close.substring(0,o.close.length-a.length):o.close}static _runAutoClosingOpenCharType(t,i,e,s,n,r,o){const h=[];for(let t=0,i=s.length;t<i;t++){const i=s[t];h[t]=new Ax(i,n,!r,o)}return new YS(4,h,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static _shouldSurroundChar(t,i){return XS(i)?t.autoSurround==="quotes"||t.autoSurround==="languageDefined":t.autoSurround==="brackets"||t.autoSurround==="languageDefined"}static _isSurroundSelectionType(t,i,e,s){if(!Ex._shouldSurroundChar(t,s)||!t.surroundingPairs.hasOwnProperty(s))return!1;const n=XS(s);for(const t of e){if(t.isEmpty())return!1;let e=!0;for(let s=t.startLineNumber;s<=t.endLineNumber;s++){const n=i.getLineContent(s),r=s===t.startLineNumber?t.startColumn-1:0,o=s===t.endLineNumber?t.endColumn-1:n.length,h=n.substring(r,o);if(/[^ \t]/.test(h)){e=!1;break}}if(e||n&&t.startLineNumber===t.endLineNumber&&t.startColumn+1===t.endColumn&&XS(i.getValueInRange(t)))return!1}return!0}static _runSurroundSelectionType(t,i,e,s,n){const r=[];for(let t=0,e=s.length;t<e;t++){const e=s[t],o=i.surroundingPairs[n];r[t]=new kx(e,n,o)}return new YS(0,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isTypeInterceptorElectricChar(t,i,e){return!(e.length!==1||!i.tokenization.isCheapToTokenize(e[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(t,i,e,s,n){if(!i.electricChars.hasOwnProperty(n)||!s.isEmpty())return null;const r=s.getPosition();e.tokenization.forceTokenization(r.lineNumber);const o=e.tokenization.getLineTokens(r.lineNumber);let h;try{h=i.onElectricCharacter(n,o,r.column)}catch(t){return Ii(t),null}if(!h)return null;if(h.matchOpenBracket){const s=(o.getLineContent()+n).lastIndexOf(h.matchOpenBracket)+1,c=e.bracketPairs.findMatchingBracketUp(h.matchOpenBracket,{lineNumber:r.lineNumber,column:s},500);if(c){if(c.startLineNumber===r.lineNumber)return null;const s=ir(e.getLineContent(c.startLineNumber)),o=i.normalizeIndentation(s),h=e.getLineContent(r.lineNumber),l=e.getLineFirstNonWhitespaceColumn(r.lineNumber)||r.column,a=o+h.substring(l-1,r.column-1)+n,u=new Cs(r.lineNumber,1,r.lineNumber,r.column),d=new ix(u,a);return new YS(Lx(a,t),[d],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}static compositionEndWithInterceptors(t,i,e,s,n,r){if(!s)return null;let o=null;for(const t of s)if(o===null)o=t.insertedText;else if(o!==t.insertedText)return null;if(!o||o.length!==1)return null;const h=o;let c=!1;for(const t of s)if(t.deletedText.length!==0){c=!0;break}if(c){if(!Ex._shouldSurroundChar(i,h)||!i.surroundingPairs.hasOwnProperty(h))return null;const t=XS(h);for(const i of s)if(i.deletedSelectionStart!==0||i.deletedSelectionEnd!==i.deletedText.length||/^[ \t]+$/.test(i.deletedText)||t&&XS(i.deletedText))return null;const e=[];for(const t of n){if(!t.isEmpty())return null;e.push(t.getPosition())}if(e.length!==s.length)return null;const r=[];for(let t=0,n=e.length;t<n;t++)r.push(new Cx(e[t],s[t].deletedText,i.surroundingPairs[h]));return new YS(4,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(this._isAutoClosingOvertype(i,e,n,r,h)){const t=n.map((t=>new ix(new Cs(t.positionLineNumber,t.positionColumn,t.positionLineNumber,t.positionColumn+1),"",!1)));return new YS(4,t,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}const l=this._getAutoClosingPairClose(i,e,n,h,!0);return l!==null?this._runAutoClosingOpenCharType(t,i,e,n,h,!0,l):null}static typeWithInterceptors(t,i,e,s,n,r,o){if(!t&&o===`\n`){const t=[];for(let i=0,r=n.length;i<r;i++)t[i]=Ex._enter(e,s,!1,n[i]);return new YS(4,t,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(!t&&this._isAutoIndentType(e,s,n)){const t=[];let i=!1;for(let r=0,h=n.length;r<h;r++)if(t[r]=this._runAutoIndentType(e,s,n[r],o),!t[r]){i=!0;break}if(!i)return new YS(4,t,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(this._isAutoClosingOvertype(e,s,n,r,o))return this._runAutoClosingOvertype(i,e,s,n,o);if(!t){const t=this._getAutoClosingPairClose(e,s,n,o,!1);if(t)return this._runAutoClosingOpenCharType(i,e,s,n,o,!1,t)}if(!t&&this._isSurroundSelectionType(e,s,n,o))return this._runSurroundSelectionType(i,e,s,n,o);if(!t&&this._isTypeInterceptorElectricChar(e,s,n)){const t=this._typeInterceptorElectricChar(i,e,s,n[0],o);if(t)return t}const h=[];for(let t=0,i=n.length;t<i;t++)h[t]=new ix(n[t],o);const c=Lx(o,i);return new YS(c,h,{shouldPushStackElementBefore:Fx(i,c),shouldPushStackElementAfter:!1})}static typeWithoutInterceptors(t,i,e,s,n){const r=[];for(let t=0,i=s.length;t<i;t++)r[t]=new ix(s[t],n);const o=Lx(n,t);return new YS(o,r,{shouldPushStackElementBefore:Fx(t,o),shouldPushStackElementAfter:!1})}static lineInsertBefore(t,i,e){if(i===null||e===null)return[];const s=[];for(let n=0,r=e.length;n<r;n++){let r=e[n].positionLineNumber;if(r===1)s[n]=new sx(new Cs(1,1,1,1),`\n`);else{r--;const e=i.getLineMaxColumn(r);s[n]=this._enter(t,i,!1,new Cs(r,e,r,e))}}return s}static lineInsertAfter(t,i,e){if(i===null||e===null)return[];const s=[];for(let n=0,r=e.length;n<r;n++){const r=e[n].positionLineNumber,o=i.getLineMaxColumn(r);s[n]=this._enter(t,i,!1,new Cs(r,o,r,o))}return s}static lineBreakInsert(t,i,e){const s=[];for(let n=0,r=e.length;n<r;n++)s[n]=this._enter(t,i,!0,e[n]);return s}}class Ax extends nx{constructor(t,i,e,s){super(t,(e?i:"")+s,0,-s.length),this._openCharacter=i,this._closeCharacter=s,this.closeCharacterRange=null,this.enclosingRange=null}computeCursorState(t,i){const e=i.getInverseEditOperations()[0].range;return this.closeCharacterRange=new Cs(e.startLineNumber,e.endColumn-this._closeCharacter.length,e.endLineNumber,e.endColumn),this.enclosingRange=new Cs(e.startLineNumber,e.endColumn-this._openCharacter.length-this._closeCharacter.length,e.endLineNumber,e.endColumn),super.computeCursorState(t,i)}}class Mx{constructor(t,i,e,s,n,r){this.deletedText=t,this.deletedSelectionStart=i,this.deletedSelectionEnd=e,this.insertedText=s,this.insertedSelectionStart=n,this.insertedSelectionEnd=r}}function Lx(t,i){return t===" "?i===5||i===6?6:5:4}function Fx(t,i){return!(!Rx(t)||Rx(i))||t!==5&&Tx(t)!==Tx(i)}function Tx(t){return t===6||t===5?"space":t}function Rx(t){return t===4||t===5||t===6}var Ox;(function(t){t.editorSimpleInput=new Ta("editorSimpleInput",!1,!0),t.editorTextFocus=new Ta("editorTextFocus",!1,tt(0,"Whether the editor text has focus (cursor is blinking)")),t.focus=new Ta("editorFocus",!1,tt(0,"Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),t.textInputFocus=new Ta("textInputFocus",!1,tt(0,"Whether an editor or a rich text input has focus (cursor is blinking)")),t.readOnly=new Ta("editorReadonly",!1,tt(0,"Whether the editor is read-only")),t.inDiffEditor=new Ta("inDiffEditor",!1,tt(0,"Whether the context is a diff editor")),t.isEmbeddedDiffEditor=new Ta("isEmbeddedDiffEditor",!1,tt(0,"Whether the context is an embedded diff editor")),t.inMultiDiffEditor=new Ta("inMultiDiffEditor",!1,tt(0,"Whether the context is a multi diff editor")),t.multiDiffEditorAllCollapsed=new Ta("multiDiffEditorAllCollapsed",void 0,tt(0,"Whether all files in multi diff editor are collapsed")),t.hasChanges=new Ta("diffEditorHasChanges",!1,tt(0,"Whether the diff editor has changes")),t.comparingMovedCode=new Ta("comparingMovedCode",!1,tt(0,"Whether a moved code block is selected for comparison")),t.accessibleDiffViewerVisible=new Ta("accessibleDiffViewerVisible",!1,tt(0,"Whether the accessible diff viewer is visible")),t.diffEditorRenderSideBySideInlineBreakpointReached=new Ta("diffEditorRenderSideBySideInlineBreakpointReached",!1,tt(0,"Whether the diff editor render side by side inline breakpoint is reached")),t.diffEditorInlineMode=new Ta("diffEditorInlineMode",!1,tt(0,"Whether inline mode is active")),t.diffEditorOriginalWritable=new Ta("diffEditorOriginalWritable",!1,tt(0,"Whether modified is writable in the diff editor")),t.diffEditorModifiedWritable=new Ta("diffEditorModifiedWritable",!1,tt(0,"Whether modified is writable in the diff editor")),t.diffEditorOriginalUri=new Ta("diffEditorOriginalUri","",tt(0,"The uri of the original document")),t.diffEditorModifiedUri=new Ta("diffEditorModifiedUri","",tt(0,"The uri of the modified document")),t.columnSelection=new Ta("editorColumnSelection",!1,tt(0,"Whether `editor.columnSelection` is enabled")),t.writable=t.readOnly.toNegated(),t.hasNonEmptySelection=new Ta("editorHasSelection",!1,tt(0,"Whether the editor has text selected")),t.hasOnlyEmptySelection=t.hasNonEmptySelection.toNegated(),t.hasMultipleSelections=new Ta("editorHasMultipleSelections",!1,tt(0,"Whether the editor has multiple selections")),t.hasSingleSelection=t.hasMultipleSelections.toNegated(),t.tabMovesFocus=new Ta("editorTabMovesFocus",!1,tt(0,"Whether `Tab` will move focus out of the editor")),t.tabDoesNotMoveFocus=t.tabMovesFocus.toNegated(),t.isInEmbeddedEditor=new Ta("isInEmbeddedEditor",!1,!0),t.canUndo=new Ta("canUndo",!1,!0),t.canRedo=new Ta("canRedo",!1,!0),t.hoverVisible=new Ta("editorHoverVisible",!1,tt(0,"Whether the editor hover is visible")),t.hoverFocused=new Ta("editorHoverFocused",!1,tt(0,"Whether the editor hover is focused")),t.stickyScrollFocused=new Ta("stickyScrollFocused",!1,tt(0,"Whether the sticky scroll is focused")),t.stickyScrollVisible=new Ta("stickyScrollVisible",!1,tt(0,"Whether the sticky scroll is visible")),t.standaloneColorPickerVisible=new Ta("standaloneColorPickerVisible",!1,tt(0,"Whether the standalone color picker is visible")),t.standaloneColorPickerFocused=new Ta("standaloneColorPickerFocused",!1,tt(0,"Whether the standalone color picker is focused")),t.inCompositeEditor=new Ta("inCompositeEditor",void 0,tt(0,"Whether the editor is part of a larger editor (e.g. notebooks)")),t.notInCompositeEditor=t.inCompositeEditor.toNegated(),t.languageId=new Ta("editorLangId","",tt(0,"The language identifier of the editor")),t.hasCompletionItemProvider=new Ta("editorHasCompletionItemProvider",!1,tt(0,"Whether the editor has a completion item provider")),t.hasCodeActionsProvider=new Ta("editorHasCodeActionsProvider",!1,tt(0,"Whether the editor has a code actions provider")),t.hasCodeLensProvider=new Ta("editorHasCodeLensProvider",!1,tt(0,"Whether the editor has a code lens provider")),t.hasDefinitionProvider=new Ta("editorHasDefinitionProvider",!1,tt(0,"Whether the editor has a definition provider")),t.hasDeclarationProvider=new Ta("editorHasDeclarationProvider",!1,tt(0,"Whether the editor has a declaration provider")),t.hasImplementationProvider=new Ta("editorHasImplementationProvider",!1,tt(0,"Whether the editor has an implementation provider")),t.hasTypeDefinitionProvider=new Ta("editorHasTypeDefinitionProvider",!1,tt(0,"Whether the editor has a type definition provider")),t.hasHoverProvider=new Ta("editorHasHoverProvider",!1,tt(0,"Whether the editor has a hover provider")),t.hasDocumentHighlightProvider=new Ta("editorHasDocumentHighlightProvider",!1,tt(0,"Whether the editor has a document highlight provider")),t.hasDocumentSymbolProvider=new Ta("editorHasDocumentSymbolProvider",!1,tt(0,"Whether the editor has a document symbol provider")),t.hasReferenceProvider=new Ta("editorHasReferenceProvider",!1,tt(0,"Whether the editor has a reference provider")),t.hasRenameProvider=new Ta("editorHasRenameProvider",!1,tt(0,"Whether the editor has a rename provider")),t.hasSignatureHelpProvider=new Ta("editorHasSignatureHelpProvider",!1,tt(0,"Whether the editor has a signature help provider")),t.hasInlayHintsProvider=new Ta("editorHasInlayHintsProvider",!1,tt(0,"Whether the editor has an inline hints provider")),t.hasDocumentFormattingProvider=new Ta("editorHasDocumentFormattingProvider",!1,tt(0,"Whether the editor has a document formatting provider")),t.hasDocumentSelectionFormattingProvider=new Ta("editorHasDocumentSelectionFormattingProvider",!1,tt(0,"Whether the editor has a document selection formatting provider")),t.hasMultipleDocumentFormattingProvider=new Ta("editorHasMultipleDocumentFormattingProvider",!1,tt(0,"Whether the editor has multiple document formatting providers")),t.hasMultipleDocumentSelectionFormattingProvider=new Ta("editorHasMultipleDocumentSelectionFormattingProvider",!1,tt(0,"Whether the editor has multiple document selection formatting providers"))})(Ox||(Ox={}));class Ix extends pu{runEditorCommand(t,i,e){const s=i._getViewModel();s&&this.runCoreEditorCommand(s,e||{})}}var _x,Px,Nx;(function(t){t.metadata={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t* 'to': A mandatory direction value.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'up', 'down'\n\t\t\t\t\t\t```\n\t\t\t\t\t* 'by': Unit to move. Default is computed based on 'to' value.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'line', 'wrappedLine', 'page', 'halfPage', 'editor'\n\t\t\t\t\t\t```\n\t\t\t\t\t* 'value': Number of units to move. Default is '1'.\n\t\t\t\t\t* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n\t\t\t\t",constraint:function(t){if(!O(t))return!1;const i=t;return!!R(i.to)&&!(!B(i.by)&&!R(i.by))&&!(!B(i.value)&&!_(i.value))&&!(!B(i.revealCursor)&&!N(i.revealCursor))},schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage","editor"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},t.RawDirection={Up:"up",Right:"right",Down:"down",Left:"left"},t.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage",Editor:"editor",Column:"column"},t.parse=function(i){let e,s;switch(i.to){case t.RawDirection.Up:e=1;break;case t.RawDirection.Right:e=2;break;case t.RawDirection.Down:e=3;break;case t.RawDirection.Left:e=4;break;default:return null}switch(i.by){case t.RawUnit.Line:s=1;break;case t.RawUnit.WrappedLine:s=2;break;case t.RawUnit.Page:s=3;break;case t.RawUnit.HalfPage:s=4;break;case t.RawUnit.Editor:s=5;break;case t.RawUnit.Column:s=6;break;default:s=2}return{direction:e,unit:s,value:Math.floor(i.value||1),revealCursor:!!i.revealCursor,select:!!i.select}}})(_x||(_x={})),function(t){t.metadata={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t* 'lineNumber': A mandatory line number value.\n\t\t\t\t\t* 'at': Logical position at which line has to be revealed.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'top', 'center', 'bottom'\n\t\t\t\t\t\t```\n\t\t\t\t",constraint:function(t){if(!O(t))return!1;const i=t;return!(!_(i.lineNumber)&&!R(i.lineNumber))&&!(!B(i.at)&&!R(i.at))},schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},t.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"}}(Px||(Px={}));class Bx{constructor(t){t.addImplementation(1e4,"code-editor",((t,i)=>{const e=t.get(Pl).getFocusedCodeEditor();return!(!e||!e.hasTextFocus())&&this._runEditorCommand(t,e,i)})),t.addImplementation(1e3,"generic-dom-input-textarea",((t,i)=>{const e=Lc();return!!(e&&["input","textarea"].indexOf(e.tagName.toLowerCase())>=0)&&(this.runDOMCommand(e),!0)})),t.addImplementation(0,"generic-dom",((t,i)=>{const e=t.get(Pl).getActiveCodeEditor();return!!e&&(e.focus(),this._runEditorCommand(t,e,i))}))}_runEditorCommand(t,i,e){return this.runEditorCommand(t,i,e)||!0}}(function(t){class i extends Ix{constructor(t){super(t),this._inSelectionMode=t.inSelectionMode}runCoreEditorCommand(t,i){i.position&&(t.model.pushStackElement(),t.setCursorStates(i.source,3,[dx.moveTo(t,t.getPrimaryCursorState(),this._inSelectionMode,i.position,i.viewPosition)])&&i.revealType!==2&&t.revealAllCursors(i.source,!0,!0))}}t.MoveTo=yu(new i({id:"_moveTo",inSelectionMode:!1,precondition:void 0})),t.MoveToSelect=yu(new i({id:"_moveToSelect",inSelectionMode:!0,precondition:void 0}));class e extends Ix{runCoreEditorCommand(t,i){t.model.pushStackElement();const e=this._getColumnSelectResult(t,t.getPrimaryCursorState(),t.getCursorColumnSelectData(),i);e!==null&&(t.setCursorStates(i.source,3,e.viewStates.map((t=>GS.fromViewState(t)))),t.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:e.fromLineNumber,fromViewVisualColumn:e.fromVisualColumn,toViewLineNumber:e.toLineNumber,toViewVisualColumn:e.toVisualColumn}),e.reversed?t.revealTopMostCursor(i.source):t.revealBottomMostCursor(i.source))}}t.ColumnSelect=yu(new class extends e{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(t,i,e,s){if(s.position===void 0||s.viewPosition===void 0||s.mouseColumn===void 0)return null;const n=t.model.validatePosition(s.position),r=t.coordinatesConverter.validateViewPosition(new ks(s.viewPosition.lineNumber,s.viewPosition.column),n),o=s.doColumnSelect?e.fromViewLineNumber:r.lineNumber,h=s.doColumnSelect?e.fromViewVisualColumn:s.mouseColumn-1;return tx.columnSelect(t.cursorConfig,t,o,h,r.lineNumber,s.mouseColumn-1)}}),t.CursorColumnSelectLeft=yu(new class extends e{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(t,i,e,s){return tx.columnSelectLeft(t.cursorConfig,t,e)}}),t.CursorColumnSelectRight=yu(new class extends e{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(t,i,e,s){return tx.columnSelectRight(t.cursorConfig,t,e)}});class s extends e{constructor(t){super(t),this._isPaged=t.isPaged}_getColumnSelectResult(t,i,e,s){return tx.columnSelectUp(t.cursorConfig,t,e,this._isPaged)}}t.CursorColumnSelectUp=yu(new s({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:3600,linux:{primary:0}}})),t.CursorColumnSelectPageUp=yu(new s({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:3595,linux:{primary:0}}}));class n extends e{constructor(t){super(t),this._isPaged=t.isPaged}_getColumnSelectResult(t,i,e,s){return tx.columnSelectDown(t.cursorConfig,t,e,this._isPaged)}}t.CursorColumnSelectDown=yu(new n({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:3602,linux:{primary:0}}})),t.CursorColumnSelectPageDown=yu(new n({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:3596,linux:{primary:0}}}));class r extends Ix{constructor(){super({id:"cursorMove",precondition:void 0,metadata:fx.metadata})}runCoreEditorCommand(t,i){const e=fx.parse(i);e&&this._runCursorMove(t,i.source,e)}_runCursorMove(t,i,e){t.model.pushStackElement(),t.setCursorStates(i,3,r._move(t,t.getCursorStates(),e)),t.revealAllCursors(i,!0)}static _move(t,i,e){const s=e.select,n=e.value;switch(e.direction){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:return dx.simpleMove(t,i,e.direction,s,n,e.unit);case 11:case 13:case 12:case 14:return dx.viewportMove(t,i,e.direction,s,n);default:return null}}}t.CursorMoveImpl=r,t.CursorMove=yu(new r);class o extends Ix{constructor(t){super(t),this._staticArgs=t.args}runCoreEditorCommand(t,i){let e=this._staticArgs;this._staticArgs.value===-1&&(e={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:i.pageSize||t.cursorConfig.pageSize}),t.model.pushStackElement(),t.setCursorStates(i.source,3,dx.simpleMove(t,t.getCursorStates(),e.direction,e.select,e.value,e.unit)),t.revealAllCursors(i.source,!0)}}t.CursorLeft=yu(new o({args:{direction:0,unit:0,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),t.CursorLeftSelect=yu(new o({args:{direction:0,unit:0,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:1039}})),t.CursorRight=yu(new o({args:{direction:1,unit:0,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),t.CursorRightSelect=yu(new o({args:{direction:1,unit:0,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:1041}})),t.CursorUp=yu(new o({args:{direction:2,unit:2,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),t.CursorUpSelect=yu(new o({args:{direction:2,unit:2,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),t.CursorPageUp=yu(new o({args:{direction:2,unit:2,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:11}})),t.CursorPageUpSelect=yu(new o({args:{direction:2,unit:2,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:1035}})),t.CursorDown=yu(new o({args:{direction:3,unit:2,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),t.CursorDownSelect=yu(new o({args:{direction:3,unit:2,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),t.CursorPageDown=yu(new o({args:{direction:3,unit:2,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:12}})),t.CursorPageDownSelect=yu(new o({args:{direction:3,unit:2,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:1036}})),t.CreateCursor=yu(new class extends Ix{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(t,i){if(!i.position)return;let e;e=i.wholeLine?dx.line(t,t.getPrimaryCursorState(),!1,i.position,i.viewPosition):dx.moveTo(t,t.getPrimaryCursorState(),!1,i.position,i.viewPosition);const s=t.getCursorStates();if(s.length>1){const n=e.modelState?e.modelState.position:null,r=e.viewState?e.viewState.position:null;for(let e=0,o=s.length;e<o;e++){const o=s[e];if((!n||o.modelState.selection.containsPosition(n))&&(!r||o.viewState.selection.containsPosition(r)))return s.splice(e,1),t.model.pushStackElement(),void t.setCursorStates(i.source,3,s)}}s.push(e),t.model.pushStackElement(),t.setCursorStates(i.source,3,s)}}),t.LastCursorMoveToSelect=yu(new class extends Ix{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(t,i){if(!i.position)return;const e=t.getLastAddedCursorIndex(),s=t.getCursorStates(),n=s.slice(0);n[e]=dx.moveTo(t,s[e],!0,i.position,i.viewPosition),t.model.pushStackElement(),t.setCursorStates(i.source,3,n)}});class h extends Ix{constructor(t){super(t),this._inSelectionMode=t.inSelectionMode}runCoreEditorCommand(t,i){t.model.pushStackElement(),t.setCursorStates(i.source,3,dx.moveToBeginningOfLine(t,t.getCursorStates(),this._inSelectionMode)),t.revealAllCursors(i.source,!0)}}t.CursorHome=yu(new h({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),t.CursorHomeSelect=yu(new h({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class c extends Ix{constructor(t){super(t),this._inSelectionMode=t.inSelectionMode}runCoreEditorCommand(t,i){t.model.pushStackElement(),t.setCursorStates(i.source,3,this._exec(t.getCursorStates())),t.revealAllCursors(i.source,!0)}_exec(t){const i=[];for(let e=0,s=t.length;e<s;e++){const s=t[e],n=s.modelState.position.lineNumber;i[e]=GS.fromModelState(s.modelState.move(this._inSelectionMode,n,1,0))}return i}}t.CursorLineStart=yu(new c({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:0,mac:{primary:287}}})),t.CursorLineStartSelect=yu(new c({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:0,mac:{primary:1311}}}));class l extends Ix{constructor(t){super(t),this._inSelectionMode=t.inSelectionMode}runCoreEditorCommand(t,i){t.model.pushStackElement(),t.setCursorStates(i.source,3,dx.moveToEndOfLine(t,t.getCursorStates(),this._inSelectionMode,i.sticky||!1)),t.revealAllCursors(i.source,!0)}}t.CursorEnd=yu(new l({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:0,kbExpr:Ox.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},metadata:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:tt(0,"Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),t.CursorEndSelect=yu(new l({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:0,kbExpr:Ox.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},metadata:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:tt(0,"Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class a extends Ix{constructor(t){super(t),this._inSelectionMode=t.inSelectionMode}runCoreEditorCommand(t,i){t.model.pushStackElement(),t.setCursorStates(i.source,3,this._exec(t,t.getCursorStates())),t.revealAllCursors(i.source,!0)}_exec(t,i){const e=[];for(let s=0,n=i.length;s<n;s++){const n=i[s],r=n.modelState.position.lineNumber,o=t.model.getLineMaxColumn(r);e[s]=GS.fromModelState(n.modelState.move(this._inSelectionMode,r,o,0))}return e}}t.CursorLineEnd=yu(new a({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:0,mac:{primary:291}}})),t.CursorLineEndSelect=yu(new a({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:0,mac:{primary:1315}}}));class u extends Ix{constructor(t){super(t),this._inSelectionMode=t.inSelectionMode}runCoreEditorCommand(t,i){t.model.pushStackElement(),t.setCursorStates(i.source,3,dx.moveToBeginningOfBuffer(t,t.getCursorStates(),this._inSelectionMode)),t.revealAllCursors(i.source,!0)}}t.CursorTop=yu(new u({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:2062,mac:{primary:2064}}})),t.CursorTopSelect=yu(new u({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:3086,mac:{primary:3088}}}));class d extends Ix{constructor(t){super(t),this._inSelectionMode=t.inSelectionMode}runCoreEditorCommand(t,i){t.model.pushStackElement(),t.setCursorStates(i.source,3,dx.moveToEndOfBuffer(t,t.getCursorStates(),this._inSelectionMode)),t.revealAllCursors(i.source,!0)}}t.CursorBottom=yu(new d({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:2061,mac:{primary:2066}}})),t.CursorBottomSelect=yu(new d({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:3085,mac:{primary:3090}}}));class f extends Ix{constructor(){super({id:"editorScroll",precondition:void 0,metadata:_x.metadata})}determineScrollMethod(t){return[6].includes(t.unit)&&[4,2].includes(t.direction)?this._runHorizontalEditorScroll.bind(this):[1,2,3,4,5,6].includes(t.unit)&&[1,3].includes(t.direction)?this._runVerticalEditorScroll.bind(this):null}runCoreEditorCommand(t,i){const e=_x.parse(i);if(!e)return;const s=this.determineScrollMethod(e);s&&s(t,i.source,e)}_runVerticalEditorScroll(t,i,e){const s=this._computeDesiredScrollTop(t,e);if(e.revealCursor){const n=t.getCompletelyVisibleViewRangeAtScrollTop(s);t.setCursorStates(i,3,[dx.findPositionInViewportIfOutside(t,t.getPrimaryCursorState(),n,e.select)])}t.viewLayout.setScrollPosition({scrollTop:s},0)}_computeDesiredScrollTop(t,i){if(i.unit===1){const e=t.viewLayout.getFutureViewport(),s=t.getCompletelyVisibleViewRangeAtScrollTop(e.top),n=t.coordinatesConverter.convertViewRangeToModelRange(s);let r;r=i.direction===1?Math.max(1,n.startLineNumber-i.value):Math.min(t.model.getLineCount(),n.startLineNumber+i.value);const o=t.coordinatesConverter.convertModelPositionToViewPosition(new ks(r,1));return t.viewLayout.getVerticalOffsetForLineNumber(o.lineNumber)}if(i.unit===5){let e=0;return i.direction===3&&(e=t.model.getLineCount()-t.cursorConfig.pageSize),t.viewLayout.getVerticalOffsetForLineNumber(e)}let e;e=i.unit===3?t.cursorConfig.pageSize*i.value:i.unit===4?Math.round(t.cursorConfig.pageSize/2)*i.value:i.value;const s=(i.direction===1?-1:1)*e;return t.viewLayout.getCurrentScrollTop()+s*t.cursorConfig.lineHeight}_runHorizontalEditorScroll(t,i,e){const s=this._computeDesiredScrollLeft(t,e);t.viewLayout.setScrollPosition({scrollLeft:s},0)}_computeDesiredScrollLeft(t,i){const e=(i.direction===4?-1:1)*i.value;return t.viewLayout.getCurrentScrollLeft()+e*t.cursorConfig.typicalHalfwidthCharacterWidth}}t.EditorScrollImpl=f,t.EditorScroll=yu(new f),t.ScrollLineUp=yu(new class extends Ix{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(i,e){t.EditorScroll.runCoreEditorCommand(i,{to:_x.RawDirection.Up,by:_x.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:e.source})}}),t.ScrollPageUp=yu(new class extends Ix{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(i,e){t.EditorScroll.runCoreEditorCommand(i,{to:_x.RawDirection.Up,by:_x.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:e.source})}}),t.ScrollEditorTop=yu(new class extends Ix{constructor(){super({id:"scrollEditorTop",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus}})}runCoreEditorCommand(i,e){t.EditorScroll.runCoreEditorCommand(i,{to:_x.RawDirection.Up,by:_x.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:e.source})}}),t.ScrollLineDown=yu(new class extends Ix{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(i,e){t.EditorScroll.runCoreEditorCommand(i,{to:_x.RawDirection.Down,by:_x.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:e.source})}}),t.ScrollPageDown=yu(new class extends Ix{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(i,e){t.EditorScroll.runCoreEditorCommand(i,{to:_x.RawDirection.Down,by:_x.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:e.source})}}),t.ScrollEditorBottom=yu(new class extends Ix{constructor(){super({id:"scrollEditorBottom",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus}})}runCoreEditorCommand(i,e){t.EditorScroll.runCoreEditorCommand(i,{to:_x.RawDirection.Down,by:_x.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:e.source})}}),t.ScrollLeft=yu(new class extends Ix{constructor(){super({id:"scrollLeft",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus}})}runCoreEditorCommand(i,e){t.EditorScroll.runCoreEditorCommand(i,{to:_x.RawDirection.Left,by:_x.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:e.source})}}),t.ScrollRight=yu(new class extends Ix{constructor(){super({id:"scrollRight",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus}})}runCoreEditorCommand(i,e){t.EditorScroll.runCoreEditorCommand(i,{to:_x.RawDirection.Right,by:_x.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:e.source})}});class g extends Ix{constructor(t){super(t),this._inSelectionMode=t.inSelectionMode}runCoreEditorCommand(t,i){i.position&&(t.model.pushStackElement(),t.setCursorStates(i.source,3,[dx.word(t,t.getPrimaryCursorState(),this._inSelectionMode,i.position)]),i.revealType!==2&&t.revealAllCursors(i.source,!0,!0))}}t.WordSelect=yu(new g({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),t.WordSelectDrag=yu(new g({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),t.LastCursorWordSelect=yu(new class extends Ix{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(t,i){if(!i.position)return;const e=t.getLastAddedCursorIndex(),s=t.getCursorStates(),n=s.slice(0),r=s[e];n[e]=dx.word(t,r,r.modelState.hasSelection(),i.position),t.model.pushStackElement(),t.setCursorStates(i.source,3,n)}});class p extends Ix{constructor(t){super(t),this._inSelectionMode=t.inSelectionMode}runCoreEditorCommand(t,i){i.position&&(t.model.pushStackElement(),t.setCursorStates(i.source,3,[dx.line(t,t.getPrimaryCursorState(),this._inSelectionMode,i.position,i.viewPosition)]),i.revealType!==2&&t.revealAllCursors(i.source,!1,!0))}}t.LineSelect=yu(new p({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),t.LineSelectDrag=yu(new p({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class m extends Ix{constructor(t){super(t),this._inSelectionMode=t.inSelectionMode}runCoreEditorCommand(t,i){if(!i.position)return;const e=t.getLastAddedCursorIndex(),s=t.getCursorStates(),n=s.slice(0);n[e]=dx.line(t,s[e],this._inSelectionMode,i.position,i.viewPosition),t.model.pushStackElement(),t.setCursorStates(i.source,3,n)}}t.LastCursorLineSelect=yu(new m({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),t.LastCursorLineSelectDrag=yu(new m({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),t.CancelSelection=yu(new class extends Ix{constructor(){super({id:"cancelSelection",precondition:Ox.hasNonEmptySelection,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(t,i){t.model.pushStackElement(),t.setCursorStates(i.source,3,[dx.cancelSelection(t,t.getPrimaryCursorState())]),t.revealAllCursors(i.source,!0)}}),t.RemoveSecondaryCursors=yu(new class extends Ix{constructor(){super({id:"removeSecondaryCursors",precondition:Ox.hasMultipleSelections,kbOpts:{weight:1,kbExpr:Ox.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(t,i){t.model.pushStackElement(),t.setCursorStates(i.source,3,[t.getPrimaryCursorState()]),t.revealAllCursors(i.source,!0),ow(tt(0,"Removed secondary cursors"))}}),t.RevealLine=yu(new class extends Ix{constructor(){super({id:"revealLine",precondition:void 0,metadata:Px.metadata})}runCoreEditorCommand(t,i){const e=i,s=e.lineNumber||0;let n=typeof s=="number"?s+1:parseInt(s)+1;n<1&&(n=1);const r=t.model.getLineCount();n>r&&(n=r);const o=new Cs(n,1,n,t.model.getLineMaxColumn(n));let h=0;if(e.at)switch(e.at){case Px.RawAtArgument.Top:h=3;break;case Px.RawAtArgument.Center:h=1;break;case Px.RawAtArgument.Bottom:h=4}const c=t.coordinatesConverter.convertModelRangeToViewRange(o);t.revealRange(i.source,!1,c,h,0)}}),t.SelectAll=new class extends Bx{constructor(){super(Lu)}runDOMCommand(t){Hr&&(t.focus(),t.select()),t.ownerDocument.execCommand("selectAll")}runEditorCommand(t,i,e){const s=i._getViewModel();s&&this.runCoreEditorCommand(s,e)}runCoreEditorCommand(t,i){t.model.pushStackElement(),t.setCursorStates("keyboard",3,[dx.selectAll(t,t.getPrimaryCursorState())])}},t.SetSelection=yu(new class extends Ix{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(t,i){i.selection&&(t.model.pushStackElement(),t.setCursorStates(i.source,3,[GS.fromModelSelection(i.selection)]))}})})(Nx||(Nx={}));const $x=ua.and(Ox.textInputFocus,Ox.columnSelection);function Wx(t,i){Ua.registerKeybindingRule({id:t,primary:i,when:$x,weight:1})}function jx(t){return t.register(),t}var Hx,Vx;Wx(Nx.CursorColumnSelectLeft.id,1039),Wx(Nx.CursorColumnSelectRight.id,1041),Wx(Nx.CursorColumnSelectUp.id,1040),Wx(Nx.CursorColumnSelectPageUp.id,1035),Wx(Nx.CursorColumnSelectDown.id,1042),Wx(Nx.CursorColumnSelectPageDown.id,1036),function(t){class i extends pu{runEditorCommand(t,i,e){const s=i._getViewModel();s&&this.runCoreEditingCommand(i,s,e||{})}}t.CoreEditingCommand=i,t.LineBreakInsert=yu(new class extends i{constructor(){super({id:"lineBreakInsert",precondition:Ox.writable,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(t,i,e){t.pushUndoStop(),t.executeCommands(this.id,Ex.lineBreakInsert(i.cursorConfig,i.model,i.getCursorStates().map((t=>t.modelState.selection))))}}),t.Outdent=yu(new class extends i{constructor(){super({id:"outdent",precondition:Ox.writable,kbOpts:{weight:0,kbExpr:ua.and(Ox.editorTextFocus,Ox.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(t,i,e){t.pushUndoStop(),t.executeCommands(this.id,Ex.outdent(i.cursorConfig,i.model,i.getCursorStates().map((t=>t.modelState.selection)))),t.pushUndoStop()}}),t.Tab=yu(new class extends i{constructor(){super({id:"tab",precondition:Ox.writable,kbOpts:{weight:0,kbExpr:ua.and(Ox.editorTextFocus,Ox.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(t,i,e){t.pushUndoStop(),t.executeCommands(this.id,Ex.tab(i.cursorConfig,i.model,i.getCursorStates().map((t=>t.modelState.selection)))),t.pushUndoStop()}}),t.DeleteLeft=yu(new class extends i{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(t,i,e){const[s,n]=cx.deleteLeft(i.getPrevEditOperationType(),i.cursorConfig,i.model,i.getCursorStates().map((t=>t.modelState.selection)),i.getCursorAutoClosedCharacters());s&&t.pushUndoStop(),t.executeCommands(this.id,n),i.setPrevEditOperationType(2)}}),t.DeleteRight=yu(new class extends i{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(t,i,e){const[s,n]=cx.deleteRight(i.getPrevEditOperationType(),i.cursorConfig,i.model,i.getCursorStates().map((t=>t.modelState.selection)));s&&t.pushUndoStop(),t.executeCommands(this.id,n),i.setPrevEditOperationType(3)}}),t.Undo=new class extends Bx{constructor(){super(Au)}runDOMCommand(t){t.ownerDocument.execCommand("undo")}runEditorCommand(t,i,e){if(i.hasModel()&&i.getOption(91)!==!0)return i.getModel().undo()}},t.Redo=new class extends Bx{constructor(){super(Mu)}runDOMCommand(t){t.ownerDocument.execCommand("redo")}runEditorCommand(t,i,e){if(i.hasModel()&&i.getOption(91)!==!0)return i.getModel().redo()}}}(Hx||(Hx={}));class zx extends du{constructor(t,i,e){super({id:t,precondition:void 0,metadata:e}),this._handlerId=i}runCommand(t,i){const e=t.get(Pl).getFocusedCodeEditor();e&&e.trigger("keyboard",this._handlerId,i)}}function Ux(t,i){jx(new zx("default:"+t,t)),jx(new zx(t,t,i))}Ux("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]}),Ux("replacePreviousChar"),Ux("compositionType"),Ux("compositionStart"),Ux("compositionEnd"),Ux("paste"),Ux("cut");class Kx{constructor(t,i,e,s){this.configuration=t,this.viewModel=i,this.userInputEvents=e,this.commandDelegate=s}paste(t,i,e,s){this.commandDelegate.paste(t,i,e,s)}type(t){this.commandDelegate.type(t)}compositionType(t,i,e,s){this.commandDelegate.compositionType(t,i,e,s)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(t){Nx.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:t})}_validateViewColumn(t){const i=this.viewModel.getLineMinColumn(t.lineNumber);return t.column<i?new ks(t.lineNumber,i):t}_hasMulticursorModifier(t){switch(this.configuration.options.get(78)){case"altKey":return t.altKey;case"ctrlKey":return t.ctrlKey;case"metaKey":return t.metaKey;default:return!1}}_hasNonMulticursorModifier(t){switch(this.configuration.options.get(78)){case"altKey":return t.ctrlKey||t.metaKey;case"ctrlKey":return t.altKey||t.metaKey;case"metaKey":return t.ctrlKey||t.altKey;default:return!1}}dispatchMouse(t){const i=this.configuration.options,e=yt&&i.get(107),s=i.get(22);t.middleButton&&!e?this._columnSelect(t.position,t.mouseColumn,t.inSelectionMode):t.startedOnLineNumbers?this._hasMulticursorModifier(t)?t.inSelectionMode?this._lastCursorLineSelect(t.position,t.revealType):this._createCursor(t.position,!0):t.inSelectionMode?this._lineSelectDrag(t.position,t.revealType):this._lineSelect(t.position,t.revealType):t.mouseDownCount>=4?this._selectAll():t.mouseDownCount===3?this._hasMulticursorModifier(t)?t.inSelectionMode?this._lastCursorLineSelectDrag(t.position,t.revealType):this._lastCursorLineSelect(t.position,t.revealType):t.inSelectionMode?this._lineSelectDrag(t.position,t.revealType):this._lineSelect(t.position,t.revealType):t.mouseDownCount===2?t.onInjectedText||(this._hasMulticursorModifier(t)?this._lastCursorWordSelect(t.position,t.revealType):t.inSelectionMode?this._wordSelectDrag(t.position,t.revealType):this._wordSelect(t.position,t.revealType)):this._hasMulticursorModifier(t)?this._hasNonMulticursorModifier(t)||(t.shiftKey?this._columnSelect(t.position,t.mouseColumn,!0):t.inSelectionMode?this._lastCursorMoveToSelect(t.position,t.revealType):this._createCursor(t.position,!1)):t.inSelectionMode?t.altKey||s?this._columnSelect(t.position,t.mouseColumn,!0):this._moveToSelect(t.position,t.revealType):this.moveTo(t.position,t.revealType)}_usualArgs(t,i){return t=this._validateViewColumn(t),{source:"mouse",position:this._convertViewToModelPosition(t),viewPosition:t,revealType:i}}moveTo(t,i){Nx.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(t,i))}_moveToSelect(t,i){Nx.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(t,i))}_columnSelect(t,i,e){t=this._validateViewColumn(t),Nx.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(t),viewPosition:t,mouseColumn:i,doColumnSelect:e})}_createCursor(t,i){t=this._validateViewColumn(t),Nx.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(t),viewPosition:t,wholeLine:i})}_lastCursorMoveToSelect(t,i){Nx.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(t,i))}_wordSelect(t,i){Nx.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(t,i))}_wordSelectDrag(t,i){Nx.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(t,i))}_lastCursorWordSelect(t,i){Nx.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(t,i))}_lineSelect(t,i){Nx.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(t,i))}_lineSelectDrag(t,i){Nx.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(t,i))}_lastCursorLineSelect(t,i){Nx.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(t,i))}_lastCursorLineSelectDrag(t,i){Nx.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(t,i))}_selectAll(){Nx.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(t){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(t)}emitKeyDown(t){this.userInputEvents.emitKeyDown(t)}emitKeyUp(t){this.userInputEvents.emitKeyUp(t)}emitContextMenu(t){this.userInputEvents.emitContextMenu(t)}emitMouseMove(t){this.userInputEvents.emitMouseMove(t)}emitMouseLeave(t){this.userInputEvents.emitMouseLeave(t)}emitMouseUp(t){this.userInputEvents.emitMouseUp(t)}emitMouseDown(t){this.userInputEvents.emitMouseDown(t)}emitMouseDrag(t){this.userInputEvents.emitMouseDrag(t)}emitMouseDrop(t){this.userInputEvents.emitMouseDrop(t)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(t){this.userInputEvents.emitMouseWheel(t)}}class qx{constructor(t){this._createLine=t,this._set(1,[])}flush(){this._set(1,[])}_set(t,i){this._lines=i,this._rendLineNumberStart=t}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(t){const i=t-this._rendLineNumberStart;if(i<0||i>=this._lines.length)throw new zi("Illegal value for lineNumber");return this._lines[i]}onLinesDeleted(t,i){if(this.getCount()===0)return null;const e=this.getStartLineNumber(),s=this.getEndLineNumber();if(i<e){const e=i-t+1;return this._rendLineNumberStart-=e,null}if(t>s)return null;let n=0,r=0;for(let o=e;o<=s;o++){const e=o-this._rendLineNumberStart;t<=o&&o<=i&&(r===0?(n=e,r=1):r++)}if(t<e){let s=0;s=i<e?i-t+1:e-t,this._rendLineNumberStart-=s}return this._lines.splice(n,r)}onLinesChanged(t,i){const e=t+i-1;if(this.getCount()===0)return!1;const s=this.getStartLineNumber(),n=this.getEndLineNumber();let r=!1;for(let i=t;i<=e;i++)i>=s&&i<=n&&(this._lines[i-this._rendLineNumberStart].onContentChanged(),r=!0);return r}onLinesInserted(t,i){if(this.getCount()===0)return null;const e=i-t+1,s=this.getStartLineNumber(),n=this.getEndLineNumber();if(t<=s)return this._rendLineNumberStart+=e,null;if(t>n)return null;if(e+t>n)return this._lines.splice(t-this._rendLineNumberStart,n-t+1);const r=[];for(let t=0;t<e;t++)r[t]=this._createLine();const o=t-this._rendLineNumberStart,h=this._lines.slice(0,o),c=this._lines.slice(o,this._lines.length-e),l=this._lines.slice(this._lines.length-e,this._lines.length);return this._lines=h.concat(r).concat(c),l}onTokensChanged(t){if(this.getCount()===0)return!1;const i=this.getStartLineNumber(),e=this.getEndLineNumber();let s=!1;for(let n=0,r=t.length;n<r;n++){const r=t[n];if(r.toLineNumber<i||r.fromLineNumber>e)continue;const o=Math.max(i,r.fromLineNumber),h=Math.min(e,r.toLineNumber);for(let t=o;t<=h;t++){const i=t-this._rendLineNumberStart;this._lines[i].onTokensChanged(),s=!0}}return s}}class Gx{constructor(t){this._host=t,this.domNode=this._createDomNode(),this._linesCollection=new qx((()=>this._host.createVisibleLine()))}_createDomNode(){const t=Sl(document.createElement("div"));return t.setClassName("view-layer"),t.setPosition("absolute"),t.domNode.setAttribute("role","presentation"),t.domNode.setAttribute("aria-hidden","true"),t}onConfigurationChanged(t){return!!t.hasChanged(145)}onFlushed(t){return this._linesCollection.flush(),!0}onLinesChanged(t){return this._linesCollection.onLinesChanged(t.fromLineNumber,t.count)}onLinesDeleted(t){const i=this._linesCollection.onLinesDeleted(t.fromLineNumber,t.toLineNumber);if(i)for(let t=0,e=i.length;t<e;t++){const e=i[t].getDomNode();e&&this.domNode.domNode.removeChild(e)}return!0}onLinesInserted(t){const i=this._linesCollection.onLinesInserted(t.fromLineNumber,t.toLineNumber);if(i)for(let t=0,e=i.length;t<e;t++){const e=i[t].getDomNode();e&&this.domNode.domNode.removeChild(e)}return!0}onScrollChanged(t){return t.scrollTopChanged}onTokensChanged(t){return this._linesCollection.onTokensChanged(t.ranges)}onZonesChanged(t){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(t){return this._linesCollection.getLine(t)}renderLines(t){const i=this._linesCollection._get(),e=new Zx(this.domNode.domNode,this._host,t),s={rendLineNumberStart:i.rendLineNumberStart,lines:i.lines,linesLength:i.lines.length},n=e.render(s,t.startLineNumber,t.endLineNumber,t.relativeVerticalOffset);this._linesCollection._set(n.rendLineNumberStart,n.lines)}}class Zx{constructor(t,i,e){this.domNode=t,this.host=i,this.viewportData=e}render(t,i,e,s){const n={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines.slice(0),linesLength:t.linesLength};if(n.rendLineNumberStart+n.linesLength-1<i||e<n.rendLineNumberStart){n.rendLineNumberStart=i,n.linesLength=e-i+1,n.lines=[];for(let t=i;t<=e;t++)n.lines[t-i]=this.host.createVisibleLine();return this._finishRendering(n,!0,s),n}if(this._renderUntouchedLines(n,Math.max(i-n.rendLineNumberStart,0),Math.min(e-n.rendLineNumberStart,n.linesLength-1),s,i),n.rendLineNumberStart>i){const t=i,r=Math.min(e,n.rendLineNumberStart-1);t<=r&&(this._insertLinesBefore(n,t,r,s,i),n.linesLength+=r-t+1)}else if(n.rendLineNumberStart<i){const t=Math.min(n.linesLength,i-n.rendLineNumberStart);t>0&&(this._removeLinesBefore(n,t),n.linesLength-=t)}if(n.rendLineNumberStart=i,n.rendLineNumberStart+n.linesLength-1<e){const t=n.rendLineNumberStart+n.linesLength,r=e;t<=r&&(this._insertLinesAfter(n,t,r,s,i),n.linesLength+=r-t+1)}else if(n.rendLineNumberStart+n.linesLength-1>e){const t=Math.max(0,e-n.rendLineNumberStart+1),i=n.linesLength-1-t+1;i>0&&(this._removeLinesAfter(n,i),n.linesLength-=i)}return this._finishRendering(n,!1,s),n}_renderUntouchedLines(t,i,e,s,n){const r=t.rendLineNumberStart,o=t.lines;for(let t=i;t<=e;t++){const i=r+t;o[t].layoutLine(i,s[i-n],this.viewportData.lineHeight)}}_insertLinesBefore(t,i,e,s,n){const r=[];let o=0;for(let t=i;t<=e;t++)r[o++]=this.host.createVisibleLine();t.lines=r.concat(t.lines)}_removeLinesBefore(t,i){for(let e=0;e<i;e++){const i=t.lines[e].getDomNode();i&&this.domNode.removeChild(i)}t.lines.splice(0,i)}_insertLinesAfter(t,i,e,s,n){const r=[];let o=0;for(let t=i;t<=e;t++)r[o++]=this.host.createVisibleLine();t.lines=t.lines.concat(r)}_removeLinesAfter(t,i){const e=t.linesLength-i;for(let s=0;s<i;s++){const i=t.lines[e+s].getDomNode();i&&this.domNode.removeChild(i)}t.lines.splice(e,i)}_finishRenderingNewLines(t,i,e,s){Zx._ttPolicy&&(e=Zx._ttPolicy.createHTML(e));const n=this.domNode.lastChild;i||!n?this.domNode.innerHTML=e:n.insertAdjacentHTML("afterend",e);let r=this.domNode.lastChild;for(let i=t.linesLength-1;i>=0;i--){const e=t.lines[i];s[i]&&(e.setDomNode(r),r=r.previousSibling)}}_finishRenderingInvalidLines(t,i,e){const s=document.createElement("div");Zx._ttPolicy&&(i=Zx._ttPolicy.createHTML(i)),s.innerHTML=i;for(let i=0;i<t.linesLength;i++){const n=t.lines[i];if(e[i]){const t=s.firstChild,i=n.getDomNode();i.parentNode.replaceChild(t,i),n.setDomNode(t)}}}_finishRendering(t,i,e){const s=Zx._sb,n=t.linesLength,r=t.lines,o=t.rendLineNumberStart,h=[];{s.reset();let c=!1;for(let t=0;t<n;t++){const i=r[t];h[t]=!1,!i.getDomNode()&&i.renderLine(t+o,e[t],this.viewportData.lineHeight,this.viewportData,s)&&(h[t]=!0,c=!0)}c&&this._finishRenderingNewLines(t,i,s.build(),h)}{s.reset();let i=!1;const c=[];for(let t=0;t<n;t++){const n=r[t];c[t]=!1,!h[t]&&n.renderLine(t+o,e[t],this.viewportData.lineHeight,this.viewportData,s)&&(c[t]=!0,i=!0)}i&&this._finishRenderingInvalidLines(t,s.build(),c)}}}Zx._ttPolicy=ju("editorViewLayer",{createHTML:t=>t}),Zx._sb=new gd(1e5);class Jx extends Yy{constructor(t){super(t),this._visibleLines=new Gx(this),this.domNode=this._visibleLines.domNode;const i=this._context.configuration.options.get(50);xl(this.domNode,i),this._dynamicOverlays=[],this._isFocused=!1,this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let t=0,i=this._dynamicOverlays.length;t<i;t++)if(this._dynamicOverlays[t].shouldRender())return!0;return!1}dispose(){super.dispose();for(let t=0,i=this._dynamicOverlays.length;t<i;t++)this._dynamicOverlays[t].dispose();this._dynamicOverlays=[]}getDomNode(){return this.domNode}createVisibleLine(){return new Qx(this._dynamicOverlays)}addDynamicOverlay(t){this._dynamicOverlays.push(t)}onConfigurationChanged(t){this._visibleLines.onConfigurationChanged(t);const i=this._context.configuration.options.get(50);return xl(this.domNode,i),!0}onFlushed(t){return this._visibleLines.onFlushed(t)}onFocusChanged(t){return this._isFocused=t.isFocused,!0}onLinesChanged(t){return this._visibleLines.onLinesChanged(t)}onLinesDeleted(t){return this._visibleLines.onLinesDeleted(t)}onLinesInserted(t){return this._visibleLines.onLinesInserted(t)}onScrollChanged(t){return this._visibleLines.onScrollChanged(t)||!0}onTokensChanged(t){return this._visibleLines.onTokensChanged(t)}onZonesChanged(t){return this._visibleLines.onZonesChanged(t)}prepareRender(t){const i=this._dynamicOverlays.filter((t=>t.shouldRender()));for(let e=0,s=i.length;e<s;e++){const s=i[e];s.prepareRender(t),s.onDidRender()}}render(t){this._viewOverlaysRender(t),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(t){this._visibleLines.renderLines(t.viewportData)}}class Qx{constructor(t){this._dynamicOverlays=t,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(t){this._domNode=Sl(t)}onContentChanged(){}onTokensChanged(){}renderLine(t,i,e,s,n){let r="";for(let i=0,e=this._dynamicOverlays.length;i<e;i++)r+=this._dynamicOverlays[i].render(s.startLineNumber,t);return this._renderedContent!==r&&(this._renderedContent=r,n.appendString('<div style="top:'),n.appendString(String(i)),n.appendString("px;height:"),n.appendString(String(e)),n.appendString('px;">'),n.appendString(r),n.appendString("</div>"),!0)}layoutLine(t,i,e){this._domNode&&(this._domNode.setTop(i),this._domNode.setHeight(e))}}class Yx extends Jx{constructor(t){super(t);const i=this._context.configuration.options.get(145);this._contentWidth=i.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(t){const i=this._context.configuration.options.get(145);return this._contentWidth=i.contentWidth,super.onConfigurationChanged(t)||!0}onScrollChanged(t){return super.onScrollChanged(t)||t.scrollWidthChanged}_viewOverlaysRender(t){super._viewOverlaysRender(t),this.domNode.setWidth(Math.max(t.scrollWidth,this._contentWidth))}}class Xx extends Jx{constructor(t){super(t);const i=this._context.configuration.options,e=i.get(145);this._contentLeft=e.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),xl(this.domNode,i.get(50))}onConfigurationChanged(t){const i=this._context.configuration.options;xl(this.domNode,i.get(50));const e=i.get(145);return this._contentLeft=e.contentLeft,super.onConfigurationChanged(t)||!0}onScrollChanged(t){return super.onScrollChanged(t)||t.scrollHeightChanged}_viewOverlaysRender(t){super._viewOverlaysRender(t);const i=Math.min(t.scrollHeight,1e6);this.domNode.setHeight(i),this.domNode.setWidth(this._contentLeft)}}class tD{constructor(t){this.onKeyDown=null,this.onKeyUp=null,this.onContextMenu=null,this.onMouseMove=null,this.onMouseLeave=null,this.onMouseDown=null,this.onMouseUp=null,this.onMouseDrag=null,this.onMouseDrop=null,this.onMouseDropCanceled=null,this.onMouseWheel=null,this._coordinatesConverter=t}emitKeyDown(t){var i;(i=this.onKeyDown)===null||i===void 0||i.call(this,t)}emitKeyUp(t){var i;(i=this.onKeyUp)===null||i===void 0||i.call(this,t)}emitContextMenu(t){var i;(i=this.onContextMenu)===null||i===void 0||i.call(this,this._convertViewToModelMouseEvent(t))}emitMouseMove(t){var i;(i=this.onMouseMove)===null||i===void 0||i.call(this,this._convertViewToModelMouseEvent(t))}emitMouseLeave(t){var i;(i=this.onMouseLeave)===null||i===void 0||i.call(this,this._convertViewToModelMouseEvent(t))}emitMouseDown(t){var i;(i=this.onMouseDown)===null||i===void 0||i.call(this,this._convertViewToModelMouseEvent(t))}emitMouseUp(t){var i;(i=this.onMouseUp)===null||i===void 0||i.call(this,this._convertViewToModelMouseEvent(t))}emitMouseDrag(t){var i;(i=this.onMouseDrag)===null||i===void 0||i.call(this,this._convertViewToModelMouseEvent(t))}emitMouseDrop(t){var i;(i=this.onMouseDrop)===null||i===void 0||i.call(this,this._convertViewToModelMouseEvent(t))}emitMouseDropCanceled(){var t;(t=this.onMouseDropCanceled)===null||t===void 0||t.call(this)}emitMouseWheel(t){var i;(i=this.onMouseWheel)===null||i===void 0||i.call(this,t)}_convertViewToModelMouseEvent(t){return t.target?{event:t.event,target:this._convertViewToModelMouseTarget(t.target)}:t}_convertViewToModelMouseTarget(t){return tD.convertViewToModelMouseTarget(t,this._coordinatesConverter)}static convertViewToModelMouseTarget(t,i){const e={...t};return e.position&&(e.position=i.convertViewPositionToModelPosition(e.position)),e.range&&(e.range=i.convertViewRangeToModelRange(e.range)),e.type!==5&&e.type!==8||(e.detail=this.convertViewToModelViewZoneData(e.detail,i)),e}static convertViewToModelViewZoneData(t,i){return{viewZoneId:t.viewZoneId,positionBefore:t.positionBefore?i.convertViewPositionToModelPosition(t.positionBefore):t.positionBefore,positionAfter:t.positionAfter?i.convertViewPositionToModelPosition(t.positionAfter):t.positionAfter,position:i.convertViewPositionToModelPosition(t.position),afterLineNumber:i.convertViewPositionToModelPosition(new ks(t.afterLineNumber,1)).lineNumber}}}class iD extends Yy{constructor(t){super(t),this.blocks=[],this.contentWidth=-1,this.contentLeft=0,this.domNode=Sl(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("blockDecorations-container"),this.update()}update(){let t=!1;const i=this._context.configuration.options.get(145),e=i.contentWidth-i.verticalScrollbarWidth;this.contentWidth!==e&&(this.contentWidth=e,t=!0);const s=i.contentLeft;return this.contentLeft!==s&&(this.contentLeft=s,t=!0),t}dispose(){super.dispose()}onConfigurationChanged(t){return this.update()}onScrollChanged(t){return t.scrollTopChanged||t.scrollLeftChanged}onDecorationsChanged(t){return!0}onZonesChanged(t){return!0}prepareRender(t){}render(t){var i;let e=0;const s=t.getDecorationsInViewport();for(const n of s){if(!n.options.blockClassName)continue;let s,r,o=this.blocks[e];o||(o=this.blocks[e]=Sl(document.createElement("div")),this.domNode.appendChild(o)),n.options.blockIsAfterEnd?(s=t.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!1),r=t.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!0)):(s=t.getVerticalOffsetForLineNumber(n.range.startLineNumber,!0),r=n.range.isEmpty()&&!n.options.blockDoesNotCollapse?t.getVerticalOffsetForLineNumber(n.range.startLineNumber,!1):t.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!0));const[h,c,l,a]=(i=n.options.blockPadding)!==null&&i!==void 0?i:[0,0,0,0];o.setClassName("blockDecorations-block "+n.options.blockClassName),o.setLeft(this.contentLeft-a),o.setWidth(this.contentWidth+a+c),o.setTop(s-t.scrollTop-h),o.setHeight(r-s+h+l),e++}for(let t=e;t<this.blocks.length;t++)this.blocks[t].domNode.remove();this.blocks.length=e}}class eD extends Yy{constructor(t,i){super(t),this._viewDomNode=i,this._widgets={},this.domNode=Sl(document.createElement("div")),Xy.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=Sl(document.createElement("div")),Xy.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(t){const i=Object.keys(this._widgets);for(const e of i)this._widgets[e].onConfigurationChanged(t);return!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLineMappingChanged(t){return this._updateAnchorsViewPositions(),!0}onLinesChanged(t){return this._updateAnchorsViewPositions(),!0}onLinesDeleted(t){return this._updateAnchorsViewPositions(),!0}onLinesInserted(t){return this._updateAnchorsViewPositions(),!0}onScrollChanged(t){return!0}onZonesChanged(t){return!0}_updateAnchorsViewPositions(){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].updateAnchorViewPosition()}addWidget(t){const i=new sD(this._context,this._viewDomNode,t);this._widgets[i.id]=i,i.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(i.domNode):this.domNode.appendChild(i.domNode),this.setShouldRender()}setWidgetPosition(t,i,e,s,n){this._widgets[t.getId()].setPosition(i,e,s,n),this.setShouldRender()}removeWidget(t){const i=t.getId();if(this._widgets.hasOwnProperty(i)){const t=this._widgets[i];delete this._widgets[i];const e=t.domNode.domNode;e.parentNode.removeChild(e),e.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(t){return!!this._widgets.hasOwnProperty(t)&&this._widgets[t].suppressMouseDown}onBeforeRender(t){const i=Object.keys(this._widgets);for(const e of i)this._widgets[e].onBeforeRender(t)}prepareRender(t){const i=Object.keys(this._widgets);for(const e of i)this._widgets[e].prepareRender(t)}render(t){const i=Object.keys(this._widgets);for(const e of i)this._widgets[e].render(t)}}class sD{constructor(t,i,e){this._primaryAnchor=new nD(null,null),this._secondaryAnchor=new nD(null,null),this._context=t,this._viewDomNode=i,this._actual=e,this.domNode=Sl(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=this._actual.allowEditorOverflow||!1,this.suppressMouseDown=this._actual.suppressMouseDown||!1;const s=this._context.configuration.options,n=s.get(145);this._fixedOverflowWidgets=s.get(42),this._contentWidth=n.contentWidth,this._contentLeft=n.contentLeft,this._lineHeight=s.get(67),this._affinity=null,this._preference=[],this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setDisplay("none"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(t){const i=this._context.configuration.options;if(this._lineHeight=i.get(67),t.hasChanged(145)){const t=i.get(145);this._contentLeft=t.contentLeft,this._contentWidth=t.contentWidth,this._maxWidth=this._getMaxWidth()}}updateAnchorViewPosition(){this._setPosition(this._affinity,this._primaryAnchor.modelPosition,this._secondaryAnchor.modelPosition)}_setPosition(t,i,e){function s(t,i,e){if(!t)return new nD(null,null);const s=i.model.validatePosition(t);if(i.coordinatesConverter.modelPositionIsVisible(s)){const n=i.coordinatesConverter.convertModelPositionToViewPosition(s,e??void 0);return new nD(t,n)}return new nD(t,null)}this._affinity=t,this._primaryAnchor=s(i,this._context.viewModel,this._affinity),this._secondaryAnchor=s(e,this._context.viewModel,this._affinity)}_getMaxWidth(){const t=this.domNode.domNode.ownerDocument,i=t.defaultView;return this.allowEditorOverflow?(i==null?void 0:i.innerWidth)||t.documentElement.offsetWidth||t.body.offsetWidth:this._contentWidth}setPosition(t,i,e,s){this._setPosition(s,t,i),this._preference=e,this._primaryAnchor.viewPosition&&this._preference&&this._preference.length>0?this.domNode.setDisplay("block"):this.domNode.setDisplay("none"),this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1}_layoutBoxInViewport(t,i,e,s){const n=t.top,r=n,o=t.top+t.height,h=n-e,c=r>=e,l=o,a=s.viewportHeight-o>=e;let u=t.left;return u+i>s.scrollLeft+s.viewportWidth&&(u=s.scrollLeft+s.viewportWidth-i),u<s.scrollLeft&&(u=s.scrollLeft),{fitsAbove:c,aboveTop:h,fitsBelow:a,belowTop:l,left:u}}_layoutHorizontalSegmentInPage(t,i,e,s){var n;const r=Math.max(15,i.left-s),o=Math.min(i.left+i.width+s,t.width-15),h=this._viewDomNode.domNode.ownerDocument.defaultView;let c=i.left+e-((n=h==null?void 0:h.scrollX)!==null&&n!==void 0?n:0);if(c+s>o){const t=c-(o-s);c-=t,e-=t}if(c<r){const t=c-r;c-=t,e-=t}return[e,c]}_layoutBoxInPage(t,i,e,s){var n,r;const o=t.top-e,h=t.top+t.height,c=vc(this._viewDomNode.domNode),l=this._viewDomNode.domNode.ownerDocument,a=l.defaultView,u=c.top+o-((n=a==null?void 0:a.scrollY)!==null&&n!==void 0?n:0),d=c.top+h-((r=a==null?void 0:a.scrollY)!==null&&r!==void 0?r:0),f=gc(l.body),[g,p]=this._layoutHorizontalSegmentInPage(f,c,t.left-s.scrollLeft+this._contentLeft,i),m=u>=22,w=d+e<=f.height-22;return this._fixedOverflowWidgets?{fitsAbove:m,aboveTop:Math.max(u,22),fitsBelow:w,belowTop:d,left:p}:{fitsAbove:m,aboveTop:o,fitsBelow:w,belowTop:h,left:g}}_prepareRenderWidgetAtExactPositionOverflowing(t){return new rD(t.top,t.left+this._contentLeft)}_getAnchorsCoordinates(t){var i,e;return{primary:s(this._primaryAnchor.viewPosition,this._affinity,this._lineHeight),secondary:s(((i=this._secondaryAnchor.viewPosition)===null||i===void 0?void 0:i.lineNumber)===((e=this._primaryAnchor.viewPosition)===null||e===void 0?void 0:e.lineNumber)?this._secondaryAnchor.viewPosition:null,this._affinity,this._lineHeight)};function s(i,e,s){if(!i)return null;const n=t.visibleRangeForPosition(i);if(!n)return null;const r=i.column===1&&e===3?0:n.left,o=t.getVerticalOffsetForLineNumber(i.lineNumber)-t.scrollTop;return new oD(o,r,s)}}_reduceAnchorCoordinates(t,i,e){if(!i)return t;const s=this._context.configuration.options.get(50);let n=i.left;return n=n<t.left?Math.max(n,t.left-e+s.typicalFullwidthCharacterWidth):Math.min(n,t.left+e-s.typicalFullwidthCharacterWidth),new oD(t.top,n,t.height)}_prepareRenderWidget(t){if(!this._preference||this._preference.length===0)return null;const{primary:i,secondary:e}=this._getAnchorsCoordinates(t);if(!i)return null;if(this._cachedDomNodeOffsetWidth===-1||this._cachedDomNodeOffsetHeight===-1){let t=null;if(typeof this._actual.beforeRender=="function"&&(t=hD(this._actual.beforeRender,this._actual)),t)this._cachedDomNodeOffsetWidth=t.width,this._cachedDomNodeOffsetHeight=t.height;else{const t=this.domNode.domNode.getBoundingClientRect();this._cachedDomNodeOffsetWidth=Math.round(t.width),this._cachedDomNodeOffsetHeight=Math.round(t.height)}}const s=this._reduceAnchorCoordinates(i,e,this._cachedDomNodeOffsetWidth);let n;n=this.allowEditorOverflow?this._layoutBoxInPage(s,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,t):this._layoutBoxInViewport(s,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,t);for(let t=1;t<=2;t++)for(const i of this._preference)if(i===1){if(!n)return null;if(t===2||n.fitsAbove)return{coordinate:new rD(n.aboveTop,n.left),position:1}}else{if(i!==2)return this.allowEditorOverflow?{coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(new rD(s.top,s.left)),position:0}:{coordinate:new rD(s.top,s.left),position:0};if(!n)return null;if(t===2||n.fitsBelow)return{coordinate:new rD(n.belowTop,n.left),position:2}}return null}onBeforeRender(t){this._primaryAnchor.viewPosition&&this._preference&&(this._primaryAnchor.viewPosition.lineNumber<t.startLineNumber||this._primaryAnchor.viewPosition.lineNumber>t.endLineNumber||this.domNode.setMaxWidth(this._maxWidth))}prepareRender(t){this._renderData=this._prepareRenderWidget(t)}render(t){if(!this._renderData)return this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,this.domNode.setVisibility("hidden")),void(typeof this._actual.afterRender=="function"&&hD(this._actual.afterRender,this._actual,null));this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+t.scrollTop-t.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),typeof this._actual.afterRender=="function"&&hD(this._actual.afterRender,this._actual,this._renderData.position)}}class nD{constructor(t,i){this.modelPosition=t,this.viewPosition=i}}class rD{constructor(t,i){this.top=t,this.left=i,this._coordinateBrand=void 0}}class oD{constructor(t,i,e){this.top=t,this.left=i,this.height=e,this._anchorCoordinateBrand=void 0}}function hD(t,i,...e){try{return t.call(i,...e)}catch{return null}}class cD extends EC{constructor(t){super(),this._context=t;const i=this._context.configuration.options,e=i.get(145);this._renderLineHighlight=i.get(96),this._renderLineHighlightOnlyWhenFocus=i.get(97),this._wordWrap=e.isViewportWrapping,this._contentLeft=e.contentLeft,this._contentWidth=e.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new Ss(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let t=!1;const i=new Set;for(const t of this._selections)i.add(t.positionLineNumber);const e=Array.from(i);e.sort(((t,i)=>t-i)),n(this._cursorLineNumbers,e)||(this._cursorLineNumbers=e,t=!0);const s=this._selections.every((t=>t.isEmpty()));return this._selectionIsEmpty!==s&&(this._selectionIsEmpty=s,t=!0),t}onThemeChanged(t){return this._readFromSelections()}onConfigurationChanged(t){const i=this._context.configuration.options,e=i.get(145);return this._renderLineHighlight=i.get(96),this._renderLineHighlightOnlyWhenFocus=i.get(97),this._wordWrap=e.isViewportWrapping,this._contentLeft=e.contentLeft,this._contentWidth=e.contentWidth,!0}onCursorStateChanged(t){return this._selections=t.selections,this._readFromSelections()}onFlushed(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollWidthChanged||t.scrollTopChanged}onZonesChanged(t){return!0}onFocusChanged(t){return!!this._renderLineHighlightOnlyWhenFocus&&(this._focused=t.isFocused,!0)}prepareRender(t){if(!this._shouldRenderThis())return void(this._renderData=null);const i=t.visibleRange.startLineNumber,e=t.visibleRange.endLineNumber,s=[];for(let t=i;t<=e;t++)s[t-i]="";if(this._wordWrap){const n=this._renderOne(t,!1);for(const t of this._cursorLineNumbers){const r=this._context.viewModel.coordinatesConverter,o=r.convertViewPositionToModelPosition(new ks(t,1)).lineNumber,h=r.convertModelPositionToViewPosition(new ks(o,1)).lineNumber,c=r.convertModelPositionToViewPosition(new ks(o,this._context.viewModel.model.getLineMaxColumn(o))).lineNumber,l=Math.max(h,i),a=Math.min(c,e);for(let t=l;t<=a;t++)s[t-i]=n}}const n=this._renderOne(t,!0);for(const t of this._cursorLineNumbers)t<i||t>e||(s[t-i]=n);this._renderData=s}render(t,i){if(!this._renderData)return"";const e=i-t;return e>=this._renderData.length?"":this._renderData[e]}_shouldRenderInMargin(){return(this._renderLineHighlight==="gutter"||this._renderLineHighlight==="all")&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderInContent(){return(this._renderLineHighlight==="line"||this._renderLineHighlight==="all")&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}}class lD extends cD{_renderOne(t,i){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-both":"")+(i?" current-line-exact":"")}" style="width:${Math.max(t.scrollWidth,this._contentWidth)}px;"></div>`}_shouldRenderThis(){return this._shouldRenderInContent()}_shouldRenderOther(){return this._shouldRenderInMargin()}}class aD extends cD{_renderOne(t,i){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")+(this._shouldRenderInMargin()&&i?" current-line-exact-margin":"")}" style="width:${this._contentLeft}px"></div>`}_shouldRenderThis(){return!0}_shouldRenderOther(){return this._shouldRenderInContent()}}RC(((t,i)=>{const e=t.getColor(IC);if(e&&(i.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${e}; }`),i.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${e}; border: none; }`)),!e||e.isTransparent()||t.defines(_C)){const e=t.getColor(_C);e&&(i.addRule(`.monaco-editor .view-overlays .current-line-exact { border: 2px solid ${e}; }`),i.addRule(`.monaco-editor .margin-view-overlays .current-line-exact-margin { border: 2px solid ${e}; }`),lk(t.type)&&(i.addRule(".monaco-editor .view-overlays .current-line-exact { border-width: 1px; }"),i.addRule(".monaco-editor .margin-view-overlays .current-line-exact-margin { border-width: 1px; }")))}}));class uD extends EC{constructor(t){super(),this._context=t;const i=this._context.configuration.options;this._typicalHalfwidthCharacterWidth=i.get(50).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(t){const i=this._context.configuration.options;return this._typicalHalfwidthCharacterWidth=i.get(50).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged||t.scrollWidthChanged}onZonesChanged(t){return!0}prepareRender(t){const i=t.getDecorationsInViewport();let e=[],s=0;for(let t=0,n=i.length;t<n;t++){const n=i[t];n.options.className&&(e[s++]=n)}e=e.sort(((t,i)=>{if(t.options.zIndex<i.options.zIndex)return-1;if(t.options.zIndex>i.options.zIndex)return 1;const e=t.options.className,s=i.options.className;return e<s?-1:e>s?1:Cs.compareRangesUsingStarts(t.range,i.range)}));const n=t.visibleRange.startLineNumber,r=t.visibleRange.endLineNumber,o=[];for(let t=n;t<=r;t++)o[t-n]="";this._renderWholeLineDecorations(t,e,o),this._renderNormalDecorations(t,e,o),this._renderResult=o}_renderWholeLineDecorations(t,i,e){const s=t.visibleRange.startLineNumber,n=t.visibleRange.endLineNumber;for(let t=0,r=i.length;t<r;t++){const r=i[t];if(!r.options.isWholeLine)continue;const o='<div class="cdr '+r.options.className+'" style="left:0;width:100%;"></div>',h=Math.max(r.range.startLineNumber,s),c=Math.min(r.range.endLineNumber,n);for(let t=h;t<=c;t++)e[t-s]+=o}}_renderNormalDecorations(t,i,e){var s;const n=t.visibleRange.startLineNumber;let r=null,o=!1,h=null,c=!1;for(let l=0,a=i.length;l<a;l++){const a=i[l];if(a.options.isWholeLine)continue;const u=a.options.className,d=!!a.options.showIfCollapsed;let f=a.range;d&&f.endColumn===1&&f.endLineNumber!==f.startLineNumber&&(f=new Cs(f.startLineNumber,f.startColumn,f.endLineNumber-1,this._context.viewModel.getLineMaxColumn(f.endLineNumber-1))),r===u&&o===d&&Cs.areIntersectingOrTouching(h,f)?h=Cs.plusRange(h,f):(r!==null&&this._renderNormalDecoration(t,h,r,c,o,n,e),r=u,o=d,h=f,c=(s=a.options.shouldFillLineOnLineBreak)!==null&&s!==void 0&&s)}r!==null&&this._renderNormalDecoration(t,h,r,c,o,n,e)}_renderNormalDecoration(t,i,e,s,n,r,o){const h=t.linesVisibleRangesForRange(i,e==="findMatch");if(h)for(let t=0,i=h.length;t<i;t++){const i=h[t];if(i.outsideRenderedLine)continue;const c=i.lineNumber-r;if(n&&i.ranges.length===1){const t=i.ranges[0];if(t.width<this._typicalHalfwidthCharacterWidth){const e=Math.round(t.left+t.width/2),s=Math.max(0,Math.round(e-this._typicalHalfwidthCharacterWidth/2));i.ranges[0]=new sk(s,this._typicalHalfwidthCharacterWidth)}}for(let t=0,n=i.ranges.length;t<n;t++){const r=s&&i.continuesOnNextLine&&n===1,h=i.ranges[t],l='<div class="cdr '+e+'" style="left:'+String(h.left)+"px;width:"+(r?"100%;":String(h.width)+"px;")+'"></div>';o[c]+=l}}}render(t,i){if(!this._renderResult)return"";const e=i-t;return e<0||e>=this._renderResult.length?"":this._renderResult[e]}}class dD extends Yy{constructor(t,i,e,s){super(t);const n=this._context.configuration.options,r=n.get(103),o=n.get(75),h=n.get(40),c=n.get(106),l={listenOnDomNode:e.domNode,className:"editor-scrollable "+LC(t.theme.type),useShadows:!1,lazyRender:!0,vertical:r.vertical,horizontal:r.horizontal,verticalHasArrows:r.verticalHasArrows,horizontalHasArrows:r.horizontalHasArrows,verticalScrollbarSize:r.verticalScrollbarSize,verticalSliderSize:r.verticalSliderSize,horizontalScrollbarSize:r.horizontalScrollbarSize,horizontalSliderSize:r.horizontalSliderSize,handleMouseWheel:r.handleMouseWheel,alwaysConsumeMouseWheel:r.alwaysConsumeMouseWheel,arrowSize:r.arrowSize,mouseWheelScrollSensitivity:o,fastScrollSensitivity:h,scrollPredominantAxis:c,scrollByPage:r.scrollByPage};this.scrollbar=this._register(new nC(i.domNode,l,this._context.viewLayout.getScrollable())),Xy.write(this.scrollbar.getDomNode(),6),this.scrollbarDomNode=Sl(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();const a=(t,i,e)=>{const s={};{const i=t.scrollTop;i&&(s.scrollTop=this._context.viewLayout.getCurrentScrollTop()+i,t.scrollTop=0)}if(e){const i=t.scrollLeft;i&&(s.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+i,t.scrollLeft=0)}this._context.viewModel.viewLayout.setScrollPosition(s,1)};this._register(sc(e.domNode,"scroll",(t=>a(e.domNode,0,!0)))),this._register(sc(i.domNode,"scroll",(t=>a(i.domNode,0,!1)))),this._register(sc(s.domNode,"scroll",(t=>a(s.domNode,0,!1)))),this._register(sc(this.scrollbarDomNode.domNode,"scroll",(t=>a(this.scrollbarDomNode.domNode,0,!1))))}dispose(){super.dispose()}_setLayout(){const t=this._context.configuration.options,i=t.get(145);this.scrollbarDomNode.setLeft(i.contentLeft),t.get(73).side==="right"?this.scrollbarDomNode.setWidth(i.contentWidth+i.minimap.minimapWidth):this.scrollbarDomNode.setWidth(i.contentWidth),this.scrollbarDomNode.setHeight(i.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarPointerDown(t){this.scrollbar.delegateVerticalScrollbarPointerDown(t)}delegateScrollFromMouseWheelEvent(t){this.scrollbar.delegateScrollFromMouseWheelEvent(t)}onConfigurationChanged(t){if(t.hasChanged(103)||t.hasChanged(75)||t.hasChanged(40)){const t=this._context.configuration.options,i=t.get(103),e=t.get(75),s=t.get(40),n=t.get(106),r={vertical:i.vertical,horizontal:i.horizontal,verticalScrollbarSize:i.verticalScrollbarSize,horizontalScrollbarSize:i.horizontalScrollbarSize,scrollByPage:i.scrollByPage,handleMouseWheel:i.handleMouseWheel,mouseWheelScrollSensitivity:e,fastScrollSensitivity:s,scrollPredominantAxis:n};this.scrollbar.updateOptions(r)}return t.hasChanged(145)&&this._setLayout(),!0}onScrollChanged(t){return!0}onThemeChanged(t){return this.scrollbar.updateClassName("editor-scrollable "+LC(this._context.theme.type)),!0}prepareRender(t){}render(t){this.scrollbar.renderNow()}}class fD{constructor(t,i,e,s,n){this.startLineNumber=t,this.endLineNumber=i,this.className=e,this.tooltip=s,this._decorationToRenderBrand=void 0,this.zIndex=n??0}}class gD{constructor(t,i,e){this.className=t,this.zIndex=i,this.tooltip=e}}class pD{constructor(){this.decorations=[]}add(t){this.decorations.push(t)}getDecorations(){return this.decorations}}class mD extends EC{_render(t,i,e){const s=[];for(let e=t;e<=i;e++)s[e-t]=new pD;if(e.length===0)return s;e.sort(((t,i)=>t.className===i.className?t.startLineNumber===i.startLineNumber?t.endLineNumber-i.endLineNumber:t.startLineNumber-i.startLineNumber:t.className<i.className?-1:1));let n=null,r=0;for(let o=0,h=e.length;o<h;o++){const h=e[o],c=h.className,l=h.zIndex;let a=Math.max(h.startLineNumber,t)-t;const u=Math.min(h.endLineNumber,i)-t;n===c?(a=Math.max(r+1,a),r=Math.max(r,u)):(n=c,r=u);for(let t=a;t<=r;t++)s[t].add(new gD(c,l,h.tooltip))}return s}}class wD extends Yy{constructor(t){super(t),this._widgets={},this._context=t;const i=this._context.configuration.options,e=i.get(145);this.domNode=Sl(document.createElement("div")),this.domNode.setClassName("glyph-margin-widgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this._lineHeight=i.get(67),this._glyphMargin=i.get(57),this._glyphMarginLeft=e.glyphMarginLeft,this._glyphMarginWidth=e.glyphMarginWidth,this._glyphMarginDecorationLaneCount=e.glyphMarginDecorationLaneCount,this._managedDomNodes=[],this._decorationGlyphsToRender=[]}dispose(){this._managedDomNodes=[],this._decorationGlyphsToRender=[],this._widgets={},super.dispose()}getWidgets(){return Object.values(this._widgets)}onConfigurationChanged(t){const i=this._context.configuration.options,e=i.get(145);return this._lineHeight=i.get(67),this._glyphMargin=i.get(57),this._glyphMarginLeft=e.glyphMarginLeft,this._glyphMarginWidth=e.glyphMarginWidth,this._glyphMarginDecorationLaneCount=e.glyphMarginDecorationLaneCount,!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged}onZonesChanged(t){return!0}addWidget(t){const i=Sl(t.getDomNode());this._widgets[t.getId()]={widget:t,preference:t.getPosition(),domNode:i,renderInfo:null},i.setPosition("absolute"),i.setDisplay("none"),i.setAttribute("widgetId",t.getId()),this.domNode.appendChild(i),this.setShouldRender()}setWidgetPosition(t,i){const e=this._widgets[t.getId()];return(e.preference.lane!==i.lane||e.preference.zIndex!==i.zIndex||!Cs.equalsRange(e.preference.range,i.range))&&(e.preference=i,this.setShouldRender(),!0)}removeWidget(t){var i;const e=t.getId();if(this._widgets[e]){const t=this._widgets[e].domNode.domNode;delete this._widgets[e],(i=t.parentNode)===null||i===void 0||i.removeChild(t),this.setShouldRender()}}_collectDecorationBasedGlyphRenderRequest(t,i){var e,s,n;const r=t.visibleRange.startLineNumber,o=t.visibleRange.endLineNumber,h=t.getDecorationsInViewport();for(const t of h){const h=t.options.glyphMarginClassName;if(!h)continue;const c=Math.max(t.range.startLineNumber,r),l=Math.min(t.range.endLineNumber,o),a=(s=(e=t.options.glyphMargin)===null||e===void 0?void 0:e.position)!==null&&s!==void 0?s:Xf.Center,u=(n=t.options.zIndex)!==null&&n!==void 0?n:0;for(let t=c;t<=l;t++){const e=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new ks(t,0)),s=this._context.viewModel.glyphLanes.getLanesAtLine(e.lineNumber).indexOf(a);i.push(new vD(t,s,u,h))}}}_collectWidgetBasedGlyphRenderRequest(t,i){const e=t.visibleRange.startLineNumber,s=t.visibleRange.endLineNumber;for(const t of Object.values(this._widgets)){const n=t.preference.range,{startLineNumber:r,endLineNumber:o}=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(Cs.lift(n));if(!r||!o||o<e||r>s)continue;const h=Math.max(r,e),c=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new ks(h,0)),l=this._context.viewModel.glyphLanes.getLanesAtLine(c.lineNumber).indexOf(t.preference.lane);i.push(new bD(h,l,t.preference.zIndex,t))}}_collectSortedGlyphRenderRequests(t){const i=[];return this._collectDecorationBasedGlyphRenderRequest(t,i),this._collectWidgetBasedGlyphRenderRequest(t,i),i.sort(((t,i)=>t.lineNumber===i.lineNumber?t.laneIndex===i.laneIndex?t.zIndex===i.zIndex?i.type===t.type?t.type===0&&i.type===0?t.className<i.className?-1:1:0:i.type-t.type:i.zIndex-t.zIndex:t.laneIndex-i.laneIndex:t.lineNumber-i.lineNumber)),i}prepareRender(t){if(!this._glyphMargin)return void(this._decorationGlyphsToRender=[]);for(const t of Object.values(this._widgets))t.renderInfo=null;const i=new L(this._collectSortedGlyphRenderRequests(t)),e=[];for(;i.length>0;){const t=i.peek();if(!t)break;const s=i.takeWhile((i=>i.lineNumber===t.lineNumber&&i.laneIndex===t.laneIndex));if(!s||s.length===0)break;const n=s[0];if(n.type===0){const t=[];for(const i of s){if(i.zIndex!==n.zIndex||i.type!==n.type)break;t.length!==0&&t[t.length-1]===i.className||t.push(i.className)}e.push(n.accept(t.join(" ")))}else n.widget.renderInfo={lineNumber:n.lineNumber,laneIndex:n.laneIndex}}this._decorationGlyphsToRender=e}render(t){if(!this._glyphMargin){for(const t of Object.values(this._widgets))t.domNode.setDisplay("none");for(;this._managedDomNodes.length>0;){const t=this._managedDomNodes.pop();t==null||t.domNode.remove()}return}const i=Math.round(this._glyphMarginWidth/this._glyphMarginDecorationLaneCount);for(const e of Object.values(this._widgets))if(e.renderInfo){const s=t.viewportData.relativeVerticalOffset[e.renderInfo.lineNumber-t.viewportData.startLineNumber],n=this._glyphMarginLeft+e.renderInfo.laneIndex*this._lineHeight;e.domNode.setDisplay("block"),e.domNode.setTop(s),e.domNode.setLeft(n),e.domNode.setWidth(i),e.domNode.setHeight(this._lineHeight)}else e.domNode.setDisplay("none");for(let e=0;e<this._decorationGlyphsToRender.length;e++){const s=this._decorationGlyphsToRender[e],n=t.viewportData.relativeVerticalOffset[s.lineNumber-t.viewportData.startLineNumber],r=this._glyphMarginLeft+s.laneIndex*this._lineHeight;let o;e<this._managedDomNodes.length?o=this._managedDomNodes[e]:(o=Sl(document.createElement("div")),this._managedDomNodes.push(o),this.domNode.appendChild(o)),o.setClassName("cgmr codicon "+s.combinedClassName),o.setPosition("absolute"),o.setTop(n),o.setLeft(r),o.setWidth(i),o.setHeight(this._lineHeight)}for(;this._managedDomNodes.length>this._decorationGlyphsToRender.length;){const t=this._managedDomNodes.pop();t==null||t.domNode.remove()}}}class vD{constructor(t,i,e,s){this.lineNumber=t,this.laneIndex=i,this.zIndex=e,this.className=s,this.type=0}accept(t){return new yD(this.lineNumber,this.laneIndex,t)}}class bD{constructor(t,i,e,s){this.lineNumber=t,this.laneIndex=i,this.zIndex=e,this.widget=s,this.type=1}}class yD{constructor(t,i,e){this.lineNumber=t,this.laneIndex=i,this.combinedClassName=e}}class kD extends Qi{constructor(){super(...arguments),this._isDisposed=!1}dispose(){super.dispose(),this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}}function CD(t,i){let e=0,s=0;const n=t.length;for(;s<n;){const n=t.charCodeAt(s);if(n===32)e++;else{if(n!==9)break;e=e-e%i+i}s++}return s===n?-1:e}(function(t){t[t.Disabled=0]="Disabled",t[t.EnabledForActive=1]="EnabledForActive",t[t.Enabled=2]="Enabled"})(Vx||(Vx={}));class SD{constructor(t,i,e,s,n,r){if(this.visibleColumn=t,this.column=i,this.className=e,this.horizontalLine=s,this.forWrappedLinesAfterColumn=n,this.forWrappedLinesBeforeOrAtColumn=r,t!==-1==(i!==-1))throw new Error}}class xD{constructor(t,i){this.top=t,this.endColumn=i}}class DD extends kD{constructor(t,i){super(),this.textModel=t,this.languageConfigurationService=i}getLanguageConfiguration(t){return this.languageConfigurationService.getLanguageConfiguration(t)}_computeIndentLevel(t){return CD(this.textModel.getLineContent(t+1),this.textModel.getOptions().tabSize)}getActiveIndentGuide(t,i,e){this.assertNotDisposed();const s=this.textModel.getLineCount();if(t<1||t>s)throw new zi("Illegal value for lineNumber");const n=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,r=!!(n&&n.offSide);let o=-2,h=-1,c=-2,l=-1;const a=t=>{if(o!==-1&&(o===-2||o>t-1)){o=-1,h=-1;for(let i=t-2;i>=0;i--){const t=this._computeIndentLevel(i);if(t>=0){o=i,h=t;break}}}if(c===-2){c=-1,l=-1;for(let i=t;i<s;i++){const t=this._computeIndentLevel(i);if(t>=0){c=i,l=t;break}}}};let u=-2,d=-1,f=-2,g=-1;const p=t=>{if(u===-2){u=-1,d=-1;for(let i=t-2;i>=0;i--){const t=this._computeIndentLevel(i);if(t>=0){u=i,d=t;break}}}if(f!==-1&&(f===-2||f<t-1)){f=-1,g=-1;for(let i=t;i<s;i++){const t=this._computeIndentLevel(i);if(t>=0){f=i,g=t;break}}}};let m=0,w=!0,v=0,b=!0,y=0,k=0;for(let n=0;w||b;n++){const o=t-n,f=t+n;n>1&&(o<1||o<i)&&(w=!1),n>1&&(f>s||f>e)&&(b=!1),n>5e4&&(w=!1,b=!1);let C=-1;if(w&&o>=1){const t=this._computeIndentLevel(o-1);t>=0?(c=o-1,l=t,C=Math.ceil(t/this.textModel.getOptions().indentSize)):(a(o),C=this._getIndentLevelForWhitespaceLine(r,h,l))}let S=-1;if(b&&f<=s){const t=this._computeIndentLevel(f-1);t>=0?(u=f-1,d=t,S=Math.ceil(t/this.textModel.getOptions().indentSize)):(p(f),S=this._getIndentLevelForWhitespaceLine(r,d,g))}if(n!==0){if(n===1){if(f<=s&&S>=0&&k+1===S){w=!1,m=f,v=f,y=S;continue}if(o>=1&&C>=0&&C-1===k){b=!1,m=o,v=o,y=C;continue}if(m=t,v=t,y=k,y===0)return{startLineNumber:m,endLineNumber:v,indent:y}}w&&(C>=y?m=o:w=!1),b&&(S>=y?v=f:b=!1)}else k=C}return{startLineNumber:m,endLineNumber:v,indent:y}}getLinesBracketGuides(t,i,e,s){var n;const r=[];for(let e=t;e<=i;e++)r.push([]);const o=this.textModel.bracketPairs.getBracketPairsInRangeWithMinIndentation(new Cs(t,1,i,this.textModel.getLineMaxColumn(i))).toArray();let h;e&&o.length>0&&(h=(n=yg((t<=e.lineNumber&&e.lineNumber<=i?o:this.textModel.bracketPairs.getBracketPairsInRange(Cs.fromPositions(e)).toArray()).filter((t=>Cs.strictContainsPosition(t.range,e))),(t=>!0)))===null||n===void 0?void 0:n.range);const c=this.textModel.getOptions().bracketPairColorizationOptions.independentColorPoolPerBracketType,l=new ED;for(const e of o){if(!e.closingBracketRange)continue;const n=h&&e.range.equalsRange(h);if(!n&&!s.includeInactive)continue;const o=l.getInlineClassName(e.nestingLevel,e.nestingLevelOfEqualBracketType,c)+(s.highlightActive&&n?" "+l.activeClassName:""),a=e.openingBracketRange.getStartPosition(),u=e.closingBracketRange.getStartPosition(),d=s.horizontalGuides===Vx.Enabled||s.horizontalGuides===Vx.EnabledForActive&&n;if(e.range.startLineNumber===e.range.endLineNumber){d&&r[e.range.startLineNumber-t].push(new SD(-1,e.openingBracketRange.getEndPosition().column,o,new xD(!1,u.column),-1,-1));continue}const f=this.getVisibleColumnFromPosition(u),g=this.getVisibleColumnFromPosition(e.openingBracketRange.getStartPosition()),p=Math.min(g,f,e.minVisibleColumnIndentation+1);let m=!1;tr(this.textModel.getLineContent(e.closingBracketRange.startLineNumber))<e.closingBracketRange.startColumn-1&&(m=!0);const w=Math.max(a.lineNumber,t),v=Math.min(u.lineNumber,i),b=m?1:0;for(let i=w;i<v+b;i++)r[i-t].push(new SD(p,-1,o,null,i===a.lineNumber?a.column:-1,i===u.lineNumber?u.column:-1));d&&(a.lineNumber>=t&&g>p&&r[a.lineNumber-t].push(new SD(p,-1,o,new xD(!1,a.column),-1,-1)),u.lineNumber<=i&&f>p&&r[u.lineNumber-t].push(new SD(p,-1,o,new xD(!m,u.column),-1,-1)))}for(const t of r)t.sort(((t,i)=>t.visibleColumn-i.visibleColumn));return r}getVisibleColumnFromPosition(t){return Ck.visibleColumnFromColumn(this.textModel.getLineContent(t.lineNumber),t.column,this.textModel.getOptions().tabSize)+1}getLinesIndentGuides(t,i){this.assertNotDisposed();const e=this.textModel.getLineCount();if(t<1||t>e)throw new Error("Illegal value for startLineNumber");if(i<1||i>e)throw new Error("Illegal value for endLineNumber");const s=this.textModel.getOptions(),n=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,r=!!(n&&n.offSide),o=new Array(i-t+1);let h=-2,c=-1,l=-2,a=-1;for(let n=t;n<=i;n++){const i=n-t,u=this._computeIndentLevel(n-1);if(u>=0)h=n-1,c=u,o[i]=Math.ceil(u/s.indentSize);else{if(h===-2){h=-1,c=-1;for(let t=n-2;t>=0;t--){const i=this._computeIndentLevel(t);if(i>=0){h=t,c=i;break}}}if(l!==-1&&(l===-2||l<n-1)){l=-1,a=-1;for(let t=n;t<e;t++){const i=this._computeIndentLevel(t);if(i>=0){l=t,a=i;break}}}o[i]=this._getIndentLevelForWhitespaceLine(r,c,a)}}return o}_getIndentLevelForWhitespaceLine(t,i,e){const s=this.textModel.getOptions();return i===-1||e===-1?0:i<e?1+Math.floor(i/s.indentSize):i===e||t?Math.ceil(e/s.indentSize):1+Math.floor(e/s.indentSize)}}class ED{constructor(){this.activeClassName="indent-active"}getInlineClassName(t,i,e){return this.getInlineClassNameOfLevel(e?i:t)}getInlineClassNameOfLevel(t){return"bracket-indent-guide lvl-"+t%30}}class AD extends EC{constructor(t){super(),this._context=t,this._primaryPosition=null;const i=this._context.configuration.options,e=i.get(146),s=i.get(50);this._spaceWidth=s.spaceWidth,this._maxIndentLeft=e.wrappingColumn===-1?-1:e.wrappingColumn*s.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=i.get(16),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(t){const i=this._context.configuration.options,e=i.get(146),s=i.get(50);return this._spaceWidth=s.spaceWidth,this._maxIndentLeft=e.wrappingColumn===-1?-1:e.wrappingColumn*s.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=i.get(16),!0}onCursorStateChanged(t){var i;const e=t.selections[0].getPosition();return!(!((i=this._primaryPosition)===null||i===void 0)&&i.equals(e))&&(this._primaryPosition=e,!0)}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged}onZonesChanged(t){return!0}onLanguageConfigurationChanged(t){return!0}prepareRender(t){var i,e,s,n;if(!this._bracketPairGuideOptions.indentation&&this._bracketPairGuideOptions.bracketPairs===!1)return void(this._renderResult=null);const r=t.visibleRange.startLineNumber,o=t.visibleRange.endLineNumber,h=t.scrollWidth,c=this._primaryPosition,l=this.getGuidesByLine(r,Math.min(o+1,this._context.viewModel.getLineCount()),c),a=[];for(let c=r;c<=o;c++){const o=c-r,u=l[o];let d="";const f=(e=(i=t.visibleRangeForPosition(new ks(c,1)))===null||i===void 0?void 0:i.left)!==null&&e!==void 0?e:0;for(const i of u){const e=i.column===-1?f+(i.visibleColumn-1)*this._spaceWidth:t.visibleRangeForPosition(new ks(c,i.column)).left;if(e>h||this._maxIndentLeft>0&&e>this._maxIndentLeft)break;const r=i.horizontalLine?i.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",o=i.horizontalLine?((n=(s=t.visibleRangeForPosition(new ks(c,i.horizontalLine.endColumn)))===null||s===void 0?void 0:s.left)!==null&&n!==void 0?n:e+this._spaceWidth)-e:this._spaceWidth;d+=`<div class="core-guide ${i.className} ${r}" style="left:${e}px;width:${o}px"></div>`}a[o]=d}this._renderResult=a}getGuidesByLine(t,i,e){const s=this._bracketPairGuideOptions.bracketPairs!==!1?this._context.viewModel.getBracketGuidesInRangeByLine(t,i,e,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:this._bracketPairGuideOptions.bracketPairsHorizontal===!0?Vx.Enabled:this._bracketPairGuideOptions.bracketPairsHorizontal==="active"?Vx.EnabledForActive:Vx.Disabled,includeInactive:this._bracketPairGuideOptions.bracketPairs===!0}):null,n=this._bracketPairGuideOptions.indentation?this._context.viewModel.getLinesIndentGuides(t,i):null;let r=0,o=0,h=0;if(this._bracketPairGuideOptions.highlightActiveIndentation!==!1&&e){const s=this._context.viewModel.getActiveIndentGuide(e.lineNumber,t,i);r=s.startLineNumber,o=s.endLineNumber,h=s.indent}const{indentSize:c}=this._context.viewModel.model.getOptions(),l=[];for(let e=t;e<=i;e++){const i=new Array;l.push(i);const a=s?s[e-t]:[],u=new L(a),d=n?n[e-t]:0;for(let t=1;t<=d;t++){const s=(t-1)*c+1,n=(this._bracketPairGuideOptions.highlightActiveIndentation==="always"||a.length===0)&&r<=e&&e<=o&&t===h;i.push(...u.takeWhile((t=>t.visibleColumn<s))||[]);const l=u.peek();l&&l.visibleColumn===s&&!l.horizontalLine||i.push(new SD(s,-1,"core-guide-indent lvl-"+(t-1)%30+(n?" indent-active":""),null,-1,-1))}i.push(...u.takeWhile((t=>!0))||[])}return l}render(t,i){if(!this._renderResult)return"";const e=i-t;return e<0||e>=this._renderResult.length?"":this._renderResult[e]}}function MD(t){if(!t||!t.isTransparent())return t}RC(((t,i)=>{const e=[{bracketColor:gS,guideColor:kS,guideColorActive:AS},{bracketColor:pS,guideColor:CS,guideColorActive:MS},{bracketColor:mS,guideColor:SS,guideColorActive:LS},{bracketColor:wS,guideColor:xS,guideColorActive:FS},{bracketColor:vS,guideColor:DS,guideColorActive:TS},{bracketColor:bS,guideColor:ES,guideColorActive:RS}],s=new ED,n=[{indentColor:KC,indentColorActive:YC},{indentColor:qC,indentColorActive:XC},{indentColor:GC,indentColorActive:tS},{indentColor:ZC,indentColorActive:iS},{indentColor:JC,indentColorActive:eS},{indentColor:QC,indentColorActive:sS}],r=e.map((i=>{var e,s;const n=t.getColor(i.bracketColor),r=t.getColor(i.guideColor),o=t.getColor(i.guideColorActive),h=MD((e=MD(r))!==null&&e!==void 0?e:n==null?void 0:n.transparent(.3)),c=MD((s=MD(o))!==null&&s!==void 0?s:n);if(h&&c)return{guideColor:h,guideColorActive:c}})).filter($),o=n.map((i=>{const e=t.getColor(i.indentColor),s=t.getColor(i.indentColorActive),n=MD(e),r=MD(s);if(n&&r)return{indentColor:n,indentColorActive:r}})).filter($);if(r.length>0){for(let t=0;t<30;t++){const e=r[t%r.length];i.addRule(`.monaco-editor .${s.getInlineClassNameOfLevel(t).replace(/ /g,".")} { --guide-color: ${e.guideColor}; --guide-color-active: ${e.guideColorActive}; }`)}i.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),i.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),i.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),i.addRule(`.monaco-editor .vertical.${s.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),i.addRule(`.monaco-editor .horizontal-top.${s.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),i.addRule(`.monaco-editor .horizontal-bottom.${s.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}if(o.length>0){for(let t=0;t<30;t++){const e=o[t%o.length];i.addRule(`.monaco-editor .lines-content .core-guide-indent.lvl-${t} { --indent-color: ${e.indentColor}; --indent-color-active: ${e.indentColorActive}; }`)}i.addRule(".monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 var(--indent-color) inset; }"),i.addRule(".monaco-editor .lines-content .core-guide-indent.indent-active { box-shadow: 1px 0 0 0 var(--indent-color-active) inset; }")}}));class LD{get didDomLayout(){return this._didDomLayout}readClientRect(){if(!this._clientRectRead){this._clientRectRead=!0;const t=this._domNode.getBoundingClientRect();this.markDidDomLayout(),this._clientRectDeltaLeft=t.left,this._clientRectScale=t.width/this._domNode.offsetWidth}}get clientRectDeltaLeft(){return this._clientRectRead||this.readClientRect(),this._clientRectDeltaLeft}get clientRectScale(){return this._clientRectRead||this.readClientRect(),this._clientRectScale}constructor(t,i){this._domNode=t,this.endNode=i,this._didDomLayout=!1,this._clientRectDeltaLeft=0,this._clientRectScale=1,this._clientRectRead=!1}markDidDomLayout(){this._didDomLayout=!0}}class FD{constructor(){this._currentVisibleRange=new Cs(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(t){this._currentVisibleRange=t}}class TD{constructor(t,i,e,s,n,r,o){this.minimalReveal=t,this.lineNumber=i,this.startColumn=e,this.endColumn=s,this.startScrollTop=n,this.stopScrollTop=r,this.scrollType=o,this.type="range",this.minLineNumber=i,this.maxLineNumber=i}}class RD{constructor(t,i,e,s,n){this.minimalReveal=t,this.selections=i,this.startScrollTop=e,this.stopScrollTop=s,this.scrollType=n,this.type="selections";let r=i[0].startLineNumber,o=i[0].endLineNumber;for(let t=1,e=i.length;t<e;t++){const e=i[t];r=Math.min(r,e.startLineNumber),o=Math.max(o,e.endLineNumber)}this.minLineNumber=r,this.maxLineNumber=o}}class OD extends Yy{constructor(t,i){super(t),this._linesContent=i,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new Gx(this),this.domNode=this._visibleLines.domNode;const e=this._context.configuration,s=this._context.configuration.options,n=s.get(50),r=s.get(146);this._lineHeight=s.get(67),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._isViewportWrapping=r.isViewportWrapping,this._revealHorizontalRightPadding=s.get(100),this._cursorSurroundingLines=s.get(29),this._cursorSurroundingLinesStyle=s.get(30),this._canUseLayerHinting=!s.get(32),this._viewLineOptions=new fk(e,this._context.theme.type),Xy.write(this.domNode,8),this.domNode.setClassName(`view-lines ${_S}`),xl(this.domNode,n),this._maxLineWidth=0,this._asyncUpdateLineWidths=new Co((()=>{this._updateLineWidthsSlow()}),200),this._asyncCheckMonospaceFontAssumptions=new Co((()=>{this._checkMonospaceFontAssumptions()}),2e3),this._lastRenderedData=new FD,this._horizontalRevealRequest=null,this._stickyScrollEnabled=s.get(115).enabled,this._maxNumberStickyLines=s.get(115).maxLineCount}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}createVisibleLine(){return new gk(this._viewLineOptions)}onConfigurationChanged(t){this._visibleLines.onConfigurationChanged(t),t.hasChanged(146)&&(this._maxLineWidth=0);const i=this._context.configuration.options,e=i.get(50),s=i.get(146);return this._lineHeight=i.get(67),this._typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this._isViewportWrapping=s.isViewportWrapping,this._revealHorizontalRightPadding=i.get(100),this._cursorSurroundingLines=i.get(29),this._cursorSurroundingLinesStyle=i.get(30),this._canUseLayerHinting=!i.get(32),this._stickyScrollEnabled=i.get(115).enabled,this._maxNumberStickyLines=i.get(115).maxLineCount,xl(this.domNode,e),this._onOptionsMaybeChanged(),t.hasChanged(145)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){const t=this._context.configuration,i=new fk(t,this._context.theme.type);if(!this._viewLineOptions.equals(i)){this._viewLineOptions=i;const t=this._visibleLines.getStartLineNumber(),e=this._visibleLines.getEndLineNumber();for(let i=t;i<=e;i++)this._visibleLines.getVisibleLine(i).onOptionsChanged(this._viewLineOptions);return!0}return!1}onCursorStateChanged(t){const i=this._visibleLines.getStartLineNumber(),e=this._visibleLines.getEndLineNumber();let s=!1;for(let t=i;t<=e;t++)s=this._visibleLines.getVisibleLine(t).onSelectionChanged()||s;return s}onDecorationsChanged(t){{const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let e=t;e<=i;e++)this._visibleLines.getVisibleLine(e).onDecorationsChanged()}return!0}onFlushed(t){const i=this._visibleLines.onFlushed(t);return this._maxLineWidth=0,i}onLinesChanged(t){return this._visibleLines.onLinesChanged(t)}onLinesDeleted(t){return this._visibleLines.onLinesDeleted(t)}onLinesInserted(t){return this._visibleLines.onLinesInserted(t)}onRevealRangeRequest(t){const i=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),t.source,t.minimalReveal,t.range,t.selections,t.verticalType);if(i===-1)return!1;let e=this._context.viewLayout.validateScrollPosition({scrollTop:i});t.revealHorizontal?t.range&&t.range.startLineNumber!==t.range.endLineNumber?e={scrollTop:e.scrollTop,scrollLeft:0}:t.range?this._horizontalRevealRequest=new TD(t.minimalReveal,t.range.startLineNumber,t.range.startColumn,t.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),e.scrollTop,t.scrollType):t.selections&&t.selections.length>0&&(this._horizontalRevealRequest=new RD(t.minimalReveal,t.selections,this._context.viewLayout.getCurrentScrollTop(),e.scrollTop,t.scrollType)):this._horizontalRevealRequest=null;const s=Math.abs(this._context.viewLayout.getCurrentScrollTop()-e.scrollTop)<=this._lineHeight?1:t.scrollType;return this._context.viewModel.viewLayout.setScrollPosition(e,s),!0}onScrollChanged(t){if(this._horizontalRevealRequest&&t.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&t.scrollTopChanged){const i=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),e=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(t.scrollTop<i||t.scrollTop>e)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(t.scrollWidth),this._visibleLines.onScrollChanged(t)||!0}onTokensChanged(t){return this._visibleLines.onTokensChanged(t)}onZonesChanged(t){return this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(t)}onThemeChanged(t){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(t,i){const e=this._getViewLineDomNode(t);if(e===null)return null;const s=this._getLineNumberFor(e);if(s===-1||s<1||s>this._context.viewModel.getLineCount())return null;if(this._context.viewModel.getLineMaxColumn(s)===1)return new ks(s,1);const n=this._visibleLines.getStartLineNumber(),r=this._visibleLines.getEndLineNumber();if(s<n||s>r)return null;let o=this._visibleLines.getVisibleLine(s).getColumnOfNodeOffset(t,i);const h=this._context.viewModel.getLineMinColumn(s);return o<h&&(o=h),new ks(s,o)}_getViewLineDomNode(t){for(;t&&t.nodeType===1;){if(t.className===gk.CLASS_NAME)return t;t=t.parentElement}return null}_getLineNumberFor(t){const i=this._visibleLines.getStartLineNumber(),e=this._visibleLines.getEndLineNumber();for(let s=i;s<=e;s++)if(t===this._visibleLines.getVisibleLine(s).getDomNode())return s;return-1}getLineWidth(t){const i=this._visibleLines.getStartLineNumber(),e=this._visibleLines.getEndLineNumber();if(t<i||t>e)return-1;const s=new LD(this.domNode.domNode,this._textRangeRestingSpot),n=this._visibleLines.getVisibleLine(t).getWidth(s);return this._updateLineWidthsSlowIfDomDidLayout(s),n}linesVisibleRangesForRange(t,i){if(this.shouldRender())return null;const e=t.endLineNumber,s=Cs.intersectRanges(t,this._lastRenderedData.getCurrentVisibleRange());if(!s)return null;const n=[];let r=0;const o=new LD(this.domNode.domNode,this._textRangeRestingSpot);let h=0;i&&(h=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new ks(s.startLineNumber,1)).lineNumber);const c=this._visibleLines.getStartLineNumber(),l=this._visibleLines.getEndLineNumber();for(let t=s.startLineNumber;t<=s.endLineNumber;t++){if(t<c||t>l)continue;const a=t===s.startLineNumber?s.startColumn:1,u=t!==s.endLineNumber,d=u?this._context.viewModel.getLineMaxColumn(t):s.endColumn,f=this._visibleLines.getVisibleLine(t).getVisibleRangesForRange(t,a,d,o);if(f){if(i&&t<e){const i=h;h=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new ks(t+1,1)).lineNumber,i!==h&&(f.ranges[f.ranges.length-1].width+=this._typicalHalfwidthCharacterWidth)}n[r++]=new ek(f.outsideRenderedLine,t,sk.from(f.ranges),u)}}return this._updateLineWidthsSlowIfDomDidLayout(o),r===0?null:n}_visibleRangesForLineRange(t,i,e){if(this.shouldRender()||t<this._visibleLines.getStartLineNumber()||t>this._visibleLines.getEndLineNumber())return null;const s=new LD(this.domNode.domNode,this._textRangeRestingSpot),n=this._visibleLines.getVisibleLine(t).getVisibleRangesForRange(t,i,e,s);return this._updateLineWidthsSlowIfDomDidLayout(s),n}visibleRangeForPosition(t){const i=this._visibleRangesForLineRange(t.lineNumber,t.column,t.column);return i?new rk(i.outsideRenderedLine,i.ranges[0].left):null}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidthsSlowIfDomDidLayout(t){t.didDomLayout&&(this._asyncUpdateLineWidths.isScheduled()||(this._asyncUpdateLineWidths.cancel(),this._updateLineWidthsSlow()))}_updateLineWidths(t){const i=this._visibleLines.getStartLineNumber(),e=this._visibleLines.getEndLineNumber();let s=1,n=!0;for(let r=i;r<=e;r++){const i=this._visibleLines.getVisibleLine(r);!t||i.getWidthIsFast()?s=Math.max(s,i.getWidth(null)):n=!1}return n&&i===1&&e===this._context.viewModel.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(s),n}_checkMonospaceFontAssumptions(){let t=-1,i=-1;const e=this._visibleLines.getStartLineNumber(),s=this._visibleLines.getEndLineNumber();for(let n=e;n<=s;n++){const e=this._visibleLines.getVisibleLine(n);if(e.needsMonospaceFontCheck()){const s=e.getWidth(null);s>i&&(i=s,t=n)}}if(t!==-1&&!this._visibleLines.getVisibleLine(t).monospaceAssumptionsAreValid())for(let t=e;t<=s;t++)this._visibleLines.getVisibleLine(t).onMonospaceAssumptionsInvalidated()}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(t){if(this._visibleLines.renderLines(t),this._lastRenderedData.setCurrentVisibleRange(t.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){const i=this._horizontalRevealRequest;if(t.startLineNumber<=i.minLineNumber&&i.maxLineNumber<=t.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();const t=this._computeScrollLeftToReveal(i);t&&(this._isViewportWrapping||this._ensureMaxLineWidth(t.maxHorizontalOffset),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:t.scrollLeft},i.scrollType))}}if(this._updateLineWidthsFast()?this._asyncUpdateLineWidths.cancel():this._asyncUpdateLineWidths.schedule(),yt&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let e=t;e<=i;e++)if(this._visibleLines.getVisibleLine(e).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");const i=this._context.viewLayout.getCurrentScrollTop()-t.bigNumbersDelta;this._linesContent.setTop(-i),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(t){const i=Math.ceil(t);this._maxLineWidth<i&&(this._maxLineWidth=i,this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(t,i,e,s,n,r){const o=t.top,h=t.height,c=o+h;let l,a,u;if(n&&n.length>0){let t=n[0].startLineNumber,i=n[0].endLineNumber;for(let e=1,s=n.length;e<s;e++){const s=n[e];t=Math.min(t,s.startLineNumber),i=Math.max(i,s.endLineNumber)}l=!1,a=this._context.viewLayout.getVerticalOffsetForLineNumber(t),u=this._context.viewLayout.getVerticalOffsetForLineNumber(i)+this._lineHeight}else{if(!s)return-1;l=!0,a=this._context.viewLayout.getVerticalOffsetForLineNumber(s.startLineNumber),u=this._context.viewLayout.getVerticalOffsetForLineNumber(s.endLineNumber)+this._lineHeight}let d,f=0,g=0;if((i==="mouse"||e)&&this._cursorSurroundingLinesStyle==="default")e||(f=this._lineHeight);else{const t=Math.min(h/this._lineHeight/2,this._cursorSurroundingLines);f=this._stickyScrollEnabled?Math.max(t,this._maxNumberStickyLines)*this._lineHeight:t*this._lineHeight,g=Math.max(0,t-1)*this._lineHeight}if(e||r!==0&&r!==4||(g+=this._lineHeight),a-=f,u+=g,u-a>h){if(!l)return-1;d=a}else if(r===5||r===6)if(r===6&&o<=a&&u<=c)d=o;else{const t=a-Math.max(5*this._lineHeight,.2*h),i=u-h;d=Math.max(i,t)}else if(r===1||r===2)if(r===2&&o<=a&&u<=c)d=o;else{const t=(a+u)/2;d=Math.max(0,t-h/2)}else d=this._computeMinimumScrolling(o,c,a,u,r===3,r===4);return d}_computeScrollLeftToReveal(t){const i=this._context.viewLayout.getCurrentViewport(),e=this._context.configuration.options.get(145),s=i.left,n=s+i.width-e.verticalScrollbarWidth;let r=1073741824,o=0;if(t.type==="range"){const i=this._visibleRangesForLineRange(t.lineNumber,t.startColumn,t.endColumn);if(!i)return null;for(const t of i.ranges)r=Math.min(r,Math.round(t.left)),o=Math.max(o,Math.round(t.left+t.width))}else for(const i of t.selections){if(i.startLineNumber!==i.endLineNumber)return null;const t=this._visibleRangesForLineRange(i.startLineNumber,i.startColumn,i.endColumn);if(!t)return null;for(const i of t.ranges)r=Math.min(r,Math.round(i.left)),o=Math.max(o,Math.round(i.left+i.width))}return t.minimalReveal||(r=Math.max(0,r-OD.HORIZONTAL_EXTRA_PX),o+=this._revealHorizontalRightPadding),t.type==="selections"&&o-r>i.width?null:{scrollLeft:this._computeMinimumScrolling(s,n,r,o),maxHorizontalOffset:o}}_computeMinimumScrolling(t,i,e,s,n,r){n=!!n,r=!!r;const o=(i|=0)-(t|=0);return(s|=0)-(e|=0)<o?n?e:r?Math.max(0,s-o):e<t?e:s>i?Math.max(0,s-o):t:e}}OD.HORIZONTAL_EXTRA_PX=30;class ID extends mD{constructor(t){super(),this._context=t;const i=this._context.configuration.options.get(145);this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(t){const i=this._context.configuration.options.get(145);return this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged}onZonesChanged(t){return!0}_getDecorations(t){var i,e;const s=t.getDecorationsInViewport(),n=[];let r=0;for(let t=0,o=s.length;t<o;t++){const o=s[t],h=o.options.linesDecorationsClassName,c=o.options.zIndex;h&&(n[r++]=new fD(o.range.startLineNumber,o.range.endLineNumber,h,(i=o.options.linesDecorationsTooltip)!==null&&i!==void 0?i:null,c));const l=o.options.firstLineDecorationClassName;l&&(n[r++]=new fD(o.range.startLineNumber,o.range.startLineNumber,l,(e=o.options.linesDecorationsTooltip)!==null&&e!==void 0?e:null,c))}return n}prepareRender(t){const i=t.visibleRange.startLineNumber,e=t.visibleRange.endLineNumber,s=this._render(i,e,this._getDecorations(t)),n='" style="left:'+this._decorationsLeft.toString()+"px;width:"+this._decorationsWidth.toString()+'px;"></div>',r=[];for(let t=i;t<=e;t++){const e=t-i,o=s[e].getDecorations();let h="";for(const t of o){let i='<div class="cldr '+t.className;t.tooltip!==null&&(i+='" title="'+t.tooltip),i+=n,h+=i}r[e]=h}this._renderResult=r}render(t,i){return this._renderResult?this._renderResult[i-t]:""}}class _D extends mD{constructor(t){super(),this._context=t,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(t){return!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged}onZonesChanged(t){return!0}_getDecorations(t){const i=t.getDecorationsInViewport(),e=[];let s=0;for(let t=0,n=i.length;t<n;t++){const n=i[t],r=n.options.marginClassName,o=n.options.zIndex;r&&(e[s++]=new fD(n.range.startLineNumber,n.range.endLineNumber,r,null,o))}return e}prepareRender(t){const i=t.visibleRange.startLineNumber,e=t.visibleRange.endLineNumber,s=this._render(i,e,this._getDecorations(t)),n=[];for(let t=i;t<=e;t++){const e=t-i,r=s[e].getDecorations();let o="";for(const t of r)o+='<div class="cmdr '+t.className+'" style=""></div>';n[e]=o}this._renderResult=n}render(t,i){return this._renderResult?this._renderResult[i-t]:""}}class PD{constructor(t,i,e,s){this._rgba8Brand=void 0,this.r=PD._clamp(t),this.g=PD._clamp(i),this.b=PD._clamp(e),this.a=PD._clamp(s)}equals(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a}static _clamp(t){return t<0?0:t>255?255:0|t}}PD.Empty=new PD(0,0,0,0);class ND extends Qi{static getInstance(){return this._INSTANCE||(this._INSTANCE=new ND),this._INSTANCE}constructor(){super(),this._onDidChange=new le,this.onDidChange=this._onDidChange.event,this._updateColorMap(),this._register(Us.onDidChange((t=>{t.changedColorMap&&this._updateColorMap()})))}_updateColorMap(){const t=Us.getColorMap();if(!t)return this._colors=[PD.Empty],void(this._backgroundIsLight=!0);this._colors=[PD.Empty];for(let i=1;i<t.length;i++){const e=t[i].rgba;this._colors[i]=new PD(e.r,e.g,e.b,Math.round(255*e.a))}const i=t[2].getRelativeLuminance();this._backgroundIsLight=i>=.5,this._onDidChange.fire(void 0)}getColor(t){return(t<1||t>=this._colors.length)&&(t=2),this._colors[t]}backgroundIsLight(){return this._backgroundIsLight}}ND._INSTANCE=null;const BD=(()=>{const t=[];for(let i=32;i<=126;i++)t.push(i);return t.push(65533),t})();class $D{constructor(t,i){this.scale=i,this._minimapCharRendererBrand=void 0,this.charDataNormal=$D.soften(t,.8),this.charDataLight=$D.soften(t,50/60)}static soften(t,i){const e=new Uint8ClampedArray(t.length);for(let s=0,n=t.length;s<n;s++)e[s]=Af(t[s]*i);return e}renderChar(t,i,e,s,n,r,o,h,c,l,a){const u=1*this.scale,d=2*this.scale,f=a?1:d;if(i+u>t.width||e+f>t.height)return void console.warn("bad render request outside image data");const g=l?this.charDataLight:this.charDataNormal,p=((t,i)=>(t-=32)<0||t>96?i<=2?(t+96)%96:95:t)(s,c),m=4*t.width,w=o.r,v=o.g,b=o.b,y=n.r-w,k=n.g-v,C=n.b-b,S=Math.max(r,h),x=t.data;let D=p*u*d,E=e*m+4*i;for(let t=0;t<f;t++){let t=E;for(let i=0;i<u;i++){const i=g[D++]/255*(r/255);x[t++]=w+y*i,x[t++]=v+k*i,x[t++]=b+C*i,x[t++]=S}E+=m}}blockRenderChar(t,i,e,s,n,r,o,h){const c=1*this.scale,l=2*this.scale,a=h?1:l;if(i+c>t.width||e+a>t.height)return void console.warn("bad render request outside image data");const u=4*t.width,d=n/255*.5,f=r.r,g=r.g,p=r.b,m=f+(s.r-f)*d,w=g+(s.g-g)*d,v=p+(s.b-p)*d,b=Math.max(n,o),y=t.data;let k=e*u+4*i;for(let t=0;t<a;t++){let t=k;for(let i=0;i<c;i++)y[t++]=m,y[t++]=w,y[t++]=v,y[t++]=b;k+=u}}}const WD={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},jD=t=>{const i=new Uint8ClampedArray(t.length/2);for(let e=0;e<t.length;e+=2)i[e>>1]=WD[t[e]]<<4|15&WD[t[e+1]];return i},HD={1:Ui((()=>jD("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792"))),2:Ui((()=>jD("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126")))};class VD{static create(t,i){if(this.lastCreated&&t===this.lastCreated.scale&&i===this.lastFontFamily)return this.lastCreated;let e;return e=HD[t]?new $D(HD[t](),t):VD.createFromSampleData(VD.createSampleData(i).data,t),this.lastFontFamily=i,this.lastCreated=e,e}static createSampleData(t){const i=document.createElement("canvas"),e=i.getContext("2d");i.style.height="16px",i.height=16,i.width=960,i.style.width="960px",e.fillStyle="#ffffff",e.font=`bold 16px ${t}`,e.textBaseline="middle";let s=0;for(const t of BD)e.fillText(String.fromCharCode(t),s,8),s+=10;return e.getImageData(0,0,960,16)}static createFromSampleData(t,i){if(t.length!==61440)throw new Error("Unexpected source in MinimapCharRenderer");const e=VD._downsample(t,i);return new $D(e,i)}static _downsampleChar(t,i,e,s,n){const r=1*n,o=2*n;let h=s,c=0;for(let s=0;s<o;s++){const n=s/o*16,l=(s+1)/o*16;for(let s=0;s<r;s++){const o=s/r*10,a=(s+1)/r*10;let u=0,d=0;for(let e=n;e<l;e++){const s=i+3840*Math.floor(e),n=1-(e-Math.floor(e));for(let i=o;i<a;i++){const e=1-(i-Math.floor(i)),r=s+4*Math.floor(i),o=e*n;d+=o,u+=t[r]*t[r+3]/255*o}}const f=u/d;c=Math.max(c,f),e[h++]=Af(f)}}return c}static _downsample(t,i){const e=2*i*1*i,s=96*e,n=new Uint8ClampedArray(s);let r=0,o=0,h=0;for(let s=0;s<96;s++)h=Math.max(h,this._downsampleChar(t,o,n,r,i)),r+=e,o+=40;if(h>0){const t=255/h;for(let i=0;i<s;i++)n[i]*=t}return n}}const zD=vt?'"Segoe WPC", "Segoe UI", sans-serif':bt?"-apple-system, BlinkMacSystemFont, sans-serif":'system-ui, "Ubuntu", "Droid Sans", sans-serif';class UD{constructor(t,i,e){const s=t.options,n=s.get(143),r=s.get(145),o=r.minimap,h=s.get(50),c=s.get(73);this.renderMinimap=o.renderMinimap,this.size=c.size,this.minimapHeightIsEditorHeight=o.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=s.get(105),this.paddingTop=s.get(84).top,this.paddingBottom=s.get(84).bottom,this.showSlider=c.showSlider,this.autohide=c.autohide,this.pixelRatio=n,this.typicalHalfwidthCharacterWidth=h.typicalHalfwidthCharacterWidth,this.lineHeight=s.get(67),this.minimapLeft=o.minimapLeft,this.minimapWidth=o.minimapWidth,this.minimapHeight=r.height,this.canvasInnerWidth=o.minimapCanvasInnerWidth,this.canvasInnerHeight=o.minimapCanvasInnerHeight,this.canvasOuterWidth=o.minimapCanvasOuterWidth,this.canvasOuterHeight=o.minimapCanvasOuterHeight,this.isSampling=o.minimapIsSampling,this.editorHeight=r.height,this.fontScale=o.minimapScale,this.minimapLineHeight=o.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.sectionHeaderFontFamily=zD,this.sectionHeaderFontSize=c.sectionHeaderFontSize*n,this.sectionHeaderFontColor=UD._getSectionHeaderColor(i,e.getColor(1)),this.charRenderer=Ui((()=>VD.create(this.fontScale,h.fontFamily))),this.defaultBackgroundColor=e.getColor(2),this.backgroundColor=UD._getMinimapBackground(i,this.defaultBackgroundColor),this.foregroundAlpha=UD._getMinimapForegroundOpacity(i)}static _getMinimapBackground(t,i){const e=t.getColor(ub);return e?new PD(e.rgba.r,e.rgba.g,e.rgba.b,Math.round(255*e.rgba.a)):i}static _getMinimapForegroundOpacity(t){const i=t.getColor(db);return i?PD._clamp(Math.round(255*i.rgba.a)):255}static _getSectionHeaderColor(t,i){const e=t.getColor(nv);return e?new PD(e.rgba.r,e.rgba.g,e.rgba.b,Math.round(255*e.rgba.a)):i}equals(t){return this.renderMinimap===t.renderMinimap&&this.size===t.size&&this.minimapHeightIsEditorHeight===t.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===t.scrollBeyondLastLine&&this.paddingTop===t.paddingTop&&this.paddingBottom===t.paddingBottom&&this.showSlider===t.showSlider&&this.autohide===t.autohide&&this.pixelRatio===t.pixelRatio&&this.typicalHalfwidthCharacterWidth===t.typicalHalfwidthCharacterWidth&&this.lineHeight===t.lineHeight&&this.minimapLeft===t.minimapLeft&&this.minimapWidth===t.minimapWidth&&this.minimapHeight===t.minimapHeight&&this.canvasInnerWidth===t.canvasInnerWidth&&this.canvasInnerHeight===t.canvasInnerHeight&&this.canvasOuterWidth===t.canvasOuterWidth&&this.canvasOuterHeight===t.canvasOuterHeight&&this.isSampling===t.isSampling&&this.editorHeight===t.editorHeight&&this.fontScale===t.fontScale&&this.minimapLineHeight===t.minimapLineHeight&&this.minimapCharWidth===t.minimapCharWidth&&this.sectionHeaderFontSize===t.sectionHeaderFontSize&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(t.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(t.backgroundColor)&&this.foregroundAlpha===t.foregroundAlpha}}class KD{constructor(t,i,e,s,n,r,o,h,c){this.scrollTop=t,this.scrollHeight=i,this.sliderNeeded=e,this._computedSliderRatio=s,this.sliderTop=n,this.sliderHeight=r,this.topPaddingLineCount=o,this.startLineNumber=h,this.endLineNumber=c}getDesiredScrollTopFromDelta(t){return Math.round(this.scrollTop+t/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(t){return Math.round((t-this.sliderHeight/2)/this._computedSliderRatio)}intersectWithViewport(t){const i=Math.max(this.startLineNumber,t.startLineNumber),e=Math.min(this.endLineNumber,t.endLineNumber);return i>e?null:[i,e]}getYForLineNumber(t,i){return+(t-this.startLineNumber+this.topPaddingLineCount)*i}static create(t,i,e,s,n,r,o,h,c,l,a){const u=t.pixelRatio,d=t.minimapLineHeight,f=Math.floor(t.canvasInnerHeight/d),g=t.lineHeight;if(t.minimapHeightIsEditorHeight){let i=h*t.lineHeight+t.paddingTop+t.paddingBottom;t.scrollBeyondLastLine&&(i+=Math.max(0,n-t.lineHeight-t.paddingBottom));const e=Math.max(1,Math.floor(n*n/i)),s=Math.max(0,t.minimapHeight-e),r=s/(l-n),a=c*r,u=s>0,d=Math.floor(t.canvasInnerHeight/t.minimapLineHeight),f=Math.floor(t.paddingTop/t.lineHeight);return new KD(c,l,u,r,a,e,f,1,Math.min(o,d))}let p;if(r&&e!==o){const t=e-i+1;p=Math.floor(t*d/u)}else{const t=n/g;p=Math.floor(t*d/u)}const m=Math.floor(t.paddingTop/g);let w,v=Math.floor(t.paddingBottom/g);if(t.scrollBeyondLastLine){const t=n/g;v=Math.max(v,t-1)}v>0?w=(m+o+v-n/g-1)*d/u:w=Math.max(0,(m+o)*d/u-p),w=Math.min(t.minimapHeight-p,w);const b=w/(l-n),y=c*b;if(f>=m+o+v)return new KD(c,l,w>0,b,y,p,m,1,o);{let e,n;e=i>1?i+m:Math.max(1,c/g);let r=Math.max(1,Math.floor(e-y*u/d));r<m?(n=m-r+1,r=1):(n=0,r=Math.max(1,r-m)),a&&a.scrollHeight===l&&(a.scrollTop>c&&(r=Math.min(r,a.startLineNumber),n=Math.max(n,a.topPaddingLineCount)),a.scrollTop<c&&(r=Math.max(r,a.startLineNumber),n=Math.min(n,a.topPaddingLineCount)));const h=Math.min(o,r-n+f-1),w=(c-s)/g;let v;return v=c>=t.paddingTop?(i-r+n+w)*d/u:c/t.paddingTop*(n+w)*d/u,new KD(c,l,!0,b,v,p,n,r,h)}}}class qD{constructor(t){this.dy=t}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}}qD.INVALID=new qD(-1);class GD{constructor(t,i,e){this.renderedLayout=t,this._imageData=i,this._renderedLines=new qx((()=>qD.INVALID)),this._renderedLines._set(t.startLineNumber,e)}linesEquals(t){if(!this.scrollEquals(t))return!1;const i=this._renderedLines._get().lines;for(let t=0,e=i.length;t<e;t++)if(i[t].dy===-1)return!1;return!0}scrollEquals(t){return this.renderedLayout.startLineNumber===t.startLineNumber&&this.renderedLayout.endLineNumber===t.endLineNumber}_get(){const t=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:t.rendLineNumberStart,lines:t.lines}}onLinesChanged(t,i){return this._renderedLines.onLinesChanged(t,i)}onLinesDeleted(t,i){this._renderedLines.onLinesDeleted(t,i)}onLinesInserted(t,i){this._renderedLines.onLinesInserted(t,i)}onTokensChanged(t){return this._renderedLines.onTokensChanged(t)}}class ZD{constructor(t,i,e,s){this._backgroundFillData=ZD._createBackgroundFillData(i,e,s),this._buffers=[t.createImageData(i,e),t.createImageData(i,e)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;const t=this._buffers[this._lastUsedBuffer];return t.data.set(this._backgroundFillData),t}static _createBackgroundFillData(t,i,e){const s=e.r,n=e.g,r=e.b,o=e.a,h=new Uint8ClampedArray(t*i*4);let c=0;for(let e=0;e<i;e++)for(let i=0;i<t;i++)h[c]=s,h[c+1]=n,h[c+2]=r,h[c+3]=o,c+=4;return h}}class JD{static compute(t,i,e){if(t.renderMinimap===0||!t.isSampling)return[null,[]];const{minimapLineCount:s}=wi.computeContainedMinimapLineCount({viewLineCount:i,scrollBeyondLastLine:t.scrollBeyondLastLine,paddingTop:t.paddingTop,paddingBottom:t.paddingBottom,height:t.editorHeight,lineHeight:t.lineHeight,pixelRatio:t.pixelRatio}),n=i/s,r=n/2;if(!e||e.minimapLines.length===0){const t=[];if(t[0]=1,s>1){for(let i=0,e=s-1;i<e;i++)t[i]=Math.round(i*n+r);t[s-1]=i}return[new JD(n,t),[]]}const o=e.minimapLines,h=o.length,c=[];let l=0,a=0,u=1,d=[],f=null;for(let t=0;t<s;t++){const e=Math.max(u,Math.round(t*n)),g=Math.max(e,Math.round((t+1)*n));for(;l<h&&o[l]<e;){if(d.length<10){const t=l+1+a;f&&f.type==="deleted"&&f._oldIndex===l-1?f.deleteToLineNumber++:(f={type:"deleted",_oldIndex:l,deleteFromLineNumber:t,deleteToLineNumber:t},d.push(f)),a--}l++}let p;if(l<h&&o[l]<=g)p=o[l],l++;else if(p=t===0?1:t+1===s?i:Math.round(t*n+r),d.length<10){const i=l+1+a;f&&f.type==="inserted"&&f._i===t-1?f.insertToLineNumber++:(f={type:"inserted",_i:t,insertFromLineNumber:i,insertToLineNumber:i},d.push(f)),a++}c[t]=p,u=p}if(d.length<10)for(;l<h;){const t=l+1+a;f&&f.type==="deleted"&&f._oldIndex===l-1?f.deleteToLineNumber++:(f={type:"deleted",_oldIndex:l,deleteFromLineNumber:t,deleteToLineNumber:t},d.push(f)),a--,l++}else d=[{type:"flush"}];return[new JD(n,c),d]}constructor(t,i){this.samplingRatio=t,this.minimapLines=i}modelLineToMinimapLine(t){return Math.min(this.minimapLines.length,Math.max(1,Math.round(t/this.samplingRatio)))}modelLineRangeToMinimapLineRange(t,i){let e=this.modelLineToMinimapLine(t)-1;for(;e>0&&this.minimapLines[e-1]>=t;)e--;let s=this.modelLineToMinimapLine(i)-1;for(;s+1<this.minimapLines.length&&this.minimapLines[s+1]<=i;)s++;if(e===s){const s=this.minimapLines[e];if(s<t||s>i)return null}return[e+1,s+1]}decorationLineRangeToMinimapLineRange(t,i){let e=this.modelLineToMinimapLine(t),s=this.modelLineToMinimapLine(i);return t!==i&&s===e&&(s===this.minimapLines.length?e>1&&e--:s++),[e,s]}onLinesDeleted(t){const i=t.toLineNumber-t.fromLineNumber+1;let e=this.minimapLines.length,s=0;for(let n=this.minimapLines.length-1;n>=0&&!(this.minimapLines[n]<t.fromLineNumber);n--)this.minimapLines[n]<=t.toLineNumber?(this.minimapLines[n]=Math.max(1,t.fromLineNumber-1),e=Math.min(e,n),s=Math.max(s,n)):this.minimapLines[n]-=i;return[e,s]}onLinesInserted(t){const i=t.toLineNumber-t.fromLineNumber+1;for(let e=this.minimapLines.length-1;e>=0&&!(this.minimapLines[e]<t.fromLineNumber);e--)this.minimapLines[e]+=i}}class QD extends Yy{constructor(t){super(t),this._sectionHeaderCache=new Kf(10,1.5),this.tokensColorTracker=ND.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new UD(this._context.configuration,this._context.theme,this.tokensColorTracker);const[i]=JD.compute(this.options,this._context.viewModel.getLineCount(),null);this._samplingState=i,this._shouldCheckSampling=!1,this._actual=new YD(t.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){const t=new UD(this._context.configuration,this._context.theme,this.tokensColorTracker);return!this.options.equals(t)&&(this.options=t,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(t){return this._onOptionsMaybeChanged()}onCursorStateChanged(t){return this._selections=t.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(t){return!!t.affectsMinimap&&this._actual.onDecorationsChanged()}onFlushed(t){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(t){if(this._samplingState){const i=this._samplingState.modelLineRangeToMinimapLineRange(t.fromLineNumber,t.fromLineNumber+t.count-1);return!!i&&this._actual.onLinesChanged(i[0],i[1]-i[0]+1)}return this._actual.onLinesChanged(t.fromLineNumber,t.count)}onLinesDeleted(t){if(this._samplingState){const[i,e]=this._samplingState.onLinesDeleted(t);return i<=e&&this._actual.onLinesChanged(i+1,e-i+1),this._shouldCheckSampling=!0,!0}return this._actual.onLinesDeleted(t.fromLineNumber,t.toLineNumber)}onLinesInserted(t){return this._samplingState?(this._samplingState.onLinesInserted(t),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(t.fromLineNumber,t.toLineNumber)}onScrollChanged(t){return this._actual.onScrollChanged()}onThemeChanged(t){return this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(t){if(this._samplingState){const i=[];for(const e of t.ranges){const t=this._samplingState.modelLineRangeToMinimapLineRange(e.fromLineNumber,e.toLineNumber);t&&i.push({fromLineNumber:t[0],toLineNumber:t[1]})}return!!i.length&&this._actual.onTokensChanged(i)}return this._actual.onTokensChanged(t.ranges)}onTokensColorsChanged(t){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(t){return this._actual.onZonesChanged()}prepareRender(t){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(t){let i=t.visibleRange.startLineNumber,e=t.visibleRange.endLineNumber;this._samplingState&&(i=this._samplingState.modelLineToMinimapLine(i),e=this._samplingState.modelLineToMinimapLine(e));const s={viewportContainsWhitespaceGaps:t.viewportData.whitespaceViewportData.length>0,scrollWidth:t.scrollWidth,scrollHeight:t.scrollHeight,viewportStartLineNumber:i,viewportEndLineNumber:e,viewportStartLineNumberVerticalOffset:t.getVerticalOffsetForLineNumber(i),scrollTop:t.scrollTop,scrollLeft:t.scrollLeft,viewportWidth:t.viewportWidth,viewportHeight:t.viewportHeight};this._actual.render(s)}_recreateLineSampling(){this._minimapSelections=null;const t=!!this._samplingState,[i,e]=JD.compute(this.options,this._context.viewModel.getLineCount(),this._samplingState);if(this._samplingState=i,t&&this._samplingState)for(const t of e)switch(t.type){case"deleted":this._actual.onLinesDeleted(t.deleteFromLineNumber,t.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(t.insertFromLineNumber,t.insertToLineNumber);break;case"flush":this._actual.onFlushed()}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.viewModel.getLineCount()}getRealLineCount(){return this._context.viewModel.getLineCount()}getLineContent(t){return this._samplingState?this._context.viewModel.getLineContent(this._samplingState.minimapLines[t-1]):this._context.viewModel.getLineContent(t)}getLineMaxColumn(t){return this._samplingState?this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[t-1]):this._context.viewModel.getLineMaxColumn(t)}getMinimapLinesRenderingData(t,i,e){if(this._samplingState){const s=[];for(let n=0,r=i-t+1;n<r;n++)e[n]?s[n]=this._context.viewModel.getViewLineData(this._samplingState.minimapLines[t+n-1]):s[n]=null;return s}return this._context.viewModel.getMinimapLinesRenderingData(t,i,e).data}getSelections(){if(this._minimapSelections===null)if(this._samplingState){this._minimapSelections=[];for(const t of this._selections){const[i,e]=this._samplingState.decorationLineRangeToMinimapLineRange(t.startLineNumber,t.endLineNumber);this._minimapSelections.push(new Ss(i,t.startColumn,e,t.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(t,i){const e=this._getMinimapDecorationsInViewport(t,i).filter((t=>{var i;return!(!((i=t.options.minimap)===null||i===void 0)&&i.sectionHeaderStyle)}));if(this._samplingState){const t=[];for(const i of e){if(!i.options.minimap)continue;const e=i.range,s=this._samplingState.modelLineToMinimapLine(e.startLineNumber),n=this._samplingState.modelLineToMinimapLine(e.endLineNumber);t.push(new Am(new Cs(s,e.startColumn,n,e.endColumn),i.options))}return t}return e}getSectionHeaderDecorationsInViewport(t,i){const e=this.options.minimapLineHeight,s=this.options.sectionHeaderFontSize/e;return t=Math.floor(Math.max(1,t-s)),this._getMinimapDecorationsInViewport(t,i).filter((t=>{var i;return!!(!((i=t.options.minimap)===null||i===void 0)&&i.sectionHeaderStyle)}))}_getMinimapDecorationsInViewport(t,i){let e;if(this._samplingState){const s=this._samplingState.minimapLines[t-1],n=this._samplingState.minimapLines[i-1];e=new Cs(s,1,n,this._context.viewModel.getLineMaxColumn(n))}else e=new Cs(t,1,i,this._context.viewModel.getLineMaxColumn(i));return this._context.viewModel.getMinimapDecorationsInRange(e)}getSectionHeaderText(t,i){var e;const s=(e=t.options.minimap)===null||e===void 0?void 0:e.sectionHeaderText;if(!s)return null;const n=this._sectionHeaderCache.get(s);if(n)return n;const r=i(s);return this._sectionHeaderCache.set(s,r),r}getOptions(){return this._context.viewModel.model.getOptions()}revealLineNumber(t){this._samplingState&&(t=this._samplingState.minimapLines[t-1]),this._context.viewModel.revealRange("mouse",!1,new Cs(t,1,t,1),1,0)}setScrollTop(t){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:t},1)}}class YD extends Qi{constructor(t,i){super(),this._renderDecorations=!1,this._gestureInProgress=!1,this._theme=t,this._model=i,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(hb),this._domNode=Sl(document.createElement("div")),Xy.write(this._domNode,9),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=Sl(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=Sl(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=Sl(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=Sl(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=Sl(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._pointerDownListener=rc(this._domNode.domNode,qc.POINTER_DOWN,(t=>{if(t.preventDefault(),this._model.options.renderMinimap===0||!this._lastRenderData)return;if(this._model.options.size!=="proportional"){if(t.button===0&&this._lastRenderData){const i=vc(this._slider.domNode),e=i.top+i.height/2;this._startSliderDragging(t,e,this._lastRenderData.renderedLayout)}return}const i=this._model.options.minimapLineHeight,e=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*t.offsetY;let s=Math.floor(e/i)+this._lastRenderData.renderedLayout.startLineNumber-this._lastRenderData.renderedLayout.topPaddingLineCount;s=Math.min(s,this._model.getLineCount()),this._model.revealLineNumber(s)})),this._sliderPointerMoveMonitor=new Lw,this._sliderPointerDownListener=rc(this._slider.domNode,qc.POINTER_DOWN,(t=>{t.preventDefault(),t.stopPropagation(),t.button===0&&this._lastRenderData&&this._startSliderDragging(t,t.pageY,this._lastRenderData.renderedLayout)})),this._gestureDisposable=Wk.addTarget(this._domNode.domNode),this._sliderTouchStartListener=sc(this._domNode.domNode,Bk.Start,(t=>{t.preventDefault(),t.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(t))}),{passive:!1}),this._sliderTouchMoveListener=sc(this._domNode.domNode,Bk.Change,(t=>{t.preventDefault(),t.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(t)}),{passive:!1}),this._sliderTouchEndListener=rc(this._domNode.domNode,Bk.End,(t=>{t.preventDefault(),t.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)}))}_startSliderDragging(t,i,e){if(!(t.target&&t.target instanceof Element))return;const s=t.pageX;this._slider.toggleClassName("active",!0);const n=(t,n)=>{const r=vc(this._domNode.domNode),o=Math.min(Math.abs(n-s),Math.abs(n-r.left),Math.abs(n-r.left-r.width));if(vt&&o>140)return void this._model.setScrollTop(e.scrollTop);const h=t-i;this._model.setScrollTop(e.getDesiredScrollTopFromDelta(h))};t.pageY!==i&&n(t.pageY,s),this._sliderPointerMoveMonitor.startMonitoring(t.target,t.pointerId,t.buttons,(t=>n(t.pageY,t.pageX)),(()=>{this._slider.toggleClassName("active",!1)}))}scrollDueToTouchEvent(t){const i=this._domNode.domNode.getBoundingClientRect().top,e=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(t.pageY-i);this._model.setScrollTop(e)}dispose(){this._pointerDownListener.dispose(),this._sliderPointerMoveMonitor.dispose(),this._sliderPointerDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){const t=["minimap"];return this._model.options.showSlider==="always"?t.push("slider-always"):t.push("slider-mouseover"),this._model.options.autohide&&t.push("autohide"),t.join(" ")}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new ZD(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(t,i){return!!this._lastRenderData&&this._lastRenderData.onLinesChanged(t,i)}onLinesDeleted(t,i){var e;return(e=this._lastRenderData)===null||e===void 0||e.onLinesDeleted(t,i),!0}onLinesInserted(t,i){var e;return(e=this._lastRenderData)===null||e===void 0||e.onLinesInserted(t,i),!0}onScrollChanged(){return this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(hb),this._renderDecorations=!0,!0}onTokensChanged(t){return!!this._lastRenderData&&this._lastRenderData.onTokensChanged(t)}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(t){if(this._model.options.renderMinimap===0)return this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),void this._sliderHorizontal.setHeight(0);t.scrollLeft+t.viewportWidth>=t.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");const i=KD.create(this._model.options,t.viewportStartLineNumber,t.viewportEndLineNumber,t.viewportStartLineNumberVerticalOffset,t.viewportHeight,t.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),t.scrollTop,t.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(i.sliderNeeded?"block":"none"),this._slider.setTop(i.sliderTop),this._slider.setHeight(i.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(i.sliderHeight),this.renderDecorations(i),this._lastRenderData=this.renderLines(i)}renderDecorations(t){if(this._renderDecorations){this._renderDecorations=!1;const i=this._model.getSelections();i.sort(Cs.compareRangesUsingStarts);const e=this._model.getMinimapDecorationsInViewport(t.startLineNumber,t.endLineNumber);e.sort(((t,i)=>(t.options.zIndex||0)-(i.options.zIndex||0)));const{canvasInnerWidth:s,canvasInnerHeight:n}=this._model.options,r=this._model.options.minimapLineHeight,o=this._model.options.minimapCharWidth,h=this._model.getOptions().tabSize,c=this._decorationsCanvas.domNode.getContext("2d");c.clearRect(0,0,s,n);const l=new XD(t.startLineNumber,t.endLineNumber,!1);this._renderSelectionLineHighlights(c,i,l,t,r),this._renderDecorationsLineHighlights(c,e,l,t,r);const a=new XD(t.startLineNumber,t.endLineNumber,null);this._renderSelectionsHighlights(c,i,a,t,r,h,o,s),this._renderDecorationsHighlights(c,e,a,t,r,h,o,s),this._renderSectionHeaders(t)}}_renderSelectionLineHighlights(t,i,e,s,n){if(!this._selectionColor||this._selectionColor.isTransparent())return;t.fillStyle=this._selectionColor.transparent(.5).toString();let r=0,o=0;for(const h of i){const i=s.intersectWithViewport(h);if(!i)continue;const[c,l]=i;for(let t=c;t<=l;t++)e.set(t,!0);const a=s.getYForLineNumber(c,n),u=s.getYForLineNumber(l,n);o>=a||(o>r&&t.fillRect(8,r,t.canvas.width,o-r),r=a),o=u}o>r&&t.fillRect(8,r,t.canvas.width,o-r)}_renderDecorationsLineHighlights(t,i,e,s,n){const r=new Map;for(let o=i.length-1;o>=0;o--){const h=i[o],c=h.options.minimap;if(!c||c.position!==1)continue;const l=s.intersectWithViewport(h.range);if(!l)continue;const[a,u]=l,d=c.getColor(this._theme.value);if(!d||d.isTransparent())continue;let f=r.get(d.toString());f||(f=d.transparent(.5).toString(),r.set(d.toString(),f)),t.fillStyle=f;for(let i=a;i<=u;i++){if(e.has(i))continue;e.set(i,!0);const r=s.getYForLineNumber(a,n);t.fillRect(8,r,t.canvas.width,n)}}}_renderSelectionsHighlights(t,i,e,s,n,r,o,h){if(this._selectionColor&&!this._selectionColor.isTransparent())for(const c of i){const i=s.intersectWithViewport(c);if(!i)continue;const[l,a]=i;for(let i=l;i<=a;i++)this.renderDecorationOnLine(t,e,c,this._selectionColor,s,i,n,n,r,o,h)}}_renderDecorationsHighlights(t,i,e,s,n,r,o,h){for(const c of i){const i=c.options.minimap;if(!i)continue;const l=s.intersectWithViewport(c.range);if(!l)continue;const[a,u]=l,d=i.getColor(this._theme.value);if(d&&!d.isTransparent())for(let l=a;l<=u;l++)switch(i.position){case 1:this.renderDecorationOnLine(t,e,c.range,d,s,l,n,n,r,o,h);continue;case 2:{const i=s.getYForLineNumber(l,n);this.renderDecoration(t,d,2,i,2,n);continue}}}}renderDecorationOnLine(t,i,e,s,n,r,o,h,c,l,a){const u=n.getYForLineNumber(r,h);if(u+o<0||u>this._model.options.canvasInnerHeight)return;const{startLineNumber:d,endLineNumber:f}=e,g=d===r?e.startColumn:1,p=f===r?e.endColumn:this._model.getLineMaxColumn(r),m=this.getXOffsetForPosition(i,r,g,c,l,a),w=this.getXOffsetForPosition(i,r,p,c,l,a);this.renderDecoration(t,s,m,u,w-m,o)}getXOffsetForPosition(t,i,e,s,n,r){if(e===1)return 8;if((e-1)*n>=r)return r;let o=t.get(i);if(!o){const e=this._model.getLineContent(i);o=[8];let h=8;for(let t=1;t<e.length+1;t++){const i=e.charCodeAt(t-1),c=h+(i===9?s*n:Mr(i)?2*n:n);if(c>=r){o[t]=r;break}o[t]=c,h=c}t.set(i,o)}return e-1<o.length?o[e-1]:r}renderDecoration(t,i,e,s,n,r){t.fillStyle=i&&i.toString()||"",t.fillRect(e,s,n,r)}_renderSectionHeaders(t){var i;const e=this._model.options.minimapLineHeight,s=this._model.options.sectionHeaderFontSize,n=1.5*s,{canvasInnerWidth:r}=this._model.options,o=this._model.options.backgroundColor,h=`rgb(${o.r} ${o.g} ${o.b} / .7)`,c=this._model.options.sectionHeaderFontColor,l=`rgb(${c.r} ${c.g} ${c.b})`,a=l,u=this._decorationsCanvas.domNode.getContext("2d");u.font=s+"px "+this._model.options.sectionHeaderFontFamily,u.strokeStyle=a,u.lineWidth=.2;const d=this._model.getSectionHeaderDecorationsInViewport(t.startLineNumber,t.endLineNumber);d.sort(((t,i)=>t.range.startLineNumber-i.range.startLineNumber));const f=YD._fitSectionHeader.bind(null,u,r-8);for(const o of d){const c=t.getYForLineNumber(o.range.startLineNumber,e)+s,a=c-s,d=a+2,g=this._model.getSectionHeaderText(o,f);YD._renderSectionLabel(u,g,((i=o.options.minimap)===null||i===void 0?void 0:i.sectionHeaderStyle)===2,h,l,r,a,n,c,d)}}static _fitSectionHeader(t,i,e){if(!e)return e;const s=t.measureText(e).width,n=t.measureText("…").width;if(s<=i||s<=n)return e;const r=e.length,o=s/e.length,h=Math.floor((i-n)/o)-1;let c=Math.ceil(h/2);for(;c>0&&/\s/.test(e[c-1]);)--c;return e.substring(0,c)+"…"+e.substring(r-(h-c))}static _renderSectionLabel(t,i,e,s,n,r,o,h,c,l){i&&(t.fillStyle=s,t.fillRect(0,o,r,h),t.fillStyle=n,t.fillText(i,8,c)),e&&(t.beginPath(),t.moveTo(0,l),t.lineTo(r,l),t.closePath(),t.stroke())}renderLines(t){const i=t.startLineNumber,e=t.endLineNumber,s=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(t)){const i=this._lastRenderData._get();return new GD(t,i.imageData,i.lines)}const n=this._getBuffer();if(!n)return null;const[r,o,h]=YD._renderUntouchedLines(n,t.topPaddingLineCount,i,e,s,this._lastRenderData),c=this._model.getMinimapLinesRenderingData(i,e,h),l=this._model.getOptions().tabSize,a=this._model.options.defaultBackgroundColor,u=this._model.options.backgroundColor,d=this._model.options.foregroundAlpha,f=this._model.tokensColorTracker,g=f.backgroundIsLight(),p=this._model.options.renderMinimap,m=this._model.options.charRenderer(),w=this._model.options.fontScale,v=this._model.options.minimapCharWidth,b=(p===1?2:3)*w,y=s>b?Math.floor((s-b)/2):0,k=u.a/255,C=new PD(Math.round((u.r-a.r)*k+a.r),Math.round((u.g-a.g)*k+a.g),Math.round((u.b-a.b)*k+a.b),255);let S=t.topPaddingLineCount*s;const x=[];for(let t=0,r=e-i+1;t<r;t++)h[t]&&YD._renderLine(n,C,u.a,g,p,v,f,d,m,S,y,l,c[t],w,s),x[t]=new qD(S),S+=s;const D=r===-1?0:r,E=(o===-1?n.height:o)-D;return this._canvas.domNode.getContext("2d").putImageData(n,0,0,0,D,n.width,E),new GD(t,n,x)}static _renderUntouchedLines(t,i,e,s,n,r){const o=[];if(!r){for(let t=0,i=s-e+1;t<i;t++)o[t]=!0;return[-1,-1,o]}const h=r._get(),c=h.imageData.data,l=h.rendLineNumberStart,a=h.lines,u=a.length,d=t.width,f=t.data,g=(s-e+1)*n*d*4;let p=-1,m=-1,w=-1,v=-1,b=-1,y=-1,k=i*n;for(let t=e;t<=s;t++){const i=t-e,s=t-l,r=s>=0&&s<u?a[s].dy:-1;if(r===-1){o[i]=!0,k+=n;continue}const h=r*d*4,C=(r+n)*d*4,S=k*d*4,x=(k+n)*d*4;v===h&&y===S?(v=C,y=x):(w!==-1&&(f.set(c.subarray(w,v),b),p===-1&&w===0&&w===b&&(p=v),m===-1&&v===g&&w===b&&(m=w)),w=h,v=C,b=S,y=x),o[i]=!1,k+=n}return w!==-1&&(f.set(c.subarray(w,v),b),p===-1&&w===0&&w===b&&(p=v),m===-1&&v===g&&w===b&&(m=w)),[p===-1?-1:p/(4*d),m===-1?-1:m/(4*d),o]}static _renderLine(t,i,e,s,n,r,o,h,c,l,a,u,d,f,g){const p=d.content,m=d.tokens,w=t.width-r,v=g===1;let b=8,y=0,k=0;for(let d=0,g=m.getCount();d<g;d++){const g=m.getEndOffset(d),C=m.getForeground(d),S=o.getColor(C);for(;y<g;y++){if(b>w)return;const o=p.charCodeAt(y);if(o===9){const t=u-(y+k)%u;k+=t-1,b+=t*r}else if(o===32)b+=r;else{const u=Mr(o)?2:1;for(let d=0;d<u;d++)if(n===2?c.blockRenderChar(t,b,l+a,S,h,i,e,v):c.renderChar(t,b,l+a,o,S,h,i,e,f,s,v),b+=r,b>w)return}}}}}class XD{constructor(t,i,e){this._startLineNumber=t,this._endLineNumber=i,this._defaultValue=e,this._values=[];for(let t=0,i=this._endLineNumber-this._startLineNumber+1;t<i;t++)this._values[t]=e}has(t){return this.get(t)!==this._defaultValue}set(t,i){t<this._startLineNumber||t>this._endLineNumber||(this._values[t-this._startLineNumber]=i)}get(t){return t<this._startLineNumber||t>this._endLineNumber?this._defaultValue:this._values[t-this._startLineNumber]}}class tE extends Yy{constructor(t,i){super(t),this._viewDomNode=i;const e=this._context.configuration.options.get(145);this._widgets={},this._verticalScrollbarWidth=e.verticalScrollbarWidth,this._minimapWidth=e.minimap.minimapWidth,this._horizontalScrollbarHeight=e.horizontalScrollbarHeight,this._editorHeight=e.height,this._editorWidth=e.width,this._viewDomNodeRect={top:0,left:0,width:0,height:0},this._domNode=Sl(document.createElement("div")),Xy.write(this._domNode,4),this._domNode.setClassName("overlayWidgets"),this.overflowingOverlayWidgetsDomNode=Sl(document.createElement("div")),Xy.write(this.overflowingOverlayWidgetsDomNode,5),this.overflowingOverlayWidgetsDomNode.setClassName("overflowingOverlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(t){const i=this._context.configuration.options.get(145);return this._verticalScrollbarWidth=i.verticalScrollbarWidth,this._minimapWidth=i.minimap.minimapWidth,this._horizontalScrollbarHeight=i.horizontalScrollbarHeight,this._editorHeight=i.height,this._editorWidth=i.width,!0}addWidget(t){const i=Sl(t.getDomNode());this._widgets[t.getId()]={widget:t,preference:null,domNode:i},i.setPosition("absolute"),i.setAttribute("widgetId",t.getId()),t.allowEditorOverflow?this.overflowingOverlayWidgetsDomNode.appendChild(i):this._domNode.appendChild(i),this.setShouldRender(),this._updateMaxMinWidth()}setWidgetPosition(t,i){const e=this._widgets[t.getId()];return e.preference===i?(this._updateMaxMinWidth(),!1):(e.preference=i,this.setShouldRender(),this._updateMaxMinWidth(),!0)}removeWidget(t){const i=t.getId();if(this._widgets.hasOwnProperty(i)){const t=this._widgets[i].domNode.domNode;delete this._widgets[i],t.remove(),this.setShouldRender(),this._updateMaxMinWidth()}}_updateMaxMinWidth(){var t,i;let e=0;const s=Object.keys(this._widgets);for(let n=0,r=s.length;n<r;n++){const r=s[n],o=(i=(t=this._widgets[r].widget).getMinContentWidthInPx)===null||i===void 0?void 0:i.call(t);o!==void 0&&(e=Math.max(e,o))}this._context.viewLayout.setOverlayWidgetsMinWidth(e)}_renderWidget(t){const i=t.domNode;if(t.preference!==null)if(t.preference===0)i.setTop(0),i.setRight(2*this._verticalScrollbarWidth+this._minimapWidth);else if(t.preference===1){const t=i.domNode.clientHeight;i.setTop(this._editorHeight-t-2*this._horizontalScrollbarHeight),i.setRight(2*this._verticalScrollbarWidth+this._minimapWidth)}else if(t.preference===2)i.setTop(0),i.domNode.style.right="50%";else{const{top:e,left:s}=t.preference;if(this._context.configuration.options.get(42)&&t.widget.allowEditorOverflow){const t=this._viewDomNodeRect;i.setTop(e+t.top),i.setLeft(s+t.left),i.setPosition("fixed")}else i.setTop(e),i.setLeft(s),i.setPosition("absolute")}else i.setTop("")}prepareRender(t){this._viewDomNodeRect=vc(this._viewDomNode.domNode)}render(t){this._domNode.setWidth(this._editorWidth);const i=Object.keys(this._widgets);for(let t=0,e=i.length;t<e;t++){const e=i[t];this._renderWidget(this._widgets[e])}}}class iE{constructor(t,i){const e=t.options;this.lineHeight=e.get(67),this.pixelRatio=e.get(143),this.overviewRulerLanes=e.get(83),this.renderBorder=e.get(82);const s=i.getColor(oS);this.borderColor=s?s.toString():null,this.hideCursor=e.get(59);const n=i.getColor(PC);this.cursorColorSingle=n?n.transparent(.7).toString():null;const r=i.getColor(BC);this.cursorColorPrimary=r?r.transparent(.7).toString():null;const o=i.getColor(WC);this.cursorColorSecondary=o?o.transparent(.7).toString():null,this.themeType=i.type;const h=e.get(73),c=h.enabled,l=h.side,a=i.getColor(hS),u=Us.getDefaultBackground();this.backgroundColor=a||(c&&l==="right"?u:null);const d=e.get(145).overviewRuler;this.top=d.top,this.right=d.right,this.domWidth=d.width,this.domHeight=d.height,this.overviewRulerLanes===0?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);const[f,g]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=f,this.w=g}_initLanes(t,i,e){const s=i-t;if(e>=3){const i=Math.floor(s/3),e=Math.floor(s/3),n=s-i-e,r=t+i;return[[0,t,r,t,t+i+n,t,r,t],[0,i,n,i+n,e,i+n+e,n+e,i+n+e]]}if(e===2){const i=Math.floor(s/2),e=s-i;return[[0,t,t,t,t+i,t,t,t],[0,i,i,i,e,i+e,i+e,i+e]]}return[[0,t,t,t,t,t,t,t],[0,s,s,s,s,s,s,s]]}equals(t){return this.lineHeight===t.lineHeight&&this.pixelRatio===t.pixelRatio&&this.overviewRulerLanes===t.overviewRulerLanes&&this.renderBorder===t.renderBorder&&this.borderColor===t.borderColor&&this.hideCursor===t.hideCursor&&this.cursorColorSingle===t.cursorColorSingle&&this.cursorColorPrimary===t.cursorColorPrimary&&this.cursorColorSecondary===t.cursorColorSecondary&&this.themeType===t.themeType&&kp.equals(this.backgroundColor,t.backgroundColor)&&this.top===t.top&&this.right===t.right&&this.domWidth===t.domWidth&&this.domHeight===t.domHeight&&this.canvasWidth===t.canvasWidth&&this.canvasHeight===t.canvasHeight}}class eE extends Yy{constructor(t){super(t),this._actualShouldRender=0,this._renderedDecorations=[],this._renderedCursorPositions=[],this._domNode=Sl(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=Us.onDidChange((t=>{t.changedColorMap&&this._updateSettings(!0)})),this._cursorPositions=[{position:new ks(1,1),color:this._settings.cursorColorSingle}]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(t){const i=new iE(this._context.configuration,this._context.theme);return(!this._settings||!this._settings.equals(i))&&(this._settings=i,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,t&&this._render(),!0)}_markRenderingIsNeeded(){return this._actualShouldRender=2,!0}_markRenderingIsMaybeNeeded(){return this._actualShouldRender=1,!0}onConfigurationChanged(t){return!!this._updateSettings(!1)&&this._markRenderingIsNeeded()}onCursorStateChanged(t){this._cursorPositions=[];for(let i=0,e=t.selections.length;i<e;i++){let s=this._settings.cursorColorSingle;e>1&&(s=i===0?this._settings.cursorColorPrimary:this._settings.cursorColorSecondary),this._cursorPositions.push({position:t.selections[i].getPosition(),color:s})}return this._cursorPositions.sort(((t,i)=>ks.compare(t.position,i.position))),this._markRenderingIsMaybeNeeded()}onDecorationsChanged(t){return!!t.affectsOverviewRuler&&this._markRenderingIsMaybeNeeded()}onFlushed(t){return this._markRenderingIsNeeded()}onScrollChanged(t){return!!t.scrollHeightChanged&&this._markRenderingIsNeeded()}onZonesChanged(t){return this._markRenderingIsNeeded()}onThemeChanged(t){return!!this._updateSettings(!1)&&this._markRenderingIsNeeded()}getDomNode(){return this._domNode.domNode}prepareRender(t){}render(t){this._render(),this._actualShouldRender=0}_render(){const t=this._settings.backgroundColor;if(this._settings.overviewRulerLanes===0)return this._domNode.setBackgroundColor(t?kp.Format.CSS.formatHexA(t):""),void this._domNode.setDisplay("none");const i=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme);if(i.sort(Mm.compareByRenderingProps),this._actualShouldRender!==1||Mm.equalsArr(this._renderedDecorations,i)||(this._actualShouldRender=2),this._actualShouldRender!==1||n(this._renderedCursorPositions,this._cursorPositions,((t,i)=>t.position.lineNumber===i.position.lineNumber&&t.color===i.color))||(this._actualShouldRender=2),this._actualShouldRender===1)return;this._renderedDecorations=i,this._renderedCursorPositions=this._cursorPositions,this._domNode.setDisplay("block");const e=this._settings.canvasWidth,s=this._settings.canvasHeight,r=this._settings.lineHeight,o=this._context.viewLayout,h=s/this._context.viewLayout.getScrollHeight(),c=6*this._settings.pixelRatio|0,l=c/2|0,a=this._domNode.domNode.getContext("2d");t?t.isOpaque()?(a.fillStyle=kp.Format.CSS.formatHexA(t),a.fillRect(0,0,e,s)):(a.clearRect(0,0,e,s),a.fillStyle=kp.Format.CSS.formatHexA(t),a.fillRect(0,0,e,s)):a.clearRect(0,0,e,s);const u=this._settings.x,d=this._settings.w;for(const t of i){const i=t.color,e=t.data;a.fillStyle=i;let n=0,f=0,g=0;for(let t=0,i=e.length/3;t<i;t++){const i=e[3*t],p=e[3*t+1],m=e[3*t+2];let w=o.getVerticalOffsetForLineNumber(p)*h|0,v=(o.getVerticalOffsetForLineNumber(m)+r)*h|0;if(v-w<c){let t=(w+v)/2|0;t<l?t=l:t+l>s&&(t=s-l),w=t-l,v=t+l}w>g+1||i!==n?(t!==0&&a.fillRect(u[n],f,d[n],g-f),n=i,f=w,g=v):v>g&&(g=v)}a.fillRect(u[n],f,d[n],g-f)}if(!this._settings.hideCursor){const t=2*this._settings.pixelRatio|0,i=t/2|0,e=this._settings.x[7],n=this._settings.w[7];let r=-100,c=-100,l=null;for(let u=0,d=this._cursorPositions.length;u<d;u++){const d=this._cursorPositions[u].color;if(!d)continue;const f=this._cursorPositions[u].position;let g=o.getVerticalOffsetForLineNumber(f.lineNumber)*h|0;g<i?g=i:g+i>s&&(g=s-i);const p=g-i,m=p+t;p>c+1||d!==l?(u!==0&&l&&a.fillRect(e,r,n,c-r),r=p,c=m):m>c&&(c=m),l=d,a.fillStyle=d}l&&a.fillRect(e,r,n,c-r)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(a.beginPath(),a.lineWidth=1,a.strokeStyle=this._settings.borderColor,a.moveTo(0,0),a.lineTo(0,s),a.stroke(),a.moveTo(0,0),a.lineTo(e,0),a.stroke())}}class sE{constructor(t,i,e){this._colorZoneBrand=void 0,this.from=0|t,this.to=0|i,this.colorId=0|e}static compare(t,i){return t.colorId===i.colorId?t.from===i.from?t.to-i.to:t.from-i.from:t.colorId-i.colorId}}class nE{constructor(t,i,e,s){this._overviewRulerZoneBrand=void 0,this.startLineNumber=t,this.endLineNumber=i,this.heightInLines=e,this.color=s,this._colorZone=null}static compare(t,i){return t.color===i.color?t.startLineNumber===i.startLineNumber?t.heightInLines===i.heightInLines?t.endLineNumber-i.endLineNumber:t.heightInLines-i.heightInLines:t.startLineNumber-i.startLineNumber:t.color<i.color?-1:1}setColorZone(t){this._colorZone=t}getColorZones(){return this._colorZone}}class rE{constructor(t){this._getVerticalOffsetForLine=t,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(t){this._zones=t,this._zones.sort(nE.compare)}setLineHeight(t){return this._lineHeight!==t&&(this._lineHeight=t,this._colorZonesInvalid=!0,!0)}setPixelRatio(t){this._pixelRatio=t,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(t){return this._domWidth!==t&&(this._domWidth=t,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(t){return this._domHeight!==t&&(this._domHeight=t,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(t){return this._outerHeight!==t&&(this._outerHeight=t,this._colorZonesInvalid=!0,!0)}resolveColorZones(){const t=this._colorZonesInvalid,i=Math.floor(this._lineHeight),e=Math.floor(this.getCanvasHeight()),s=e/Math.floor(this._outerHeight),n=Math.floor(4*this._pixelRatio/2),r=[];for(let o=0,h=this._zones.length;o<h;o++){const h=this._zones[o];if(!t){const t=h.getColorZones();if(t){r.push(t);continue}}const c=this._getVerticalOffsetForLine(h.startLineNumber),l=h.heightInLines===0?this._getVerticalOffsetForLine(h.endLineNumber)+i:c+h.heightInLines*i,a=Math.floor(s*c),u=Math.floor(s*l);let d=Math.floor((a+u)/2),f=u-d;f<n&&(f=n),d-f<0&&(d=f),d+f>e&&(d=e-f);const g=h.color;let p=this._color2Id[g];p||(p=++this._lastAssignedId,this._color2Id[g]=p,this._id2Color[p]=g);const m=new sE(d-f,d+f,p);h.setColorZone(m),r.push(m)}return this._colorZonesInvalid=!1,r.sort(sE.compare),r}}class oE extends Qy{constructor(t,i){super(),this._context=t;const e=this._context.configuration.options;this._domNode=Sl(document.createElement("canvas")),this._domNode.setClassName(i),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new rE((t=>this._context.viewLayout.getVerticalOffsetForLineNumber(t))),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(e.get(67)),this._zoneManager.setPixelRatio(e.get(143)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(t){const i=this._context.configuration.options;return t.hasChanged(67)&&(this._zoneManager.setLineHeight(i.get(67)),this._render()),t.hasChanged(143)&&(this._zoneManager.setPixelRatio(i.get(143)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(t){return this._render(),!0}onScrollChanged(t){return t.scrollHeightChanged&&(this._zoneManager.setOuterHeight(t.scrollHeight),this._render()),!0}onZonesChanged(t){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(t){this._domNode.setTop(t.top),this._domNode.setRight(t.right);let i=!1;i=this._zoneManager.setDOMWidth(t.width)||i,i=this._zoneManager.setDOMHeight(t.height)||i,i&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(t){this._zoneManager.setZones(t),this._render()}_render(){if(this._zoneManager.getOuterHeight()===0)return!1;const t=this._zoneManager.getCanvasWidth(),i=this._zoneManager.getCanvasHeight(),e=this._zoneManager.resolveColorZones(),s=this._zoneManager.getId2Color(),n=this._domNode.domNode.getContext("2d");return n.clearRect(0,0,t,i),e.length>0&&this._renderOneLane(n,e,s,t),!0}_renderOneLane(t,i,e,s){let n=0,r=0,o=0;for(const h of i){const i=h.colorId,c=h.from,l=h.to;i!==n?(t.fillRect(0,r,s,o-r),n=i,t.fillStyle=e[n],r=c,o=l):o>=c?o=Math.max(o,l):(t.fillRect(0,r,s,o-r),r=c,o=l)}t.fillRect(0,r,s,o-r)}}class hE extends Yy{constructor(t){super(t),this.domNode=Sl(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];const i=this._context.configuration.options;this._rulers=i.get(102),this._typicalHalfwidthCharacterWidth=i.get(50).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(t){const i=this._context.configuration.options;return this._rulers=i.get(102),this._typicalHalfwidthCharacterWidth=i.get(50).typicalHalfwidthCharacterWidth,!0}onScrollChanged(t){return t.scrollHeightChanged}prepareRender(t){}_ensureRulersCount(){const t=this._renderedRulers.length,i=this._rulers.length;if(t===i)return;if(t<i){const{tabSize:e}=this._context.viewModel.model.getOptions(),s=e;let n=i-t;for(;n>0;){const t=Sl(document.createElement("div"));t.setClassName("view-ruler"),t.setWidth(s),this.domNode.appendChild(t),this._renderedRulers.push(t),n--}return}let e=t-i;for(;e>0;){const t=this._renderedRulers.pop();this.domNode.removeChild(t),e--}}render(t){this._ensureRulersCount();for(let i=0,e=this._rulers.length;i<e;i++){const e=this._renderedRulers[i],s=this._rulers[i];e.setBoxShadow(s.color?`1px 0 0 0 ${s.color} inset`:""),e.setHeight(Math.min(t.scrollHeight,1e6)),e.setLeft(s.column*this._typicalHalfwidthCharacterWidth)}}}class cE extends Yy{constructor(t){super(t),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;const i=this._context.configuration.options.get(103);this._useShadows=i.useShadows,this._domNode=Sl(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){const t=this._useShadows&&this._scrollTop>0;return this._shouldShow!==t&&(this._shouldShow=t,!0)}getDomNode(){return this._domNode}_updateWidth(){const t=this._context.configuration.options.get(145);t.minimap.renderMinimap===0||t.minimap.minimapWidth>0&&t.minimap.minimapLeft===0?this._width=t.width:this._width=t.width-t.verticalScrollbarWidth}onConfigurationChanged(t){const i=this._context.configuration.options.get(103);return this._useShadows=i.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(t){return this._scrollTop=t.scrollTop,this._updateShouldShow()}prepareRender(t){}render(t){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}}class lE{constructor(t){this.left=t.left,this.width=t.width,this.startStyle=null,this.endStyle=null}}class aE{constructor(t,i){this.lineNumber=t,this.ranges=i}}function uE(t){return new lE(t)}function dE(t){return new aE(t.lineNumber,t.ranges.map(uE))}class fE extends EC{constructor(t){super(),this._previousFrameVisibleRangesWithStyle=[],this._context=t;const i=this._context.configuration.options;this._roundedSelection=i.get(101),this._typicalHalfwidthCharacterWidth=i.get(50).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(t){const i=this._context.configuration.options;return this._roundedSelection=i.get(101),this._typicalHalfwidthCharacterWidth=i.get(50).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(t){return this._selections=t.selections.slice(0),!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged}onZonesChanged(t){return!0}_visibleRangesHaveGaps(t){for(let i=0,e=t.length;i<e;i++)if(t[i].ranges.length>1)return!0;return!1}_enrichVisibleRangesWithStyle(t,i,e){const s=this._typicalHalfwidthCharacterWidth/4;let n=null,r=null;if(e&&e.length>0&&i.length>0){const s=i[0].lineNumber;if(s===t.startLineNumber)for(let t=0;!n&&t<e.length;t++)e[t].lineNumber===s&&(n=e[t].ranges[0]);const o=i[i.length-1].lineNumber;if(o===t.endLineNumber)for(let t=e.length-1;!r&&t>=0;t--)e[t].lineNumber===o&&(r=e[t].ranges[0]);n&&!n.startStyle&&(n=null),r&&!r.startStyle&&(r=null)}for(let t=0,e=i.length;t<e;t++){const o=i[t].ranges[0],h=o.left,c=o.left+o.width,l={top:0,bottom:0},a={top:0,bottom:0};if(t>0){const e=i[t-1].ranges[0].left,n=i[t-1].ranges[0].left+i[t-1].ranges[0].width;gE(h-e)<s?l.top=2:h>e&&(l.top=1),gE(c-n)<s?a.top=2:e<c&&c<n&&(a.top=1)}else n&&(l.top=n.startStyle.top,a.top=n.endStyle.top);if(t+1<e){const e=i[t+1].ranges[0].left,n=i[t+1].ranges[0].left+i[t+1].ranges[0].width;gE(h-e)<s?l.bottom=2:e<h&&h<n&&(l.bottom=1),gE(c-n)<s?a.bottom=2:c<n&&(a.bottom=1)}else r&&(l.bottom=r.startStyle.bottom,a.bottom=r.endStyle.bottom);o.startStyle=l,o.endStyle=a}}_getVisibleRangesWithStyle(t,i,e){const s=(i.linesVisibleRangesForRange(t,!0)||[]).map(dE);return!this._visibleRangesHaveGaps(s)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(i.visibleRange,s,e),s}_createSelectionPiece(t,i,e,s,n){return'<div class="cslr '+e+'" style="top:'+t.toString()+"px;bottom:"+i.toString()+"px;left:"+s.toString()+"px;width:"+n.toString()+'px;"></div>'}_actualRenderOneSelection(t,i,e,s){if(s.length===0)return;const n=!!s[0].ranges[0].startStyle,r=s[0].lineNumber,o=s[s.length-1].lineNumber;for(let h=0,c=s.length;h<c;h++){const c=s[h],l=c.lineNumber,a=l-i,u=e&&l===r?1:0,d=e&&l!==r&&l===o?1:0;let f="",g="";for(let t=0,i=c.ranges.length;t<i;t++){const i=c.ranges[t];if(n){const t=i.startStyle,e=i.endStyle;if(t.top===1||t.bottom===1){f+=this._createSelectionPiece(u,d,fE.SELECTION_CLASS_NAME,i.left-fE.ROUNDED_PIECE_WIDTH,fE.ROUNDED_PIECE_WIDTH);let e=fE.EDITOR_BACKGROUND_CLASS_NAME;t.top===1&&(e+=" "+fE.SELECTION_TOP_RIGHT),t.bottom===1&&(e+=" "+fE.SELECTION_BOTTOM_RIGHT),f+=this._createSelectionPiece(u,d,e,i.left-fE.ROUNDED_PIECE_WIDTH,fE.ROUNDED_PIECE_WIDTH)}if(e.top===1||e.bottom===1){f+=this._createSelectionPiece(u,d,fE.SELECTION_CLASS_NAME,i.left+i.width,fE.ROUNDED_PIECE_WIDTH);let t=fE.EDITOR_BACKGROUND_CLASS_NAME;e.top===1&&(t+=" "+fE.SELECTION_TOP_LEFT),e.bottom===1&&(t+=" "+fE.SELECTION_BOTTOM_LEFT),f+=this._createSelectionPiece(u,d,t,i.left+i.width,fE.ROUNDED_PIECE_WIDTH)}}let e=fE.SELECTION_CLASS_NAME;if(n){const t=i.startStyle,s=i.endStyle;t.top===0&&(e+=" "+fE.SELECTION_TOP_LEFT),t.bottom===0&&(e+=" "+fE.SELECTION_BOTTOM_LEFT),s.top===0&&(e+=" "+fE.SELECTION_TOP_RIGHT),s.bottom===0&&(e+=" "+fE.SELECTION_BOTTOM_RIGHT)}g+=this._createSelectionPiece(u,d,e,i.left,i.width)}t[a][0]+=f,t[a][1]+=g}}prepareRender(t){const i=[],e=t.visibleRange.startLineNumber,s=t.visibleRange.endLineNumber;for(let t=e;t<=s;t++)i[t-e]=["",""];const n=[];for(let s=0,r=this._selections.length;s<r;s++){const r=this._selections[s];if(r.isEmpty()){n[s]=null;continue}const o=this._getVisibleRangesWithStyle(r,t,this._previousFrameVisibleRangesWithStyle[s]);n[s]=o,this._actualRenderOneSelection(i,e,this._selections.length>1,o)}this._previousFrameVisibleRangesWithStyle=n,this._renderResult=i.map((([t,i])=>t+i))}render(t,i){if(!this._renderResult)return"";const e=i-t;return e<0||e>=this._renderResult.length?"":this._renderResult[e]}}function gE(t){return t<0?-t:t}fE.SELECTION_CLASS_NAME="selected-text",fE.SELECTION_TOP_LEFT="top-left-radius",fE.SELECTION_BOTTOM_LEFT="bottom-left-radius",fE.SELECTION_TOP_RIGHT="top-right-radius",fE.SELECTION_BOTTOM_RIGHT="bottom-right-radius",fE.EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background",fE.ROUNDED_PIECE_WIDTH=10,RC(((t,i)=>{const e=t.getColor(vv);e&&!e.isTransparent()&&i.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${e}; }`)}));class pE{constructor(t,i,e,s,n,r,o){this.top=t,this.left=i,this.paddingLeft=e,this.width=s,this.height=n,this.textContent=r,this.textContentClassName=o}}var mE;(function(t){t[t.Single=0]="Single",t[t.MultiPrimary=1]="MultiPrimary",t[t.MultiSecondary=2]="MultiSecondary"})(mE||(mE={}));class wE{constructor(t,i){this._context=t;const e=this._context.configuration.options,s=e.get(50);this._cursorStyle=e.get(28),this._lineHeight=e.get(67),this._typicalHalfwidthCharacterWidth=s.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(e.get(31),this._typicalHalfwidthCharacterWidth),this._isVisible=!0,this._domNode=Sl(document.createElement("div")),this._domNode.setClassName(`cursor ${_S}`),this._domNode.setHeight(this._lineHeight),this._domNode.setTop(0),this._domNode.setLeft(0),xl(this._domNode,s),this._domNode.setDisplay("none"),this._position=new ks(1,1),this._pluralityClass="",this.setPlurality(i),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}setPlurality(t){switch(t){default:case mE.Single:this._pluralityClass="";break;case mE.MultiPrimary:this._pluralityClass="cursor-primary";break;case mE.MultiSecondary:this._pluralityClass="cursor-secondary"}}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(t){const i=this._context.configuration.options,e=i.get(50);return this._cursorStyle=i.get(28),this._lineHeight=i.get(67),this._typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(i.get(31),this._typicalHalfwidthCharacterWidth),xl(this._domNode,e),!0}onCursorPositionChanged(t,i){return this._domNode.domNode.style.transitionProperty=i?"none":"",this._position=t,!0}_getGraphemeAwarePosition(){const{lineNumber:t,column:i}=this._position,e=this._context.viewModel.getLineContent(t),[s,n]=function(t,i){i>0&&pr(t.charCodeAt(i))&&i--;const e=i+yr(t,i);return[e-kr(t,e),e]}(e,i-1);return[new ks(t,s+1),e.substring(s,n)]}_prepareRender(t){let i="",e="";const[s,n]=this._getGraphemeAwarePosition();if(this._cursorStyle===di.Line||this._cursorStyle===di.LineThin){const r=t.visibleRangeForPosition(s);if(!r||r.outsideRenderedLine)return null;const o=Uh(this._domNode.domNode);let h;this._cursorStyle===di.Line?(h=hl(o,this._lineCursorWidth>0?this._lineCursorWidth:2),h>2&&(i=n,e=this._getTokenClassName(s))):h=hl(o,1);let c=r.left,l=0;h>=2&&c>=1&&(l=1,c-=l);const a=t.getVerticalOffsetForLineNumber(s.lineNumber)-t.bigNumbersDelta;return new pE(a,c,l,h,this._lineHeight,i,e)}const r=t.linesVisibleRangesForRange(new Cs(s.lineNumber,s.column,s.lineNumber,s.column+n.length),!1);if(!r||r.length===0)return null;const o=r[0];if(o.outsideRenderedLine||o.ranges.length===0)return null;const h=o.ranges[0],c=n==="\t"||h.width<1?this._typicalHalfwidthCharacterWidth:h.width;this._cursorStyle===di.Block&&(i=n,e=this._getTokenClassName(s));let l=t.getVerticalOffsetForLineNumber(s.lineNumber)-t.bigNumbersDelta,a=this._lineHeight;return this._cursorStyle!==di.Underline&&this._cursorStyle!==di.UnderlineThin||(l+=this._lineHeight-2,a=2),new pE(l,h.left,0,c,a,i,e)}_getTokenClassName(t){const i=this._context.viewModel.getViewLineData(t.lineNumber),e=i.tokens.findTokenIndexAtOffset(t.column-1);return i.tokens.getClassName(e)}prepareRender(t){this._renderData=this._prepareRender(t)}render(t){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${this._pluralityClass} ${_S} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setPaddingLeft(this._renderData.paddingLeft),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}}class vE extends Yy{constructor(t){super(t);const i=this._context.configuration.options;this._readOnly=i.get(91),this._cursorBlinking=i.get(26),this._cursorStyle=i.get(28),this._cursorSmoothCaretAnimation=i.get(27),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new wE(this._context,mE.Single),this._secondaryCursors=[],this._renderData=[],this._domNode=Sl(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new yo,this._cursorFlatBlinkInterval=new uc,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(t){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(t){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(t){const i=this._context.configuration.options;this._readOnly=i.get(91),this._cursorBlinking=i.get(26),this._cursorStyle=i.get(28),this._cursorSmoothCaretAnimation=i.get(27),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(t);for(let i=0,e=this._secondaryCursors.length;i<e;i++)this._secondaryCursors[i].onConfigurationChanged(t);return!0}_onCursorPositionChanged(t,i,e){const s=this._secondaryCursors.length!==i.length||this._cursorSmoothCaretAnimation==="explicit"&&e!==3;if(this._primaryCursor.setPlurality(i.length?mE.MultiPrimary:mE.Single),this._primaryCursor.onCursorPositionChanged(t,s),this._updateBlinking(),this._secondaryCursors.length<i.length){const t=i.length-this._secondaryCursors.length;for(let i=0;i<t;i++){const t=new wE(this._context,mE.MultiSecondary);this._domNode.domNode.insertBefore(t.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(t)}}else if(this._secondaryCursors.length>i.length){const t=this._secondaryCursors.length-i.length;for(let i=0;i<t;i++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let t=0;t<i.length;t++)this._secondaryCursors[t].onCursorPositionChanged(i[t],s)}onCursorStateChanged(t){const i=[];for(let e=0,s=t.selections.length;e<s;e++)i[e]=t.selections[e].getPosition();this._onCursorPositionChanged(i[0],i.slice(1),t.reason);const e=t.selections[0].isEmpty();return this._selectionIsEmpty!==e&&(this._selectionIsEmpty=e,this._updateDomClassName()),!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onFocusChanged(t){return this._editorHasFocus=t.isFocused,this._updateBlinking(),!1}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return!0}onTokensChanged(t){const i=i=>{for(let e=0,s=t.ranges.length;e<s;e++)if(t.ranges[e].fromLineNumber<=i.lineNumber&&i.lineNumber<=t.ranges[e].toLineNumber)return!0;return!1};if(i(this._primaryCursor.getPosition()))return!0;for(const t of this._secondaryCursors)if(i(t.getPosition()))return!0;return!1}onZonesChanged(t){return!0}_getCursorBlinking(){return this._isComposingInput?0:this._editorHasFocus?this._readOnly?5:this._cursorBlinking:0}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();const t=this._getCursorBlinking(),i=t===0,e=t===5;i?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),i||e||(t===1?this._cursorFlatBlinkInterval.cancelAndSet((()=>{this._isVisible?this._hide():this._show()}),vE.BLINK_INTERVAL,Uh(this._domNode.domNode)):this._startCursorBlinkAnimation.setIfNotSet((()=>{this._blinkingEnabled=!0,this._updateDomClassName()}),vE.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let t="cursors-layer";switch(this._selectionIsEmpty||(t+=" has-selection"),this._cursorStyle){case di.Line:t+=" cursor-line-style";break;case di.Block:t+=" cursor-block-style";break;case di.Underline:t+=" cursor-underline-style";break;case di.LineThin:t+=" cursor-line-thin-style";break;case di.BlockOutline:t+=" cursor-block-outline-style";break;case di.UnderlineThin:t+=" cursor-underline-thin-style";break;default:t+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:t+=" cursor-blink";break;case 2:t+=" cursor-smooth";break;case 3:t+=" cursor-phase";break;case 4:t+=" cursor-expand";break;default:t+=" cursor-solid"}else t+=" cursor-solid";return this._cursorSmoothCaretAnimation!=="on"&&this._cursorSmoothCaretAnimation!=="explicit"||(t+=" cursor-smooth-caret-animation"),t}_show(){this._primaryCursor.show();for(let t=0,i=this._secondaryCursors.length;t<i;t++)this._secondaryCursors[t].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let t=0,i=this._secondaryCursors.length;t<i;t++)this._secondaryCursors[t].hide();this._isVisible=!1}prepareRender(t){this._primaryCursor.prepareRender(t);for(let i=0,e=this._secondaryCursors.length;i<e;i++)this._secondaryCursors[i].prepareRender(t)}render(t){const i=[];let e=0;const s=this._primaryCursor.render(t);s&&(i[e++]=s);for(let s=0,n=this._secondaryCursors.length;s<n;s++){const n=this._secondaryCursors[s].render(t);n&&(i[e++]=n)}this._renderData=i}getLastRenderData(){return this._renderData}}vE.BLINK_INTERVAL=500,RC(((t,i)=>{const e=[{class:".cursor",foreground:PC,background:NC},{class:".cursor-primary",foreground:BC,background:$C},{class:".cursor-secondary",foreground:WC,background:jC}];for(const s of e){const e=t.getColor(s.foreground);if(e){let n=t.getColor(s.background);n||(n=e.opposite()),i.addRule(`.monaco-editor .cursors-layer ${s.class} { background-color: ${e}; border-color: ${e}; color: ${n}; }`),lk(t.type)&&i.addRule(`.monaco-editor .cursors-layer.has-selection ${s.class} { border-left: 1px solid ${n}; border-right: 1px solid ${n}; }`)}}}));const bE=()=>{throw new Error("Invalid change accessor")};class yE extends Yy{constructor(t){super(t);const i=this._context.configuration.options,e=i.get(145);this._lineHeight=i.get(67),this._contentWidth=e.contentWidth,this._contentLeft=e.contentLeft,this.domNode=Sl(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=Sl(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){const t=this._context.viewLayout.getWhitespaces(),i=new Map;for(const e of t)i.set(e.id,e);let e=!1;return this._context.viewModel.changeWhitespace((t=>{const s=Object.keys(this._zones);for(let n=0,r=s.length;n<r;n++){const r=s[n],o=this._zones[r],h=this._computeWhitespaceProps(o.delegate);o.isInHiddenArea=h.isInHiddenArea;const c=i.get(r);!c||c.afterLineNumber===h.afterViewLineNumber&&c.height===h.heightInPx||(t.changeOneWhitespace(r,h.afterViewLineNumber,h.heightInPx),this._safeCallOnComputedHeight(o.delegate,h.heightInPx),e=!0)}})),e}onConfigurationChanged(t){const i=this._context.configuration.options,e=i.get(145);return this._lineHeight=i.get(67),this._contentWidth=e.contentWidth,this._contentLeft=e.contentLeft,t.hasChanged(67)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(t){return this._recomputeWhitespacesProps()}onLinesDeleted(t){return!0}onScrollChanged(t){return t.scrollTopChanged||t.scrollWidthChanged}onZonesChanged(t){return!0}onLinesInserted(t){return!0}_getZoneOrdinal(t){var i,e;return(e=(i=t.ordinal)!==null&&i!==void 0?i:t.afterColumn)!==null&&e!==void 0?e:1e4}_computeWhitespaceProps(t){if(t.afterLineNumber===0)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(t),minWidthInPx:this._minWidthInPixels(t)};let i,e;if(t.afterColumn!==void 0)i=this._context.viewModel.model.validatePosition({lineNumber:t.afterLineNumber,column:t.afterColumn});else{const e=this._context.viewModel.model.validatePosition({lineNumber:t.afterLineNumber,column:1}).lineNumber;i=new ks(e,this._context.viewModel.model.getLineMaxColumn(e))}e=i.column===this._context.viewModel.model.getLineMaxColumn(i.lineNumber)?this._context.viewModel.model.validatePosition({lineNumber:i.lineNumber+1,column:1}):this._context.viewModel.model.validatePosition({lineNumber:i.lineNumber,column:i.column+1});const s=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i,t.afterColumnAffinity,!0),n=t.showInHiddenAreas||this._context.viewModel.coordinatesConverter.modelPositionIsVisible(e);return{isInHiddenArea:!n,afterViewLineNumber:s.lineNumber,heightInPx:n?this._heightInPixels(t):0,minWidthInPx:this._minWidthInPixels(t)}}changeViewZones(t){let i=!1;return this._context.viewModel.changeWhitespace((e=>{const s={addZone:t=>(i=!0,this._addZone(e,t)),removeZone:t=>{t&&(i=this._removeZone(e,t)||i)},layoutZone:t=>{t&&(i=this._layoutZone(e,t)||i)}};(function(t,i){try{return t(i)}catch(t){Ii(t)}})(t,s),s.addZone=bE,s.removeZone=bE,s.layoutZone=bE})),i}_addZone(t,i){const e=this._computeWhitespaceProps(i),s={whitespaceId:t.insertWhitespace(e.afterViewLineNumber,this._getZoneOrdinal(i),e.heightInPx,e.minWidthInPx),delegate:i,isInHiddenArea:e.isInHiddenArea,isVisible:!1,domNode:Sl(i.domNode),marginDomNode:i.marginDomNode?Sl(i.marginDomNode):null};return this._safeCallOnComputedHeight(s.delegate,e.heightInPx),s.domNode.setPosition("absolute"),s.domNode.domNode.style.width="100%",s.domNode.setDisplay("none"),s.domNode.setAttribute("monaco-view-zone",s.whitespaceId),this.domNode.appendChild(s.domNode),s.marginDomNode&&(s.marginDomNode.setPosition("absolute"),s.marginDomNode.domNode.style.width="100%",s.marginDomNode.setDisplay("none"),s.marginDomNode.setAttribute("monaco-view-zone",s.whitespaceId),this.marginDomNode.appendChild(s.marginDomNode)),this._zones[s.whitespaceId]=s,this.setShouldRender(),s.whitespaceId}_removeZone(t,i){if(this._zones.hasOwnProperty(i)){const e=this._zones[i];return delete this._zones[i],t.removeWhitespace(e.whitespaceId),e.domNode.removeAttribute("monaco-visible-view-zone"),e.domNode.removeAttribute("monaco-view-zone"),e.domNode.domNode.parentNode.removeChild(e.domNode.domNode),e.marginDomNode&&(e.marginDomNode.removeAttribute("monaco-visible-view-zone"),e.marginDomNode.removeAttribute("monaco-view-zone"),e.marginDomNode.domNode.parentNode.removeChild(e.marginDomNode.domNode)),this.setShouldRender(),!0}return!1}_layoutZone(t,i){if(this._zones.hasOwnProperty(i)){const e=this._zones[i],s=this._computeWhitespaceProps(e.delegate);return e.isInHiddenArea=s.isInHiddenArea,t.changeOneWhitespace(e.whitespaceId,s.afterViewLineNumber,s.heightInPx),this._safeCallOnComputedHeight(e.delegate,s.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(t){return this._zones.hasOwnProperty(t)?!!this._zones[t].delegate.suppressMouseDown:!1}_heightInPixels(t){return typeof t.heightInPx=="number"?t.heightInPx:typeof t.heightInLines=="number"?this._lineHeight*t.heightInLines:this._lineHeight}_minWidthInPixels(t){return typeof t.minWidthInPx=="number"?t.minWidthInPx:0}_safeCallOnComputedHeight(t,i){if(typeof t.onComputedHeight=="function")try{t.onComputedHeight(i)}catch(t){Ii(t)}}_safeCallOnDomNodeTop(t,i){if(typeof t.onDomNodeTop=="function")try{t.onDomNodeTop(i)}catch(t){Ii(t)}}prepareRender(t){}render(t){const i=t.viewportData.whitespaceViewportData,e={};let s=!1;for(const t of i)this._zones[t.id].isInHiddenArea||(e[t.id]=t,s=!0);const n=Object.keys(this._zones);for(let i=0,s=n.length;i<s;i++){const s=n[i],r=this._zones[s];let o=0,h=0,c="none";e.hasOwnProperty(s)?(o=e[s].verticalOffset-t.bigNumbersDelta,h=e[s].height,c="block",r.isVisible||(r.domNode.setAttribute("monaco-visible-view-zone","true"),r.isVisible=!0),this._safeCallOnDomNodeTop(r.delegate,t.getScrolledTopFromAbsoluteTop(e[s].verticalOffset))):(r.isVisible&&(r.domNode.removeAttribute("monaco-visible-view-zone"),r.isVisible=!1),this._safeCallOnDomNodeTop(r.delegate,t.getScrolledTopFromAbsoluteTop(-1e6))),r.domNode.setTop(o),r.domNode.setHeight(h),r.domNode.setDisplay(c),r.marginDomNode&&(r.marginDomNode.setTop(o),r.marginDomNode.setHeight(h),r.marginDomNode.setDisplay(c))}s&&(this.domNode.setWidth(Math.max(t.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}}class kE extends EC{constructor(t){super(),this._context=t,this._options=new CE(this._context.configuration),this._selection=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(t){const i=new CE(this._context.configuration);return this._options.equals(i)?t.hasChanged(145):(this._options=i,!0)}onCursorStateChanged(t){return this._selection=t.selections,this._options.renderWhitespace==="selection"}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return t.scrollTopChanged}onZonesChanged(t){return!0}prepareRender(t){if(this._options.renderWhitespace==="none")return void(this._renderResult=null);const i=t.visibleRange.startLineNumber,e=t.visibleRange.endLineNumber-i+1,s=new Array(e);for(let t=0;t<e;t++)s[t]=!0;const n=this._context.viewModel.getMinimapLinesRenderingData(t.viewportData.startLineNumber,t.viewportData.endLineNumber,s);this._renderResult=[];for(let i=t.viewportData.startLineNumber;i<=t.viewportData.endLineNumber;i++){const e=i-t.viewportData.startLineNumber,s=n.data[e];let r=null;if(this._options.renderWhitespace==="selection"){const t=this._selection;for(const e of t){if(e.endLineNumber<i||e.startLineNumber>i)continue;const t=e.startLineNumber===i?e.startColumn:s.minColumn,n=e.endLineNumber===i?e.endColumn:s.maxColumn;t<n&&(r||(r=[]),r.push(new am(t-1,n-1)))}}this._renderResult[e]=this._applyRenderWhitespace(t,i,r,s)}}_applyRenderWhitespace(t,i,e,s){if(this._options.renderWhitespace==="selection"&&!e||this._options.renderWhitespace==="trailing"&&s.continuesWithWrappedLine)return"";const n=this._context.theme.getColor(HC),r=this._options.renderWithSVG,o=s.content,h=this._options.stopRenderingLineAfter===-1?o.length:Math.min(this._options.stopRenderingLineAfter,o.length),c=s.continuesWithWrappedLine,l=s.minColumn-1,a=this._options.renderWhitespace==="boundary",u=this._options.renderWhitespace==="trailing",d=this._options.lineHeight,f=this._options.middotWidth,g=this._options.wsmiddotWidth,p=this._options.spaceWidth,m=Math.abs(g-p)<Math.abs(f-p)?11825:183,w=this._options.canUseHalfwidthRightwardsArrow;let v,b="",y=!1,k=tr(o);k===-1?(y=!0,k=h,v=h):v=er(o);let C=0,S=e&&e[C],x=0;for(let s=l;s<h;s++){const n=o.charCodeAt(s);if(S&&s>=S.endOffset&&(C++,S=e&&e[C]),n!==9&&n!==32||u&&!y&&s<=v)continue;if(a&&s>=k&&s<=v&&n===32){const t=s-1>=0?o.charCodeAt(s-1):0,i=s+1<h?o.charCodeAt(s+1):0;if(t!==32&&i!==32)continue}if(a&&c&&s===h-1){const t=s-1>=0?o.charCodeAt(s-1):0;if(n===32&&t!==32&&t!==9)continue}if(e&&(!S||S.startOffset>s||S.endOffset<=s))continue;const l=t.visibleRangeForPosition(new ks(i,s+1));l&&(r?(x=Math.max(x,l.left),b+=n===9?this._renderArrow(d,p,l.left):`<circle cx="${(l.left+p/2).toFixed(2)}" cy="${(d/2).toFixed(2)}" r="${(p/7).toFixed(2)}" />`):b+=n===9?`<div class="mwh" style="left:${l.left}px;height:${d}px;">${w?"￫":"→"}</div>`:`<div class="mwh" style="left:${l.left}px;height:${d}px;">${String.fromCharCode(m)}</div>`)}return r?(x=Math.round(x+p),`<svg style="bottom:0;position:absolute;width:${x}px;height:${d}px" viewBox="0 0 ${x} ${d}" xmlns="http://www.w3.org/2000/svg" fill="${n}">`+b+"</svg>"):b}_renderArrow(t,i,e){const s=t/2,n=e,r={x:0,y:i/7/2},o={x:.8*i,y:r.y},h={x:o.x-.2*o.x,y:o.y+.2*o.x},c={x:h.x+.1*o.x,y:h.y+.1*o.x},l={x:c.x+.35*o.x,y:c.y-.35*o.x};return`<path d="M ${[r,o,h,c,l,{x:l.x,y:-l.y},{x:c.x,y:-c.y},{x:h.x,y:-h.y},{x:o.x,y:-o.y},{x:r.x,y:-r.y}].map((t=>`${(n+t.x).toFixed(2)} ${(s+t.y).toFixed(2)}`)).join(" L ")}" />`}render(t,i){if(!this._renderResult)return"";const e=i-t;return e<0||e>=this._renderResult.length?"":this._renderResult[e]}}class CE{constructor(t){const i=t.options,e=i.get(50),s=i.get(38);s==="off"?(this.renderWhitespace="none",this.renderWithSVG=!1):s==="svg"?(this.renderWhitespace=i.get(99),this.renderWithSVG=!0):(this.renderWhitespace=i.get(99),this.renderWithSVG=!1),this.spaceWidth=e.spaceWidth,this.middotWidth=e.middotWidth,this.wsmiddotWidth=e.wsmiddotWidth,this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow,this.lineHeight=i.get(67),this.stopRenderingLineAfter=i.get(117)}equals(t){return this.renderWhitespace===t.renderWhitespace&&this.renderWithSVG===t.renderWithSVG&&this.spaceWidth===t.spaceWidth&&this.middotWidth===t.middotWidth&&this.wsmiddotWidth===t.wsmiddotWidth&&this.canUseHalfwidthRightwardsArrow===t.canUseHalfwidthRightwardsArrow&&this.lineHeight===t.lineHeight&&this.stopRenderingLineAfter===t.stopRenderingLineAfter}}class SE{constructor(t,i,e,s){this.selections=t,this.startLineNumber=0|i.startLineNumber,this.endLineNumber=0|i.endLineNumber,this.relativeVerticalOffset=i.relativeVerticalOffset,this.bigNumbersDelta=0|i.bigNumbersDelta,this.lineHeight=0|i.lineHeight,this.whitespaceViewportData=e,this._model=s,this.visibleRange=new Cs(i.startLineNumber,this._model.getLineMinColumn(i.startLineNumber),i.endLineNumber,this._model.getLineMaxColumn(i.endLineNumber))}getViewLineRenderingData(t){return this._model.getViewportViewLineRenderingData(this.visibleRange,t)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}}class xE{get type(){return this._theme.type}get value(){return this._theme}constructor(t){this._theme=t}update(t){this._theme=t}getColor(t){return this._theme.getColor(t)}}class DE{constructor(t,i,e){this.configuration=t,this.theme=new xE(i),this.viewModel=e,this.viewLayout=e.viewLayout}addEventHandler(t){this.viewModel.addViewEventHandler(t)}removeEventHandler(t){this.viewModel.removeViewEventHandler(t)}}var EE=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},AE=function(t,i){return function(e,s){i(e,s,t)}};let ME=class extends Qy{constructor(t,i,e,s,n,r,o){super(),this._instantiationService=o,this._shouldRecomputeGlyphMarginLanes=!1,this._selections=[new Ss(1,1,1,1)],this._renderAnimationFrame=null;const h=new Kx(i,s,n,t);this._context=new DE(i,e,s),this._context.addEventHandler(this),this._viewParts=[],this._textAreaHandler=this._instantiationService.createInstance(HS,this._context,h,this._createTextAreaHandlerHelper()),this._viewParts.push(this._textAreaHandler),this._linesContent=Sl(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=Sl(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=Sl(document.createElement("div")),Xy.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new dD(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new OD(this._context,this._linesContent),this._viewZones=new yE(this._context),this._viewParts.push(this._viewZones);const c=new eE(this._context);this._viewParts.push(c);const l=new cE(this._context);this._viewParts.push(l);const a=new Yx(this._context);this._viewParts.push(a),a.addDynamicOverlay(new lD(this._context)),a.addDynamicOverlay(new fE(this._context)),a.addDynamicOverlay(new AD(this._context)),a.addDynamicOverlay(new uD(this._context)),a.addDynamicOverlay(new kE(this._context));const u=new Xx(this._context);this._viewParts.push(u),u.addDynamicOverlay(new aD(this._context)),u.addDynamicOverlay(new _D(this._context)),u.addDynamicOverlay(new ID(this._context)),u.addDynamicOverlay(new OS(this._context)),this._glyphMarginWidgets=new wD(this._context),this._viewParts.push(this._glyphMarginWidgets);const d=new IS(this._context);d.getDomNode().appendChild(this._viewZones.marginDomNode),d.getDomNode().appendChild(u.getDomNode()),d.getDomNode().appendChild(this._glyphMarginWidgets.domNode),this._viewParts.push(d),this._contentWidgets=new eD(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new vE(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new tE(this._context,this.domNode),this._viewParts.push(this._overlayWidgets);const f=new hE(this._context);this._viewParts.push(f);const g=new iD(this._context);this._viewParts.push(g);const p=new QD(this._context);if(this._viewParts.push(p),c){const t=this._scrollbar.getOverviewRulerLayoutInfo();t.parent.insertBefore(c.getDomNode(),t.insertBefore)}this._linesContent.appendChild(a.getDomNode()),this._linesContent.appendChild(f.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(d.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(l.getDomNode()),this._overflowGuardContainer.appendChild(this._textAreaHandler.textArea),this._overflowGuardContainer.appendChild(this._textAreaHandler.textAreaCover),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(p.getDomNode()),this._overflowGuardContainer.appendChild(g.domNode),this.domNode.appendChild(this._overflowGuardContainer),r?(r.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode),r.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode.domNode)):(this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this.domNode.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode)),this._applyLayout(),this._pointerHandler=this._register(new DC(this._context,h,this._createPointerHandlerHelper()))}_computeGlyphMarginLanes(){const t=this._context.viewModel.model,i=this._context.viewModel.glyphLanes;let e=[],s=0;e=e.concat(t.getAllMarginDecorations().map((t=>{var i,e,n;const r=(e=(i=t.options.glyphMargin)===null||i===void 0?void 0:i.position)!==null&&e!==void 0?e:Xf.Center;return s=Math.max(s,t.range.endLineNumber),{range:t.range,lane:r,persist:(n=t.options.glyphMargin)===null||n===void 0?void 0:n.persistLane}}))),e=e.concat(this._glyphMarginWidgets.getWidgets().map((i=>{const e=t.validateRange(i.preference.range);return s=Math.max(s,e.endLineNumber),{range:e,lane:i.preference.lane}}))),e.sort(((t,i)=>Cs.compareRangesUsingStarts(t.range,i.range))),i.reset(s);for(const t of e)i.push(t.lane,t.range,t.persist);return i}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:t=>{this._textAreaHandler.textArea.domNode.dispatchEvent(t)},getLastRenderData:()=>{const t=this._viewCursors.getLastRenderData()||[],i=this._textAreaHandler.getLastRenderData();return new Ak(t,i)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:t=>this._viewZones.shouldSuppressMouseDownOnViewZone(t),shouldSuppressMouseDownOnWidget:t=>this._contentWidgets.shouldSuppressMouseDownOnWidget(t),getPositionFromDOMInfo:(t,i)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(t,i)),visibleRangeForPosition:(t,i)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new ks(t,i))),getLineWidth:t=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(t))}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:t=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(t))}}_applyLayout(){const t=this._context.configuration.options.get(145);this.domNode.setWidth(t.width),this.domNode.setHeight(t.height),this._overflowGuardContainer.setWidth(t.width),this._overflowGuardContainer.setHeight(t.height),this._linesContent.setWidth(16777216),this._linesContent.setHeight(16777216)}_getEditorClassName(){const t=this._textAreaHandler.isFocused()?" focused":"";return this._context.configuration.options.get(142)+" "+LC(this._context.theme.type)+t}handleEvents(t){super.handleEvents(t),this._scheduleRender()}onConfigurationChanged(t){return this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(t){return this._selections=t.selections,!1}onDecorationsChanged(t){return t.affectsGlyphMargin&&(this._shouldRecomputeGlyphMarginLanes=!0),!1}onFocusChanged(t){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(t){return this._context.theme.update(t.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){this._renderAnimationFrame!==null&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(const t of this._viewParts)t.dispose();super.dispose()}_scheduleRender(){if(this._store.isDisposed)throw new zi;if(this._renderAnimationFrame===null){const t=this._createCoordinatedRendering();this._renderAnimationFrame=FE.INSTANCE.scheduleCoordinatedRendering({window:Uh(this.domNode.domNode),prepareRenderText:()=>{if(this._store.isDisposed)throw new zi;try{return t.prepareRenderText()}finally{this._renderAnimationFrame=null}},renderText:()=>{if(this._store.isDisposed)throw new zi;return t.renderText()},prepareRender:(i,e)=>{if(this._store.isDisposed)throw new zi;return t.prepareRender(i,e)},render:(i,e)=>{if(this._store.isDisposed)throw new zi;return t.render(i,e)}})}}_flushAccumulatedAndRenderNow(){const t=this._createCoordinatedRendering();LE((()=>t.prepareRenderText()));const i=LE((()=>t.renderText()));if(i){const[e,s]=i;LE((()=>t.prepareRender(e,s))),LE((()=>t.render(e,s)))}}_getViewPartsToRender(){const t=[];let i=0;for(const e of this._viewParts)e.shouldRender()&&(t[i++]=e);return t}_createCoordinatedRendering(){return{prepareRenderText:()=>{if(this._shouldRecomputeGlyphMarginLanes){this._shouldRecomputeGlyphMarginLanes=!1;const t=this._computeGlyphMarginLanes();this._context.configuration.setGlyphMarginDecorationLaneCount(t.requiredLanes)}Mw.onRenderStart()},renderText:()=>{if(!this.domNode.domNode.isConnected)return null;let t=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&t.length===0)return null;const i=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(i.startLineNumber,i.endLineNumber,i.centeredLineNumber);const e=new SE(this._selections,i,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);return this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(e),this._viewLines.shouldRender()&&(this._viewLines.renderText(e),this._viewLines.onDidRender(),t=this._getViewPartsToRender()),[t,new ik(this._context.viewLayout,e,this._viewLines)]},prepareRender:(t,i)=>{for(const e of t)e.prepareRender(i)},render:(t,i)=>{for(const e of t)e.render(i),e.onDidRender()}}}delegateVerticalScrollbarPointerDown(t){this._scrollbar.delegateVerticalScrollbarPointerDown(t)}delegateScrollFromMouseWheelEvent(t){this._scrollbar.delegateScrollFromMouseWheelEvent(t)}restoreState(t){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:t.scrollTop,scrollLeft:t.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(t,i){const e=this._context.viewModel.model.validatePosition({lineNumber:t,column:i}),s=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(e);this._flushAccumulatedAndRenderNow();const n=this._viewLines.visibleRangeForPosition(new ks(s.lineNumber,s.column));return n?n.left:-1}getTargetAtClientPoint(t,i){const e=this._pointerHandler.getTargetAtClientPoint(t,i);return e?tD.convertViewToModelMouseTarget(e,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(t){return new oE(this._context,t)}change(t){this._viewZones.changeViewZones(t),this._scheduleRender()}render(t,i){if(i){this._viewLines.forceShouldRender();for(const t of this._viewParts)t.forceShouldRender()}t?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(t){this._textAreaHandler.writeScreenReaderContent(t)}focus(){this._textAreaHandler.focusTextArea()}isFocused(){return this._textAreaHandler.isFocused()}setAriaOptions(t){this._textAreaHandler.setAriaOptions(t)}addContentWidget(t){this._contentWidgets.addWidget(t.widget),this.layoutContentWidget(t),this._scheduleRender()}layoutContentWidget(t){var i,e,s,n,r,o,h,c;this._contentWidgets.setWidgetPosition(t.widget,(e=(i=t.position)===null||i===void 0?void 0:i.position)!==null&&e!==void 0?e:null,(n=(s=t.position)===null||s===void 0?void 0:s.secondaryPosition)!==null&&n!==void 0?n:null,(o=(r=t.position)===null||r===void 0?void 0:r.preference)!==null&&o!==void 0?o:null,(c=(h=t.position)===null||h===void 0?void 0:h.positionAffinity)!==null&&c!==void 0?c:null),this._scheduleRender()}removeContentWidget(t){this._contentWidgets.removeWidget(t.widget),this._scheduleRender()}addOverlayWidget(t){this._overlayWidgets.addWidget(t.widget),this.layoutOverlayWidget(t),this._scheduleRender()}layoutOverlayWidget(t){const i=t.position?t.position.preference:null;this._overlayWidgets.setWidgetPosition(t.widget,i)&&this._scheduleRender()}removeOverlayWidget(t){this._overlayWidgets.removeWidget(t.widget),this._scheduleRender()}addGlyphMarginWidget(t){this._glyphMarginWidgets.addWidget(t.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}layoutGlyphMarginWidget(t){const i=t.position;this._glyphMarginWidgets.setWidgetPosition(t.widget,i)&&(this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender())}removeGlyphMarginWidget(t){this._glyphMarginWidgets.removeWidget(t.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}};function LE(t){try{return t()}catch(t){return Ii(t),null}}ME=EE([AE(6,Il)],ME);class FE{constructor(){this._coordinatedRenderings=[],this._animationFrameRunners=new Map}scheduleCoordinatedRendering(t){return this._coordinatedRenderings.push(t),this._scheduleRender(t.window),{dispose:()=>{const i=this._coordinatedRenderings.indexOf(t);if(i!==-1&&(this._coordinatedRenderings.splice(i,1),this._coordinatedRenderings.length===0)){for(const[t,i]of this._animationFrameRunners)i.dispose();this._animationFrameRunners.clear()}}}}_scheduleRender(t){if(!this._animationFrameRunners.has(t)){const i=()=>{this._animationFrameRunners.delete(t),this._onRenderScheduled()};this._animationFrameRunners.set(t,lc(t,i,100))}}_onRenderScheduled(){const t=this._coordinatedRenderings.slice(0);this._coordinatedRenderings=[];for(const i of t)LE((()=>i.prepareRenderText()));const i=[];for(let e=0,s=t.length;e<s;e++){const s=t[e];i[e]=LE((()=>s.renderText()))}for(let e=0,s=t.length;e<s;e++){const s=t[e],n=i[e];if(!n)continue;const[r,o]=n;LE((()=>s.prepareRender(r,o)))}for(let e=0,s=t.length;e<s;e++){const s=t[e],n=i[e];if(!n)continue;const[r,o]=n;LE((()=>s.render(r,o)))}}}FE.INSTANCE=new FE;class TE{constructor(t,i,e,s,n){this.injectionOffsets=t,this.injectionOptions=i,this.breakOffsets=e,this.breakOffsetsVisibleColumn=s,this.wrappedTextIndentLength=n}getOutputLineCount(){return this.breakOffsets.length}getMinOutputOffset(t){return t>0?this.wrappedTextIndentLength:0}getLineLength(t){const i=t>0?this.breakOffsets[t-1]:0;let e=this.breakOffsets[t]-i;return t>0&&(e+=this.wrappedTextIndentLength),e}getMaxOutputOffset(t){return this.getLineLength(t)}translateToInputOffset(t,i){t>0&&(i=Math.max(0,i-this.wrappedTextIndentLength));let e=t===0?i:this.breakOffsets[t-1]+i;if(this.injectionOffsets!==null)for(let t=0;t<this.injectionOffsets.length&&e>this.injectionOffsets[t];t++)e<this.injectionOffsets[t]+this.injectionOptions[t].content.length?e=this.injectionOffsets[t]:e-=this.injectionOptions[t].content.length;return e}translateToOutputPosition(t,i=2){let e=t;if(this.injectionOffsets!==null)for(let s=0;s<this.injectionOffsets.length&&!(t<this.injectionOffsets[s])&&(i===1||t!==this.injectionOffsets[s]);s++)e+=this.injectionOptions[s].content.length;return this.offsetInInputWithInjectionsToOutputPosition(e,i)}offsetInInputWithInjectionsToOutputPosition(t,i=2){let e=0,s=this.breakOffsets.length-1,n=0,r=0;for(;e<=s;){n=e+(s-e)/2|0;const o=this.breakOffsets[n];if(r=n>0?this.breakOffsets[n-1]:0,i===0)if(t<=r)s=n-1;else{if(!(t>o))break;e=n+1}else if(t<r)s=n-1;else{if(!(t>=o))break;e=n+1}}let o=t-r;return n>0&&(o+=this.wrappedTextIndentLength),new IE(n,o)}normalizeOutputPosition(t,i,e){if(this.injectionOffsets!==null){const s=this.outputPositionToOffsetInInputWithInjections(t,i),n=this.normalizeOffsetInInputWithInjectionsAroundInjections(s,e);if(n!==s)return this.offsetInInputWithInjectionsToOutputPosition(n,e)}if(e===0){if(t>0&&i===this.getMinOutputOffset(t))return new IE(t-1,this.getMaxOutputOffset(t-1))}else if(e===1&&t<this.getOutputLineCount()-1&&i===this.getMaxOutputOffset(t))return new IE(t+1,this.getMinOutputOffset(t+1));return new IE(t,i)}outputPositionToOffsetInInputWithInjections(t,i){return t>0&&(i=Math.max(0,i-this.wrappedTextIndentLength)),(t>0?this.breakOffsets[t-1]:0)+i}normalizeOffsetInInputWithInjectionsAroundInjections(t,i){const e=this.getInjectedTextAtOffset(t);if(!e)return t;if(i===2){if(t===e.offsetInInputWithInjections+e.length&&RE(this.injectionOptions[e.injectedTextIndex].cursorStops))return e.offsetInInputWithInjections+e.length;{let t=e.offsetInInputWithInjections;if(OE(this.injectionOptions[e.injectedTextIndex].cursorStops))return t;let i=e.injectedTextIndex-1;for(;i>=0&&this.injectionOffsets[i]===this.injectionOffsets[e.injectedTextIndex]&&!RE(this.injectionOptions[i].cursorStops)&&(t-=this.injectionOptions[i].content.length,!OE(this.injectionOptions[i].cursorStops));)i--;return t}}if(i===1||i===4){let t=e.offsetInInputWithInjections+e.length,i=e.injectedTextIndex;for(;i+1<this.injectionOffsets.length&&this.injectionOffsets[i+1]===this.injectionOffsets[i];)t+=this.injectionOptions[i+1].content.length,i++;return t}if(i===0||i===3){let t=e.offsetInInputWithInjections,i=e.injectedTextIndex;for(;i-1>=0&&this.injectionOffsets[i-1]===this.injectionOffsets[i];)t-=this.injectionOptions[i-1].content.length,i--;return t}$a()}getInjectedText(t,i){const e=this.outputPositionToOffsetInInputWithInjections(t,i),s=this.getInjectedTextAtOffset(e);return s?{options:this.injectionOptions[s.injectedTextIndex]}:null}getInjectedTextAtOffset(t){const i=this.injectionOffsets,e=this.injectionOptions;if(i!==null){let s=0;for(let n=0;n<i.length;n++){const r=e[n].content.length,o=i[n]+s,h=i[n]+s+r;if(o>t)break;if(t<=h)return{injectedTextIndex:n,offsetInInputWithInjections:o,length:r};s+=r}}}}function RE(t){return t==null||t===tg.Right||t===tg.Both}function OE(t){return t==null||t===tg.Left||t===tg.Both}class IE{constructor(t,i){this.outputLineIndex=t,this.outputOffset=i}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(t){return new ks(t+this.outputLineIndex,this.outputOffset+1)}}class _E{constructor(){this.changeType=1}}class PE{static applyInjectedText(t,i){if(!i||i.length===0)return t;let e="",s=0;for(const n of i)e+=t.substring(s,n.column-1),s=n.column-1,e+=n.options.content;return e+=t.substring(s),e}static fromDecorations(t){const i=[];for(const e of t)e.options.before&&e.options.before.content.length>0&&i.push(new PE(e.ownerId,e.range.startLineNumber,e.range.startColumn,e.options.before,0)),e.options.after&&e.options.after.content.length>0&&i.push(new PE(e.ownerId,e.range.endLineNumber,e.range.endColumn,e.options.after,1));return i.sort(((t,i)=>t.lineNumber===i.lineNumber?t.column===i.column?t.order-i.order:t.column-i.column:t.lineNumber-i.lineNumber)),i}constructor(t,i,e,s,n){this.ownerId=t,this.lineNumber=i,this.column=e,this.options=s,this.order=n}}class NE{constructor(t,i,e){this.changeType=2,this.lineNumber=t,this.detail=i,this.injectedText=e}}class BE{constructor(t,i){this.changeType=3,this.fromLineNumber=t,this.toLineNumber=i}}class $E{constructor(t,i,e,s){this.changeType=4,this.injectedTexts=s,this.fromLineNumber=t,this.toLineNumber=i,this.detail=e}}class WE{constructor(){this.changeType=5}}class jE{constructor(t,i,e,s){this.changes=t,this.versionId=i,this.isUndoing=e,this.isRedoing=s,this.resultingSelection=null}containsEvent(t){for(let i=0,e=this.changes.length;i<e;i++)if(this.changes[i].changeType===t)return!0;return!1}static merge(t,i){const e=[].concat(t.changes).concat(i.changes),s=i.versionId,n=t.isUndoing||i.isUndoing,r=t.isRedoing||i.isRedoing;return new jE(e,s,n,r)}}class HE{constructor(t){this.changes=t}}class VE{constructor(t,i){this.rawContentChangedEvent=t,this.contentChangedEvent=i}merge(t){const i=jE.merge(this.rawContentChangedEvent,t.rawContentChangedEvent),e=VE._mergeChangeEvents(this.contentChangedEvent,t.contentChangedEvent);return new VE(i,e)}static _mergeChangeEvents(t,i){const e=[].concat(t.changes).concat(i.changes),s=i.eol,n=i.versionId,r=t.isUndoing||i.isUndoing,o=t.isRedoing||i.isRedoing,h=t.isFlush||i.isFlush;return{changes:e,eol:s,isEolChange:t.isEolChange&&i.isEolChange,versionId:n,isUndoing:r,isRedoing:o,isFlush:h}}}const zE=ju("domLineBreaksComputer",{createHTML:t=>t});class UE{static create(t){return new UE(new WeakRef(t))}constructor(t){this.targetWindow=t}createLineBreaksComputer(t,i,e,s,n){const r=[],o=[];return{addRequest:(t,i,e)=>{r.push(t),o.push(i)},finalize:()=>function(t,i,e,s,n,r,o,h){var c;function l(t){const e=h[t];if(e){const s=PE.applyInjectedText(i[t],e),n=e.map((t=>t.options)),r=e.map((t=>t.column-1));return new TE(r,n,[s.length],[],0)}return null}if(n===-1){const t=[];for(let e=0,s=i.length;e<s;e++)t[e]=l(e);return t}const a=Math.round(n*e.typicalHalfwidthCharacterWidth),u=r===3?2:r===2?1:0,d=Math.round(s*u),f=Math.ceil(e.spaceWidth*d),g=document.createElement("div");xl(g,e);const p=new gd(1e4),m=[],w=[],v=[],b=[],y=[];for(let t=0;t<i.length;t++){const n=PE.applyInjectedText(i[t],h[t]);let o=0,c=0,l=a;if(r!==0)if(o=tr(n),o===-1)o=0;else{for(let t=0;t<o;t++)c+=n.charCodeAt(t)===9?s-c%s:1;const t=Math.ceil(e.spaceWidth*c);t+e.typicalFullwidthCharacterWidth>a?(o=0,c=0):l=a-t}const u=n.substr(o),d=KE(u,c,s,l,p,f);m[t]=o,w[t]=c,v[t]=u,b[t]=d[0],y[t]=d[1]}const k=p.build(),C=(c=zE==null?void 0:zE.createHTML(k))!==null&&c!==void 0?c:k;g.innerHTML=C,g.style.position="absolute",g.style.top="10000",o==="keepAll"?(g.style.wordBreak="keep-all",g.style.overflowWrap="anywhere"):(g.style.wordBreak="inherit",g.style.overflowWrap="break-word"),t.document.body.appendChild(g);const S=document.createRange(),x=Array.prototype.slice.call(g.children,0),D=[];for(let t=0;t<i.length;t++){const i=qE(S,x[t],v[t],b[t]);if(i===null){D[t]=l(t);continue}const e=m[t],s=w[t]+d,n=y[t],r=[];for(let t=0,e=i.length;t<e;t++)r[t]=n[i[t]];if(e!==0)for(let t=0,s=i.length;t<s;t++)i[t]+=e;let o,c;const a=h[t];a?(o=a.map((t=>t.options)),c=a.map((t=>t.column-1))):(o=null,c=null),D[t]=new TE(c,o,i,r,s)}return t.document.body.removeChild(g),D}(H(this.targetWindow.deref()),r,t,i,e,s,n,o)}}}function KE(t,i,e,s,n,r){if(r!==0){const t=String(r);n.appendString('<div style="text-indent: -'),n.appendString(t),n.appendString("px; padding-left: "),n.appendString(t),n.appendString("px; box-sizing: border-box; width:")}else n.appendString('<div style="width:');n.appendString(String(s)),n.appendString('px;">');const o=t.length;let h=i,c=0;const l=[],a=[];let u=0<o?t.charCodeAt(0):0;n.appendString("<span>");for(let i=0;i<o;i++){i!==0&&i%16384==0&&n.appendString("</span><span>"),l[i]=c,a[i]=h;const s=u;u=i+1<o?t.charCodeAt(i+1):0;let r=1,d=1;switch(s){case 9:r=e-h%e,d=r;for(let t=1;t<=r;t++)t<r?n.appendCharCode(160):n.appendASCIICharCode(32);break;case 32:u===32?n.appendCharCode(160):n.appendASCIICharCode(32);break;case 60:n.appendString("&lt;");break;case 62:n.appendString("&gt;");break;case 38:n.appendString("&amp;");break;case 0:n.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:n.appendCharCode(65533);break;default:Mr(s)&&d++,s<32?n.appendCharCode(9216+s):n.appendCharCode(s)}c+=r,h+=d}return n.appendString("</span>"),l[t.length]=c,a[t.length]=h,n.appendString("</div>"),[l,a]}function qE(t,i,e,s){if(e.length<=1)return null;const n=Array.prototype.slice.call(i.children,0),r=[];try{GE(t,n,s,0,null,e.length-1,null,r)}catch(t){return console.log(t),null}return r.length===0?null:(r.push(e.length),r)}function GE(t,i,e,s,n,r,o,h){if(s===r||(n=n||ZE(t,i,e[s],e[s+1]),o=o||ZE(t,i,e[r],e[r+1]),Math.abs(n[0].top-o[0].top)<=.1))return;if(s+1===r)return void h.push(r);const c=s+(r-s)/2|0,l=ZE(t,i,e[c],e[c+1]);GE(t,i,e,s,n,c,l,h),GE(t,i,e,c,l,r,o,h)}function ZE(t,i,e,s){return t.setStart(i[e/16384|0].firstChild,e%16384),t.setEnd(i[s/16384|0].firstChild,s%16384),t.getClientRects()}class JE extends Qi{constructor(){super(),this._editor=null,this._instantiationService=null,this._instances=this._register(new ie),this._pending=new Map,this._finishedInstantiation=[],this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(t,i,e){this._editor=t,this._instantiationService=e;for(const t of i)this._pending.has(t.id)?Ii(new Error(`Cannot have two contributions with the same id ${t.id}`)):this._pending.set(t.id,t);this._instantiateSome(0),this._register(hc(Uh(this._editor.getDomNode()),(()=>{this._instantiateSome(1)}))),this._register(hc(Uh(this._editor.getDomNode()),(()=>{this._instantiateSome(2)}))),this._register(hc(Uh(this._editor.getDomNode()),(()=>{this._instantiateSome(3)}),5e3))}saveViewState(){const t={};for(const[i,e]of this._instances)typeof e.saveViewState=="function"&&(t[i]=e.saveViewState());return t}restoreViewState(t){for(const[i,e]of this._instances)typeof e.restoreViewState=="function"&&e.restoreViewState(t[i])}get(t){return this._instantiateById(t),this._instances.get(t)||null}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){var t;return hc(Uh((t=this._editor)===null||t===void 0?void 0:t.getDomNode()),(()=>{this._instantiateSome(1)}),50)}_instantiateSome(t){if(this._finishedInstantiation[t])return;this._finishedInstantiation[t]=!0;const i=this._findPendingContributionsByInstantiation(t);for(const t of i)this._instantiateById(t.id)}_findPendingContributionsByInstantiation(t){const i=[];for(const[,e]of this._pending)e.instantiation===t&&i.push(e);return i}_instantiateById(t){const i=this._pending.get(t);if(i){if(this._pending.delete(t),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{const t=this._instantiationService.createInstance(i.ctor,this._editor);this._instances.set(i.id,t),typeof t.restoreViewState=="function"&&i.instantiation!==0&&console.warn(`Editor contribution '${i.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(t){Ii(t)}}}}class QE{constructor(t,i,e,s,n,r,o){this.id=t,this.label=i,this.alias=e,this.metadata=s,this._precondition=n,this._run=r,this._contextKeyService=o}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(t){return this.isSupported()?this._run(t):Promise.resolve(void 0)}}function YE(t){let i=0,e=0,s=0,n=0;for(let r=0,o=t.length;r<o;r++){const h=t.charCodeAt(r);h===13?(i===0&&(e=r),i++,r+1<o&&t.charCodeAt(r+1)===10?(n|=2,r++):n|=3,s=r+1):h===10&&(n|=1,i===0&&(e=r),i++,s=r+1)}return i===0&&(e=t.length),[i,e,t.length-s,n]}class XE{constructor(t,i,e,s){this.range=t,this.nestingLevel=i,this.nestingLevelOfEqualBracketType=e,this.isInvalid=s}}class tA{constructor(t,i,e,s,n,r){this.range=t,this.openingBracketRange=i,this.closingBracketRange=e,this.nestingLevel=s,this.nestingLevelOfEqualBracketType=n,this.bracketPairNode=r}get openingBracketInfo(){return this.bracketPairNode.openingBracket.bracketInfo}}class iA extends tA{constructor(t,i,e,s,n,r,o){super(t,i,e,s,n,r),this.minVisibleColumnIndentation=o}}class eA{static ofText(t){let i=0,e=0;for(const s of t)s===`\n`?(i++,e=0):e++;return new eA(i,e)}constructor(t,i){this.lineCount=t,this.columnCount=i}createRange(t){return this.lineCount===0?new Cs(t.lineNumber,t.column,t.lineNumber,t.column+this.columnCount):new Cs(t.lineNumber,t.column,t.lineNumber+this.lineCount,this.columnCount+1)}addToPosition(t){return this.lineCount===0?new ks(t.lineNumber,t.column+this.columnCount):new ks(t.lineNumber+this.lineCount,this.columnCount+1)}toString(){return`${this.lineCount},${this.columnCount}`}}eA.zero=new eA(0,0);const sA=0;function nA(t){return t===0}const rA=2**26;function oA(t,i){return t*rA+i}function hA(t){const i=t,e=Math.floor(i/rA);return new eA(e,i-e*rA)}function cA(t,i){let e=t+i;return i>=rA&&(e-=t%rA),e}function lA(t,i){return t.reduce(((t,e)=>cA(t,i(e))),sA)}function aA(t,i){return t===i}function uA(t,i){const e=t,s=i;if(s-e<=0)return sA;const n=Math.floor(e/rA),r=Math.floor(s/rA),o=s-r*rA;return n===r?oA(0,o-(e-n*rA)):oA(r-n,o)}function dA(t,i){return t<i}function fA(t,i){return t<=i}function gA(t,i){return t>=i}function pA(t){return oA(t.lineNumber-1,t.column-1)}function mA(t,i){const e=t,s=Math.floor(e/rA),n=e-s*rA,r=i,o=Math.floor(r/rA);return new Cs(s+1,n+1,o+1,r-o*rA+1)}class wA{static fromModelContentChanges(t){return t.map((t=>{const i=Cs.lift(t.range);return new wA(pA(i.getStartPosition()),pA(i.getEndPosition()),function(t){const i=Xn(t);return oA(i.length-1,i[i.length-1].length)}(t.text))})).reverse()}constructor(t,i,e){this.startOffset=t,this.endOffset=i,this.newLength=e}toString(){return`[${hA(this.startOffset)}...${hA(this.endOffset)}) -> ${hA(this.newLength)}`}}class vA{constructor(t){this.nextEditIdx=0,this.deltaOldToNewLineCount=0,this.deltaOldToNewColumnCount=0,this.deltaLineIdxInOld=-1,this.edits=t.map((t=>bA.from(t)))}getOffsetBeforeChange(t){return this.adjustNextEdit(t),this.translateCurToOld(t)}getDistanceToNextChange(t){this.adjustNextEdit(t);const i=this.edits[this.nextEditIdx],e=i?this.translateOldToCur(i.offsetObj):null;return e===null?null:uA(t,e)}translateOldToCur(t){return t.lineCount===this.deltaLineIdxInOld?oA(t.lineCount+this.deltaOldToNewLineCount,t.columnCount+this.deltaOldToNewColumnCount):oA(t.lineCount+this.deltaOldToNewLineCount,t.columnCount)}translateCurToOld(t){const i=hA(t);return i.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?oA(i.lineCount-this.deltaOldToNewLineCount,i.columnCount-this.deltaOldToNewColumnCount):oA(i.lineCount-this.deltaOldToNewLineCount,i.columnCount)}adjustNextEdit(t){for(;this.nextEditIdx<this.edits.length;){const i=this.edits[this.nextEditIdx],e=this.translateOldToCur(i.endOffsetAfterObj);if(!fA(e,t))break;{this.nextEditIdx++;const t=hA(e),s=hA(this.translateOldToCur(i.endOffsetBeforeObj)),n=t.lineCount-s.lineCount;this.deltaOldToNewLineCount+=n;const r=this.deltaLineIdxInOld===i.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,o=t.columnCount-s.columnCount;this.deltaOldToNewColumnCount=r+o,this.deltaLineIdxInOld=i.endOffsetBeforeObj.lineCount}}}}class bA{static from(t){return new bA(t.startOffset,t.endOffset,t.newLength)}constructor(t,i,e){this.endOffsetBeforeObj=hA(i),this.endOffsetAfterObj=hA(cA(t,e)),this.offsetObj=hA(t)}}const yA=[];class kA{static create(t,i){if(t<=128&&i.length===0){let e=kA.cache[t];return e||(e=new kA(t,i),kA.cache[t]=e),e}return new kA(t,i)}static getEmpty(){return this.empty}constructor(t,i){this.items=t,this.additionalItems=i}add(t,i){const e=i.getKey(t);let s=e>>5;if(s===0){const t=1<<e|this.items;return t===this.items?this:kA.create(t,this.additionalItems)}s--;const n=this.additionalItems.slice(0);for(;n.length<s;)n.push(0);return n[s]|=1<<(31&e),kA.create(this.items,n)}merge(t){const i=this.items|t.items;if(this.additionalItems===yA&&t.additionalItems===yA)return i===this.items?this:i===t.items?t:kA.create(i,yA);const e=[];for(let i=0;i<Math.max(this.additionalItems.length,t.additionalItems.length);i++){const s=this.additionalItems[i]||0,n=t.additionalItems[i]||0;e.push(s|n)}return kA.create(i,e)}intersects(t){if(this.items&t.items)return!0;for(let i=0;i<Math.min(this.additionalItems.length,t.additionalItems.length);i++)if(this.additionalItems[i]&t.additionalItems[i])return!0;return!1}}kA.cache=new Array(129),kA.empty=kA.create(0,yA);const CA={getKey:t=>t};class SA{constructor(){this.items=new Map}getKey(t){let i=this.items.get(t);return i===void 0&&(i=this.items.size,this.items.set(t,i)),i}}class xA{get length(){return this._length}constructor(t){this._length=t}}class DA extends xA{static create(t,i,e){let s=t.length;return i&&(s=cA(s,i.length)),e&&(s=cA(s,e.length)),new DA(s,t,i,e,i?i.missingOpeningBracketIds:kA.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(t){switch(t){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){const t=[];return t.push(this.openingBracket),this.child&&t.push(this.child),this.closingBracket&&t.push(this.closingBracket),t}constructor(t,i,e,s,n){super(t),this.openingBracket=i,this.child=e,this.closingBracket=s,this.missingOpeningBracketIds=n}canBeReused(t){return this.closingBracket!==null&&!t.intersects(this.missingOpeningBracketIds)}deepClone(){return new DA(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(t,i){return this.child?this.child.computeMinIndentation(cA(t,this.openingBracket.length),i):Number.MAX_SAFE_INTEGER}}class EA extends xA{static create23(t,i,e,s=!1){let n=t.length,r=t.missingOpeningBracketIds;if(t.listHeight!==i.listHeight)throw new Error("Invalid list heights");if(n=cA(n,i.length),r=r.merge(i.missingOpeningBracketIds),e){if(t.listHeight!==e.listHeight)throw new Error("Invalid list heights");n=cA(n,e.length),r=r.merge(e.missingOpeningBracketIds)}return s?new MA(n,t.listHeight+1,t,i,e,r):new AA(n,t.listHeight+1,t,i,e,r)}static getEmpty(){return new FA(sA,0,[],kA.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}constructor(t,i,e){super(t),this.listHeight=i,this._missingOpeningBracketIds=e,this.cachedMinIndentation=-1}throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();const t=this.childrenLength;if(t===0)return;const i=this.getChild(t-1),e=i.kind===4?i.toMutable():i;return i!==e&&this.setChild(t-1,e),e}makeFirstElementMutable(){if(this.throwIfImmutable(),this.childrenLength===0)return;const t=this.getChild(0),i=t.kind===4?t.toMutable():t;return t!==i&&this.setChild(0,i),i}canBeReused(t){if(t.intersects(this.missingOpeningBracketIds)||this.childrenLength===0)return!1;let i=this;for(;i.kind===4;){const t=i.childrenLength;if(t===0)throw new zi;i=i.getChild(t-1)}return i.canBeReused(t)}handleChildrenChanged(){this.throwIfImmutable();const t=this.childrenLength;let i=this.getChild(0).length,e=this.getChild(0).missingOpeningBracketIds;for(let s=1;s<t;s++){const t=this.getChild(s);i=cA(i,t.length),e=e.merge(t.missingOpeningBracketIds)}this._length=i,this._missingOpeningBracketIds=e,this.cachedMinIndentation=-1}computeMinIndentation(t,i){if(this.cachedMinIndentation!==-1)return this.cachedMinIndentation;let e=Number.MAX_SAFE_INTEGER,s=t;for(let t=0;t<this.childrenLength;t++){const n=this.getChild(t);n&&(e=Math.min(e,n.computeMinIndentation(s,i)),s=cA(s,n.length))}return this.cachedMinIndentation=e,e}}class AA extends EA{get childrenLength(){return this._item3!==null?3:2}getChild(t){switch(t){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(t,i){switch(t){case 0:return void(this._item1=i);case 1:return void(this._item2=i);case 2:return void(this._item3=i)}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}constructor(t,i,e,s,n,r){super(t,i,r),this._item1=e,this._item2=s,this._item3=n}deepClone(){return new AA(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(t){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=t,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const t=this._item3;return this._item3=null,this.handleChildrenChanged(),t}prependChildOfSameHeight(t){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=t,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const t=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),t}toMutable(){return this}}class MA extends AA{toMutable(){return new AA(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}class LA extends EA{get childrenLength(){return this._children.length}getChild(t){return this._children[t]}setChild(t,i){this._children[t]=i}get children(){return this._children}constructor(t,i,e,s){super(t,i,s),this._children=e}deepClone(){const t=new Array(this._children.length);for(let i=0;i<this._children.length;i++)t[i]=this._children[i].deepClone();return new LA(this.length,this.listHeight,t,this.missingOpeningBracketIds)}appendChildOfSameHeight(t){this.throwIfImmutable(),this._children.push(t),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();const t=this._children.pop();return this.handleChildrenChanged(),t}prependChildOfSameHeight(t){this.throwIfImmutable(),this._children.unshift(t),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();const t=this._children.shift();return this.handleChildrenChanged(),t}toMutable(){return this}}class FA extends LA{toMutable(){return new LA(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}const TA=[];class RA extends xA{get listHeight(){return 0}get childrenLength(){return 0}getChild(t){return null}get children(){return TA}deepClone(){return this}}class OA extends RA{get kind(){return 0}get missingOpeningBracketIds(){return kA.getEmpty()}canBeReused(t){return!0}computeMinIndentation(t,i){const e=hA(t),s=(e.columnCount===0?e.lineCount:e.lineCount+1)+1,n=function(t){return Math.floor(t/rA)}(cA(t,this.length))+1;let r=Number.MAX_SAFE_INTEGER;for(let t=s;t<=n;t++){const e=i.getLineFirstNonWhitespaceColumn(t),s=i.getLineContent(t);if(e===0)continue;const n=Ck.visibleColumnFromColumn(s,e,i.getOptions().tabSize);r=Math.min(r,n)}return r}}class IA extends RA{static create(t,i,e){return new IA(t,i,e)}get kind(){return 1}get missingOpeningBracketIds(){return kA.getEmpty()}constructor(t,i,e){super(t),this.bracketInfo=i,this.bracketIds=e}get text(){return this.bracketInfo.bracketText}get languageId(){return this.bracketInfo.languageId}canBeReused(t){return!1}computeMinIndentation(t,i){return Number.MAX_SAFE_INTEGER}}class _A extends RA{get kind(){return 3}constructor(t,i){super(i),this.missingOpeningBracketIds=t}canBeReused(t){return!t.intersects(this.missingOpeningBracketIds)}computeMinIndentation(t,i){return Number.MAX_SAFE_INTEGER}}let PA=class{constructor(t,i,e,s,n){this.length=t,this.kind=i,this.bracketId=e,this.bracketIds=s,this.astNode=n}};class NA{constructor(t,i){this.textModel=t,this.bracketTokens=i,this.reader=new BA(this.textModel,this.bracketTokens),this._offset=sA,this.didPeek=!1,this.peeked=null,this.textBufferLineCount=t.getLineCount(),this.textBufferLastLineLength=t.getLineLength(this.textBufferLineCount)}get offset(){return this._offset}get length(){return oA(this.textBufferLineCount-1,this.textBufferLastLineLength)}skip(t){this.didPeek=!1,this._offset=cA(this._offset,t);const i=hA(this._offset);this.reader.setPosition(i.lineCount,i.columnCount)}read(){let t;return this.peeked?(this.didPeek=!1,t=this.peeked):t=this.reader.read(),t&&(this._offset=cA(this._offset,t.length)),t}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}}class BA{constructor(t,i){this.textModel=t,this.bracketTokens=i,this.lineIdx=0,this.line=null,this.lineCharOffset=0,this.lineTokens=null,this.lineTokenOffset=0,this.peekedToken=null,this.textBufferLineCount=t.getLineCount(),this.textBufferLastLineLength=t.getLineLength(this.textBufferLineCount)}setPosition(t,i){t===this.lineIdx?(this.lineCharOffset=i,this.line!==null&&(this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset))):(this.lineIdx=t,this.lineCharOffset=i,this.line=null),this.peekedToken=null}read(){if(this.peekedToken){const t=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=t.length,t}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;this.line===null&&(this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));const t=this.lineIdx,i=this.lineCharOffset;let e=0;for(;;){const s=this.lineTokens,n=s.getCount();let r=null;if(this.lineTokenOffset<n){const o=s.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<n&&o===s.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;const h=em.getTokenType(o)===0,c=em.containsBalancedBrackets(o),l=s.getEndOffset(this.lineTokenOffset);if(c&&h&&this.lineCharOffset<l){const t=s.getLanguageId(this.lineTokenOffset),i=this.line.substring(this.lineCharOffset,l),e=this.bracketTokens.getSingleLanguageBracketTokens(t),n=e.regExpGlobal;if(n){n.lastIndex=0;const t=n.exec(i);t&&(r=e.getToken(t[0]),r&&(this.lineCharOffset+=t.index))}}if(e+=l-this.lineCharOffset,r){if(t!==this.lineIdx||i!==this.lineCharOffset){this.peekedToken=r;break}return this.lineCharOffset+=r.length,r}this.lineTokenOffset++,this.lineCharOffset=l}else if(this.lineIdx===this.textBufferLineCount-1||(this.lineIdx++,this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,e+=33,e>1e3))break;if(e>1500)break}const s=(n=t,r=i,o=this.lineIdx,h=this.lineCharOffset,n!==o?oA(o-n,h):oA(0,h-r));var n,r,o,h;return new PA(s,0,-1,kA.getEmpty(),new OA(s))}}class $A{constructor(t,i){this.text=t,this._offset=sA,this.idx=0;const e=i.getRegExpStr(),s=e?new RegExp(e+`|\n`,"gi"):null,n=[];let r,o=0,h=0,c=0,l=0;const a=[];for(let t=0;t<60;t++)a.push(new PA(oA(0,t),0,-1,kA.getEmpty(),new OA(oA(0,t))));const u=[];for(let t=0;t<60;t++)u.push(new PA(oA(1,t),0,-1,kA.getEmpty(),new OA(oA(1,t))));if(s)for(s.lastIndex=0;(r=s.exec(t))!==null;){const t=r.index,e=r[0];if(e===`\n`)o++,h=t+1;else{if(c!==t){let i;if(l===o){const e=t-c;if(e<a.length)i=a[e];else{const t=oA(0,e);i=new PA(t,0,-1,kA.getEmpty(),new OA(t))}}else{const e=o-l,s=t-h;if(e===1&&s<u.length)i=u[s];else{const t=oA(e,s);i=new PA(t,0,-1,kA.getEmpty(),new OA(t))}}n.push(i)}n.push(i.getToken(e)),c=t+e.length,l=o}}const d=t.length;if(c!==d){const t=l===o?oA(0,d-c):oA(o-l,d-h);n.push(new PA(t,0,-1,kA.getEmpty(),new OA(t)))}this.length=oA(o,d-h),this.tokens=n}get offset(){return this._offset}read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(t){throw new Hi}}class WA{static createFromLanguage(t,i){function e(t){return i.getKey(`${t.languageId}:::${t.bracketText}`)}const s=new Map;for(const i of t.bracketsNew.openingBrackets){const t=oA(0,i.bracketText.length),n=e(i),r=kA.getEmpty().add(n,CA);s.set(i.bracketText,new PA(t,1,n,r,IA.create(t,i,r)))}for(const i of t.bracketsNew.closingBrackets){const t=oA(0,i.bracketText.length);let n=kA.getEmpty();const r=i.getOpeningBrackets();for(const t of r)n=n.add(e(t),CA);s.set(i.bracketText,new PA(t,2,e(r[0]),n,IA.create(t,i,n)))}return new WA(s)}constructor(t){this.map=t,this.hasRegExp=!1,this._regExpGlobal=null}getRegExpStr(){if(this.isEmpty)return null;{const t=[...this.map.keys()];return t.sort(),t.reverse(),t.map((t=>function(t){let i=Gn(t);return/^[\w ]+/.test(t)&&(i=`\\b${i}`),/[\w ]+$/.test(t)&&(i=`${i}\\b`),i}(t))).join("|")}}get regExpGlobal(){if(!this.hasRegExp){const t=this.getRegExpStr();this._regExpGlobal=t?new RegExp(t,"gi"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(t){return this.map.get(t.toLowerCase())}findClosingTokenText(t){for(const[i,e]of this.map)if(e.kind===2&&e.bracketIds.intersects(t))return i}get isEmpty(){return this.map.size===0}}class jA{constructor(t,i){this.denseKeyProvider=t,this.getLanguageConfiguration=i,this.languageIdToBracketTokens=new Map}didLanguageChange(t){return this.languageIdToBracketTokens.has(t)}getSingleLanguageBracketTokens(t){let i=this.languageIdToBracketTokens.get(t);return i||(i=WA.createFromLanguage(this.getLanguageConfiguration(t),this.denseKeyProvider),this.languageIdToBracketTokens.set(t,i)),i}}function HA(t,i=!1){if(t.length===0)return null;if(t.length===1)return t[0];let e=t.length;for(;e>3;){const s=e>>1;for(let n=0;n<s;n++){const s=n<<1;t[n]=EA.create23(t[s],t[s+1],s+3===e?t[s+2]:null,i)}e=s}return EA.create23(t[0],t[1],e>=3?t[2]:null,i)}function VA(t,i){return Math.abs(t.listHeight-i.listHeight)}function zA(t,i){return t.listHeight===i.listHeight?EA.create23(t,i,null,!1):t.listHeight>i.listHeight?function(t,i){let e=t=t.toMutable();const s=[];let n;for(;;){if(i.listHeight===e.listHeight){n=i;break}if(e.kind!==4)throw new Error("unexpected");s.push(e),e=e.makeLastElementMutable()}for(let t=s.length-1;t>=0;t--){const i=s[t];n?i.childrenLength>=3?n=EA.create23(i.unappendChild(),n,null,!1):(i.appendChildOfSameHeight(n),n=void 0):i.handleChildrenChanged()}return n?EA.create23(t,n,null,!1):t}(t,i):function(t,i){let e=t=t.toMutable();const s=[];for(;i.listHeight!==e.listHeight;){if(e.kind!==4)throw new Error("unexpected");s.push(e),e=e.makeFirstElementMutable()}let n=i;for(let t=s.length-1;t>=0;t--){const i=s[t];n?i.childrenLength>=3?n=EA.create23(n,i.unprependChild(),null,!1):(i.prependChildOfSameHeight(n),n=void 0):i.handleChildrenChanged()}return n?EA.create23(n,t,null,!1):t}(i,t)}class UA{constructor(t){this.lastOffset=sA,this.nextNodes=[t],this.offsets=[sA],this.idxs=[]}readLongestNodeAt(t,i){if(dA(t,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=t;;){const e=qA(this.nextNodes);if(!e)return;const s=qA(this.offsets);if(dA(t,s))return;if(dA(s,t))if(cA(s,e.length)<=t)this.nextNodeAfterCurrent();else{const t=KA(e);t!==-1?(this.nextNodes.push(e.getChild(t)),this.offsets.push(s),this.idxs.push(t)):this.nextNodeAfterCurrent()}else{if(i(e))return this.nextNodeAfterCurrent(),e;{const t=KA(e);if(t===-1)return void this.nextNodeAfterCurrent();this.nextNodes.push(e.getChild(t)),this.offsets.push(s),this.idxs.push(t)}}}}nextNodeAfterCurrent(){for(;;){const t=qA(this.offsets),i=qA(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),this.idxs.length===0)break;const e=qA(this.nextNodes),s=KA(e,this.idxs[this.idxs.length-1]);if(s!==-1){this.nextNodes.push(e.getChild(s)),this.offsets.push(cA(t,i.length)),this.idxs[this.idxs.length-1]=s;break}this.idxs.pop()}}}function KA(t,i=-1){for(;;){if(++i>=t.childrenLength)return-1;if(t.getChild(i))return i}}function qA(t){return t.length>0?t[t.length-1]:void 0}function GA(t,i,e,s){return new ZA(t,i,e,s).parseDocument()}class ZA{constructor(t,i,e,s){if(this.tokenizer=t,this.createImmutableLists=s,this._itemsConstructed=0,this._itemsFromCache=0,e&&s)throw new Error("Not supported");this.oldNodeReader=e?new UA(e):void 0,this.positionMapper=new vA(i)}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let t=this.parseList(kA.getEmpty(),0);return t||(t=EA.getEmpty()),t}parseList(t,i){const e=[];for(;;){let s=this.tryReadChildFromCache(t);if(!s){const e=this.tokenizer.peek();if(!e||e.kind===2&&e.bracketIds.intersects(t))break;s=this.parseChild(t,i+1)}s.kind===4&&s.childrenLength===0||e.push(s)}return this.oldNodeReader?function(t){if(t.length===0)return null;if(t.length===1)return t[0];let i=0;function e(){if(i>=t.length)return null;const e=i,s=t[e].listHeight;for(i++;i<t.length&&t[i].listHeight===s;)i++;return i-e>=2?HA(e===0&&i===t.length?t:t.slice(e,i),!1):t[e]}let s=e(),n=e();if(!n)return s;for(let t=e();t;t=e())VA(s,n)<=VA(n,t)?(s=zA(s,n),n=t):n=zA(n,t);return zA(s,n)}(e):HA(e,this.createImmutableLists)}tryReadChildFromCache(t){if(this.oldNodeReader){const i=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(i===null||!nA(i)){const e=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),(e=>i!==null&&!dA(e.length,i)?!1:e.canBeReused(t)));if(e)return this._itemsFromCache++,this.tokenizer.skip(e.length),e}}}parseChild(t,i){this._itemsConstructed++;const e=this.tokenizer.read();switch(e.kind){case 2:return new _A(e.bracketIds,e.length);case 0:return e.astNode;case 1:{if(i>300)return new OA(e.length);const s=t.merge(e.bracketIds),n=this.parseList(s,i+1),r=this.tokenizer.peek();return r&&r.kind===2&&(r.bracketId===e.bracketId||r.bracketIds.intersects(e.bracketIds))?(this.tokenizer.read(),DA.create(e.astNode,n,r.astNode)):DA.create(e.astNode,n,null)}default:throw new Error("unexpected")}}}function JA(t,i){if(t.length===0)return i;if(i.length===0)return t;const e=new L(YA(t)),s=YA(i);s.push({modified:!1,lengthBefore:void 0,lengthAfter:void 0});let n=e.dequeue();function r(t){if(t===void 0){const t=e.takeWhile((t=>!0))||[];return n&&t.unshift(n),t}const i=[];for(;n&&!nA(t);){const[s,r]=n.splitAt(t);i.push(s),t=uA(s.lengthAfter,t),n=r??e.dequeue()}return nA(t)||i.push(new QA(!1,t,t)),i}const o=[];function h(t,i,e){if(o.length>0&&aA(o[o.length-1].endOffset,t)){const t=o[o.length-1];o[o.length-1]=new wA(t.startOffset,i,cA(t.newLength,e))}else o.push({startOffset:t,endOffset:i,newLength:e})}let c=sA;for(const t of s){const i=r(t.lengthBefore);if(t.modified){const e=cA(c,lA(i,(t=>t.lengthBefore)));h(c,e,t.lengthAfter),c=e}else for(const t of i){const i=c;c=cA(c,t.lengthBefore),t.modified&&h(i,c,t.lengthAfter)}}return o}class QA{constructor(t,i,e){this.modified=t,this.lengthBefore=i,this.lengthAfter=e}splitAt(t){const i=uA(t,this.lengthAfter);return aA(i,sA)?[this,void 0]:this.modified?[new QA(this.modified,this.lengthBefore,t),new QA(this.modified,sA,i)]:[new QA(this.modified,t,t),new QA(this.modified,i,i)]}toString(){return`${this.modified?"M":"U"}:${hA(this.lengthBefore)} -> ${hA(this.lengthAfter)}`}}function YA(t){const i=[];let e=sA;for(const s of t){const t=uA(e,s.startOffset);nA(t)||i.push(new QA(!1,t,t));const n=uA(s.startOffset,s.endOffset);i.push(new QA(!0,n,s.newLength)),e=s.endOffset}return i}class XA extends Qi{didLanguageChange(t){return this.brackets.didLanguageChange(t)}constructor(t,i){if(super(),this.textModel=t,this.getLanguageConfiguration=i,this.didChangeEmitter=new le,this.denseKeyProvider=new SA,this.brackets=new jA(this.denseKeyProvider,this.getLanguageConfiguration),this.onDidChange=this.didChangeEmitter.event,this.queuedTextEditsForInitialAstWithoutTokens=[],this.queuedTextEdits=[],t.tokenization.hasTokens)t.tokenization.backgroundTokenizationState===2?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens);else{const t=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),i=new $A(this.textModel.getValue(),t);this.initialAstWithoutTokens=GA(i,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}}handleDidChangeBackgroundTokenizationState(){if(this.textModel.tokenization.backgroundTokenizationState===2){const t=this.initialAstWithoutTokens===void 0;this.initialAstWithoutTokens=void 0,t||this.didChangeEmitter.fire()}}handleDidChangeTokens({ranges:t}){const i=t.map((t=>new wA(oA(t.fromLineNumber-1,0),oA(t.toLineNumber,0),oA(t.toLineNumber-t.fromLineNumber+1,0))));this.handleEdits(i,!0),this.initialAstWithoutTokens||this.didChangeEmitter.fire()}handleContentChanged(t){const i=wA.fromModelContentChanges(t.changes);this.handleEdits(i,!1)}handleEdits(t,i){const e=JA(this.queuedTextEdits,t);this.queuedTextEdits=e,this.initialAstWithoutTokens&&!i&&(this.queuedTextEditsForInitialAstWithoutTokens=JA(this.queuedTextEditsForInitialAstWithoutTokens,t))}flushQueue(){this.queuedTextEdits.length>0&&(this.astWithTokens=this.parseDocumentFromTextBuffer(this.queuedTextEdits,this.astWithTokens,!1),this.queuedTextEdits=[]),this.queuedTextEditsForInitialAstWithoutTokens.length>0&&(this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(this.queuedTextEditsForInitialAstWithoutTokens,this.initialAstWithoutTokens,!1)),this.queuedTextEditsForInitialAstWithoutTokens=[])}parseDocumentFromTextBuffer(t,i,e){const s=i;return GA(new NA(this.textModel,this.brackets),t,s,e)}getBracketsInRange(t,i){this.flushQueue();const e=oA(t.startLineNumber-1,t.startColumn-1),s=oA(t.endLineNumber-1,t.endColumn-1);return new F((t=>{const n=this.initialAstWithoutTokens||this.astWithTokens;eM(n,sA,n.length,e,s,t,0,0,new Map,i)}))}getBracketPairsInRange(t,i){this.flushQueue();const e=pA(t.getStartPosition()),s=pA(t.getEndPosition());return new F((t=>{const n=this.initialAstWithoutTokens||this.astWithTokens,r=new sM(t,i,this.textModel);nM(n,sA,n.length,e,s,r,0,new Map)}))}getFirstBracketAfter(t){this.flushQueue();const i=this.initialAstWithoutTokens||this.astWithTokens;return iM(i,sA,i.length,pA(t))}getFirstBracketBefore(t){this.flushQueue();const i=this.initialAstWithoutTokens||this.astWithTokens;return tM(i,sA,i.length,pA(t))}}function tM(t,i,e,s){if(t.kind===4||t.kind===2){const n=[];for(const s of t.children)e=cA(i,s.length),n.push({nodeOffsetStart:i,nodeOffsetEnd:e}),i=e;for(let i=n.length-1;i>=0;i--){const{nodeOffsetStart:e,nodeOffsetEnd:r}=n[i];if(dA(e,s)){const n=tM(t.children[i],e,r,s);if(n)return n}}return null}if(t.kind===3)return null;if(t.kind===1){const s=mA(i,e);return{bracketInfo:t.bracketInfo,range:s}}return null}function iM(t,i,e,s){if(t.kind===4||t.kind===2){for(const n of t.children){if(dA(s,e=cA(i,n.length))){const t=iM(n,i,e,s);if(t)return t}i=e}return null}if(t.kind===3)return null;if(t.kind===1){const s=mA(i,e);return{bracketInfo:t.bracketInfo,range:s}}return null}function eM(t,i,e,s,n,r,o,h,c,l,a=!1){if(o>200)return!0;t:for(;;)switch(t.kind){case 4:{const h=t.childrenLength;for(let a=0;a<h;a++){const h=t.getChild(a);if(h){if(e=cA(i,h.length),fA(i,n)&&gA(e,s)){if(gA(e,n)){t=h;continue t}if(!eM(h,i,e,s,n,r,o,0,c,l))return!1}i=e}}return!0}case 2:{const a=!l||!t.closingBracket||t.closingBracket.bracketInfo.closesColorized(t.openingBracket.bracketInfo);let u=0;if(c){let i=c.get(t.openingBracket.text);i===void 0&&(i=0),u=i,a&&(i++,c.set(t.openingBracket.text,i))}const d=t.childrenLength;for(let f=0;f<d;f++){const d=t.getChild(f);if(d){if(e=cA(i,d.length),fA(i,n)&&gA(e,s)){if(gA(e,n)&&d.kind!==1){t=d,a?(o++,h=u+1):h=u;continue t}if((a||d.kind!==1||!t.closingBracket)&&!eM(d,i,e,s,n,r,a?o+1:o,a?u+1:u,c,l,!t.closingBracket))return!1}i=e}}return c==null||c.set(t.openingBracket.text,u),!0}case 3:{const t=mA(i,e);return r(new XE(t,o-1,0,!0))}case 1:{const t=mA(i,e);return r(new XE(t,o-1,h-1,a))}case 0:return!0}}class sM{constructor(t,i,e){this.push=t,this.includeMinIndentation=i,this.textModel=e}}function nM(t,i,e,s,n,r,o,h){var c;if(o>200)return!0;let l=!0;if(t.kind===2){let a=0;if(h){let i=h.get(t.openingBracket.text);i===void 0&&(i=0),a=i,i++,h.set(t.openingBracket.text,i)}const u=cA(i,t.openingBracket.length);let d=-1;if(r.includeMinIndentation&&(d=t.computeMinIndentation(i,r.textModel)),l=r.push(new iA(mA(i,e),mA(i,u),t.closingBracket?mA(cA(u,((c=t.child)===null||c===void 0?void 0:c.length)||sA),e):void 0,o,a,t,d)),i=u,l&&t.child){const c=t.child;if(e=cA(i,c.length),fA(i,n)&&gA(e,s)&&(l=nM(c,i,e,s,n,r,o+1,h),!l))return!1}h==null||h.set(t.openingBracket.text,a)}else{let e=i;for(const i of t.children){const t=e;if(e=cA(e,i.length),fA(t,n)&&fA(s,e)&&(l=nM(i,t,e,s,n,r,o,h),!l))return!1}}return l}class rM extends Qi{get canBuildAST(){return this.textModel.getValueLength()<=5e6}constructor(t,i){super(),this.textModel=t,this.languageConfigurationService=i,this.bracketPairsTree=this._register(new Yi),this.onDidChangeEmitter=new le,this.onDidChange=this.onDidChangeEmitter.event,this.bracketsRequested=!1,this._register(this.languageConfigurationService.onDidChange((t=>{var i;t.languageId&&!(!((i=this.bracketPairsTree.value)===null||i===void 0)&&i.object.didLanguageChange(t.languageId))||(this.bracketPairsTree.clear(),this.updateBracketPairsTree())})))}handleDidChangeOptions(t){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeLanguage(t){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeContent(t){var i;(i=this.bracketPairsTree.value)===null||i===void 0||i.object.handleContentChanged(t)}handleDidChangeBackgroundTokenizationState(){var t;(t=this.bracketPairsTree.value)===null||t===void 0||t.object.handleDidChangeBackgroundTokenizationState()}handleDidChangeTokens(t){var i;(i=this.bracketPairsTree.value)===null||i===void 0||i.object.handleDidChangeTokens(t)}updateBracketPairsTree(){if(this.bracketsRequested&&this.canBuildAST){if(!this.bracketPairsTree.value){const e=new Ji;this.bracketPairsTree.value=(t=e.add(new XA(this.textModel,(t=>this.languageConfigurationService.getLanguageConfiguration(t)))),i=e,{object:t,dispose:()=>i==null?void 0:i.dispose()}),e.add(this.bracketPairsTree.value.object.onDidChange((t=>this.onDidChangeEmitter.fire(t)))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire());var t,i}getBracketPairsInRange(t){var i;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((i=this.bracketPairsTree.value)===null||i===void 0?void 0:i.object.getBracketPairsInRange(t,!1))||F.empty}getBracketPairsInRangeWithMinIndentation(t){var i;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((i=this.bracketPairsTree.value)===null||i===void 0?void 0:i.object.getBracketPairsInRange(t,!0))||F.empty}getBracketsInRange(t,i=!1){var e;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((e=this.bracketPairsTree.value)===null||e===void 0?void 0:e.object.getBracketsInRange(t,i))||F.empty}findMatchingBracketUp(t,i,e){const s=this.textModel.validatePosition(i),n=this.textModel.getLanguageIdAtPosition(s.lineNumber,s.column);if(this.canBuildAST){const e=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew.getClosingBracketInfo(t);if(!e)return null;const s=this.getBracketPairsInRange(Cs.fromPositions(i,i)).findLast((t=>e.closes(t.openingBracketInfo)));return s?s.openingBracketRange:null}{const i=t.toLowerCase(),r=this.languageConfigurationService.getLanguageConfiguration(n).brackets;if(!r)return null;const o=r.textIsBracket[i];return o?cM(this._findMatchingBracketUp(o,s,oM(e))):null}}matchBracket(t,i){if(this.canBuildAST){const i=this.getBracketPairsInRange(Cs.fromPositions(t,t)).filter((i=>i.closingBracketRange!==void 0&&(i.openingBracketRange.containsPosition(t)||i.closingBracketRange.containsPosition(t)))).findLastMaxBy(D((i=>i.openingBracketRange.containsPosition(t)?i.openingBracketRange:i.closingBracketRange),Cs.compareRangesUsingStarts));return i?[i.openingBracketRange,i.closingBracketRange]:null}{const e=oM(i);return this._matchBracket(this.textModel.validatePosition(t),e)}}_establishBracketSearchOffsets(t,i,e,s){const n=i.getCount(),r=i.getLanguageId(s);let o=Math.max(0,t.column-1-e.maxBracketLength);for(let t=s-1;t>=0;t--){const e=i.getEndOffset(t);if(e<=o)break;if(Qu(i.getStandardTokenType(t))||i.getLanguageId(t)!==r){o=e;break}}let h=Math.min(i.getLineContent().length,t.column-1+e.maxBracketLength);for(let t=s+1;t<n;t++){const e=i.getStartOffset(t);if(e>=h)break;if(Qu(i.getStandardTokenType(t))||i.getLanguageId(t)!==r){h=e;break}}return{searchStartOffset:o,searchEndOffset:h}}_matchBracket(t,i){const e=t.lineNumber,s=this.textModel.tokenization.getLineTokens(e),n=this.textModel.getLineContent(e),r=s.findTokenIndexAtOffset(t.column-1);if(r<0)return null;const o=this.languageConfigurationService.getLanguageConfiguration(s.getLanguageId(r)).brackets;if(o&&!Qu(s.getStandardTokenType(r))){let{searchStartOffset:h,searchEndOffset:c}=this._establishBracketSearchOffsets(t,s,o,r),l=null;for(;;){const s=Sd.findNextBracketInRange(o.forwardRegex,e,n,h,c);if(!s)break;if(s.startColumn<=t.column&&t.column<=s.endColumn){const t=n.substring(s.startColumn-1,s.endColumn-1).toLowerCase(),e=this._matchFoundBracket(s,o.textIsBracket[t],o.textIsOpenBracket[t],i);if(e){if(e instanceof hM)return null;l=e}}h=s.endColumn-1}if(l)return l}if(r>0&&s.getStartOffset(r)===t.column-1){const o=r-1,h=this.languageConfigurationService.getLanguageConfiguration(s.getLanguageId(o)).brackets;if(h&&!Qu(s.getStandardTokenType(o))){const{searchStartOffset:r,searchEndOffset:c}=this._establishBracketSearchOffsets(t,s,h,o),l=Sd.findPrevBracketInRange(h.reversedRegex,e,n,r,c);if(l&&l.startColumn<=t.column&&t.column<=l.endColumn){const t=n.substring(l.startColumn-1,l.endColumn-1).toLowerCase(),e=this._matchFoundBracket(l,h.textIsBracket[t],h.textIsOpenBracket[t],i);if(e)return e instanceof hM?null:e}}}return null}_matchFoundBracket(t,i,e,s){if(!i)return null;const n=e?this._findMatchingBracketDown(i,t.getEndPosition(),s):this._findMatchingBracketUp(i,t.getStartPosition(),s);return n?n instanceof hM?n:[t,n]:null}_findMatchingBracketUp(t,i,e){const s=t.languageId,n=t.reversedRegex;let r=-1,o=0;const h=(i,s,h,c)=>{for(;;){if(e&&++o%100==0&&!e())return hM.INSTANCE;const l=Sd.findPrevBracketInRange(n,i,s,h,c);if(!l)break;const a=s.substring(l.startColumn-1,l.endColumn-1).toLowerCase();if(t.isOpen(a)?r++:t.isClose(a)&&r--,r===0)return l;c=l.startColumn-1}return null};for(let t=i.lineNumber;t>=1;t--){const e=this.textModel.tokenization.getLineTokens(t),n=e.getCount(),r=this.textModel.getLineContent(t);let o=n-1,c=r.length,l=r.length;t===i.lineNumber&&(o=e.findTokenIndexAtOffset(i.column-1),c=i.column-1,l=i.column-1);let a=!0;for(;o>=0;o--){const i=e.getLanguageId(o)===s&&!Qu(e.getStandardTokenType(o));if(i)a?c=e.getStartOffset(o):(c=e.getStartOffset(o),l=e.getEndOffset(o));else if(a&&c!==l){const i=h(t,r,c,l);if(i)return i}a=i}if(a&&c!==l){const i=h(t,r,c,l);if(i)return i}}return null}_findMatchingBracketDown(t,i,e){const s=t.languageId,n=t.forwardRegex;let r=1,o=0;const h=(i,s,h,c)=>{for(;;){if(e&&++o%100==0&&!e())return hM.INSTANCE;const l=Sd.findNextBracketInRange(n,i,s,h,c);if(!l)break;const a=s.substring(l.startColumn-1,l.endColumn-1).toLowerCase();if(t.isOpen(a)?r++:t.isClose(a)&&r--,r===0)return l;h=l.endColumn-1}return null},c=this.textModel.getLineCount();for(let t=i.lineNumber;t<=c;t++){const e=this.textModel.tokenization.getLineTokens(t),n=e.getCount(),r=this.textModel.getLineContent(t);let o=0,c=0,l=0;t===i.lineNumber&&(o=e.findTokenIndexAtOffset(i.column-1),c=i.column-1,l=i.column-1);let a=!0;for(;o<n;o++){const i=e.getLanguageId(o)===s&&!Qu(e.getStandardTokenType(o));if(i)a||(c=e.getStartOffset(o)),l=e.getEndOffset(o);else if(a&&c!==l){const i=h(t,r,c,l);if(i)return i}a=i}if(a&&c!==l){const i=h(t,r,c,l);if(i)return i}}return null}findPrevBracket(t){var i;const e=this.textModel.validatePosition(t);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),((i=this.bracketPairsTree.value)===null||i===void 0?void 0:i.object.getFirstBracketBefore(e))||null;let s=null,n=null,r=null;for(let t=e.lineNumber;t>=1;t--){const i=this.textModel.tokenization.getLineTokens(t),o=i.getCount(),h=this.textModel.getLineContent(t);let c=o-1,l=h.length,a=h.length;if(t===e.lineNumber){c=i.findTokenIndexAtOffset(e.column-1),l=e.column-1,a=e.column-1;const t=i.getLanguageId(c);s!==t&&(s=t,n=this.languageConfigurationService.getLanguageConfiguration(s).brackets,r=this.languageConfigurationService.getLanguageConfiguration(s).bracketsNew)}let u=!0;for(;c>=0;c--){const e=i.getLanguageId(c);if(s!==e){if(n&&r&&u&&l!==a){const i=Sd.findPrevBracketInRange(n.reversedRegex,t,h,l,a);if(i)return this._toFoundBracket(r,i);u=!1}s=e,n=this.languageConfigurationService.getLanguageConfiguration(s).brackets,r=this.languageConfigurationService.getLanguageConfiguration(s).bracketsNew}const o=!!n&&!Qu(i.getStandardTokenType(c));if(o)u?l=i.getStartOffset(c):(l=i.getStartOffset(c),a=i.getEndOffset(c));else if(r&&n&&u&&l!==a){const i=Sd.findPrevBracketInRange(n.reversedRegex,t,h,l,a);if(i)return this._toFoundBracket(r,i)}u=o}if(r&&n&&u&&l!==a){const i=Sd.findPrevBracketInRange(n.reversedRegex,t,h,l,a);if(i)return this._toFoundBracket(r,i)}}return null}findNextBracket(t){var i;const e=this.textModel.validatePosition(t);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),((i=this.bracketPairsTree.value)===null||i===void 0?void 0:i.object.getFirstBracketAfter(e))||null;const s=this.textModel.getLineCount();let n=null,r=null,o=null;for(let t=e.lineNumber;t<=s;t++){const i=this.textModel.tokenization.getLineTokens(t),s=i.getCount(),h=this.textModel.getLineContent(t);let c=0,l=0,a=0;if(t===e.lineNumber){c=i.findTokenIndexAtOffset(e.column-1),l=e.column-1,a=e.column-1;const t=i.getLanguageId(c);n!==t&&(n=t,r=this.languageConfigurationService.getLanguageConfiguration(n).brackets,o=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew)}let u=!0;for(;c<s;c++){const e=i.getLanguageId(c);if(n!==e){if(o&&r&&u&&l!==a){const i=Sd.findNextBracketInRange(r.forwardRegex,t,h,l,a);if(i)return this._toFoundBracket(o,i);u=!1}n=e,r=this.languageConfigurationService.getLanguageConfiguration(n).brackets,o=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew}const s=!!r&&!Qu(i.getStandardTokenType(c));if(s)u||(l=i.getStartOffset(c)),a=i.getEndOffset(c);else if(o&&r&&u&&l!==a){const i=Sd.findNextBracketInRange(r.forwardRegex,t,h,l,a);if(i)return this._toFoundBracket(o,i)}u=s}if(o&&r&&u&&l!==a){const i=Sd.findNextBracketInRange(r.forwardRegex,t,h,l,a);if(i)return this._toFoundBracket(o,i)}}return null}findEnclosingBrackets(t,i){const e=this.textModel.validatePosition(t);if(this.canBuildAST){const t=Cs.fromPositions(e),i=this.getBracketPairsInRange(Cs.fromPositions(e,e)).findLast((i=>i.closingBracketRange!==void 0&&i.range.strictContainsRange(t)));return i?[i.openingBracketRange,i.closingBracketRange]:null}const s=oM(i),n=this.textModel.getLineCount(),r=new Map;let o=[];const h=(t,i)=>{if(!r.has(t)){const e=[];for(let t=0,s=i?i.brackets.length:0;t<s;t++)e[t]=0;r.set(t,e)}o=r.get(t)};let c=0;const l=(t,i,e,n,r)=>{for(;;){if(s&&++c%100==0&&!s())return hM.INSTANCE;const h=Sd.findNextBracketInRange(t.forwardRegex,i,e,n,r);if(!h)break;const l=e.substring(h.startColumn-1,h.endColumn-1).toLowerCase(),a=t.textIsBracket[l];if(a&&(a.isOpen(l)?o[a.index]++:a.isClose(l)&&o[a.index]--,o[a.index]===-1))return this._matchFoundBracket(h,a,!1,s);n=h.endColumn-1}return null};let a=null,u=null;for(let t=e.lineNumber;t<=n;t++){const i=this.textModel.tokenization.getLineTokens(t),s=i.getCount(),n=this.textModel.getLineContent(t);let r=0,o=0,c=0;if(t===e.lineNumber){r=i.findTokenIndexAtOffset(e.column-1),o=e.column-1,c=e.column-1;const t=i.getLanguageId(r);a!==t&&(a=t,u=this.languageConfigurationService.getLanguageConfiguration(a).brackets,h(a,u))}let d=!0;for(;r<s;r++){const e=i.getLanguageId(r);if(a!==e){if(u&&d&&o!==c){const i=l(u,t,n,o,c);if(i)return cM(i);d=!1}a=e,u=this.languageConfigurationService.getLanguageConfiguration(a).brackets,h(a,u)}const s=!!u&&!Qu(i.getStandardTokenType(r));if(s)d||(o=i.getStartOffset(r)),c=i.getEndOffset(r);else if(u&&d&&o!==c){const i=l(u,t,n,o,c);if(i)return cM(i)}d=s}if(u&&d&&o!==c){const i=l(u,t,n,o,c);if(i)return cM(i)}}return null}_toFoundBracket(t,i){if(!i)return null;let e=this.textModel.getValueInRange(i);e=e.toLowerCase();const s=t.getBracketInfo(e);return s?{range:i,bracketInfo:s}:null}}function oM(t){if(t===void 0)return()=>!0;{const i=Date.now();return()=>Date.now()-i<=t}}class hM{constructor(){this._searchCanceledBrand=void 0}}function cM(t){return t instanceof hM?null:t}hM.INSTANCE=new hM;class lM extends Qi{constructor(t){super(),this.textModel=t,this.colorProvider=new aM,this.onDidChangeEmitter=new le,this.onDidChange=this.onDidChangeEmitter.event,this.colorizationOptions=t.getOptions().bracketPairColorizationOptions,this._register(t.bracketPairs.onDidChange((t=>{this.onDidChangeEmitter.fire()})))}handleDidChangeOptions(t){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(t,i,e,s){return s?[]:i===void 0?[]:this.colorizationOptions.enabled?this.textModel.bracketPairs.getBracketsInRange(t,!0).map((t=>({id:`bracket${t.range.toString()}-${t.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(t,this.colorizationOptions.independentColorPoolPerBracketType)},ownerId:0,range:t.range}))).toArray():[]}getAllDecorations(t,i){return t===void 0?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new Cs(1,1,this.textModel.getLineCount(),1),t,i):[]}}class aM{constructor(){this.unexpectedClosingBracketClassName="unexpected-closing-bracket"}getInlineClassName(t,i){return t.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(i?t.nestingLevelOfEqualBracketType:t.nestingLevel)}getInlineClassNameOfLevel(t){return"bracket-highlighting-"+t%30}}function uM(t){return t.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}RC(((t,i)=>{const e=[gS,pS,mS,wS,vS,bS],s=new aM;i.addRule(`.monaco-editor .${s.unexpectedClosingBracketClassName} { color: ${t.getColor(yS)}; }`);const n=e.map((i=>t.getColor(i))).filter((t=>!!t)).filter((t=>!t.isTransparent()));for(let t=0;t<30;t++){const e=n[t%n.length];i.addRule(`.monaco-editor .${s.getInlineClassNameOfLevel(t)} { color: ${e}; }`)}}));class dM{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(t,i,e,s){this.oldPosition=t,this.oldText=i,this.newPosition=e,this.newText=s}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${uM(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${uM(this.oldText)}")`:`(replace@${this.oldPosition} "${uM(this.oldText)}" with "${uM(this.newText)}")`}static _writeStringSize(t){return 4+2*t.length}static _writeString(t,i,e){const s=i.length;cd(t,s,e),e+=4;for(let n=0;n<s;n++)od(t,i.charCodeAt(n),e),e+=2;return e}static _readString(t,i){const e=hd(t,i);return fd(t,i+=4,e)}writeSize(){return 8+dM._writeStringSize(this.oldText)+dM._writeStringSize(this.newText)}write(t,i){return cd(t,this.oldPosition,i),i+=4,cd(t,this.newPosition,i),i+=4,i=dM._writeString(t,this.oldText,i),i=dM._writeString(t,this.newText,i)}static read(t,i,e){const s=hd(t,i),n=hd(t,i+=4);i+=4;const r=dM._readString(t,i);i+=dM._writeStringSize(r);const o=dM._readString(t,i);return i+=dM._writeStringSize(o),e.push(new dM(s,r,n,o)),i}}class fM{constructor(t,i){this._prevEdits=t,this._currEdits=i,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let t=0,i=0,e=this._getPrev(t),s=this._getCurr(i);for(;t<this._prevLen||i<this._currLen;){if(e===null){this._acceptCurr(s),s=this._getCurr(++i);continue}if(s===null){this._acceptPrev(e),e=this._getPrev(++t);continue}if(s.oldEnd<=e.newPosition){this._acceptCurr(s),s=this._getCurr(++i);continue}if(e.newEnd<=s.oldPosition){this._acceptPrev(e),e=this._getPrev(++t);continue}if(s.oldPosition<e.newPosition){const[t,i]=fM._splitCurr(s,e.newPosition-s.oldPosition);this._acceptCurr(t),s=i;continue}if(e.newPosition<s.oldPosition){const[t,i]=fM._splitPrev(e,s.oldPosition-e.newPosition);this._acceptPrev(t),e=i;continue}let n,r;if(s.oldEnd===e.newEnd)n=e,r=s,e=this._getPrev(++t),s=this._getCurr(++i);else if(s.oldEnd<e.newEnd){const[t,o]=fM._splitPrev(e,s.oldLength);n=t,r=s,e=o,s=this._getCurr(++i)}else{const[i,o]=fM._splitCurr(s,e.newLength);n=e,r=i,e=this._getPrev(++t),s=o}this._result[this._resultLen++]=new dM(n.oldPosition,n.oldText,r.newPosition,r.newText),this._prevDeltaOffset+=n.newLength-n.oldLength,this._currDeltaOffset+=r.newLength-r.oldLength}const n=fM._merge(this._result);return fM._removeNoOps(n)}_acceptCurr(t){this._result[this._resultLen++]=fM._rebaseCurr(this._prevDeltaOffset,t),this._currDeltaOffset+=t.newLength-t.oldLength}_getCurr(t){return t<this._currLen?this._currEdits[t]:null}_acceptPrev(t){this._result[this._resultLen++]=fM._rebasePrev(this._currDeltaOffset,t),this._prevDeltaOffset+=t.newLength-t.oldLength}_getPrev(t){return t<this._prevLen?this._prevEdits[t]:null}static _rebaseCurr(t,i){return new dM(i.oldPosition-t,i.oldText,i.newPosition,i.newText)}static _rebasePrev(t,i){return new dM(i.oldPosition,i.oldText,i.newPosition+t,i.newText)}static _splitPrev(t,i){const e=t.newText.substr(0,i),s=t.newText.substr(i);return[new dM(t.oldPosition,t.oldText,t.newPosition,e),new dM(t.oldEnd,"",t.newPosition+i,s)]}static _splitCurr(t,i){const e=t.oldText.substr(0,i),s=t.oldText.substr(i);return[new dM(t.oldPosition,e,t.newPosition,t.newText),new dM(t.oldPosition+i,s,t.newEnd,"")]}static _merge(t){if(t.length===0)return t;const i=[];let e=0,s=t[0];for(let n=1;n<t.length;n++){const r=t[n];s.oldEnd===r.oldPosition?s=new dM(s.oldPosition,s.oldText+r.oldText,s.newPosition,s.newText+r.newText):(i[e++]=s,s=r)}return i[e++]=s,i}static _removeNoOps(t){if(t.length===0)return t;const i=[];let e=0;for(let s=0;s<t.length;s++){const n=t[s];n.oldText!==n.newText&&(i[e++]=n)}return i}}function gM(t){return t===47||t===92}function pM(t){return t.replace(/[\\/]/g,Je.sep)}function mM(t,i=Je.sep){if(!t)return"";const e=t.length,s=t.charCodeAt(0);if(gM(s)){if(gM(t.charCodeAt(1))&&!gM(t.charCodeAt(2))){let s=3;const n=s;for(;s<e&&!gM(t.charCodeAt(s));s++);if(n!==s&&!gM(t.charCodeAt(s+1))){for(s+=1;s<e;s++)if(gM(t.charCodeAt(s)))return t.slice(0,s+1).replace(/[\\/]/g,i)}}return i}if(vM(s)&&t.charCodeAt(1)===58)return gM(t.charCodeAt(2))?t.slice(0,2)+i:t.slice(0,2);let n=t.indexOf("://");if(n!==-1){for(n+=3;n<e;n++)if(gM(t.charCodeAt(n)))return t.slice(0,n+1)}return""}function wM(t,i,e,s=ss){if(t===i)return!0;if(!t||!i||i.length>t.length)return!1;if(e){if(!ur(t,i))return!1;if(i.length===t.length)return!0;let e=i.length;return i.charAt(i.length-1)===s&&e--,t.charAt(e)===s}return i.charAt(i.length-1)!==s&&(i+=s),t.indexOf(i)===0}function vM(t){return t>=65&&t<=90||t>=97&&t<=122}function bM(t){return ms(t,!0)}const yM=new class{constructor(t){this._ignorePathCasing=t}compare(t,i,e=!1){return t===i?0:sr(this.getComparisonKey(t,e),this.getComparisonKey(i,e))}isEqual(t,i,e=!1){return t===i||!(!t||!i)&&this.getComparisonKey(t,e)===this.getComparisonKey(i,e)}getComparisonKey(t,i=!1){return t.with({path:this._ignorePathCasing(t)?t.path.toLowerCase():void 0,fragment:i?null:void 0}).toString()}isEqualOrParent(t,i,e=!1){if(t.scheme===i.scheme){if(t.scheme===Lh.file)return wM(bM(t),bM(i),this._ignorePathCasing(t))&&t.query===i.query&&(e||t.fragment===i.fragment);if(FM(t.authority,i.authority))return wM(t.path,i.path,this._ignorePathCasing(t),"/")&&t.query===i.query&&(e||t.fragment===i.fragment)}return!1}joinPath(t,...i){return as.joinPath(t,...i)}basenameOrAuthority(t){return SM(t)||t.authority}basename(t){return Je.basename(t.path)}extname(t){return Je.extname(t.path)}dirname(t){if(t.path.length===0)return t;let i;return t.scheme===Lh.file?i=as.file(ts(bM(t))).path:(i=Je.dirname(t.path),t.authority&&i.length&&i.charCodeAt(0)!==47&&(console.error(`dirname("${t.toString})) resulted in a relative path`),i="/")),t.with({path:i})}normalizePath(t){if(!t.path.length)return t;let i;return i=t.scheme===Lh.file?as.file(Qe(bM(t))).path:Je.normalize(t.path),t.with({path:i})}relativePath(t,i){if(t.scheme!==i.scheme||!FM(t.authority,i.authority))return;if(t.scheme===Lh.file){const e=Xe(bM(t),bM(i));return vt?pM(e):e}let e=t.path||"/";const s=i.path||"/";if(this._ignorePathCasing(t)){let t=0;for(const i=Math.min(e.length,s.length);t<i&&(e.charCodeAt(t)===s.charCodeAt(t)||e.charAt(t).toLowerCase()===s.charAt(t).toLowerCase());t++);e=s.substr(0,t)+e.substr(t)}return Je.relative(e,s)}resolvePath(t,i){if(t.scheme===Lh.file){const e=as.file(Ye(bM(t),i));return t.with({authority:e.authority,path:e.path})}var e;return(e=i).indexOf("/")===-1&&(e=pM(e)),/^[a-zA-Z]:(\/|$)/.test(e)&&(e="/"+e),i=e,t.with({path:Je.resolve(t.path,i)})}isAbsolutePath(t){return!!t.path&&t.path[0]==="/"}isEqualAuthority(t,i){return t===i||t!==void 0&&i!==void 0&&ar(t,i)}hasTrailingPathSeparator(t,i=ss){if(t.scheme===Lh.file){const e=bM(t);return e.length>mM(e).length&&e[e.length-1]===i}{const i=t.path;return i.length>1&&i.charCodeAt(i.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(t.fsPath)}}removeTrailingPathSeparator(t,i=ss){return TM(t,i)?t.with({path:t.path.substr(0,t.path.length-1)}):t}addTrailingPathSeparator(t,i=ss){let e=!1;if(t.scheme===Lh.file){const s=bM(t);e=s!==void 0&&s.length===mM(s).length&&s[s.length-1]===i}else{i="/";const s=t.path;e=s.length===1&&s.charCodeAt(s.length-1)===47}return e||TM(t,i)?t:t.with({path:t.path+"/"})}}((()=>!1)),kM=yM.isEqual.bind(yM);yM.isEqualOrParent.bind(yM),yM.getComparisonKey.bind(yM);const CM=yM.basenameOrAuthority.bind(yM),SM=yM.basename.bind(yM),xM=yM.extname.bind(yM),DM=yM.dirname.bind(yM),EM=yM.joinPath.bind(yM),AM=yM.normalizePath.bind(yM),MM=yM.relativePath.bind(yM),LM=yM.resolvePath.bind(yM);yM.isAbsolutePath.bind(yM);const FM=yM.isEqualAuthority.bind(yM),TM=yM.hasTrailingPathSeparator.bind(yM);var RM;function OM(t){return t.toString()}yM.removeTrailingPathSeparator.bind(yM),yM.addTrailingPathSeparator.bind(yM),function(t){t.META_DATA_LABEL="label",t.META_DATA_DESCRIPTION="description",t.META_DATA_SIZE="size",t.META_DATA_MIME="mime",t.parseMetaData=function(i){const e=new Map;i.path.substring(i.path.indexOf(";")+1,i.path.lastIndexOf(";")).split(";").forEach((t=>{const[i,s]=t.split(":");i&&s&&e.set(i,s)}));const s=i.path.substring(0,i.path.indexOf(";"));return s&&e.set(t.META_DATA_MIME,s),e}}(RM||(RM={}));class IM{static create(t,i){const e=t.getAlternativeVersionId(),s=NM(t);return new IM(e,e,s,s,i,i,[])}constructor(t,i,e,s,n,r,o){this.beforeVersionId=t,this.afterVersionId=i,this.beforeEOL=e,this.afterEOL=s,this.beforeCursorState=n,this.afterCursorState=r,this.changes=o}append(t,i,e,s,n){var r,o;i.length>0&&(this.changes=(r=this.changes,o=i,r===null||r.length===0?o:new fM(r,o).compress())),this.afterEOL=e,this.afterVersionId=s,this.afterCursorState=n}static _writeSelectionsSize(t){return 4+16*(t?t.length:0)}static _writeSelections(t,i,e){if(cd(t,i?i.length:0,e),e+=4,i)for(const s of i)cd(t,s.selectionStartLineNumber,e),e+=4,cd(t,s.selectionStartColumn,e),e+=4,cd(t,s.positionLineNumber,e),e+=4,cd(t,s.positionColumn,e),e+=4;return e}static _readSelections(t,i,e){const s=hd(t,i);i+=4;for(let n=0;n<s;n++){const s=hd(t,i),n=hd(t,i+=4),r=hd(t,i+=4),o=hd(t,i+=4);i+=4,e.push(new Ss(s,n,r,o))}return i}serialize(){let t=10+IM._writeSelectionsSize(this.beforeCursorState)+IM._writeSelectionsSize(this.afterCursorState)+4;for(const i of this.changes)t+=i.writeSize();const i=new Uint8Array(t);let e=0;cd(i,this.beforeVersionId,e),e+=4,cd(i,this.afterVersionId,e),e+=4,ad(i,this.beforeEOL,e),e+=1,ad(i,this.afterEOL,e),e+=1,e=IM._writeSelections(i,this.beforeCursorState,e),e=IM._writeSelections(i,this.afterCursorState,e),cd(i,this.changes.length,e),e+=4;for(const t of this.changes)e=t.write(i,e);return i.buffer}static deserialize(t){const i=new Uint8Array(t);let e=0;const s=hd(i,e);e+=4;const n=hd(i,e);e+=4;const r=ld(i,e);e+=1;const o=ld(i,e);e+=1;const h=[];e=IM._readSelections(i,e,h);const c=[];e=IM._readSelections(i,e,c);const l=hd(i,e);e+=4;const a=[];for(let t=0;t<l;t++)e=dM.read(i,e,a);return new IM(s,n,r,o,h,c,a)}}class _M{get type(){return 0}get resource(){return as.isUri(this.model)?this.model:this.model.uri}constructor(t,i,e,s){this.label=t,this.code=i,this.model=e,this._data=IM.create(e,s)}toString(){return(this._data instanceof IM?this._data:IM.deserialize(this._data)).changes.map((t=>t.toString())).join(", ")}matchesResource(t){return(as.isUri(this.model)?this.model:this.model.uri).toString()===t.toString()}setModel(t){this.model=t}canAppend(t){return this.model===t&&this._data instanceof IM}append(t,i,e,s,n){this._data instanceof IM&&this._data.append(t,i,e,s,n)}close(){this._data instanceof IM&&(this._data=this._data.serialize())}open(){this._data instanceof IM||(this._data=IM.deserialize(this._data))}undo(){if(as.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof IM&&(this._data=this._data.serialize());const t=IM.deserialize(this._data);this.model._applyUndo(t.changes,t.beforeEOL,t.beforeVersionId,t.beforeCursorState)}redo(){if(as.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof IM&&(this._data=this._data.serialize());const t=IM.deserialize(this._data);this.model._applyRedo(t.changes,t.afterEOL,t.afterVersionId,t.afterCursorState)}heapSize(){return this._data instanceof IM&&(this._data=this._data.serialize()),this._data.byteLength+168}}class PM{get resources(){return this._editStackElementsArr.map((t=>t.resource))}constructor(t,i,e){this.label=t,this.code=i,this.type=1,this._isOpen=!0,this._editStackElementsArr=e.slice(0),this._editStackElementsMap=new Map;for(const t of this._editStackElementsArr){const i=OM(t.resource);this._editStackElementsMap.set(i,t)}this._delegate=null}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}matchesResource(t){const i=OM(t);return this._editStackElementsMap.has(i)}setModel(t){const i=OM(as.isUri(t)?t:t.uri);this._editStackElementsMap.has(i)&&this._editStackElementsMap.get(i).setModel(t)}canAppend(t){if(!this._isOpen)return!1;const i=OM(t.uri);return this._editStackElementsMap.has(i)?this._editStackElementsMap.get(i).canAppend(t):!1}append(t,i,e,s,n){const r=OM(t.uri);this._editStackElementsMap.get(r).append(t,i,e,s,n)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(const t of this._editStackElementsArr)t.undo()}redo(){for(const t of this._editStackElementsArr)t.redo()}heapSize(t){const i=OM(t);return this._editStackElementsMap.has(i)?this._editStackElementsMap.get(i).heapSize():0}split(){return this._editStackElementsArr}toString(){const t=[];for(const i of this._editStackElementsArr)t.push(`${SM(i.resource)}: ${i}`);return`{${t.join(", ")}}`}}function NM(t){return t.getEOL()===`\n`?0:1}function BM(t){return!!t&&(t instanceof _M||t instanceof PM)}class $M{constructor(t,i){this._model=t,this._undoRedoService=i}pushStackElement(){const t=this._undoRedoService.getLastElement(this._model.uri);BM(t)&&t.close()}popStackElement(){const t=this._undoRedoService.getLastElement(this._model.uri);BM(t)&&t.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(t,i){const e=this._undoRedoService.getLastElement(this._model.uri);if(BM(e)&&e.canAppend(this._model))return e;const s=new _M(tt(0,"Typing"),"undoredo.textBufferEdit",this._model,t);return this._undoRedoService.pushElement(s,i),s}pushEOL(t){const i=this._getOrCreateEditStackElement(null,void 0);this._model.setEOL(t),i.append(this._model,[],NM(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(t,i,e,s){const n=this._getOrCreateEditStackElement(t,s),r=this._model.applyEdits(i,!0),o=$M._computeCursorState(e,r),h=r.map(((t,i)=>({index:i,textChange:t.textChange})));return h.sort(((t,i)=>t.textChange.oldPosition===i.textChange.oldPosition?t.index-i.index:t.textChange.oldPosition-i.textChange.oldPosition)),n.append(this._model,h.map((t=>t.textChange)),NM(this._model),this._model.getAlternativeVersionId(),o),o}static _computeCursorState(t,i){try{return t?t(i):null}catch(t){return Ii(t),null}}}class WM{constructor(){this.spacesDiff=0,this.looksLikeAlignment=!1}}function jM(t,i,e,s,n){let r;for(n.spacesDiff=0,n.looksLikeAlignment=!1,r=0;r<i&&r<s&&t.charCodeAt(r)===e.charCodeAt(r);r++);let o=0,h=0;for(let e=r;e<i;e++)t.charCodeAt(e)===32?o++:h++;let c=0,l=0;for(let t=r;t<s;t++)e.charCodeAt(t)===32?c++:l++;if(o>0&&h>0||c>0&&l>0)return;const a=Math.abs(h-l),u=Math.abs(o-c);if(a===0)return n.spacesDiff=u,void(u>0&&0<=c-1&&c-1<t.length&&c<e.length&&e.charCodeAt(c)!==32&&t.charCodeAt(c-1)===32&&t.charCodeAt(t.length-1)===44&&(n.looksLikeAlignment=!0));u%a!=0||(n.spacesDiff=u/a)}function HM(t,i,e){const s=Math.min(t.getLineCount(),1e4);let n=0,r=0,o="",h=0;const c=[2,4,6,8,3,5,7],l=[0,0,0,0,0,0,0,0,0],a=new WM;for(let c=1;c<=s;c++){const s=t.getLineLength(c),u=t.getLineContent(c),d=s<=65536;let f=!1,g=0,p=0,m=0;for(let i=0,e=s;i<e;i++){const e=d?u.charCodeAt(i):t.getLineCharCode(c,i);if(e===9)m++;else{if(e!==32){f=!0,g=i;break}p++}}if(!f||(m>0?n++:p>1&&r++,jM(o,h,u,g,a),a.looksLikeAlignment&&(!e||i!==a.spacesDiff)))continue;const w=a.spacesDiff;w<=8&&l[w]++,o=u,h=g}let u=e;n!==r&&(u=n<r);let d=i;if(u){let t=u?0:.1*s;c.forEach((i=>{const e=l[i];e>t&&(t=e,d=i)})),d===4&&l[4]>0&&l[2]>0&&l[2]>=l[4]/2&&(d=2)}return{insertSpaces:u,tabSize:d}}function VM(t){return(1&t.metadata)>>>0}function zM(t,i){t.metadata=254&t.metadata|i}function UM(t){return(2&t.metadata)>>>1==1}function KM(t,i){t.metadata=253&t.metadata|(i?1:0)<<1}function qM(t){return(4&t.metadata)>>>2==1}function GM(t,i){t.metadata=251&t.metadata|(i?1:0)<<2}function ZM(t){return(64&t.metadata)>>>6==1}function JM(t,i){t.metadata=191&t.metadata|(i?1:0)<<6}function QM(t,i){t.metadata=231&t.metadata|i<<3}function YM(t,i){t.metadata=223&t.metadata|(i?1:0)<<5}class XM{constructor(t,i,e){this.metadata=0,this.parent=this,this.left=this,this.right=this,zM(this,1),this.start=i,this.end=e,this.delta=0,this.maxEnd=e,this.id=t,this.ownerId=0,this.options=null,GM(this,!1),JM(this,!1),QM(this,1),YM(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=i,this.cachedAbsoluteEnd=e,this.range=null,KM(this,!1)}reset(t,i,e,s){this.start=i,this.end=e,this.maxEnd=e,this.cachedVersionId=t,this.cachedAbsoluteStart=i,this.cachedAbsoluteEnd=e,this.range=s}setOptions(t){this.options=t;const i=this.options.className;GM(this,i==="squiggly-error"||i==="squiggly-warning"||i==="squiggly-info"),JM(this,this.options.glyphMarginClassName!==null),QM(this,this.options.stickiness),YM(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(t,i,e){this.cachedVersionId!==e&&(this.range=null),this.cachedVersionId=e,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i}detach(){this.parent=null,this.left=null,this.right=null}}const tL=new XM(null,0,0);tL.parent=tL,tL.left=tL,tL.right=tL,zM(tL,0);class iL{constructor(){this.root=tL,this.requestNormalizeDelta=!1}intervalSearch(t,i,e,s,n,r){return this.root===tL?[]:function(t,i,e,s,n,r,o){let h=t.root,c=0,l=0,a=0,u=0;const d=[];let f=0;for(;h!==tL;)if(UM(h))KM(h.left,!1),KM(h.right,!1),h===h.parent.right&&(c-=h.parent.delta),h=h.parent;else{if(!UM(h.left)){if(l=c+h.maxEnd,l<i){KM(h,!0);continue}if(h.left!==tL){h=h.left;continue}}if(a=c+h.start,a>e)KM(h,!0);else{if(u=c+h.end,u>=i){h.setCachedOffsets(a,u,r);let t=!0;s&&h.ownerId&&h.ownerId!==s&&(t=!1),n&&qM(h)&&(t=!1),o&&!ZM(h)&&(t=!1),t&&(d[f++]=h)}KM(h,!0),h.right===tL||UM(h.right)||(c+=h.delta,h=h.right)}}return KM(t.root,!1),d}(this,t,i,e,s,n,r)}search(t,i,e,s){return this.root===tL?[]:function(t,i,e,s,n){let r=t.root,o=0,h=0,c=0;const l=[];let a=0;for(;r!==tL;){if(UM(r)){KM(r.left,!1),KM(r.right,!1),r===r.parent.right&&(o-=r.parent.delta),r=r.parent;continue}if(r.left!==tL&&!UM(r.left)){r=r.left;continue}h=o+r.start,c=o+r.end,r.setCachedOffsets(h,c,s);let t=!0;i&&r.ownerId&&r.ownerId!==i&&(t=!1),e&&qM(r)&&(t=!1),n&&!ZM(r)&&(t=!1),t&&(l[a++]=r),KM(r,!0),r.right===tL||UM(r.right)||(o+=r.delta,r=r.right)}return KM(t.root,!1),l}(this,t,i,e,s)}collectNodesFromOwner(t){return function(t,i){let e=t.root;const s=[];let n=0;for(;e!==tL;)UM(e)?(KM(e.left,!1),KM(e.right,!1),e=e.parent):e.left===tL||UM(e.left)?(e.ownerId===i&&(s[n++]=e),KM(e,!0),e.right===tL||UM(e.right)||(e=e.right)):e=e.left;return KM(t.root,!1),s}(this,t)}collectNodesPostOrder(){return function(t){let i=t.root;const e=[];let s=0;for(;i!==tL;)UM(i)?(KM(i.left,!1),KM(i.right,!1),i=i.parent):i.left===tL||UM(i.left)?i.right===tL||UM(i.right)?(e[s++]=i,KM(i,!0)):i=i.right:i=i.left;return KM(t.root,!1),e}(this)}insert(t){nL(this,t),this._normalizeDeltaIfNecessary()}delete(t){rL(this,t),this._normalizeDeltaIfNecessary()}resolveNode(t,i){const e=t;let s=0;for(;t!==this.root;)t===t.parent.right&&(s+=t.parent.delta),t=t.parent;const n=e.start+s,r=e.end+s;e.setCachedOffsets(n,r,i)}acceptReplace(t,i,e,s){const n=function(t,i,e){let s=t.root,n=0,r=0,o=0,h=0;const c=[];let l=0;for(;s!==tL;)if(UM(s))KM(s.left,!1),KM(s.right,!1),s===s.parent.right&&(n-=s.parent.delta),s=s.parent;else{if(!UM(s.left)){if(r=n+s.maxEnd,r<i){KM(s,!0);continue}if(s.left!==tL){s=s.left;continue}}o=n+s.start,o>e?KM(s,!0):(h=n+s.end,h>=i&&(s.setCachedOffsets(o,h,0),c[l++]=s),KM(s,!0),s.right===tL||UM(s.right)||(n+=s.delta,s=s.right))}return KM(t.root,!1),c}(this,t,t+i);for(let t=0,i=n.length;t<i;t++)rL(this,n[t]);this._normalizeDeltaIfNecessary(),function(t,i,e,s){let n=t.root,r=0,o=0,h=0;const c=s-(e-i);for(;n!==tL;)if(UM(n))KM(n.left,!1),KM(n.right,!1),n===n.parent.right&&(r-=n.parent.delta),aL(n),n=n.parent;else{if(!UM(n.left)){if(o=r+n.maxEnd,o<i){KM(n,!0);continue}if(n.left!==tL){n=n.left;continue}}h=r+n.start,h>e?(n.start+=c,n.end+=c,n.delta+=c,(n.delta<-1073741824||n.delta>1073741824)&&(t.requestNormalizeDelta=!0),KM(n,!0)):(KM(n,!0),n.right===tL||UM(n.right)||(r+=n.delta,n=n.right))}KM(t.root,!1)}(this,t,t+i,e),this._normalizeDeltaIfNecessary();for(let r=0,o=n.length;r<o;r++){const o=n[r];o.start=o.cachedAbsoluteStart,o.end=o.cachedAbsoluteEnd,sL(o,t,t+i,e,s),o.maxEnd=o.end,nL(this,o)}this._normalizeDeltaIfNecessary()}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,function(t){let i=t.root,e=0;for(;i!==tL;)i.left===tL||UM(i.left)?i.right===tL||UM(i.right)?(i.start=e+i.start,i.end=e+i.end,i.delta=0,aL(i),KM(i,!0),KM(i.left,!1),KM(i.right,!1),i===i.parent.right&&(e-=i.parent.delta),i=i.parent):(e+=i.delta,i=i.right):i=i.left;KM(t.root,!1)}(this))}}function eL(t,i,e,s){return t<e||!(t>e)&&s!==1&&(s===2||i)}function sL(t,i,e,s,n){const r=function(t){return(24&t.metadata)>>>3}(t),o=r===0||r===2,h=r===1||r===2,c=e-i,l=s,a=Math.min(c,l),u=t.start;let d=!1;const f=t.end;let g=!1;i<=u&&f<=e&&function(t){return(32&t.metadata)>>>5==1}(t)&&(t.start=i,d=!0,t.end=i,g=!0);{const t=n?1:c>0?2:0;!d&&eL(u,o,i,t)&&(d=!0),!g&&eL(f,h,i,t)&&(g=!0)}if(a>0&&!n){const t=c>l?2:0;!d&&eL(u,o,i+a,t)&&(d=!0),!g&&eL(f,h,i+a,t)&&(g=!0)}{const s=n?1:0;!d&&eL(u,o,e,s)&&(t.start=i+l,d=!0),!g&&eL(f,h,e,s)&&(t.end=i+l,g=!0)}const p=l-c;d||(t.start=Math.max(0,u+p)),g||(t.end=Math.max(0,f+p)),t.start>t.end&&(t.end=t.start)}function nL(t,i){if(t.root===tL)return i.parent=tL,i.left=tL,i.right=tL,zM(i,0),t.root=i,t.root;(function(t,i){let e=0,s=t.root;const n=i.start,r=i.end;for(;;)if(dL(n,r,s.start+e,s.end+e)<0){if(s.left===tL){i.start-=e,i.end-=e,i.maxEnd-=e,s.left=i;break}s=s.left}else{if(s.right===tL){i.start-=e+s.delta,i.end-=e+s.delta,i.maxEnd-=e+s.delta,s.right=i;break}e+=s.delta,s=s.right}i.parent=s,i.left=tL,i.right=tL,zM(i,1)})(t,i),uL(i.parent);let e=i;for(;e!==t.root&&VM(e.parent)===1;)if(e.parent===e.parent.parent.left){const i=e.parent.parent.right;VM(i)===1?(zM(e.parent,0),zM(i,0),zM(e.parent.parent,1),e=e.parent.parent):(e===e.parent.right&&(e=e.parent,hL(t,e)),zM(e.parent,0),zM(e.parent.parent,1),cL(t,e.parent.parent))}else{const i=e.parent.parent.left;VM(i)===1?(zM(e.parent,0),zM(i,0),zM(e.parent.parent,1),e=e.parent.parent):(e===e.parent.left&&(e=e.parent,cL(t,e)),zM(e.parent,0),zM(e.parent.parent,1),hL(t,e.parent.parent))}return zM(t.root,0),i}function rL(t,i){let e,s;if(i.left===tL?(e=i.right,s=i,e.delta+=i.delta,(e.delta<-1073741824||e.delta>1073741824)&&(t.requestNormalizeDelta=!0),e.start+=i.delta,e.end+=i.delta):i.right===tL?(e=i.left,s=i):(s=function(t){for(;t.left!==tL;)t=t.left;return t}(i.right),e=s.right,e.start+=s.delta,e.end+=s.delta,e.delta+=s.delta,(e.delta<-1073741824||e.delta>1073741824)&&(t.requestNormalizeDelta=!0),s.start+=i.delta,s.end+=i.delta,s.delta=i.delta,(s.delta<-1073741824||s.delta>1073741824)&&(t.requestNormalizeDelta=!0)),s===t.root)return t.root=e,zM(e,0),i.detach(),oL(),aL(e),void(t.root.parent=tL);const n=VM(s)===1;if(s===s.parent.left?s.parent.left=e:s.parent.right=e,s===i?e.parent=s.parent:(s.parent===i?e.parent=s:e.parent=s.parent,s.left=i.left,s.right=i.right,s.parent=i.parent,zM(s,VM(i)),i===t.root?t.root=s:i===i.parent.left?i.parent.left=s:i.parent.right=s,s.left!==tL&&(s.left.parent=s),s.right!==tL&&(s.right.parent=s)),i.detach(),n)return uL(e.parent),s!==i&&(uL(s),uL(s.parent)),void oL();let r;for(uL(e),uL(e.parent),s!==i&&(uL(s),uL(s.parent));e!==t.root&&VM(e)===0;)e===e.parent.left?(r=e.parent.right,VM(r)===1&&(zM(r,0),zM(e.parent,1),hL(t,e.parent),r=e.parent.right),VM(r.left)===0&&VM(r.right)===0?(zM(r,1),e=e.parent):(VM(r.right)===0&&(zM(r.left,0),zM(r,1),cL(t,r),r=e.parent.right),zM(r,VM(e.parent)),zM(e.parent,0),zM(r.right,0),hL(t,e.parent),e=t.root)):(r=e.parent.left,VM(r)===1&&(zM(r,0),zM(e.parent,1),cL(t,e.parent),r=e.parent.left),VM(r.left)===0&&VM(r.right)===0?(zM(r,1),e=e.parent):(VM(r.left)===0&&(zM(r.right,0),zM(r,1),hL(t,r),r=e.parent.left),zM(r,VM(e.parent)),zM(e.parent,0),zM(r.left,0),cL(t,e.parent),e=t.root));zM(e,0),oL()}function oL(){tL.parent=tL,tL.delta=0,tL.start=0,tL.end=0}function hL(t,i){const e=i.right;e.delta+=i.delta,(e.delta<-1073741824||e.delta>1073741824)&&(t.requestNormalizeDelta=!0),e.start+=i.delta,e.end+=i.delta,i.right=e.left,e.left!==tL&&(e.left.parent=i),e.parent=i.parent,i.parent===tL?t.root=e:i===i.parent.left?i.parent.left=e:i.parent.right=e,e.left=i,i.parent=e,aL(i),aL(e)}function cL(t,i){const e=i.left;i.delta-=e.delta,(i.delta<-1073741824||i.delta>1073741824)&&(t.requestNormalizeDelta=!0),i.start-=e.delta,i.end-=e.delta,i.left=e.right,e.right!==tL&&(e.right.parent=i),e.parent=i.parent,i.parent===tL?t.root=e:i===i.parent.right?i.parent.right=e:i.parent.left=e,e.right=i,i.parent=e,aL(i),aL(e)}function lL(t){let i=t.end;if(t.left!==tL){const e=t.left.maxEnd;e>i&&(i=e)}if(t.right!==tL){const e=t.right.maxEnd+t.delta;e>i&&(i=e)}return i}function aL(t){t.maxEnd=lL(t)}function uL(t){for(;t!==tL;){const i=lL(t);if(t.maxEnd===i)return;t.maxEnd=i,t=t.parent}}function dL(t,i,e,s){return t===e?i-s:t-e}class fL{constructor(t,i){this.piece=t,this.color=i,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==gL)return pL(this.right);let t=this;for(;t.parent!==gL&&t.parent.left!==t;)t=t.parent;return t.parent===gL?gL:t.parent}prev(){if(this.left!==gL)return mL(this.left);let t=this;for(;t.parent!==gL&&t.parent.right!==t;)t=t.parent;return t.parent===gL?gL:t.parent}detach(){this.parent=null,this.left=null,this.right=null}}const gL=new fL(null,0);function pL(t){for(;t.left!==gL;)t=t.left;return t}function mL(t){for(;t.right!==gL;)t=t.right;return t}function wL(t){return t===gL?0:t.size_left+t.piece.length+wL(t.right)}function vL(t){return t===gL?0:t.lf_left+t.piece.lineFeedCnt+vL(t.right)}function bL(){gL.parent=gL}function yL(t,i){const e=i.right;e.size_left+=i.size_left+(i.piece?i.piece.length:0),e.lf_left+=i.lf_left+(i.piece?i.piece.lineFeedCnt:0),i.right=e.left,e.left!==gL&&(e.left.parent=i),e.parent=i.parent,i.parent===gL?t.root=e:i.parent.left===i?i.parent.left=e:i.parent.right=e,e.left=i,i.parent=e}function kL(t,i){const e=i.left;i.left=e.right,e.right!==gL&&(e.right.parent=i),e.parent=i.parent,i.size_left-=e.size_left+(e.piece?e.piece.length:0),i.lf_left-=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),i.parent===gL?t.root=e:i===i.parent.right?i.parent.right=e:i.parent.left=e,e.right=i,i.parent=e}function CL(t,i){let e,s;if(i.left===gL?(s=i,e=s.right):i.right===gL?(s=i,e=s.left):(s=pL(i.right),e=s.right),s===t.root)return t.root=e,e.color=0,i.detach(),bL(),void(t.root.parent=gL);const n=s.color===1;if(s===s.parent.left?s.parent.left=e:s.parent.right=e,s===i?(e.parent=s.parent,DL(t,e)):(s.parent===i?e.parent=s:e.parent=s.parent,DL(t,e),s.left=i.left,s.right=i.right,s.parent=i.parent,s.color=i.color,i===t.root?t.root=s:i===i.parent.left?i.parent.left=s:i.parent.right=s,s.left!==gL&&(s.left.parent=s),s.right!==gL&&(s.right.parent=s),s.size_left=i.size_left,s.lf_left=i.lf_left,DL(t,s)),i.detach(),e.parent.left===e){const i=wL(e),s=vL(e);if(i!==e.parent.size_left||s!==e.parent.lf_left){const n=i-e.parent.size_left,r=s-e.parent.lf_left;e.parent.size_left=i,e.parent.lf_left=s,xL(t,e.parent,n,r)}}if(DL(t,e.parent),n)return void bL();let r;for(;e!==t.root&&e.color===0;)e===e.parent.left?(r=e.parent.right,r.color===1&&(r.color=0,e.parent.color=1,yL(t,e.parent),r=e.parent.right),r.left.color===0&&r.right.color===0?(r.color=1,e=e.parent):(r.right.color===0&&(r.left.color=0,r.color=1,kL(t,r),r=e.parent.right),r.color=e.parent.color,e.parent.color=0,r.right.color=0,yL(t,e.parent),e=t.root)):(r=e.parent.left,r.color===1&&(r.color=0,e.parent.color=1,kL(t,e.parent),r=e.parent.left),r.left.color===0&&r.right.color===0?(r.color=1,e=e.parent):(r.left.color===0&&(r.right.color=0,r.color=1,yL(t,r),r=e.parent.left),r.color=e.parent.color,e.parent.color=0,r.left.color=0,kL(t,e.parent),e=t.root));e.color=0,bL()}function SL(t,i){for(DL(t,i);i!==t.root&&i.parent.color===1;)if(i.parent===i.parent.parent.left){const e=i.parent.parent.right;e.color===1?(i.parent.color=0,e.color=0,i.parent.parent.color=1,i=i.parent.parent):(i===i.parent.right&&yL(t,i=i.parent),i.parent.color=0,i.parent.parent.color=1,kL(t,i.parent.parent))}else{const e=i.parent.parent.left;e.color===1?(i.parent.color=0,e.color=0,i.parent.parent.color=1,i=i.parent.parent):(i===i.parent.left&&kL(t,i=i.parent),i.parent.color=0,i.parent.parent.color=1,yL(t,i.parent.parent))}t.root.color=0}function xL(t,i,e,s){for(;i!==t.root&&i!==gL;)i.parent.left===i&&(i.parent.size_left+=e,i.parent.lf_left+=s),i=i.parent}function DL(t,i){let e=0,s=0;if(i!==t.root){for(;i!==t.root&&i===i.parent.right;)i=i.parent;if(i!==t.root)for(e=wL((i=i.parent).left)-i.size_left,s=vL(i.left)-i.lf_left,i.size_left+=e,i.lf_left+=s;i!==t.root&&(e!==0||s!==0);)i.parent.left===i&&(i.parent.size_left+=e,i.parent.lf_left+=s),i=i.parent}}gL.parent=gL,gL.left=gL,gL.right=gL,gL.color=0;const EL=65535;function AL(t){let i;return i=t[t.length-1]<65536?new Uint16Array(t.length):new Uint32Array(t.length),i.set(t,0),i}class ML{constructor(t,i,e,s,n){this.lineStarts=t,this.cr=i,this.lf=e,this.crlf=s,this.isBasicASCII=n}}function LL(t,i=!0){const e=[0];let s=1;for(let i=0,n=t.length;i<n;i++){const r=t.charCodeAt(i);r===13?i+1<n&&t.charCodeAt(i+1)===10?(e[s++]=i+2,i++):e[s++]=i+1:r===10&&(e[s++]=i+1)}return i?AL(e):e}class FL{constructor(t,i,e,s,n){this.bufferIndex=t,this.start=i,this.end=e,this.lineFeedCnt=s,this.length=n}}class TL{constructor(t,i){this.buffer=t,this.lineStarts=i}}class RL{constructor(t,i){this._pieces=[],this._tree=t,this._BOM=i,this._index=0,t.root!==gL&&t.iterate(t.root,(t=>(t!==gL&&this._pieces.push(t.piece),!0)))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class OL{constructor(t){this._limit=t,this._cache=[]}get(t){for(let i=this._cache.length-1;i>=0;i--){const e=this._cache[i];if(e.nodeStartOffset<=t&&e.nodeStartOffset+e.node.piece.length>=t)return e}return null}get2(t){for(let i=this._cache.length-1;i>=0;i--){const e=this._cache[i];if(e.nodeStartLineNumber&&e.nodeStartLineNumber<t&&e.nodeStartLineNumber+e.node.piece.lineFeedCnt>=t)return e}return null}set(t){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(t)}validate(t){let i=!1;const e=this._cache;for(let s=0;s<e.length;s++){const n=e[s];(n.node.parent===null||n.nodeStartOffset>=t)&&(e[s]=null,i=!0)}if(i){const t=[];for(const i of e)i!==null&&t.push(i);this._cache=t}}}class IL{constructor(t,i,e){this.create(t,i,e)}create(t,i,e){this._buffers=[new TL("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=gL,this._lineCnt=1,this._length=0,this._EOL=i,this._EOLLength=i.length,this._EOLNormalized=e;let s=null;for(let i=0,e=t.length;i<e;i++)if(t[i].buffer.length>0){t[i].lineStarts||(t[i].lineStarts=LL(t[i].buffer));const e=new FL(i+1,{line:0,column:0},{line:t[i].lineStarts.length-1,column:t[i].buffer.length-t[i].lineStarts[t[i].lineStarts.length-1]},t[i].lineStarts.length-1,t[i].buffer.length);this._buffers.push(t[i]),s=this.rbInsertRight(s,e)}this._searchCache=new OL(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(t){const i=EL,e=i-Math.floor(21845),s=2*e;let n="",r=0;const o=[];if(this.iterate(this.root,(i=>{const h=this.getNodeContent(i),c=h.length;if(r<=e||r+c<s)return n+=h,r+=c,!0;const l=n.replace(/\r\n|\r|\n/g,t);return o.push(new TL(l,LL(l))),n=h,r=c,!0})),r>0){const i=n.replace(/\r\n|\r|\n/g,t);o.push(new TL(i,LL(i)))}this.create(o,t,!0)}getEOL(){return this._EOL}setEOL(t){this._EOL=t,this._EOLLength=this._EOL.length,this.normalizeEOL(t)}createSnapshot(t){return new RL(this,t)}getOffsetAt(t,i){let e=0,s=this.root;for(;s!==gL;)if(s.left!==gL&&s.lf_left+1>=t)s=s.left;else{if(s.lf_left+s.piece.lineFeedCnt+1>=t)return e+=s.size_left,e+(this.getAccumulatedValue(s,t-s.lf_left-2)+i-1);t-=s.lf_left+s.piece.lineFeedCnt,e+=s.size_left+s.piece.length,s=s.right}return e}getPositionAt(t){t=Math.floor(t),t=Math.max(0,t);let i=this.root,e=0;const s=t;for(;i!==gL;)if(i.size_left!==0&&i.size_left>=t)i=i.left;else{if(i.size_left+i.piece.length>=t){const n=this.getIndexOf(i,t-i.size_left);if(e+=i.lf_left+n.index,n.index===0){const t=this.getOffsetAt(e+1,1);return new ks(e+1,s-t+1)}return new ks(e+1,n.remainder+1)}if(t-=i.size_left+i.piece.length,e+=i.lf_left+i.piece.lineFeedCnt,i.right===gL){const i=this.getOffsetAt(e+1,1);return new ks(e+1,s-t-i+1)}i=i.right}return new ks(1,1)}getValueInRange(t,i){if(t.startLineNumber===t.endLineNumber&&t.startColumn===t.endColumn)return"";const e=this.nodeAt2(t.startLineNumber,t.startColumn),s=this.nodeAt2(t.endLineNumber,t.endColumn),n=this.getValueInRange2(e,s);return i?i===this._EOL&&this._EOLNormalized&&i===this.getEOL()&&this._EOLNormalized?n:n.replace(/\r\n|\r|\n/g,i):n}getValueInRange2(t,i){if(t.node===i.node){const e=t.node,s=this._buffers[e.piece.bufferIndex].buffer,n=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start);return s.substring(n+t.remainder,n+i.remainder)}let e=t.node;const s=this._buffers[e.piece.bufferIndex].buffer,n=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start);let r=s.substring(n+t.remainder,n+e.piece.length);for(e=e.next();e!==gL;){const t=this._buffers[e.piece.bufferIndex].buffer,s=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start);if(e===i.node){r+=t.substring(s,s+i.remainder);break}r+=t.substr(s,e.piece.length),e=e.next()}return r}getLinesContent(){const t=[];let i=0,e="",s=!1;return this.iterate(this.root,(n=>{if(n===gL)return!0;const r=n.piece;let o=r.length;if(o===0)return!0;const h=this._buffers[r.bufferIndex].buffer,c=this._buffers[r.bufferIndex].lineStarts,l=r.start.line,a=r.end.line;let u=c[l]+r.start.column;if(s&&(h.charCodeAt(u)===10&&(u++,o--),t[i++]=e,e="",s=!1,o===0))return!0;if(l===a)return this._EOLNormalized||h.charCodeAt(u+o-1)!==13?e+=h.substr(u,o):(s=!0,e+=h.substr(u,o-1)),!0;e+=this._EOLNormalized?h.substring(u,Math.max(u,c[l+1]-this._EOLLength)):h.substring(u,c[l+1]).replace(/(\r\n|\r|\n)$/,""),t[i++]=e;for(let s=l+1;s<a;s++)e=this._EOLNormalized?h.substring(c[s],c[s+1]-this._EOLLength):h.substring(c[s],c[s+1]).replace(/(\r\n|\r|\n)$/,""),t[i++]=e;return this._EOLNormalized||h.charCodeAt(c[a]+r.end.column-1)!==13?e=h.substr(c[a],r.end.column):(s=!0,r.end.column===0?i--:e=h.substr(c[a],r.end.column-1)),!0})),s&&(t[i++]=e,e=""),t[i++]=e,t}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(t){return this._lastVisitedLine.lineNumber===t||(this._lastVisitedLine.lineNumber=t,t===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(t):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(t,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(t).replace(/(\r\n|\r|\n)$/,"")),this._lastVisitedLine.value}_getCharCode(t){if(t.remainder===t.node.piece.length){const i=t.node.next();if(!i)return 0;const e=this._buffers[i.piece.bufferIndex],s=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return e.buffer.charCodeAt(s)}{const i=this._buffers[t.node.piece.bufferIndex],e=this.offsetInBuffer(t.node.piece.bufferIndex,t.node.piece.start)+t.remainder;return i.buffer.charCodeAt(e)}}getLineCharCode(t,i){const e=this.nodeAt2(t,i+1);return this._getCharCode(e)}getLineLength(t){if(t===this.getLineCount()){const i=this.getOffsetAt(t,1);return this.getLength()-i}return this.getOffsetAt(t+1,1)-this.getOffsetAt(t,1)-this._EOLLength}findMatchesInNode(t,i,e,s,n,r,o,h,c,l,a){const u=this._buffers[t.piece.bufferIndex],d=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start),f=this.offsetInBuffer(t.piece.bufferIndex,n),g=this.offsetInBuffer(t.piece.bufferIndex,r);let p;const m={line:0,column:0};let w,v;i._wordSeparators?(w=u.buffer.substring(f,g),v=t=>t+f,i.reset(0)):(w=u.buffer,v=t=>t,i.reset(f));do{if(p=i.next(w),p){if(v(p.index)>=g)return l;this.positionInBuffer(t,v(p.index)-d,m);const i=this.getLineFeedCnt(t.piece.bufferIndex,n,m),r=m.line===n.line?m.column-n.column+s:m.column+1,o=r+p[0].length;if(a[l++]=cg(new Cs(e+i,r,e+i,o),p,h),v(p.index)+p[0].length>=g||l>=c)return l}}while(p);return l}findMatchesLineByLine(t,i,e,s){const n=[];let r=0;const o=new dg(i.wordSeparators,i.regex);let h=this.nodeAt2(t.startLineNumber,t.startColumn);if(h===null)return[];const c=this.nodeAt2(t.endLineNumber,t.endColumn);if(c===null)return[];let l=this.positionInBuffer(h.node,h.remainder);const a=this.positionInBuffer(c.node,c.remainder);if(h.node===c.node)return this.findMatchesInNode(h.node,o,t.startLineNumber,t.startColumn,l,a,i,e,s,r,n),n;let u=t.startLineNumber,d=h.node;for(;d!==c.node;){const c=this.getLineFeedCnt(d.piece.bufferIndex,l,d.piece.end);if(c>=1){const h=this._buffers[d.piece.bufferIndex].lineStarts,a=this.offsetInBuffer(d.piece.bufferIndex,d.piece.start),f=h[l.line+c],g=u===t.startLineNumber?t.startColumn:1;if(r=this.findMatchesInNode(d,o,u,g,l,this.positionInBuffer(d,f-a),i,e,s,r,n),r>=s)return n;u+=c}const a=u===t.startLineNumber?t.startColumn-1:0;if(u===t.endLineNumber){const h=this.getLineContent(u).substring(a,t.endColumn-1);return r=this._findMatchesInLine(i,o,h,t.endLineNumber,a,r,n,e,s),n}if(r=this._findMatchesInLine(i,o,this.getLineContent(u).substr(a),u,a,r,n,e,s),r>=s)return n;u++,h=this.nodeAt2(u,1),d=h.node,l=this.positionInBuffer(h.node,h.remainder)}if(u===t.endLineNumber){const h=u===t.startLineNumber?t.startColumn-1:0,c=this.getLineContent(u).substring(h,t.endColumn-1);return r=this._findMatchesInLine(i,o,c,t.endLineNumber,h,r,n,e,s),n}const f=u===t.startLineNumber?t.startColumn:1;return r=this.findMatchesInNode(c.node,o,u,f,l,a,i,e,s,r,n),n}_findMatchesInLine(t,i,e,s,n,r,o,h,c){const l=t.wordSeparators;if(!h&&t.simpleSearch){const i=t.simpleSearch,h=i.length,a=e.length;let u=-h;for(;(u=e.indexOf(i,u+h))!==-1;)if((!l||ug(l,e,a,u,h))&&(o[r++]=new eg(new Cs(s,u+1+n,s,u+1+h+n),null),r>=c))return r;return r}let a;i.reset(0);do{if(a=i.next(e),a&&(o[r++]=cg(new Cs(s,a.index+1+n,s,a.index+1+a[0].length+n),a,h),r>=c))return r}while(a);return r}insert(t,i,e=!1){if(this._EOLNormalized=this._EOLNormalized&&e,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==gL){const{node:e,remainder:s,nodeStartOffset:n}=this.nodeAt(t),r=e.piece,o=r.bufferIndex,h=this.positionInBuffer(e,s);if(e.piece.bufferIndex===0&&r.end.line===this._lastChangeBufferPos.line&&r.end.column===this._lastChangeBufferPos.column&&n+r.length===t&&i.length<EL)return this.appendToNode(e,i),void this.computeBufferMetadata();if(n===t)this.insertContentToNodeLeft(i,e),this._searchCache.validate(t);else if(n+e.piece.length>t){const t=[];let n=new FL(r.bufferIndex,h,r.end,this.getLineFeedCnt(r.bufferIndex,h,r.end),this.offsetInBuffer(o,r.end)-this.offsetInBuffer(o,h));if(this.shouldCheckCRLF()&&this.endWithCR(i)&&this.nodeCharCodeAt(e,s)===10){const t={line:n.start.line+1,column:0};n=new FL(n.bufferIndex,t,n.end,this.getLineFeedCnt(n.bufferIndex,t,n.end),n.length-1),i+=`\n`}if(this.shouldCheckCRLF()&&this.startWithLF(i))if(this.nodeCharCodeAt(e,s-1)===13){const n=this.positionInBuffer(e,s-1);this.deleteNodeTail(e,n),i="\r"+i,e.piece.length===0&&t.push(e)}else this.deleteNodeTail(e,h);else this.deleteNodeTail(e,h);const c=this.createNewPieces(i);n.length>0&&this.rbInsertRight(e,n);let l=e;for(let t=0;t<c.length;t++)l=this.rbInsertRight(l,c[t]);this.deleteNodes(t)}else this.insertContentToNodeRight(i,e)}else{const t=this.createNewPieces(i);let e=this.rbInsertLeft(null,t[0]);for(let i=1;i<t.length;i++)e=this.rbInsertRight(e,t[i])}this.computeBufferMetadata()}delete(t,i){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",i<=0||this.root===gL)return;const e=this.nodeAt(t),s=this.nodeAt(t+i),n=e.node,r=s.node;if(n===r){const r=this.positionInBuffer(n,e.remainder),o=this.positionInBuffer(n,s.remainder);if(e.nodeStartOffset===t){if(i===n.piece.length){const t=n.next();return CL(this,n),this.validateCRLFWithPrevNode(t),void this.computeBufferMetadata()}return this.deleteNodeHead(n,o),this._searchCache.validate(t),this.validateCRLFWithPrevNode(n),void this.computeBufferMetadata()}return e.nodeStartOffset+n.piece.length===t+i?(this.deleteNodeTail(n,r),this.validateCRLFWithNextNode(n),void this.computeBufferMetadata()):(this.shrinkNode(n,r,o),void this.computeBufferMetadata())}const o=[],h=this.positionInBuffer(n,e.remainder);this.deleteNodeTail(n,h),this._searchCache.validate(t),n.piece.length===0&&o.push(n);const c=this.positionInBuffer(r,s.remainder);this.deleteNodeHead(r,c),r.piece.length===0&&o.push(r);for(let t=n.next();t!==gL&&t!==r;t=t.next())o.push(t);const l=n.piece.length===0?n.prev():n;this.deleteNodes(o),this.validateCRLFWithNextNode(l),this.computeBufferMetadata()}insertContentToNodeLeft(t,i){const e=[];if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.startWithLF(i)){const s=i.piece,n={line:s.start.line+1,column:0},r=new FL(s.bufferIndex,n,s.end,this.getLineFeedCnt(s.bufferIndex,n,s.end),s.length-1);i.piece=r,t+=`\n`,xL(this,i,-1,-1),i.piece.length===0&&e.push(i)}const s=this.createNewPieces(t);let n=this.rbInsertLeft(i,s[s.length-1]);for(let t=s.length-2;t>=0;t--)n=this.rbInsertLeft(n,s[t]);this.validateCRLFWithPrevNode(n),this.deleteNodes(e)}insertContentToNodeRight(t,i){this.adjustCarriageReturnFromNext(t,i)&&(t+=`\n`);const e=this.createNewPieces(t),s=this.rbInsertRight(i,e[0]);let n=s;for(let t=1;t<e.length;t++)n=this.rbInsertRight(n,e[t]);this.validateCRLFWithPrevNode(s)}positionInBuffer(t,i,e){const s=t.piece,n=t.piece.bufferIndex,r=this._buffers[n].lineStarts,o=r[s.start.line]+s.start.column+i;let h=s.start.line,c=s.end.line,l=0,a=0,u=0;for(;h<=c&&(l=h+(c-h)/2|0,u=r[l],l!==c);)if(a=r[l+1],o<u)c=l-1;else{if(!(o>=a))break;h=l+1}return e?(e.line=l,e.column=o-u,null):{line:l,column:o-u}}getLineFeedCnt(t,i,e){if(e.column===0)return e.line-i.line;const s=this._buffers[t].lineStarts;if(e.line===s.length-1)return e.line-i.line;const n=s[e.line+1],r=s[e.line]+e.column;if(n>r+1)return e.line-i.line;const o=r-1;return this._buffers[t].buffer.charCodeAt(o)===13?e.line-i.line+1:e.line-i.line}offsetInBuffer(t,i){return this._buffers[t].lineStarts[i.line]+i.column}deleteNodes(t){for(let i=0;i<t.length;i++)CL(this,t[i])}createNewPieces(t){if(t.length>EL){const i=[];for(;t.length>EL;){const e=t.charCodeAt(65534);let s;e===13||e>=55296&&e<=56319?(s=t.substring(0,65534),t=t.substring(65534)):(s=t.substring(0,EL),t=t.substring(EL));const n=LL(s);i.push(new FL(this._buffers.length,{line:0,column:0},{line:n.length-1,column:s.length-n[n.length-1]},n.length-1,s.length)),this._buffers.push(new TL(s,n))}const e=LL(t);return i.push(new FL(this._buffers.length,{line:0,column:0},{line:e.length-1,column:t.length-e[e.length-1]},e.length-1,t.length)),this._buffers.push(new TL(t,e)),i}let i=this._buffers[0].buffer.length;const e=LL(t,!1);let s=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===i&&i!==0&&this.startWithLF(t)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},s=this._lastChangeBufferPos;for(let t=0;t<e.length;t++)e[t]+=i+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(e.slice(1)),this._buffers[0].buffer+="_"+t,i+=1}else{if(i!==0)for(let t=0;t<e.length;t++)e[t]+=i;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(e.slice(1)),this._buffers[0].buffer+=t}const n=this._buffers[0].buffer.length,r=this._buffers[0].lineStarts.length-1,o={line:r,column:n-this._buffers[0].lineStarts[r]},h=new FL(0,s,o,this.getLineFeedCnt(0,s,o),n-i);return this._lastChangeBufferPos=o,[h]}getLineRawContent(t,i=0){let e=this.root,s="";const n=this._searchCache.get2(t);if(n){e=n.node;const r=this.getAccumulatedValue(e,t-n.nodeStartLineNumber-1),o=this._buffers[e.piece.bufferIndex].buffer,h=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start);if(n.nodeStartLineNumber+e.piece.lineFeedCnt!==t){const s=this.getAccumulatedValue(e,t-n.nodeStartLineNumber);return o.substring(h+r,h+s-i)}s=o.substring(h+r,h+e.piece.length)}else{let n=0;const r=t;for(;e!==gL;)if(e.left!==gL&&e.lf_left>=t-1)e=e.left;else{if(e.lf_left+e.piece.lineFeedCnt>t-1){const s=this.getAccumulatedValue(e,t-e.lf_left-2),o=this.getAccumulatedValue(e,t-e.lf_left-1),h=this._buffers[e.piece.bufferIndex].buffer,c=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start);return n+=e.size_left,this._searchCache.set({node:e,nodeStartOffset:n,nodeStartLineNumber:r-(t-1-e.lf_left)}),h.substring(c+s,c+o-i)}if(e.lf_left+e.piece.lineFeedCnt===t-1){const i=this.getAccumulatedValue(e,t-e.lf_left-2),n=this._buffers[e.piece.bufferIndex].buffer,r=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start);s=n.substring(r+i,r+e.piece.length);break}t-=e.lf_left+e.piece.lineFeedCnt,n+=e.size_left+e.piece.length,e=e.right}}for(e=e.next();e!==gL;){const t=this._buffers[e.piece.bufferIndex].buffer;if(e.piece.lineFeedCnt>0){const n=this.getAccumulatedValue(e,0),r=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start);return s+=t.substring(r,r+n-i),s}{const i=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start);s+=t.substr(i,e.piece.length)}e=e.next()}return s}computeBufferMetadata(){let t=this.root,i=1,e=0;for(;t!==gL;)i+=t.lf_left+t.piece.lineFeedCnt,e+=t.size_left+t.piece.length,t=t.right;this._lineCnt=i,this._length=e,this._searchCache.validate(this._length)}getIndexOf(t,i){const e=t.piece,s=this.positionInBuffer(t,i),n=s.line-e.start.line;if(this.offsetInBuffer(e.bufferIndex,e.end)-this.offsetInBuffer(e.bufferIndex,e.start)===i){const i=this.getLineFeedCnt(t.piece.bufferIndex,e.start,s);if(i!==n)return{index:i,remainder:0}}return{index:n,remainder:s.column}}getAccumulatedValue(t,i){if(i<0)return 0;const e=t.piece,s=this._buffers[e.bufferIndex].lineStarts,n=e.start.line+i+1;return n>e.end.line?s[e.end.line]+e.end.column-s[e.start.line]-e.start.column:s[n]-s[e.start.line]-e.start.column}deleteNodeTail(t,i){const e=t.piece,s=e.lineFeedCnt,n=this.offsetInBuffer(e.bufferIndex,e.end),r=i,o=this.offsetInBuffer(e.bufferIndex,r),h=this.getLineFeedCnt(e.bufferIndex,e.start,r),c=h-s,l=o-n,a=e.length+l;t.piece=new FL(e.bufferIndex,e.start,r,h,a),xL(this,t,l,c)}deleteNodeHead(t,i){const e=t.piece,s=e.lineFeedCnt,n=this.offsetInBuffer(e.bufferIndex,e.start),r=i,o=this.getLineFeedCnt(e.bufferIndex,r,e.end),h=o-s,c=n-this.offsetInBuffer(e.bufferIndex,r),l=e.length+c;t.piece=new FL(e.bufferIndex,r,e.end,o,l),xL(this,t,c,h)}shrinkNode(t,i,e){const s=t.piece,n=s.start,r=s.end,o=s.length,h=s.lineFeedCnt,c=i,l=this.getLineFeedCnt(s.bufferIndex,s.start,c),a=this.offsetInBuffer(s.bufferIndex,i)-this.offsetInBuffer(s.bufferIndex,n);t.piece=new FL(s.bufferIndex,s.start,c,l,a),xL(this,t,a-o,l-h);const u=new FL(s.bufferIndex,e,r,this.getLineFeedCnt(s.bufferIndex,e,r),this.offsetInBuffer(s.bufferIndex,r)-this.offsetInBuffer(s.bufferIndex,e)),d=this.rbInsertRight(t,u);this.validateCRLFWithPrevNode(d)}appendToNode(t,i){this.adjustCarriageReturnFromNext(i,t)&&(i+=`\n`);const e=this.shouldCheckCRLF()&&this.startWithLF(i)&&this.endWithCR(t),s=this._buffers[0].buffer.length;this._buffers[0].buffer+=i;const n=LL(i,!1);for(let t=0;t<n.length;t++)n[t]+=s;if(e){const t=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:s-t}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1));const r=this._buffers[0].lineStarts.length-1,o={line:r,column:this._buffers[0].buffer.length-this._buffers[0].lineStarts[r]},h=t.piece.length+i.length,c=t.piece.lineFeedCnt,l=this.getLineFeedCnt(0,t.piece.start,o),a=l-c;t.piece=new FL(t.piece.bufferIndex,t.piece.start,o,l,h),this._lastChangeBufferPos=o,xL(this,t,i.length,a)}nodeAt(t){let i=this.root;const e=this._searchCache.get(t);if(e)return{node:e.node,nodeStartOffset:e.nodeStartOffset,remainder:t-e.nodeStartOffset};let s=0;for(;i!==gL;)if(i.size_left>t)i=i.left;else{if(i.size_left+i.piece.length>=t){s+=i.size_left;const e={node:i,remainder:t-i.size_left,nodeStartOffset:s};return this._searchCache.set(e),e}t-=i.size_left+i.piece.length,s+=i.size_left+i.piece.length,i=i.right}return null}nodeAt2(t,i){let e=this.root,s=0;for(;e!==gL;)if(e.left!==gL&&e.lf_left>=t-1)e=e.left;else{if(e.lf_left+e.piece.lineFeedCnt>t-1){const n=this.getAccumulatedValue(e,t-e.lf_left-2),r=this.getAccumulatedValue(e,t-e.lf_left-1);return s+=e.size_left,{node:e,remainder:Math.min(n+i-1,r),nodeStartOffset:s}}if(e.lf_left+e.piece.lineFeedCnt===t-1){const n=this.getAccumulatedValue(e,t-e.lf_left-2);if(n+i-1<=e.piece.length)return{node:e,remainder:n+i-1,nodeStartOffset:s};i-=e.piece.length-n;break}t-=e.lf_left+e.piece.lineFeedCnt,s+=e.size_left+e.piece.length,e=e.right}for(e=e.next();e!==gL;){if(e.piece.lineFeedCnt>0){const t=this.getAccumulatedValue(e,0),s=this.offsetOfNode(e);return{node:e,remainder:Math.min(i-1,t),nodeStartOffset:s}}if(e.piece.length>=i-1)return{node:e,remainder:i-1,nodeStartOffset:this.offsetOfNode(e)};i-=e.piece.length,e=e.next()}return null}nodeCharCodeAt(t,i){if(t.piece.lineFeedCnt<1)return-1;const e=this._buffers[t.piece.bufferIndex],s=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start)+i;return e.buffer.charCodeAt(s)}offsetOfNode(t){if(!t)return 0;let i=t.size_left;for(;t!==this.root;)t.parent.right===t&&(i+=t.parent.size_left+t.parent.piece.length),t=t.parent;return i}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`\n`)}startWithLF(t){if(typeof t=="string")return t.charCodeAt(0)===10;if(t===gL||t.piece.lineFeedCnt===0)return!1;const i=t.piece,e=this._buffers[i.bufferIndex].lineStarts,s=i.start.line,n=e[s]+i.start.column;return s===e.length-1?!1:!(e[s+1]>n+1)&&this._buffers[i.bufferIndex].buffer.charCodeAt(n)===10}endWithCR(t){return typeof t=="string"?t.charCodeAt(t.length-1)===13:t!==gL&&t.piece.lineFeedCnt!==0&&this.nodeCharCodeAt(t,t.piece.length-1)===13}validateCRLFWithPrevNode(t){if(this.shouldCheckCRLF()&&this.startWithLF(t)){const i=t.prev();this.endWithCR(i)&&this.fixCRLF(i,t)}}validateCRLFWithNextNode(t){if(this.shouldCheckCRLF()&&this.endWithCR(t)){const i=t.next();this.startWithLF(i)&&this.fixCRLF(t,i)}}fixCRLF(t,i){const e=[],s=this._buffers[t.piece.bufferIndex].lineStarts;let n;n=t.piece.end.column===0?{line:t.piece.end.line-1,column:s[t.piece.end.line]-s[t.piece.end.line-1]-1}:{line:t.piece.end.line,column:t.piece.end.column-1};const r=t.piece.length-1,o=t.piece.lineFeedCnt-1;t.piece=new FL(t.piece.bufferIndex,t.piece.start,n,o,r),xL(this,t,-1,-1),t.piece.length===0&&e.push(t);const h={line:i.piece.start.line+1,column:0},c=i.piece.length-1,l=this.getLineFeedCnt(i.piece.bufferIndex,h,i.piece.end);i.piece=new FL(i.piece.bufferIndex,h,i.piece.end,l,c),xL(this,i,-1,-1),i.piece.length===0&&e.push(i);const a=this.createNewPieces(`\r\n`);this.rbInsertRight(t,a[0]);for(let t=0;t<e.length;t++)CL(this,e[t])}adjustCarriageReturnFromNext(t,i){if(this.shouldCheckCRLF()&&this.endWithCR(t)){const e=i.next();if(this.startWithLF(e)){if(t+=`\n`,e.piece.length===1)CL(this,e);else{const t=e.piece,i={line:t.start.line+1,column:0},s=t.length-1,n=this.getLineFeedCnt(t.bufferIndex,i,t.end);e.piece=new FL(t.bufferIndex,i,t.end,n,s),xL(this,e,-1,-1)}return!0}}return!1}iterate(t,i){if(t===gL)return i(gL);const e=this.iterate(t.left,i);return e&&i(t)&&this.iterate(t.right,i)}getNodeContent(t){if(t===gL)return"";const i=this._buffers[t.piece.bufferIndex],e=t.piece,s=this.offsetInBuffer(e.bufferIndex,e.start),n=this.offsetInBuffer(e.bufferIndex,e.end);return i.buffer.substring(s,n)}getPieceContent(t){const i=this._buffers[t.bufferIndex],e=this.offsetInBuffer(t.bufferIndex,t.start),s=this.offsetInBuffer(t.bufferIndex,t.end);return i.buffer.substring(e,s)}rbInsertRight(t,i){const e=new fL(i,1);if(e.left=gL,e.right=gL,e.parent=gL,e.size_left=0,e.lf_left=0,this.root===gL)this.root=e,e.color=0;else if(t.right===gL)t.right=e,e.parent=t;else{const i=pL(t.right);i.left=e,e.parent=i}return SL(this,e),e}rbInsertLeft(t,i){const e=new fL(i,1);if(e.left=gL,e.right=gL,e.parent=gL,e.size_left=0,e.lf_left=0,this.root===gL)this.root=e,e.color=0;else if(t.left===gL)t.left=e,e.parent=t;else{const i=mL(t.left);i.right=e,e.parent=i}return SL(this,e),e}}class _L extends Qi{constructor(t,i,e,s,n,r,o){super(),this._onDidChangeContent=this._register(new le),this._BOM=i,this._mightContainNonBasicASCII=!r,this._mightContainRTL=s,this._mightContainUnusualLineTerminators=n,this._pieceTree=new IL(t,e,o)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(t){return this._pieceTree.createSnapshot(t?this._BOM:"")}getOffsetAt(t,i){return this._pieceTree.getOffsetAt(t,i)}getPositionAt(t){return this._pieceTree.getPositionAt(t)}getRangeAt(t,i){const e=t+i,s=this.getPositionAt(t),n=this.getPositionAt(e);return new Cs(s.lineNumber,s.column,n.lineNumber,n.column)}getValueInRange(t,i=0){if(t.isEmpty())return"";const e=this._getEndOfLine(i);return this._pieceTree.getValueInRange(t,e)}getValueLengthInRange(t,i=0){if(t.isEmpty())return 0;if(t.startLineNumber===t.endLineNumber)return t.endColumn-t.startColumn;const e=this.getOffsetAt(t.startLineNumber,t.startColumn),s=this.getOffsetAt(t.endLineNumber,t.endColumn);let n=0;const r=this._getEndOfLine(i),o=this.getEOL();return r.length!==o.length&&(n=(r.length-o.length)*(t.endLineNumber-t.startLineNumber)),s-e+n}getCharacterCountInRange(t,i=0){if(this._mightContainNonBasicASCII){let e=0;const s=t.startLineNumber,n=t.endLineNumber;for(let i=s;i<=n;i++){const r=this.getLineContent(i),o=i===s?t.startColumn-1:0,h=i===n?t.endColumn-1:r.length;for(let t=o;t<h;t++)gr(r.charCodeAt(t))?(e+=1,t+=1):e+=1}return e+=this._getEndOfLine(i).length*(n-s),e}return this.getValueLengthInRange(t,i)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(t){return this._pieceTree.getLineContent(t)}getLineCharCode(t,i){return this._pieceTree.getLineCharCode(t,i)}getLineLength(t){return this._pieceTree.getLineLength(t)}getLineFirstNonWhitespaceColumn(t){const i=tr(this.getLineContent(t));return i===-1?0:i+1}getLineLastNonWhitespaceColumn(t){const i=er(this.getLineContent(t));return i===-1?0:i+2}_getEndOfLine(t){switch(t){case 1:return`\n`;case 2:return`\r\n`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(t){this._pieceTree.setEOL(t)}applyEdits(t,i,e){let s=this._mightContainRTL,n=this._mightContainUnusualLineTerminators,r=this._mightContainNonBasicASCII,o=!0,h=[];for(let i=0;i<t.length;i++){const e=t[i];o&&e._isTracked&&(o=!1);const c=e.range;if(e.text){let t=!0;r||(t=!Dr(e.text),r=t),!s&&t&&(s=Sr(e.text)),!n&&t&&(n=Ar(e.text))}let l="",a=0,u=0,d=0;if(e.text){let t;[a,u,d,t]=YE(e.text);const i=this.getEOL();l=t===0||t===(i===`\r\n`?2:1)?e.text:e.text.replace(/\r\n|\r|\n/g,i)}h[i]={sortIndex:i,identifier:e.identifier||null,range:c,rangeOffset:this.getOffsetAt(c.startLineNumber,c.startColumn),rangeLength:this.getValueLengthInRange(c),text:l,eolCount:a,firstLineLength:u,lastLineLength:d,forceMoveMarkers:!!e.forceMoveMarkers,isAutoWhitespaceEdit:e.isAutoWhitespaceEdit||!1}}h.sort(_L._sortOpsAscending);let c=!1;for(let t=0,i=h.length-1;t<i;t++){const i=h[t].range.getEndPosition(),e=h[t+1].range.getStartPosition();if(e.isBeforeOrEqual(i)){if(e.isBefore(i))throw new Error("Overlapping ranges are not allowed!");c=!0}}o&&(h=this._reduceOperations(h));const l=e||i?_L._getInverseEditRanges(h):[],a=[];if(i)for(let t=0;t<h.length;t++){const i=h[t],e=l[t];if(i.isAutoWhitespaceEdit&&i.range.isEmpty())for(let t=e.startLineNumber;t<=e.endLineNumber;t++){let s="";t===e.startLineNumber&&(s=this.getLineContent(i.range.startLineNumber),tr(s)!==-1)||a.push({lineNumber:t,oldContent:s})}}let u=null;if(e){let t=0;u=[];for(let i=0;i<h.length;i++){const e=h[i],s=l[i],n=this.getValueInRange(e.range),r=e.rangeOffset+t;t+=e.text.length-n.length,u[i]={sortIndex:e.sortIndex,identifier:e.identifier,range:s,text:n,textChange:new dM(e.rangeOffset,n,r,e.text)}}c||u.sort(((t,i)=>t.sortIndex-i.sortIndex))}this._mightContainRTL=s,this._mightContainUnusualLineTerminators=n,this._mightContainNonBasicASCII=r;const d=this._doApplyEdits(h);let f=null;if(i&&a.length>0){a.sort(((t,i)=>i.lineNumber-t.lineNumber)),f=[];for(let t=0,i=a.length;t<i;t++){const i=a[t].lineNumber;if(t>0&&a[t-1].lineNumber===i)continue;const e=a[t].oldContent,s=this.getLineContent(i);s.length!==0&&s!==e&&tr(s)===-1&&f.push(i)}}return this._onDidChangeContent.fire(),new rg(u,d,f)}_reduceOperations(t){return t.length<1e3?t:[this._toSingleEditOperation(t)]}_toSingleEditOperation(t){let i=!1;const e=t[0].range,s=t[t.length-1].range,n=new Cs(e.startLineNumber,e.startColumn,s.endLineNumber,s.endColumn);let r=e.startLineNumber,o=e.startColumn;const h=[];for(let e=0,s=t.length;e<s;e++){const s=t[e],n=s.range;i=i||s.forceMoveMarkers,h.push(this.getValueInRange(new Cs(r,o,n.startLineNumber,n.startColumn))),s.text.length>0&&h.push(s.text),r=n.endLineNumber,o=n.endColumn}const c=h.join(""),[l,a,u]=YE(c);return{sortIndex:0,identifier:t[0].identifier,range:n,rangeOffset:this.getOffsetAt(n.startLineNumber,n.startColumn),rangeLength:this.getValueLengthInRange(n,0),text:c,eolCount:l,firstLineLength:a,lastLineLength:u,forceMoveMarkers:i,isAutoWhitespaceEdit:!1}}_doApplyEdits(t){t.sort(_L._sortOpsDescending);const i=[];for(let e=0;e<t.length;e++){const s=t[e],n=s.range.startLineNumber,r=s.range.startColumn,o=s.range.endLineNumber,h=s.range.endColumn;if(n===o&&r===h&&s.text.length===0)continue;s.text?(this._pieceTree.delete(s.rangeOffset,s.rangeLength),this._pieceTree.insert(s.rangeOffset,s.text,!0)):this._pieceTree.delete(s.rangeOffset,s.rangeLength);const c=new Cs(n,r,o,h);i.push({range:c,rangeLength:s.rangeLength,text:s.text,rangeOffset:s.rangeOffset,forceMoveMarkers:s.forceMoveMarkers})}return i}findMatchesLineByLine(t,i,e,s){return this._pieceTree.findMatchesLineByLine(t,i,e,s)}static _getInverseEditRanges(t){const i=[];let e=0,s=0,n=null;for(let r=0,o=t.length;r<o;r++){const o=t[r];let h,c,l;if(n?n.range.endLineNumber===o.range.startLineNumber?(h=e,c=s+(o.range.startColumn-n.range.endColumn)):(h=e+(o.range.startLineNumber-n.range.endLineNumber),c=o.range.startColumn):(h=o.range.startLineNumber,c=o.range.startColumn),o.text.length>0){const t=o.eolCount+1;l=t===1?new Cs(h,c,h,c+o.firstLineLength):new Cs(h,c,h+t-1,o.lastLineLength+1)}else l=new Cs(h,c,h,c);e=l.endLineNumber,s=l.endColumn,i.push(l),n=o}return i}static _sortOpsAscending(t,i){const e=Cs.compareRangesUsingEnds(t.range,i.range);return e===0?t.sortIndex-i.sortIndex:e}static _sortOpsDescending(t,i){const e=Cs.compareRangesUsingEnds(t.range,i.range);return e===0?i.sortIndex-t.sortIndex:-e}}class PL{constructor(t,i,e,s,n,r,o,h,c){this._chunks=t,this._bom=i,this._cr=e,this._lf=s,this._crlf=n,this._containsRTL=r,this._containsUnusualLineTerminators=o,this._isBasicASCII=h,this._normalizeEOL=c}_getEOL(t){const i=this._cr+this._lf+this._crlf,e=this._cr+this._crlf;return i===0?t===1?`\n`:`\r\n`:e>i/2?`\r\n`:`\n`}create(t){const i=this._getEOL(t),e=this._chunks;if(this._normalizeEOL&&(i===`\r\n`&&(this._cr>0||this._lf>0)||i===`\n`&&(this._cr>0||this._crlf>0)))for(let t=0,s=e.length;t<s;t++){const s=e[t].buffer.replace(/\r\n|\r|\n/g,i),n=LL(s);e[t]=new TL(s,n)}const s=new _L(e,this._bom,i,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:s,disposable:s}}}class NL{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(t){if(t.length===0)return;this.chunks.length===0&&Tr(t)&&(this.BOM=Fr,t=t.substr(1));const i=t.charCodeAt(t.length-1);i===13||i>=55296&&i<=56319?(this._acceptChunk1(t.substr(0,t.length-1),!1),this._hasPreviousChar=!0,this._previousChar=i):(this._acceptChunk1(t,!1),this._hasPreviousChar=!1,this._previousChar=i)}_acceptChunk1(t,i){(i||t.length!==0)&&(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+t):this._acceptChunk2(t))}_acceptChunk2(t){const i=function(t,i){t.length=0,t[0]=0;let e=1,s=0,n=0,r=0,o=!0;for(let h=0,c=i.length;h<c;h++){const l=i.charCodeAt(h);l===13?h+1<c&&i.charCodeAt(h+1)===10?(r++,t[e++]=h+2,h++):(s++,t[e++]=h+1):l===10?(n++,t[e++]=h+1):o&&l!==9&&(l<32||l>126)&&(o=!1)}const h=new ML(AL(t),s,n,r,o);return t.length=0,h}(this._tmpLineStarts,t);this.chunks.push(new TL(t,i.lineStarts)),this.cr+=i.cr,this.lf+=i.lf,this.crlf+=i.crlf,i.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=Sr(t)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=Ar(t)))}finish(t=!0){return this._finish(),new PL(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,t)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;const t=this.chunks[this.chunks.length-1];t.buffer+=String.fromCharCode(this._previousChar);const i=LL(t.buffer);t.lineStarts=i,this._previousChar===13&&this.cr++}}}class BL{constructor(t){this._default=t,this._store=[]}get(t){return t<this._store.length?this._store[t]:this._default}set(t,i){for(;t>=this._store.length;)this._store[this._store.length]=this._default;this._store[t]=i}replace(t,i,e){if(t>=this._store.length)return;if(i===0)return void this.insert(t,e);if(e===0)return void this.delete(t,i);const s=this._store.slice(0,t),n=this._store.slice(t+i),r=function(t,i){const e=[];for(let s=0;s<t;s++)e[s]=i;return e}(e,this._default);this._store=s.concat(r,n)}delete(t,i){i===0||t>=this._store.length||this._store.splice(t,i)}insert(t,i){if(i===0||t>=this._store.length)return;const e=[];for(let t=0;t<i;t++)e[t]=this._default;this._store=w(this._store,t,e)}}class $L{get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}constructor(t,i){this._startLineNumber=t,this._tokens=i}getLineTokens(t){return this._tokens[t-this._startLineNumber]}appendLineTokens(t){this._tokens.push(t)}}class WL{constructor(){this._tokens=[]}add(t,i){if(this._tokens.length>0){const e=this._tokens[this._tokens.length-1];if(e.endLineNumber+1===t)return void e.appendLineTokens(i)}this._tokens.push(new $L(t,[i]))}finalize(){return this._tokens}}class jL{constructor(t,i){this.tokenizationSupport=i,this.initialState=this.tokenizationSupport.getInitialState(),this.store=new VL(t)}getStartState(t){return this.store.getStartState(t,this.initialState)}getFirstInvalidLine(){return this.store.getFirstInvalidLine(this.initialState)}}class HL extends jL{constructor(t,i,e,s){super(t,i),this._textModel=e,this._languageIdCodec=s}updateTokensUntilLine(t,i){const e=this._textModel.getLanguageId();for(;;){const s=this.getFirstInvalidLine();if(!s||s.lineNumber>i)break;const n=this._textModel.getLineContent(s.lineNumber),r=KL(this._languageIdCodec,e,this.tokenizationSupport,n,!0,s.startState);t.add(s.lineNumber,r.tokens),this.store.setEndState(s.lineNumber,r.endState)}}getTokenTypeIfInsertingCharacter(t,i){const e=this.getStartState(t.lineNumber);if(!e)return 0;const s=this._textModel.getLanguageId(),n=this._textModel.getLineContent(t.lineNumber),r=n.substring(0,t.column-1)+i+n.substring(t.column-1),o=KL(this._languageIdCodec,s,this.tokenizationSupport,r,!0,e),h=new sm(o.tokens,r,this._languageIdCodec);if(h.getCount()===0)return 0;const c=h.findTokenIndexAtOffset(t.column-1);return h.getStandardTokenType(c)}tokenizeLineWithEdit(t,i,e){const s=t.lineNumber,n=t.column,r=this.getStartState(s);if(!r)return null;const o=this._textModel.getLineContent(s),h=o.substring(0,n-1)+e+o.substring(n-1+i),c=this._textModel.getLanguageIdAtPosition(s,0),l=KL(this._languageIdCodec,c,this.tokenizationSupport,h,!0,r);return new sm(l.tokens,h,this._languageIdCodec)}hasAccurateTokensForLine(t){return t<this.store.getFirstInvalidEndStateLineNumberOrMax()}isCheapToTokenize(t){const i=this.store.getFirstInvalidEndStateLineNumberOrMax();return t<i||t===i&&this._textModel.getLineLength(t)<2048}tokenizeHeuristically(t,i,e){if(e<=this.store.getFirstInvalidEndStateLineNumberOrMax())return{heuristicTokens:!1};if(i<=this.store.getFirstInvalidEndStateLineNumberOrMax())return this.updateTokensUntilLine(t,e),{heuristicTokens:!1};let s=this.guessStartState(i);const n=this._textModel.getLanguageId();for(let r=i;r<=e;r++){const i=this._textModel.getLineContent(r),e=KL(this._languageIdCodec,n,this.tokenizationSupport,i,!0,s);t.add(r,e.tokens),s=e.endState}return{heuristicTokens:!0}}guessStartState(t){let i=this._textModel.getLineFirstNonWhitespaceColumn(t);const e=[];let s=null;for(let n=t-1;i>1&&n>=1;n--){const t=this._textModel.getLineFirstNonWhitespaceColumn(n);if(t!==0&&t<i&&(e.push(this._textModel.getLineContent(n)),i=t,s=this.getStartState(n),s))break}s||(s=this.tokenizationSupport.getInitialState()),e.reverse();const n=this._textModel.getLanguageId();let r=s;for(const t of e)r=KL(this._languageIdCodec,n,this.tokenizationSupport,t,!1,r).endState;return r}}class VL{constructor(t){this.lineCount=t,this._tokenizationStateStore=new zL,this._invalidEndStatesLineNumbers=new UL,this._invalidEndStatesLineNumbers.addRange(new vg(1,t+1))}getEndState(t){return this._tokenizationStateStore.getEndState(t)}setEndState(t,i){if(!i)throw new zi("Cannot set null/undefined state");this._invalidEndStatesLineNumbers.delete(t);const e=this._tokenizationStateStore.setEndState(t,i);return e&&t<this.lineCount&&this._invalidEndStatesLineNumbers.addRange(new vg(t+1,t+2)),e}acceptChange(t,i){this.lineCount+=i-t.length,this._tokenizationStateStore.acceptChange(t,i),this._invalidEndStatesLineNumbers.addRangeAndResize(new vg(t.startLineNumber,t.endLineNumberExclusive),i)}acceptChanges(t){for(const i of t){const[t]=YE(i.text);this.acceptChange(new Ag(i.range.startLineNumber,i.range.endLineNumber+1),t+1)}}invalidateEndStateRange(t){this._invalidEndStatesLineNumbers.addRange(new vg(t.startLineNumber,t.endLineNumberExclusive))}getFirstInvalidEndStateLineNumber(){return this._invalidEndStatesLineNumbers.min}getFirstInvalidEndStateLineNumberOrMax(){return this.getFirstInvalidEndStateLineNumber()||Number.MAX_SAFE_INTEGER}allStatesValid(){return this._invalidEndStatesLineNumbers.min===null}getStartState(t,i){return t===1?i:this.getEndState(t-1)}getFirstInvalidLine(t){const i=this.getFirstInvalidEndStateLineNumber();if(i===null)return null;const e=this.getStartState(i,t);if(!e)throw new zi("Start state must be defined");return{lineNumber:i,startState:e}}}class zL{constructor(){this._lineEndStates=new BL(null)}getEndState(t){return this._lineEndStates.get(t)}setEndState(t,i){const e=this._lineEndStates.get(t);return(!e||!e.equals(i))&&(this._lineEndStates.set(t,i),!0)}acceptChange(t,i){let e=t.length;i>0&&e>0&&(e--,i--),this._lineEndStates.replace(t.startLineNumber,e,i)}}class UL{constructor(){this._ranges=[]}get min(){return this._ranges.length===0?null:this._ranges[0].start}delete(t){const i=this._ranges.findIndex((i=>i.contains(t)));if(i!==-1){const e=this._ranges[i];e.start===t?e.endExclusive===t+1?this._ranges.splice(i,1):this._ranges[i]=new vg(t+1,e.endExclusive):e.endExclusive===t+1?this._ranges[i]=new vg(e.start,t):this._ranges.splice(i,1,new vg(e.start,t),new vg(t+1,e.endExclusive))}}addRange(t){vg.addRange(t,this._ranges)}addRangeAndResize(t,i){let e=0;for(;!(e>=this._ranges.length||t.start<=this._ranges[e].endExclusive);)e++;let s=e;for(;!(s>=this._ranges.length||t.endExclusive<this._ranges[s].start);)s++;const n=i-t.length;for(let t=s;t<this._ranges.length;t++)this._ranges[t]=this._ranges[t].delta(n);if(e===s){const s=new vg(t.start,t.start+i);s.isEmpty||this._ranges.splice(e,0,s)}else{const i=Math.min(t.start,this._ranges[e].start),r=Math.max(t.endExclusive,this._ranges[s-1].endExclusive),o=new vg(i,r+n);o.isEmpty?this._ranges.splice(e,s-e):this._ranges.splice(e,s-e,o)}}toString(){return this._ranges.map((t=>t.toString())).join(" + ")}}function KL(t,i,e,s,n,r){let o=null;if(e)try{o=e.tokenizeEncoded(s,n,r.clone())}catch(t){Ii(t)}return o||(o=im(t.encodeLanguageId(i),r)),sm.convertToEndOffset(o.tokens,s.length),o}class qL{constructor(t,i){this._tokenizerWithStateStore=t,this._backgroundTokenStore=i,this._isDisposed=!1,this._isScheduled=!1}dispose(){this._isDisposed=!0}handleChanges(){this._beginBackgroundTokenization()}_beginBackgroundTokenization(){!this._isScheduled&&this._tokenizerWithStateStore._textModel.isAttachedToEditor()&&this._hasLinesToTokenize()&&(this._isScheduled=!0,So((t=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(t)})))}_backgroundTokenizeWithDeadline(t){const i=Date.now()+t.timeRemaining(),e=()=>{!this._isDisposed&&this._tokenizerWithStateStore._textModel.isAttachedToEditor()&&this._hasLinesToTokenize()&&(this._backgroundTokenizeForAtLeast1ms(),Date.now()<i?Lt(e):this._beginBackgroundTokenization())};e()}_backgroundTokenizeForAtLeast1ms(){const t=this._tokenizerWithStateStore._textModel.getLineCount(),i=new WL,e=se.create(!1);do{if(e.elapsed()>1||this._tokenizeOneInvalidLine(i)>=t)break}while(this._hasLinesToTokenize());this._backgroundTokenStore.setTokens(i.finalize()),this.checkFinished()}_hasLinesToTokenize(){return!!this._tokenizerWithStateStore&&!this._tokenizerWithStateStore.store.allStatesValid()}_tokenizeOneInvalidLine(t){var i;const e=(i=this._tokenizerWithStateStore)===null||i===void 0?void 0:i.getFirstInvalidLine();return e?(this._tokenizerWithStateStore.updateTokensUntilLine(t,e.lineNumber),e.lineNumber):this._tokenizerWithStateStore._textModel.getLineCount()+1}checkFinished(){this._isDisposed||this._tokenizerWithStateStore.store.allStatesValid()&&this._backgroundTokenStore.backgroundTokenizationFinished()}requestTokens(t,i){this._tokenizerWithStateStore.store.invalidateEndStateRange(new Ag(t,i))}}const GL=new Uint32Array(0).buffer;class ZL{static deleteBeginning(t,i){return t===null||t===GL?t:ZL.delete(t,0,i)}static deleteEnding(t,i){if(t===null||t===GL)return t;const e=JL(t),s=e[e.length-2];return ZL.delete(t,i,s)}static delete(t,i,e){if(t===null||t===GL||i===e)return t;const s=JL(t),n=s.length>>>1;if(i===0&&s[s.length-2]===e)return GL;const r=sm.findIndexInTokensArray(s,i),o=r>0?s[r-1<<1]:0;if(e<s[r<<1]){const o=e-i;for(let t=r;t<n;t++)s[t<<1]-=o;return t}let h,c;o!==i?(s[r<<1]=i,h=r+1<<1,c=i):(h=r<<1,c=o);const l=e-i;for(let t=r+1;t<n;t++){const i=s[t<<1]-l;i>c&&(s[h++]=i,s[h++]=s[1+(t<<1)],c=i)}if(h===s.length)return t;const a=new Uint32Array(h);return a.set(s.subarray(0,h),0),a.buffer}static append(t,i){if(i===GL)return t;if(t===GL)return i;if(t===null)return t;if(i===null)return null;const e=JL(t),s=JL(i),n=s.length>>>1,r=new Uint32Array(e.length+s.length);r.set(e,0);let o=e.length;const h=e[e.length-2];for(let t=0;t<n;t++)r[o++]=s[t<<1]+h,r[o++]=s[1+(t<<1)];return r.buffer}static insert(t,i,e){if(t===null||t===GL)return t;const s=JL(t),n=s.length>>>1;let r=sm.findIndexInTokensArray(s,i);r>0&&s[r-1<<1]===i&&r--;for(let t=r;t<n;t++)s[t<<1]+=e;return t}}function JL(t){return t instanceof Uint32Array?t:new Uint32Array(t)}class QL{constructor(t){this._lineTokens=[],this._len=0,this._languageIdCodec=t}flush(){this._lineTokens=[],this._len=0}get hasTokens(){return this._lineTokens.length>0}getTokens(t,i,e){let s=null;if(i<this._len&&(s=this._lineTokens[i]),s!==null&&s!==GL)return new sm(JL(s),e,this._languageIdCodec);const n=new Uint32Array(2);return n[0]=e.length,n[1]=YL(this._languageIdCodec.encodeLanguageId(t)),new sm(n,e,this._languageIdCodec)}static _massageTokens(t,i,e){const s=e?JL(e):null;if(i===0){let i=!1;if(s&&s.length>1&&(i=em.getLanguageId(s[1])!==t),!i)return GL}if(!s||s.length===0){const e=new Uint32Array(2);return e[0]=i,e[1]=YL(t),e.buffer}return s[s.length-2]=i,s.byteOffset===0&&s.byteLength===s.buffer.byteLength?s.buffer:s}_ensureLine(t){for(;t>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(t,i){i!==0&&(t+i>this._len&&(i=this._len-t),this._lineTokens.splice(t,i),this._len-=i)}_insertLines(t,i){if(i===0)return;const e=[];for(let t=0;t<i;t++)e[t]=null;this._lineTokens=w(this._lineTokens,t,e),this._len+=i}setTokens(t,i,e,s,n){const r=QL._massageTokens(this._languageIdCodec.encodeLanguageId(t),e,s);this._ensureLine(i);const o=this._lineTokens[i];return this._lineTokens[i]=r,!!n&&!QL._equals(o,r)}static _equals(t,i){if(!t||!i)return!t&&!i;const e=JL(t),s=JL(i);if(e.length!==s.length)return!1;for(let t=0,i=e.length;t<i;t++)if(e[t]!==s[t])return!1;return!0}acceptEdit(t,i,e){this._acceptDeleteRange(t),this._acceptInsertText(new ks(t.startLineNumber,t.startColumn),i,e)}_acceptDeleteRange(t){const i=t.startLineNumber-1;if(i>=this._len)return;if(t.startLineNumber===t.endLineNumber)return t.startColumn===t.endColumn?void 0:void(this._lineTokens[i]=ZL.delete(this._lineTokens[i],t.startColumn-1,t.endColumn-1));this._lineTokens[i]=ZL.deleteEnding(this._lineTokens[i],t.startColumn-1);const e=t.endLineNumber-1;let s=null;e<this._len&&(s=ZL.deleteBeginning(this._lineTokens[e],t.endColumn-1)),this._lineTokens[i]=ZL.append(this._lineTokens[i],s),this._deleteLines(t.startLineNumber,t.endLineNumber-t.startLineNumber)}_acceptInsertText(t,i,e){if(i===0&&e===0)return;const s=t.lineNumber-1;s>=this._len||(i!==0?(this._lineTokens[s]=ZL.deleteEnding(this._lineTokens[s],t.column-1),this._lineTokens[s]=ZL.insert(this._lineTokens[s],t.column-1,e),this._insertLines(t.lineNumber,i)):this._lineTokens[s]=ZL.insert(this._lineTokens[s],t.column-1,e))}setMultilineTokens(t,i){if(t.length===0)return{changes:[]};const e=[];for(let s=0,n=t.length;s<n;s++){const n=t[s];let r=0,o=0,h=!1;for(let t=n.startLineNumber;t<=n.endLineNumber;t++)h?(this.setTokens(i.getLanguageId(),t-1,i.getLineLength(t),n.getLineTokens(t),!1),o=t):this.setTokens(i.getLanguageId(),t-1,i.getLineLength(t),n.getLineTokens(t),!0)&&(h=!0,r=t,o=t);h&&e.push({fromLineNumber:r,toLineNumber:o})}return{changes:e}}}function YL(t){return(32768|t|2<<24|1024)>>>0}class XL{constructor(t){this._pieces=[],this._isComplete=!1,this._languageIdCodec=t}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return this._pieces.length===0}set(t,i){this._pieces=t||[],this._isComplete=i}setPartial(t,i){let e=t;if(i.length>0){const s=i[0].getRange(),n=i[i.length-1].getRange();if(!s||!n)return t;e=t.plusRange(s).plusRange(n)}let s=null;for(let t=0,i=this._pieces.length;t<i;t++){const n=this._pieces[t];if(n.endLineNumber<e.startLineNumber)continue;if(n.startLineNumber>e.endLineNumber){s=s||{index:t};break}if(n.removeTokens(e),n.isEmpty()){this._pieces.splice(t,1),t--,i--;continue}if(n.endLineNumber<e.startLineNumber)continue;if(n.startLineNumber>e.endLineNumber){s=s||{index:t};continue}const[r,o]=n.split(e);r.isEmpty()?s=s||{index:t}:o.isEmpty()||(this._pieces.splice(t,1,r,o),t++,i++,s=s||{index:t})}return s=s||{index:this._pieces.length},i.length>0&&(this._pieces=w(this._pieces,s.index,i)),e}isComplete(){return this._isComplete}addSparseTokens(t,i){if(i.getLineContent().length===0)return i;const e=this._pieces;if(e.length===0)return i;const s=e[XL._findFirstPieceWithLine(e,t)].getLineTokens(t);if(!s)return i;const n=i.getCount(),r=s.getCount();let o=0;const h=[];let c=0,l=0;const a=(t,i)=>{t!==l&&(l=t,h[c++]=t,h[c++]=i)};for(let t=0;t<r;t++){const e=s.getStartCharacter(t),r=s.getEndCharacter(t),h=s.getMetadata(t),c=((1&h?2048:0)|(2&h?4096:0)|(4&h?8192:0)|(8&h?16384:0)|(16&h?16744448:0)|(32&h?4278190080:0))>>>0,l=~c>>>0;for(;o<n&&i.getEndOffset(o)<=e;)a(i.getEndOffset(o),i.getMetadata(o)),o++;for(o<n&&i.getStartOffset(o)<e&&a(e,i.getMetadata(o));o<n&&i.getEndOffset(o)<r;)a(i.getEndOffset(o),i.getMetadata(o)&l|h&c),o++;if(o<n)a(r,i.getMetadata(o)&l|h&c),i.getEndOffset(o)===r&&o++;else{const t=Math.min(Math.max(0,o-1),n-1);a(r,i.getMetadata(t)&l|h&c)}}for(;o<n;)a(i.getEndOffset(o),i.getMetadata(o)),o++;return new sm(new Uint32Array(h),i.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(t,i){let e=0,s=t.length-1;for(;e<s;){let n=e+Math.floor((s-e)/2);if(t[n].endLineNumber<i)e=n+1;else{if(!(t[n].startLineNumber>i)){for(;n>e&&t[n-1].startLineNumber<=i&&i<=t[n-1].endLineNumber;)n--;return n}s=n-1}}return e}acceptEdit(t,i,e,s,n){for(const r of this._pieces)r.acceptEdit(t,i,e,s,n)}}class tF extends kD{constructor(t,i,e,s,n,r){super(),this._languageService=t,this._languageConfigurationService=i,this._textModel=e,this._bracketPairsTextModelPart=s,this._languageId=n,this._attachedViews=r,this._semanticTokens=new XL(this._languageService.languageIdCodec),this._onDidChangeLanguage=this._register(new le),this.onDidChangeLanguage=this._onDidChangeLanguage.event,this._onDidChangeLanguageConfiguration=this._register(new le),this.onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event,this._onDidChangeTokens=this._register(new le),this.onDidChangeTokens=this._onDidChangeTokens.event,this.grammarTokens=this._register(new iF(this._languageService.languageIdCodec,this._textModel,(()=>this._languageId),this._attachedViews)),this._register(this._languageConfigurationService.onDidChange((t=>{t.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})}))),this._register(this.grammarTokens.onDidChangeTokens((t=>{this._emitModelTokensChangedEvent(t)}))),this._register(this.grammarTokens.onDidChangeBackgroundTokenizationState((t=>{this._bracketPairsTextModelPart.handleDidChangeBackgroundTokenizationState()})))}handleDidChangeContent(t){if(t.isFlush)this._semanticTokens.flush();else if(!t.isEolChange)for(const i of t.changes){const[t,e,s]=YE(i.text);this._semanticTokens.acceptEdit(i.range,t,e,s,i.text.length>0?i.text.charCodeAt(0):0)}this.grammarTokens.handleDidChangeContent(t)}handleDidChangeAttached(){this.grammarTokens.handleDidChangeAttached()}getLineTokens(t){this.validateLineNumber(t);const i=this.grammarTokens.getLineTokens(t);return this._semanticTokens.addSparseTokens(t,i)}_emitModelTokensChangedEvent(t){this._textModel._isDisposing()||(this._bracketPairsTextModelPart.handleDidChangeTokens(t),this._onDidChangeTokens.fire(t))}validateLineNumber(t){if(t<1||t>this._textModel.getLineCount())throw new zi("Illegal value for lineNumber")}get hasTokens(){return this.grammarTokens.hasTokens}resetTokenization(){this.grammarTokens.resetTokenization()}get backgroundTokenizationState(){return this.grammarTokens.backgroundTokenizationState}forceTokenization(t){this.validateLineNumber(t),this.grammarTokens.forceTokenization(t)}hasAccurateTokensForLine(t){return this.validateLineNumber(t),this.grammarTokens.hasAccurateTokensForLine(t)}isCheapToTokenize(t){return this.validateLineNumber(t),this.grammarTokens.isCheapToTokenize(t)}tokenizeIfCheap(t){this.validateLineNumber(t),this.grammarTokens.tokenizeIfCheap(t)}getTokenTypeIfInsertingCharacter(t,i,e){return this.grammarTokens.getTokenTypeIfInsertingCharacter(t,i,e)}tokenizeLineWithEdit(t,i,e){return this.grammarTokens.tokenizeLineWithEdit(t,i,e)}setSemanticTokens(t,i){this._semanticTokens.set(t,i),this._emitModelTokensChangedEvent({semanticTokensApplied:t!==null,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(t,i){if(this.hasCompleteSemanticTokens())return;const e=this._textModel.validateRange(this._semanticTokens.setPartial(t,i));this._emitModelTokensChangedEvent({semanticTokensApplied:!0,ranges:[{fromLineNumber:e.startLineNumber,toLineNumber:e.endLineNumber}]})}getWordAtPosition(t){this.assertNotDisposed();const i=this._textModel.validatePosition(t),e=this._textModel.getLineContent(i.lineNumber),s=this.getLineTokens(i.lineNumber),n=s.findTokenIndexAtOffset(i.column-1),[r,o]=tF._findLanguageBoundaries(s,n),h=qt(i.column,this.getLanguageConfiguration(s.getLanguageId(n)).getWordDefinition(),e.substring(r,o),r);if(h&&h.startColumn<=t.column&&t.column<=h.endColumn)return h;if(n>0&&r===i.column-1){const[r,o]=tF._findLanguageBoundaries(s,n-1),h=qt(i.column,this.getLanguageConfiguration(s.getLanguageId(n-1)).getWordDefinition(),e.substring(r,o),r);if(h&&h.startColumn<=t.column&&t.column<=h.endColumn)return h}return null}getLanguageConfiguration(t){return this._languageConfigurationService.getLanguageConfiguration(t)}static _findLanguageBoundaries(t,i){const e=t.getLanguageId(i);let s=0;for(let n=i;n>=0&&t.getLanguageId(n)===e;n--)s=t.getStartOffset(n);let n=t.getLineContent().length;for(let s=i,r=t.getCount();s<r&&t.getLanguageId(s)===e;s++)n=t.getEndOffset(s);return[s,n]}getWordUntilPosition(t){const i=this.getWordAtPosition(t);return i?{word:i.word.substr(0,t.column-i.startColumn),startColumn:i.startColumn,endColumn:t.column}:{word:"",startColumn:t.column,endColumn:t.column}}getLanguageId(){return this._languageId}getLanguageIdAtPosition(t,i){const e=this._textModel.validatePosition(new ks(t,i)),s=this.getLineTokens(e.lineNumber);return s.getLanguageId(s.findTokenIndexAtOffset(e.column-1))}setLanguageId(t,i="api"){if(this._languageId===t)return;const e={oldLanguage:this._languageId,newLanguage:t,source:i};this._languageId=t,this._bracketPairsTextModelPart.handleDidChangeLanguage(e),this.grammarTokens.resetTokenization(),this._onDidChangeLanguage.fire(e),this._onDidChangeLanguageConfiguration.fire({})}}class iF extends Qi{get backgroundTokenizationState(){return this._backgroundTokenizationState}constructor(t,i,e,s){super(),this._languageIdCodec=t,this._textModel=i,this.getLanguageId=e,this._tokenizer=null,this._defaultBackgroundTokenizer=null,this._backgroundTokenizer=this._register(new Yi),this._tokens=new QL(this._languageIdCodec),this._debugBackgroundTokenizer=this._register(new Yi),this._backgroundTokenizationState=1,this._onDidChangeBackgroundTokenizationState=this._register(new le),this.onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event,this._onDidChangeTokens=this._register(new le),this.onDidChangeTokens=this._onDidChangeTokens.event,this._attachedViewStates=this._register(new ie),this._register(Us.onDidChange((t=>{const i=this.getLanguageId();t.changedLanguages.indexOf(i)!==-1&&this.resetTokenization()}))),this.resetTokenization(),this._register(s.onDidChangeVisibleRanges((({view:t,state:i})=>{if(i){let e=this._attachedViewStates.get(t);e||(e=new eF((()=>this.refreshRanges(e.lineRanges))),this._attachedViewStates.set(t,e)),e.handleStateChange(i)}else this._attachedViewStates.deleteAndDispose(t)})))}resetTokenization(t=!0){var i;this._tokens.flush(),(i=this._debugBackgroundTokens)===null||i===void 0||i.flush(),this._debugBackgroundStates&&(this._debugBackgroundStates=new VL(this._textModel.getLineCount())),t&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]});const[e,s]=(()=>{if(this._textModel.isTooLargeForTokenization())return[null,null];const t=Us.get(this.getLanguageId());if(!t)return[null,null];let i;try{i=t.getInitialState()}catch(t){return Ii(t),[null,null]}return[t,i]})();if(this._tokenizer=e&&s?new HL(this._textModel.getLineCount(),e,this._textModel,this._languageIdCodec):null,this._backgroundTokenizer.clear(),this._defaultBackgroundTokenizer=null,this._tokenizer){const t={setTokens:t=>{this.setTokens(t)},backgroundTokenizationFinished:()=>{this._backgroundTokenizationState!==2&&(this._backgroundTokenizationState=2,this._onDidChangeBackgroundTokenizationState.fire())},setEndState:(t,i)=>{var e;if(!this._tokenizer)return;const s=this._tokenizer.store.getFirstInvalidEndStateLineNumber();s!==null&&t>=s&&((e=this._tokenizer)===null||e===void 0||e.store.setEndState(t,i))}};e&&e.createBackgroundTokenizer&&!e.backgroundTokenizerShouldOnlyVerifyTokens&&(this._backgroundTokenizer.value=e.createBackgroundTokenizer(this._textModel,t)),this._backgroundTokenizer.value||this._textModel.isTooLargeForTokenization()||(this._backgroundTokenizer.value=this._defaultBackgroundTokenizer=new qL(this._tokenizer,t),this._defaultBackgroundTokenizer.handleChanges()),e!=null&&e.backgroundTokenizerShouldOnlyVerifyTokens&&e.createBackgroundTokenizer?(this._debugBackgroundTokens=new QL(this._languageIdCodec),this._debugBackgroundStates=new VL(this._textModel.getLineCount()),this._debugBackgroundTokenizer.clear(),this._debugBackgroundTokenizer.value=e.createBackgroundTokenizer(this._textModel,{setTokens:t=>{var i;(i=this._debugBackgroundTokens)===null||i===void 0||i.setMultilineTokens(t,this._textModel)},backgroundTokenizationFinished(){},setEndState:(t,i)=>{var e;(e=this._debugBackgroundStates)===null||e===void 0||e.setEndState(t,i)}})):(this._debugBackgroundTokens=void 0,this._debugBackgroundStates=void 0,this._debugBackgroundTokenizer.value=void 0)}this.refreshAllVisibleLineTokens()}handleDidChangeAttached(){var t;(t=this._defaultBackgroundTokenizer)===null||t===void 0||t.handleChanges()}handleDidChangeContent(t){var i,e,s;if(t.isFlush)this.resetTokenization(!1);else if(!t.isEolChange){for(const e of t.changes){const[t,s]=YE(e.text);this._tokens.acceptEdit(e.range,t,s),(i=this._debugBackgroundTokens)===null||i===void 0||i.acceptEdit(e.range,t,s)}(e=this._debugBackgroundStates)===null||e===void 0||e.acceptChanges(t.changes),this._tokenizer&&this._tokenizer.store.acceptChanges(t.changes),(s=this._defaultBackgroundTokenizer)===null||s===void 0||s.handleChanges()}}setTokens(t){const{changes:i}=this._tokens.setMultilineTokens(t,this._textModel);return i.length>0&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:i}),{changes:i}}refreshAllVisibleLineTokens(){const t=Ag.joinMany([...this._attachedViewStates].map((([t,i])=>i.lineRanges)));this.refreshRanges(t)}refreshRanges(t){for(const i of t)this.refreshRange(i.startLineNumber,i.endLineNumberExclusive-1)}refreshRange(t,i){var e,s;if(!this._tokenizer)return;t=Math.max(1,Math.min(this._textModel.getLineCount(),t)),i=Math.min(this._textModel.getLineCount(),i);const n=new WL,{heuristicTokens:r}=this._tokenizer.tokenizeHeuristically(n,t,i),o=this.setTokens(n.finalize());if(r)for(const t of o.changes)(e=this._backgroundTokenizer.value)===null||e===void 0||e.requestTokens(t.fromLineNumber,t.toLineNumber+1);(s=this._defaultBackgroundTokenizer)===null||s===void 0||s.checkFinished()}forceTokenization(t){var i,e;const s=new WL;(i=this._tokenizer)===null||i===void 0||i.updateTokensUntilLine(s,t),this.setTokens(s.finalize()),(e=this._defaultBackgroundTokenizer)===null||e===void 0||e.checkFinished()}hasAccurateTokensForLine(t){return!this._tokenizer||this._tokenizer.hasAccurateTokensForLine(t)}isCheapToTokenize(t){return!this._tokenizer||this._tokenizer.isCheapToTokenize(t)}tokenizeIfCheap(t){this.isCheapToTokenize(t)&&this.forceTokenization(t)}getLineTokens(t){var i;const e=this._textModel.getLineContent(t),s=this._tokens.getTokens(this._textModel.getLanguageId(),t-1,e);if(this._debugBackgroundTokens&&this._debugBackgroundStates&&this._tokenizer&&this._debugBackgroundStates.getFirstInvalidEndStateLineNumberOrMax()>t&&this._tokenizer.store.getFirstInvalidEndStateLineNumberOrMax()>t){const n=this._debugBackgroundTokens.getTokens(this._textModel.getLanguageId(),t-1,e);!s.equals(n)&&(!((i=this._debugBackgroundTokenizer.value)===null||i===void 0)&&i.reportMismatchingTokens)&&this._debugBackgroundTokenizer.value.reportMismatchingTokens(t)}return s}getTokenTypeIfInsertingCharacter(t,i,e){if(!this._tokenizer)return 0;const s=this._textModel.validatePosition(new ks(t,i));return this.forceTokenization(s.lineNumber),this._tokenizer.getTokenTypeIfInsertingCharacter(s,e)}tokenizeLineWithEdit(t,i,e){if(!this._tokenizer)return null;const s=this._textModel.validatePosition(t);return this.forceTokenization(s.lineNumber),this._tokenizer.tokenizeLineWithEdit(s,i,e)}get hasTokens(){return this._tokens.hasTokens}}class eF extends Qi{get lineRanges(){return this._lineRanges}constructor(t){super(),this._refreshTokens=t,this.runner=this._register(new Co((()=>this.update()),50)),this._computedLineRanges=[],this._lineRanges=[]}update(){n(this._computedLineRanges,this._lineRanges,((t,i)=>t.equals(i)))||(this._computedLineRanges=this._lineRanges,this._refreshTokens())}handleStateChange(t){this._lineRanges=t.visibleLineRanges,t.stabilized?(this.runner.cancel(),this.update()):this.runner.schedule()}}const sF=_l("undoRedoService");class nF{constructor(t,i){this.resource=t,this.elements=i}}class rF{constructor(){this.id=rF._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}}rF._ID=0,rF.None=new rF;class oF{constructor(){this.id=oF._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}}oF._ID=0,oF.None=new oF;var hF,cF=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},lF=function(t,i){return function(e,s){i(e,s,t)}};function aF(t,i){let e;var s;return typeof t=="string"?e=function(t){const i=new NL;return i.acceptChunk(t),i.finish()}(t):e=(s=t)&&typeof s.read=="function"?function(t){const i=new NL;let e;for(;typeof(e=t.read())=="string";)i.acceptChunk(e);return i.finish()}(t):t,e.create(i)}let uF=0;class dF{constructor(t){this._source=t,this._eos=!1}read(){if(this._eos)return null;const t=[];let i=0,e=0;for(;;){const s=this._source.read();if(s===null)return this._eos=!0,i===0?null:t.join("");if(s.length>0&&(t[i++]=s,e+=s.length),e>=65536)return t.join("")}}}const fF=()=>{throw new Error("Invalid change accessor")};let gF=hF=class extends Qi{static resolveOptions(t,i){if(i.detectIndentation){const e=HM(t,i.tabSize,i.insertSpaces);return new ig({tabSize:e.tabSize,indentSize:"tabSize",insertSpaces:e.insertSpaces,trimAutoWhitespace:i.trimAutoWhitespace,defaultEOL:i.defaultEOL,bracketPairColorizationOptions:i.bracketPairColorizationOptions})}return new ig(i)}get onDidChangeLanguage(){return this._tokenizationTextModelPart.onDidChangeLanguage}get onDidChangeLanguageConfiguration(){return this._tokenizationTextModelPart.onDidChangeLanguageConfiguration}get onDidChangeTokens(){return this._tokenizationTextModelPart.onDidChangeTokens}onDidChangeContent(t){return this._eventEmitter.slowEvent((i=>t(i.contentChangedEvent)))}onDidChangeContentOrInjectedText(t){return Gi(this._eventEmitter.fastEvent((i=>t(i))),this._onDidChangeInjectedText.event((i=>t(i))))}_isDisposing(){return this.__isDisposing}get tokenization(){return this._tokenizationTextModelPart}get bracketPairs(){return this._bracketPairs}get guides(){return this._guidesTextModelPart}constructor(t,i,e,s=null,n,r,o){super(),this._undoRedoService=n,this._languageService=r,this._languageConfigurationService=o,this._onWillDispose=this._register(new le),this.onWillDispose=this._onWillDispose.event,this._onDidChangeDecorations=this._register(new AF((t=>this.handleBeforeFireDecorationsChangedEvent(t)))),this.onDidChangeDecorations=this._onDidChangeDecorations.event,this._onDidChangeOptions=this._register(new le),this.onDidChangeOptions=this._onDidChangeOptions.event,this._onDidChangeAttached=this._register(new le),this.onDidChangeAttached=this._onDidChangeAttached.event,this._onDidChangeInjectedText=this._register(new le),this._eventEmitter=this._register(new MF),this._languageSelectionListener=this._register(new Yi),this._deltaDecorationCallCnt=0,this._attachedViews=new LF,uF++,this.id="$model"+uF,this.isForSimpleWidget=e.isForSimpleWidget,this._associatedResource=s??as.parse("inmemory://model/"+uF),this._attachedEditorCount=0;const{textBuffer:h,disposable:c}=aF(t,e.defaultEOL);this._buffer=h,this._bufferDisposable=c,this._options=hF.resolveOptions(this._buffer,e);const l=typeof i=="string"?i:i.languageId;typeof i!="string"&&(this._languageSelectionListener.value=i.onDidChange((()=>this._setLanguage(i.languageId)))),this._bracketPairs=this._register(new rM(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new DD(this,this._languageConfigurationService)),this._decorationProvider=this._register(new lM(this)),this._tokenizationTextModelPart=new tF(this._languageService,this._languageConfigurationService,this,this._bracketPairs,l,this._attachedViews);const a=this._buffer.getLineCount(),u=this._buffer.getValueLengthInRange(new Cs(1,1,a,this._buffer.getLineLength(a)+1),0);e.largeFileOptimizations?(this._isTooLargeForTokenization=u>hF.LARGE_FILE_SIZE_THRESHOLD||a>hF.LARGE_FILE_LINE_COUNT_THRESHOLD,this._isTooLargeForHeapOperation=u>hF.LARGE_FILE_HEAP_OPERATION_THRESHOLD):(this._isTooLargeForTokenization=!1,this._isTooLargeForHeapOperation=!1),this._isTooLargeForSyncing=u>hF._MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this.__isDisposing=!1,this._instanceId=Rr(uF),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new wF,this._commandManager=new $M(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._register(this._decorationProvider.onDidChange((()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()}))),this._languageService.requestRichLanguageFeatures(l)}dispose(){this.__isDisposing=!0,this._onWillDispose.fire(),this._tokenizationTextModelPart.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this.__isDisposing=!1;const t=new _L([],"",`\n`,!1,!1,!0,!0);t.dispose(),this._buffer=t,this._bufferDisposable=Qi.None}_assertNotDisposed(){if(this._isDisposed)throw new Error("Model is disposed!")}_emitContentChangedEvent(t,i){this.__isDisposing||(this._tokenizationTextModelPart.handleDidChangeContent(i),this._bracketPairs.handleDidChangeContent(i),this._eventEmitter.fire(new VE(t,i)))}setValue(t){if(this._assertNotDisposed(),t==null)throw Wi();const{textBuffer:i,disposable:e}=aF(t,this._options.defaultEOL);this._setValueFromTextBuffer(i,e)}_createContentChanged2(t,i,e,s,n,r,o,h){return{changes:[{range:t,rangeOffset:i,rangeLength:e,text:s}],eol:this._buffer.getEOL(),isEolChange:h,versionId:this.getVersionId(),isUndoing:n,isRedoing:r,isFlush:o}}_setValueFromTextBuffer(t,i){this._assertNotDisposed();const e=this.getFullModelRange(),s=this.getValueLengthInRange(e),n=this.getLineCount(),r=this.getLineMaxColumn(n);this._buffer=t,this._bufferDisposable.dispose(),this._bufferDisposable=i,this._increaseVersionId(),this._decorations=Object.create(null),this._decorationsTree=new wF,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new jE([new _E],this._versionId,!1,!1),this._createContentChanged2(new Cs(1,1,n,r),0,s,this.getValue(),!1,!1,!0,!1))}setEOL(t){this._assertNotDisposed();const i=t===1?`\r\n`:`\n`;if(this._buffer.getEOL()===i)return;const e=this.getFullModelRange(),s=this.getValueLengthInRange(e),n=this.getLineCount(),r=this.getLineMaxColumn(n);this._onBeforeEOLChange(),this._buffer.setEOL(i),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new jE([new WE],this._versionId,!1,!1),this._createContentChanged2(new Cs(1,1,n,r),0,s,this.getValue(),!1,!1,!1,!0))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){const t=this.getVersionId(),i=this._decorationsTree.collectNodesPostOrder();for(let e=0,s=i.length;e<s;e++){const s=i[e],n=s.range,r=s.cachedAbsoluteStart-s.start,o=this._buffer.getOffsetAt(n.startLineNumber,n.startColumn),h=this._buffer.getOffsetAt(n.endLineNumber,n.endColumn);s.cachedAbsoluteStart=o,s.cachedAbsoluteEnd=h,s.cachedVersionId=t,s.start=o-r,s.end=h-r,aL(s)}}onBeforeAttached(){return this._attachedEditorCount++,this._attachedEditorCount===1&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.attachView()}onBeforeDetached(t){this._attachedEditorCount--,this._attachedEditorCount===0&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.detachView(t)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isTooLargeForHeapOperation(){return this._isTooLargeForHeapOperation}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let t=0,i=0;const e=this._buffer.getLineCount();for(let s=1;s<=e;s++){const e=this._buffer.getLineLength(s);e>=1e4?i+=e:t+=e}return i>t}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(t){this._assertNotDisposed();const i=t.tabSize!==void 0?t.tabSize:this._options.tabSize,e=t.indentSize!==void 0?t.indentSize:this._options.originalIndentSize,s=t.insertSpaces!==void 0?t.insertSpaces:this._options.insertSpaces,n=t.trimAutoWhitespace!==void 0?t.trimAutoWhitespace:this._options.trimAutoWhitespace,r=t.bracketColorizationOptions!==void 0?t.bracketColorizationOptions:this._options.bracketPairColorizationOptions,o=new ig({tabSize:i,indentSize:e,insertSpaces:s,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:n,bracketPairColorizationOptions:r});if(this._options.equals(o))return;const h=this._options.createChangeEvent(o);this._options=o,this._bracketPairs.handleDidChangeOptions(h),this._decorationProvider.handleDidChangeOptions(h),this._onDidChangeOptions.fire(h)}detectIndentation(t,i){this._assertNotDisposed();const e=HM(this._buffer,i,t);this.updateOptions({insertSpaces:e.insertSpaces,tabSize:e.tabSize,indentSize:e.tabSize})}normalizeIndentation(t){return this._assertNotDisposed(),VS(t,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(t=null){const i=this.findMatches(Er.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(t,i.map((t=>({range:t.range,text:null}))),(()=>null))}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(t){this._assertNotDisposed();const i=this._validatePosition(t.lineNumber,t.column,0);return this._buffer.getOffsetAt(i.lineNumber,i.column)}getPositionAt(t){this._assertNotDisposed();const i=Math.min(this._buffer.getLength(),Math.max(0,t));return this._buffer.getPositionAt(i)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(t){this._versionId=t}_overwriteAlternativeVersionId(t){this._alternativeVersionId=t}_overwriteInitialUndoRedoSnapshot(t){this._initialUndoRedoSnapshot=t}getValue(t,i=!1){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new zi("Operation would exceed heap memory limits");const e=this.getFullModelRange(),s=this.getValueInRange(e,t);return i?this._buffer.getBOM()+s:s}createSnapshot(t=!1){return new dF(this._buffer.createSnapshot(t))}getValueLength(t,i=!1){this._assertNotDisposed();const e=this.getFullModelRange(),s=this.getValueLengthInRange(e,t);return i?this._buffer.getBOM().length+s:s}getValueInRange(t,i=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(t),i)}getValueLengthInRange(t,i=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(t),i)}getCharacterCountInRange(t,i=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(t),i)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new zi("Illegal value for lineNumber");return this._buffer.getLineContent(t)}getLineLength(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new zi("Illegal value for lineNumber");return this._buffer.getLineLength(t)}getLinesContent(){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new zi("Operation would exceed heap memory limits");return this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),this._buffer.getEOL()===`\n`?0:1}getLineMinColumn(t){return this._assertNotDisposed(),1}getLineMaxColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new zi("Illegal value for lineNumber");return this._buffer.getLineLength(t)+1}getLineFirstNonWhitespaceColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new zi("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(t)}getLineLastNonWhitespaceColumn(t){if(this._assertNotDisposed(),t<1||t>this.getLineCount())throw new zi("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(t)}_validateRangeRelaxedNoAllocations(t){const i=this._buffer.getLineCount(),e=t.startLineNumber,s=t.startColumn;let n=Math.floor(typeof e!="number"||isNaN(e)?1:e),r=Math.floor(typeof s!="number"||isNaN(s)?1:s);if(n<1)n=1,r=1;else if(n>i)n=i,r=this.getLineMaxColumn(n);else if(r<=1)r=1;else{const t=this.getLineMaxColumn(n);r>=t&&(r=t)}const o=t.endLineNumber,h=t.endColumn;let c=Math.floor(typeof o!="number"||isNaN(o)?1:o),l=Math.floor(typeof h!="number"||isNaN(h)?1:h);if(c<1)c=1,l=1;else if(c>i)c=i,l=this.getLineMaxColumn(c);else if(l<=1)l=1;else{const t=this.getLineMaxColumn(c);l>=t&&(l=t)}return e===n&&s===r&&o===c&&h===l&&t instanceof Cs&&!(t instanceof Ss)?t:new Cs(n,r,c,l)}_isValidPosition(t,i,e){return typeof t!="number"||typeof i!="number"||isNaN(t)||isNaN(i)||t<1||i<1||(0|t)!==t||(0|i)!==i||t>this._buffer.getLineCount()?!1:i===1?!0:!(i>this.getLineMaxColumn(t)||e===1&&gr(this._buffer.getLineCharCode(t,i-2)))}_validatePosition(t,i,e){const s=Math.floor(typeof t!="number"||isNaN(t)?1:t),n=Math.floor(typeof i!="number"||isNaN(i)?1:i),r=this._buffer.getLineCount();if(s<1)return new ks(1,1);if(s>r)return new ks(r,this.getLineMaxColumn(r));if(n<=1)return new ks(s,1);const o=this.getLineMaxColumn(s);return n>=o?new ks(s,o):e===1&&gr(this._buffer.getLineCharCode(s,n-2))?new ks(s,n-1):new ks(s,n)}validatePosition(t){return this._assertNotDisposed(),t instanceof ks&&this._isValidPosition(t.lineNumber,t.column,1)?t:this._validatePosition(t.lineNumber,t.column,1)}_isValidRange(t,i){const e=t.startLineNumber,s=t.startColumn,n=t.endLineNumber,r=t.endColumn;if(!this._isValidPosition(e,s,0)||!this._isValidPosition(n,r,0))return!1;if(i===1){const t=s>1?this._buffer.getLineCharCode(e,s-2):0,i=r>1&&r<=this._buffer.getLineLength(n)?this._buffer.getLineCharCode(n,r-2):0,o=gr(t),h=gr(i);return!o&&!h}return!0}validateRange(t){if(this._assertNotDisposed(),t instanceof Cs&&!(t instanceof Ss)&&this._isValidRange(t,1))return t;const i=this._validatePosition(t.startLineNumber,t.startColumn,0),e=this._validatePosition(t.endLineNumber,t.endColumn,0),s=i.lineNumber,n=i.column,r=e.lineNumber,o=e.column;{const t=n>1?this._buffer.getLineCharCode(s,n-2):0,i=o>1&&o<=this._buffer.getLineLength(r)?this._buffer.getLineCharCode(r,o-2):0,e=gr(t),h=gr(i);return e||h?s===r&&n===o?new Cs(s,n-1,r,o-1):e&&h?new Cs(s,n-1,r,o+1):e?new Cs(s,n-1,r,o):new Cs(s,n,r,o+1):new Cs(s,n,r,o)}}modifyPosition(t,i){this._assertNotDisposed();const e=this.getOffsetAt(t)+i;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,e)))}getFullModelRange(){this._assertNotDisposed();const t=this.getLineCount();return new Cs(1,1,t,this.getLineMaxColumn(t))}findMatchesLineByLine(t,i,e,s){return this._buffer.findMatchesLineByLine(t,i,e,s)}findMatches(t,i,e,s,n,r,o=999){this._assertNotDisposed();let h=null;i!==null&&(Array.isArray(i)||(i=[i]),i.every((t=>Cs.isIRange(t)))&&(h=i.map((t=>this.validateRange(t))))),h===null&&(h=[this.getFullModelRange()]),h=h.sort(((t,i)=>t.startLineNumber-i.startLineNumber||t.startColumn-i.startColumn));const c=[];let l;if(c.push(h.reduce(((t,i)=>Cs.areIntersecting(t,i)?t.plusRange(i):(c.push(t),i)))),!e&&t.indexOf(`\n`)<0){const i=new hg(t,e,s,n).parseSearchRequest();if(!i)return[];l=t=>this.findMatchesLineByLine(t,i,r,o)}else l=i=>ag.findMatches(this,new hg(t,e,s,n),i,r,o);return c.map(l).reduce(((t,i)=>t.concat(i)),[])}findNextMatch(t,i,e,s,n,r){this._assertNotDisposed();const o=this.validatePosition(i);if(!e&&t.indexOf(`\n`)<0){const i=new hg(t,e,s,n).parseSearchRequest();if(!i)return null;const h=this.getLineCount();let c=new Cs(o.lineNumber,o.column,h,this.getLineMaxColumn(h)),l=this.findMatchesLineByLine(c,i,r,1);return ag.findNextMatch(this,new hg(t,e,s,n),o,r),l.length>0?l[0]:(c=new Cs(1,1,o.lineNumber,this.getLineMaxColumn(o.lineNumber)),l=this.findMatchesLineByLine(c,i,r,1),l.length>0?l[0]:null)}return ag.findNextMatch(this,new hg(t,e,s,n),o,r)}findPreviousMatch(t,i,e,s,n,r){this._assertNotDisposed();const o=this.validatePosition(i);return ag.findPreviousMatch(this,new hg(t,e,s,n),o,r)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(t){if((this.getEOL()===`\n`?0:1)!==t)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(t)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(t){return t instanceof sg?t:new sg(t.identifier||null,this.validateRange(t.range),t.text,t.forceMoveMarkers||!1,t.isAutoWhitespaceEdit||!1,t._isTracked||!1)}_validateEditOperations(t){const i=[];for(let e=0,s=t.length;e<s;e++)i[e]=this._validateEditOperation(t[e]);return i}pushEditOperations(t,i,e,s){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(t,this._validateEditOperations(i),e,s)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(t,i,e,s){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){const e=i.map((t=>({range:this.validateRange(t.range),text:t.text})));let s=!0;if(t)for(let i=0,n=t.length;i<n;i++){const n=t[i];let r=!1;for(let t=0,i=e.length;t<i;t++){const i=e[t].range,s=i.startLineNumber>n.endLineNumber,o=n.startLineNumber>i.endLineNumber;if(!s&&!o){r=!0;break}}if(!r){s=!1;break}}if(s)for(let t=0,s=this._trimAutoWhitespaceLines.length;t<s;t++){const s=this._trimAutoWhitespaceLines[t],n=this.getLineMaxColumn(s);let r=!0;for(let t=0,i=e.length;t<i;t++){const i=e[t].range,o=e[t].text;if(!(s<i.startLineNumber||s>i.endLineNumber)&&!(s===i.startLineNumber&&i.startColumn===n&&i.isEmpty()&&o&&o.length>0&&o.charAt(0)===`\n`||s===i.startLineNumber&&i.startColumn===1&&i.isEmpty()&&o&&o.length>0&&o.charAt(o.length-1)===`\n`)){r=!1;break}}if(r){const t=new Cs(s,1,s,n);i.push(new sg(null,t,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(t,i,e,s)}_applyUndo(t,i,e,s){const n=t.map((t=>{const i=this.getPositionAt(t.newPosition),e=this.getPositionAt(t.newEnd);return{range:new Cs(i.lineNumber,i.column,e.lineNumber,e.column),text:t.oldText}}));this._applyUndoRedoEdits(n,i,!0,!1,e,s)}_applyRedo(t,i,e,s){const n=t.map((t=>{const i=this.getPositionAt(t.oldPosition),e=this.getPositionAt(t.oldEnd);return{range:new Cs(i.lineNumber,i.column,e.lineNumber,e.column),text:t.newText}}));this._applyUndoRedoEdits(n,i,!1,!0,e,s)}_applyUndoRedoEdits(t,i,e,s,n,r){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=e,this._isRedoing=s,this.applyEdits(t,!1),this.setEOL(i),this._overwriteAlternativeVersionId(n)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(r),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(t,i=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();const e=this._validateEditOperations(t);return this._doApplyEdits(e,i)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(t,i){const e=this._buffer.getLineCount(),s=this._buffer.applyEdits(t,this._options.trimAutoWhitespace,i),n=this._buffer.getLineCount(),r=s.changes;if(this._trimAutoWhitespaceLines=s.trimAutoWhitespaceLineNumbers,r.length!==0){for(let t=0,i=r.length;t<i;t++){const i=r[t];this._decorationsTree.acceptReplace(i.rangeOffset,i.rangeLength,i.text.length,i.forceMoveMarkers)}const t=[];this._increaseVersionId();let i=e;for(let e=0,s=r.length;e<s;e++){const s=r[e],[o]=YE(s.text);this._onDidChangeDecorations.fire();const h=s.range.startLineNumber,c=s.range.endLineNumber,l=c-h,a=o,u=Math.min(l,a),d=a-l,f=n-i-d+h,g=f,p=f+a,m=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new ks(g,1)),this.getOffsetAt(new ks(p,this.getLineMaxColumn(p))),0),w=PE.fromDecorations(m),v=new L(w);for(let i=u;i>=0;i--){const e=h+i,s=f+i;v.takeFromEndWhile((t=>t.lineNumber>s));const n=v.takeFromEndWhile((t=>t.lineNumber===s));t.push(new NE(e,this.getLineContent(s),n))}if(u<l){const i=h+u;t.push(new BE(i+1,c))}if(u<a){const e=new L(w),s=h+u,r=a-u,o=n-i-r+s+1,c=[],l=[];for(let t=0;t<r;t++){const i=o+t;l[t]=this.getLineContent(i),e.takeWhile((t=>t.lineNumber<i)),c[t]=e.takeWhile((t=>t.lineNumber===i))}t.push(new $E(s+1,h+a,l,c))}i+=d}this._emitContentChangedEvent(new jE(t,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:r,eol:this._buffer.getEOL(),isEolChange:!1,versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return s.reverseEdits===null?void 0:s.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(t){if(t===null||t.size===0)return;const i=Array.from(t).map((t=>new NE(t,this.getLineContent(t),this._getInjectedTextInLine(t))));this._onDidChangeInjectedText.fire(new HE(i))}changeDecorations(t,i=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(i,t)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(t,i){const e={addDecoration:(i,e)=>this._deltaDecorationsImpl(t,[],[{range:i,options:e}])[0],changeDecoration:(t,i)=>{this._changeDecorationImpl(t,i)},changeDecorationOptions:(t,i)=>{this._changeDecorationOptionsImpl(t,EF(i))},removeDecoration:i=>{this._deltaDecorationsImpl(t,[i],[])},deltaDecorations:(i,e)=>i.length===0&&e.length===0?[]:this._deltaDecorationsImpl(t,i,e)};let s=null;try{s=i(e)}catch(t){Ii(t)}return e.addDecoration=fF,e.changeDecoration=fF,e.changeDecorationOptions=fF,e.removeDecoration=fF,e.deltaDecorations=fF,s}deltaDecorations(t,i,e=0){if(this._assertNotDisposed(),t||(t=[]),t.length===0&&i.length===0)return[];try{return this._deltaDecorationCallCnt++,this._deltaDecorationCallCnt>1&&(console.warn("Invoking deltaDecorations recursively could lead to leaking decorations."),Ii(new Error("Invoking deltaDecorations recursively could lead to leaking decorations."))),this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(e,t,i)}finally{this._onDidChangeDecorations.endDeferredEmit(),this._deltaDecorationCallCnt--}}_getTrackedRange(t){return this.getDecorationRange(t)}_setTrackedRange(t,i,e){const s=t?this._decorations[t]:null;if(!s)return i?this._deltaDecorationsImpl(0,[],[{range:i,options:DF[e]}],!0)[0]:null;if(!i)return this._decorationsTree.delete(s),delete this._decorations[s.id],null;const n=this._validateRangeRelaxedNoAllocations(i),r=this._buffer.getOffsetAt(n.startLineNumber,n.startColumn),o=this._buffer.getOffsetAt(n.endLineNumber,n.endColumn);return this._decorationsTree.delete(s),s.reset(this.getVersionId(),r,o,n),s.setOptions(DF[e]),this._decorationsTree.insert(s),s.id}removeAllDecorationsWithOwnerId(t){if(this._isDisposed)return;const i=this._decorationsTree.collectNodesFromOwner(t);for(let t=0,e=i.length;t<e;t++){const e=i[t];this._decorationsTree.delete(e),delete this._decorations[e.id]}}getDecorationOptions(t){const i=this._decorations[t];return i?i.options:null}getDecorationRange(t){const i=this._decorations[t];return i?this._decorationsTree.getNodeRange(this,i):null}getLineDecorations(t,i=0,e=!1){return t<1||t>this.getLineCount()?[]:this.getLinesDecorations(t,t,i,e)}getLinesDecorations(t,i,e=0,s=!1,n=!1){const r=this.getLineCount(),o=Math.min(r,Math.max(1,t)),h=Math.min(r,Math.max(1,i)),c=this.getLineMaxColumn(h),l=new Cs(o,1,h,c),a=this._getDecorationsInRange(l,e,s,n);return y(a,this._decorationProvider.getDecorationsInRange(l,e,s)),a}getDecorationsInRange(t,i=0,e=!1,s=!1,n=!1){const r=this.validateRange(t),o=this._getDecorationsInRange(r,i,e,n);return y(o,this._decorationProvider.getDecorationsInRange(r,i,e,s)),o}getOverviewRulerDecorations(t=0,i=!1){return this._decorationsTree.getAll(this,t,i,!0,!1)}getInjectedTextDecorations(t=0){return this._decorationsTree.getAllInjectedText(this,t)}_getInjectedTextInLine(t){const i=this._buffer.getOffsetAt(t,1),e=i+this._buffer.getLineLength(t),s=this._decorationsTree.getInjectedTextInInterval(this,i,e,0);return PE.fromDecorations(s).filter((i=>i.lineNumber===t))}getAllDecorations(t=0,i=!1){let e=this._decorationsTree.getAll(this,t,i,!1,!1);return e=e.concat(this._decorationProvider.getAllDecorations(t,i)),e}getAllMarginDecorations(t=0){return this._decorationsTree.getAll(this,t,!1,!1,!0)}_getDecorationsInRange(t,i,e,s){const n=this._buffer.getOffsetAt(t.startLineNumber,t.startColumn),r=this._buffer.getOffsetAt(t.endLineNumber,t.endColumn);return this._decorationsTree.getAllInInterval(this,n,r,i,e,s)}getRangeAt(t,i){return this._buffer.getRangeAt(t,i-t)}_changeDecorationImpl(t,i){const e=this._decorations[t];if(!e)return;if(e.options.after){const i=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(i.endLineNumber)}if(e.options.before){const i=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(i.startLineNumber)}const s=this._validateRangeRelaxedNoAllocations(i),n=this._buffer.getOffsetAt(s.startLineNumber,s.startColumn),r=this._buffer.getOffsetAt(s.endLineNumber,s.endColumn);this._decorationsTree.delete(e),e.reset(this.getVersionId(),n,r,s),this._decorationsTree.insert(e),this._onDidChangeDecorations.checkAffectedAndFire(e.options),e.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(s.endLineNumber),e.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(s.startLineNumber)}_changeDecorationOptionsImpl(t,i){const e=this._decorations[t];if(!e)return;const s=!(!e.options.overviewRuler||!e.options.overviewRuler.color),n=!(!i.overviewRuler||!i.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(e.options),this._onDidChangeDecorations.checkAffectedAndFire(i),e.options.after||i.after){const t=this._decorationsTree.getNodeRange(this,e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(t.endLineNumber)}if(e.options.before||i.before){const t=this._decorationsTree.getNodeRange(this,e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(t.startLineNumber)}const r=s!==n,o=function(t){return!!t.after||!!t.before}(i)!==mF(e);r||o?(this._decorationsTree.delete(e),e.setOptions(i),this._decorationsTree.insert(e)):e.setOptions(i)}_deltaDecorationsImpl(t,i,e,s=!1){const n=this.getVersionId(),r=i.length;let o=0;const h=e.length;let c=0;this._onDidChangeDecorations.beginDeferredEmit();try{const l=new Array(h);for(;o<r||c<h;){let a=null;if(o<r){do{a=this._decorations[i[o++]]}while(!a&&o<r);if(a){if(a.options.after){const t=this._decorationsTree.getNodeRange(this,a);this._onDidChangeDecorations.recordLineAffectedByInjectedText(t.endLineNumber)}if(a.options.before){const t=this._decorationsTree.getNodeRange(this,a);this._onDidChangeDecorations.recordLineAffectedByInjectedText(t.startLineNumber)}this._decorationsTree.delete(a),s||this._onDidChangeDecorations.checkAffectedAndFire(a.options)}}if(c<h){if(!a){const t=++this._lastDecorationId,i=`${this._instanceId};${t}`;a=new XM(i,0,0),this._decorations[i]=a}const i=e[c],r=this._validateRangeRelaxedNoAllocations(i.range),o=EF(i.options),h=this._buffer.getOffsetAt(r.startLineNumber,r.startColumn),u=this._buffer.getOffsetAt(r.endLineNumber,r.endColumn);a.ownerId=t,a.reset(n,h,u,r),a.setOptions(o),a.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.endLineNumber),a.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.startLineNumber),s||this._onDidChangeDecorations.checkAffectedAndFire(o),this._decorationsTree.insert(a),l[c]=a.id,c++}else a&&delete this._decorations[a.id]}return l}finally{this._onDidChangeDecorations.endDeferredEmit()}}getLanguageId(){return this.tokenization.getLanguageId()}setLanguage(t,i){typeof t=="string"?(this._languageSelectionListener.clear(),this._setLanguage(t,i)):(this._languageSelectionListener.value=t.onDidChange((()=>this._setLanguage(t.languageId,i))),this._setLanguage(t.languageId,i))}_setLanguage(t,i){this.tokenization.setLanguageId(t,i),this._languageService.requestRichLanguageFeatures(t)}getLanguageIdAtPosition(t,i){return this.tokenization.getLanguageIdAtPosition(t,i)}getWordAtPosition(t){return this._tokenizationTextModelPart.getWordAtPosition(t)}getWordUntilPosition(t){return this._tokenizationTextModelPart.getWordUntilPosition(t)}normalizePosition(t,i){return t}getLineIndentColumn(t){return function(t){let i=0;for(const e of t){if(e!==" "&&e!=="\t")break;i++}return i}(this.getLineContent(t))+1}};function pF(t){return!(!t.options.overviewRuler||!t.options.overviewRuler.color)}function mF(t){return!!t.options.after||!!t.options.before}gF._MODEL_SYNC_LIMIT=52428800,gF.LARGE_FILE_SIZE_THRESHOLD=20971520,gF.LARGE_FILE_LINE_COUNT_THRESHOLD=3e5,gF.LARGE_FILE_HEAP_OPERATION_THRESHOLD=268435456,gF.DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:$t.tabSize,indentSize:$t.indentSize,insertSpaces:$t.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:$t.trimAutoWhitespace,largeFileOptimizations:$t.largeFileOptimizations,bracketPairColorizationOptions:$t.bracketPairColorizationOptions},gF=hF=cF([lF(4,sF),lF(5,Id),lF(6,cf)],gF);class wF{constructor(){this._decorationsTree0=new iL,this._decorationsTree1=new iL,this._injectedTextDecorationsTree=new iL}ensureAllNodesHaveRanges(t){this.getAll(t,0,!1,!1,!1)}_ensureNodesHaveRanges(t,i){for(const e of i)e.range===null&&(e.range=t.getRangeAt(e.cachedAbsoluteStart,e.cachedAbsoluteEnd));return i}getAllInInterval(t,i,e,s,n,r){const o=t.getVersionId(),h=this._intervalSearch(i,e,s,n,o,r);return this._ensureNodesHaveRanges(t,h)}_intervalSearch(t,i,e,s,n,r){const o=this._decorationsTree0.intervalSearch(t,i,e,s,n,r),h=this._decorationsTree1.intervalSearch(t,i,e,s,n,r),c=this._injectedTextDecorationsTree.intervalSearch(t,i,e,s,n,r);return o.concat(h).concat(c)}getInjectedTextInInterval(t,i,e,s){const n=t.getVersionId(),r=this._injectedTextDecorationsTree.intervalSearch(i,e,s,!1,n,!1);return this._ensureNodesHaveRanges(t,r).filter((t=>t.options.showIfCollapsed||!t.range.isEmpty()))}getAllInjectedText(t,i){const e=t.getVersionId(),s=this._injectedTextDecorationsTree.search(i,!1,e,!1);return this._ensureNodesHaveRanges(t,s).filter((t=>t.options.showIfCollapsed||!t.range.isEmpty()))}getAll(t,i,e,s,n){const r=t.getVersionId(),o=this._search(i,e,s,r,n);return this._ensureNodesHaveRanges(t,o)}_search(t,i,e,s,n){if(e)return this._decorationsTree1.search(t,i,s,n);{const e=this._decorationsTree0.search(t,i,s,n),r=this._decorationsTree1.search(t,i,s,n),o=this._injectedTextDecorationsTree.search(t,i,s,n);return e.concat(r).concat(o)}}collectNodesFromOwner(t){const i=this._decorationsTree0.collectNodesFromOwner(t),e=this._decorationsTree1.collectNodesFromOwner(t),s=this._injectedTextDecorationsTree.collectNodesFromOwner(t);return i.concat(e).concat(s)}collectNodesPostOrder(){const t=this._decorationsTree0.collectNodesPostOrder(),i=this._decorationsTree1.collectNodesPostOrder(),e=this._injectedTextDecorationsTree.collectNodesPostOrder();return t.concat(i).concat(e)}insert(t){mF(t)?this._injectedTextDecorationsTree.insert(t):pF(t)?this._decorationsTree1.insert(t):this._decorationsTree0.insert(t)}delete(t){mF(t)?this._injectedTextDecorationsTree.delete(t):pF(t)?this._decorationsTree1.delete(t):this._decorationsTree0.delete(t)}getNodeRange(t,i){const e=t.getVersionId();return i.cachedVersionId!==e&&this._resolveNode(i,e),i.range===null&&(i.range=t.getRangeAt(i.cachedAbsoluteStart,i.cachedAbsoluteEnd)),i.range}_resolveNode(t,i){mF(t)?this._injectedTextDecorationsTree.resolveNode(t,i):pF(t)?this._decorationsTree1.resolveNode(t,i):this._decorationsTree0.resolveNode(t,i)}acceptReplace(t,i,e,s){this._decorationsTree0.acceptReplace(t,i,e,s),this._decorationsTree1.acceptReplace(t,i,e,s),this._injectedTextDecorationsTree.acceptReplace(t,i,e,s)}}function vF(t){return t.replace(/[^a-z0-9\-_]/gi," ")}class bF{constructor(t){this.color=t.color||"",this.darkColor=t.darkColor||""}}class yF extends bF{constructor(t){super(t),this._resolvedColor=null,this.position=typeof t.position=="number"?t.position:Yf.Center}getColor(t){return this._resolvedColor||(t.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,t):this._resolvedColor=this._resolveColor(this.color,t)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(t,i){if(typeof t=="string")return t;const e=t?i.getColor(t.id):null;return e?e.toString():""}}class kF{constructor(t){var i;this.position=(i=t==null?void 0:t.position)!==null&&i!==void 0?i:Xf.Center,this.persistLane=t==null?void 0:t.persistLane}}class CF extends bF{constructor(t){var i,e;super(t),this.position=t.position,this.sectionHeaderStyle=(i=t.sectionHeaderStyle)!==null&&i!==void 0?i:null,this.sectionHeaderText=(e=t.sectionHeaderText)!==null&&e!==void 0?e:null}getColor(t){return this._resolvedColor||(t.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,t):this._resolvedColor=this._resolveColor(this.color,t)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(t,i){return typeof t=="string"?kp.fromHex(t):i.getColor(t.id)}}class SF{static from(t){return t instanceof SF?t:new SF(t)}constructor(t){this.content=t.content||"",this.inlineClassName=t.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=t.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=t.attachedData||null,this.cursorStops=t.cursorStops||null}}class xF{static register(t){return new xF(t)}static createDynamic(t){return new xF(t)}constructor(t){var i,e,s,n,r,o;this.description=t.description,this.blockClassName=t.blockClassName?vF(t.blockClassName):null,this.blockDoesNotCollapse=(i=t.blockDoesNotCollapse)!==null&&i!==void 0?i:null,this.blockIsAfterEnd=(e=t.blockIsAfterEnd)!==null&&e!==void 0?e:null,this.blockPadding=(s=t.blockPadding)!==null&&s!==void 0?s:null,this.stickiness=t.stickiness||0,this.zIndex=t.zIndex||0,this.className=t.className?vF(t.className):null,this.shouldFillLineOnLineBreak=(n=t.shouldFillLineOnLineBreak)!==null&&n!==void 0?n:null,this.hoverMessage=t.hoverMessage||null,this.glyphMarginHoverMessage=t.glyphMarginHoverMessage||null,this.lineNumberHoverMessage=t.lineNumberHoverMessage||null,this.isWholeLine=t.isWholeLine||!1,this.showIfCollapsed=t.showIfCollapsed||!1,this.collapseOnReplaceEdit=t.collapseOnReplaceEdit||!1,this.overviewRuler=t.overviewRuler?new yF(t.overviewRuler):null,this.minimap=t.minimap?new CF(t.minimap):null,this.glyphMargin=t.glyphMarginClassName?new kF(t.glyphMargin):null,this.glyphMarginClassName=t.glyphMarginClassName?vF(t.glyphMarginClassName):null,this.linesDecorationsClassName=t.linesDecorationsClassName?vF(t.linesDecorationsClassName):null,this.lineNumberClassName=t.lineNumberClassName?vF(t.lineNumberClassName):null,this.linesDecorationsTooltip=t.linesDecorationsTooltip?t.linesDecorationsTooltip.replace(/[<>"'&]/g,(t=>{switch(t){case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;";case"&":return"&amp;"}return t})):null,this.firstLineDecorationClassName=t.firstLineDecorationClassName?vF(t.firstLineDecorationClassName):null,this.marginClassName=t.marginClassName?vF(t.marginClassName):null,this.inlineClassName=t.inlineClassName?vF(t.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=t.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=t.beforeContentClassName?vF(t.beforeContentClassName):null,this.afterContentClassName=t.afterContentClassName?vF(t.afterContentClassName):null,this.after=t.after?SF.from(t.after):null,this.before=t.before?SF.from(t.before):null,this.hideInCommentTokens=(r=t.hideInCommentTokens)!==null&&r!==void 0&&r,this.hideInStringTokens=(o=t.hideInStringTokens)!==null&&o!==void 0&&o}}xF.EMPTY=xF.register({description:"empty"});const DF=[xF.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),xF.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),xF.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),xF.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function EF(t){return t instanceof xF?t:xF.createDynamic(t)}class AF extends Qi{constructor(t){super(),this.handleBeforeFire=t,this._actual=this._register(new le),this.event=this._actual.event,this._affectedInjectedTextLines=null,this._deferredCnt=0,this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._affectsLineNumber=!1}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){var t;this._deferredCnt--,this._deferredCnt===0&&(this._shouldFireDeferred&&this.doFire(),(t=this._affectedInjectedTextLines)===null||t===void 0||t.clear(),this._affectedInjectedTextLines=null)}recordLineAffectedByInjectedText(t){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(t)}checkAffectedAndFire(t){var i,e;this._affectsMinimap||(this._affectsMinimap=!!(!((i=t.minimap)===null||i===void 0)&&i.position)),this._affectsOverviewRuler||(this._affectsOverviewRuler=!!(!((e=t.overviewRuler)===null||e===void 0)&&e.color)),this._affectsGlyphMargin||(this._affectsGlyphMargin=!!t.glyphMarginClassName),this._affectsLineNumber||(this._affectsLineNumber=!!t.lineNumberClassName),this.tryFire()}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._affectsGlyphMargin=!0,this.tryFire()}tryFire(){this._deferredCnt===0?this.doFire():this._shouldFireDeferred=!0}doFire(){this.handleBeforeFire(this._affectedInjectedTextLines);const t={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler,affectsGlyphMargin:this._affectsGlyphMargin,affectsLineNumber:this._affectsLineNumber};this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._actual.fire(t)}}class MF extends Qi{constructor(){super(),this._fastEmitter=this._register(new le),this.fastEvent=this._fastEmitter.event,this._slowEmitter=this._register(new le),this.slowEvent=this._slowEmitter.event,this._deferredCnt=0,this._deferredEvent=null}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(t=null){if(this._deferredCnt--,this._deferredCnt===0&&this._deferredEvent!==null){this._deferredEvent.rawContentChangedEvent.resultingSelection=t;const i=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(i),this._slowEmitter.fire(i)}}fire(t){this._deferredCnt>0?this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(t):this._deferredEvent=t:(this._fastEmitter.fire(t),this._slowEmitter.fire(t))}}class LF{constructor(){this._onDidChangeVisibleRanges=new le,this.onDidChangeVisibleRanges=this._onDidChangeVisibleRanges.event,this._views=new Set}attachView(){const t=new FF((i=>{this._onDidChangeVisibleRanges.fire({view:t,state:i})}));return this._views.add(t),t}detachView(t){this._views.delete(t),this._onDidChangeVisibleRanges.fire({view:t,state:void 0})}}class FF{constructor(t){this.handleStateChange=t}setVisibleLines(t,i){const e=t.map((t=>new Ag(t.startLineNumber,t.endLineNumber+1)));this.handleStateChange({visibleLineRanges:e,stabilized:i})}}class TF{static create(t){return new TF(t.get(134),t.get(133))}constructor(t,i){this.classifier=new RF(t,i)}createLineBreaksComputer(t,i,e,s,n){const r=[],o=[],h=[];return{addRequest:(t,i,e)=>{r.push(t),o.push(i),h.push(e)},finalize:()=>{const c=t.typicalFullwidthCharacterWidth/t.typicalHalfwidthCharacterWidth,l=[];for(let t=0,a=r.length;t<a;t++){const a=o[t],u=h[t];!u||u.injectionOptions||a?l[t]=PF(this.classifier,r[t],a,i,e,c,s,n):l[t]=_F(this.classifier,u,r[t],i,e,c,s,n)}return OF.length=0,IF.length=0,l}}}}class RF extends Of{constructor(t,i){super(0);for(let i=0;i<t.length;i++)this.set(t.charCodeAt(i),1);for(let t=0;t<i.length;t++)this.set(i.charCodeAt(t),2)}get(t){return t>=0&&t<256?this._asciiMap[t]:t>=12352&&t<=12543||t>=13312&&t<=19903||t>=19968&&t<=40959?3:this._map.get(t)||this._defaultValue}}let OF=[],IF=[];function _F(t,i,e,s,n,r,o,h){if(n===-1)return null;const c=e.length;if(c<=1)return null;const l=h==="keepAll",a=i.breakOffsets,u=i.breakOffsetsVisibleColumn,d=WF(e,s,n,r,o),f=n-d,g=OF,p=IF;let m=0,w=0,v=0,b=n;const y=a.length;let k=0;if(k>=0){let t=Math.abs(u[k]-b);for(;k+1<y;){const i=Math.abs(u[k+1]-b);if(i>=t)break;t=i,k++}}for(;k<y;){let i=k<0?0:a[k],n=k<0?0:u[k];w>i&&(i=w,n=v);let o=0,h=0,d=0,C=0;if(n<=b){let v=n,y=i===0?0:e.charCodeAt(i-1),k=i===0?0:t.get(y),S=!0;for(let n=i;n<c;n++){const i=n,c=e.charCodeAt(n);let a,u;if(gr(c)?(n++,a=0,u=2):(a=t.get(c),u=NF(c,v,s,r)),i>w&&$F(y,k,c,a,l)&&(o=i,h=v),v+=u,v>b){i>w?(d=i,C=v-u):(d=n+1,C=v),v-h>f&&(o=0),S=!1;break}y=c,k=a}if(S){m>0&&(g[m]=a[a.length-1],p[m]=u[a.length-1],m++);break}}if(o===0){let c=n,a=e.charCodeAt(i),u=t.get(a),g=!1;for(let s=i-1;s>=w;s--){const i=s+1,n=e.charCodeAt(s);if(n===9){g=!0;break}let p,m;if(pr(n)?(s--,p=0,m=2):(p=t.get(n),m=Mr(n)?r:1),c<=b){if(d===0&&(d=i,C=c),c<=b-f)break;if($F(n,p,a,u,l)){o=i,h=c;break}}c-=m,a=n,u=p}if(o!==0){const t=f-(C-h);if(t<=s){const i=e.charCodeAt(d);let n;n=gr(i)?2:NF(i,C,s,r),t-n<0&&(o=0)}}if(g){k--;continue}}if(o===0&&(o=d,h=C),o<=w){const t=e.charCodeAt(w);gr(t)?(o=w+2,h=v+2):(o=w+1,h=v+NF(t,v,s,r))}for(w=o,g[m]=o,v=h,p[m]=h,m++,b=h+f;k<0||k<y&&u[k]<h;)k++;let S=Math.abs(u[k]-b);for(;k+1<y;){const t=Math.abs(u[k+1]-b);if(t>=S)break;S=t,k++}}return m===0?null:(g.length=m,p.length=m,OF=i.breakOffsets,IF=i.breakOffsetsVisibleColumn,i.breakOffsets=g,i.breakOffsetsVisibleColumn=p,i.wrappedTextIndentLength=d,i)}function PF(t,i,e,s,n,r,o,h){const c=PE.applyInjectedText(i,e);let l,a;if(e&&e.length>0?(l=e.map((t=>t.options)),a=e.map((t=>t.column-1))):(l=null,a=null),n===-1)return l?new TE(a,l,[c.length],[],0):null;const u=c.length;if(u<=1)return l?new TE(a,l,[c.length],[],0):null;const d=h==="keepAll",f=WF(c,s,n,r,o),g=n-f,p=[],m=[];let w=0,v=0,b=0,y=n,k=c.charCodeAt(0),C=t.get(k),S=NF(k,0,s,r),x=1;gr(k)&&(S+=1,k=c.charCodeAt(1),C=t.get(k),x++);for(let i=x;i<u;i++){const e=i,n=c.charCodeAt(i);let o,h;gr(n)?(i++,o=0,h=2):(o=t.get(n),h=NF(n,S,s,r)),$F(k,C,n,o,d)&&(v=e,b=S),S+=h,S>y&&((v===0||S-b>g)&&(v=e,b=S-h),p[w]=v,m[w]=b,w++,y=b+g,v=0),k=n,C=o}return w!==0||e&&e.length!==0?(p[w]=u,m[w]=S,new TE(a,l,p,m,f)):null}function NF(t,i,e,s){return t===9?e-i%e:Mr(t)||t<32?s:1}function BF(t,i){return i-t%i}function $F(t,i,e,s,n){return e!==32&&(i===2&&s!==2||i!==1&&s===1||!n&&i===3&&s!==2||!n&&s===3&&i!==1)}function WF(t,i,e,s,n){let r=0;if(n!==0){const o=tr(t);if(o!==-1){for(let e=0;e<o;e++)r+=t.charCodeAt(e)===9?BF(r,i):1;const h=n===3?2:n===2?1:0;for(let t=0;t<h;t++)r+=BF(r,i);r+s>e&&(r=0)}}return r}class jF{constructor(t){this._selTrackedRange=null,this._trackSelection=!0,this._setState(t,new QS(new Cs(1,1,1,1),0,0,new ks(1,1),0),new QS(new Cs(1,1,1,1),0,0,new ks(1,1),0))}dispose(t){this._removeTrackedRange(t)}startTrackingSelection(t){this._trackSelection=!0,this._updateTrackedRange(t)}stopTrackingSelection(t){this._trackSelection=!1,this._removeTrackedRange(t)}_updateTrackedRange(t){this._trackSelection&&(this._selTrackedRange=t.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(t){this._selTrackedRange=t.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new GS(this.modelState,this.viewState)}readSelectionFromMarkers(t){const i=t.model._getTrackedRange(this._selTrackedRange);return this.modelState.selection.isEmpty()&&!i.isEmpty()?Ss.fromRange(i.collapseToEnd(),this.modelState.selection.getDirection()):Ss.fromRange(i,this.modelState.selection.getDirection())}ensureValidState(t){this._setState(t,this.modelState,this.viewState)}setState(t,i,e){this._setState(t,i,e)}static _validatePositionWithCache(t,i,e,s){return i.equals(e)?s:t.normalizePosition(i,2)}static _validateViewState(t,i){const e=i.position,s=i.selectionStart.getStartPosition(),n=i.selectionStart.getEndPosition(),r=t.normalizePosition(e,2),o=this._validatePositionWithCache(t,s,e,r),h=this._validatePositionWithCache(t,n,s,o);return e.equals(r)&&s.equals(o)&&n.equals(h)?i:new QS(Cs.fromPositions(o,h),i.selectionStartKind,i.selectionStartLeftoverVisibleColumns+s.column-o.column,r,i.leftoverVisibleColumns+e.column-r.column)}_setState(t,i,e){if(e&&(e=jF._validateViewState(t.viewModel,e)),i){const e=t.model.validateRange(i.selectionStart),s=i.selectionStart.equalsRange(e)?i.selectionStartLeftoverVisibleColumns:0,n=t.model.validatePosition(i.position),r=i.position.equals(n)?i.leftoverVisibleColumns:0;i=new QS(e,i.selectionStartKind,s,n,r)}else{if(!e)return;const s=t.model.validateRange(t.coordinatesConverter.convertViewRangeToModelRange(e.selectionStart)),n=t.model.validatePosition(t.coordinatesConverter.convertViewPositionToModelPosition(e.position));i=new QS(s,e.selectionStartKind,e.selectionStartLeftoverVisibleColumns,n,e.leftoverVisibleColumns)}if(e){const s=t.coordinatesConverter.validateViewRange(e.selectionStart,i.selectionStart),n=t.coordinatesConverter.validateViewPosition(e.position,i.position);e=new QS(s,i.selectionStartKind,i.selectionStartLeftoverVisibleColumns,n,i.leftoverVisibleColumns)}else{const s=t.coordinatesConverter.convertModelPositionToViewPosition(new ks(i.selectionStart.startLineNumber,i.selectionStart.startColumn)),n=t.coordinatesConverter.convertModelPositionToViewPosition(new ks(i.selectionStart.endLineNumber,i.selectionStart.endColumn)),r=new Cs(s.lineNumber,s.column,n.lineNumber,n.column),o=t.coordinatesConverter.convertModelPositionToViewPosition(i.position);e=new QS(r,i.selectionStartKind,i.selectionStartLeftoverVisibleColumns,o,i.leftoverVisibleColumns)}this.modelState=i,this.viewState=e,this._updateTrackedRange(t)}}class HF{constructor(t){this.context=t,this.cursors=[new jF(t)],this.lastAddedCursorIndex=0}dispose(){for(const t of this.cursors)t.dispose(this.context)}startTrackingSelections(){for(const t of this.cursors)t.startTrackingSelection(this.context)}stopTrackingSelections(){for(const t of this.cursors)t.stopTrackingSelection(this.context)}updateContext(t){this.context=t}ensureValidState(){for(const t of this.cursors)t.ensureValidState(this.context)}readSelectionFromMarkers(){return this.cursors.map((t=>t.readSelectionFromMarkers(this.context)))}getAll(){return this.cursors.map((t=>t.asCursorState()))}getViewPositions(){return this.cursors.map((t=>t.viewState.position))}getTopMostViewPosition(){return function(t,i){return Dg(t,((t,e)=>-i(t,e)))}(this.cursors,D((t=>t.viewState.position),ks.compare)).viewState.position}getBottomMostViewPosition(){return function(t,i){if(t.length===0)return;let e=t[0];for(let s=1;s<t.length;s++){const n=t[s];i(n,e)>=0&&(e=n)}return e}(this.cursors,D((t=>t.viewState.position),ks.compare)).viewState.position}getSelections(){return this.cursors.map((t=>t.modelState.selection))}getViewSelections(){return this.cursors.map((t=>t.viewState.selection))}setSelections(t){this.setStates(GS.fromModelSelections(t))}getPrimaryCursor(){return this.cursors[0].asCursorState()}setStates(t){t!==null&&(this.cursors[0].setState(this.context,t[0].modelState,t[0].viewState),this._setSecondaryStates(t.slice(1)))}_setSecondaryStates(t){const i=this.cursors.length-1,e=t.length;if(i<e){const t=e-i;for(let i=0;i<t;i++)this._addSecondaryCursor()}else if(i>e){const t=i-e;for(let i=0;i<t;i++)this._removeSecondaryCursor(this.cursors.length-2)}for(let i=0;i<e;i++)this.cursors[i+1].setState(this.context,t[i].modelState,t[i].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.cursors.push(new jF(this.context)),this.lastAddedCursorIndex=this.cursors.length-1}getLastAddedCursorIndex(){return this.cursors.length===1||this.lastAddedCursorIndex===0?0:this.lastAddedCursorIndex}_removeSecondaryCursor(t){this.lastAddedCursorIndex>=t+1&&this.lastAddedCursorIndex--,this.cursors[t+1].dispose(this.context),this.cursors.splice(t+1,1)}normalize(){if(this.cursors.length===1)return;const t=this.cursors.slice(0),i=[];for(let e=0,s=t.length;e<s;e++)i.push({index:e,selection:t[e].modelState.selection});i.sort(D((t=>t.selection),Cs.compareRangesUsingStarts));for(let e=0;e<i.length-1;e++){const s=i[e],n=i[e+1],r=s.selection,o=n.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let h;if(h=o.isEmpty()||r.isEmpty()?o.getStartPosition().isBeforeOrEqual(r.getEndPosition()):o.getStartPosition().isBefore(r.getEndPosition()),h){const r=s.index<n.index?e:e+1,o=s.index<n.index?e+1:e,h=i[o].index,c=i[r].index,l=i[o].selection,a=i[r].selection;if(!l.equalsSelection(a)){const e=l.plusRange(a),s=l.selectionStartLineNumber===l.startLineNumber&&l.selectionStartColumn===l.startColumn,n=a.selectionStartLineNumber===a.startLineNumber&&a.selectionStartColumn===a.startColumn;let o,u;h===this.lastAddedCursorIndex?(o=s,this.lastAddedCursorIndex=c):o=n,u=o?new Ss(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new Ss(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn),i[r].selection=u;const d=GS.fromModelSelection(u);t[c].setState(this.context,d.modelState,d.viewState)}for(const t of i)t.index>h&&t.index--;t.splice(h,1),i.splice(o,1),this._removeSecondaryCursor(h-1),e--}}}}class VF{constructor(t,i,e,s){this._cursorContextBrand=void 0,this.model=t,this.viewModel=i,this.coordinatesConverter=e,this.cursorConfig=s}}class zF{constructor(){this.type=0}}class UF{constructor(){this.type=1}}class KF{constructor(t){this.type=2,this._source=t}hasChanged(t){return this._source.hasChanged(t)}}class qF{constructor(t,i,e){this.selections=t,this.modelSelections=i,this.reason=e,this.type=3}}class GF{constructor(t){this.type=4,t?(this.affectsMinimap=t.affectsMinimap,this.affectsOverviewRuler=t.affectsOverviewRuler,this.affectsGlyphMargin=t.affectsGlyphMargin,this.affectsLineNumber=t.affectsLineNumber):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0,this.affectsGlyphMargin=!0,this.affectsLineNumber=!0)}}class ZF{constructor(){this.type=5}}class JF{constructor(t){this.type=6,this.isFocused=t}}class QF{constructor(){this.type=7}}class YF{constructor(){this.type=8}}class XF{constructor(t,i){this.fromLineNumber=t,this.count=i,this.type=9}}class tT{constructor(t,i){this.type=10,this.fromLineNumber=t,this.toLineNumber=i}}class iT{constructor(t,i){this.type=11,this.fromLineNumber=t,this.toLineNumber=i}}class eT{constructor(t,i,e,s,n,r,o){this.source=t,this.minimalReveal=i,this.range=e,this.selections=s,this.verticalType=n,this.revealHorizontal=r,this.scrollType=o,this.type=12}}class sT{constructor(t){this.type=13,this.scrollWidth=t.scrollWidth,this.scrollLeft=t.scrollLeft,this.scrollHeight=t.scrollHeight,this.scrollTop=t.scrollTop,this.scrollWidthChanged=t.scrollWidthChanged,this.scrollLeftChanged=t.scrollLeftChanged,this.scrollHeightChanged=t.scrollHeightChanged,this.scrollTopChanged=t.scrollTopChanged}}class nT{constructor(t){this.theme=t,this.type=14}}class rT{constructor(t){this.type=15,this.ranges=t}}class oT{constructor(){this.type=16}}let hT=class{constructor(){this.type=17}};class cT extends Qi{constructor(){super(),this._onEvent=this._register(new le),this.onEvent=this._onEvent.event,this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(t){this._addOutgoingEvent(t),this._emitOutgoingEvents()}_addOutgoingEvent(t){for(let i=0,e=this._outgoingEvents.length;i<e;i++){const e=this._outgoingEvents[i].kind===t.kind?this._outgoingEvents[i].attemptToMerge(t):null;if(e)return void(this._outgoingEvents[i]=e)}this._outgoingEvents.push(t)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;const t=this._outgoingEvents.shift();t.isNoOp()||this._onEvent.fire(t)}}addViewEventHandler(t){for(let i=0,e=this._eventHandlers.length;i<e;i++)this._eventHandlers[i]===t&&console.warn("Detected duplicate listener in ViewEventDispatcher",t);this._eventHandlers.push(t)}removeViewEventHandler(t){for(let i=0;i<this._eventHandlers.length;i++)if(this._eventHandlers[i]===t){this._eventHandlers.splice(i,1);break}}beginEmitViewEvents(){return this._collectorCnt++,this._collectorCnt===1&&(this._collector=new lT),this._collector}endEmitViewEvents(){if(this._collectorCnt--,this._collectorCnt===0){const t=this._collector.outgoingEvents,i=this._collector.viewEvents;this._collector=null;for(const i of t)this._addOutgoingEvent(i);i.length>0&&this._emitMany(i)}this._emitOutgoingEvents()}emitSingleViewEvent(t){try{this.beginEmitViewEvents().emitViewEvent(t)}finally{this.endEmitViewEvents()}}_emitMany(t){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(t):this._viewEventQueue=t,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){const t=this._viewEventQueue;this._viewEventQueue=null;const i=this._eventHandlers.slice(0);for(const e of i)e.handleEvents(t)}}}class lT{constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(t){this.viewEvents.push(t)}emitOutgoingEvent(t){this.outgoingEvents.push(t)}}class aT{constructor(t,i,e,s){this.kind=0,this._oldContentWidth=t,this._oldContentHeight=i,this.contentWidth=e,this.contentHeight=s,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}attemptToMerge(t){return t.kind!==this.kind?null:new aT(this._oldContentWidth,this._oldContentHeight,t.contentWidth,t.contentHeight)}}class uT{constructor(t,i){this.kind=1,this.oldHasFocus=t,this.hasFocus=i}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(t){return t.kind!==this.kind?null:new uT(this.oldHasFocus,t.hasFocus)}}class dT{constructor(t,i,e,s,n,r,o,h){this.kind=2,this._oldScrollWidth=t,this._oldScrollLeft=i,this._oldScrollHeight=e,this._oldScrollTop=s,this.scrollWidth=n,this.scrollLeft=r,this.scrollHeight=o,this.scrollTop=h,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!(this.scrollWidthChanged||this.scrollLeftChanged||this.scrollHeightChanged||this.scrollTopChanged)}attemptToMerge(t){return t.kind!==this.kind?null:new dT(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,t.scrollWidth,t.scrollLeft,t.scrollHeight,t.scrollTop)}}class fT{constructor(){this.kind=3}isNoOp(){return!1}attemptToMerge(t){return t.kind!==this.kind?null:this}}class gT{constructor(){this.kind=4}isNoOp(){return!1}attemptToMerge(t){return t.kind!==this.kind?null:this}}class pT{constructor(t,i,e,s,n,r,o){this.kind=6,this.oldSelections=t,this.selections=i,this.oldModelVersionId=e,this.modelVersionId=s,this.source=n,this.reason=r,this.reachedMaxCursorCount=o}static _selectionsAreEqual(t,i){if(!t&&!i)return!0;if(!t||!i)return!1;const e=t.length;if(e!==i.length)return!1;for(let s=0;s<e;s++)if(!t[s].equalsSelection(i[s]))return!1;return!0}isNoOp(){return pT._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}attemptToMerge(t){return t.kind!==this.kind?null:new pT(this.oldSelections,t.selections,this.oldModelVersionId,t.modelVersionId,t.source,t.reason,this.reachedMaxCursorCount||t.reachedMaxCursorCount)}}class mT{constructor(){this.kind=5}isNoOp(){return!1}attemptToMerge(t){return t.kind!==this.kind?null:this}}class wT{constructor(t){this.event=t,this.kind=7}isNoOp(){return!1}attemptToMerge(t){return null}}class vT{constructor(t){this.event=t,this.kind=8}isNoOp(){return!1}attemptToMerge(t){return null}}class bT{constructor(t){this.event=t,this.kind=9}isNoOp(){return!1}attemptToMerge(t){return null}}class yT{constructor(t){this.event=t,this.kind=10}isNoOp(){return!1}attemptToMerge(t){return null}}class kT{constructor(t){this.event=t,this.kind=11}isNoOp(){return!1}attemptToMerge(t){return null}}class CT{constructor(t){this.event=t,this.kind=12}isNoOp(){return!1}attemptToMerge(t){return null}}class ST extends Qi{constructor(t,i,e,s){super(),this._model=t,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=i,this._coordinatesConverter=e,this.context=new VF(this._model,this._viewModel,this._coordinatesConverter,s),this._cursors=new HF(this.context),this._hasFocus=!1,this._isHandling=!1,this._compositionState=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=qi(this._autoClosedActions),super.dispose()}updateConfiguration(t){this.context=new VF(this._model,this._viewModel,this._coordinatesConverter,t),this._cursors.updateContext(this.context)}onLineMappingChanged(t){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(t,"viewModel",0,this.getCursorStates())}setHasFocus(t){this._hasFocus=t}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){const t=this._cursors.getSelections();for(let i=0;i<this._autoClosedActions.length;i++){const e=this._autoClosedActions[i];e.isValid(t)||(e.dispose(),this._autoClosedActions.splice(i,1),i--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(t,i,e,s){let n=!1;const r=this.context.cursorConfig.multiCursorLimit;s!==null&&s.length>r&&(s=s.slice(0,r),n=!0);const o=xT.from(this._model,this);return this._cursors.setStates(s),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,i,e,o,n)}setCursorColumnSelectData(t){this._columnSelectData=t}revealAll(t,i,e,s,n,r){const o=this._cursors.getViewPositions();let h=null,c=null;o.length>1?c=this._cursors.getViewSelections():h=Cs.fromPositions(o[0],o[0]),t.emitViewEvent(new eT(i,e,h,c,s,n,r))}revealPrimary(t,i,e,s,n,r){const o=[this._cursors.getPrimaryCursor().viewState.selection];t.emitViewEvent(new eT(i,e,null,o,s,n,r))}saveState(){const t=[],i=this._cursors.getSelections();for(let e=0,s=i.length;e<s;e++){const s=i[e];t.push({inSelectionMode:!s.isEmpty(),selectionStart:{lineNumber:s.selectionStartLineNumber,column:s.selectionStartColumn},position:{lineNumber:s.positionLineNumber,column:s.positionColumn}})}return t}restoreState(t,i){const e=[];for(let t=0,s=i.length;t<s;t++){const s=i[t];let n=1,r=1;s.position&&s.position.lineNumber&&(n=s.position.lineNumber),s.position&&s.position.column&&(r=s.position.column);let o=n,h=r;s.selectionStart&&s.selectionStart.lineNumber&&(o=s.selectionStart.lineNumber),s.selectionStart&&s.selectionStart.column&&(h=s.selectionStart.column),e.push({selectionStartLineNumber:o,selectionStartColumn:h,positionLineNumber:n,positionColumn:r})}this.setStates(t,"restoreState",0,GS.fromModelSelections(e)),this.revealAll(t,"restoreState",!1,0,!0,1)}onModelContentChanged(t,i){if(i instanceof HE){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(t,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{const e=i.rawContentChangedEvent;if(this._knownModelVersionId=e.versionId,this._isHandling)return;const s=e.containsEvent(1);if(this._prevEditOperationType=0,s)this._cursors.dispose(),this._cursors=new HF(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,"model",1,null,!1);else if(this._hasFocus&&e.resultingSelection&&e.resultingSelection.length>0){const i=GS.fromModelSelections(e.resultingSelection);this.setStates(t,"modelChange",e.isUndoing?5:e.isRedoing?6:2,i)&&this.revealAll(t,"modelChange",!1,0,!0,0)}else{const i=this._cursors.readSelectionFromMarkers();this.setStates(t,"modelChange",2,GS.fromModelSelections(i))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;const t=this._cursors.getPrimaryCursor(),i=t.viewState.selectionStart.getStartPosition(),e=t.viewState.position;return{isReal:!1,fromViewLineNumber:i.lineNumber,fromViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,i),toViewLineNumber:e.lineNumber,toViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,e)}}getSelections(){return this._cursors.getSelections()}setSelections(t,i,e,s){this.setStates(t,i,s,GS.fromModelSelections(e))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(t){this._prevEditOperationType=t}_pushAutoClosedAction(t,i){const e=[],s=[];for(let n=0,r=t.length;n<r;n++)e.push({range:t[n],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),s.push({range:i[n],options:{description:"auto-closed-enclosing",stickiness:1}});const n=this._model.deltaDecorations([],e),r=this._model.deltaDecorations([],s);this._autoClosedActions.push(new DT(this._model,n,r))}_executeEditOperation(t){if(!t)return;t.shouldPushStackElementBefore&&this._model.pushStackElement();const i=ET.executeCommands(this._model,this._cursors.getSelections(),t.commands);if(i){this._interpretCommandResult(i);const e=[],s=[];for(let i=0;i<t.commands.length;i++){const n=t.commands[i];n instanceof Ax&&n.enclosingRange&&n.closeCharacterRange&&(e.push(n.closeCharacterRange),s.push(n.enclosingRange))}e.length>0&&this._pushAutoClosedAction(e,s),this._prevEditOperationType=t.type}t.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(t){t&&t.length!==0||(t=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(t),this._cursors.normalize()}_emitStateChangedIfNecessary(t,i,e,s,n){const r=xT.from(this._model,this);if(r.equals(s))return!1;const o=this._cursors.getSelections(),h=this._cursors.getViewSelections();if(t.emitViewEvent(new qF(h,o,e)),!s||s.cursorState.length!==r.cursorState.length||r.cursorState.some(((t,i)=>!t.modelState.equals(s.cursorState[i].modelState)))){const h=s?s.cursorState.map((t=>t.modelState.selection)):null,c=s?s.modelVersionId:0;t.emitOutgoingEvent(new pT(h,o,c,r.modelVersionId,i||"keyboard",e,n))}return!0}_findAutoClosingPairs(t){if(!t.length)return null;const i=[];for(let e=0,s=t.length;e<s;e++){const s=t[e];if(!s.text||s.text.indexOf(`\n`)>=0)return null;const n=s.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!n)return null;const r=n[1],o=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(r);if(!o||o.length!==1)return null;const h=o[0].open,c=s.text.length-n[2].length-1,l=s.text.lastIndexOf(h,c-1);if(l===-1)return null;i.push([l,c])}return i}executeEdits(t,i,e,s){let n=null;i==="snippet"&&(n=this._findAutoClosingPairs(e)),n&&(e[0]._isTracked=!0);const r=[],o=[],h=this._model.pushEditOperations(this.getSelections(),e,(t=>{if(n)for(let i=0,e=n.length;i<e;i++){const[e,s]=n[i],h=t[i],c=h.range.startLineNumber,l=h.range.startColumn-1+e,a=h.range.startColumn-1+s;r.push(new Cs(c,a+1,c,a+2)),o.push(new Cs(c,l+1,c,a+2))}const i=s(t);return i&&(this._isHandling=!0),i}));h&&(this._isHandling=!1,this.setSelections(t,i,h,0)),r.length>0&&this._pushAutoClosedAction(r,o)}_executeEdit(t,i,e,s=0){if(this.context.cursorConfig.readOnly)return;const n=xT.from(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),t()}catch(t){Ii(t)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(i,e,s,n,!1)&&this.revealAll(i,e,!1,0,!0,0)}getAutoClosedCharacters(){return DT.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(t){this._compositionState=new MT(this._model,this.getSelections())}endComposition(t,i){const e=this._compositionState?this._compositionState.deduceOutcome(this._model,this.getSelections()):null;this._compositionState=null,this._executeEdit((()=>{i==="keyboard"&&this._executeEditOperation(Ex.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,e,this.getSelections(),this.getAutoClosedCharacters()))}),t,i)}type(t,i,e){this._executeEdit((()=>{if(e==="keyboard"){const t=i.length;let e=0;for(;e<t;){const t=yr(i,e),s=i.substr(e,t);this._executeEditOperation(Ex.typeWithInterceptors(!!this._compositionState,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),s)),e+=t}}else this._executeEditOperation(Ex.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),i))}),t,e)}compositionType(t,i,e,s,n,r){if(i.length!==0||e!==0||s!==0)this._executeEdit((()=>{this._executeEditOperation(Ex.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),i,e,s,n))}),t,r);else if(n!==0){const i=this.getSelections().map((t=>{const i=t.getPosition();return new Ss(i.lineNumber,i.column+n,i.lineNumber,i.column+n)}));this.setSelections(t,r,i,0)}}paste(t,i,e,s,n){this._executeEdit((()=>{this._executeEditOperation(Ex.paste(this.context.cursorConfig,this._model,this.getSelections(),i,e,s||[]))}),t,n,4)}cut(t,i){this._executeEdit((()=>{this._executeEditOperation(cx.cut(this.context.cursorConfig,this._model,this.getSelections()))}),t,i)}executeCommand(t,i,e){this._executeEdit((()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new YS(0,[i],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))}),t,e)}executeCommands(t,i,e){this._executeEdit((()=>{this._executeEditOperation(new YS(0,i,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))}),t,e)}}class xT{static from(t,i){return new xT(t.getVersionId(),i.getCursorStates())}constructor(t,i){this.modelVersionId=t,this.cursorState=i}equals(t){if(!t||this.modelVersionId!==t.modelVersionId||this.cursorState.length!==t.cursorState.length)return!1;for(let i=0,e=this.cursorState.length;i<e;i++)if(!this.cursorState[i].equals(t.cursorState[i]))return!1;return!0}}class DT{static getAllAutoClosedCharacters(t){let i=[];for(const e of t)i=i.concat(e.getAutoClosedCharactersRanges());return i}constructor(t,i,e){this._model=t,this._autoClosedCharactersDecorations=i,this._autoClosedEnclosingDecorations=e}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){const t=[];for(let i=0;i<this._autoClosedCharactersDecorations.length;i++){const e=this._model.getDecorationRange(this._autoClosedCharactersDecorations[i]);e&&t.push(e)}return t}isValid(t){const i=[];for(let t=0;t<this._autoClosedEnclosingDecorations.length;t++){const e=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[t]);if(e&&(i.push(e),e.startLineNumber!==e.endLineNumber))return!1}i.sort(Cs.compareRangesUsingStarts),t.sort(Cs.compareRangesUsingStarts);for(let e=0;e<t.length;e++)if(e>=i.length||!i[e].strictContainsRange(t[e]))return!1;return!0}}class ET{static executeCommands(t,i,e){const s={model:t,selectionsBefore:i,trackedRanges:[],trackedRangesDirection:[]},n=this._innerExecuteCommands(s,e);for(let t=0,i=s.trackedRanges.length;t<i;t++)s.model._setTrackedRange(s.trackedRanges[t],null,0);return n}static _innerExecuteCommands(t,i){if(this._arrayIsEmpty(i))return null;const e=this._getEditOperations(t,i);if(e.operations.length===0)return null;const s=e.operations,n=this._getLoserCursorMap(s);if(n.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;const r=[];for(let t=0,i=s.length;t<i;t++)n.hasOwnProperty(s[t].identifier.major.toString())||r.push(s[t]);e.hadTrackedEditOperation&&r.length>0&&(r[0]._isTracked=!0);let o=t.model.pushEditOperations(t.selectionsBefore,r,(e=>{const s=[];for(let i=0;i<t.selectionsBefore.length;i++)s[i]=[];for(const t of e)t.identifier&&s[t.identifier.major].push(t);const n=(t,i)=>t.identifier.minor-i.identifier.minor,r=[];for(let e=0;e<t.selectionsBefore.length;e++)s[e].length>0?(s[e].sort(n),r[e]=i[e].computeCursorState(t.model,{getInverseEditOperations:()=>s[e],getTrackedSelection:i=>{const e=parseInt(i,10),s=t.model._getTrackedRange(t.trackedRanges[e]);return t.trackedRangesDirection[e]===0?new Ss(s.startLineNumber,s.startColumn,s.endLineNumber,s.endColumn):new Ss(s.endLineNumber,s.endColumn,s.startLineNumber,s.startColumn)}})):r[e]=t.selectionsBefore[e];return r}));o||(o=t.selectionsBefore);const h=[];for(const t in n)n.hasOwnProperty(t)&&h.push(parseInt(t,10));h.sort(((t,i)=>i-t));for(const t of h)o.splice(t,1);return o}static _arrayIsEmpty(t){for(let i=0,e=t.length;i<e;i++)if(t[i])return!1;return!0}static _getEditOperations(t,i){let e=[],s=!1;for(let n=0,r=i.length;n<r;n++){const r=i[n];if(r){const i=this._getEditOperationsFromCommand(t,n,r);e=e.concat(i.operations),s=s||i.hadTrackedEditOperation}}return{operations:e,hadTrackedEditOperation:s}}static _getEditOperationsFromCommand(t,i,e){const s=[];let n=0;const r=(t,r,o=!1)=>{Cs.isEmpty(t)&&r===""||s.push({identifier:{major:i,minor:n++},range:t,text:r,forceMoveMarkers:o,isAutoWhitespaceEdit:e.insertsAutoWhitespace})};let o=!1;const h={addEditOperation:r,addTrackedEditOperation:(t,i,e)=>{o=!0,r(t,i,e)},trackSelection:(i,e)=>{const s=Ss.liftSelection(i);let n;if(s.isEmpty())if(typeof e=="boolean")n=e?2:3;else{const i=t.model.getLineMaxColumn(s.startLineNumber);n=s.startColumn===i?2:3}else n=1;const r=t.trackedRanges.length,o=t.model._setTrackedRange(null,s,n);return t.trackedRanges[r]=o,t.trackedRangesDirection[r]=s.getDirection(),r.toString()}};try{e.getEditOperations(t.model,h)}catch(t){return Ii(t),{operations:[],hadTrackedEditOperation:!1}}return{operations:s,hadTrackedEditOperation:o}}static _getLoserCursorMap(t){(t=t.slice(0)).sort(((t,i)=>-Cs.compareRangesUsingEnds(t.range,i.range)));const i={};for(let e=1;e<t.length;e++){const s=t[e-1],n=t[e];if(Cs.getStartPosition(s.range).isBefore(Cs.getEndPosition(n.range))){let r;r=s.identifier.major>n.identifier.major?s.identifier.major:n.identifier.major,i[r.toString()]=!0;for(let i=0;i<t.length;i++)t[i].identifier.major===r&&(t.splice(i,1),i<e&&e--,i--);e>0&&e--}}return i}}class AT{constructor(t,i,e){this.text=t,this.startSelection=i,this.endSelection=e}}class MT{static _capture(t,i){const e=[];for(const s of i){if(s.startLineNumber!==s.endLineNumber)return null;e.push(new AT(t.getLineContent(s.startLineNumber),s.startColumn-1,s.endColumn-1))}return e}constructor(t,i){this._original=MT._capture(t,i)}deduceOutcome(t,i){if(!this._original)return null;const e=MT._capture(t,i);if(!e||this._original.length!==e.length)return null;const s=[];for(let t=0,i=this._original.length;t<i;t++)s.push(MT._deduceOutcome(this._original[t],e[t]));return s}static _deduceOutcome(t,i){const e=Math.min(t.startSelection,i.startSelection,dr(t.text,i.text)),s=Math.min(t.text.length-t.endSelection,i.text.length-i.endSelection,fr(t.text,i.text)),n=t.text.substring(e,t.text.length-s),r=i.text.substring(e,i.text.length-s);return new Mx(n,t.startSelection-e,t.endSelection-e,r,i.startSelection-e,i.endSelection-e)}}const LT={getInitialState:()=>Xp,tokenizeEncoded:(t,i,e)=>im(0,e)};function FT(t,i,e,s,n,r,o){let h="<div>",c=s,l=0,a=!0;for(let u=0,d=i.getCount();u<d;u++){const d=i.getEndOffset(u);if(d<=s)continue;let f="";for(;c<d&&c<n;c++){const i=t.charCodeAt(c);switch(i){case 9:{let t=r-(c+l)%r;for(l+=t-1;t>0;)o&&a?(f+="&#160;",a=!1):(f+=" ",a=!0),t--;break}case 60:f+="&lt;",a=!1;break;case 62:f+="&gt;",a=!1;break;case 38:f+="&amp;",a=!1;break;case 0:f+="&#00;",a=!1;break;case 65279:case 8232:case 8233:case 133:f+="�",a=!1;break;case 13:f+="&#8203",a=!1;break;case 32:o&&a?(f+="&#160;",a=!1):(f+=" ",a=!0);break;default:f+=String.fromCharCode(i),a=!1}}if(h+=`<span style="${i.getInlineStyle(u,e)}">${f}</span>`,d>n||c>=n)break}return h+="</div>",h}function TT(t,i,e){let s='<div class="monaco-tokenized-source">';const n=Xn(t);let r=e.getInitialState();for(let t=0,o=n.length;t<o;t++){const o=n[t];t>0&&(s+="<br/>");const h=e.tokenizeEncoded(o,!0,r);sm.convertToEndOffset(h.tokens,o.length);const c=new sm(h.tokens,o,i).inflate();let l=0;for(let t=0,i=c.getCount();t<i;t++){const i=c.getClassName(t),e=c.getEndOffset(t);s+=`<span class="${i}">${qn(o.substring(l,e))}</span>`,l=e}r=h.endState}return s+="</div>",s}class RT{constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(t){this._hasPending=!0,this._inserts.push(t)}change(t){this._hasPending=!0,this._changes.push(t)}remove(t){this._hasPending=!0,this._removes.push(t)}mustCommit(){return this._hasPending}commit(t){if(!this._hasPending)return;const i=this._inserts,e=this._changes,s=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],t._commitPendingChanges(i,e,s)}}class OT{constructor(t,i,e,s,n){this.id=t,this.afterLineNumber=i,this.ordinal=e,this.height=s,this.minWidth=n,this.prefixSum=0}}let IT=class t{constructor(i,e,s,n){this._instanceId=Rr(++t.INSTANCE_COUNT),this._pendingChanges=new RT,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=i,this._lineHeight=e,this._paddingTop=s,this._paddingBottom=n}static findInsertionIndex(t,i,e){let s=0,n=t.length;for(;s<n;){const r=s+n>>>1;i===t[r].afterLineNumber?e<t[r].ordinal?n=r:s=r+1:i<t[r].afterLineNumber?n=r:s=r+1}return s}setLineHeight(t){this._checkPendingChanges(),this._lineHeight=t}setPadding(t,i){this._paddingTop=t,this._paddingBottom=i}onFlushed(t){this._checkPendingChanges(),this._lineCount=t}changeWhitespace(t){let i=!1;try{t({insertWhitespace:(t,e,s,n)=>{i=!0,t|=0,e|=0,s|=0,n|=0;const r=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new OT(r,t,e,s,n)),r},changeOneWhitespace:(t,e,s)=>{i=!0,e|=0,s|=0,this._pendingChanges.change({id:t,newAfterLineNumber:e,newHeight:s})},removeWhitespace:t=>{i=!0,this._pendingChanges.remove({id:t})}})}finally{this._pendingChanges.commit(this)}return i}_commitPendingChanges(t,i,e){if((t.length>0||e.length>0)&&(this._minWidth=-1),t.length+i.length+e.length<=1){for(const i of t)this._insertWhitespace(i);for(const t of i)this._changeOneWhitespace(t.id,t.newAfterLineNumber,t.newHeight);for(const t of e){const i=this._findWhitespaceIndex(t.id);i!==-1&&this._removeWhitespace(i)}return}const s=new Set;for(const t of e)s.add(t.id);const n=new Map;for(const t of i)n.set(t.id,t);const r=t=>{const i=[];for(const e of t)if(!s.has(e.id)){if(n.has(e.id)){const t=n.get(e.id);e.afterLineNumber=t.newAfterLineNumber,e.height=t.newHeight}i.push(e)}return i},o=r(this._arr).concat(r(t));o.sort(((t,i)=>t.afterLineNumber===i.afterLineNumber?t.ordinal-i.ordinal:t.afterLineNumber-i.afterLineNumber)),this._arr=o,this._prefixSumValidIndex=-1}_checkPendingChanges(){this._pendingChanges.mustCommit()&&this._pendingChanges.commit(this)}_insertWhitespace(i){const e=t.findInsertionIndex(this._arr,i.afterLineNumber,i.ordinal);this._arr.splice(e,0,i),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1)}_findWhitespaceIndex(t){const i=this._arr;for(let e=0,s=i.length;e<s;e++)if(i[e].id===t)return e;return-1}_changeOneWhitespace(t,i,e){const s=this._findWhitespaceIndex(t);if(s!==-1&&(this._arr[s].height!==e&&(this._arr[s].height=e,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,s-1)),this._arr[s].afterLineNumber!==i)){const t=this._arr[s];this._removeWhitespace(s),t.afterLineNumber=i,this._insertWhitespace(t)}}_removeWhitespace(t){this._arr.splice(t,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,t-1)}onLinesDeleted(t,i){this._checkPendingChanges(),t|=0,i|=0,this._lineCount-=i-t+1;for(let e=0,s=this._arr.length;e<s;e++){const s=this._arr[e].afterLineNumber;t<=s&&s<=i?this._arr[e].afterLineNumber=t-1:s>i&&(this._arr[e].afterLineNumber-=i-t+1)}}onLinesInserted(t,i){this._checkPendingChanges(),t|=0,i|=0,this._lineCount+=i-t+1;for(let e=0,s=this._arr.length;e<s;e++)t<=this._arr[e].afterLineNumber&&(this._arr[e].afterLineNumber+=i-t+1)}getWhitespacesTotalHeight(){return this._checkPendingChanges(),this._arr.length===0?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(t){this._checkPendingChanges(),t|=0;let i=Math.max(0,this._prefixSumValidIndex+1);i===0&&(this._arr[0].prefixSum=this._arr[0].height,i++);for(let e=i;e<=t;e++)this._arr[e].prefixSum=this._arr[e-1].prefixSum+this._arr[e].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,t),this._arr[t].prefixSum}getLinesTotalHeight(){return this._checkPendingChanges(),this._lineHeight*this._lineCount+this.getWhitespacesTotalHeight()+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(t){this._checkPendingChanges(),t|=0;const i=this._findLastWhitespaceBeforeLineNumber(t);return i===-1?0:this.getWhitespacesAccumulatedHeight(i)}_findLastWhitespaceBeforeLineNumber(t){t|=0;const i=this._arr;let e=0,s=i.length-1;for(;e<=s;){const n=e+((s-e|0)/2|0)|0;if(i[n].afterLineNumber<t){if(n+1>=i.length||i[n+1].afterLineNumber>=t)return n;e=n+1|0}else s=n-1|0}return-1}_findFirstWhitespaceAfterLineNumber(t){t|=0;const i=this._findLastWhitespaceBeforeLineNumber(t)+1;return i<this._arr.length?i:-1}getFirstWhitespaceIndexAfterLineNumber(t){return this._checkPendingChanges(),t|=0,this._findFirstWhitespaceAfterLineNumber(t)}getVerticalOffsetForLineNumber(t,i=!1){let e;return this._checkPendingChanges(),e=(t|=0)>1?this._lineHeight*(t-1):0,e+this.getWhitespaceAccumulatedHeightBeforeLineNumber(t-(i?1:0))+this._paddingTop}getVerticalOffsetAfterLineNumber(t,i=!1){return this._checkPendingChanges(),t|=0,this._lineHeight*t+this.getWhitespaceAccumulatedHeightBeforeLineNumber(t+(i?1:0))+this._paddingTop}getWhitespaceMinWidth(){if(this._checkPendingChanges(),this._minWidth===-1){let t=0;for(let i=0,e=this._arr.length;i<e;i++)t=Math.max(t,this._arr[i].minWidth);this._minWidth=t}return this._minWidth}isAfterLines(t){return this._checkPendingChanges(),t>this.getLinesTotalHeight()}isInTopPadding(t){return this._paddingTop!==0&&(this._checkPendingChanges(),t<this._paddingTop)}isInBottomPadding(t){return this._paddingBottom===0?!1:(this._checkPendingChanges(),t>=this.getLinesTotalHeight()-this._paddingBottom)}getLineNumberAtOrAfterVerticalOffset(t){if(this._checkPendingChanges(),(t|=0)<0)return 1;const i=0|this._lineCount,e=this._lineHeight;let s=1,n=i;for(;s<n;){const i=(s+n)/2|0,r=0|this.getVerticalOffsetForLineNumber(i);if(t>=r+e)s=i+1;else{if(t>=r)return i;n=i}}return s>i?i:s}getLinesViewportData(t,i){this._checkPendingChanges(),t|=0,i|=0;const e=this._lineHeight,s=0|this.getLineNumberAtOrAfterVerticalOffset(t),n=0|this.getVerticalOffsetForLineNumber(s);let r=0|this._lineCount,o=0|this.getFirstWhitespaceIndexAfterLineNumber(s);const h=0|this.getWhitespacesCount();let c,l;o===-1?(o=h,l=r+1,c=0):(l=0|this.getAfterLineNumberForWhitespaceIndex(o),c=0|this.getHeightForWhitespaceIndex(o));let a=n,u=a;const d=5e5;let f=0;n>=d&&(f=Math.floor(n/d)*d,f=Math.floor(f/e)*e,u-=f);const g=[],p=t+(i-t)/2;let m=-1;for(let t=s;t<=r;t++){for(m===-1&&(a<=p&&p<a+e||a>p)&&(m=t),a+=e,g[t-s]=u,u+=e;l===t;)u+=c,a+=c,o++,o>=h?l=r+1:(l=0|this.getAfterLineNumberForWhitespaceIndex(o),c=0|this.getHeightForWhitespaceIndex(o));if(a>=i){r=t;break}}m===-1&&(m=r);const w=0|this.getVerticalOffsetForLineNumber(r);let v=s,b=r;return v<b&&n<t&&v++,v<b&&w+e>i&&b--,{bigNumbersDelta:f,startLineNumber:s,endLineNumber:r,relativeVerticalOffset:g,centeredLineNumber:m,completelyVisibleStartLineNumber:v,completelyVisibleEndLineNumber:b,lineHeight:this._lineHeight}}getVerticalOffsetForWhitespaceIndex(t){this._checkPendingChanges(),t|=0;const i=this.getAfterLineNumberForWhitespaceIndex(t);let e,s;return e=i>=1?this._lineHeight*i:0,s=t>0?this.getWhitespacesAccumulatedHeight(t-1):0,e+s+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(t){this._checkPendingChanges(),t|=0;let i=0,e=this.getWhitespacesCount()-1;if(e<0||t>=this.getVerticalOffsetForWhitespaceIndex(e)+this.getHeightForWhitespaceIndex(e))return-1;for(;i<e;){const s=Math.floor((i+e)/2),n=this.getVerticalOffsetForWhitespaceIndex(s);if(t>=n+this.getHeightForWhitespaceIndex(s))i=s+1;else{if(t>=n)return s;e=s}}return i}getWhitespaceAtVerticalOffset(t){this._checkPendingChanges(),t|=0;const i=this.getWhitespaceIndexAtOrAfterVerticallOffset(t);if(i<0||i>=this.getWhitespacesCount())return null;const e=this.getVerticalOffsetForWhitespaceIndex(i);if(e>t)return null;const s=this.getHeightForWhitespaceIndex(i);return{id:this.getIdForWhitespaceIndex(i),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(i),verticalOffset:e,height:s}}getWhitespaceViewportData(t,i){this._checkPendingChanges(),t|=0,i|=0;const e=this.getWhitespaceIndexAtOrAfterVerticallOffset(t),s=this.getWhitespacesCount()-1;if(e<0)return[];const n=[];for(let t=e;t<=s;t++){const e=this.getVerticalOffsetForWhitespaceIndex(t),s=this.getHeightForWhitespaceIndex(t);if(e>=i)break;n.push({id:this.getIdForWhitespaceIndex(t),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(t),verticalOffset:e,height:s})}return n}getWhitespaces(){return this._checkPendingChanges(),this._arr.slice(0)}getWhitespacesCount(){return this._checkPendingChanges(),this._arr.length}getIdForWhitespaceIndex(t){return this._checkPendingChanges(),t|=0,this._arr[t].id}getAfterLineNumberForWhitespaceIndex(t){return this._checkPendingChanges(),t|=0,this._arr[t].afterLineNumber}getHeightForWhitespaceIndex(t){return this._checkPendingChanges(),t|=0,this._arr[t].height}};IT.INSTANCE_COUNT=0;class _T{constructor(t,i,e,s){(t|=0)<0&&(t=0),(i|=0)<0&&(i=0),(e|=0)<0&&(e=0),(s|=0)<0&&(s=0),this.width=t,this.contentWidth=i,this.scrollWidth=Math.max(t,i),this.height=e,this.contentHeight=s,this.scrollHeight=Math.max(e,s)}equals(t){return this.width===t.width&&this.contentWidth===t.contentWidth&&this.height===t.height&&this.contentHeight===t.contentHeight}}class PT extends Qi{constructor(t,i){super(),this._onDidContentSizeChange=this._register(new le),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._dimensions=new _T(0,0,0,0),this._scrollable=this._register(new Jk({forceIntegerValues:!0,smoothScrollDuration:t,scheduleAtNextAnimationFrame:i})),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(t){this._scrollable.setSmoothScrollDuration(t)}validateScrollPosition(t){return this._scrollable.validateScrollPosition(t)}getScrollDimensions(){return this._dimensions}setScrollDimensions(t){if(this._dimensions.equals(t))return;const i=this._dimensions;this._dimensions=t,this._scrollable.setScrollDimensions({width:t.width,scrollWidth:t.scrollWidth,height:t.height,scrollHeight:t.scrollHeight},!0);const e=i.contentWidth!==t.contentWidth,s=i.contentHeight!==t.contentHeight;(e||s)&&this._onDidContentSizeChange.fire(new aT(i.contentWidth,i.contentHeight,t.contentWidth,t.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(t){this._scrollable.setScrollPositionNow(t)}setScrollPositionSmooth(t){this._scrollable.setScrollPositionSmooth(t)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}}class NT extends Qi{constructor(t,i,e){super(),this._configuration=t;const s=this._configuration.options,n=s.get(145),r=s.get(84);this._linesLayout=new IT(i,s.get(67),r.top,r.bottom),this._maxLineWidth=0,this._overlayWidgetsMinWidth=0,this._scrollable=this._register(new PT(0,e)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new _T(n.contentWidth,0,n.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(114)?125:0)}onConfigurationChanged(t){const i=this._configuration.options;if(t.hasChanged(67)&&this._linesLayout.setLineHeight(i.get(67)),t.hasChanged(84)){const t=i.get(84);this._linesLayout.setPadding(t.top,t.bottom)}if(t.hasChanged(145)){const t=i.get(145),e=t.contentWidth,s=t.height,n=this._scrollable.getScrollDimensions(),r=n.contentWidth;this._scrollable.setScrollDimensions(new _T(e,n.contentWidth,s,this._getContentHeight(e,s,r)))}else this._updateHeight();t.hasChanged(114)&&this._configureSmoothScrollDuration()}onFlushed(t){this._linesLayout.onFlushed(t)}onLinesDeleted(t,i){this._linesLayout.onLinesDeleted(t,i)}onLinesInserted(t,i){this._linesLayout.onLinesInserted(t,i)}_getHorizontalScrollbarHeight(t,i){const e=this._configuration.options.get(103);return e.horizontal===2||t>=i?0:e.horizontalScrollbarSize}_getContentHeight(t,i,e){const s=this._configuration.options;let n=this._linesLayout.getLinesTotalHeight();return s.get(105)?n+=Math.max(0,i-s.get(67)-s.get(84).bottom):s.get(103).ignoreHorizontalScrollbarInContentHeight||(n+=this._getHorizontalScrollbarHeight(t,e)),n}_updateHeight(){const t=this._scrollable.getScrollDimensions(),i=t.width,e=t.height,s=t.contentWidth;this._scrollable.setScrollDimensions(new _T(i,t.contentWidth,e,this._getContentHeight(i,e,s)))}getCurrentViewport(){const t=this._scrollable.getScrollDimensions(),i=this._scrollable.getCurrentScrollPosition();return new km(i.scrollTop,i.scrollLeft,t.width,t.height)}getFutureViewport(){const t=this._scrollable.getScrollDimensions(),i=this._scrollable.getFutureScrollPosition();return new km(i.scrollTop,i.scrollLeft,t.width,t.height)}_computeContentWidth(){const t=this._configuration.options,i=this._maxLineWidth,e=t.get(146),s=t.get(50),n=t.get(145);if(e.isViewportWrapping){const e=t.get(73);return i>n.contentWidth+s.typicalHalfwidthCharacterWidth&&e.enabled&&e.side==="right"?i+n.verticalScrollbarWidth:i}{const e=t.get(104)*s.typicalHalfwidthCharacterWidth,r=this._linesLayout.getWhitespaceMinWidth();return Math.max(i+e+n.verticalScrollbarWidth,r,this._overlayWidgetsMinWidth)}}setMaxLineWidth(t){this._maxLineWidth=t,this._updateContentWidth()}setOverlayWidgetsMinWidth(t){this._overlayWidgetsMinWidth=t,this._updateContentWidth()}_updateContentWidth(){const t=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new _T(t.width,this._computeContentWidth(),t.height,t.contentHeight)),this._updateHeight()}saveState(){const t=this._scrollable.getFutureScrollPosition(),i=t.scrollTop,e=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(i);return{scrollTop:i,scrollTopWithoutViewZones:i-this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(e),scrollLeft:t.scrollLeft}}changeWhitespace(t){const i=this._linesLayout.changeWhitespace(t);return i&&this.onHeightMaybeChanged(),i}getVerticalOffsetForLineNumber(t,i=!1){return this._linesLayout.getVerticalOffsetForLineNumber(t,i)}getVerticalOffsetAfterLineNumber(t,i=!1){return this._linesLayout.getVerticalOffsetAfterLineNumber(t,i)}isAfterLines(t){return this._linesLayout.isAfterLines(t)}isInTopPadding(t){return this._linesLayout.isInTopPadding(t)}isInBottomPadding(t){return this._linesLayout.isInBottomPadding(t)}getLineNumberAtVerticalOffset(t){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(t)}getWhitespaceAtVerticalOffset(t){return this._linesLayout.getWhitespaceAtVerticalOffset(t)}getLinesViewportData(){const t=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(t.top,t.top+t.height)}getLinesViewportDataAtScrollTop(t){const i=this._scrollable.getScrollDimensions();return t+i.height>i.scrollHeight&&(t=i.scrollHeight-i.height),t<0&&(t=0),this._linesLayout.getLinesViewportData(t,t+i.height)}getWhitespaceViewportData(){const t=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(t.top,t.top+t.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(t){return this._scrollable.validateScrollPosition(t)}setScrollPosition(t,i){i===1?this._scrollable.setScrollPositionNow(t):this._scrollable.setScrollPositionSmooth(t)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}deltaScrollNow(t,i){const e=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:e.scrollLeft+t,scrollTop:e.scrollTop+i})}}class BT{constructor(t,i,e,s,n){this.editorId=t,this.model=i,this.configuration=e,this._linesCollection=s,this._coordinatesConverter=n,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(t){const i=t.id;let e=this._decorationsCache[i];if(!e){const s=t.range,n=t.options;let r;if(n.isWholeLine){const t=this._coordinatesConverter.convertModelPositionToViewPosition(new ks(s.startLineNumber,1),0,!1,!0),i=this._coordinatesConverter.convertModelPositionToViewPosition(new ks(s.endLineNumber,this.model.getLineMaxColumn(s.endLineNumber)),1);r=new Cs(t.lineNumber,t.column,i.lineNumber,i.column)}else r=this._coordinatesConverter.convertModelRangeToViewRange(s,1);e=new Am(r,n),this._decorationsCache[i]=e}return e}getMinimapDecorationsInRange(t){return this._getDecorationsInRange(t,!0,!1).decorations}getDecorationsViewportData(t){let i=this._cachedModelDecorationsResolver!==null;return i=i&&t.equalsRange(this._cachedModelDecorationsResolverViewRange),i||(this._cachedModelDecorationsResolver=this._getDecorationsInRange(t,!1,!1),this._cachedModelDecorationsResolverViewRange=t),this._cachedModelDecorationsResolver}getInlineDecorationsOnLine(t,i=!1,e=!1){const s=new Cs(t,this._linesCollection.getViewLineMinColumn(t),t,this._linesCollection.getViewLineMaxColumn(t));return this._getDecorationsInRange(s,i,e).inlineDecorations[0]}_getDecorationsInRange(t,i,e){const s=this._linesCollection.getDecorationsInRange(t,this.editorId,vi(this.configuration.options),i,e),n=t.startLineNumber,r=t.endLineNumber,o=[];let h=0;const c=[];for(let t=n;t<=r;t++)c[t-n]=[];for(let t=0,i=s.length;t<i;t++){const i=s[t],e=i.options;if(!$T(this.model,i))continue;const l=this._getOrCreateViewModelDecoration(i),a=l.range;if(o[h++]=l,e.inlineClassName){const t=new Dm(a,e.inlineClassName,e.inlineClassNameAffectsLetterSpacing?3:0),i=Math.max(n,a.startLineNumber),s=Math.min(r,a.endLineNumber);for(let e=i;e<=s;e++)c[e-n].push(t)}if(e.beforeContentClassName&&n<=a.startLineNumber&&a.startLineNumber<=r){const t=new Dm(new Cs(a.startLineNumber,a.startColumn,a.startLineNumber,a.startColumn),e.beforeContentClassName,1);c[a.startLineNumber-n].push(t)}if(e.afterContentClassName&&n<=a.endLineNumber&&a.endLineNumber<=r){const t=new Dm(new Cs(a.endLineNumber,a.endColumn,a.endLineNumber,a.endColumn),e.afterContentClassName,2);c[a.endLineNumber-n].push(t)}}return{decorations:o,inlineDecorations:c}}}function $T(t,i){return(!i.options.hideInCommentTokens||!WT(t,i))&&(!i.options.hideInStringTokens||!jT(t,i))}function WT(t,i){return HT(t,i.range,(t=>t===1))}function jT(t,i){return HT(t,i.range,(t=>t===2))}function HT(t,i,e){for(let s=i.startLineNumber;s<=i.endLineNumber;s++){const n=t.tokenization.getLineTokens(s),r=s===i.startLineNumber,o=s===i.endLineNumber;let h=r?n.findTokenIndexAtOffset(i.startColumn-1):0;for(;h<n.getCount()&&!(o&&n.getStartOffset(h)>i.endColumn-1);){if(!e(n.getStandardTokenType(h)))return!1;h++}}return!0}function VT(t,i){return t===null?i?UT.INSTANCE:KT.INSTANCE:new zT(t,i)}class zT{constructor(t,i){this._projectionData=t,this._isVisible=i}isVisible(){return this._isVisible}setVisible(t){return this._isVisible=t,this}getProjectionData(){return this._projectionData}getViewLineCount(){return this._isVisible?this._projectionData.getOutputLineCount():0}getViewLineContent(t,i,e){this._assertVisible();const s=e>0?this._projectionData.breakOffsets[e-1]:0,n=this._projectionData.breakOffsets[e];let r;if(this._projectionData.injectionOffsets!==null){const e=this._projectionData.injectionOffsets.map(((t,i)=>new PE(0,0,t+1,this._projectionData.injectionOptions[i],0)));r=PE.applyInjectedText(t.getLineContent(i),e).substring(s,n)}else r=t.getValueInRange({startLineNumber:i,startColumn:s+1,endLineNumber:i,endColumn:n+1});return e>0&&(r=GT(this._projectionData.wrappedTextIndentLength)+r),r}getViewLineLength(t,i,e){return this._assertVisible(),this._projectionData.getLineLength(e)}getViewLineMinColumn(t,i,e){return this._assertVisible(),this._projectionData.getMinOutputOffset(e)+1}getViewLineMaxColumn(t,i,e){return this._assertVisible(),this._projectionData.getMaxOutputOffset(e)+1}getViewLineData(t,i,e){const s=new Array;return this.getViewLinesData(t,i,e,1,0,[!0],s),s[0]}getViewLinesData(t,i,e,s,n,r,o){this._assertVisible();const h=this._projectionData,c=h.injectionOffsets,l=h.injectionOptions;let a,u=null;if(c){u=[];let t=0,i=0;for(let e=0;e<h.getOutputLineCount();e++){const s=new Array;u[e]=s;const n=e>0?h.breakOffsets[e-1]:0,r=h.breakOffsets[e];for(;i<c.length;){const o=l[i].content.length,a=c[i]+t,u=a+o;if(a>r)break;if(n<u){const t=l[i];if(t.inlineClassName){const i=e>0?h.wrappedTextIndentLength:0,o=i+Math.max(a-n,0),c=i+Math.min(u-n,r-n);o!==c&&s.push(new Em(o,c,t.inlineClassName,t.inlineClassNameAffectsLetterSpacing))}}if(!(u<=r))break;t+=o,i++}}}a=c?t.tokenization.getLineTokens(i).withInserted(c.map(((t,i)=>({offset:t,text:l[i].content,tokenMetadata:sm.defaultTokenMetadata})))):t.tokenization.getLineTokens(i);for(let t=e;t<e+s;t++){const i=n+t-e;r[i]?o[i]=this._getViewLineData(a,u?u[t]:null,t):o[i]=null}}_getViewLineData(t,i,e){this._assertVisible();const s=this._projectionData,n=e>0?s.wrappedTextIndentLength:0,r=e>0?s.breakOffsets[e-1]:0,o=s.breakOffsets[e],h=t.sliceAndInflate(r,o,n);let c=h.getLineContent();e>0&&(c=GT(s.wrappedTextIndentLength)+c);const l=this._projectionData.getMinOutputOffset(e)+1,a=c.length+1,u=e+1<this.getViewLineCount(),d=e===0?0:s.breakOffsetsVisibleColumn[e-1];return new Sm(c,u,l,a,d,h,i)}getModelColumnOfViewPosition(t,i){return this._assertVisible(),this._projectionData.translateToInputOffset(t,i-1)+1}getViewPositionOfModelPosition(t,i,e=2){return this._assertVisible(),this._projectionData.translateToOutputPosition(i-1,e).toPosition(t)}getViewLineNumberOfModelPosition(t,i){return this._assertVisible(),t+this._projectionData.translateToOutputPosition(i-1).outputLineIndex}normalizePosition(t,i,e){const s=i.lineNumber-t;return this._projectionData.normalizeOutputPosition(t,i.column-1,e).toPosition(s)}getInjectedTextAt(t,i){return this._projectionData.getInjectedText(t,i-1)}_assertVisible(){if(!this._isVisible)throw new Error("Not supported")}}class UT{constructor(){}isVisible(){return!0}setVisible(t){return t?this:KT.INSTANCE}getProjectionData(){return null}getViewLineCount(){return 1}getViewLineContent(t,i,e){return t.getLineContent(i)}getViewLineLength(t,i,e){return t.getLineLength(i)}getViewLineMinColumn(t,i,e){return t.getLineMinColumn(i)}getViewLineMaxColumn(t,i,e){return t.getLineMaxColumn(i)}getViewLineData(t,i,e){const s=t.tokenization.getLineTokens(i),n=s.getLineContent();return new Sm(n,!1,1,n.length+1,0,s.inflate(),null)}getViewLinesData(t,i,e,s,n,r,o){r[n]?o[n]=this.getViewLineData(t,i,0):o[n]=null}getModelColumnOfViewPosition(t,i){return i}getViewPositionOfModelPosition(t,i){return new ks(t,i)}getViewLineNumberOfModelPosition(t,i){return t}normalizePosition(t,i,e){return i}getInjectedTextAt(t,i){return null}}UT.INSTANCE=new UT;class KT{constructor(){}isVisible(){return!1}setVisible(t){return t?UT.INSTANCE:this}getProjectionData(){return null}getViewLineCount(){return 0}getViewLineContent(t,i,e){throw new Error("Not supported")}getViewLineLength(t,i,e){throw new Error("Not supported")}getViewLineMinColumn(t,i,e){throw new Error("Not supported")}getViewLineMaxColumn(t,i,e){throw new Error("Not supported")}getViewLineData(t,i,e){throw new Error("Not supported")}getViewLinesData(t,i,e,s,n,r,o){throw new Error("Not supported")}getModelColumnOfViewPosition(t,i){throw new Error("Not supported")}getViewPositionOfModelPosition(t,i){throw new Error("Not supported")}getViewLineNumberOfModelPosition(t,i){throw new Error("Not supported")}normalizePosition(t,i,e){throw new Error("Not supported")}getInjectedTextAt(t,i){throw new Error("Not supported")}}KT.INSTANCE=new KT;const qT=[""];function GT(t){if(t>=qT.length)for(let i=1;i<=t;i++)qT[i]=ZT(i);return qT[t]}function ZT(t){return new Array(t+1).join(" ")}class JT{constructor(t,i,e,s,n,r,o,h,c,l){this._editorId=t,this.model=i,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=e,this._monospaceLineBreaksComputerFactory=s,this.fontInfo=n,this.tabSize=r,this.wrappingStrategy=o,this.wrappingColumn=h,this.wrappingIndent=c,this.wordBreak=l,this._constructLines(!0,null)}dispose(){this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[])}createCoordinatesConverter(){return new XT(this)}_constructLines(t,i){this.modelLineProjections=[],t&&(this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[]));const e=this.model.getLinesContent(),s=this.model.getInjectedTextDecorations(this._editorId),n=e.length,r=this.createLineBreaksComputer(),o=new L(PE.fromDecorations(s));for(let t=0;t<n;t++){const s=o.takeWhile((i=>i.lineNumber===t+1));r.addRequest(e[t],s,i?i[t]:null)}const h=r.finalize(),c=[],l=this.hiddenAreasDecorationIds.map((t=>this.model.getDecorationRange(t))).sort(Cs.compareRangesUsingStarts);let a=1,u=0,d=-1,f=d+1<l.length?u+1:n+2;for(let t=0;t<n;t++){const i=t+1;i===f&&(d++,a=l[d].startLineNumber,u=l[d].endLineNumber,f=d+1<l.length?u+1:n+2);const e=i>=a&&i<=u,s=VT(h[t],!e);c[t]=s.getViewLineCount(),this.modelLineProjections[t]=s}this._validModelVersionId=this.model.getVersionId(),this.projectedModelLineLineCounts=new Ff(c)}getHiddenAreas(){return this.hiddenAreasDecorationIds.map((t=>this.model.getDecorationRange(t)))}setHiddenAreas(t){const i=function(t){if(t.length===0)return[];const i=t.slice();i.sort(Cs.compareRangesUsingStarts);const e=[];let s=i[0].startLineNumber,n=i[0].endLineNumber;for(let t=1,r=i.length;t<r;t++){const r=i[t];r.startLineNumber>n+1?(e.push(new Cs(s,1,n,1)),s=r.startLineNumber,n=r.endLineNumber):r.endLineNumber>n&&(n=r.endLineNumber)}return e.push(new Cs(s,1,n,1)),e}(t.map((t=>this.model.validateRange(t)))),e=this.hiddenAreasDecorationIds.map((t=>this.model.getDecorationRange(t))).sort(Cs.compareRangesUsingStarts);if(i.length===e.length){let t=!1;for(let s=0;s<i.length;s++)if(!i[s].equalsRange(e[s])){t=!0;break}if(!t)return!1}const s=i.map((t=>({range:t,options:xF.EMPTY})));this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,s);const n=i;let r=1,o=0,h=-1,c=h+1<n.length?o+1:this.modelLineProjections.length+2,l=!1;for(let t=0;t<this.modelLineProjections.length;t++){const i=t+1;i===c&&(h++,r=n[h].startLineNumber,o=n[h].endLineNumber,c=h+1<n.length?o+1:this.modelLineProjections.length+2);let e=!1;if(i>=r&&i<=o?this.modelLineProjections[t].isVisible()&&(this.modelLineProjections[t]=this.modelLineProjections[t].setVisible(!1),e=!0):(l=!0,this.modelLineProjections[t].isVisible()||(this.modelLineProjections[t]=this.modelLineProjections[t].setVisible(!0),e=!0)),e){const i=this.modelLineProjections[t].getViewLineCount();this.projectedModelLineLineCounts.setValue(t,i)}}return l||this.setHiddenAreas([]),!0}modelPositionIsVisible(t,i){return!(t<1||t>this.modelLineProjections.length)&&this.modelLineProjections[t-1].isVisible()}getModelLineViewLineCount(t){return t<1||t>this.modelLineProjections.length?1:this.modelLineProjections[t-1].getViewLineCount()}setTabSize(t){return this.tabSize!==t&&(this.tabSize=t,this._constructLines(!1,null),!0)}setWrappingSettings(t,i,e,s,n){const r=this.fontInfo.equals(t),o=this.wrappingStrategy===i,h=this.wrappingColumn===e,c=this.wrappingIndent===s,l=this.wordBreak===n;if(r&&o&&h&&c&&l)return!1;const a=r&&o&&!h&&c&&l;this.fontInfo=t,this.wrappingStrategy=i,this.wrappingColumn=e,this.wrappingIndent=s,this.wordBreak=n;let u=null;if(a){u=[];for(let t=0,i=this.modelLineProjections.length;t<i;t++)u[t]=this.modelLineProjections[t].getProjectionData()}return this._constructLines(!1,u),!0}createLineBreaksComputer(){return(this.wrappingStrategy==="advanced"?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent,this.wordBreak)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(t,i,e){if(!t||t<=this._validModelVersionId)return null;const s=i===1?1:this.projectedModelLineLineCounts.getPrefixSum(i-1)+1,n=this.projectedModelLineLineCounts.getPrefixSum(e);return this.modelLineProjections.splice(i-1,e-i+1),this.projectedModelLineLineCounts.removeValues(i-1,e-i+1),new tT(s,n)}onModelLinesInserted(t,i,e,s){if(!t||t<=this._validModelVersionId)return null;const n=i>2&&!this.modelLineProjections[i-2].isVisible(),r=i===1?1:this.projectedModelLineLineCounts.getPrefixSum(i-1)+1;let o=0;const h=[],c=[];for(let t=0,i=s.length;t<i;t++){const i=VT(s[t],!n);h.push(i);const e=i.getViewLineCount();o+=e,c[t]=e}return this.modelLineProjections=this.modelLineProjections.slice(0,i-1).concat(h).concat(this.modelLineProjections.slice(i-1)),this.projectedModelLineLineCounts.insertValues(i-1,c),new iT(r,r+o-1)}onModelLineChanged(t,i,e){if(t!==null&&t<=this._validModelVersionId)return[!1,null,null,null];const s=i-1,n=this.modelLineProjections[s].getViewLineCount(),r=VT(e,this.modelLineProjections[s].isVisible());this.modelLineProjections[s]=r;const o=this.modelLineProjections[s].getViewLineCount();let h=!1,c=0,l=-1,a=0,u=-1,d=0,f=-1;return n>o?(c=this.projectedModelLineLineCounts.getPrefixSum(i-1)+1,l=c+o-1,d=l+1,f=d+(n-o)-1,h=!0):n<o?(c=this.projectedModelLineLineCounts.getPrefixSum(i-1)+1,l=c+n-1,a=l+1,u=a+(o-n)-1,h=!0):(c=this.projectedModelLineLineCounts.getPrefixSum(i-1)+1,l=c+o-1),this.projectedModelLineLineCounts.setValue(s,o),[h,c<=l?new XF(c,l-c+1):null,a<=u?new iT(a,u):null,d<=f?new tT(d,f):null]}acceptVersionId(t){this._validModelVersionId=t,this.modelLineProjections.length!==1||this.modelLineProjections[0].isVisible()||this.setHiddenAreas([])}getViewLineCount(){return this.projectedModelLineLineCounts.getTotalSum()}_toValidViewLineNumber(t){if(t<1)return 1;const i=this.getViewLineCount();return t>i?i:0|t}getActiveIndentGuide(t,i,e){t=this._toValidViewLineNumber(t),i=this._toValidViewLineNumber(i),e=this._toValidViewLineNumber(e);const s=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),n=this.convertViewPositionToModelPosition(i,this.getViewLineMinColumn(i)),r=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),o=this.model.guides.getActiveIndentGuide(s.lineNumber,n.lineNumber,r.lineNumber),h=this.convertModelPositionToViewPosition(o.startLineNumber,1),c=this.convertModelPositionToViewPosition(o.endLineNumber,this.model.getLineMaxColumn(o.endLineNumber));return{startLineNumber:h.lineNumber,endLineNumber:c.lineNumber,indent:o.indent}}getViewLineInfo(t){t=this._toValidViewLineNumber(t);const i=this.projectedModelLineLineCounts.getIndexOf(t-1),e=i.index,s=i.remainder;return new QT(e+1,s)}getMinColumnOfViewLine(t){return this.modelLineProjections[t.modelLineNumber-1].getViewLineMinColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getMaxColumnOfViewLine(t){return this.modelLineProjections[t.modelLineNumber-1].getViewLineMaxColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(t){const i=this.modelLineProjections[t.modelLineNumber-1],e=i.getViewLineMinColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx),s=i.getModelColumnOfViewPosition(t.modelLineWrappedLineIdx,e);return new ks(t.modelLineNumber,s)}getModelEndPositionOfViewLine(t){const i=this.modelLineProjections[t.modelLineNumber-1],e=i.getViewLineMaxColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx),s=i.getModelColumnOfViewPosition(t.modelLineWrappedLineIdx,e);return new ks(t.modelLineNumber,s)}getViewLineInfosGroupedByModelRanges(t,i){const e=this.getViewLineInfo(t),s=this.getViewLineInfo(i),n=new Array;let r=this.getModelStartPositionOfViewLine(e),o=new Array;for(let t=e.modelLineNumber;t<=s.modelLineNumber;t++){const i=this.modelLineProjections[t-1];if(i.isVisible()){const n=t===e.modelLineNumber?e.modelLineWrappedLineIdx:0,r=t===s.modelLineNumber?s.modelLineWrappedLineIdx+1:i.getViewLineCount();for(let i=n;i<r;i++)o.push(new QT(t,i))}if(!i.isVisible()&&r){const i=new ks(t-1,this.model.getLineMaxColumn(t-1)+1),e=Cs.fromPositions(r,i);n.push(new YT(e,o)),o=[],r=null}else i.isVisible()&&!r&&(r=new ks(t,1))}if(r){const t=Cs.fromPositions(r,this.getModelEndPositionOfViewLine(s));n.push(new YT(t,o))}return n}getViewLinesBracketGuides(t,i,e,s){const n=e?this.convertViewPositionToModelPosition(e.lineNumber,e.column):null,r=[];for(const e of this.getViewLineInfosGroupedByModelRanges(t,i)){const t=e.modelRange.startLineNumber,i=this.model.guides.getLinesBracketGuides(t,e.modelRange.endLineNumber,n,s);for(const s of e.viewLines){const e=i[s.modelLineNumber-t].map((t=>{if(t.forWrappedLinesAfterColumn!==-1&&this.modelLineProjections[s.modelLineNumber-1].getViewPositionOfModelPosition(0,t.forWrappedLinesAfterColumn).lineNumber>=s.modelLineWrappedLineIdx||t.forWrappedLinesBeforeOrAtColumn!==-1&&this.modelLineProjections[s.modelLineNumber-1].getViewPositionOfModelPosition(0,t.forWrappedLinesBeforeOrAtColumn).lineNumber<s.modelLineWrappedLineIdx)return;if(!t.horizontalLine)return t;let i=-1;if(t.column!==-1){const e=this.modelLineProjections[s.modelLineNumber-1].getViewPositionOfModelPosition(0,t.column);if(e.lineNumber===s.modelLineWrappedLineIdx)i=e.column;else if(e.lineNumber<s.modelLineWrappedLineIdx)i=this.getMinColumnOfViewLine(s);else if(e.lineNumber>s.modelLineWrappedLineIdx)return}const e=this.convertModelPositionToViewPosition(s.modelLineNumber,t.horizontalLine.endColumn),n=this.modelLineProjections[s.modelLineNumber-1].getViewPositionOfModelPosition(0,t.horizontalLine.endColumn);return n.lineNumber===s.modelLineWrappedLineIdx?new SD(t.visibleColumn,i,t.className,new xD(t.horizontalLine.top,e.column),-1,-1):n.lineNumber<s.modelLineWrappedLineIdx||t.visibleColumn!==-1?void 0:new SD(t.visibleColumn,i,t.className,new xD(t.horizontalLine.top,this.getMaxColumnOfViewLine(s)),-1,-1)}));r.push(e.filter((t=>!!t)))}}return r}getViewLinesIndentGuides(t,i){t=this._toValidViewLineNumber(t),i=this._toValidViewLineNumber(i);const e=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),s=this.convertViewPositionToModelPosition(i,this.getViewLineMaxColumn(i));let n=[];const r=[],o=[],h=e.lineNumber-1,c=s.lineNumber-1;let l=null;for(let t=h;t<=c;t++){const i=this.modelLineProjections[t];if(i.isVisible()){const s=i.getViewLineNumberOfModelPosition(0,t===h?e.column:1),n=i.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(t+1)),c=n-s+1;let a=0;c>1&&i.getViewLineMinColumn(this.model,t+1,n)===1&&(a=s===0?1:2),r.push(c),o.push(a),l===null&&(l=new ks(t+1,0))}else l!==null&&(n=n.concat(this.model.guides.getLinesIndentGuides(l.lineNumber,t)),l=null)}l!==null&&(n=n.concat(this.model.guides.getLinesIndentGuides(l.lineNumber,s.lineNumber)),l=null);const a=i-t+1,u=new Array(a);let d=0;for(let t=0,i=n.length;t<i;t++){let i=n[t];const e=Math.min(a-d,r[t]),s=o[t];let h;h=s===2?0:s===1?1:e;for(let t=0;t<e;t++)t===h&&(i=0),u[d++]=i}return u}getViewLineContent(t){const i=this.getViewLineInfo(t);return this.modelLineProjections[i.modelLineNumber-1].getViewLineContent(this.model,i.modelLineNumber,i.modelLineWrappedLineIdx)}getViewLineLength(t){const i=this.getViewLineInfo(t);return this.modelLineProjections[i.modelLineNumber-1].getViewLineLength(this.model,i.modelLineNumber,i.modelLineWrappedLineIdx)}getViewLineMinColumn(t){const i=this.getViewLineInfo(t);return this.modelLineProjections[i.modelLineNumber-1].getViewLineMinColumn(this.model,i.modelLineNumber,i.modelLineWrappedLineIdx)}getViewLineMaxColumn(t){const i=this.getViewLineInfo(t);return this.modelLineProjections[i.modelLineNumber-1].getViewLineMaxColumn(this.model,i.modelLineNumber,i.modelLineWrappedLineIdx)}getViewLineData(t){const i=this.getViewLineInfo(t);return this.modelLineProjections[i.modelLineNumber-1].getViewLineData(this.model,i.modelLineNumber,i.modelLineWrappedLineIdx)}getViewLinesData(t,i,e){t=this._toValidViewLineNumber(t),i=this._toValidViewLineNumber(i);const s=this.projectedModelLineLineCounts.getIndexOf(t-1);let n=t;const r=s.index,o=s.remainder,h=[];for(let s=r,c=this.model.getLineCount();s<c;s++){const c=this.modelLineProjections[s];if(!c.isVisible())continue;const l=s===r?o:0;let a=c.getViewLineCount()-l,u=!1;if(n+a>i&&(u=!0,a=i-n+1),c.getViewLinesData(this.model,s+1,l,a,n-t,e,h),n+=a,u)break}return h}validateViewPosition(t,i,e){t=this._toValidViewLineNumber(t);const s=this.projectedModelLineLineCounts.getIndexOf(t-1),n=s.index,r=s.remainder,o=this.modelLineProjections[n],h=o.getViewLineMinColumn(this.model,n+1,r),c=o.getViewLineMaxColumn(this.model,n+1,r);i<h&&(i=h),i>c&&(i=c);const l=o.getModelColumnOfViewPosition(r,i);return this.model.validatePosition(new ks(n+1,l)).equals(e)?new ks(t,i):this.convertModelPositionToViewPosition(e.lineNumber,e.column)}validateViewRange(t,i){const e=this.validateViewPosition(t.startLineNumber,t.startColumn,i.getStartPosition()),s=this.validateViewPosition(t.endLineNumber,t.endColumn,i.getEndPosition());return new Cs(e.lineNumber,e.column,s.lineNumber,s.column)}convertViewPositionToModelPosition(t,i){const e=this.getViewLineInfo(t),s=this.modelLineProjections[e.modelLineNumber-1].getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,i);return this.model.validatePosition(new ks(e.modelLineNumber,s))}convertViewRangeToModelRange(t){const i=this.convertViewPositionToModelPosition(t.startLineNumber,t.startColumn),e=this.convertViewPositionToModelPosition(t.endLineNumber,t.endColumn);return new Cs(i.lineNumber,i.column,e.lineNumber,e.column)}convertModelPositionToViewPosition(t,i,e=2,s=!1,n=!1){const r=this.model.validatePosition(new ks(t,i)),o=r.lineNumber,h=r.column;let c=o-1,l=!1;if(n)for(;c<this.modelLineProjections.length&&!this.modelLineProjections[c].isVisible();)c++,l=!0;else for(;c>0&&!this.modelLineProjections[c].isVisible();)c--,l=!0;if(c===0&&!this.modelLineProjections[c].isVisible())return new ks(s?0:1,1);const a=1+this.projectedModelLineLineCounts.getPrefixSum(c);let u;return u=l?n?this.modelLineProjections[c].getViewPositionOfModelPosition(a,1,e):this.modelLineProjections[c].getViewPositionOfModelPosition(a,this.model.getLineMaxColumn(c+1),e):this.modelLineProjections[o-1].getViewPositionOfModelPosition(a,h,e),u}convertModelRangeToViewRange(t,i=0){if(t.isEmpty()){const e=this.convertModelPositionToViewPosition(t.startLineNumber,t.startColumn,i);return Cs.fromPositions(e)}{const i=this.convertModelPositionToViewPosition(t.startLineNumber,t.startColumn,1),e=this.convertModelPositionToViewPosition(t.endLineNumber,t.endColumn,0);return new Cs(i.lineNumber,i.column,e.lineNumber,e.column)}}getViewLineNumberOfModelPosition(t,i){let e=t-1;if(this.modelLineProjections[e].isVisible()){const t=1+this.projectedModelLineLineCounts.getPrefixSum(e);return this.modelLineProjections[e].getViewLineNumberOfModelPosition(t,i)}for(;e>0&&!this.modelLineProjections[e].isVisible();)e--;if(e===0&&!this.modelLineProjections[e].isVisible())return 1;const s=1+this.projectedModelLineLineCounts.getPrefixSum(e);return this.modelLineProjections[e].getViewLineNumberOfModelPosition(s,this.model.getLineMaxColumn(e+1))}getDecorationsInRange(t,i,e,s,n){const r=this.convertViewPositionToModelPosition(t.startLineNumber,t.startColumn),o=this.convertViewPositionToModelPosition(t.endLineNumber,t.endColumn);if(o.lineNumber-r.lineNumber<=t.endLineNumber-t.startLineNumber)return this.model.getDecorationsInRange(new Cs(r.lineNumber,1,o.lineNumber,o.column),i,e,s,n);let h=[];const c=r.lineNumber-1,l=o.lineNumber-1;let a=null;for(let t=c;t<=l;t++)if(this.modelLineProjections[t].isVisible())a===null&&(a=new ks(t+1,t===c?r.column:1));else if(a!==null){const n=this.model.getLineMaxColumn(t);h=h.concat(this.model.getDecorationsInRange(new Cs(a.lineNumber,a.column,t,n),i,e,s)),a=null}a!==null&&(h=h.concat(this.model.getDecorationsInRange(new Cs(a.lineNumber,a.column,o.lineNumber,o.column),i,e,s)),a=null),h.sort(((t,i)=>{const e=Cs.compareRangesUsingStarts(t.range,i.range);return e===0?t.id<i.id?-1:t.id>i.id?1:0:e}));const u=[];let d=0,f=null;for(const t of h){const i=t.id;f!==i&&(f=i,u[d++]=t)}return u}getInjectedTextAt(t){const i=this.getViewLineInfo(t.lineNumber);return this.modelLineProjections[i.modelLineNumber-1].getInjectedTextAt(i.modelLineWrappedLineIdx,t.column)}normalizePosition(t,i){const e=this.getViewLineInfo(t.lineNumber);return this.modelLineProjections[e.modelLineNumber-1].normalizePosition(e.modelLineWrappedLineIdx,t,i)}getLineIndentColumn(t){const i=this.getViewLineInfo(t);return i.modelLineWrappedLineIdx===0?this.model.getLineIndentColumn(i.modelLineNumber):0}}class QT{constructor(t,i){this.modelLineNumber=t,this.modelLineWrappedLineIdx=i}}class YT{constructor(t,i){this.modelRange=t,this.viewLines=i}}class XT{constructor(t){this._lines=t}convertViewPositionToModelPosition(t){return this._lines.convertViewPositionToModelPosition(t.lineNumber,t.column)}convertViewRangeToModelRange(t){return this._lines.convertViewRangeToModelRange(t)}validateViewPosition(t,i){return this._lines.validateViewPosition(t.lineNumber,t.column,i)}validateViewRange(t,i){return this._lines.validateViewRange(t,i)}convertModelPositionToViewPosition(t,i,e,s){return this._lines.convertModelPositionToViewPosition(t.lineNumber,t.column,i,e,s)}convertModelRangeToViewRange(t,i){return this._lines.convertModelRangeToViewRange(t,i)}modelPositionIsVisible(t){return this._lines.modelPositionIsVisible(t.lineNumber,t.column)}getModelLineViewLineCount(t){return this._lines.getModelLineViewLineCount(t)}getViewLineNumberOfModelPosition(t,i){return this._lines.getViewLineNumberOfModelPosition(t,i)}}class tR{constructor(t){this.model=t}dispose(){}createCoordinatesConverter(){return new iR(this)}getHiddenAreas(){return[]}setHiddenAreas(t){return!1}setTabSize(t){return!1}setWrappingSettings(t,i,e,s){return!1}createLineBreaksComputer(){const t=[];return{addRequest:(i,e,s)=>{t.push(null)},finalize:()=>t}}onModelFlushed(){}onModelLinesDeleted(t,i,e){return new tT(i,e)}onModelLinesInserted(t,i,e,s){return new iT(i,e)}onModelLineChanged(t,i,e){return[!1,new XF(i,1),null,null]}acceptVersionId(t){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(t,i,e){return{startLineNumber:t,endLineNumber:t,indent:0}}getViewLinesBracketGuides(t,i,e){return new Array(i-t+1).fill([])}getViewLinesIndentGuides(t,i){const e=i-t+1,s=new Array(e);for(let t=0;t<e;t++)s[t]=0;return s}getViewLineContent(t){return this.model.getLineContent(t)}getViewLineLength(t){return this.model.getLineLength(t)}getViewLineMinColumn(t){return this.model.getLineMinColumn(t)}getViewLineMaxColumn(t){return this.model.getLineMaxColumn(t)}getViewLineData(t){const i=this.model.tokenization.getLineTokens(t),e=i.getLineContent();return new Sm(e,!1,1,e.length+1,0,i.inflate(),null)}getViewLinesData(t,i,e){const s=this.model.getLineCount();t=Math.min(Math.max(1,t),s),i=Math.min(Math.max(1,i),s);const n=[];for(let s=t;s<=i;s++){const i=s-t;n[i]=e[i]?this.getViewLineData(s):null}return n}getDecorationsInRange(t,i,e,s,n){return this.model.getDecorationsInRange(t,i,e,s,n)}normalizePosition(t,i){return this.model.normalizePosition(t,i)}getLineIndentColumn(t){return this.model.getLineIndentColumn(t)}getInjectedTextAt(t){return null}}class iR{constructor(t){this._lines=t}_validPosition(t){return this._lines.model.validatePosition(t)}_validRange(t){return this._lines.model.validateRange(t)}convertViewPositionToModelPosition(t){return this._validPosition(t)}convertViewRangeToModelRange(t){return this._validRange(t)}validateViewPosition(t,i){return this._validPosition(i)}validateViewRange(t,i){return this._validRange(i)}convertModelPositionToViewPosition(t){return this._validPosition(t)}convertModelRangeToViewRange(t){return this._validRange(t)}modelPositionIsVisible(t){const i=this._lines.model.getLineCount();return!(t.lineNumber<1||t.lineNumber>i)}getModelLineViewLineCount(t){return 1}getViewLineNumberOfModelPosition(t,i){return t}}const eR=Xf.Right;class sR{constructor(t){this.persist=0,this._requiredLanes=1,this.lanes=new Uint8Array(Math.ceil((t+1)*eR/8))}reset(t){const i=Math.ceil((t+1)*eR/8);this.lanes.length<i?this.lanes=new Uint8Array(i):this.lanes.fill(0),this._requiredLanes=1}get requiredLanes(){return this._requiredLanes}push(t,i,e){e&&(this.persist|=1<<t-1);for(let e=i.startLineNumber;e<=i.endLineNumber;e++){const i=eR*e+(t-1);this.lanes[i>>>3]|=1<<i%8,this._requiredLanes=Math.max(this._requiredLanes,this.countAtLine(e))}}getLanesAtLine(t){const i=[];let e=eR*t;for(let t=0;t<eR;t++)(this.persist&1<<t||this.lanes[e>>>3]&1<<e%8)&&i.push(t+1),e++;return i.length?i:[Xf.Center]}countAtLine(t){let i=eR*t,e=0;for(let t=0;t<eR;t++)(this.persist&1<<t||this.lanes[i>>>3]&1<<i%8)&&e++,i++;return e}}let nR=class extends Qi{constructor(t,i,e,s,n,r,o,h,c){if(super(),this.languageConfigurationService=o,this._themeService=h,this._attachedView=c,this.hiddenAreasModel=new hR,this.previousHiddenAreas=[],this._editorId=t,this._configuration=i,this.model=e,this._eventDispatcher=new cT,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new qS(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._updateConfigurationViewLineCount=this._register(new Co((()=>this._updateConfigurationViewLineCountNow()),0)),this._hasFocus=!1,this._viewportStart=rR.create(this.model),this.glyphLanes=new sR(0),this.model.isTooLargeForTokenization())this._lines=new tR(this.model);else{const t=this._configuration.options,i=t.get(50),e=t.get(139),r=t.get(146),o=t.get(138),h=t.get(129);this._lines=new JT(this._editorId,this.model,s,n,i,this.model.getOptions().tabSize,e,r.wrappingColumn,o,h)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new ST(e,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new NT(this._configuration,this.getLineCount(),r)),this._register(this.viewLayout.onDidScroll((t=>{t.scrollTopChanged&&this._handleVisibleLinesChanged(),t.scrollTopChanged&&this._viewportStart.invalidate(),this._eventDispatcher.emitSingleViewEvent(new sT(t)),this._eventDispatcher.emitOutgoingEvent(new dT(t.oldScrollWidth,t.oldScrollLeft,t.oldScrollHeight,t.oldScrollTop,t.scrollWidth,t.scrollLeft,t.scrollHeight,t.scrollTop))}))),this._register(this.viewLayout.onDidContentSizeChange((t=>{this._eventDispatcher.emitOutgoingEvent(t)}))),this._decorations=new BT(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast((t=>{try{const i=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(i,t)}finally{this._eventDispatcher.endEmitViewEvents()}}))),this._register(ND.getInstance().onDidChange((()=>{this._eventDispatcher.emitSingleViewEvent(new oT)}))),this._register(this._themeService.onDidColorThemeChange((t=>{this._invalidateDecorationsColorCache(),this._eventDispatcher.emitSingleViewEvent(new nT(t))}))),this._updateConfigurationViewLineCountNow()}dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this._viewportStart.dispose(),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(t){this._eventDispatcher.addViewEventHandler(t)}removeViewEventHandler(t){this._eventDispatcher.removeViewEventHandler(t)}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}getModelVisibleRanges(){const t=this.viewLayout.getLinesViewportData(),i=new Cs(t.startLineNumber,this.getLineMinColumn(t.startLineNumber),t.endLineNumber,this.getLineMaxColumn(t.endLineNumber));return this._toModelVisibleRanges(i)}visibleLinesStabilized(){const t=this.getModelVisibleRanges();this._attachedView.setVisibleLines(t,!0)}_handleVisibleLinesChanged(){const t=this.getModelVisibleRanges();this._attachedView.setVisibleLines(t,!1)}setHasFocus(t){this._hasFocus=t,this._cursor.setHasFocus(t),this._eventDispatcher.emitSingleViewEvent(new JF(t)),this._eventDispatcher.emitOutgoingEvent(new uT(!t,t))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new zF)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new UF)}_captureStableViewport(){if(this._viewportStart.isValid&&this.viewLayout.getCurrentScrollTop()>0){const t=new ks(this._viewportStart.viewLineNumber,this.getLineMinColumn(this._viewportStart.viewLineNumber)),i=this.coordinatesConverter.convertViewPositionToModelPosition(t);return new lR(i,this._viewportStart.startLineDelta)}return new lR(null,0)}_onConfigurationChanged(t,i){const e=this._captureStableViewport(),s=this._configuration.options,n=s.get(50),r=s.get(139),o=s.get(146),h=s.get(138),c=s.get(129);this._lines.setWrappingSettings(n,r,o.wrappingColumn,h,c)&&(t.emitViewEvent(new ZF),t.emitViewEvent(new YF),t.emitViewEvent(new GF(null)),this._cursor.onLineMappingChanged(t),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this._updateConfigurationViewLineCount.schedule()),i.hasChanged(91)&&(this._decorations.reset(),t.emitViewEvent(new GF(null))),i.hasChanged(98)&&(this._decorations.reset(),t.emitViewEvent(new GF(null))),t.emitViewEvent(new KF(i)),this.viewLayout.onConfigurationChanged(i),e.recoverViewportStart(this.coordinatesConverter,this.viewLayout),qS.shouldRecreate(i)&&(this.cursorConfig=new qS(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText((t=>{try{const i=this._eventDispatcher.beginEmitViewEvents();let e=!1,s=!1;const n=t instanceof VE?t.rawContentChangedEvent.changes:t.changes,r=t instanceof VE?t.rawContentChangedEvent.versionId:null,o=this._lines.createLineBreaksComputer();for(const t of n)switch(t.changeType){case 4:for(let i=0;i<t.detail.length;i++){const e=t.detail[i];let s=t.injectedTexts[i];s&&(s=s.filter((t=>!t.ownerId||t.ownerId===this._editorId))),o.addRequest(e,s,null)}break;case 2:{let i=null;t.injectedText&&(i=t.injectedText.filter((t=>!t.ownerId||t.ownerId===this._editorId))),o.addRequest(t.detail,i,null);break}}const h=o.finalize(),c=new L(h);for(const t of n)switch(t.changeType){case 1:this._lines.onModelFlushed(),i.emitViewEvent(new ZF),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount()),e=!0;break;case 3:{const s=this._lines.onModelLinesDeleted(r,t.fromLineNumber,t.toLineNumber);s!==null&&(i.emitViewEvent(s),this.viewLayout.onLinesDeleted(s.fromLineNumber,s.toLineNumber)),e=!0;break}case 4:{const s=c.takeCount(t.detail.length),n=this._lines.onModelLinesInserted(r,t.fromLineNumber,t.toLineNumber,s);n!==null&&(i.emitViewEvent(n),this.viewLayout.onLinesInserted(n.fromLineNumber,n.toLineNumber)),e=!0;break}case 2:{const e=c.dequeue(),[n,o,h,l]=this._lines.onModelLineChanged(r,t.lineNumber,e);s=n,o&&i.emitViewEvent(o),h&&(i.emitViewEvent(h),this.viewLayout.onLinesInserted(h.fromLineNumber,h.toLineNumber)),l&&(i.emitViewEvent(l),this.viewLayout.onLinesDeleted(l.fromLineNumber,l.toLineNumber));break}}r!==null&&this._lines.acceptVersionId(r),this.viewLayout.onHeightMaybeChanged(),!e&&s&&(i.emitViewEvent(new YF),i.emitViewEvent(new GF(null)),this._cursor.onLineMappingChanged(i),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}const i=this._viewportStart.isValid;if(this._viewportStart.invalidate(),this._configuration.setModelLineCount(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&i){const t=this.model._getTrackedRange(this._viewportStart.modelTrackedRange);if(t){const i=this.coordinatesConverter.convertModelPositionToViewPosition(t.getStartPosition()),e=this.viewLayout.getVerticalOffsetForLineNumber(i.lineNumber);this.viewLayout.setScrollPosition({scrollTop:e+this._viewportStart.startLineDelta},1)}}try{const i=this._eventDispatcher.beginEmitViewEvents();t instanceof VE&&i.emitOutgoingEvent(new yT(t.contentChangedEvent)),this._cursor.onModelContentChanged(i,t)}finally{this._eventDispatcher.endEmitViewEvents()}this._handleVisibleLinesChanged()}))),this._register(this.model.onDidChangeTokens((t=>{const i=[];for(let e=0,s=t.ranges.length;e<s;e++){const s=t.ranges[e],n=this.coordinatesConverter.convertModelPositionToViewPosition(new ks(s.fromLineNumber,1)).lineNumber,r=this.coordinatesConverter.convertModelPositionToViewPosition(new ks(s.toLineNumber,this.model.getLineMaxColumn(s.toLineNumber))).lineNumber;i[e]={fromLineNumber:n,toLineNumber:r}}this._eventDispatcher.emitSingleViewEvent(new rT(i)),this._eventDispatcher.emitOutgoingEvent(new CT(t))}))),this._register(this.model.onDidChangeLanguageConfiguration((t=>{this._eventDispatcher.emitSingleViewEvent(new QF),this.cursorConfig=new qS(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new bT(t))}))),this._register(this.model.onDidChangeLanguage((t=>{this.cursorConfig=new qS(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new vT(t))}))),this._register(this.model.onDidChangeOptions((t=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{const t=this._eventDispatcher.beginEmitViewEvents();t.emitViewEvent(new ZF),t.emitViewEvent(new YF),t.emitViewEvent(new GF(null)),this._cursor.onLineMappingChanged(t),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new qS(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new kT(t))}))),this._register(this.model.onDidChangeDecorations((t=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new GF(t)),this._eventDispatcher.emitOutgoingEvent(new wT(t))})))}setHiddenAreas(t,i){var e;this.hiddenAreasModel.setHiddenAreas(i,t);const s=this.hiddenAreasModel.getMergedRanges();if(s===this.previousHiddenAreas)return;this.previousHiddenAreas=s;const n=this._captureStableViewport();let r=!1;try{const t=this._eventDispatcher.beginEmitViewEvents();r=this._lines.setHiddenAreas(s),r&&(t.emitViewEvent(new ZF),t.emitViewEvent(new YF),t.emitViewEvent(new GF(null)),this._cursor.onLineMappingChanged(t),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this.viewLayout.onHeightMaybeChanged());const i=(e=n.viewportStartModelPosition)===null||e===void 0?void 0:e.lineNumber;i&&s.some((t=>t.startLineNumber<=i&&i<=t.endLineNumber))||n.recoverViewportStart(this.coordinatesConverter,this.viewLayout)}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),r&&this._eventDispatcher.emitOutgoingEvent(new gT)}getVisibleRangesPlusViewportAboveBelow(){const t=this._configuration.options.get(145),i=this._configuration.options.get(67),e=Math.max(20,Math.round(t.height/i)),s=this.viewLayout.getLinesViewportData(),n=Math.max(1,s.completelyVisibleStartLineNumber-e),r=Math.min(this.getLineCount(),s.completelyVisibleEndLineNumber+e);return this._toModelVisibleRanges(new Cs(n,this.getLineMinColumn(n),r,this.getLineMaxColumn(r)))}getVisibleRanges(){const t=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(t)}getHiddenAreas(){return this._lines.getHiddenAreas()}_toModelVisibleRanges(t){const i=this.coordinatesConverter.convertViewRangeToModelRange(t),e=this._lines.getHiddenAreas();if(e.length===0)return[i];const s=[];let n=0,r=i.startLineNumber,o=i.startColumn;const h=i.endLineNumber,c=i.endColumn;for(let t=0,i=e.length;t<i;t++){const i=e[t].startLineNumber,c=e[t].endLineNumber;c<r||i>h||(r<i&&(s[n++]=new Cs(r,o,i-1,this.model.getLineMaxColumn(i-1))),r=c+1,o=1)}return(r<h||r===h&&o<c)&&(s[n++]=new Cs(r,o,h,c)),s}getCompletelyVisibleViewRange(){const t=this.viewLayout.getLinesViewportData(),i=t.completelyVisibleStartLineNumber,e=t.completelyVisibleEndLineNumber;return new Cs(i,this.getLineMinColumn(i),e,this.getLineMaxColumn(e))}getCompletelyVisibleViewRangeAtScrollTop(t){const i=this.viewLayout.getLinesViewportDataAtScrollTop(t),e=i.completelyVisibleStartLineNumber,s=i.completelyVisibleEndLineNumber;return new Cs(e,this.getLineMinColumn(e),s,this.getLineMaxColumn(s))}saveState(){const t=this.viewLayout.saveState(),i=t.scrollTop,e=this.viewLayout.getLineNumberAtVerticalOffset(i),s=this.coordinatesConverter.convertViewPositionToModelPosition(new ks(e,this.getLineMinColumn(e))),n=this.viewLayout.getVerticalOffsetForLineNumber(e)-i;return{scrollLeft:t.scrollLeft,firstPosition:s,firstPositionDeltaTop:n}}reduceRestoreState(t){if(t.firstPosition===void 0)return this._reduceRestoreStateCompatibility(t);const i=this.model.validatePosition(t.firstPosition),e=this.coordinatesConverter.convertModelPositionToViewPosition(i),s=this.viewLayout.getVerticalOffsetForLineNumber(e.lineNumber)-t.firstPositionDeltaTop;return{scrollLeft:t.scrollLeft,scrollTop:s}}_reduceRestoreStateCompatibility(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this._lines.getViewLineCount()}setViewport(t,i,e){this._viewportStart.update(this,t)}getActiveIndentGuide(t,i,e){return this._lines.getActiveIndentGuide(t,i,e)}getLinesIndentGuides(t,i){return this._lines.getViewLinesIndentGuides(t,i)}getBracketGuidesInRangeByLine(t,i,e,s){return this._lines.getViewLinesBracketGuides(t,i,e,s)}getLineContent(t){return this._lines.getViewLineContent(t)}getLineLength(t){return this._lines.getViewLineLength(t)}getLineMinColumn(t){return this._lines.getViewLineMinColumn(t)}getLineMaxColumn(t){return this._lines.getViewLineMaxColumn(t)}getLineFirstNonWhitespaceColumn(t){const i=tr(this.getLineContent(t));return i===-1?0:i+1}getLineLastNonWhitespaceColumn(t){const i=er(this.getLineContent(t));return i===-1?0:i+2}getMinimapDecorationsInRange(t){return this._decorations.getMinimapDecorationsInRange(t)}getDecorationsInViewport(t){return this._decorations.getDecorationsViewportData(t).decorations}getInjectedTextAt(t){return this._lines.getInjectedTextAt(t)}getViewportViewLineRenderingData(t,i){const e=this._decorations.getDecorationsViewportData(t).inlineDecorations[i-t.startLineNumber];return this._getViewLineRenderingData(i,e)}getViewLineRenderingData(t){const i=this._decorations.getInlineDecorationsOnLine(t);return this._getViewLineRenderingData(t,i)}_getViewLineRenderingData(t,i){const e=this.model.mightContainRTL(),s=this.model.mightContainNonBasicASCII(),n=this.getTabSize(),r=this._lines.getViewLineData(t);return r.inlineDecorations&&(i=[...i,...r.inlineDecorations.map((i=>i.toInlineDecoration(t)))]),new xm(r.minColumn,r.maxColumn,r.content,r.continuesWithWrappedLine,e,s,r.tokens,i,n,r.startVisibleColumn)}getViewLineData(t){return this._lines.getViewLineData(t)}getMinimapLinesRenderingData(t,i,e){const s=this._lines.getViewLinesData(t,i,e);return new Cm(this.getTabSize(),s)}getAllOverviewRulerDecorations(t){const i=this.model.getOverviewRulerDecorations(this._editorId,vi(this._configuration.options)),e=new oR;for(const s of i){const i=s.options,n=i.overviewRuler;if(!n)continue;const r=n.position;if(r===0)continue;const o=n.getColor(t.value),h=this.coordinatesConverter.getViewLineNumberOfModelPosition(s.range.startLineNumber,s.range.startColumn),c=this.coordinatesConverter.getViewLineNumberOfModelPosition(s.range.endLineNumber,s.range.endColumn);e.accept(o,i.zIndex,h,c,r)}return e.asArray}_invalidateDecorationsColorCache(){const t=this.model.getOverviewRulerDecorations();for(const i of t){const t=i.options.overviewRuler;t==null||t.invalidateCachedColor();const e=i.options.minimap;e==null||e.invalidateCachedColor()}}getValueInRange(t,i){const e=this.coordinatesConverter.convertViewRangeToModelRange(t);return this.model.getValueInRange(e,i)}getValueLengthInRange(t,i){const e=this.coordinatesConverter.convertViewRangeToModelRange(t);return this.model.getValueLengthInRange(e,i)}modifyPosition(t,i){const e=this.coordinatesConverter.convertViewPositionToModelPosition(t),s=this.model.modifyPosition(e,i);return this.coordinatesConverter.convertModelPositionToViewPosition(s)}deduceModelPositionRelativeToViewPosition(t,i,e){const s=this.coordinatesConverter.convertViewPositionToModelPosition(t);this.model.getEOL().length===2&&(i<0?i-=e:i+=e);const n=this.model.getOffsetAt(s)+i;return this.model.getPositionAt(n)}getPlainTextToCopy(t,i,e){const s=e?`\r\n`:this.model.getEOL();(t=t.slice(0)).sort(Cs.compareRangesUsingStarts);let n=!1,r=!1;for(const i of t)i.isEmpty()?n=!0:r=!0;if(!r){if(!i)return"";const e=t.map((t=>t.startLineNumber));let n="";for(let t=0;t<e.length;t++)t>0&&e[t-1]===e[t]||(n+=this.model.getLineContent(e[t])+s);return n}if(n&&i){const i=[];let s=0;for(const n of t){const t=n.startLineNumber;n.isEmpty()?t!==s&&i.push(this.model.getLineContent(t)):i.push(this.model.getValueInRange(n,e?2:0)),s=t}return i.length===1?i[0]:i}const o=[];for(const i of t)i.isEmpty()||o.push(this.model.getValueInRange(i,e?2:0));return o.length===1?o[0]:o}getRichTextToCopy(t,i){const e=this.model.getLanguageId();if(e===Yd||t.length!==1)return null;let s=t[0];if(s.isEmpty()){if(!i)return null;const t=s.startLineNumber;s=new Cs(t,this.model.getLineMinColumn(t),t,this.model.getLineMaxColumn(t))}const n=this._configuration.options.get(50),r=this._getColorMap();let o;return/[:;\\\/<>]/.test(n.fontFamily)||n.fontFamily===Li.fontFamily?o=Li.fontFamily:(o=n.fontFamily,o=o.replace(/"/g,"'"),/[,']/.test(o)||/[+ ]/.test(o)&&(o=`'${o}'`),o=`${o}, ${Li.fontFamily}`),{mode:e,html:`<div style="color: ${r[1]};background-color: ${r[2]};font-family: ${o};font-weight: ${n.fontWeight};font-size: ${n.fontSize}px;line-height: ${n.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(s,r)+"</div>"}}_getHTMLToCopy(t,i){const e=t.startLineNumber,s=t.startColumn,n=t.endLineNumber,r=t.endColumn,o=this.getTabSize();let h="";for(let t=e;t<=n;t++){const c=this.model.tokenization.getLineTokens(t),l=c.getLineContent(),a=t===e?s-1:0,u=t===n?r-1:l.length;h+=l===""?"<br>":FT(l,c.inflate(),i,a,u,o,vt)}return h}_getColorMap(){const t=Us.getColorMap(),i=["#000000"];if(t)for(let e=1,s=t.length;e<s;e++)i[e]=kp.Format.CSS.formatHex(t[e]);return i}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(t,i,e){return this._withViewEventsCollector((s=>this._cursor.setStates(s,t,i,e)))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(t){this._cursor.setCursorColumnSelectData(t)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(t){this._cursor.setPrevEditOperationType(t)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(t,i,e=0){this._withViewEventsCollector((s=>this._cursor.setSelections(s,t,i,e)))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(t){this._withViewEventsCollector((i=>this._cursor.restoreState(i,t)))}_executeCursorEdit(t){this._cursor.context.cursorConfig.readOnly?this._eventDispatcher.emitOutgoingEvent(new mT):this._withViewEventsCollector(t)}executeEdits(t,i,e){this._executeCursorEdit((s=>this._cursor.executeEdits(s,t,i,e)))}startComposition(){this._executeCursorEdit((t=>this._cursor.startComposition(t)))}endComposition(t){this._executeCursorEdit((i=>this._cursor.endComposition(i,t)))}type(t,i){this._executeCursorEdit((e=>this._cursor.type(e,t,i)))}compositionType(t,i,e,s,n){this._executeCursorEdit((r=>this._cursor.compositionType(r,t,i,e,s,n)))}paste(t,i,e,s){this._executeCursorEdit((n=>this._cursor.paste(n,t,i,e,s)))}cut(t){this._executeCursorEdit((i=>this._cursor.cut(i,t)))}executeCommand(t,i){this._executeCursorEdit((e=>this._cursor.executeCommand(e,t,i)))}executeCommands(t,i){this._executeCursorEdit((e=>this._cursor.executeCommands(e,t,i)))}revealAllCursors(t,i,e=!1){this._withViewEventsCollector((s=>this._cursor.revealAll(s,t,e,0,i,0)))}revealPrimaryCursor(t,i,e=!1){this._withViewEventsCollector((s=>this._cursor.revealPrimary(s,t,e,0,i,0)))}revealTopMostCursor(t){const i=this._cursor.getTopMostViewPosition(),e=new Cs(i.lineNumber,i.column,i.lineNumber,i.column);this._withViewEventsCollector((i=>i.emitViewEvent(new eT(t,!1,e,null,0,!0,0))))}revealBottomMostCursor(t){const i=this._cursor.getBottomMostViewPosition(),e=new Cs(i.lineNumber,i.column,i.lineNumber,i.column);this._withViewEventsCollector((i=>i.emitViewEvent(new eT(t,!1,e,null,0,!0,0))))}revealRange(t,i,e,s,n){this._withViewEventsCollector((r=>r.emitViewEvent(new eT(t,!1,e,null,s,i,n))))}changeWhitespace(t){this.viewLayout.changeWhitespace(t)&&(this._eventDispatcher.emitSingleViewEvent(new hT),this._eventDispatcher.emitOutgoingEvent(new fT))}_withViewEventsCollector(t){try{return t(this._eventDispatcher.beginEmitViewEvents())}finally{this._eventDispatcher.endEmitViewEvents()}}normalizePosition(t,i){return this._lines.normalizePosition(t,i)}getLineIndentColumn(t){return this._lines.getLineIndentColumn(t)}};class rR{static create(t){const i=t._setTrackedRange(null,new Cs(1,1,1,1),1);return new rR(t,1,!1,i,0)}get viewLineNumber(){return this._viewLineNumber}get isValid(){return this._isValid}get modelTrackedRange(){return this._modelTrackedRange}get startLineDelta(){return this._startLineDelta}constructor(t,i,e,s,n){this._model=t,this._viewLineNumber=i,this._isValid=e,this._modelTrackedRange=s,this._startLineDelta=n}dispose(){this._model._setTrackedRange(this._modelTrackedRange,null,1)}update(t,i){const e=t.coordinatesConverter.convertViewPositionToModelPosition(new ks(i,t.getLineMinColumn(i))),s=t.model._setTrackedRange(this._modelTrackedRange,new Cs(e.lineNumber,e.column,e.lineNumber,e.column),1),n=t.viewLayout.getVerticalOffsetForLineNumber(i),r=t.viewLayout.getCurrentScrollTop();this._viewLineNumber=i,this._isValid=!0,this._modelTrackedRange=s,this._startLineDelta=r-n}invalidate(){this._isValid=!1}}class oR{constructor(){this._asMap=Object.create(null),this.asArray=[]}accept(t,i,e,s,n){const r=this._asMap[t];if(r){const t=r.data,i=t[t.length-3],o=t[t.length-1];if(i===n&&o+1>=e)return void(s>o&&(t[t.length-1]=s));t.push(n,e,s)}else{const r=new Mm(t,i,[n,e,s]);this._asMap[t]=r,this.asArray.push(r)}}}class hR{constructor(){this.hiddenAreas=new Map,this.shouldRecompute=!1,this.ranges=[]}setHiddenAreas(t,i){const e=this.hiddenAreas.get(t);e&&cR(e,i)||(this.hiddenAreas.set(t,i),this.shouldRecompute=!0)}getMergedRanges(){if(!this.shouldRecompute)return this.ranges;this.shouldRecompute=!1;const t=Array.from(this.hiddenAreas.values()).reduce(((t,i)=>function(t,i){const e=[];let s=0,n=0;for(;s<t.length&&n<i.length;){const r=t[s],o=i[n];if(r.endLineNumber<o.startLineNumber-1)e.push(t[s++]);else if(o.endLineNumber<r.startLineNumber-1)e.push(i[n++]);else{const t=Math.min(r.startLineNumber,o.startLineNumber),i=Math.max(r.endLineNumber,o.endLineNumber);e.push(new Cs(t,1,i,1)),s++,n++}}for(;s<t.length;)e.push(t[s++]);for(;n<i.length;)e.push(i[n++]);return e}(t,i)),[]);return cR(this.ranges,t)||(this.ranges=t),this.ranges}}function cR(t,i){if(t.length!==i.length)return!1;for(let e=0;e<t.length;e++)if(!t[e].equalsRange(i[e]))return!1;return!0}class lR{constructor(t,i){this.viewportStartModelPosition=t,this.startLineDelta=i}recoverViewportStart(t,i){if(!this.viewportStartModelPosition)return;const e=t.convertModelPositionToViewPosition(this.viewportStartModelPosition),s=i.getVerticalOffsetForLineNumber(e.lineNumber);i.setScrollPosition({scrollTop:s+this.startLineDelta},1)}}class aR{constructor(...t){this._entries=new Map;for(const[i,e]of t)this.set(i,e)}set(t,i){const e=this._entries.get(t);return this._entries.set(t,i),e}get(t){return this._entries.get(t)}}var uR;(function(t){t[t.Ignore=0]="Ignore",t[t.Info=1]="Info",t[t.Warning=2]="Warning",t[t.Error=3]="Error"})(uR||(uR={})),function(t){const i="error",e="warning",s="info";t.fromValue=function(n){return n?ar(i,n)?t.Error:ar(e,n)||ar("warn",n)?t.Warning:ar(s,n)?t.Info:t.Ignore:t.Ignore},t.toString=function(n){switch(n){case t.Error:return i;case t.Warning:return e;case t.Info:return s;default:return"ignore"}}}(uR||(uR={}));const dR=uR;var fR=dR;const gR=_l("notificationService");var pR,mR=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},wR=function(t,i){return function(e,s){i(e,s,t)}};let vR=pR=class extends Qi{get isSimpleWidget(){return this._configuration.isSimpleWidget}constructor(t,i,e,s,n,r,o,h,c,l,a,u){var d;super(),this.languageConfigurationService=a,this._deliveryQueue=new ae,this._contributions=this._register(new JE),this._onDidDispose=this._register(new le),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModelContent=this._register(new le({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelContent=this._onDidChangeModelContent.event,this._onDidChangeModelLanguage=this._register(new le({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguage=this._onDidChangeModelLanguage.event,this._onDidChangeModelLanguageConfiguration=this._register(new le({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event,this._onDidChangeModelOptions=this._register(new le({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelOptions=this._onDidChangeModelOptions.event,this._onDidChangeModelDecorations=this._register(new le({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelDecorations=this._onDidChangeModelDecorations.event,this._onDidChangeModelTokens=this._register(new le({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelTokens=this._onDidChangeModelTokens.event,this._onDidChangeConfiguration=this._register(new le({deliveryQueue:this._deliveryQueue})),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onWillChangeModel=this._register(new le({deliveryQueue:this._deliveryQueue})),this.onWillChangeModel=this._onWillChangeModel.event,this._onDidChangeModel=this._register(new le({deliveryQueue:this._deliveryQueue})),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidChangeCursorPosition=this._register(new le({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorPosition=this._onDidChangeCursorPosition.event,this._onDidChangeCursorSelection=this._register(new le({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorSelection=this._onDidChangeCursorSelection.event,this._onDidAttemptReadOnlyEdit=this._register(new CR(this._contributions,this._deliveryQueue)),this.onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event,this._onDidLayoutChange=this._register(new le({deliveryQueue:this._deliveryQueue})),this.onDidLayoutChange=this._onDidLayoutChange.event,this._editorTextFocus=this._register(new kR({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue,this.onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse,this._editorWidgetFocus=this._register(new kR({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue,this.onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse,this._onWillType=this._register(new CR(this._contributions,this._deliveryQueue)),this.onWillType=this._onWillType.event,this._onDidType=this._register(new CR(this._contributions,this._deliveryQueue)),this.onDidType=this._onDidType.event,this._onDidCompositionStart=this._register(new CR(this._contributions,this._deliveryQueue)),this.onDidCompositionStart=this._onDidCompositionStart.event,this._onDidCompositionEnd=this._register(new CR(this._contributions,this._deliveryQueue)),this.onDidCompositionEnd=this._onDidCompositionEnd.event,this._onDidPaste=this._register(new CR(this._contributions,this._deliveryQueue)),this.onDidPaste=this._onDidPaste.event,this._onMouseUp=this._register(new CR(this._contributions,this._deliveryQueue)),this.onMouseUp=this._onMouseUp.event,this._onMouseDown=this._register(new CR(this._contributions,this._deliveryQueue)),this.onMouseDown=this._onMouseDown.event,this._onMouseDrag=this._register(new CR(this._contributions,this._deliveryQueue)),this.onMouseDrag=this._onMouseDrag.event,this._onMouseDrop=this._register(new CR(this._contributions,this._deliveryQueue)),this.onMouseDrop=this._onMouseDrop.event,this._onMouseDropCanceled=this._register(new CR(this._contributions,this._deliveryQueue)),this.onMouseDropCanceled=this._onMouseDropCanceled.event,this._onDropIntoEditor=this._register(new CR(this._contributions,this._deliveryQueue)),this.onDropIntoEditor=this._onDropIntoEditor.event,this._onContextMenu=this._register(new CR(this._contributions,this._deliveryQueue)),this.onContextMenu=this._onContextMenu.event,this._onMouseMove=this._register(new CR(this._contributions,this._deliveryQueue)),this.onMouseMove=this._onMouseMove.event,this._onMouseLeave=this._register(new CR(this._contributions,this._deliveryQueue)),this.onMouseLeave=this._onMouseLeave.event,this._onMouseWheel=this._register(new CR(this._contributions,this._deliveryQueue)),this.onMouseWheel=this._onMouseWheel.event,this._onKeyUp=this._register(new CR(this._contributions,this._deliveryQueue)),this.onKeyUp=this._onKeyUp.event,this._onKeyDown=this._register(new CR(this._contributions,this._deliveryQueue)),this.onKeyDown=this._onKeyDown.event,this._onDidContentSizeChange=this._register(new le({deliveryQueue:this._deliveryQueue})),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._onDidScrollChange=this._register(new le({deliveryQueue:this._deliveryQueue})),this.onDidScrollChange=this._onDidScrollChange.event,this._onDidChangeViewZones=this._register(new le({deliveryQueue:this._deliveryQueue})),this.onDidChangeViewZones=this._onDidChangeViewZones.event,this._onDidChangeHiddenAreas=this._register(new le({deliveryQueue:this._deliveryQueue})),this.onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event,this._actions=new Map,this._bannerDomNode=null,this._dropIntoEditorDecorations=this.createDecorationsCollection(),n.willCreateCodeEditor();const f={...i};let g;this._domElement=t,this._overflowWidgetsDomNode=f.overflowWidgetsDomNode,delete f.overflowWidgetsDomNode,this._id=++bR,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=e.telemetryData,this._configuration=this._register(this._createConfiguration(e.isSimpleWidget||!1,f,l)),this._register(this._configuration.onDidChange((t=>{this._onDidChangeConfiguration.fire(t);const i=this._configuration.options;if(t.hasChanged(145)){const t=i.get(145);this._onDidLayoutChange.fire(t)}}))),this._contextKeyService=this._register(o.createScoped(this._domElement)),this._notificationService=c,this._codeEditorService=n,this._commandService=r,this._themeService=h,this._register(new SR(this,this._contextKeyService)),this._register(new xR(this,this._contextKeyService,u)),this._instantiationService=s.createChild(new aR([Ra,this._contextKeyService])),this._modelData=null,this._focusTracker=new DR(t,this._overflowWidgetsDomNode),this._register(this._focusTracker.onChange((()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())}))),this._contentWidgets={},this._overlayWidgets={},this._glyphMarginWidgets={},g=Array.isArray(e.contributions)?e.contributions:xu.getEditorContributions(),this._contributions.initialize(this,g,this._instantiationService);for(const t of xu.getEditorActions()){if(this._actions.has(t.id)){Ii(new Error(`Cannot have two actions with the same id ${t.id}`));continue}const i=new QE(t.id,t.label,t.alias,t.metadata,(d=t.precondition)!==null&&d!==void 0?d:void 0,(i=>this._instantiationService.invokeFunction((e=>Promise.resolve(t.runEditorCommand(e,this,i))))),this._contextKeyService);this._actions.set(i.id,i)}const p=()=>!this._configuration.options.get(91)&&this._configuration.options.get(36).enabled;this._register(new gl(this._domElement,{onDragOver:t=>{if(!p())return;const i=this.getTargetAtClientPoint(t.clientX,t.clientY);i!=null&&i.position&&this.showDropIndicatorAt(i.position)},onDrop:async t=>{if(!p()||(this.removeDropIndicator(),!t.dataTransfer))return;const i=this.getTargetAtClientPoint(t.clientX,t.clientY);i!=null&&i.position&&this._onDropIntoEditor.fire({position:i.position,event:t})},onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}writeScreenReaderContent(t){var i;(i=this._modelData)===null||i===void 0||i.view.writeScreenReaderContent(t)}_createConfiguration(t,i,e){return new Cw(t,i,this._domElement,e)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return Yp.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose(),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(t){return this._instantiationService.invokeFunction(t)}updateOptions(t){this._configuration.updateOptions(t||{})}getOptions(){return this._configuration.options}getOption(t){return this._configuration.options.get(t)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(t){return this._modelData?lx.getWordAtPosition(this._modelData.model,this._configuration.options.get(131),this._configuration.options.get(130),t):null}getValue(t=null){if(!this._modelData)return"";const i=!(!t||!t.preserveBOM);let e=0;return t&&t.lineEnding&&t.lineEnding===`\n`?e=1:t&&t.lineEnding&&t.lineEnding===`\r\n`&&(e=2),this._modelData.model.getValue(e,i)}setValue(t){this._modelData&&this._modelData.model.setValue(t)}getModel(){return this._modelData?this._modelData.model:null}setModel(t=null){var i;const e=t;if(this._modelData===null&&e===null||this._modelData&&this._modelData.model===e)return;const s={oldModelUrl:((i=this._modelData)===null||i===void 0?void 0:i.model.uri)||null,newModelUrl:(e==null?void 0:e.uri)||null};this._onWillChangeModel.fire(s);const n=this.hasTextFocus(),r=this._detachModel();this._attachModel(e),n&&this.hasModel()&&this.focus(),this._removeDecorationTypes(),this._onDidChangeModel.fire(s),this._postDetachModelCleanup(r),this._contributionsDisposable=this._contributions.onAfterModelAttached()}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(const t in this._decorationTypeSubtypes){const i=this._decorationTypeSubtypes[t];for(const e in i)this._removeDecorationType(t+"-"+e)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(t,i,e,s){const n=t.model.validatePosition({lineNumber:i,column:e}),r=t.viewModel.coordinatesConverter.convertModelPositionToViewPosition(n);return t.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(r.lineNumber,s)}getTopForLineNumber(t,i=!1){return this._modelData?pR._getVerticalOffsetForPosition(this._modelData,t,1,i):-1}getTopForPosition(t,i){return this._modelData?pR._getVerticalOffsetForPosition(this._modelData,t,i,!1):-1}static _getVerticalOffsetForPosition(t,i,e,s=!1){const n=t.model.validatePosition({lineNumber:i,column:e}),r=t.viewModel.coordinatesConverter.convertModelPositionToViewPosition(n);return t.viewModel.viewLayout.getVerticalOffsetForLineNumber(r.lineNumber,s)}getBottomForLineNumber(t,i=!1){return this._modelData?pR._getVerticalOffsetAfterPosition(this._modelData,t,1,i):-1}setHiddenAreas(t,i){var e;(e=this._modelData)===null||e===void 0||e.viewModel.setHiddenAreas(t.map((t=>Cs.lift(t))),i)}getVisibleColumnFromPosition(t){if(!this._modelData)return t.column;const i=this._modelData.model.validatePosition(t),e=this._modelData.model.getOptions().tabSize;return Ck.visibleColumnFromColumn(this._modelData.model.getLineContent(i.lineNumber),i.column,e)+1}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(t,i="api"){if(this._modelData){if(!ks.isIPosition(t))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(i,[{selectionStartLineNumber:t.lineNumber,selectionStartColumn:t.column,positionLineNumber:t.lineNumber,positionColumn:t.column}])}}_sendRevealRange(t,i,e,s){if(!this._modelData)return;if(!Cs.isIRange(t))throw new Error("Invalid arguments");const n=this._modelData.model.validateRange(t),r=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(n);this._modelData.viewModel.revealRange("api",e,r,i,s)}revealLine(t,i=0){this._revealLine(t,0,i)}revealLineInCenter(t,i=0){this._revealLine(t,1,i)}revealLineInCenterIfOutsideViewport(t,i=0){this._revealLine(t,2,i)}revealLineNearTop(t,i=0){this._revealLine(t,5,i)}_revealLine(t,i,e){if(typeof t!="number")throw new Error("Invalid arguments");this._sendRevealRange(new Cs(t,1,t,1),i,!1,e)}revealPosition(t,i=0){this._revealPosition(t,0,!0,i)}revealPositionInCenter(t,i=0){this._revealPosition(t,1,!0,i)}revealPositionInCenterIfOutsideViewport(t,i=0){this._revealPosition(t,2,!0,i)}revealPositionNearTop(t,i=0){this._revealPosition(t,5,!0,i)}_revealPosition(t,i,e,s){if(!ks.isIPosition(t))throw new Error("Invalid arguments");this._sendRevealRange(new Cs(t.lineNumber,t.column,t.lineNumber,t.column),i,e,s)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(t,i="api"){const e=Ss.isISelection(t),s=Cs.isIRange(t);if(!e&&!s)throw new Error("Invalid arguments");if(e)this._setSelectionImpl(t,i);else if(s){const e={selectionStartLineNumber:t.startLineNumber,selectionStartColumn:t.startColumn,positionLineNumber:t.endLineNumber,positionColumn:t.endColumn};this._setSelectionImpl(e,i)}}_setSelectionImpl(t,i){if(!this._modelData)return;const e=new Ss(t.selectionStartLineNumber,t.selectionStartColumn,t.positionLineNumber,t.positionColumn);this._modelData.viewModel.setSelections(i,[e])}revealLines(t,i,e=0){this._revealLines(t,i,0,e)}revealLinesInCenter(t,i,e=0){this._revealLines(t,i,1,e)}revealLinesInCenterIfOutsideViewport(t,i,e=0){this._revealLines(t,i,2,e)}revealLinesNearTop(t,i,e=0){this._revealLines(t,i,5,e)}_revealLines(t,i,e,s){if(typeof t!="number"||typeof i!="number")throw new Error("Invalid arguments");this._sendRevealRange(new Cs(t,1,i,1),e,!1,s)}revealRange(t,i=0,e=!1,s=!0){this._revealRange(t,e?1:0,s,i)}revealRangeInCenter(t,i=0){this._revealRange(t,1,!0,i)}revealRangeInCenterIfOutsideViewport(t,i=0){this._revealRange(t,2,!0,i)}revealRangeNearTop(t,i=0){this._revealRange(t,5,!0,i)}revealRangeNearTopIfOutsideViewport(t,i=0){this._revealRange(t,6,!0,i)}revealRangeAtTop(t,i=0){this._revealRange(t,3,!0,i)}_revealRange(t,i,e,s){if(!Cs.isIRange(t))throw new Error("Invalid arguments");this._sendRevealRange(Cs.lift(t),i,e,s)}setSelections(t,i="api",e=0){if(this._modelData){if(!t||t.length===0)throw new Error("Invalid arguments");for(let i=0,e=t.length;i<e;i++)if(!Ss.isISelection(t[i]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(i,t,e)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(t,i=1){if(this._modelData){if(typeof t!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:t},i)}}setScrollTop(t,i=1){if(this._modelData){if(typeof t!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:t},i)}}setScrollPosition(t,i=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(t,i)}hasPendingScrollAnimation(){return!!this._modelData&&this._modelData.viewModel.viewLayout.hasPendingScrollAnimation()}saveViewState(){if(!this._modelData)return null;const t=this._contributions.saveViewState();return{cursorState:this._modelData.viewModel.saveCursorState(),viewState:this._modelData.viewModel.saveState(),contributionsState:t}}restoreViewState(t){if(!this._modelData||!this._modelData.hasRealView)return;const i=t;if(i&&i.cursorState&&i.viewState){const t=i.cursorState;Array.isArray(t)?t.length>0&&this._modelData.viewModel.restoreCursorState(t):this._modelData.viewModel.restoreCursorState([t]),this._contributions.restoreViewState(i.contributionsState||{});const e=this._modelData.viewModel.reduceRestoreState(i.viewState);this._modelData.view.restoreState(e)}}handleInitialized(){var t;(t=this._getViewModel())===null||t===void 0||t.visibleLinesStabilized()}getContribution(t){return this._contributions.get(t)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let t=this.getActions();return t=t.filter((t=>t.isSupported())),t}getAction(t){return this._actions.get(t)||null}trigger(t,i,e){switch(e=e||{},i){case"compositionStart":return void this._startComposition();case"compositionEnd":return void this._endComposition(t);case"type":{const i=e;return void this._type(t,i.text||"")}case"replacePreviousChar":{const i=e;return void this._compositionType(t,i.text||"",i.replaceCharCnt||0,0,0)}case"compositionType":{const i=e;return void this._compositionType(t,i.text||"",i.replacePrevCharCnt||0,i.replaceNextCharCnt||0,i.positionDelta||0)}case"paste":{const i=e;return void this._paste(t,i.text||"",i.pasteOnNewLine||!1,i.multicursorText||null,i.mode||null,i.clipboardEvent)}case"cut":return void this._cut(t)}const s=this.getAction(i);s?Promise.resolve(s.run(e)).then(void 0,Ii):this._modelData&&(this._triggerEditorCommand(t,i,e)||this._triggerCommand(i,e))}_triggerCommand(t,i){this._commandService.executeCommand(t,i)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(t){this._modelData&&(this._modelData.viewModel.endComposition(t),this._onDidCompositionEnd.fire())}_type(t,i){this._modelData&&i.length!==0&&(t==="keyboard"&&this._onWillType.fire(i),this._modelData.viewModel.type(i,t),t==="keyboard"&&this._onDidType.fire(i))}_compositionType(t,i,e,s,n){this._modelData&&this._modelData.viewModel.compositionType(i,e,s,n,t)}_paste(t,i,e,s,n,r){if(!this._modelData)return;const o=this._modelData.viewModel,h=o.getSelection().getStartPosition();o.paste(i,e,s,t);const c=o.getSelection().getStartPosition();t==="keyboard"&&this._onDidPaste.fire({clipboardEvent:r,range:new Cs(h.lineNumber,h.column,c.lineNumber,c.column),languageId:n})}_cut(t){this._modelData&&this._modelData.viewModel.cut(t)}_triggerEditorCommand(t,i,e){const s=xu.getEditorCommand(i);return!!s&&((e=e||{}).source=t,this._instantiationService.invokeFunction((t=>{Promise.resolve(s.runEditorCommand(t,this,e)).then(void 0,Ii)})),!0)}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!!this._modelData&&!this._configuration.options.get(91)&&(this._modelData.model.pushStackElement(),!0)}popUndoStop(){return!!this._modelData&&!this._configuration.options.get(91)&&(this._modelData.model.popStackElement(),!0)}executeEdits(t,i,e){if(!this._modelData||this._configuration.options.get(91))return!1;let s;return s=e?Array.isArray(e)?()=>e:e:()=>null,this._modelData.viewModel.executeEdits(t,i,s),!0}executeCommand(t,i){this._modelData&&this._modelData.viewModel.executeCommand(i,t)}executeCommands(t,i){this._modelData&&this._modelData.viewModel.executeCommands(i,t)}createDecorationsCollection(t){return new ER(this,t)}changeDecorations(t){return this._modelData?this._modelData.model.changeDecorations(t,this._id):null}getLineDecorations(t){return this._modelData?this._modelData.model.getLineDecorations(t,this._id,vi(this._configuration.options)):null}getDecorationsInRange(t){return this._modelData?this._modelData.model.getDecorationsInRange(t,this._id,vi(this._configuration.options)):null}deltaDecorations(t,i){return this._modelData?t.length===0&&i.length===0?t:this._modelData.model.deltaDecorations(t,i,this._id):[]}removeDecorations(t){this._modelData&&t.length!==0&&this._modelData.model.changeDecorations((i=>{i.deltaDecorations(t,[])}))}removeDecorationsByType(t){const i=this._decorationTypeKeysToIds[t];i&&this.changeDecorations((t=>t.deltaDecorations(i,[]))),this._decorationTypeKeysToIds.hasOwnProperty(t)&&delete this._decorationTypeKeysToIds[t],this._decorationTypeSubtypes.hasOwnProperty(t)&&delete this._decorationTypeSubtypes[t]}getLayoutInfo(){return this._configuration.options.get(145)}createOverviewRuler(t){return this._modelData&&this._modelData.hasRealView?this._modelData.view.createOverviewRuler(t):null}getContainerDomNode(){return this._domElement}getDomNode(){return this._modelData&&this._modelData.hasRealView?this._modelData.view.domNode.domNode:null}delegateVerticalScrollbarPointerDown(t){this._modelData&&this._modelData.hasRealView&&this._modelData.view.delegateVerticalScrollbarPointerDown(t)}delegateScrollFromMouseWheelEvent(t){this._modelData&&this._modelData.hasRealView&&this._modelData.view.delegateScrollFromMouseWheelEvent(t)}layout(t,i=!1){this._configuration.observeContainer(t),i||this.render()}focus(){this._modelData&&this._modelData.hasRealView&&this._modelData.view.focus()}hasTextFocus(){return!(!this._modelData||!this._modelData.hasRealView)&&this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(t){const i={widget:t,position:t.getPosition()};this._contentWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting a content widget with the same id:"+t.getId()),this._contentWidgets[t.getId()]=i,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(i)}layoutContentWidget(t){const i=t.getId();if(this._contentWidgets.hasOwnProperty(i)){const e=this._contentWidgets[i];e.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(e)}}removeContentWidget(t){const i=t.getId();if(this._contentWidgets.hasOwnProperty(i)){const t=this._contentWidgets[i];delete this._contentWidgets[i],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(t)}}addOverlayWidget(t){const i={widget:t,position:t.getPosition()};this._overlayWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[t.getId()]=i,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(i)}layoutOverlayWidget(t){const i=t.getId();if(this._overlayWidgets.hasOwnProperty(i)){const e=this._overlayWidgets[i];e.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(e)}}removeOverlayWidget(t){const i=t.getId();if(this._overlayWidgets.hasOwnProperty(i)){const t=this._overlayWidgets[i];delete this._overlayWidgets[i],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(t)}}addGlyphMarginWidget(t){const i={widget:t,position:t.getPosition()};this._glyphMarginWidgets.hasOwnProperty(t.getId())&&console.warn("Overwriting a glyph margin widget with the same id."),this._glyphMarginWidgets[t.getId()]=i,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addGlyphMarginWidget(i)}layoutGlyphMarginWidget(t){const i=t.getId();if(this._glyphMarginWidgets.hasOwnProperty(i)){const e=this._glyphMarginWidgets[i];e.position=t.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutGlyphMarginWidget(e)}}removeGlyphMarginWidget(t){const i=t.getId();if(this._glyphMarginWidgets.hasOwnProperty(i)){const t=this._glyphMarginWidgets[i];delete this._glyphMarginWidgets[i],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeGlyphMarginWidget(t)}}changeViewZones(t){this._modelData&&this._modelData.hasRealView&&this._modelData.view.change(t)}getTargetAtClientPoint(t,i){return this._modelData&&this._modelData.hasRealView?this._modelData.view.getTargetAtClientPoint(t,i):null}getScrolledVisiblePosition(t){if(!this._modelData||!this._modelData.hasRealView)return null;const i=this._modelData.model.validatePosition(t),e=this._configuration.options,s=e.get(145);return{top:pR._getVerticalOffsetForPosition(this._modelData,i.lineNumber,i.column)-this.getScrollTop(),left:this._modelData.view.getOffsetForColumn(i.lineNumber,i.column)+s.glyphMarginWidth+s.lineNumbersWidth+s.decorationsWidth-this.getScrollLeft(),height:e.get(67)}}getOffsetForColumn(t,i){return this._modelData&&this._modelData.hasRealView?this._modelData.view.getOffsetForColumn(t,i):-1}render(t=!1){this._modelData&&this._modelData.hasRealView&&this._modelData.view.render(!0,t)}setAriaOptions(t){this._modelData&&this._modelData.hasRealView&&this._modelData.view.setAriaOptions(t)}applyFontInfo(t){xl(t,this._configuration.options.get(50))}setBanner(t,i){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._domElement.removeChild(this._bannerDomNode),this._bannerDomNode=t,this._configuration.setReservedHeight(t?i:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(t){if(!t)return void(this._modelData=null);const i=[];this._domElement.setAttribute("data-mode-id",t.getLanguageId()),this._configuration.setIsDominatedByLongLines(t.isDominatedByLongLines()),this._configuration.setModelLineCount(t.getLineCount());const e=t.onBeforeAttached(),s=new nR(this._id,this._configuration,t,UE.create(Uh(this._domElement)),TF.create(this._configuration.options),(t=>ac(Uh(this._domElement),t)),this.languageConfigurationService,this._themeService,e);i.push(t.onWillDispose((()=>this.setModel(null)))),i.push(s.onEvent((i=>{switch(i.kind){case 0:this._onDidContentSizeChange.fire(i);break;case 1:this._editorTextFocus.setValue(i.hasFocus);break;case 2:this._onDidScrollChange.fire(i);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{if(i.reachedMaxCursorCount){const t=tt(0,"The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",this.getOption(80));this._notificationService.prompt(fR.Warning,t,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:tt(0,"Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}const t=[];for(let e=0,s=i.selections.length;e<s;e++)t[e]=i.selections[e].getPosition();const e={position:t[0],secondaryPositions:t.slice(1),reason:i.reason,source:i.source};this._onDidChangeCursorPosition.fire(e);const s={selection:i.selections[0],secondarySelections:i.selections.slice(1),modelVersionId:i.modelVersionId,oldSelections:i.oldSelections,oldModelVersionId:i.oldModelVersionId,source:i.source,reason:i.reason};this._onDidChangeCursorSelection.fire(s);break}case 7:this._onDidChangeModelDecorations.fire(i.event);break;case 8:this._domElement.setAttribute("data-mode-id",t.getLanguageId()),this._onDidChangeModelLanguage.fire(i.event);break;case 9:this._onDidChangeModelLanguageConfiguration.fire(i.event);break;case 10:this._onDidChangeModelContent.fire(i.event);break;case 11:this._onDidChangeModelOptions.fire(i.event);break;case 12:this._onDidChangeModelTokens.fire(i.event)}})));const[n,r]=this._createView(s);if(r){this._domElement.appendChild(n.domNode.domNode);let i=Object.keys(this._contentWidgets);for(let t=0,e=i.length;t<e;t++){const e=i[t];n.addContentWidget(this._contentWidgets[e])}i=Object.keys(this._overlayWidgets);for(let t=0,e=i.length;t<e;t++){const e=i[t];n.addOverlayWidget(this._overlayWidgets[e])}i=Object.keys(this._glyphMarginWidgets);for(let t=0,e=i.length;t<e;t++){const e=i[t];n.addGlyphMarginWidget(this._glyphMarginWidgets[e])}n.render(!1,!0),n.domNode.domNode.setAttribute("data-uri",t.uri.toString())}this._modelData=new yR(t,s,n,r,i,e)}_createView(t){let i;i=this.isSimpleWidget?{paste:(t,i,e,s)=>{this._paste("keyboard",t,i,e,s)},type:t=>{this._type("keyboard",t)},compositionType:(t,i,e,s)=>{this._compositionType("keyboard",t,i,e,s)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:{paste:(t,i,e,s)=>{const n={text:t,pasteOnNewLine:i,multicursorText:e,mode:s};this._commandService.executeCommand("paste",n)},type:t=>{const i={text:t};this._commandService.executeCommand("type",i)},compositionType:(t,i,e,s)=>{if(e||s){const n={text:t,replacePrevCharCnt:i,replaceNextCharCnt:e,positionDelta:s};this._commandService.executeCommand("compositionType",n)}else{const e={text:t,replaceCharCnt:i};this._commandService.executeCommand("replacePreviousChar",e)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};const e=new tD(t.coordinatesConverter);return e.onKeyDown=t=>this._onKeyDown.fire(t),e.onKeyUp=t=>this._onKeyUp.fire(t),e.onContextMenu=t=>this._onContextMenu.fire(t),e.onMouseMove=t=>this._onMouseMove.fire(t),e.onMouseLeave=t=>this._onMouseLeave.fire(t),e.onMouseDown=t=>this._onMouseDown.fire(t),e.onMouseUp=t=>this._onMouseUp.fire(t),e.onMouseDrag=t=>this._onMouseDrag.fire(t),e.onMouseDrop=t=>this._onMouseDrop.fire(t),e.onMouseDropCanceled=t=>this._onMouseDropCanceled.fire(t),e.onMouseWheel=t=>this._onMouseWheel.fire(t),[new ME(i,this._configuration,this._themeService.getColorTheme(),t,e,this._overflowWidgetsDomNode,this._instantiationService),!0]}_postDetachModelCleanup(t){t==null||t.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){var t;if((t=this._contributionsDisposable)===null||t===void 0||t.dispose(),this._contributionsDisposable=void 0,!this._modelData)return null;const i=this._modelData.model,e=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),e&&this._domElement.contains(e)&&this._domElement.removeChild(e),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._domElement.removeChild(this._bannerDomNode),i}_removeDecorationType(t){this._codeEditorService.removeDecorationType(t)}hasModel(){return this._modelData!==null}showDropIndicatorAt(t){const i=[{range:new Cs(t.lineNumber,t.column,t.lineNumber,t.column),options:pR.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(i),this.revealPosition(t,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}setContextValue(t,i){this._contextKeyService.createKey(t,i)}};vR.dropIntoEditorDecorationOptions=xF.register({description:"workbench-dnd-target",className:"dnd-target"}),vR=pR=mR([wR(3,Il),wR(4,Pl),wR(5,ql),wR(6,Ra),wR(7,AC),wR(8,gR),wR(9,vw),wR(10,cf),wR(11,$p)],vR);let bR=0,yR=class{constructor(t,i,e,s,n,r){this.model=t,this.viewModel=i,this.view=e,this.hasRealView=s,this.listenersToRemove=n,this.attachedView=r}dispose(){qi(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}};class kR extends Qi{constructor(t){super(),this._emitterOptions=t,this._onDidChangeToTrue=this._register(new le(this._emitterOptions)),this.onDidChangeToTrue=this._onDidChangeToTrue.event,this._onDidChangeToFalse=this._register(new le(this._emitterOptions)),this.onDidChangeToFalse=this._onDidChangeToFalse.event,this._value=0}setValue(t){const i=t?2:1;this._value!==i&&(this._value=i,this._value===2?this._onDidChangeToTrue.fire():this._value===1&&this._onDidChangeToFalse.fire())}}class CR extends le{constructor(t,i){super({deliveryQueue:i}),this._contributions=t}fire(t){this._contributions.onBeforeInteractionEvent(),super.fire(t)}}class SR extends Qi{constructor(t,i){super(),this._editor=t,i.createKey("editorId",t.getId()),this._editorSimpleInput=Ox.editorSimpleInput.bindTo(i),this._editorFocus=Ox.focus.bindTo(i),this._textInputFocus=Ox.textInputFocus.bindTo(i),this._editorTextFocus=Ox.editorTextFocus.bindTo(i),this._tabMovesFocus=Ox.tabMovesFocus.bindTo(i),this._editorReadonly=Ox.readOnly.bindTo(i),this._inDiffEditor=Ox.inDiffEditor.bindTo(i),this._editorColumnSelection=Ox.columnSelection.bindTo(i),this._hasMultipleSelections=Ox.hasMultipleSelections.bindTo(i),this._hasNonEmptySelection=Ox.hasNonEmptySelection.bindTo(i),this._canUndo=Ox.canUndo.bindTo(i),this._canRedo=Ox.canRedo.bindTo(i),this._register(this._editor.onDidChangeConfiguration((()=>this._updateFromConfig()))),this._register(this._editor.onDidChangeCursorSelection((()=>this._updateFromSelection()))),this._register(this._editor.onDidFocusEditorWidget((()=>this._updateFromFocus()))),this._register(this._editor.onDidBlurEditorWidget((()=>this._updateFromFocus()))),this._register(this._editor.onDidFocusEditorText((()=>this._updateFromFocus()))),this._register(this._editor.onDidBlurEditorText((()=>this._updateFromFocus()))),this._register(this._editor.onDidChangeModel((()=>this._updateFromModel()))),this._register(this._editor.onDidChangeConfiguration((()=>this._updateFromModel()))),this._register(ww.onDidChangeTabFocus((t=>this._tabMovesFocus.set(t)))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){const t=this._editor.getOptions();this._tabMovesFocus.set(ww.getTabFocusMode()),this._editorReadonly.set(t.get(91)),this._inDiffEditor.set(t.get(61)),this._editorColumnSelection.set(t.get(22))}_updateFromSelection(){const t=this._editor.getSelections();t?(this._hasMultipleSelections.set(t.length>1),this._hasNonEmptySelection.set(t.some((t=>!t.isEmpty())))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){const t=this._editor.getModel();this._canUndo.set(!!(t&&t.canUndo())),this._canRedo.set(!!(t&&t.canRedo()))}}class xR extends Qi{constructor(t,i,e){super(),this._editor=t,this._contextKeyService=i,this._languageFeaturesService=e,this._langId=Ox.languageId.bindTo(i),this._hasCompletionItemProvider=Ox.hasCompletionItemProvider.bindTo(i),this._hasCodeActionsProvider=Ox.hasCodeActionsProvider.bindTo(i),this._hasCodeLensProvider=Ox.hasCodeLensProvider.bindTo(i),this._hasDefinitionProvider=Ox.hasDefinitionProvider.bindTo(i),this._hasDeclarationProvider=Ox.hasDeclarationProvider.bindTo(i),this._hasImplementationProvider=Ox.hasImplementationProvider.bindTo(i),this._hasTypeDefinitionProvider=Ox.hasTypeDefinitionProvider.bindTo(i),this._hasHoverProvider=Ox.hasHoverProvider.bindTo(i),this._hasDocumentHighlightProvider=Ox.hasDocumentHighlightProvider.bindTo(i),this._hasDocumentSymbolProvider=Ox.hasDocumentSymbolProvider.bindTo(i),this._hasReferenceProvider=Ox.hasReferenceProvider.bindTo(i),this._hasRenameProvider=Ox.hasRenameProvider.bindTo(i),this._hasSignatureHelpProvider=Ox.hasSignatureHelpProvider.bindTo(i),this._hasInlayHintsProvider=Ox.hasInlayHintsProvider.bindTo(i),this._hasDocumentFormattingProvider=Ox.hasDocumentFormattingProvider.bindTo(i),this._hasDocumentSelectionFormattingProvider=Ox.hasDocumentSelectionFormattingProvider.bindTo(i),this._hasMultipleDocumentFormattingProvider=Ox.hasMultipleDocumentFormattingProvider.bindTo(i),this._hasMultipleDocumentSelectionFormattingProvider=Ox.hasMultipleDocumentSelectionFormattingProvider.bindTo(i),this._isInEmbeddedEditor=Ox.isInEmbeddedEditor.bindTo(i);const s=()=>this._update();this._register(t.onDidChangeModel(s)),this._register(t.onDidChangeModelLanguage(s)),this._register(e.completionProvider.onDidChange(s)),this._register(e.codeActionProvider.onDidChange(s)),this._register(e.codeLensProvider.onDidChange(s)),this._register(e.definitionProvider.onDidChange(s)),this._register(e.declarationProvider.onDidChange(s)),this._register(e.implementationProvider.onDidChange(s)),this._register(e.typeDefinitionProvider.onDidChange(s)),this._register(e.hoverProvider.onDidChange(s)),this._register(e.documentHighlightProvider.onDidChange(s)),this._register(e.documentSymbolProvider.onDidChange(s)),this._register(e.referenceProvider.onDidChange(s)),this._register(e.renameProvider.onDidChange(s)),this._register(e.documentFormattingEditProvider.onDidChange(s)),this._register(e.documentRangeFormattingEditProvider.onDidChange(s)),this._register(e.signatureHelpProvider.onDidChange(s)),this._register(e.inlayHintsProvider.onDidChange(s)),s()}dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents((()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInEmbeddedEditor.reset()}))}_update(){const t=this._editor.getModel();t?this._contextKeyService.bufferChangeEvents((()=>{this._langId.set(t.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(t)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(t)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(t)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(t)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(t)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(t)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(t)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(t)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(t)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(t)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(t)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(t)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(t)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(t)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(t)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(t)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(t)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(t).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(t).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(t).length>1),this._isInEmbeddedEditor.set(t.uri.scheme===Lh.walkThroughSnippet||t.uri.scheme===Lh.vscodeChatCodeBlock)})):this.reset()}}class DR extends Qi{constructor(t,i){super(),this._onChange=this._register(new le),this.onChange=this._onChange.event,this._hadFocus=void 0,this._hasDomElementFocus=!1,this._domFocusTracker=this._register(Qc(t)),this._overflowWidgetsDomNodeHasFocus=!1,this._register(this._domFocusTracker.onDidFocus((()=>{this._hasDomElementFocus=!0,this._update()}))),this._register(this._domFocusTracker.onDidBlur((()=>{this._hasDomElementFocus=!1,this._update()}))),i&&(this._overflowWidgetsDomNode=this._register(Qc(i)),this._register(this._overflowWidgetsDomNode.onDidFocus((()=>{this._overflowWidgetsDomNodeHasFocus=!0,this._update()}))),this._register(this._overflowWidgetsDomNode.onDidBlur((()=>{this._overflowWidgetsDomNodeHasFocus=!1,this._update()}))))}_update(){const t=this._hasDomElementFocus||this._overflowWidgetsDomNodeHasFocus;this._hadFocus!==t&&(this._hadFocus=t,this._onChange.fire(void 0))}hasFocus(){var t;return(t=this._hadFocus)!==null&&t!==void 0&&t}}class ER{get length(){return this._decorationIds.length}constructor(t,i){this._editor=t,this._decorationIds=[],this._isChangingDecorations=!1,Array.isArray(i)&&i.length>0&&this.set(i)}onDidChange(t,i,e){return this._editor.onDidChangeModelDecorations((e=>{this._isChangingDecorations||t.call(i,e)}),e)}getRange(t){return this._editor.hasModel()?t>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[t]):null}getRanges(){if(!this._editor.hasModel())return[];const t=this._editor.getModel(),i=[];for(const e of this._decorationIds){const s=t.getDecorationRange(e);s&&i.push(s)}return i}has(t){return this._decorationIds.includes(t.id)}clear(){this._decorationIds.length!==0&&this.set([])}set(t){try{this._isChangingDecorations=!0,this._editor.changeDecorations((i=>{this._decorationIds=i.deltaDecorations(this._decorationIds,t)}))}finally{this._isChangingDecorations=!1}return this._decorationIds}append(t){let i=[];try{this._isChangingDecorations=!0,this._editor.changeDecorations((e=>{i=e.deltaDecorations([],t),this._decorationIds=this._decorationIds.concat(i)}))}finally{this._isChangingDecorations=!1}return i}}const AR=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),MR=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function LR(t){return AR+encodeURIComponent(t.toString())+MR}const FR=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),TR=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');RC(((t,i)=>{const e=t.getColor(cv);e&&i.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${LR(e)}") repeat-x bottom left; }`);const s=t.getColor(uv);s&&i.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${LR(s)}") repeat-x bottom left; }`);const n=t.getColor(fv);n&&i.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${LR(n)}") repeat-x bottom left; }`);const r=t.getColor(pv);var o;r&&i.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${o=r,FR+encodeURIComponent(o.toString())+TR}") no-repeat bottom left; }`);const h=t.getColor(cS);h&&i.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${h.rgba.a}; }`)}));var RR=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},OR=function(t,i){return function(e,s){i(e,s,t)}};let IR=class extends Qi{constructor(t){super(),this._themeService=t,this._onWillCreateCodeEditor=this._register(new le),this._onCodeEditorAdd=this._register(new le),this.onCodeEditorAdd=this._onCodeEditorAdd.event,this._onCodeEditorRemove=this._register(new le),this.onCodeEditorRemove=this._onCodeEditorRemove.event,this._onWillCreateDiffEditor=this._register(new le),this._onDiffEditorAdd=this._register(new le),this.onDiffEditorAdd=this._onDiffEditorAdd.event,this._onDiffEditorRemove=this._register(new le),this.onDiffEditorRemove=this._onDiffEditorRemove.event,this._decorationOptionProviders=new Map,this._codeEditorOpenHandlers=new Ht,this._modelProperties=new Map,this._codeEditors=Object.create(null),this._diffEditors=Object.create(null),this._globalStyleSheet=null}willCreateCodeEditor(){this._onWillCreateCodeEditor.fire()}addCodeEditor(t){this._codeEditors[t.getId()]=t,this._onCodeEditorAdd.fire(t)}removeCodeEditor(t){delete this._codeEditors[t.getId()]&&this._onCodeEditorRemove.fire(t)}listCodeEditors(){return Object.keys(this._codeEditors).map((t=>this._codeEditors[t]))}willCreateDiffEditor(){this._onWillCreateDiffEditor.fire()}addDiffEditor(t){this._diffEditors[t.getId()]=t,this._onDiffEditorAdd.fire(t)}listDiffEditors(){return Object.keys(this._diffEditors).map((t=>this._diffEditors[t]))}getFocusedCodeEditor(){let t=null;const i=this.listCodeEditors();for(const e of i){if(e.hasTextFocus())return e;e.hasWidgetFocus()&&(t=e)}return t}removeDecorationType(t){const i=this._decorationOptionProviders.get(t);i&&(i.refCount--,i.refCount<=0&&(this._decorationOptionProviders.delete(t),i.dispose(),this.listCodeEditors().forEach((i=>i.removeDecorationsByType(t)))))}setModelProperty(t,i,e){const s=t.toString();let n;this._modelProperties.has(s)?n=this._modelProperties.get(s):(n=new Map,this._modelProperties.set(s,n)),n.set(i,e)}getModelProperty(t,i){const e=t.toString();if(this._modelProperties.has(e))return this._modelProperties.get(e).get(i)}async openCodeEditor(t,i,e){for(const s of this._codeEditorOpenHandlers){const n=await s(t,i,e);if(n!==null)return n}return null}registerCodeEditorOpenHandler(t){return Zi(this._codeEditorOpenHandlers.unshift(t))}};IR=RR([OR(0,AC)],IR);var _R=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},PR=function(t,i){return function(e,s){i(e,s,t)}};let NR=class extends IR{constructor(t,i){super(i),this._register(this.onCodeEditorAdd((()=>this._checkContextKey()))),this._register(this.onCodeEditorRemove((()=>this._checkContextKey()))),this._editorIsOpen=t.createKey("editorIsOpen",!1),this._activeCodeEditor=null,this._register(this.registerCodeEditorOpenHandler((async(t,i,e)=>i?this.doOpenEditor(i,t):null)))}_checkContextKey(){let t=!1;for(const i of this.listCodeEditors())if(!i.isSimpleWidget){t=!0;break}this._editorIsOpen.set(t)}setActiveCodeEditor(t){this._activeCodeEditor=t}getActiveCodeEditor(){return this._activeCodeEditor}doOpenEditor(t,i){if(!this.findModel(t,i.resource)){if(i.resource){const e=i.resource.scheme;if(e===Lh.http||e===Lh.https)return cl(i.resource.toString()),t}return null}const e=i.options?i.options.selection:null;if(e)if(typeof e.endLineNumber=="number"&&typeof e.endColumn=="number")t.setSelection(e),t.revealRangeInCenter(e,1);else{const i={lineNumber:e.startLineNumber,column:e.startColumn};t.setPosition(i),t.revealPositionInCenter(i,1)}return t}findModel(t,i){const e=t.getModel();return e&&e.uri.toString()!==i.toString()?null:e}};NR=_R([PR(0,Ra),PR(1,AC)],NR),Nd(Pl,NR,0);const BR=_l("layoutService");var $R=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},WR=function(t,i){return function(e,s){i(e,s,t)}};let jR=class{get mainContainer(){var t,i;return(i=(t=p(this._codeEditorService.listCodeEditors()))===null||t===void 0?void 0:t.getContainerDomNode())!==null&&i!==void 0?i:Wn.document.body}get activeContainer(){var t,i;const e=(t=this._codeEditorService.getFocusedCodeEditor())!==null&&t!==void 0?t:this._codeEditorService.getActiveCodeEditor();return(i=e==null?void 0:e.getContainerDomNode())!==null&&i!==void 0?i:this.mainContainer}get mainContainerDimension(){return gc(this.mainContainer)}get activeContainerDimension(){return gc(this.activeContainer)}get containers(){return a(this._codeEditorService.listCodeEditors().map((t=>t.getContainerDomNode())))}getContainer(){return this.activeContainer}whenContainerStylesLoaded(){}focus(){var t;(t=this._codeEditorService.getFocusedCodeEditor())===null||t===void 0||t.focus()}constructor(t){this._codeEditorService=t,this.onDidLayoutMainContainer=ne.None,this.onDidLayoutActiveContainer=ne.None,this.onDidLayoutContainer=ne.None,this.onDidChangeActiveContainer=ne.None,this.onDidAddContainer=ne.None,this.mainContainerOffset={top:0,quickPickTop:0},this.activeContainerOffset={top:0,quickPickTop:0}}};jR=$R([WR(0,Pl)],jR);let HR=class extends jR{get mainContainer(){return this._container}constructor(t,i){super(i),this._container=t}};HR=$R([WR(1,Pl)],HR),Nd(BR,jR,1);const VR=_l("dialogService");var zR=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},UR=function(t,i){return function(e,s){i(e,s,t)}};function KR(t){return t.scheme===Lh.file?t.fsPath:t.path}let qR=0;class GR{constructor(t,i,e,s,n,r,o){this.id=++qR,this.type=0,this.actual=t,this.label=t.label,this.confirmBeforeUndo=t.confirmBeforeUndo||!1,this.resourceLabel=i,this.strResource=e,this.resourceLabels=[this.resourceLabel],this.strResources=[this.strResource],this.groupId=s,this.groupOrder=n,this.sourceId=r,this.sourceOrder=o,this.isValid=!0}setValid(t){this.isValid=t}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.isValid?"  VALID":"INVALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class ZR{constructor(t,i){this.resourceLabel=t,this.reason=i}}class JR{constructor(){this.elements=new Map}createMessage(){const t=[],i=[];for(const[,e]of this.elements)(e.reason===0?t:i).push(e.resourceLabel);const e=[];return t.length>0&&e.push(tt(0,"The following files have been closed and modified on disk: {0}.",t.join(", "))),i.length>0&&e.push(tt(0,"The following files have been modified in an incompatible way: {0}.",i.join(", "))),e.join(`\n`)}get size(){return this.elements.size}has(t){return this.elements.has(t)}set(t,i){this.elements.set(t,i)}delete(t){return this.elements.delete(t)}}class QR{constructor(t,i,e,s,n,r,o){this.id=++qR,this.type=1,this.actual=t,this.label=t.label,this.confirmBeforeUndo=t.confirmBeforeUndo||!1,this.resourceLabels=i,this.strResources=e,this.groupId=s,this.groupOrder=n,this.sourceId=r,this.sourceOrder=o,this.removedResources=null,this.invalidatedResources=null}canSplit(){return typeof this.actual.split=="function"}removeResource(t,i,e){this.removedResources||(this.removedResources=new JR),this.removedResources.has(i)||this.removedResources.set(i,new ZR(t,e))}setValid(t,i,e){e?this.invalidatedResources&&(this.invalidatedResources.delete(i),this.invalidatedResources.size===0&&(this.invalidatedResources=null)):(this.invalidatedResources||(this.invalidatedResources=new JR),this.invalidatedResources.has(i)||this.invalidatedResources.set(i,new ZR(t,0)))}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.invalidatedResources?"INVALID":"  VALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class YR{constructor(t,i){this.resourceLabel=t,this.strResource=i,this._past=[],this._future=[],this.locked=!1,this.versionId=1}dispose(){for(const t of this._past)t.type===1&&t.removeResource(this.resourceLabel,this.strResource,0);for(const t of this._future)t.type===1&&t.removeResource(this.resourceLabel,this.strResource,0);this.versionId++}toString(){const t=[];t.push(`* ${this.strResource}:`);for(let i=0;i<this._past.length;i++)t.push(`   * [UNDO] ${this._past[i]}`);for(let i=this._future.length-1;i>=0;i--)t.push(`   * [REDO] ${this._future[i]}`);return t.join(`\n`)}flushAllElements(){this._past=[],this._future=[],this.versionId++}_setElementValidFlag(t,i){t.type===1?t.setValid(this.resourceLabel,this.strResource,i):t.setValid(i)}setElementsValidFlag(t,i){for(const e of this._past)i(e.actual)&&this._setElementValidFlag(e,t);for(const e of this._future)i(e.actual)&&this._setElementValidFlag(e,t)}pushElement(t){for(const t of this._future)t.type===1&&t.removeResource(this.resourceLabel,this.strResource,1);this._future=[],this._past.push(t),this.versionId++}createSnapshot(t){const i=[];for(let t=0,e=this._past.length;t<e;t++)i.push(this._past[t].id);for(let t=this._future.length-1;t>=0;t--)i.push(this._future[t].id);return new nF(t,i)}restoreSnapshot(t){const i=t.elements.length;let e=!0,s=0,n=-1;for(let r=0,o=this._past.length;r<o;r++,s++){const o=this._past[r];e&&(s>=i||o.id!==t.elements[s])&&(e=!1,n=0),e||o.type!==1||o.removeResource(this.resourceLabel,this.strResource,0)}let r=-1;for(let n=this._future.length-1;n>=0;n--,s++){const o=this._future[n];e&&(s>=i||o.id!==t.elements[s])&&(e=!1,r=n),e||o.type!==1||o.removeResource(this.resourceLabel,this.strResource,0)}n!==-1&&(this._past=this._past.slice(0,n)),r!==-1&&(this._future=this._future.slice(r+1)),this.versionId++}getElements(){const t=[],i=[];for(const i of this._past)t.push(i.actual);for(const t of this._future)i.push(t.actual);return{past:t,future:i}}getClosestPastElement(){return this._past.length===0?null:this._past[this._past.length-1]}getSecondClosestPastElement(){return this._past.length<2?null:this._past[this._past.length-2]}getClosestFutureElement(){return this._future.length===0?null:this._future[this._future.length-1]}hasPastElements(){return this._past.length>0}hasFutureElements(){return this._future.length>0}splitPastWorkspaceElement(t,i){for(let e=this._past.length-1;e>=0;e--)if(this._past[e]===t){i.has(this.strResource)?this._past[e]=i.get(this.strResource):this._past.splice(e,1);break}this.versionId++}splitFutureWorkspaceElement(t,i){for(let e=this._future.length-1;e>=0;e--)if(this._future[e]===t){i.has(this.strResource)?this._future[e]=i.get(this.strResource):this._future.splice(e,1);break}this.versionId++}moveBackward(t){this._past.pop(),this._future.push(t),this.versionId++}moveForward(t){this._future.pop(),this._past.push(t),this.versionId++}}class XR{constructor(t){this.editStacks=t,this._versionIds=[];for(let t=0,i=this.editStacks.length;t<i;t++)this._versionIds[t]=this.editStacks[t].versionId}isValid(){for(let t=0,i=this.editStacks.length;t<i;t++)if(this._versionIds[t]!==this.editStacks[t].versionId)return!1;return!0}}const tO=new YR("","");tO.locked=!0;let iO=class{constructor(t,i){this._dialogService=t,this._notificationService=i,this._editStacks=new Map,this._uriComparisonKeyComputers=[]}getUriComparisonKey(t){for(const i of this._uriComparisonKeyComputers)if(i[0]===t.scheme)return i[1].getComparisonKey(t);return t.toString()}_print(t){console.log("------------------------------------"),console.log(`AFTER ${t}: `);const i=[];for(const t of this._editStacks)i.push(t[1].toString());console.log(i.join(`\n`))}pushElement(t,i=rF.None,e=oF.None){if(t.type===0){const s=KR(t.resource),n=this.getUriComparisonKey(t.resource);this._pushElement(new GR(t,s,n,i.id,i.nextOrder(),e.id,e.nextOrder()))}else{const s=new Set,n=[],r=[];for(const i of t.resources){const t=KR(i),e=this.getUriComparisonKey(i);s.has(e)||(s.add(e),n.push(t),r.push(e))}n.length===1?this._pushElement(new GR(t,n[0],r[0],i.id,i.nextOrder(),e.id,e.nextOrder())):this._pushElement(new QR(t,n,r,i.id,i.nextOrder(),e.id,e.nextOrder()))}}_pushElement(t){for(let i=0,e=t.strResources.length;i<e;i++){const e=t.resourceLabels[i],s=t.strResources[i];let n;this._editStacks.has(s)?n=this._editStacks.get(s):(n=new YR(e,s),this._editStacks.set(s,n)),n.pushElement(t)}}getLastElement(t){const i=this.getUriComparisonKey(t);if(this._editStacks.has(i)){const t=this._editStacks.get(i);if(t.hasFutureElements())return null;const e=t.getClosestPastElement();return e?e.actual:null}return null}_splitPastWorkspaceElement(t,i){const e=t.actual.split(),s=new Map;for(const t of e){const i=KR(t.resource),e=this.getUriComparisonKey(t.resource),n=new GR(t,i,e,0,0,0,0);s.set(n.strResource,n)}for(const e of t.strResources)i&&i.has(e)||this._editStacks.get(e).splitPastWorkspaceElement(t,s)}_splitFutureWorkspaceElement(t,i){const e=t.actual.split(),s=new Map;for(const t of e){const i=KR(t.resource),e=this.getUriComparisonKey(t.resource),n=new GR(t,i,e,0,0,0,0);s.set(n.strResource,n)}for(const e of t.strResources)i&&i.has(e)||this._editStacks.get(e).splitFutureWorkspaceElement(t,s)}removeElements(t){const i=typeof t=="string"?t:this.getUriComparisonKey(t);this._editStacks.has(i)&&(this._editStacks.get(i).dispose(),this._editStacks.delete(i))}setElementsValidFlag(t,i,e){const s=this.getUriComparisonKey(t);this._editStacks.has(s)&&this._editStacks.get(s).setElementsValidFlag(i,e)}createSnapshot(t){const i=this.getUriComparisonKey(t);return this._editStacks.has(i)?this._editStacks.get(i).createSnapshot(t):new nF(t,[])}restoreSnapshot(t){const i=this.getUriComparisonKey(t.resource);if(this._editStacks.has(i)){const e=this._editStacks.get(i);e.restoreSnapshot(t),e.hasPastElements()||e.hasFutureElements()||(e.dispose(),this._editStacks.delete(i))}}getElements(t){const i=this.getUriComparisonKey(t);return this._editStacks.has(i)?this._editStacks.get(i).getElements():{past:[],future:[]}}_findClosestUndoElementWithSource(t){if(!t)return[null,null];let i=null,e=null;for(const[s,n]of this._editStacks){const r=n.getClosestPastElement();r&&r.sourceId===t&&(!i||r.sourceOrder>i.sourceOrder)&&(i=r,e=s)}return[i,e]}canUndo(t){if(t instanceof oF){const[,i]=this._findClosestUndoElementWithSource(t.id);return!!i}const i=this.getUriComparisonKey(t);return this._editStacks.has(i)?this._editStacks.get(i).hasPastElements():!1}_onError(t,i){Ii(t);for(const t of i.strResources)this.removeElements(t);this._notificationService.error(t)}_acquireLocks(t){for(const i of t.editStacks)if(i.locked)throw new Error("Cannot acquire edit stack lock");for(const i of t.editStacks)i.locked=!0;return()=>{for(const i of t.editStacks)i.locked=!1}}_safeInvokeWithLocks(t,i,e,s,n){const r=this._acquireLocks(e);let o;try{o=i()}catch(i){return r(),s.dispose(),this._onError(i,t)}return o?o.then((()=>(r(),s.dispose(),n())),(i=>(r(),s.dispose(),this._onError(i,t)))):(r(),s.dispose(),n())}async _invokeWorkspacePrepare(t){if(t.actual.prepareUndoRedo===void 0)return Qi.None;const i=t.actual.prepareUndoRedo();return i===void 0?Qi.None:i}_invokeResourcePrepare(t,i){if(t.actual.type!==1||t.actual.prepareUndoRedo===void 0)return i(Qi.None);const e=t.actual.prepareUndoRedo();return e?Ki(e)?i(e):e.then((t=>i(t))):i(Qi.None)}_getAffectedEditStacks(t){const i=[];for(const e of t.strResources)i.push(this._editStacks.get(e)||tO);return new XR(i)}_tryToSplitAndUndo(t,i,e,s){if(i.canSplit())return this._splitPastWorkspaceElement(i,e),this._notificationService.warn(s),new eO(this._undo(t,0,!0));for(const t of i.strResources)this.removeElements(t);return this._notificationService.warn(s),new eO}_checkWorkspaceUndo(t,i,e,s){if(i.removedResources)return this._tryToSplitAndUndo(t,i,i.removedResources,tt(0,"Could not undo '{0}' across all files. {1}",i.label,i.removedResources.createMessage()));if(s&&i.invalidatedResources)return this._tryToSplitAndUndo(t,i,i.invalidatedResources,tt(0,"Could not undo '{0}' across all files. {1}",i.label,i.invalidatedResources.createMessage()));const n=[];for(const t of e.editStacks)t.getClosestPastElement()!==i&&n.push(t.resourceLabel);if(n.length>0)return this._tryToSplitAndUndo(t,i,null,tt(0,"Could not undo '{0}' across all files because changes were made to {1}",i.label,n.join(", ")));const r=[];for(const t of e.editStacks)t.locked&&r.push(t.resourceLabel);return r.length>0?this._tryToSplitAndUndo(t,i,null,tt(0,"Could not undo '{0}' across all files because there is already an undo or redo operation running on {1}",i.label,r.join(", "))):e.isValid()?null:this._tryToSplitAndUndo(t,i,null,tt(0,"Could not undo '{0}' across all files because an undo or redo operation occurred in the meantime",i.label))}_workspaceUndo(t,i,e){const s=this._getAffectedEditStacks(i),n=this._checkWorkspaceUndo(t,i,s,!1);return n?n.returnValue:this._confirmAndExecuteWorkspaceUndo(t,i,s,e)}_isPartOfUndoGroup(t){if(!t.groupId)return!1;for(const[,i]of this._editStacks){const e=i.getClosestPastElement();if(e){if(e===t){const e=i.getSecondClosestPastElement();if(e&&e.groupId===t.groupId)return!0}if(e.groupId===t.groupId)return!0}}return!1}async _confirmAndExecuteWorkspaceUndo(t,i,e,s){if(i.canSplit()&&!this._isPartOfUndoGroup(i)){let n;(function(t){t[t.All=0]="All",t[t.This=1]="This",t[t.Cancel=2]="Cancel"})(n||(n={}));const{result:r}=await this._dialogService.prompt({type:dR.Info,message:tt(0,"Would you like to undo '{0}' across all files?",i.label),buttons:[{label:tt(0,"&&Undo in {0} Files",e.editStacks.length),run:()=>n.All},{label:tt(0,"Undo this &&File"),run:()=>n.This}],cancelButton:{run:()=>n.Cancel}});if(r===n.Cancel)return;if(r===n.This)return this._splitPastWorkspaceElement(i,null),this._undo(t,0,!0);const o=this._checkWorkspaceUndo(t,i,e,!1);if(o)return o.returnValue;s=!0}let n;try{n=await this._invokeWorkspacePrepare(i)}catch(t){return this._onError(t,i)}const r=this._checkWorkspaceUndo(t,i,e,!0);if(r)return n.dispose(),r.returnValue;for(const t of e.editStacks)t.moveBackward(i);return this._safeInvokeWithLocks(i,(()=>i.actual.undo()),e,n,(()=>this._continueUndoInGroup(i.groupId,s)))}_resourceUndo(t,i,e){if(i.isValid){if(!t.locked)return this._invokeResourcePrepare(i,(s=>(t.moveBackward(i),this._safeInvokeWithLocks(i,(()=>i.actual.undo()),new XR([t]),s,(()=>this._continueUndoInGroup(i.groupId,e))))));{const t=tt(0,"Could not undo '{0}' because there is already an undo or redo operation running.",i.label);this._notificationService.warn(t)}}else t.flushAllElements()}_findClosestUndoElementInGroup(t){if(!t)return[null,null];let i=null,e=null;for(const[s,n]of this._editStacks){const r=n.getClosestPastElement();r&&r.groupId===t&&(!i||r.groupOrder>i.groupOrder)&&(i=r,e=s)}return[i,e]}_continueUndoInGroup(t,i){if(!t)return;const[,e]=this._findClosestUndoElementInGroup(t);return e?this._undo(e,0,i):void 0}undo(t){if(t instanceof oF){const[,i]=this._findClosestUndoElementWithSource(t.id);return i?this._undo(i,t.id,!1):void 0}return typeof t=="string"?this._undo(t,0,!1):this._undo(this.getUriComparisonKey(t),0,!1)}_undo(t,i=0,e){if(!this._editStacks.has(t))return;const s=this._editStacks.get(t),n=s.getClosestPastElement();if(n){if(n.groupId){const[t,s]=this._findClosestUndoElementInGroup(n.groupId);if(n!==t&&s)return this._undo(s,i,e)}if((n.sourceId!==i||n.confirmBeforeUndo)&&!e)return this._confirmAndContinueUndo(t,i,n);try{return n.type===1?this._workspaceUndo(t,n,e):this._resourceUndo(s,n,e)}finally{}}}async _confirmAndContinueUndo(t,i,e){if((await this._dialogService.confirm({message:tt(0,"Would you like to undo '{0}'?",e.label),primaryButton:tt(0,"&&Yes"),cancelButton:tt(0,"No")})).confirmed)return this._undo(t,i,!0)}_findClosestRedoElementWithSource(t){if(!t)return[null,null];let i=null,e=null;for(const[s,n]of this._editStacks){const r=n.getClosestFutureElement();r&&r.sourceId===t&&(!i||r.sourceOrder<i.sourceOrder)&&(i=r,e=s)}return[i,e]}canRedo(t){if(t instanceof oF){const[,i]=this._findClosestRedoElementWithSource(t.id);return!!i}const i=this.getUriComparisonKey(t);return this._editStacks.has(i)?this._editStacks.get(i).hasFutureElements():!1}_tryToSplitAndRedo(t,i,e,s){if(i.canSplit())return this._splitFutureWorkspaceElement(i,e),this._notificationService.warn(s),new eO(this._redo(t));for(const t of i.strResources)this.removeElements(t);return this._notificationService.warn(s),new eO}_checkWorkspaceRedo(t,i,e,s){if(i.removedResources)return this._tryToSplitAndRedo(t,i,i.removedResources,tt(0,"Could not redo '{0}' across all files. {1}",i.label,i.removedResources.createMessage()));if(s&&i.invalidatedResources)return this._tryToSplitAndRedo(t,i,i.invalidatedResources,tt(0,"Could not redo '{0}' across all files. {1}",i.label,i.invalidatedResources.createMessage()));const n=[];for(const t of e.editStacks)t.getClosestFutureElement()!==i&&n.push(t.resourceLabel);if(n.length>0)return this._tryToSplitAndRedo(t,i,null,tt(0,"Could not redo '{0}' across all files because changes were made to {1}",i.label,n.join(", ")));const r=[];for(const t of e.editStacks)t.locked&&r.push(t.resourceLabel);return r.length>0?this._tryToSplitAndRedo(t,i,null,tt(0,"Could not redo '{0}' across all files because there is already an undo or redo operation running on {1}",i.label,r.join(", "))):e.isValid()?null:this._tryToSplitAndRedo(t,i,null,tt(0,"Could not redo '{0}' across all files because an undo or redo operation occurred in the meantime",i.label))}_workspaceRedo(t,i){const e=this._getAffectedEditStacks(i),s=this._checkWorkspaceRedo(t,i,e,!1);return s?s.returnValue:this._executeWorkspaceRedo(t,i,e)}async _executeWorkspaceRedo(t,i,e){let s;try{s=await this._invokeWorkspacePrepare(i)}catch(t){return this._onError(t,i)}const n=this._checkWorkspaceRedo(t,i,e,!0);if(n)return s.dispose(),n.returnValue;for(const t of e.editStacks)t.moveForward(i);return this._safeInvokeWithLocks(i,(()=>i.actual.redo()),e,s,(()=>this._continueRedoInGroup(i.groupId)))}_resourceRedo(t,i){if(i.isValid){if(!t.locked)return this._invokeResourcePrepare(i,(e=>(t.moveForward(i),this._safeInvokeWithLocks(i,(()=>i.actual.redo()),new XR([t]),e,(()=>this._continueRedoInGroup(i.groupId))))));{const t=tt(0,"Could not redo '{0}' because there is already an undo or redo operation running.",i.label);this._notificationService.warn(t)}}else t.flushAllElements()}_findClosestRedoElementInGroup(t){if(!t)return[null,null];let i=null,e=null;for(const[s,n]of this._editStacks){const r=n.getClosestFutureElement();r&&r.groupId===t&&(!i||r.groupOrder<i.groupOrder)&&(i=r,e=s)}return[i,e]}_continueRedoInGroup(t){if(!t)return;const[,i]=this._findClosestRedoElementInGroup(t);return i?this._redo(i):void 0}redo(t){if(t instanceof oF){const[,i]=this._findClosestRedoElementWithSource(t.id);return i?this._redo(i):void 0}return typeof t=="string"?this._redo(t):this._redo(this.getUriComparisonKey(t))}_redo(t){if(!this._editStacks.has(t))return;const i=this._editStacks.get(t),e=i.getClosestFutureElement();if(e){if(e.groupId){const[t,i]=this._findClosestRedoElementInGroup(e.groupId);if(e!==t&&i)return this._redo(i)}try{return e.type===1?this._workspaceRedo(t,e):this._resourceRedo(i,e)}finally{}}}};iO=zR([UR(0,VR),UR(1,gR)],iO);class eO{constructor(t){this.returnValue=t}}function sO(t,i,e){return Math.min(Math.max(t,i),e)}Nd(sF,iO,1);class nO{constructor(){this._n=1,this._val=0}update(t){return this._val=this._val+(t-this._val)/this._n,this._n+=1,this._val}get value(){return this._val}}class rO{constructor(t){this._n=0,this._val=0,this._values=[],this._index=0,this._sum=0,this._values=new Array(t),this._values.fill(0,0,t)}update(t){const i=this._values[this._index];return this._values[this._index]=t,this._index=(this._index+1)%this._values.length,this._sum-=i,this._sum+=t,this._n<this._values.length&&(this._n+=1),this._val=this._sum/this._n,this._val}get value(){return this._val}}const oO=_l("environmentService");var hO=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},cO=function(t,i){return function(e,s){i(e,s,t)}};const lO=_l("ILanguageFeatureDebounceService");var aO;(function(t){const i=new WeakMap;let e=0;t.of=function(t){let s=i.get(t);return s===void 0&&(s=++e,i.set(t,s)),s}})(aO||(aO={}));class uO{constructor(t){this._default=t}get(t){return this._default}update(t,i){return this._default}default(){return this._default}}class dO{constructor(t,i,e,s,n,r){this._logService=t,this._name=i,this._registry=e,this._default=s,this._min=n,this._max=r,this._cache=new Kf(50,.7)}_key(t){return t.id+this._registry.all(t).reduce(((t,i)=>Nh(aO.of(i),t)),0)}get(t){const i=this._key(t),e=this._cache.get(i);return e?sO(e.value,this._min,this._max):this.default()}update(t,i){const e=this._key(t);let s=this._cache.get(e);s||(s=new rO(6),this._cache.set(e,s));const n=sO(s.update(i),this._min,this._max);return Fh(t.uri,"output")||this._logService.trace(`[DEBOUNCE: ${this._name}] for ${t.uri.toString()} is ${n}ms`),n}_overall(){const t=new nO;for(const[,i]of this._cache)t.update(i.value);return t.value}default(){return sO(0|this._overall()||this._default,this._min,this._max)}}let fO=class{constructor(t,i){this._logService=t,this._data=new Map,this._isDev=i.isExtensionDevelopment||!i.isBuilt}for(t,i,e){var s,n,r;const o=(s=e==null?void 0:e.min)!==null&&s!==void 0?s:50,h=(n=e==null?void 0:e.max)!==null&&n!==void 0?n:o**2,c=(r=e==null?void 0:e.key)!==null&&r!==void 0?r:void 0,l=`${aO.of(t)},${o}${c?","+c:""}`;let a=this._data.get(l);return a||(this._isDev?a=new dO(this._logService,i,t,0|this._overallAverage()||1.5*o,o,h):(this._logService.debug(`[DEBOUNCE: ${i}] is disabled in developed mode`),a=new uO(1.5*o)),this._data.set(l,a)),a}_overallAverage(){const t=new nO;for(const i of this._data.values())t.update(i.default());return t.value}};fO=hO([cO(0,ou),cO(1,oO)],fO),Nd(lO,fO,1);class gO{static create(t,i){return new gO(t,new pO(i))}get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._endLineNumber}constructor(t,i){this._startLineNumber=t,this._tokens=i,this._endLineNumber=this._startLineNumber+this._tokens.getMaxDeltaLine()}toString(){return this._tokens.toString(this._startLineNumber)}_updateEndLineNumber(){this._endLineNumber=this._startLineNumber+this._tokens.getMaxDeltaLine()}isEmpty(){return this._tokens.isEmpty()}getLineTokens(t){return this._startLineNumber<=t&&t<=this._endLineNumber?this._tokens.getLineTokens(t-this._startLineNumber):null}getRange(){const t=this._tokens.getRange();return t&&new Cs(this._startLineNumber+t.startLineNumber,t.startColumn,this._startLineNumber+t.endLineNumber,t.endColumn)}removeTokens(t){const i=t.startLineNumber-this._startLineNumber,e=t.endLineNumber-this._startLineNumber;this._startLineNumber+=this._tokens.removeTokens(i,t.startColumn-1,e,t.endColumn-1),this._updateEndLineNumber()}split(t){const i=t.startLineNumber-this._startLineNumber,e=t.endLineNumber-this._startLineNumber,[s,n,r]=this._tokens.split(i,t.startColumn-1,e,t.endColumn-1);return[new gO(this._startLineNumber,s),new gO(this._startLineNumber+r,n)]}applyEdit(t,i){const[e,s,n]=YE(i);this.acceptEdit(t,e,s,n,i.length>0?i.charCodeAt(0):0)}acceptEdit(t,i,e,s,n){this._acceptDeleteRange(t),this._acceptInsertText(new ks(t.startLineNumber,t.startColumn),i,e,s,n),this._updateEndLineNumber()}_acceptDeleteRange(t){if(t.startLineNumber===t.endLineNumber&&t.startColumn===t.endColumn)return;const i=t.startLineNumber-this._startLineNumber,e=t.endLineNumber-this._startLineNumber;if(e<0){const t=e-i;return void(this._startLineNumber-=t)}const s=this._tokens.getMaxDeltaLine();if(!(i>=s+1)){if(i<0&&e>=s+1)return this._startLineNumber=0,void this._tokens.clear();if(i<0){const s=-i;this._startLineNumber-=s,this._tokens.acceptDeleteRange(t.startColumn-1,0,0,e,t.endColumn-1)}else this._tokens.acceptDeleteRange(0,i,t.startColumn-1,e,t.endColumn-1)}}_acceptInsertText(t,i,e,s,n){if(i===0&&e===0)return;const r=t.lineNumber-this._startLineNumber;if(r<0)return void(this._startLineNumber+=i);r>=this._tokens.getMaxDeltaLine()+1||this._tokens.acceptInsertText(r,t.column-1,i,e,s,n)}}class pO{constructor(t){this._tokens=t,this._tokenCount=t.length/4}toString(t){const i=[];for(let e=0;e<this._tokenCount;e++)i.push(`(${this._getDeltaLine(e)+t},${this._getStartCharacter(e)}-${this._getEndCharacter(e)})`);return`[${i.join(",")}]`}getMaxDeltaLine(){const t=this._getTokenCount();return t===0?-1:this._getDeltaLine(t-1)}getRange(){const t=this._getTokenCount();if(t===0)return null;const i=this._getStartCharacter(0),e=this._getDeltaLine(t-1),s=this._getEndCharacter(t-1);return new Cs(0,i+1,e,s+1)}_getTokenCount(){return this._tokenCount}_getDeltaLine(t){return this._tokens[4*t]}_getStartCharacter(t){return this._tokens[4*t+1]}_getEndCharacter(t){return this._tokens[4*t+2]}isEmpty(){return this._getTokenCount()===0}getLineTokens(t){let i=0,e=this._getTokenCount()-1;for(;i<e;){const s=i+Math.floor((e-i)/2),n=this._getDeltaLine(s);if(n<t)i=s+1;else{if(!(n>t)){let n=s;for(;n>i&&this._getDeltaLine(n-1)===t;)n--;let r=s;for(;r<e&&this._getDeltaLine(r+1)===t;)r++;return new mO(this._tokens.subarray(4*n,4*r+4))}e=s-1}}return this._getDeltaLine(i)===t?new mO(this._tokens.subarray(4*i,4*i+4)):null}clear(){this._tokenCount=0}removeTokens(t,i,e,s){const n=this._tokens,r=this._tokenCount;let o=0,h=!1,c=0;for(let l=0;l<r;l++){const r=4*l,a=n[r],u=n[r+1],d=n[r+2],f=n[r+3];if((a>t||a===t&&d>=i)&&(a<e||a===e&&u<=s))h=!0;else{if(o===0&&(c=a),h){const t=4*o;n[t]=a-c,n[t+1]=u,n[t+2]=d,n[t+3]=f}o++}}return this._tokenCount=o,c}split(t,i,e,s){const n=this._tokens,r=this._tokenCount,o=[],h=[];let c=o,l=0,a=0;for(let o=0;o<r;o++){const r=4*o,u=n[r],d=n[r+1],f=n[r+2],g=n[r+3];if(u>t||u===t&&f>=i){if(u<e||u===e&&d<=s)continue;c!==h&&(c=h,l=0,a=u)}c[l++]=u-a,c[l++]=d,c[l++]=f,c[l++]=g}return[new pO(new Uint32Array(o)),new pO(new Uint32Array(h)),a]}acceptDeleteRange(t,i,e,s,n){const r=this._tokens,o=this._tokenCount,h=s-i;let c=0,l=!1;for(let a=0;a<o;a++){const u=4*a;let d=r[u],f=r[u+1],g=r[u+2];const p=r[u+3];if(d<i||d===i&&g<=e){c++;continue}if(d===i&&f<e)d===s&&g>n?g-=n-e:g=e;else if(d===i&&f===e){if(!(d===s&&g>n)){l=!0;continue}g-=n-e}else if(d<s||d===s&&f<n){if(!(d===s&&g>n)){l=!0;continue}d=i,f=e,g=f+(g-n)}else if(d>s){if(h===0&&!l){c=o;break}d-=h}else{if(!(d===s&&f>=n))throw new Error("Not possible!");t&&d===0&&(f+=t,g+=t),d-=h,f-=n-e,g-=n-e}const m=4*c;r[m]=d,r[m+1]=f,r[m+2]=g,r[m+3]=p,c++}this._tokenCount=c}acceptInsertText(t,i,e,s,n,r){const o=e===0&&s===1&&(r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122),h=this._tokens,c=this._tokenCount;for(let r=0;r<c;r++){const c=4*r;let l=h[c],a=h[c+1],u=h[c+2];if(!(l<t||l===t&&u<i)){if(l===t&&u===i){if(!o)continue;u+=1}else if(l===t&&a<i&&i<u)e===0?u+=s:u=i;else{if(l===t&&a===i&&o)continue;if(l===t)if(l+=e,e===0)a+=s,u+=s;else{const t=u-a;a=n+(a-i),u=a+t}else l+=e}h[c]=l,h[c+1]=a,h[c+2]=u}}}}class mO{constructor(t){this._tokens=t}getCount(){return this._tokens.length/4}getStartCharacter(t){return this._tokens[4*t+1]}getEndCharacter(t){return this._tokens[4*t+2]}getMetadata(t){return this._tokens[4*t+3]}}var wO=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},vO=function(t,i){return function(e,s){i(e,s,t)}};let bO=class{constructor(t,i,e,s){this._legend=t,this._themeService=i,this._languageService=e,this._logService=s,this._hasWarnedOverlappingTokens=!1,this._hasWarnedInvalidLengthTokens=!1,this._hasWarnedInvalidEditStart=!1,this._hashTable=new CO}getMetadata(t,i,e){const s=this._languageService.languageIdCodec.encodeLanguageId(e),n=this._hashTable.get(t,i,s);let r;if(n)r=n.metadata,this._logService.getLevel()===hu.Trace&&this._logService.trace(`SemanticTokensProviderStyling [CACHED] ${t} / ${i}: foreground ${em.getForeground(r)}, fontStyle ${em.getFontStyle(r).toString(2)}`);else{let n=this._legend.tokenTypes[t];const o=[];if(n){let t=i;for(let i=0;t>0&&i<this._legend.tokenModifiers.length;i++)1&t&&o.push(this._legend.tokenModifiers[i]),t>>=1;t>0&&this._logService.getLevel()===hu.Trace&&(this._logService.trace(`SemanticTokensProviderStyling: unknown token modifier index: ${i.toString(2)} for legend: ${JSON.stringify(this._legend.tokenModifiers)}`),o.push("not-in-legend"));const s=this._themeService.getColorTheme().getTokenStyleMetadata(n,o,e);s===void 0?r=2147483647:(r=0,s.italic!==void 0&&(r|=1|(s.italic?1:0)<<11),s.bold!==void 0&&(r|=2|(s.bold?2:0)<<11),s.underline!==void 0&&(r|=4|(s.underline?4:0)<<11),s.strikethrough!==void 0&&(r|=8|(s.strikethrough?8:0)<<11),s.foreground&&(r|=16|s.foreground<<15),r===0&&(r=2147483647))}else this._logService.getLevel()===hu.Trace&&this._logService.trace(`SemanticTokensProviderStyling: unknown token type index: ${t} for legend: ${JSON.stringify(this._legend.tokenTypes)}`),r=2147483647,n="not-in-legend";this._hashTable.add(t,i,s,r),this._logService.getLevel()===hu.Trace&&this._logService.trace(`SemanticTokensProviderStyling ${t} (${n}) / ${i} (${o.join(" ")}): foreground ${em.getForeground(r)}, fontStyle ${em.getFontStyle(r).toString(2)}`)}return r}warnOverlappingSemanticTokens(t,i){this._hasWarnedOverlappingTokens||(this._hasWarnedOverlappingTokens=!0,this._logService.warn(`Overlapping semantic tokens detected at lineNumber ${t}, column ${i}`))}warnInvalidLengthSemanticTokens(t,i){this._hasWarnedInvalidLengthTokens||(this._hasWarnedInvalidLengthTokens=!0,this._logService.warn(`Semantic token with invalid length detected at lineNumber ${t}, column ${i}`))}warnInvalidEditStart(t,i,e,s,n){this._hasWarnedInvalidEditStart||(this._hasWarnedInvalidEditStart=!0,this._logService.warn(`Invalid semantic tokens edit detected (previousResultId: ${t}, resultId: ${i}) at edit #${e}: The provided start offset ${s} is outside the previous data (length ${n}).`))}};function yO(t,i,e){const s=t.data,n=t.data.length/5|0,r=Math.max(Math.ceil(n/1024),400),o=[];let h=0,c=1,l=0;for(;h<n;){const t=h;let a=Math.min(t+r,n);if(a<n){let i=a;for(;i-1>t&&s[5*i]===0;)i--;if(i-1===t){let t=a;for(;t+1<n&&s[5*t]===0;)t++;a=t}else a=i}let u=new Uint32Array(4*(a-t)),d=0,f=0,g=0,p=0;for(;h<a;){const t=5*h,n=s[t],r=s[t+1],o=c+n|0,a=n===0?l+r|0:r,m=a+s[t+2]|0,w=s[t+3],v=s[t+4];if(m<=a)i.warnInvalidLengthSemanticTokens(o,a+1);else if(g===o&&p>a)i.warnOverlappingSemanticTokens(o,a+1);else{const t=i.getMetadata(w,v,e);t!==2147483647&&(f===0&&(f=o),u[d]=o-f,u[d+1]=a,u[d+2]=m,u[d+3]=t,d+=4,g=o,p=m)}c=o,l=a,h++}d!==u.length&&(u=u.subarray(0,d));const m=gO.create(f,u);o.push(m)}return o}bO=wO([vO(1,AC),vO(2,Id),vO(3,ou)],bO);class kO{constructor(t,i,e,s){this.tokenTypeIndex=t,this.tokenModifierSet=i,this.languageId=e,this.metadata=s,this.next=null}}class CO{constructor(){this._elementsCount=0,this._currentLengthIndex=0,this._currentLength=CO._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<CO._SIZES.length?2/3*this._currentLength:0),this._elements=[],CO._nullOutEntries(this._elements,this._currentLength)}static _nullOutEntries(t,i){for(let e=0;e<i;e++)t[e]=null}_hash2(t,i){return(t<<5)-t+i|0}_hashFunc(t,i,e){return this._hash2(this._hash2(t,i),e)%this._currentLength}get(t,i,e){const s=this._hashFunc(t,i,e);let n=this._elements[s];for(;n;){if(n.tokenTypeIndex===t&&n.tokenModifierSet===i&&n.languageId===e)return n;n=n.next}return null}add(t,i,e,s){if(this._elementsCount++,this._growCount!==0&&this._elementsCount>=this._growCount){const t=this._elements;this._currentLengthIndex++,this._currentLength=CO._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<CO._SIZES.length?2/3*this._currentLength:0),this._elements=[],CO._nullOutEntries(this._elements,this._currentLength);for(const i of t){let t=i;for(;t;){const i=t.next;t.next=null,this._add(t),t=i}}}this._add(new kO(t,i,e,s))}_add(t){const i=this._hashFunc(t.tokenTypeIndex,t.tokenModifierSet,t.languageId);t.next=this._elements[i],this._elements[i]=t}}CO._SIZES=[3,7,13,31,61,127,251,509,1021,2039,4093,8191,16381,32749,65521,131071,262139,524287,1048573,2097143];const SO=_l("semanticTokensStylingService");var xO=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},DO=function(t,i){return function(e,s){i(e,s,t)}};let EO=class extends Qi{constructor(t,i,e){super(),this._themeService=t,this._logService=i,this._languageService=e,this._caches=new WeakMap,this._register(this._themeService.onDidColorThemeChange((()=>{this._caches=new WeakMap})))}getStyling(t){return this._caches.has(t)||this._caches.set(t,new bO(t.getLegend(),this._themeService,this._languageService,this._logService)),this._caches.get(t)}};EO=xO([DO(0,AC),DO(1,ou),DO(2,Id)],EO),Nd(SO,EO,1);const AO="**",MO="/",LO="[/\\\\]",FO="[^/\\\\]",TO=/\//g;function RO(t,i){switch(t){case 0:return"";case 1:return`${FO}*?`;default:return`(?:${LO}|${FO}+${LO}${i?`|${LO}${FO}+`:""})*?`}}function OO(t,i){if(!t)return[];const e=[];let s=!1,n=!1,r="";for(const o of t){switch(o){case i:if(!s&&!n){e.push(r),r="";continue}break;case"{":s=!0;break;case"}":s=!1;break;case"[":n=!0;break;case"]":n=!1}r+=o}return r&&e.push(r),e}function IO(t){if(!t)return"";let i="";const e=OO(t,MO);if(e.every((t=>t===AO)))i=".*";else{let t=!1;e.forEach(((s,n)=>{if(s===AO){if(t)return;i+=RO(2,n===e.length-1)}else{let t=!1,r="",o=!1,h="";for(const e of s)if(e!=="}"&&t)r+=e;else if(!o||e==="]"&&h)switch(e){case"{":t=!0;continue;case"[":o=!0;continue;case"}":{const e=`(?:${OO(r,",").map((t=>IO(t))).join("|")})`;i+=e,t=!1,r="";break}case"]":i+="["+h+"]",o=!1,h="";break;case"?":i+=FO;continue;case"*":i+=RO(1);continue;default:i+=Gn(e)}else{let t;t=e==="-"?e:e!=="^"&&e!=="!"||h?e===MO?"":Gn(e):"^",h+=t}n<e.length-1&&(e[n+1]!==AO||n+2<e.length)&&(i+=LO)}t=s===AO}))}return i}const _O=/^\*\*\/\*\.[\w\.-]+$/,PO=/^\*\*\/([\w\.-]+)\/?$/,NO=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,BO=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,$O=/^\*\*((\/[\w\.-]+)+)\/?$/,WO=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,jO=new Kf(1e4),HO=function(){return!1},VO=function(){return null};function zO(t,i){if(!t)return VO;let e;e=typeof t!="string"?t.pattern:t,e=e.trim();const s=`${e}_${!!i.trimForExclusions}`;let n,r=jO.get(s);return r||(r=_O.test(e)?function(t,i){return function(e,s){return typeof e=="string"&&e.endsWith(t)?i:null}}(e.substr(4),e):(n=PO.exec(KO(e,i)))?function(t,i){const e=`/${t}`,s=`\\${t}`,n=function(n,r){return typeof n!="string"?null:r?r===t?i:null:n===t||n.endsWith(e)||n.endsWith(s)?i:null},r=[t];return n.basenames=r,n.patterns=[i],n.allBasenames=r,n}(n[1],e):(i.trimForExclusions?BO:NO).test(e)?function(t,i){const e=ZO(t.slice(1,-1).split(",").map((t=>zO(t,i))).filter((t=>t!==VO)),t),s=e.length;if(!s)return VO;if(s===1)return e[0];const n=function(i,s){for(let n=0,r=e.length;n<r;n++)if(e[n](i,s))return t;return null},r=e.find((t=>!!t.allBasenames));r&&(n.allBasenames=r.allBasenames);const o=e.reduce(((t,i)=>i.allPaths?t.concat(i.allPaths):t),[]);return o.length&&(n.allPaths=o),n}(e,i):(n=$O.exec(KO(e,i)))?qO(n[1].substr(1),e,!0):(n=WO.exec(KO(e,i)))?qO(n[1],e,!1):function(t){try{const i=new RegExp(`^${IO(t)}$`);return function(e){return i.lastIndex=0,typeof e=="string"&&i.test(e)?t:null}}catch{return VO}}(e),jO.set(s,r)),UO(r,t)}function UO(t,i){if(typeof i=="string")return t;const e=function(e,s){return wM(e,i.base,!yt)?t(Jn(e.substr(i.base.length),ss),s):null};return e.allBasenames=t.allBasenames,e.allPaths=t.allPaths,e.basenames=t.basenames,e.patterns=t.patterns,e}function KO(t,i){return i.trimForExclusions&&t.endsWith("/**")?t.substr(0,t.length-2):t}function qO(t,i,e){const s=ss===Je.sep,n=s?t:t.replace(TO,ss),r=ss+n,o=Je.sep+t;let h;return h=e?function(e,h){return typeof e!="string"||e!==n&&!e.endsWith(r)&&(s||e!==t&&!e.endsWith(o))?null:i}:function(e,r){return typeof e!="string"||e!==n&&(s||e!==t)?null:i},h.allPaths=[(e?"*/":"./")+t],h}function GO(t,i={}){if(!t)return HO;if(typeof t=="string"||function(t){const i=t;return i?typeof i.base=="string"&&typeof i.pattern=="string":!1}(t)){const e=zO(t,i);if(e===VO)return HO;const s=function(t,i){return!!e(t,i)};return e.allBasenames&&(s.allBasenames=e.allBasenames),e.allPaths&&(s.allPaths=e.allPaths),s}return function(t,i){const e=ZO(Object.getOwnPropertyNames(t).map((e=>function(t,i,e){if(i===!1)return VO;const s=zO(t,e);if(s===VO)return VO;if(typeof i=="boolean")return s;if(i){const e=i.when;if(typeof e=="string"){const i=(i,n,r,o)=>{if(!o||!s(i,n))return null;const h=o(e.replace("$(basename)",(()=>r)));return ao(h)?h.then((i=>i?t:null)):h?t:null};return i.requiresSiblings=!0,i}}return s}(e,t[e],i))).filter((t=>t!==VO))),s=e.length;if(!s)return VO;if(!e.some((t=>!!t.requiresSiblings))){if(s===1)return e[0];const t=function(t,i){let s;for(let n=0,r=e.length;n<r;n++){const r=e[n](t,i);if(typeof r=="string")return r;ao(r)&&(s||(s=[]),s.push(r))}return s?(async()=>{for(const t of s){const i=await t;if(typeof i=="string")return i}return null})():null},i=e.find((t=>!!t.allBasenames));i&&(t.allBasenames=i.allBasenames);const n=e.reduce(((t,i)=>i.allPaths?t.concat(i.allPaths):t),[]);return n.length&&(t.allPaths=n),t}const n=function(t,i,s){let n,r;for(let o=0,h=e.length;o<h;o++){const h=e[o];h.requiresSiblings&&s&&(i||(i=is(t)),n||(n=i.substr(0,i.length-es(t).length)));const c=h(t,i,n,s);if(typeof c=="string")return c;ao(c)&&(r||(r=[]),r.push(c))}return r?(async()=>{for(const t of r){const i=await t;if(typeof i=="string")return i}return null})():null},r=e.find((t=>!!t.allBasenames));r&&(n.allBasenames=r.allBasenames);const o=e.reduce(((t,i)=>i.allPaths?t.concat(i.allPaths):t),[]);return o.length&&(n.allPaths=o),n}(t,i)}function ZO(t,i){const e=t.filter((t=>!!t.basenames));if(e.length<2)return t;const s=e.reduce(((t,i)=>{const e=i.basenames;return e?t.concat(e):t}),[]);let n;if(i){n=[];for(let t=0,e=s.length;t<e;t++)n.push(i)}else n=e.reduce(((t,i)=>{const e=i.patterns;return e?t.concat(e):t}),[]);const r=function(t,i){if(typeof t!="string")return null;if(!i){let e;for(e=t.length;e>0;e--){const i=t.charCodeAt(e-1);if(i===47||i===92)break}i=t.substr(e)}const e=s.indexOf(i);return e!==-1?n[e]:null};r.basenames=s,r.patterns=n,r.allBasenames=s;const o=t.filter((t=>!t.basenames));return o.push(r),o}function JO(t,i,e,s,n,r){if(Array.isArray(t)){let o=0;for(const h of t){const t=JO(h,i,e,s,n,r);if(t===10)return t;t>o&&(o=t)}return o}if(typeof t=="string")return s?t==="*"?5:t===e?10:0:0;if(t){const{language:l,pattern:a,scheme:u,hasAccessToAllModels:d,notebookType:f}=t;if(!s&&!d)return 0;f&&n&&(i=n);let g=0;if(u)if(u===i.scheme)g=10;else{if(u!=="*")return 0;g=5}if(l)if(l===e)g=10;else{if(l!=="*")return 0;g=Math.max(g,5)}if(f)if(f===r)g=10;else{if(f!=="*"||r===void 0)return 0;g=Math.max(g,5)}if(a){let t;if(t=typeof a=="string"?a:{...a,base:Qe(a.base)},t!==i.fsPath&&(o=t,h=i.fsPath,!o||typeof h!="string"||!GO(o)(h,void 0,c)))return 0;g=10}return g}return 0;var o,h,c}function QO(t){return typeof t!="string"&&(Array.isArray(t)?t.every(QO):!!t.exclusive)}class YO{constructor(t,i,e,s){this.uri=t,this.languageId=i,this.notebookUri=e,this.notebookType=s}equals(t){var i,e;return this.notebookType===t.notebookType&&this.languageId===t.languageId&&this.uri.toString()===t.uri.toString()&&((i=this.notebookUri)===null||i===void 0?void 0:i.toString())===((e=t.notebookUri)===null||e===void 0?void 0:e.toString())}}class XO{constructor(t){this._notebookInfoResolver=t,this._clock=0,this._entries=[],this._onDidChange=new le,this.onDidChange=this._onDidChange.event}register(t,i){let e={selector:t,provider:i,_score:-1,_time:this._clock++};return this._entries.push(e),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),Zi((()=>{if(e){const t=this._entries.indexOf(e);t>=0&&(this._entries.splice(t,1),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),e=void 0)}}))}has(t){return this.all(t).length>0}all(t){if(!t)return[];this._updateScores(t);const i=[];for(const t of this._entries)t._score>0&&i.push(t.provider);return i}ordered(t){const i=[];return this._orderedForEach(t,(t=>i.push(t.provider))),i}orderedGroups(t){const i=[];let e,s;return this._orderedForEach(t,(t=>{e&&s===t._score?e.push(t.provider):(s=t._score,e=[t.provider],i.push(e))})),i}_orderedForEach(t,i){this._updateScores(t);for(const t of this._entries)t._score>0&&i(t)}_updateScores(t){var i,e;const s=(i=this._notebookInfoResolver)===null||i===void 0?void 0:i.call(this,t.uri),n=s?new YO(t.uri,t.getLanguageId(),s.uri,s.type):new YO(t.uri,t.getLanguageId(),void 0,void 0);if(!(!((e=this._lastCandidate)===null||e===void 0)&&e.equals(n))){this._lastCandidate=n;for(const i of this._entries)if(i._score=JO(i.selector,n.uri,n.languageId,og(t),n.notebookUri,n.notebookType),QO(i.selector)&&i._score>0){for(const t of this._entries)t._score=0;i._score=1e3;break}this._entries.sort(XO._compareByScoreAndTime)}}static _compareByScoreAndTime(t,i){return t._score<i._score?1:t._score>i._score?-1:tI(t.selector)&&!tI(i.selector)?1:!tI(t.selector)&&tI(i.selector)?-1:t._time<i._time?1:t._time>i._time?-1:0}}function tI(t){return typeof t!="string"&&(Array.isArray(t)?t.some(tI):!!t.isBuiltin)}Nd($p,class{constructor(){this.referenceProvider=new XO(this._score.bind(this)),this.renameProvider=new XO(this._score.bind(this)),this.newSymbolNamesProvider=new XO(this._score.bind(this)),this.codeActionProvider=new XO(this._score.bind(this)),this.definitionProvider=new XO(this._score.bind(this)),this.typeDefinitionProvider=new XO(this._score.bind(this)),this.declarationProvider=new XO(this._score.bind(this)),this.implementationProvider=new XO(this._score.bind(this)),this.documentSymbolProvider=new XO(this._score.bind(this)),this.inlayHintsProvider=new XO(this._score.bind(this)),this.colorProvider=new XO(this._score.bind(this)),this.codeLensProvider=new XO(this._score.bind(this)),this.documentFormattingEditProvider=new XO(this._score.bind(this)),this.documentRangeFormattingEditProvider=new XO(this._score.bind(this)),this.onTypeFormattingEditProvider=new XO(this._score.bind(this)),this.signatureHelpProvider=new XO(this._score.bind(this)),this.hoverProvider=new XO(this._score.bind(this)),this.documentHighlightProvider=new XO(this._score.bind(this)),this.multiDocumentHighlightProvider=new XO(this._score.bind(this)),this.selectionRangeProvider=new XO(this._score.bind(this)),this.foldingRangeProvider=new XO(this._score.bind(this)),this.linkProvider=new XO(this._score.bind(this)),this.inlineCompletionsProvider=new XO(this._score.bind(this)),this.inlineEditProvider=new XO(this._score.bind(this)),this.completionProvider=new XO(this._score.bind(this)),this.linkedEditingRangeProvider=new XO(this._score.bind(this)),this.documentRangeSemanticTokensProvider=new XO(this._score.bind(this)),this.documentSemanticTokensProvider=new XO(this._score.bind(this)),this.documentOnDropEditProvider=new XO(this._score.bind(this)),this.documentPasteEditProvider=new XO(this._score.bind(this))}_score(t){var i;return(i=this._notebookTypeResolver)===null||i===void 0?void 0:i.call(this,t)}},1);var iI=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},eI=function(t,i){return function(e,s){i(e,s,t)}};const sI=_l("hoverService");let nI=class extends Qi{get delay(){return this.isInstantlyHovering()?0:this._delay}constructor(t,i,e={},s,n){super(),this.placement=t,this.instantHover=i,this.overrideOptions=e,this.configurationService=s,this.hoverService=n,this.lastHoverHideTime=0,this.timeLimit=200,this.hoverDisposables=this._register(new Ji),this._delay=this.configurationService.getValue("workbench.hover.delay"),this._register(this.configurationService.onDidChangeConfiguration((t=>{t.affectsConfiguration("workbench.hover.delay")&&(this._delay=this.configurationService.getValue("workbench.hover.delay"))})))}showHover(t,i){const e=typeof this.overrideOptions=="function"?this.overrideOptions(t,i):this.overrideOptions;this.hoverDisposables.clear();const s=t.target instanceof HTMLElement?[t.target]:t.target.targetElements;for(const t of s)this.hoverDisposables.add(rc(t,"keydown",(t=>{t.equals(9)&&this.hoverService.hideHover()})));const n=t.content instanceof HTMLElement?void 0:t.content.toString();return this.hoverService.showHover({...t,...e,persistence:{hideOnKeyDown:!0,...e.persistence},id:n,appearance:{...t.appearance,compact:!0,skipFadeInAnimation:this.isInstantlyHovering(),...e.appearance}},i)}isInstantlyHovering(){return this.instantHover&&Date.now()-this.lastHoverHideTime<this.timeLimit}onDidHideHover(){this.hoverDisposables.clear(),this.instantHover&&(this.lastHoverHideTime=Date.now())}};nI=iI([eI(3,Md),eI(4,sI)],nI);const rI=_l("contextViewService"),oI=_l("contextMenuService"),hI=nl;let cI=class extends Qi{constructor(){super(),this.containerDomNode=document.createElement("div"),this.containerDomNode.className="monaco-hover",this.containerDomNode.tabIndex=0,this.containerDomNode.setAttribute("role","tooltip"),this.contentsDomNode=document.createElement("div"),this.contentsDomNode.className="monaco-hover-content",this.scrollbar=this._register(new rC(this.contentsDomNode,{consumeMouseWheelIfScrollbarIsNeeded:!0})),this.containerDomNode.appendChild(this.scrollbar.getDomNode())}onContentsChanged(){this.scrollbar.scanDomNode()}};class lI extends Qi{static render(t,i,e){return new lI(t,i,e)}constructor(t,i,e){super(),this.actionContainer=Yc(t,hI("div.action-container")),this.actionContainer.setAttribute("tabindex","0"),this.action=Yc(this.actionContainer,hI("a.action")),this.action.setAttribute("role","button"),i.iconClass&&Yc(this.action,hI(`span.icon.${i.iconClass}`)),Yc(this.action,hI("span")).textContent=e?`${i.label} (${e})`:i.label,this._register(sc(this.actionContainer,qc.CLICK,(t=>{t.stopPropagation(),t.preventDefault(),i.run(this.actionContainer)}))),this._register(sc(this.actionContainer,qc.KEY_DOWN,(t=>{const e=new so(t);(e.equals(3)||e.equals(10))&&(t.stopPropagation(),t.preventDefault(),i.run(this.actionContainer))}))),this.setEnabled(!0)}setEnabled(t){t?(this.actionContainer.classList.remove("disabled"),this.actionContainer.removeAttribute("aria-disabled")):(this.actionContainer.classList.add("disabled"),this.actionContainer.setAttribute("aria-disabled","true"))}}function aI(t,i){return t&&i?tt(0,"Inspect this in the accessible view with {0}.",i):t?tt(0,"Inspect this in the accessible view via the command Open Accessible View which is currently not triggerable via keybinding."):""}const uI=_l("openerService");function dI(t,i={}){const e=fI(i);return pI(e,function(t,i){const e={type:1,children:[]};let s=0,n=e;const r=[],o=new gI(t);for(;!o.eos();){let t=o.next();const e=t==="\\"&&wI(o.peek(),i)!==0;if(e&&(t=o.next()),!e&&mI(t,i)&&t===o.peek()){o.advance(),n.type===2&&(n=r.pop());const e=wI(t,i);if(n.type===e||n.type===5&&e===6)n=r.pop();else{const t={type:e,children:[]};e===5&&(t.index=s,s++),n.children.push(t),r.push(n),n=t}}else if(t===`\n`)n.type===2&&(n=r.pop()),n.children.push({type:8});else if(n.type!==2){const i={type:2,content:t};n.children.push(i),r.push(n),n=i}else n.content+=t}return n.type===2&&(n=r.pop()),e}(t,!!i.renderCodeSegments),i.actionHandler,i.renderCodeSegments),e}function fI(t){const i=t.inline?"span":"div",e=document.createElement(i);return t.className&&(e.className=t.className),e}class gI{constructor(t){this.source=t,this.index=0}eos(){return this.index>=this.source.length}next(){const t=this.peek();return this.advance(),t}peek(){return this.source[this.index]}advance(){this.index++}}function pI(t,i,e,s){let n;if(i.type===2)n=document.createTextNode(i.content||"");else if(i.type===3)n=document.createElement("b");else if(i.type===4)n=document.createElement("i");else if(i.type===7&&s)n=document.createElement("code");else if(i.type===5&&e){const t=document.createElement("a");e.disposables.add(rc(t,"click",(t=>{e.callback(String(i.index),t)}))),n=t}else i.type===8?n=document.createElement("br"):i.type===1&&(n=t);n&&t!==n&&t.appendChild(n),n&&Array.isArray(i.children)&&i.children.forEach((t=>{pI(n,t,e,s)}))}function mI(t,i){return wI(t,i)!==0}function wI(t,i){switch(t){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return i?7:0;default:return 0}}const vI=new RegExp(`(\\\\)?\\$\\((${Kl.iconNameExpression}(?:${Kl.iconModifierExpression})?)\\)`,"g");function bI(t){const i=new Array;let e,s=0,n=0;for(;(e=vI.exec(t))!==null;){n=e.index||0,s<n&&i.push(t.substring(s,n)),s=(e.index||0)+e[0].length;const[,r,o]=e;i.push(r?`$(${o})`:yI({id:o}))}return s<t.length&&i.push(t.substring(s)),i}function yI(t){const i=nl("span");return i.classList.add(...Kl.asClassNameArray(t)),i}function kI(t){const i=function(t){if(CI=0,xI(t,DI,4352),CI>0||(xI(t,EI,4449),CI>0)||(xI(t,AI,4520),CI>0)||(xI(t,MI,12593),CI))return SI.subarray(0,CI);if(t>=44032&&t<=55203){const i=t-44032,e=i%588,s=Math.floor(i/588),n=Math.floor(e/28),r=e%28-1;if(s<DI.length?xI(s,DI,0):4352+s-12593<MI.length&&xI(4352+s,MI,12593),n<EI.length?xI(n,EI,0):4449+n-12593<MI.length&&xI(4449+n-12593,MI,12593),r>=0&&(r<AI.length?xI(r,AI,0):4520+r-12593<MI.length&&xI(4520+r-12593,MI,12593)),CI>0)return SI.subarray(0,CI)}}(t);if(i&&i.length>0)return new Uint32Array(i)}let CI=0;const SI=new Uint32Array(10);function xI(t,i,e){t>=e&&t<e+i.length&&function(t){t!==0&&(SI[CI++]=255&t,t>>8&&(SI[CI++]=t>>8&255),t>>16&&(SI[CI++]=t>>16&255))}(i[t-e])}const DI=new Uint8Array([114,82,115,101,69,102,97,113,81,116,84,100,119,87,99,122,120,118,103]),EI=new Uint16Array([107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]),AI=new Uint16Array([114,82,29810,115,30579,26483,101,102,29286,24934,29030,29798,30822,30310,26470,97,113,29809,116,84,100,119,99,122,120,118,103]),MI=new Uint16Array([114,82,29810,115,30579,26483,101,69,102,29286,24934,29030,29798,30822,30310,26470,97,113,81,29809,116,84,100,119,87,99,122,120,118,103,107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]);function LI(...t){return function(i,e){for(let s=0,n=t.length;s<n;s++){const n=t[s](i,e);if(n)return n}return null}}TI.bind(void 0,!1);const FI=TI.bind(void 0,!0);function TI(t,i,e){if(!e||e.length<i.length)return null;let s;return s=t?ur(e,i):e.indexOf(i)===0,s?i.length>0?[{start:0,end:i.length}]:[]:null}function RI(t,i){const e=i.toLowerCase().indexOf(t.toLowerCase());return e===-1?null:[{start:e,end:e+t.length}]}function OI(t,i){return II(t.toLowerCase(),i.toLowerCase(),0,0)}function II(t,i,e,s){if(e===t.length)return[];if(s===i.length)return null;if(t[e]===i[s]){let n=null;return(n=II(t,i,e+1,s+1))?UI({start:s,end:s+1},n):null}return II(t,i,e,s+1)}function _I(t){return 97<=t&&t<=122}function PI(t){return 65<=t&&t<=90}function NI(t){return 48<=t&&t<=57}function BI(t){return t===32||t===9||t===10||t===13}const $I=new Set;function WI(t){return BI(t)||$I.has(t)}function jI(t,i){return t===i||WI(t)&&WI(i)}"()[]{}<>`'\"-/;:,.?!".split("").forEach((t=>$I.add(t.charCodeAt(0))));const HI=new Map;function VI(t){if(HI.has(t))return HI.get(t);let i;const e=kI(t);return e&&(i=e),HI.set(t,i),i}function zI(t){return _I(t)||PI(t)||NI(t)}function UI(t,i){return i.length===0?i=[t]:t.end===i[0].start?i[0].start=t.start:i.unshift(t),i}function KI(t,i){for(let e=i;e<t.length;e++){const i=t.charCodeAt(e);if(PI(i)||NI(i)||e>0&&!zI(t.charCodeAt(e-1)))return e}return t.length}function qI(t,i,e,s){if(e===t.length)return[];if(s===i.length||t[e]!==i[s].toLowerCase())return null;{let n=null,r=s+1;for(n=qI(t,i,e+1,s+1);!n&&(r=KI(i,r))<i.length;)n=qI(t,i,e+1,r),r++;return n===null?null:UI({start:s,end:s+1},n)}}function GI(t,i){if(!i||(i=i.trim()).length===0||!function(t){let i=0,e=0,s=0,n=0;for(let r=0;r<t.length;r++)s=t.charCodeAt(r),PI(s)&&i++,_I(s)&&e++,BI(s)&&n++;return i!==0&&e!==0||n!==0?i<=5:t.length<=30}(t))return null;i.length>60&&(i=i.substring(0,60));const e=function(t){let i=0,e=0,s=0,n=0,r=0;for(let o=0;o<t.length;o++)r=t.charCodeAt(o),PI(r)&&i++,_I(r)&&e++,zI(r)&&s++,NI(r)&&n++;return{upperPercent:i/t.length,lowerPercent:e/t.length,alphaPercent:s/t.length,numericPercent:n/t.length}}(i);if(!function(t){const{upperPercent:i,lowerPercent:e,alphaPercent:s,numericPercent:n}=t;return e>.2&&i<.8&&s>.6&&n<.2}(e)){if(!function(t){const{upperPercent:i,lowerPercent:e}=t;return e===0&&i>.6}(e))return null;i=i.toLowerCase()}let s=null,n=0;for(t=t.toLowerCase();n<i.length&&(s=qI(t,i,0,n))===null;)n=KI(i,n+1);return s}function ZI(t,i,e,s,n){let r=0;if(e===t.length)return[];if(s===i.length)return null;if(!jI(t.charCodeAt(e),i.charCodeAt(s))){const n=VI(t.charCodeAt(e));if(!n)return null;for(let t=0;t<n.length;t++)if(!jI(n[t],i.charCodeAt(s+t)))return null;r+=n.length-1}let o=null,h=s+r+1;if(o=ZI(t,i,e+1,h,n),!n)for(;!o&&(h=JI(i,h))<i.length;)o=ZI(t,i,e+1,h,n),h++;if(!o)return null;if(t.charCodeAt(e)!==i.charCodeAt(s)){const n=VI(t.charCodeAt(e));if(!n)return o;for(let t=0;t<n.length;t++)if(n[t]!==i.charCodeAt(s+t))return o}return UI({start:s,end:s+r+1},o)}function JI(t,i){for(let e=i;e<t.length;e++)if(WI(t.charCodeAt(e))||e>0&&WI(t.charCodeAt(e-1)))return e;return t.length}const QI=LI(FI,GI,RI),YI=LI(FI,GI,OI),XI=new Kf(1e4);function t_(t,i,e=!1){if(typeof t!="string"||typeof i!="string")return null;let s=XI.get(t);s||(s=new RegExp(t.replace(/[\-\\\{\}\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&").replace(/[\*]/g,".*"),"i"),XI.set(t,s));const n=s.exec(i);return n?[{start:n.index,end:n.index+n[0].length}]:e?YI(t,i):QI(t,i)}function i_(t,i){const e=w_(t,t.toLowerCase(),0,i,i.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return e?s_(e):null}function e_(t,i,e,s,n,r){const o=Math.min(13,t.length);for(;e<o;e++){const o=w_(t,i,e,s,n,r,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(o)return o}return[0,r]}function s_(t){if(t===void 0)return[];const i=[],e=t[1];for(let s=t.length-1;s>1;s--){const n=t[s]+e,r=i[i.length-1];r&&r.end===n?r.end=n+1:i.push({start:n,end:n+1})}return i}const n_=128;function r_(){const t=[],i=[];for(let t=0;t<=n_;t++)i[t]=0;for(let e=0;e<=n_;e++)t.push(i.slice(0));return t}function o_(t){const i=[];for(let e=0;e<=t;e++)i[e]=0;return i}const h_=o_(2*n_),c_=o_(2*n_),l_=r_(),a_=r_(),u_=r_();function d_(t,i){if(i<0||i>=t.length)return!1;const e=t.codePointAt(i);switch(e){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 62:case 40:case 41:case 91:case 93:case 123:case 125:return!0;case void 0:return!1;default:return!!Lr(e)}}function f_(t,i){if(i<0||i>=t.length)return!1;switch(t.charCodeAt(i)){case 32:case 9:return!0;default:return!1}}function g_(t,i,e){return i[t]!==e[t]}var p_;(function(t){t.Default=[-100,0],t.isDefault=function(t){return!t||t.length===2&&t[0]===-100&&t[1]===0}})(p_||(p_={}));class m_{constructor(t,i){this.firstMatchCanBeWeak=t,this.boostFullMatch=i}}function w_(t,i,e,s,n,r,o=m_.default){const h=t.length>n_?n_:t.length,c=s.length>n_?n_:s.length;if(e>=h||r>=c||h-e>c-r||!function(t,i,e,s,n,r,o=!1){for(;i<e&&n<r;)t[i]===s[n]&&(o&&(h_[i]=n),i+=1),n+=1;return i===e}(i,e,h,n,r,c,!0))return;(function(t,i,e,s,n,r){let o=t-1,h=i-1;for(;o>=e&&h>=s;)n[o]===r[h]&&(c_[o]=h,o--),h--})(h,c,e,r,i,n);let l=1,a=1,u=e,d=r;const f=[!1];for(l=1,u=e;u<h;l++,u++){const o=h_[u],g=c_[u],p=u+1<h?c_[u+1]:c;for(a=o-r+1,d=o;d<p;a++,d++){let h=Number.MIN_SAFE_INTEGER,p=!1;d<=g&&(h=v_(t,i,u,e,s,n,d,c,r,l_[l-1][a-1]===0,f));let m=0;h!==Number.MAX_SAFE_INTEGER&&(p=!0,m=h+a_[l-1][a-1]);const w=d>o,v=w?a_[l][a-1]+(l_[l][a-1]>0?-5:0):0,b=d>o+1&&l_[l][a-1]>0,y=b?a_[l][a-2]+(l_[l][a-2]>0?-5:0):0;if(b&&(!w||y>=v)&&(!p||y>=m))a_[l][a]=y,u_[l][a]=3,l_[l][a]=0;else if(w&&(!p||v>=m))a_[l][a]=v,u_[l][a]=2,l_[l][a]=0;else{if(!p)throw new Error("not possible");a_[l][a]=m,u_[l][a]=1,l_[l][a]=l_[l-1][a-1]+1}}}if(!f[0]&&!o.firstMatchCanBeWeak)return;l--,a--;const g=[a_[l][a],r];let p=0,m=0;for(;l>=1;){let t=a;do{const i=u_[l][t];if(i===3)t-=2;else{if(i!==2)break;t-=1}}while(t>=1);p>1&&i[e+l-1]===n[r+a-1]&&!g_(t+r-1,s,n)&&p+1>l_[l][t]&&(t=a),t===a?p++:p=1,m||(m=t),l--,a=t-1,g.push(a)}c===h&&o.boostFullMatch&&(g[0]+=2);const w=m-h;return g[0]-=w,g}function v_(t,i,e,s,n,r,o,h,c,l,a){if(i[e]!==r[o])return Number.MIN_SAFE_INTEGER;let u=1,d=!1;return o===e-s?u=t[e]===n[o]?7:5:!g_(o,n,r)||o!==0&&g_(o-1,n,r)?!d_(r,o)||o!==0&&d_(r,o-1)?(d_(r,o-1)||f_(r,o-1))&&(u=5,d=!0):u=5:(u=t[e]===n[o]?7:5,d=!0),u>1&&e===s&&(a[0]=!0),d||(d=g_(o,n,r)||d_(r,o-1)||f_(r,o-1)),e===s?o>c&&(u-=d?3:5):u+=l?d?2:0:d?0:1,o+1===h&&(u-=d?3:5),u}function b_(t,i,e,s,n,r,o){return function(t,i,e,s,n,r,o,h){let c=w_(t,i,e,s,n,r,h);if(c&&!o)return c;if(t.length>=3){const i=Math.min(7,t.length-1);for(let o=e+1;o<i;o++){const i=y_(t,o);if(i){const t=w_(i,i.toLowerCase(),e,s,n,r,h);t&&(t[0]-=3,(!c||t[0]>c[0])&&(c=t))}}}return c}(t,i,e,s,n,r,!0,o)}function y_(t,i){if(i+1>=t.length)return;const e=t[i],s=t[i+1];return e!==s?t.slice(0,i)+s+e+t.slice(i+2):void 0}m_.default={boostFullMatch:!0,firstMatchCanBeWeak:!1};const k_="$(",C_=new RegExp(`\\$\\(${Kl.iconNameExpression}(?:${Kl.iconModifierExpression})?\\)`,"g"),S_=new RegExp(`(\\\\)?${C_.source}`,"g"),x_=new RegExp(`\\\\${C_.source}`,"g"),D_=new RegExp(`(\\s)?(\\\\)?${C_.source}(\\s)?`,"g");function E_(t){return t.indexOf(k_)===-1?t:t.replace(D_,((t,i,e,s)=>e?t:i||s||""))}const A_=new RegExp(`\\$\\(${Kl.iconNameCharacter}+\\)`,"g");function M_(t){A_.lastIndex=0;let i="";const e=[];let s=0;for(;;){const n=A_.lastIndex,r=A_.exec(t),o=t.substring(n,r==null?void 0:r.index);if(o.length>0){i+=o;for(let t=0;t<o.length;t++)e.push(s)}if(!r)break;s+=r[0].length}return{text:i,iconOffsets:e}}function L_(t,i,e=!1){const{text:s,iconOffsets:n}=i;if(!n||n.length===0)return t_(t,s,e);const r=Jn(s," "),o=s.length-r.length,h=t_(t,r,e);if(h)for(const t of h){const i=n[t.start+o]+o;t.start+=i,t.end+=i}return h}class F_{constructor(t="",i=!1){var e,s,n;if(this.value=t,typeof this.value!="string")throw Wi("value");typeof i=="boolean"?(this.isTrusted=i,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=(e=i.isTrusted)!==null&&e!==void 0?e:void 0,this.supportThemeIcons=(s=i.supportThemeIcons)!==null&&s!==void 0&&s,this.supportHtml=(n=i.supportHtml)!==null&&n!==void 0&&n)}appendText(t,i=0){return this.value+=function(t){return t.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}(this.supportThemeIcons?function(t){return t.replace(S_,((t,i)=>i?t:`\\${t}`))}(t):t).replace(/([ \t]+)/g,((t,i)=>"&nbsp;".repeat(i.length))).replace(/\>/gm,"\\>").replace(/\n/g,i===1?`\\\n`:`\n\n`),this}appendMarkdown(t){return this.value+=t,this}appendCodeblock(t,i){return this.value+=`\n${function(t,i){var e,s;const n=(s=(e=t.match(/^`+/gm))===null||e===void 0?void 0:e.reduce(((t,i)=>t.length>i.length?t:i)).length)!==null&&s!==void 0?s:0,r=n>=3?n+1:3;return[`${"`".repeat(r)}${i}`,t,`${"`".repeat(r)}`].join(`\n`)}(i,t)}\n`,this}appendLink(t,i,e){return this.value+="[",this.value+=this._escape(i,"]"),this.value+="](",this.value+=this._escape(String(t),")"),e&&(this.value+=` "${this._escape(this._escape(e,'"'),")")}"`),this.value+=")",this}_escape(t,i){const e=new RegExp(Gn(i),"g");return t.replace(e,((i,e)=>t.charAt(e-1)!=="\\"?`\\${i}`:i))}}function T_(t){return R_(t)?!t.value:!Array.isArray(t)||t.every(T_)}function R_(t){return t instanceof F_||!(!t||typeof t!="object")&&!(typeof t.value!="string"||typeof t.isTrusted!="boolean"&&typeof t.isTrusted!="object"&&t.isTrusted!==void 0||typeof t.supportThemeIcons!="boolean"&&t.supportThemeIcons!==void 0)}function O_(t){return t.replace(/"/g,"&quot;")}function I_(t){return t&&t.replace(/\\([\\`*_{}[\]()#+\-.!~])/g,"$1")}class __{constructor(t){this._prefix=t,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}}const P_=new __("id#");let N_={};(function(){function t(t,i){i(N_)}var i,e;t.amd=!0,i=this,e=function(t){function i(t,i,e){return e&&function(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function e(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,s=new Array(i);e<i;e++)s[e]=t[e];return s}function s(t,i){var s=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(s)return(s=s.call(t)).next.bind(s);if(Array.isArray(t)||(s=function(t,i){if(t){if(typeof t=="string")return e(t,i);var s=Object.prototype.toString.call(t).slice(8,-1);return s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set"?Array.from(t):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?e(t,i):void 0}}(t))||i){s&&(t=s);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}t.defaults={async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1};var r=/[&<>"']/,o=/[&<>"']/g,h=/[<>"']|&(?!#?\w+;)/,c=/[<>"']|&(?!#?\w+;)/g,l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},a=function(t){return l[t]};function u(t,i){if(i){if(r.test(t))return t.replace(o,a)}else if(h.test(t))return t.replace(c,a);return t}var d=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function f(t){return t.replace(d,(function(t,i){return(i=i.toLowerCase())==="colon"?":":i.charAt(0)==="#"?i.charAt(1)==="x"?String.fromCharCode(parseInt(i.substring(2),16)):String.fromCharCode(+i.substring(1)):""}))}var g=/(^|[^\[])\^/g;function p(t,i){t=typeof t=="string"?t:t.source,i=i||"";var e={replace:function(i,s){return s=(s=s.source||s).replace(g,"$1"),t=t.replace(i,s),e},getRegex:function(){return new RegExp(t,i)}};return e}var m=/[^\w:]/g,w=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function v(t,i,e){if(t){var s;try{s=decodeURIComponent(f(e)).replace(m,"").toLowerCase()}catch{return null}if(s.indexOf("javascript:")===0||s.indexOf("vbscript:")===0||s.indexOf("data:")===0)return null}i&&!w.test(e)&&(e=function(t,i){b[" "+t]||(y.test(t)?b[" "+t]=t+"/":b[" "+t]=E(t,"/",!0));var e=(t=b[" "+t]).indexOf(":")===-1;return i.substring(0,2)==="//"?e?i:t.replace(k,"$1")+i:i.charAt(0)==="/"?e?i:t.replace(C,"$1")+i:t+i}(i,e));try{e=encodeURI(e).replace(/%25/g,"%")}catch{return null}return e}var b={},y=/^[^:]+:\/*[^/]*$/,k=/^([^:]+:)[\s\S]*$/,C=/^([^:]+:\/*[^/]*)[\s\S]*$/,S={exec:function(){}};function x(t){for(var i,e,s=1;s<arguments.length;s++)for(e in i=arguments[s])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t}function D(t,i){var e=t.replace(/\|/g,(function(t,i,e){for(var s=!1,n=i;--n>=0&&e[n]==="\\";)s=!s;return s?"|":" |"})).split(/ \|/),s=0;if(e[0].trim()||e.shift(),e.length>0&&!e[e.length-1].trim()&&e.pop(),e.length>i)e.splice(i);else for(;e.length<i;)e.push("");for(;s<e.length;s++)e[s]=e[s].trim().replace(/\\\|/g,"|");return e}function E(t,i,e){var s=t.length;if(s===0)return"";for(var n=0;n<s;){var r=t.charAt(s-n-1);if(r!==i||e){if(r===i||!e)break;n++}else n++}return t.slice(0,s-n)}function A(t){t&&t.sanitize&&!t.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function M(t,i){if(i<1)return"";for(var e="";i>1;)1&i&&(e+=t),i>>=1,t+=t;return e+t}function L(t,i,e,s){var n=i.href,r=i.title?u(i.title):null,o=t[1].replace(/\\([\[\]])/g,"$1");if(t[0].charAt(0)!=="!"){s.state.inLink=!0;var h={type:"link",raw:e,href:n,title:r,text:o,tokens:s.inlineTokens(o)};return s.state.inLink=!1,h}return{type:"image",raw:e,href:n,title:r,text:u(o)}}var F=function(){function i(i){this.options=i||t.defaults}var e=i.prototype;return e.space=function(t){var i=this.rules.block.newline.exec(t);if(i&&i[0].length>0)return{type:"space",raw:i[0]}},e.code=function(t){var i=this.rules.block.code.exec(t);if(i){var e=i[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:i[0],codeBlockStyle:"indented",text:this.options.pedantic?e:E(e,`\n`)}}},e.fences=function(t){var i=this.rules.block.fences.exec(t);if(i){var e=i[0],s=function(t,i){var e=t.match(/^(\s+)(?:```)/);if(e===null)return i;var s=e[1];return i.split(`\n`).map((function(t){var i=t.match(/^\s+/);return i===null?t:i[0].length>=s.length?t.slice(s.length):t})).join(`\n`)}(e,i[3]||"");return{type:"code",raw:e,lang:i[2]?i[2].trim():i[2],text:s}}},e.heading=function(t){var i=this.rules.block.heading.exec(t);if(i){var e=i[2].trim();if(/#$/.test(e)){var s=E(e,"#");this.options.pedantic?e=s.trim():s&&!/ $/.test(s)||(e=s.trim())}return{type:"heading",raw:i[0],depth:i[1].length,text:e,tokens:this.lexer.inline(e)}}},e.hr=function(t){var i=this.rules.block.hr.exec(t);if(i)return{type:"hr",raw:i[0]}},e.blockquote=function(t){var i=this.rules.block.blockquote.exec(t);if(i){var e=i[0].replace(/^ *>[ \t]?/gm,"");return{type:"blockquote",raw:i[0],tokens:this.lexer.blockTokens(e,[]),text:e}}},e.list=function(t){var i=this.rules.block.list.exec(t);if(i){var e,n,r,o,h,c,l,a,u,d,f,g,p=i[1].trim(),m=p.length>1,w={type:"list",raw:"",ordered:m,start:m?+p.slice(0,-1):"",loose:!1,items:[]};p=m?"\\d{1,9}\\"+p.slice(-1):"\\"+p,this.options.pedantic&&(p=m?p:"[*+-]");for(var v=new RegExp("^( {0,3}"+p+")((?:[\t ][^\\n]*)?(?:\\n|$))");t&&(g=!1,i=v.exec(t))&&!this.rules.block.hr.test(t);){if(e=i[0],t=t.substring(e.length),a=i[2].split(`\n`,1)[0],u=t.split(`\n`,1)[0],this.options.pedantic?(o=2,f=a.trimLeft()):(o=(o=i[2].search(/[^ ]/))>4?1:o,f=a.slice(o),o+=i[1].length),c=!1,!a&&/^ *$/.test(u)&&(e+=u+`\n`,t=t.substring(u.length+1),g=!0),!g)for(var b=new RegExp("^ {0,"+Math.min(3,o-1)+"}(?:[*+-]|\\d{1,9}[.)])((?: [^\\n]*)?(?:\\n|$))"),y=new RegExp("^ {0,"+Math.min(3,o-1)+"}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)"),k=new RegExp("^ {0,"+Math.min(3,o-1)+"}(?:```|~~~)"),C=new RegExp("^ {0,"+Math.min(3,o-1)+"}#");t&&(a=d=t.split(`\n`,1)[0],this.options.pedantic&&(a=a.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!k.test(a))&&!C.test(a)&&!b.test(a)&&!y.test(t);){if(a.search(/[^ ]/)>=o||!a.trim())f+=`\n`+a.slice(o);else{if(c)break;f+=`\n`+a}c||a.trim()||(c=!0),e+=d+`\n`,t=t.substring(d.length+1)}w.loose||(l?w.loose=!0:/\n *\n *$/.test(e)&&(l=!0)),this.options.gfm&&(n=/^\[[ xX]\] /.exec(f))&&(r=n[0]!=="[ ] ",f=f.replace(/^\[[ xX]\] +/,"")),w.items.push({type:"list_item",raw:e,task:!!n,checked:r,loose:!1,text:f}),w.raw+=e}w.items[w.items.length-1].raw=e.trimRight(),w.items[w.items.length-1].text=f.trimRight(),w.raw=w.raw.trimRight();var S=w.items.length;for(h=0;h<S;h++){this.lexer.state.top=!1,w.items[h].tokens=this.lexer.blockTokens(w.items[h].text,[]);var x=w.items[h].tokens.filter((function(t){return t.type==="space"})),D=x.every((function(t){for(var i,e=0,n=s(t.raw.split(""));!(i=n()).done;)if(i.value===`\n`&&(e+=1),e>1)return!0;return!1}));!w.loose&&x.length&&D&&(w.loose=!0,w.items[h].loose=!0)}return w}},e.html=function(t){var i=this.rules.block.html.exec(t);if(i){var e={type:"html",raw:i[0],pre:!this.options.sanitizer&&(i[1]==="pre"||i[1]==="script"||i[1]==="style"),text:i[0]};if(this.options.sanitize){var s=this.options.sanitizer?this.options.sanitizer(i[0]):u(i[0]);e.type="paragraph",e.text=s,e.tokens=this.lexer.inline(s)}return e}},e.def=function(t){var i=this.rules.block.def.exec(t);if(i)return i[3]&&(i[3]=i[3].substring(1,i[3].length-1)),{type:"def",tag:i[1].toLowerCase().replace(/\s+/g," "),raw:i[0],href:i[2],title:i[3]}},e.table=function(t){var i=this.rules.block.table.exec(t);if(i){var e={type:"table",header:D(i[1]).map((function(t){return{text:t}})),align:i[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:i[3]&&i[3].trim()?i[3].replace(/\n[ \t]*$/,"").split(`\n`):[]};if(e.header.length===e.align.length){e.raw=i[0];var s,n,r,o,h=e.align.length;for(s=0;s<h;s++)/^ *-+: *$/.test(e.align[s])?e.align[s]="right":/^ *:-+: *$/.test(e.align[s])?e.align[s]="center":/^ *:-+ *$/.test(e.align[s])?e.align[s]="left":e.align[s]=null;for(h=e.rows.length,s=0;s<h;s++)e.rows[s]=D(e.rows[s],e.header.length).map((function(t){return{text:t}}));for(h=e.header.length,n=0;n<h;n++)e.header[n].tokens=this.lexer.inline(e.header[n].text);for(h=e.rows.length,n=0;n<h;n++)for(o=e.rows[n],r=0;r<o.length;r++)o[r].tokens=this.lexer.inline(o[r].text);return e}}},e.lheading=function(t){var i=this.rules.block.lheading.exec(t);if(i)return{type:"heading",raw:i[0],depth:i[2].charAt(0)==="="?1:2,text:i[1],tokens:this.lexer.inline(i[1])}},e.paragraph=function(t){var i=this.rules.block.paragraph.exec(t);if(i){var e=i[1].charAt(i[1].length-1)===`\n`?i[1].slice(0,-1):i[1];return{type:"paragraph",raw:i[0],text:e,tokens:this.lexer.inline(e)}}},e.text=function(t){var i=this.rules.block.text.exec(t);if(i)return{type:"text",raw:i[0],text:i[0],tokens:this.lexer.inline(i[0])}},e.escape=function(t){var i=this.rules.inline.escape.exec(t);if(i)return{type:"escape",raw:i[0],text:u(i[1])}},e.tag=function(t){var i=this.rules.inline.tag.exec(t);if(i)return!this.lexer.state.inLink&&/^<a /i.test(i[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(i[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(i[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(i[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:i[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):u(i[0]):i[0]}},e.link=function(t){var i=this.rules.inline.link.exec(t);if(i){var e=i[2].trim();if(!this.options.pedantic&&/^</.test(e)){if(!/>$/.test(e))return;var s=E(e.slice(0,-1),"\\");if((e.length-s.length)%2==0)return}else{var n=function(t,i){if(t.indexOf(i[1])===-1)return-1;for(var e=t.length,s=0,n=0;n<e;n++)if(t[n]==="\\")n++;else if(t[n]===i[0])s++;else if(t[n]===i[1]&&--s<0)return n;return-1}(i[2],"()");if(n>-1){var r=(i[0].indexOf("!")===0?5:4)+i[1].length+n;i[2]=i[2].substring(0,n),i[0]=i[0].substring(0,r).trim(),i[3]=""}}var o=i[2],h="";if(this.options.pedantic){var c=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(o);c&&(o=c[1],h=c[3])}else h=i[3]?i[3].slice(1,-1):"";return o=o.trim(),/^</.test(o)&&(o=this.options.pedantic&&!/>$/.test(e)?o.slice(1):o.slice(1,-1)),L(i,{href:o&&o.replace(this.rules.inline._escapes,"$1"),title:h&&h.replace(this.rules.inline._escapes,"$1")},i[0],this.lexer)}},e.reflink=function(t,i){var e;if((e=this.rules.inline.reflink.exec(t))||(e=this.rules.inline.nolink.exec(t))){var s=(e[2]||e[1]).replace(/\s+/g," ");if(!(s=i[s.toLowerCase()])||!s.href){var n=e[0].charAt(0);return{type:"text",raw:n,text:n}}return L(e,s,e[0],this.lexer)}},e.emStrong=function(t,i,e){e===void 0&&(e="");var s=this.rules.inline.emStrong.lDelim.exec(t);if(s&&(!s[3]||!e.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDF70-\uDF81\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var n=s[1]||s[2]||"";if(!n||n&&(e===""||this.rules.inline.punctuation.exec(e))){var r,o,h=s[0].length-1,c=h,l=0,a=s[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(a.lastIndex=0,i=i.slice(-1*t.length+h);(s=a.exec(i))!=null;)if(r=s[1]||s[2]||s[3]||s[4]||s[5]||s[6])if(o=r.length,s[3]||s[4])c+=o;else if(!((s[5]||s[6])&&h%3)||(h+o)%3){if(!((c-=o)>0)){if(o=Math.min(o,o+c+l),Math.min(h,o)%2){var u=t.slice(1,h+s.index+o);return{type:"em",raw:t.slice(0,h+s.index+o+1),text:u,tokens:this.lexer.inlineTokens(u)}}var d=t.slice(2,h+s.index+o-1);return{type:"strong",raw:t.slice(0,h+s.index+o+1),text:d,tokens:this.lexer.inlineTokens(d)}}}else l+=o}}},e.codespan=function(t){var i=this.rules.inline.code.exec(t);if(i){var e=i[2].replace(/\n/g," "),s=/[^ ]/.test(e),n=/^ /.test(e)&&/ $/.test(e);return s&&n&&(e=e.substring(1,e.length-1)),e=u(e,!0),{type:"codespan",raw:i[0],text:e}}},e.br=function(t){var i=this.rules.inline.br.exec(t);if(i)return{type:"br",raw:i[0]}},e.del=function(t){var i=this.rules.inline.del.exec(t);if(i)return{type:"del",raw:i[0],text:i[2],tokens:this.lexer.inlineTokens(i[2])}},e.autolink=function(t,i){var e,s,n=this.rules.inline.autolink.exec(t);if(n)return s=n[2]==="@"?"mailto:"+(e=u(this.options.mangle?i(n[1]):n[1])):e=u(n[1]),{type:"link",raw:n[0],text:e,href:s,tokens:[{type:"text",raw:e,text:e}]}},e.url=function(t,i){var e;if(e=this.rules.inline.url.exec(t)){var s,n;if(e[2]==="@")n="mailto:"+(s=u(this.options.mangle?i(e[0]):e[0]));else{var r;do{r=e[0],e[0]=this.rules.inline._backpedal.exec(e[0])[0]}while(r!==e[0]);s=u(e[0]),n=e[1]==="www."?"http://"+s:s}return{type:"link",raw:e[0],text:s,href:n,tokens:[{type:"text",raw:s,text:s}]}}},e.inlineText=function(t,i){var e,s=this.rules.inline.text.exec(t);if(s)return e=this.lexer.state.inRawBlock?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(s[0]):u(s[0]):s[0]:u(this.options.smartypants?i(s[0]):s[0]),{type:"text",raw:s[0],text:e}},i}(),T={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:S,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\.|[^\[\]\\])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};T.def=p(T.def).replace("label",T._label).replace("title",T._title).getRegex(),T.bullet=/(?:[*+-]|\d{1,9}[.)])/,T.listItemStart=p(/^( *)(bull) */).replace("bull",T.bullet).getRegex(),T.list=p(T.list).replace(/bull/g,T.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+T.def.source+")").getRegex(),T._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",T._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,T.html=p(T.html,"i").replace("comment",T._comment).replace("tag",T._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),T.paragraph=p(T._paragraph).replace("hr",T.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",T._tag).getRegex(),T.blockquote=p(T.blockquote).replace("paragraph",T.paragraph).getRegex(),T.normal=x({},T),T.gfm=x({},T.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),T.gfm.table=p(T.gfm.table).replace("hr",T.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",T._tag).getRegex(),T.gfm.paragraph=p(T._paragraph).replace("hr",T.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",T.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",T._tag).getRegex(),T.pedantic=x({},T.normal,{html:p(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",T._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:S,paragraph:p(T.normal._paragraph).replace("hr",T.hr).replace("heading",` *#{1,6} *[^\n]`).replace("lheading",T.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var R={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:S,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[^*]+(?=[^*])|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:S,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};function O(t){return t.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function I(t){var i,e,s="",n=t.length;for(i=0;i<n;i++)e=t.charCodeAt(i),Math.random()>.5&&(e="x"+e.toString(16)),s+="&#"+e+";";return s}R._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",R.punctuation=p(R.punctuation).replace(/punctuation/g,R._punctuation).getRegex(),R.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,R.escapedEmSt=/\\\*|\\_/g,R._comment=p(T._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),R.emStrong.lDelim=p(R.emStrong.lDelim).replace(/punct/g,R._punctuation).getRegex(),R.emStrong.rDelimAst=p(R.emStrong.rDelimAst,"g").replace(/punct/g,R._punctuation).getRegex(),R.emStrong.rDelimUnd=p(R.emStrong.rDelimUnd,"g").replace(/punct/g,R._punctuation).getRegex(),R._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,R._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,R._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,R.autolink=p(R.autolink).replace("scheme",R._scheme).replace("email",R._email).getRegex(),R._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,R.tag=p(R.tag).replace("comment",R._comment).replace("attribute",R._attribute).getRegex(),R._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,R._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,R._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,R.link=p(R.link).replace("label",R._label).replace("href",R._href).replace("title",R._title).getRegex(),R.reflink=p(R.reflink).replace("label",R._label).replace("ref",T._label).getRegex(),R.nolink=p(R.nolink).replace("ref",T._label).getRegex(),R.reflinkSearch=p(R.reflinkSearch,"g").replace("reflink",R.reflink).replace("nolink",R.nolink).getRegex(),R.normal=x({},R),R.pedantic=x({},R.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:p(/^!?\[(label)\]\((.*?)\)/).replace("label",R._label).getRegex(),reflink:p(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",R._label).getRegex()}),R.gfm=x({},R.normal,{escape:p(R.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),R.gfm.url=p(R.gfm.url,"i").replace("email",R.gfm._extended_email).getRegex(),R.breaks=x({},R.gfm,{br:p(R.br).replace("{2,}","*").getRegex(),text:p(R.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var _=function(){function e(i){this.tokens=[],this.tokens.links=Object.create(null),this.options=i||t.defaults,this.options.tokenizer=this.options.tokenizer||new F,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};var e={block:T.normal,inline:R.normal};this.options.pedantic?(e.block=T.pedantic,e.inline=R.pedantic):this.options.gfm&&(e.block=T.gfm,this.options.breaks?e.inline=R.breaks:e.inline=R.gfm),this.tokenizer.rules=e}e.lex=function(t,i){return new e(i).lex(t)},e.lexInline=function(t,i){return new e(i).inlineTokens(t)};var s=e.prototype;return s.lex=function(t){var i;for(t=t.replace(/\r\n|\r/g,`\n`),this.blockTokens(t,this.tokens);i=this.inlineQueue.shift();)this.inlineTokens(i.src,i.tokens);return this.tokens},s.blockTokens=function(t,i){var e,s,n,r,o=this;for(i===void 0&&(i=[]),t=this.options.pedantic?t.replace(/\t/g,"    ").replace(/^ +$/gm,""):t.replace(/^( *)(\t+)/gm,(function(t,i,e){return i+"    ".repeat(e.length)}));t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some((function(s){return!!(e=s.call({lexer:o},t,i))&&(t=t.substring(e.raw.length),i.push(e),!0)})))){if(e=this.tokenizer.space(t))t=t.substring(e.raw.length),e.raw.length===1&&i.length>0?i[i.length-1].raw+=`\n`:i.push(e);else if(e=this.tokenizer.code(t))t=t.substring(e.raw.length),!(s=i[i.length-1])||s.type!=="paragraph"&&s.type!=="text"?i.push(e):(s.raw+=`\n`+e.raw,s.text+=`\n`+e.text,this.inlineQueue[this.inlineQueue.length-1].src=s.text);else if(e=this.tokenizer.fences(t))t=t.substring(e.raw.length),i.push(e);else if(e=this.tokenizer.heading(t))t=t.substring(e.raw.length),i.push(e);else if(e=this.tokenizer.hr(t))t=t.substring(e.raw.length),i.push(e);else if(e=this.tokenizer.blockquote(t))t=t.substring(e.raw.length),i.push(e);else if(e=this.tokenizer.list(t))t=t.substring(e.raw.length),i.push(e);else if(e=this.tokenizer.html(t))t=t.substring(e.raw.length),i.push(e);else if(e=this.tokenizer.def(t))t=t.substring(e.raw.length),!(s=i[i.length-1])||s.type!=="paragraph"&&s.type!=="text"?this.tokens.links[e.tag]||(this.tokens.links[e.tag]={href:e.href,title:e.title}):(s.raw+=`\n`+e.raw,s.text+=`\n`+e.raw,this.inlineQueue[this.inlineQueue.length-1].src=s.text);else if(e=this.tokenizer.table(t))t=t.substring(e.raw.length),i.push(e);else if(e=this.tokenizer.lheading(t))t=t.substring(e.raw.length),i.push(e);else if(n=t,this.options.extensions&&this.options.extensions.startBlock&&function(){var i=1/0,e=t.slice(1),s=void 0;o.options.extensions.startBlock.forEach((function(t){typeof(s=t.call({lexer:this},e))=="number"&&s>=0&&(i=Math.min(i,s))})),i<1/0&&i>=0&&(n=t.substring(0,i+1))}(),this.state.top&&(e=this.tokenizer.paragraph(n)))s=i[i.length-1],r&&s.type==="paragraph"?(s.raw+=`\n`+e.raw,s.text+=`\n`+e.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):i.push(e),r=n.length!==t.length,t=t.substring(e.raw.length);else if(e=this.tokenizer.text(t))t=t.substring(e.raw.length),(s=i[i.length-1])&&s.type==="text"?(s.raw+=`\n`+e.raw,s.text+=`\n`+e.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):i.push(e);else if(t){var h="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(h);break}throw new Error(h)}}return this.state.top=!0,i},s.inline=function(t,i){return i===void 0&&(i=[]),this.inlineQueue.push({src:t,tokens:i}),i},s.inlineTokens=function(t,i){var e,s,n,r=this;i===void 0&&(i=[]);var o,h,c,l=t;if(this.tokens.links){var a=Object.keys(this.tokens.links);if(a.length>0)for(;(o=this.tokenizer.rules.inline.reflinkSearch.exec(l))!=null;)a.includes(o[0].slice(o[0].lastIndexOf("[")+1,-1))&&(l=l.slice(0,o.index)+"["+M("a",o[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(o=this.tokenizer.rules.inline.blockSkip.exec(l))!=null;)l=l.slice(0,o.index)+"["+M("a",o[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(o=this.tokenizer.rules.inline.escapedEmSt.exec(l))!=null;)l=l.slice(0,o.index)+"++"+l.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;t;)if(h||(c=""),h=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some((function(s){return!!(e=s.call({lexer:r},t,i))&&(t=t.substring(e.raw.length),i.push(e),!0)}))))if(e=this.tokenizer.escape(t))t=t.substring(e.raw.length),i.push(e);else if(e=this.tokenizer.tag(t))t=t.substring(e.raw.length),(s=i[i.length-1])&&e.type==="text"&&s.type==="text"?(s.raw+=e.raw,s.text+=e.text):i.push(e);else if(e=this.tokenizer.link(t))t=t.substring(e.raw.length),i.push(e);else if(e=this.tokenizer.reflink(t,this.tokens.links))t=t.substring(e.raw.length),(s=i[i.length-1])&&e.type==="text"&&s.type==="text"?(s.raw+=e.raw,s.text+=e.text):i.push(e);else if(e=this.tokenizer.emStrong(t,l,c))t=t.substring(e.raw.length),i.push(e);else if(e=this.tokenizer.codespan(t))t=t.substring(e.raw.length),i.push(e);else if(e=this.tokenizer.br(t))t=t.substring(e.raw.length),i.push(e);else if(e=this.tokenizer.del(t))t=t.substring(e.raw.length),i.push(e);else if(e=this.tokenizer.autolink(t,I))t=t.substring(e.raw.length),i.push(e);else if(this.state.inLink||!(e=this.tokenizer.url(t,I))){if(n=t,this.options.extensions&&this.options.extensions.startInline&&function(){var i=1/0,e=t.slice(1),s=void 0;r.options.extensions.startInline.forEach((function(t){typeof(s=t.call({lexer:this},e))=="number"&&s>=0&&(i=Math.min(i,s))})),i<1/0&&i>=0&&(n=t.substring(0,i+1))}(),e=this.tokenizer.inlineText(n,O))t=t.substring(e.raw.length),e.raw.slice(-1)!=="_"&&(c=e.raw.slice(-1)),h=!0,(s=i[i.length-1])&&s.type==="text"?(s.raw+=e.raw,s.text+=e.text):i.push(e);else if(t){var u="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(u);break}throw new Error(u)}}else t=t.substring(e.raw.length),i.push(e);return i},i(e,0,[{key:"rules",get:function(){return{block:T,inline:R}}}]),e}(),P=function(){function i(i){this.options=i||t.defaults}var e=i.prototype;return e.code=function(t,i,e){var s=(i||"").match(/\S*/)[0];if(this.options.highlight){var n=this.options.highlight(t,s);n!=null&&n!==t&&(e=!0,t=n)}return t=t.replace(/\n$/,"")+`\n`,s?'<pre><code class="'+this.options.langPrefix+u(s,!0)+'">'+(e?t:u(t,!0))+`</code></pre>\n`:"<pre><code>"+(e?t:u(t,!0))+`</code></pre>\n`},e.blockquote=function(t){return`<blockquote>\n`+t+`</blockquote>\n`},e.html=function(t){return t},e.heading=function(t,i,e,s){return this.options.headerIds?"<h"+i+' id="'+(this.options.headerPrefix+s.slug(e))+'">'+t+"</h"+i+`>\n`:"<h"+i+">"+t+"</h"+i+`>\n`},e.hr=function(){return this.options.xhtml?`<hr/>\n`:`<hr>\n`},e.list=function(t,i,e){var s=i?"ol":"ul";return"<"+s+(i&&e!==1?' start="'+e+'"':"")+`>\n`+t+"</"+s+`>\n`},e.listitem=function(t){return"<li>"+t+`</li>\n`},e.checkbox=function(t){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},e.paragraph=function(t){return"<p>"+t+`</p>\n`},e.table=function(t,i){return i&&(i="<tbody>"+i+"</tbody>"),`<table>\n<thead>\n`+t+`</thead>\n`+i+`</table>\n`},e.tablerow=function(t){return`<tr>\n`+t+`</tr>\n`},e.tablecell=function(t,i){var e=i.header?"th":"td";return(i.align?"<"+e+' align="'+i.align+'">':"<"+e+">")+t+"</"+e+`>\n`},e.strong=function(t){return"<strong>"+t+"</strong>"},e.em=function(t){return"<em>"+t+"</em>"},e.codespan=function(t){return"<code>"+t+"</code>"},e.br=function(){return this.options.xhtml?"<br/>":"<br>"},e.del=function(t){return"<del>"+t+"</del>"},e.link=function(t,i,e){if((t=v(this.options.sanitize,this.options.baseUrl,t))===null)return e;var s='<a href="'+u(t)+'"';return i&&(s+=' title="'+i+'"'),s+=">"+e+"</a>"},e.image=function(t,i,e){if((t=v(this.options.sanitize,this.options.baseUrl,t))===null)return e;var s='<img src="'+t+'" alt="'+e+'"';return i&&(s+=' title="'+i+'"'),s+=this.options.xhtml?"/>":">"},e.text=function(t){return t},i}(),N=function(){function t(){}var i=t.prototype;return i.strong=function(t){return t},i.em=function(t){return t},i.codespan=function(t){return t},i.del=function(t){return t},i.html=function(t){return t},i.text=function(t){return t},i.link=function(t,i,e){return""+e},i.image=function(t,i,e){return""+e},i.br=function(){return""},t}(),B=function(){function t(){this.seen={}}var i=t.prototype;return i.serialize=function(t){return t.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},i.getNextSafeSlug=function(t,i){var e=t,s=0;if(this.seen.hasOwnProperty(e)){s=this.seen[t];do{e=t+"-"+ ++s}while(this.seen.hasOwnProperty(e))}return i||(this.seen[t]=s,this.seen[e]=0),e},i.slug=function(t,i){i===void 0&&(i={});var e=this.serialize(t);return this.getNextSafeSlug(e,i.dryrun)},t}(),$=function(){function i(i){this.options=i||t.defaults,this.options.renderer=this.options.renderer||new P,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new N,this.slugger=new B}i.parse=function(t,e){return new i(e).parse(t)},i.parseInline=function(t,e){return new i(e).parseInline(t)};var e=i.prototype;return e.parse=function(t,i){i===void 0&&(i=!0);var e,s,n,r,o,h,c,l,a,u,d,g,p,m,w,v,b,y,k,C="",S=t.length;for(e=0;e<S;e++)if(u=t[e],!(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[u.type])||(k=this.options.extensions.renderers[u.type].call({parser:this},u))===!1&&["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(u.type))switch(u.type){case"space":continue;case"hr":C+=this.renderer.hr();continue;case"heading":C+=this.renderer.heading(this.parseInline(u.tokens),u.depth,f(this.parseInline(u.tokens,this.textRenderer)),this.slugger);continue;case"code":C+=this.renderer.code(u.text,u.lang,u.escaped);continue;case"table":for(l="",c="",r=u.header.length,s=0;s<r;s++)c+=this.renderer.tablecell(this.parseInline(u.header[s].tokens),{header:!0,align:u.align[s]});for(l+=this.renderer.tablerow(c),a="",r=u.rows.length,s=0;s<r;s++){for(c="",o=(h=u.rows[s]).length,n=0;n<o;n++)c+=this.renderer.tablecell(this.parseInline(h[n].tokens),{header:!1,align:u.align[n]});a+=this.renderer.tablerow(c)}C+=this.renderer.table(l,a);continue;case"blockquote":a=this.parse(u.tokens),C+=this.renderer.blockquote(a);continue;case"list":for(d=u.ordered,g=u.start,p=u.loose,r=u.items.length,a="",s=0;s<r;s++)v=(w=u.items[s]).checked,b=w.task,m="",w.task&&(y=this.renderer.checkbox(v),p?w.tokens.length>0&&w.tokens[0].type==="paragraph"?(w.tokens[0].text=y+" "+w.tokens[0].text,w.tokens[0].tokens&&w.tokens[0].tokens.length>0&&w.tokens[0].tokens[0].type==="text"&&(w.tokens[0].tokens[0].text=y+" "+w.tokens[0].tokens[0].text)):w.tokens.unshift({type:"text",text:y}):m+=y),m+=this.parse(w.tokens,p),a+=this.renderer.listitem(m,b,v);C+=this.renderer.list(a,d,g);continue;case"html":C+=this.renderer.html(u.text);continue;case"paragraph":C+=this.renderer.paragraph(this.parseInline(u.tokens));continue;case"text":for(a=u.tokens?this.parseInline(u.tokens):u.text;e+1<S&&t[e+1].type==="text";)a+=`\n`+((u=t[++e]).tokens?this.parseInline(u.tokens):u.text);C+=i?this.renderer.paragraph(a):a;continue;default:var x='Token with "'+u.type+'" type was not found.';if(this.options.silent)return void console.error(x);throw new Error(x)}else C+=k||"";return C},e.parseInline=function(t,i){i=i||this.renderer;var e,s,n,r="",o=t.length;for(e=0;e<o;e++)if(s=t[e],!(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type])||(n=this.options.extensions.renderers[s.type].call({parser:this},s))===!1&&["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type))switch(s.type){case"escape":case"text":r+=i.text(s.text);break;case"html":r+=i.html(s.text);break;case"link":r+=i.link(s.href,s.title,this.parseInline(s.tokens,i));break;case"image":r+=i.image(s.href,s.title,s.text);break;case"strong":r+=i.strong(this.parseInline(s.tokens,i));break;case"em":r+=i.em(this.parseInline(s.tokens,i));break;case"codespan":r+=i.codespan(s.text);break;case"br":r+=i.br();break;case"del":r+=i.del(this.parseInline(s.tokens,i));break;default:var h='Token with "'+s.type+'" type was not found.';if(this.options.silent)return void console.error(h);throw new Error(h)}else r+=n||"";return r},i}();function W(t,i,e){if(t==null)throw new Error("marked(): input parameter is undefined or null");if(typeof t!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected");if(typeof i=="function"&&(e=i,i=null),A(i=x({},W.defaults,i||{})),e){var s,n=i.highlight;try{s=_.lex(t,i)}catch(t){return e(t)}var r=function(t){var r;if(!t)try{i.walkTokens&&W.walkTokens(s,i.walkTokens),r=$.parse(s,i)}catch(i){t=i}return i.highlight=n,t?e(t):e(null,r)};if(!n||n.length<3||(delete i.highlight,!s.length))return r();var o=0;return W.walkTokens(s,(function(t){t.type==="code"&&(o++,setTimeout((function(){n(t.text,t.lang,(function(i,e){if(i)return r(i);e!=null&&e!==t.text&&(t.text=e,t.escaped=!0),--o==0&&r()}))}),0))})),void(o===0&&r())}function h(t){if(t.message+=`\nPlease report this to https://github.com/markedjs/marked.`,i.silent)return"<p>An error occurred:</p><pre>"+u(t.message+"",!0)+"</pre>";throw t}try{var c=_.lex(t,i);if(i.walkTokens){if(i.async)return Promise.all(W.walkTokens(c,i.walkTokens)).then((function(){return $.parse(c,i)})).catch(h);W.walkTokens(c,i.walkTokens)}return $.parse(c,i)}catch(t){h(t)}}W.options=W.setOptions=function(i){var e;return x(W.defaults,i),e=W.defaults,t.defaults=e,W},W.getDefaults=n,W.defaults=t.defaults,W.use=function(){for(var t=arguments.length,i=new Array(t),e=0;e<t;e++)i[e]=arguments[e];var s,n=x.apply(void 0,[{}].concat(i)),r=W.defaults.extensions||{renderers:{},childTokens:{}};i.forEach((function(t){if(t.extensions&&(s=!0,t.extensions.forEach((function(t){if(!t.name)throw new Error("extension name required");if(t.renderer){var i=r.renderers?r.renderers[t.name]:null;r.renderers[t.name]=i?function(){for(var e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];var r=t.renderer.apply(this,s);return r===!1&&(r=i.apply(this,s)),r}:t.renderer}if(t.tokenizer){if(!t.level||t.level!=="block"&&t.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");r[t.level]?r[t.level].unshift(t.tokenizer):r[t.level]=[t.tokenizer],t.start&&(t.level==="block"?r.startBlock?r.startBlock.push(t.start):r.startBlock=[t.start]:t.level==="inline"&&(r.startInline?r.startInline.push(t.start):r.startInline=[t.start]))}t.childTokens&&(r.childTokens[t.name]=t.childTokens)}))),t.renderer&&function(){var i=W.defaults.renderer||new P,e=function(e){var s=i[e];i[e]=function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];var h=t.renderer[e].apply(i,r);return h===!1&&(h=s.apply(i,r)),h}};for(var s in t.renderer)e(s);n.renderer=i}(),t.tokenizer&&function(){var i=W.defaults.tokenizer||new F,e=function(e){var s=i[e];i[e]=function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];var h=t.tokenizer[e].apply(i,r);return h===!1&&(h=s.apply(i,r)),h}};for(var s in t.tokenizer)e(s);n.tokenizer=i}(),t.walkTokens){var i=W.defaults.walkTokens;n.walkTokens=function(e){var s=[];return s.push(t.walkTokens.call(this,e)),i&&(s=s.concat(i.call(this,e))),s}}s&&(n.extensions=r),W.setOptions(n)}))},W.walkTokens=function(t,i){for(var e,n=[],r=function(){var t=e.value;switch(n=n.concat(i.call(W,t)),t.type){case"table":for(var r,o=s(t.header);!(r=o()).done;){var h=r.value;n=n.concat(W.walkTokens(h.tokens,i))}for(var c,l=s(t.rows);!(c=l()).done;)for(var a,u=s(c.value);!(a=u()).done;){var d=a.value;n=n.concat(W.walkTokens(d.tokens,i))}break;case"list":n=n.concat(W.walkTokens(t.items,i));break;default:W.defaults.extensions&&W.defaults.extensions.childTokens&&W.defaults.extensions.childTokens[t.type]?W.defaults.extensions.childTokens[t.type].forEach((function(e){n=n.concat(W.walkTokens(t[e],i))})):t.tokens&&(n=n.concat(W.walkTokens(t.tokens,i)))}},o=s(t);!(e=o()).done;)r();return n},W.parseInline=function(t,i){if(t==null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof t!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected");A(i=x({},W.defaults,i||{}));try{var e=_.lexInline(t,i);return i.walkTokens&&W.walkTokens(e,i.walkTokens),$.parseInline(e,i)}catch(t){if(t.message+=`\nPlease report this to https://github.com/markedjs/marked.`,i.silent)return"<p>An error occurred:</p><pre>"+u(t.message+"",!0)+"</pre>";throw t}},W.Parser=$,W.parser=$.parse,W.Renderer=P,W.TextRenderer=N,W.Lexer=_,W.lexer=_.lex,W.Tokenizer=F,W.Slugger=B,W.parse=W;var j=W.options,H=W.setOptions,V=W.use,z=W.walkTokens,U=W.parseInline,K=W,q=$.parse,G=_.lex;t.Lexer=_,t.Parser=$,t.Renderer=P,t.Slugger=B,t.TextRenderer=N,t.Tokenizer=F,t.getDefaults=n,t.lexer=G,t.marked=W,t.options=j,t.parse=K,t.parseInline=U,t.parser=q,t.setOptions=H,t.use=V,t.walkTokens=z,Object.defineProperty(t,"__esModule",{value:!0})},t.amd?t(0,e):e(typeof exports=="object"&&typeof module<"u"?exports:(i=typeof globalThis<"u"?globalThis:i||self).marked={})})(),N_.Lexer||exports.Lexer,N_.Parser||exports.Parser,N_.Renderer||exports.Renderer,N_.Slugger||exports.Slugger,N_.TextRenderer||exports.TextRenderer,N_.Tokenizer||exports.Tokenizer,N_.getDefaults||exports.getDefaults,N_.lexer||exports.lexer;var B_=N_.marked||exports.marked;function $_(t){let i=JSON.parse(t);return i=j_(i),i}function W_(t,i){return i instanceof RegExp?{$mid:2,source:i.source,flags:i.flags}:i}function j_(t,i=0){if(!t||i>200)return t;if(typeof t=="object"){switch(t.$mid){case 1:return as.revive(t);case 2:return new RegExp(t.source,t.flags);case 17:return new Date(t.source)}if(t instanceof nd||t instanceof Uint8Array)return t;if(Array.isArray(t))for(let e=0;e<t.length;++e)t[e]=j_(t[e],i+1);else for(const e in t)Object.hasOwnProperty.call(t,e)&&(t[e]=j_(t[e],i+1))}return t}N_.options||exports.options,N_.parse||exports.parse,N_.parseInline||exports.parseInline,N_.parser||exports.parser,N_.setOptions||exports.setOptions,N_.use||exports.use,N_.walkTokens||exports.walkTokens;const H_=Object.freeze({image:(t,i,e)=>{let s=[],n=[];return t&&(({href:t,dimensions:s}=function(t){const i=[],e=t.split("|").map((t=>t.trim()));t=e[0];const s=e[1];if(s){const t=/height=(\d+)/.exec(s),e=/width=(\d+)/.exec(s),n=t?t[1]:"",r=e?e[1]:"",o=isFinite(parseInt(r)),h=isFinite(parseInt(n));o&&i.push(`width="${r}"`),h&&i.push(`height="${n}"`)}return{href:t,dimensions:i}}(t)),n.push(`src="${O_(t)}"`)),e&&n.push(`alt="${O_(e)}"`),i&&n.push(`title="${O_(i)}"`),s.length&&(n=n.concat(s)),"<img "+n.join(" ")+">"},paragraph:t=>`<p>${t}</p>`,link:(t,i,e)=>typeof t!="string"?"":(t===e&&(e=I_(e)),i=typeof i=="string"?O_(I_(i)):"",`<a href="${t=(t=I_(t)).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}" title="${i||t}" draggable="false">${e}</a>`)});function V_(t,i={},e={}){var s,n;const r=new Ji;let o=!1;const h=fI(i),c=function(i){let e;try{e=$_(decodeURIComponent(i))}catch{}return e?(e=q(e,(i=>t.uris&&t.uris[i]?as.revive(t.uris[i]):void 0)),encodeURIComponent(JSON.stringify(e))):i},l=function(i,e){const s=t.uris&&t.uris[i];let n=as.revive(s);return e?i.startsWith(Lh.data+":")?i:(n||(n=as.parse(i)),Ih.uriToBrowserUri(n).toString(!0)):n?as.parse(i).toString()===n.toString()?i:(n.query&&(n=n.with({query:c(n.query)})),n.toString()):i},a=new B_.Renderer;a.image=H_.image,a.link=H_.link,a.paragraph=H_.paragraph;const u=[],d=[];if(i.codeBlockRendererSync?a.code=(t,e)=>{const s=P_.nextId(),n=i.codeBlockRendererSync(z_(e),t);return d.push([s,n]),`<div class="code" data-code="${s}">${qn(t)}</div>`}:i.codeBlockRenderer&&(a.code=(t,e)=>{const s=P_.nextId(),n=i.codeBlockRenderer(z_(e),t);return u.push(n.then((t=>[s,t]))),`<div class="code" data-code="${s}">${qn(t)}</div>`}),i.actionHandler){const e=function(e){let s=e.target;if(s.tagName==="A"||(s=s.parentElement,s&&s.tagName==="A"))try{let n=s.dataset.href;n&&(t.baseUri&&(n=U_(as.from(t.baseUri),n)),i.actionHandler.callback(n,e))}catch(t){Ii(t)}finally{e.preventDefault()}},s=i.actionHandler.disposables.add(new uC(h,"click")),n=i.actionHandler.disposables.add(new uC(h,"auxclick"));i.actionHandler.disposables.add(ne.any(s.event,n.event)((t=>{const i=new ho(Uh(h),t);(i.leftButton||i.middleButton)&&e(i)}))),i.actionHandler.disposables.add(sc(h,"keydown",(t=>{const i=new so(t);(i.equals(10)||i.equals(3))&&e(i)})))}t.supportHtml||(e.sanitizer=i=>t.isTrusted&&i.match(/^(<span[^>]+>)|(<\/\s*span>)$/)?i:"",e.sanitize=!0,e.silent=!0),e.renderer=a;let f,g=(s=t.value)!==null&&s!==void 0?s:"";if(g.length>1e5&&(g=`${g.substr(0,1e5)}…`),t.supportThemeIcons&&(g=function(t){return t.replace(x_,(t=>`\\${t}`))}(g)),i.fillInIncompleteTokens){const t={...B_.defaults,...e},i=function(t){let i,e;for(i=0;i<t.length;i++){const s=t[i];let n;if(s.type==="paragraph"&&(n=s.raw.match(/(\n|^)(````*)/))){const s=n[2];e=tP(t.slice(i),s);break}if(s.type==="paragraph"&&s.raw.match(/(\n|^)\|/)){e=lP(t.slice(i));break}if(i===t.length-1&&s.type==="paragraph"){const t=Y_(s);if(t){e=[t];break}}}if(e){const s=[...t.slice(0,i),...e];return s.links=t.links,s}return t}(B_.lexer(g,t));f=B_.parser(i,t)}else f=B_.parse(g,e);t.supportThemeIcons&&(f=bI(f).map((t=>typeof t=="string"?t:t.outerHTML)).join(""));const p=(new DOMParser).parseFromString(K_(t,f),"text/html");if(p.body.querySelectorAll("img").forEach((i=>{const e=i.getAttribute("src");if(e){let s=e;try{t.baseUri&&(s=U_(as.from(t.baseUri),s))}catch{}i.src=l(s,!0)}})),p.body.querySelectorAll("a").forEach((i=>{const e=i.getAttribute("href");if(i.setAttribute("href",""),!e||/^data:|javascript:/i.test(e)||/^command:/i.test(e)&&!t.isTrusted||/^command:(\/\/\/)?_workbench\.downloadResource/i.test(e))i.replaceWith(...i.childNodes);else{let s=l(e,!1);t.baseUri&&(s=U_(as.from(t.baseUri),e)),i.dataset.href=s}})),h.innerHTML=K_(t,p.body.innerHTML),u.length>0)Promise.all(u).then((t=>{var e,s;if(o)return;const n=new Map(t),r=h.querySelectorAll("div[data-code]");for(const t of r){const i=n.get((e=t.dataset.code)!==null&&e!==void 0?e:"");i&&tl(t,i)}(s=i.asyncRenderCallback)===null||s===void 0||s.call(i)}));else if(d.length>0){const t=new Map(d),i=h.querySelectorAll("div[data-code]");for(const e of i){const i=t.get((n=e.dataset.code)!==null&&n!==void 0?n:"");i&&tl(e,i)}}if(i.asyncRenderCallback)for(const t of h.getElementsByTagName("img")){const e=r.add(sc(t,"load",(()=>{e.dispose(),i.asyncRenderCallback()})))}return{element:h,dispose:()=>{o=!0,r.dispose()}}}function z_(t){if(!t)return"";const i=t.split(/[\s+|:|,|\{|\?]/,1);return i.length?i[0]:t}function U_(t,i){return/^\w[\w\d+.-]*:/.test(i)?i:t.path.endsWith("/")?LM(t,i).toString():LM(DM(t),i).toString()}function K_(t,i){const{config:e,allowedSchemes:s}=function(t){const i=[Lh.http,Lh.https,Lh.mailto,Lh.data,Lh.file,Lh.vscodeFileResource,Lh.vscodeRemote,Lh.vscodeRemoteResource];return t.isTrusted&&i.push(Lh.command),{config:{ALLOWED_TAGS:[...dl],ALLOWED_ATTR:q_,ALLOW_UNKNOWN_PROTOCOLS:!0},allowedSchemes:i}}(t);Ah("uponSanitizeAttribute",((t,i)=>{var e;if(i.attrName!=="style"&&i.attrName!=="class"){if(t.tagName==="INPUT"&&((e=t.attributes.getNamedItem("type"))===null||e===void 0?void 0:e.value)==="checkbox"){if(i.attrName==="type"&&i.attrValue==="checkbox"||i.attrName==="disabled"||i.attrName==="checked")return void(i.keepAttr=!0);i.keepAttr=!1}}else{if(t.tagName==="SPAN"){if(i.attrName==="style")return void(i.keepAttr=/^(color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z]+)+\));)?(background-color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z]+)+\));)?$/.test(i.attrValue));if(i.attrName==="class")return void(i.keepAttr=/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(i.attrValue))}i.keepAttr=!1}})),Ah("uponSanitizeElement",((t,i)=>{var e,s;i.tagName==="input"&&(((e=t.attributes.getNamedItem("type"))===null||e===void 0?void 0:e.value)==="checkbox"?t.setAttribute("disabled",""):(s=t.parentElement)===null||s===void 0||s.removeChild(t))}));const n=function(t,i=!1){const e=document.createElement("a");return Ah("afterSanitizeAttributes",(s=>{for(const n of["href","src"])if(s.hasAttribute(n)){const r=s.getAttribute(n);if(n==="href"&&r.startsWith("#"))continue;if(e.href=r,!t.includes(e.protocol.replace(/:$/,""))){if(i&&n==="src"&&e.href.startsWith("data:"))continue;s.removeAttribute(n)}}})),Zi((()=>{Mh("afterSanitizeAttributes")}))}(s);try{return Eh(i,{...e,RETURN_TRUSTED_TYPE:!0})}finally{Mh("uponSanitizeAttribute"),n.dispose()}}const q_=["align","autoplay","alt","checked","class","controls","data-code","data-href","disabled","draggable","height","href","loop","muted","playsinline","poster","src","style","target","title","type","width","start"];function G_(t){return typeof t=="string"?t:function(t){var i;let e=(i=t.value)!==null&&i!==void 0?i:"";e.length>1e5&&(e=`${e.substr(0,1e5)}…`);const s=B_.parse(e,{renderer:J_.value}).replace(/&(#\d+|[a-zA-Z]+);/g,(t=>{var i;return(i=Z_.get(t))!==null&&i!==void 0?i:t}));return K_({isTrusted:!1},s).toString()}(t)}const Z_=new Map([["&quot;",'"'],["&nbsp;"," "],["&amp;","&"],["&#39;","'"],["&lt;","<"],["&gt;",">"]]),J_=new Hn((()=>{const t=new B_.Renderer;return t.code=t=>t,t.blockquote=t=>t,t.html=t=>"",t.heading=(t,i,e)=>t+`\n`,t.hr=()=>"",t.list=(t,i)=>t,t.listitem=t=>t+`\n`,t.paragraph=t=>t+`\n`,t.table=(t,i)=>t+i+`\n`,t.tablerow=t=>t,t.tablecell=(t,i)=>t+" ",t.strong=t=>t,t.em=t=>t,t.codespan=t=>t,t.br=()=>`\n`,t.del=t=>t,t.image=(t,i,e)=>"",t.text=t=>t,t.link=(t,i,e)=>e,t}));function Q_(t){let i="";return t.forEach((t=>{i+=t.raw})),i}function Y_(t){var i,e;for(let s=0;s<t.tokens.length;s++){const n=t.tokens[s];if(n.type==="text"){const r=n.raw.split(`\n`),o=r[r.length-1];if(o.includes("`"))return iP(t);if(o.includes("**"))return cP(t,"**");if(o.match(/\*\w/))return eP(t);if(o.match(/(^|\s)__\w/))return hP(t);if(o.match(/(^|\s)_\w/))return sP(t);if(o.match(/(^|\s)\[.*\]\(\w*/)){const n=t.tokens.slice(s+1);return((i=n[0])===null||i===void 0?void 0:i.type)==="link"&&((e=n[1])===null||e===void 0?void 0:e.type)==="text"&&n[1].raw.match(/^ *"[^"]*$/)?rP(t):nP(t)}if(X_(o))return nP(t);if(o.match(/(^|\s)\[\w/)&&!t.tokens.slice(s+1).some((t=>X_(t.raw))))return oP(t)}}}function X_(t){return!!t.match(/^[^\[]*\]\([^\)]*$/)}function tP(t,i){const e=Q_(t);return B_.lexer(e+`\n${i}`)}function iP(t){return cP(t,"`")}function eP(t){return cP(t,"*")}function sP(t){return cP(t,"_")}function nP(t){return cP(t,")")}function rP(t){return cP(t,'")')}function oP(t){return cP(t,"](about:blank)")}function hP(t){return cP(t,"__")}function cP(t,i){const e=Q_(Array.isArray(t)?t:[t]);return B_.lexer(e+i)[0]}function lP(t){const i=Q_(t),e=i.split(`\n`);let s,n=!1;for(let t=0;t<e.length;t++){const i=e[t].trim();if(s===void 0&&i.match(/^\s*\|/)){const t=i.match(/(\|[^\|]+)(?=\||$)/g);t&&(s=t.length)}else if(typeof s=="number"){if(!i.match(/^\s*\|/)||t!==e.length-1)return;n=!0}}if(typeof s=="number"&&s>0){const t=n?e.slice(0,-1).join(`\n`):i,r=!!t.match(/\|\s*$/),o=t+(r?"":"|")+`\n|${" --- |".repeat(s)}`;return B_.lexer(o)}}var aP,uP=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},dP=function(t,i){return function(e,s){i(e,s,t)}};let fP=aP=class{constructor(t,i,e){this._options=t,this._languageService=i,this._openerService=e,this._onDidRenderAsync=new le,this.onDidRenderAsync=this._onDidRenderAsync.event}dispose(){this._onDidRenderAsync.dispose()}render(t,i,e){if(!t)return{element:document.createElement("span"),dispose:()=>{}};const s=new Ji,n=s.add(V_(t,{...this._getRenderOptions(t,s),...i},e));return n.element.classList.add("rendered-markdown"),{element:n.element,dispose:()=>s.dispose()}}_getRenderOptions(t,i){return{codeBlockRenderer:async(t,i)=>{var e,s,n;let r;t?r=this._languageService.getLanguageIdByLanguageName(t):this._options.editor&&(r=(e=this._options.editor.getModel())===null||e===void 0?void 0:e.getLanguageId()),r||(r=Yd);const o=await async function(t,i,e){if(!e)return TT(i,t.languageIdCodec,LT);const s=await Us.getOrCreate(e);return TT(i,t.languageIdCodec,s||LT)}(this._languageService,i,r),h=document.createElement("span");return h.innerHTML=(n=(s=aP._ttpTokenizer)===null||s===void 0?void 0:s.createHTML(o))!==null&&n!==void 0?n:o,this._options.editor?xl(h,this._options.editor.getOption(50)):this._options.codeBlockFontFamily&&(h.style.fontFamily=this._options.codeBlockFontFamily),this._options.codeBlockFontSize!==void 0&&(h.style.fontSize=this._options.codeBlockFontSize),h},asyncRenderCallback:()=>this._onDidRenderAsync.fire(),actionHandler:{callback:i=>gP(this._openerService,i,t.isTrusted),disposables:i}}}};async function gP(t,i,e){try{return await t.open(i,{fromUserGesture:!0,allowContributedOpeners:!0,allowCommands:pP(e)})}catch(t){return Ii(t),!1}}function pP(t){return t===!0||!(!t||!Array.isArray(t.enabledCommands))&&t.enabledCommands}fP._ttpTokenizer=ju("tokenizeToString",{createHTML:t=>t}),fP=aP=uP([dP(1,Id),dP(2,uI)],fP);var mP=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},wP=function(t,i){return function(e,s){i(e,s,t)}};const vP=nl;let bP=class extends jk{get _targetWindow(){return Uh(this._target.targetElements[0])}get _targetDocumentElement(){return Uh(this._target.targetElements[0]).document.documentElement}get isDisposed(){return this._isDisposed}get isMouseIn(){return this._lockMouseTracker.isMouseIn}get domNode(){return this._hover.containerDomNode}get onDispose(){return this._onDispose.event}get onRequestLayout(){return this._onRequestLayout.event}get anchor(){return this._hoverPosition===2?0:1}get x(){return this._x}get y(){return this._y}get isLocked(){return this._isLocked}set isLocked(t){this._isLocked!==t&&(this._isLocked=t,this._hoverContainer.classList.toggle("locked",this._isLocked))}constructor(t,i,e,s,n,r){var o,h,c,l,a,u,d,f;super(),this._keybindingService=i,this._configurationService=e,this._openerService=s,this._instantiationService=n,this._accessibilityService=r,this._messageListeners=new Ji,this._isDisposed=!1,this._forcePosition=!1,this._x=0,this._y=0,this._isLocked=!1,this._enableFocusTraps=!1,this._addedFocusTrap=!1,this._onDispose=this._register(new le),this._onRequestLayout=this._register(new le),this._linkHandler=t.linkHandler||(i=>gP(this._openerService,i,R_(t.content)?t.content.isTrusted:void 0)),this._target="targetElements"in t.target?t.target:new kP(t.target),this._hoverPointer=!((o=t.appearance)===null||o===void 0)&&o.showPointer?vP("div.workbench-hover-pointer"):void 0,this._hover=this._register(new cI),this._hover.containerDomNode.classList.add("workbench-hover","fadeIn"),!((h=t.appearance)===null||h===void 0)&&h.compact&&this._hover.containerDomNode.classList.add("workbench-hover","compact"),!((c=t.appearance)===null||c===void 0)&&c.skipFadeInAnimation&&this._hover.containerDomNode.classList.add("skip-fade-in"),t.additionalClasses&&this._hover.containerDomNode.classList.add(...t.additionalClasses),!((l=t.position)===null||l===void 0)&&l.forcePosition&&(this._forcePosition=!0),t.trapFocus&&(this._enableFocusTraps=!0),this._hoverPosition=(u=(a=t.position)===null||a===void 0?void 0:a.hoverPosition)!==null&&u!==void 0?u:3,this.onmousedown(this._hover.containerDomNode,(t=>t.stopPropagation())),this.onkeydown(this._hover.containerDomNode,(t=>{t.equals(9)&&this.dispose()})),this._register(sc(this._targetWindow,"blur",(()=>this.dispose())));const g=vP("div.hover-row.markdown-hover"),p=vP("div.hover-contents");if(typeof t.content=="string")p.textContent=t.content,p.style.whiteSpace="pre-wrap";else if(t.content instanceof HTMLElement)p.appendChild(t.content),p.classList.add("html-hover-contents");else{const i=t.content,e=this._instantiationService.createInstance(fP,{codeBlockFontFamily:this._configurationService.getValue("editor").fontFamily||Li.fontFamily}),{element:s}=e.render(i,{actionHandler:{callback:t=>this._linkHandler(t),disposables:this._messageListeners},asyncRenderCallback:()=>{p.classList.add("code-hover-contents"),this.layout(),this._onRequestLayout.fire()}});p.appendChild(s)}if(g.appendChild(p),this._hover.contentsDomNode.appendChild(g),t.actions&&t.actions.length>0){const i=vP("div.hover-row.status-bar"),e=vP("div.actions");t.actions.forEach((t=>{const i=this._keybindingService.lookupKeybinding(t.commandId),s=i?i.getLabel():null;lI.render(e,{label:t.label,commandId:t.commandId,run:i=>{t.run(i),this.dispose()},iconClass:t.iconClass},s)})),i.appendChild(e),this._hover.containerDomNode.appendChild(i)}let m;if(this._hoverContainer=vP("div.workbench-hover-container"),this._hoverPointer&&this._hoverContainer.appendChild(this._hoverPointer),this._hoverContainer.appendChild(this._hover.containerDomNode),m=!(t.actions&&t.actions.length>0)&&(((d=t.persistence)===null||d===void 0?void 0:d.hideOnHover)===void 0?typeof t.content=="string"||R_(t.content)&&!t.content.value.includes("](")&&!t.content.value.includes("</a>"):t.persistence.hideOnHover),m&&((f=t.appearance)===null||f===void 0?void 0:f.showHoverHint)){const t=vP("div.hover-row.status-bar"),i=vP("div.info");i.textContent=tt(0,"Hold {0} key to mouse over",bt?"Option":"Alt"),t.appendChild(i),this._hover.containerDomNode.appendChild(t)}const w=[...this._target.targetElements];m||w.push(this._hoverContainer);const v=this._register(new yP(w));if(this._register(v.onMouseOut((()=>{this._isLocked||this.dispose()}))),m){const t=[...this._target.targetElements,this._hoverContainer];this._lockMouseTracker=this._register(new yP(t)),this._register(this._lockMouseTracker.onMouseOut((()=>{this._isLocked||this.dispose()})))}else this._lockMouseTracker=v}addFocusTrap(){if(!this._enableFocusTraps||this._addedFocusTrap)return;this._addedFocusTrap=!0;const t=this._hover.containerDomNode,i=this.findLastFocusableChild(this._hover.containerDomNode);if(i){const e=Xc(this._hoverContainer,vP("div")),s=Yc(this._hoverContainer,vP("div"));e.tabIndex=0,s.tabIndex=0,this._register(sc(s,"focus",(i=>{t.focus(),i.preventDefault()}))),this._register(sc(e,"focus",(t=>{i.focus(),t.preventDefault()})))}}findLastFocusableChild(t){if(t.hasChildNodes())for(let i=0;i<t.childNodes.length;i++){const e=t.childNodes.item(t.childNodes.length-i-1);if(e.nodeType===e.ELEMENT_NODE){const t=e;if(typeof t.tabIndex=="number"&&t.tabIndex>=0)return t}const s=this.findLastFocusableChild(e);if(s)return s}}render(t){var i;t.appendChild(this._hoverContainer);const e=this._hoverContainer.contains(this._hoverContainer.ownerDocument.activeElement)&&aI(this._configurationService.getValue("accessibility.verbosity.hover")===!0&&this._accessibilityService.isScreenReaderOptimized(),(i=this._keybindingService.lookupKeybinding("editor.action.accessibleView"))===null||i===void 0?void 0:i.getAriaLabel());e&&ow(e),this.layout(),this.addFocusTrap()}layout(){this._hover.containerDomNode.classList.remove("right-aligned"),this._hover.contentsDomNode.style.maxHeight="";const t=this._target.targetElements.map((t=>(t=>{const i=bc(t),e=t.getBoundingClientRect();return{top:e.top*i,bottom:e.bottom*i,right:e.right*i,left:e.left*i}})(t))),{top:i,right:e,bottom:s,left:n}=t[0],r=e-n,o=s-i,h={top:i,right:e,bottom:s,left:n,width:r,height:o,center:{x:n+r/2,y:i+o/2}};if(this.adjustHorizontalHoverPosition(h),this.adjustVerticalHoverPosition(h),this.adjustHoverMaxHeight(h),this._hoverContainer.style.padding="",this._hoverContainer.style.margin="",this._hoverPointer){switch(this._hoverPosition){case 1:h.left+=3,h.right+=3,this._hoverContainer.style.paddingLeft="3px",this._hoverContainer.style.marginLeft="-3px";break;case 0:h.left-=3,h.right-=3,this._hoverContainer.style.paddingRight="3px",this._hoverContainer.style.marginRight="-3px";break;case 2:h.top+=3,h.bottom+=3,this._hoverContainer.style.paddingTop="3px",this._hoverContainer.style.marginTop="-3px";break;case 3:h.top-=3,h.bottom-=3,this._hoverContainer.style.paddingBottom="3px",this._hoverContainer.style.marginBottom="-3px"}h.center.x=h.left+r/2,h.center.y=h.top+o/2}this.computeXCordinate(h),this.computeYCordinate(h),this._hoverPointer&&(this._hoverPointer.classList.remove("top"),this._hoverPointer.classList.remove("left"),this._hoverPointer.classList.remove("right"),this._hoverPointer.classList.remove("bottom"),this.setHoverPointerPosition(h)),this._hover.onContentsChanged()}computeXCordinate(t){const i=this._hover.containerDomNode.clientWidth+2;this._target.x!==void 0?this._x=this._target.x:this._hoverPosition===1?this._x=t.right:this._hoverPosition===0?this._x=t.left-i:(this._hoverPointer?this._x=t.center.x-this._hover.containerDomNode.clientWidth/2:this._x=t.left,this._x+i>=this._targetDocumentElement.clientWidth&&(this._hover.containerDomNode.classList.add("right-aligned"),this._x=Math.max(this._targetDocumentElement.clientWidth-i-2,this._targetDocumentElement.clientLeft))),this._x<this._targetDocumentElement.clientLeft&&(this._x=t.left+2)}computeYCordinate(t){this._target.y!==void 0?this._y=this._target.y:this._hoverPosition===3?this._y=t.top:this._hoverPosition===2?this._y=t.bottom-2:this._hoverPointer?this._y=t.center.y+this._hover.containerDomNode.clientHeight/2:this._y=t.bottom,this._y>this._targetWindow.innerHeight&&(this._y=t.bottom)}adjustHorizontalHoverPosition(t){if(this._target.x!==void 0)return;const i=this._hoverPointer?3:0;if(this._forcePosition){const e=i+2;this._hoverPosition===1?this._hover.containerDomNode.style.maxWidth=this._targetDocumentElement.clientWidth-t.right-e+"px":this._hoverPosition===0&&(this._hover.containerDomNode.style.maxWidth=t.left-e+"px")}else this._hoverPosition===1?this._targetDocumentElement.clientWidth-t.right<this._hover.containerDomNode.clientWidth+i&&(t.left>=this._hover.containerDomNode.clientWidth+i?this._hoverPosition=0:this._hoverPosition=2):this._hoverPosition===0&&(t.left<this._hover.containerDomNode.clientWidth+i&&(this._targetDocumentElement.clientWidth-t.right>=this._hover.containerDomNode.clientWidth+i?this._hoverPosition=1:this._hoverPosition=2),t.left-this._hover.containerDomNode.clientWidth-i<=this._targetDocumentElement.clientLeft&&(this._hoverPosition=1))}adjustVerticalHoverPosition(t){if(this._target.y!==void 0||this._forcePosition)return;const i=this._hoverPointer?3:0;this._hoverPosition===3?t.top-this._hover.containerDomNode.clientHeight-i<0&&(this._hoverPosition=2):this._hoverPosition===2&&t.bottom+this._hover.containerDomNode.clientHeight+i>this._targetWindow.innerHeight&&(this._hoverPosition=3)}adjustHoverMaxHeight(t){let i=this._targetWindow.innerHeight/2;if(this._forcePosition){const e=2+(this._hoverPointer?3:0);this._hoverPosition===3?i=Math.min(i,t.top-e):this._hoverPosition===2&&(i=Math.min(i,this._targetWindow.innerHeight-t.bottom-e))}if(this._hover.containerDomNode.style.maxHeight=`${i}px`,this._hover.contentsDomNode.clientHeight<this._hover.contentsDomNode.scrollHeight){const t=`${this._hover.scrollbar.options.verticalScrollbarSize}px`;this._hover.contentsDomNode.style.paddingRight!==t&&(this._hover.contentsDomNode.style.paddingRight=t)}}setHoverPointerPosition(t){if(this._hoverPointer)switch(this._hoverPosition){case 0:case 1:{this._hoverPointer.classList.add(this._hoverPosition===0?"right":"left");const i=this._hover.containerDomNode.clientHeight;i>t.height?this._hoverPointer.style.top=t.center.y-(this._y-i)-3+"px":this._hoverPointer.style.top=Math.round(i/2)-3+"px";break}case 3:case 2:{this._hoverPointer.classList.add(this._hoverPosition===3?"bottom":"top");const i=this._hover.containerDomNode.clientWidth;let e=Math.round(i/2)-3;const s=this._x+e;(s<t.left||s>t.right)&&(e=t.center.x-this._x-3),this._hoverPointer.style.left=`${e}px`;break}}}focus(){this._hover.containerDomNode.focus()}dispose(){this._isDisposed||(this._onDispose.fire(),this._hoverContainer.remove(),this._messageListeners.dispose(),this._target.dispose(),super.dispose()),this._isDisposed=!0}};bP=mP([wP(1,NS),wP(2,Md),wP(3,uI),wP(4,Il),wP(5,vw)],bP);class yP extends jk{get onMouseOut(){return this._onMouseOut.event}get isMouseIn(){return this._isMouseIn}constructor(t){super(),this._elements=t,this._isMouseIn=!0,this._onMouseOut=this._register(new le),this._elements.forEach((t=>this.onmouseover(t,(()=>this._onTargetMouseOver(t))))),this._elements.forEach((t=>this.onmouseleave(t,(()=>this._onTargetMouseLeave(t)))))}_onTargetMouseOver(t){this._isMouseIn=!0,this._clearEvaluateMouseStateTimeout(t)}_onTargetMouseLeave(t){this._isMouseIn=!1,this._evaluateMouseState(t)}_evaluateMouseState(t){this._clearEvaluateMouseStateTimeout(t),this._mouseTimeout=Uh(t).setTimeout((()=>this._fireIfMouseOutside()),0)}_clearEvaluateMouseStateTimeout(t){this._mouseTimeout&&(Uh(t).clearTimeout(this._mouseTimeout),this._mouseTimeout=void 0)}_fireIfMouseOutside(){this._isMouseIn||this._onMouseOut.fire()}}class kP{constructor(t){this._element=t,this.targetElements=[this._element]}dispose(){}}var CP,SP;function xP(t,i,e){const s=e.mode===SP.ALIGN?e.offset:e.offset+e.size,n=e.mode===SP.ALIGN?e.offset+e.size:e.offset;return e.position===0?i<=t-s?s:i<=n?n-i:Math.max(t-i,0):i<=n?n-i:i<=t-s?s:0}(function(t){function i(t,i){if(t.start>=i.end||i.start>=t.end)return{start:0,end:0};const e=Math.max(t.start,i.start),s=Math.min(t.end,i.end);return s-e<=0?{start:0,end:0}:{start:e,end:s}}function e(t){return t.end-t.start<=0}t.intersect=i,t.isEmpty=e,t.intersects=function(t,s){return!e(i(t,s))},t.relativeComplement=function(t,i){const s=[],n={start:t.start,end:Math.min(i.start,t.end)},r={start:Math.max(i.end,t.start),end:t.end};return e(n)||s.push(n),e(r)||s.push(r),s}})(CP||(CP={})),function(t){t[t.AVOID=0]="AVOID",t[t.ALIGN=1]="ALIGN"}(SP||(SP={}));class DP extends Qi{constructor(t,i){super(),this.container=null,this.useFixedPosition=!1,this.useShadowDOM=!1,this.delegate=null,this.toDisposeOnClean=Qi.None,this.toDisposeOnSetContainer=Qi.None,this.shadowRoot=null,this.shadowRootHostElement=null,this.view=nl(".context-view"),ol(this.view),this.setContainer(t,i),this._register(Zi((()=>this.setContainer(null,1))))}setContainer(t,i){var e;this.useFixedPosition=i!==1;const s=this.useShadowDOM;if(this.useShadowDOM=i===3,(t!==this.container||s!==this.useShadowDOM)&&(this.container&&(this.toDisposeOnSetContainer.dispose(),this.shadowRoot?(this.shadowRoot.removeChild(this.view),this.shadowRoot=null,(e=this.shadowRootHostElement)===null||e===void 0||e.remove(),this.shadowRootHostElement=null):this.container.removeChild(this.view),this.container=null),t)){if(this.container=t,this.useShadowDOM){this.shadowRootHostElement=nl(".shadow-root-host"),this.container.appendChild(this.shadowRootHostElement),this.shadowRoot=this.shadowRootHostElement.attachShadow({mode:"open"});const t=document.createElement("style");t.textContent=EP,this.shadowRoot.appendChild(t),this.shadowRoot.appendChild(this.view),this.shadowRoot.appendChild(nl("slot"))}else this.container.appendChild(this.view);const i=new Ji;DP.BUBBLE_UP_EVENTS.forEach((t=>{i.add(rc(this.container,t,(t=>{this.onDOMEvent(t,!1)})))})),DP.BUBBLE_DOWN_EVENTS.forEach((t=>{i.add(rc(this.container,t,(t=>{this.onDOMEvent(t,!0)}),!0))})),this.toDisposeOnSetContainer=i}}show(t){var i,e,s;this.isVisible()&&this.hide(),ic(this.view),this.view.className="context-view",this.view.style.top="0px",this.view.style.left="0px",this.view.style.zIndex=`${2575+((i=t.layer)!==null&&i!==void 0?i:0)}`,this.view.style.position=this.useFixedPosition?"fixed":"absolute",rl(this.view),this.toDisposeOnClean=t.render(this.view)||Qi.None,this.delegate=t,this.doLayout(),(s=(e=this.delegate).focus)===null||s===void 0||s.call(e)}getViewElement(){return this.view}layout(){var t,i;this.isVisible()&&(this.delegate.canRelayout!==!1||xt&&Gr?((i=(t=this.delegate)===null||t===void 0?void 0:t.layout)===null||i===void 0||i.call(t),this.doLayout()):this.hide())}doLayout(){if(!this.isVisible())return;const t=this.delegate.getAnchor();let i;if(t instanceof HTMLElement){const e=vc(t),s=bc(t);i={top:e.top*s,left:e.left*s,width:e.width*s,height:e.height*s}}else i=function(t){const i=t;return!!i&&typeof i.x=="number"&&typeof i.y=="number"}(t)?{top:t.y,left:t.x,width:t.width||1,height:t.height||2}:{top:t.posy,left:t.posx,width:2,height:2};const e=yc(this.view),s=Sc(this.view),n=this.delegate.anchorPosition||0,r=this.delegate.anchorAlignment||0,o=this.delegate.anchorAxisAlignment||0;let h,c;const l=function(){var t,i;return(i=(t=Rc().defaultView)===null||t===void 0?void 0:t.window)!==null&&i!==void 0?i:Wn}();if(o===0){const t={offset:i.top-l.pageYOffset,size:i.height,position:n===0?0:1},o={offset:i.left,size:i.width,position:r===0?0:1,mode:SP.ALIGN};h=xP(l.innerHeight,s,t)+l.pageYOffset,CP.intersects({start:h,end:h+s},{start:t.offset,end:t.offset+t.size})&&(o.mode=SP.AVOID),c=xP(l.innerWidth,e,o)}else{const t={offset:i.left,size:i.width,position:r===0?0:1},o={offset:i.top,size:i.height,position:n===0?0:1,mode:SP.ALIGN};c=xP(l.innerWidth,e,t),CP.intersects({start:c,end:c+e},{start:t.offset,end:t.offset+t.size})&&(o.mode=SP.AVOID),h=xP(l.innerHeight,s,o)+l.pageYOffset}this.view.classList.remove("top","bottom","left","right"),this.view.classList.add(n===0?"bottom":"top"),this.view.classList.add(r===0?"left":"right"),this.view.classList.toggle("fixed",this.useFixedPosition);const a=vc(this.container);this.view.style.top=h-(this.useFixedPosition?vc(this.view).top:a.top)+"px",this.view.style.left=c-(this.useFixedPosition?vc(this.view).left:a.left)+"px",this.view.style.width="initial"}hide(t){const i=this.delegate;this.delegate=null,i!=null&&i.onHide&&i.onHide(t),this.toDisposeOnClean.dispose(),ol(this.view)}isVisible(){return!!this.delegate}onDOMEvent(t,i){this.delegate&&(this.delegate.onDOMEvent?this.delegate.onDOMEvent(t,Uh(t).document.activeElement):i&&!xc(t.target,this.container)&&this.hide())}dispose(){this.hide(),super.dispose()}}DP.BUBBLE_UP_EVENTS=["click","keydown","focus","blur"],DP.BUBBLE_DOWN_EVENTS=["click"];const EP=`\n\t:host {\n\t\tall: initial; /* 1st rule so subsequent properties are reset. */\n\t}\n\n\t.codicon[class*='codicon-'] {\n\t\tfont: normal normal normal 16px/1 codicon;\n\t\tdisplay: inline-block;\n\t\ttext-decoration: none;\n\t\ttext-rendering: auto;\n\t\ttext-align: center;\n\t\t-webkit-font-smoothing: antialiased;\n\t\t-moz-osx-font-smoothing: grayscale;\n\t\tuser-select: none;\n\t\t-webkit-user-select: none;\n\t\t-ms-user-select: none;\n\t}\n\n\t:host {\n\t\tfont-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "HelveticaNeue-Light", system-ui, "Ubuntu", "Droid Sans", sans-serif;\n\t}\n\n\t:host-context(.mac) { font-family: -apple-system, BlinkMacSystemFont, sans-serif; }\n\t:host-context(.mac:lang(zh-Hans)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", sans-serif; }\n\t:host-context(.mac:lang(zh-Hant)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang TC", sans-serif; }\n\t:host-context(.mac:lang(ja)) { font-family: -apple-system, BlinkMacSystemFont, "Hiragino Kaku Gothic Pro", sans-serif; }\n\t:host-context(.mac:lang(ko)) { font-family: -apple-system, BlinkMacSystemFont, "Nanum Gothic", "Apple SD Gothic Neo", "AppleGothic", sans-serif; }\n\n\t:host-context(.windows) { font-family: "Segoe WPC", "Segoe UI", sans-serif; }\n\t:host-context(.windows:lang(zh-Hans)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft YaHei", sans-serif; }\n\t:host-context(.windows:lang(zh-Hant)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft Jhenghei", sans-serif; }\n\t:host-context(.windows:lang(ja)) { font-family: "Segoe WPC", "Segoe UI", "Yu Gothic UI", "Meiryo UI", sans-serif; }\n\t:host-context(.windows:lang(ko)) { font-family: "Segoe WPC", "Segoe UI", "Malgun Gothic", "Dotom", sans-serif; }\n\n\t:host-context(.linux) { font-family: system-ui, "Ubuntu", "Droid Sans", sans-serif; }\n\t:host-context(.linux:lang(zh-Hans)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans SC", "Source Han Sans CN", "Source Han Sans", sans-serif; }\n\t:host-context(.linux:lang(zh-Hant)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans TC", "Source Han Sans TW", "Source Han Sans", sans-serif; }\n\t:host-context(.linux:lang(ja)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans J", "Source Han Sans JP", "Source Han Sans", sans-serif; }\n\t:host-context(.linux:lang(ko)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans K", "Source Han Sans JR", "Source Han Sans", "UnDotum", "FBaekmuk Gulim", sans-serif; }\n`;var AP=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},MP=function(t,i){return function(e,s){i(e,s,t)}};let LP=class extends Qi{constructor(t){super(),this.layoutService=t,this.currentViewDisposable=this._register(new Yi),this.contextView=this._register(new DP(this.layoutService.mainContainer,1)),this.layout(),this._register(t.onDidLayoutContainer((()=>this.layout())))}showContextView(t,i,e){let s;s=i?i===this.layoutService.getContainer(Uh(i))?1:e?3:2:1,this.contextView.setContainer(i??this.layoutService.activeContainer,s),this.contextView.show(t);const n=Zi((()=>{this.currentViewDisposable===n&&this.hideContextView()}));return this.currentViewDisposable.value=n,n}layout(){this.contextView.layout()}hideContextView(t){this.contextView.hide(t)}};LP=AP([MP(0,BR)],LP);class FP extends LP{getContextViewElement(){return this.contextView.getViewElement()}}var TP=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},RP=function(t,i){return function(e,s){i(e,s,t)}};let OP=class extends Qi{constructor(t,i,e,s,n){super(),this._instantiationService=t,this._keybindingService=e,this._layoutService=s,this._accessibilityService=n,i.onDidShowContextMenu((()=>this.hideHover())),this._contextViewHandler=this._register(new LP(this._layoutService))}showHover(t,i,e){var s,n,r,o;if(IP(this._currentHoverOptions)===IP(t)||this._currentHover&&(!((n=(s=this._currentHoverOptions)===null||s===void 0?void 0:s.persistence)===null||n===void 0)&&n.sticky))return;this._currentHoverOptions=t,this._lastHoverOptions=t;const h=t.trapFocus||this._accessibilityService.isScreenReaderOptimized(),c=Lc();e||(this._lastFocusedElementBeforeOpen=h&&c?c:void 0);const l=new Ji,a=this._instantiationService.createInstance(bP,t);if(!((r=t.persistence)===null||r===void 0)&&r.sticky&&(a.isLocked=!0),a.onDispose((()=>{var i,e;!((i=this._currentHover)===null||i===void 0)&&i.domNode&&Tc(this._currentHover.domNode)&&((e=this._lastFocusedElementBeforeOpen)===null||e===void 0||e.focus()),this._currentHoverOptions===t&&(this._currentHoverOptions=void 0),l.dispose()})),!t.container){const i=t.target instanceof HTMLElement?t.target:t.target.targetElements[0];t.container=this._layoutService.getContainer(Uh(i))}if(this._contextViewHandler.showContextView(new _P(a,i),t.container),a.onRequestLayout((()=>this._contextViewHandler.layout())),(o=t.persistence)===null||o===void 0?void 0:o.sticky)l.add(sc(Uh(t.container).document,qc.MOUSE_DOWN,(t=>{xc(t.target,a.domNode)||this.doHideHover()})));else{if("targetElements"in t.target)for(const i of t.target.targetElements)l.add(sc(i,qc.CLICK,(()=>this.hideHover())));else l.add(sc(t.target,qc.CLICK,(()=>this.hideHover())));const i=Lc();if(i){const e=Uh(i).document;l.add(sc(i,qc.KEY_DOWN,(i=>{var e;return this._keyDown(i,a,!!(!((e=t.persistence)===null||e===void 0)&&e.hideOnKeyDown))}))),l.add(sc(e,qc.KEY_DOWN,(i=>{var e;return this._keyDown(i,a,!!(!((e=t.persistence)===null||e===void 0)&&e.hideOnKeyDown))}))),l.add(sc(i,qc.KEY_UP,(t=>this._keyUp(t,a)))),l.add(sc(e,qc.KEY_UP,(t=>this._keyUp(t,a))))}}if("IntersectionObserver"in Wn){const i=new IntersectionObserver((t=>this._intersectionChange(t,a)),{threshold:0}),e="targetElements"in t.target?t.target.targetElements[0]:t.target;i.observe(e),l.add(Zi((()=>i.disconnect())))}return this._currentHover=a,a}hideHover(){var t;!(!((t=this._currentHover)===null||t===void 0)&&t.isLocked)&&this._currentHoverOptions&&this.doHideHover()}doHideHover(){this._currentHover=void 0,this._currentHoverOptions=void 0,this._contextViewHandler.hideContextView()}_intersectionChange(t,i){t[t.length-1].isIntersecting||i.dispose()}_keyDown(t,i,e){var s,n;if(t.key==="Alt")return void(i.isLocked=!0);const r=new so(t);this._keybindingService.resolveKeyboardEvent(r).getSingleModifierDispatchChords().some((t=>!!t))||this._keybindingService.softDispatch(r,r.target).kind!==0||!e||!((s=this._currentHoverOptions)===null||s===void 0)&&s.trapFocus&&t.key==="Tab"||(this.hideHover(),(n=this._lastFocusedElementBeforeOpen)===null||n===void 0||n.focus())}_keyUp(t,i){var e;t.key==="Alt"&&(i.isLocked=!1,i.isMouseIn||(this.hideHover(),(e=this._lastFocusedElementBeforeOpen)===null||e===void 0||e.focus()))}};function IP(t){var i;if(t!==void 0)return(i=t==null?void 0:t.id)!==null&&i!==void 0?i:t}OP=TP([RP(0,Il),RP(1,oI),RP(2,NS),RP(3,BR),RP(4,vw)],OP);class _P{get anchorPosition(){return this._hover.anchor}constructor(t,i=!1){this._hover=t,this._focus=i,this.layer=1}render(t){return this._hover.render(t),this._focus&&this._hover.focus(),this._hover}getAnchor(){return{x:this._hover.x,y:this._hover.y}}layout(){this._hover.layout()}}Nd(sI,OP,1),RC(((t,i)=>{const e=t.getColor(Dv);e&&(i.addRule(`.monaco-workbench .workbench-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${e.transparent(.5)}; }`),i.addRule(`.monaco-workbench .workbench-hover hr { border-top: 1px solid ${e.transparent(.5)}; }`))}));const PP=_l("IWorkspaceEditService");class NP{constructor(t){this.metadata=t}static convert(t){return t.edits.map((t=>{if(BP.is(t))return BP.lift(t);if($P.is(t))return $P.lift(t);throw new Error("Unsupported edit")}))}}class BP extends NP{static is(t){return t instanceof BP||O(t)&&as.isUri(t.resource)&&O(t.textEdit)}static lift(t){return t instanceof BP?t:new BP(t.resource,t.textEdit,t.versionId,t.metadata)}constructor(t,i,e=void 0,s){super(s),this.resource=t,this.textEdit=i,this.versionId=e}}class $P extends NP{static is(t){return t instanceof $P||O(t)&&(!!t.newResource||!!t.oldResource)}static lift(t){return t instanceof $P?t:new $P(t.oldResource,t.newResource,t.options,t.metadata)}constructor(t,i,e={},s){super(s),this.oldResource=t,this.newResource=i,this.options=e}}const WP={enableSplitViewResizing:!0,splitViewDefaultRatio:.5,renderSideBySide:!0,renderMarginRevertIcon:!0,renderGutterMenu:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1,experimental:{showMoves:!1,showEmptyDecorations:!0},hideUnchangedRegions:{enabled:!1,contextLineCount:3,minimumLineCount:3,revealLineCount:20},isInEmbeddedEditor:!1,onlyShowAccessibleDiffViewer:!1,renderSideBySideInlineBreakpoint:900,useInlineViewWhenSpaceIsLimited:!0},jP=Object.freeze({id:"editor",order:5,type:"object",title:tt(0,"Editor"),scope:5}),HP={...jP,properties:{"editor.tabSize":{type:"number",default:$t.tabSize,minimum:1,markdownDescription:tt(0,"The number of spaces a tab is equal to. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.indentSize":{anyOf:[{type:"string",enum:["tabSize"]},{type:"number",minimum:1}],default:"tabSize",markdownDescription:tt(0,'The number of spaces used for indentation or `"tabSize"` to use the value from `#editor.tabSize#`. This setting is overridden based on the file contents when `#editor.detectIndentation#` is on.')},"editor.insertSpaces":{type:"boolean",default:$t.insertSpaces,markdownDescription:tt(0,"Insert spaces when pressing `Tab`. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.detectIndentation":{type:"boolean",default:$t.detectIndentation,markdownDescription:tt(0,"Controls whether {0} and {1} will be automatically detected when a file is opened based on the file contents.","`#editor.tabSize#`","`#editor.insertSpaces#`")},"editor.trimAutoWhitespace":{type:"boolean",default:$t.trimAutoWhitespace,description:tt(0,"Remove trailing auto inserted whitespace.")},"editor.largeFileOptimizations":{type:"boolean",default:$t.largeFileOptimizations,description:tt(0,"Special handling for large files to disable certain memory intensive features.")},"editor.wordBasedSuggestions":{enum:["off","currentDocument","matchingDocuments","allDocuments"],default:"matchingDocuments",enumDescriptions:[tt(0,"Turn off Word Based Suggestions."),tt(0,"Only suggest words from the active document."),tt(0,"Suggest words from all open documents of the same language."),tt(0,"Suggest words from all open documents.")],description:tt(0,"Controls whether completions should be computed based on words in the document and from which documents they are computed.")},"editor.semanticHighlighting.enabled":{enum:[!0,!1,"configuredByTheme"],enumDescriptions:[tt(0,"Semantic highlighting enabled for all color themes."),tt(0,"Semantic highlighting disabled for all color themes."),tt(0,"Semantic highlighting is configured by the current color theme's `semanticHighlighting` setting.")],default:"configuredByTheme",description:tt(0,"Controls whether the semanticHighlighting is shown for the languages that support it.")},"editor.stablePeek":{type:"boolean",default:!1,markdownDescription:tt(0,"Keep peek editors open even when double-clicking their content or when hitting `Escape`.")},"editor.maxTokenizationLineLength":{type:"integer",default:2e4,description:tt(0,"Lines above this length will not be tokenized for performance reasons")},"editor.experimental.asyncTokenization":{type:"boolean",default:!1,description:tt(0,"Controls whether the tokenization should happen asynchronously on a web worker."),tags:["experimental"]},"editor.experimental.asyncTokenizationLogging":{type:"boolean",default:!1,description:tt(0,"Controls whether async tokenization should be logged. For debugging only.")},"editor.experimental.asyncTokenizationVerification":{type:"boolean",default:!1,description:tt(0,"Controls whether async tokenization should be verified against legacy background tokenization. Might slow down tokenization. For debugging only."),tags:["experimental"]},"editor.language.brackets":{type:["array","null"],default:null,description:tt(0,"Defines the bracket symbols that increase or decrease the indentation."),items:{type:"array",items:[{type:"string",description:tt(0,"The opening bracket character or string sequence.")},{type:"string",description:tt(0,"The closing bracket character or string sequence.")}]}},"editor.language.colorizedBracketPairs":{type:["array","null"],default:null,description:tt(0,"Defines the bracket pairs that are colorized by their nesting level if bracket pair colorization is enabled."),items:{type:"array",items:[{type:"string",description:tt(0,"The opening bracket character or string sequence.")},{type:"string",description:tt(0,"The closing bracket character or string sequence.")}]}},"diffEditor.maxComputationTime":{type:"number",default:WP.maxComputationTime,description:tt(0,"Timeout in milliseconds after which diff computation is cancelled. Use 0 for no timeout.")},"diffEditor.maxFileSize":{type:"number",default:WP.maxFileSize,description:tt(0,"Maximum file size in MB for which to compute diffs. Use 0 for no limit.")},"diffEditor.renderSideBySide":{type:"boolean",default:WP.renderSideBySide,description:tt(0,"Controls whether the diff editor shows the diff side by side or inline.")},"diffEditor.renderSideBySideInlineBreakpoint":{type:"number",default:WP.renderSideBySideInlineBreakpoint,description:tt(0,"If the diff editor width is smaller than this value, the inline view is used.")},"diffEditor.useInlineViewWhenSpaceIsLimited":{type:"boolean",default:WP.useInlineViewWhenSpaceIsLimited,description:tt(0,"If enabled and the editor width is too small, the inline view is used.")},"diffEditor.renderMarginRevertIcon":{type:"boolean",default:WP.renderMarginRevertIcon,description:tt(0,"When enabled, the diff editor shows arrows in its glyph margin to revert changes.")},"diffEditor.renderGutterMenu":{type:"boolean",default:WP.renderGutterMenu,description:tt(0,"When enabled, the diff editor shows a special gutter for revert and stage actions.")},"diffEditor.ignoreTrimWhitespace":{type:"boolean",default:WP.ignoreTrimWhitespace,description:tt(0,"When enabled, the diff editor ignores changes in leading or trailing whitespace.")},"diffEditor.renderIndicators":{type:"boolean",default:WP.renderIndicators,description:tt(0,"Controls whether the diff editor shows +/- indicators for added/removed changes.")},"diffEditor.codeLens":{type:"boolean",default:WP.diffCodeLens,description:tt(0,"Controls whether the editor shows CodeLens.")},"diffEditor.wordWrap":{type:"string",enum:["off","on","inherit"],default:WP.diffWordWrap,markdownEnumDescriptions:[tt(0,"Lines will never wrap."),tt(0,"Lines will wrap at the viewport width."),tt(0,"Lines will wrap according to the {0} setting.","`#editor.wordWrap#`")]},"diffEditor.diffAlgorithm":{type:"string",enum:["legacy","advanced"],default:WP.diffAlgorithm,markdownEnumDescriptions:[tt(0,"Uses the legacy diffing algorithm."),tt(0,"Uses the advanced diffing algorithm.")],tags:["experimental"]},"diffEditor.hideUnchangedRegions.enabled":{type:"boolean",default:WP.hideUnchangedRegions.enabled,markdownDescription:tt(0,"Controls whether the diff editor shows unchanged regions.")},"diffEditor.hideUnchangedRegions.revealLineCount":{type:"integer",default:WP.hideUnchangedRegions.revealLineCount,markdownDescription:tt(0,"Controls how many lines are used for unchanged regions."),minimum:1},"diffEditor.hideUnchangedRegions.minimumLineCount":{type:"integer",default:WP.hideUnchangedRegions.minimumLineCount,markdownDescription:tt(0,"Controls how many lines are used as a minimum for unchanged regions."),minimum:1},"diffEditor.hideUnchangedRegions.contextLineCount":{type:"integer",default:WP.hideUnchangedRegions.contextLineCount,markdownDescription:tt(0,"Controls how many lines are used as context when comparing unchanged regions."),minimum:1},"diffEditor.experimental.showMoves":{type:"boolean",default:WP.experimental.showMoves,markdownDescription:tt(0,"Controls whether the diff editor should show detected code moves.")},"diffEditor.experimental.showEmptyDecorations":{type:"boolean",default:WP.experimental.showEmptyDecorations,description:tt(0,"Controls whether the diff editor shows empty decorations to see where characters got inserted or deleted.")}}};for(const t of Fi){const i=t.schema;if(i!==void 0)if((VP=i).type!==void 0||VP.anyOf!==void 0)HP.properties[`editor.${t.name}`]=i;else for(const t in i)Object.hasOwnProperty.call(i,t)&&(HP.properties[t]=i[t])}var VP;let zP=null;function UP(){return zP===null&&(zP=Object.create(null),Object.keys(HP.properties).forEach((t=>{zP[t]=!0}))),zP}Va.as(Hd).registerConfiguration(HP);class KP{static insert(t,i){return{range:new Cs(t.lineNumber,t.column,t.lineNumber,t.column),text:i,forceMoveMarkers:!0}}static delete(t){return{range:t,text:null}}static replace(t,i){return{range:t,text:i}}static replaceMove(t,i){return{range:t,text:i,forceMoveMarkers:!0}}}function qP(t){return Object.isFrozen(t)?t:function(t){if(!t||typeof t!="object")return t;const i=[t];for(;i.length>0;){const t=i.shift();Object.freeze(t);for(const e in t)if(K.call(t,e)){const s=t[e];typeof s!="object"||Object.isFrozen(s)||I(s)||i.push(s)}}return t}(t)}class GP{constructor(t={},i=[],e=[],s){this._contents=t,this._keys=i,this._overrides=e,this.raw=s,this.overrideConfigurations=new Map}get rawConfiguration(){var t;if(!this._rawConfiguration)if(!((t=this.raw)===null||t===void 0)&&t.length){const t=this.raw.map((t=>{if(t instanceof GP)return t;const i=new ZP("");return i.parseRaw(t),i.configurationModel}));this._rawConfiguration=t.reduce(((t,i)=>i===t?i:t.merge(i)),t[0])}else this._rawConfiguration=this;return this._rawConfiguration}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(t){return t?Od(this.contents,t):this.contents}inspect(t,i){const e=this;return{get value(){return qP(e.rawConfiguration.getValue(t))},get override(){return i?qP(e.rawConfiguration.getOverrideValue(t,i)):void 0},get merged(){return qP(i?e.rawConfiguration.override(i).getValue(t):e.rawConfiguration.getValue(t))},get overrides(){const i=[];for(const{contents:s,identifiers:n,keys:r}of e.rawConfiguration.overrides){const e=new GP(s,r).getValue(t);e!==void 0&&i.push({identifiers:n,value:e})}return i.length?qP(i):void 0}}}getOverrideValue(t,i){const e=this.getContentsForOverrideIdentifer(i);return e?t?Od(e,t):e:void 0}override(t){let i=this.overrideConfigurations.get(t);return i||(i=this.createOverrideConfigurationModel(t),this.overrideConfigurations.set(t,i)),i}merge(...t){var i,e;const s=U(this.contents),r=U(this.overrides),o=[...this.keys],h=!((i=this.raw)===null||i===void 0)&&i.length?[...this.raw]:[this];for(const i of t)if(h.push(...!((e=i.raw)===null||e===void 0)&&e.length?i.raw:[i]),!i.isEmpty()){this.mergeContents(s,i.contents);for(const t of i.overrides){const[i]=r.filter((i=>n(i.identifiers,t.identifiers)));i?(this.mergeContents(i.contents,t.contents),i.keys.push(...t.keys),i.keys=g(i.keys)):r.push(U(t))}for(const t of i.keys)o.indexOf(t)===-1&&o.push(t)}return new GP(s,o,r,h.every((t=>t instanceof GP))?void 0:h)}createOverrideConfigurationModel(t){const i=this.getContentsForOverrideIdentifer(t);if(!i||typeof i!="object"||!Object.keys(i).length)return this;const e={};for(const t of g([...Object.keys(this.contents),...Object.keys(i)])){let s=this.contents[t];const n=i[t];n&&(typeof s=="object"&&typeof n=="object"?(s=U(s),this.mergeContents(s,n)):s=n),e[t]=s}return new GP(e,this.keys,this.overrides)}mergeContents(t,i){for(const e of Object.keys(i))e in t&&O(t[e])&&O(i[e])?this.mergeContents(t[e],i[e]):t[e]=U(i[e])}getContentsForOverrideIdentifer(t){let i=null,e=null;const s=t=>{t&&(e?this.mergeContents(e,t):e=U(t))};for(const e of this.overrides)e.identifiers.length===1&&e.identifiers[0]===t?i=e.contents:e.identifiers.includes(t)&&s(e.contents);return s(i),e}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}addValue(t,i){this.updateValue(t,i,!0)}setValue(t,i){this.updateValue(t,i,!1)}removeValue(t){const i=this.keys.indexOf(t);i!==-1&&(this.keys.splice(i,1),Td(this.contents,t),qd.test(t)&&this.overrides.splice(this.overrides.findIndex((i=>n(i.identifiers,Gd(t)))),1))}updateValue(t,i,e){Fd(this.contents,t,i,(t=>console.error(t))),(e=e||this.keys.indexOf(t)===-1)&&this.keys.push(t),qd.test(t)&&this.overrides.push({identifiers:Gd(t),keys:Object.keys(this.contents[t]),contents:Ld(this.contents[t],(t=>console.error(t)))})}}class ZP{constructor(t){this._name=t,this._raw=null,this._configurationModel=null,this._restrictedConfigurations=[]}get configurationModel(){return this._configurationModel||new GP}parseRaw(t,i){this._raw=t;const{contents:e,keys:s,overrides:n,restricted:r,hasExcludedProperties:o}=this.doParseRaw(t,i);this._configurationModel=new GP(e,s,n,o?[t]:void 0),this._restrictedConfigurations=r||[]}doParseRaw(t,i){const e=Va.as(Hd).getConfigurationProperties(),s=this.filter(t,e,!0,i);return{contents:Ld(t=s.raw,(t=>console.error(`Conflict in settings file ${this._name}: ${t}`))),keys:Object.keys(t),overrides:this.toOverrides(t,(t=>console.error(`Conflict in settings file ${this._name}: ${t}`))),restricted:s.restricted,hasExcludedProperties:s.hasExcludedProperties}}filter(t,i,e,s){var n,r,o;let h=!1;if(!(s!=null&&s.scopes)&&!(s!=null&&s.skipRestricted)&&!(!((n=s==null?void 0:s.exclude)===null||n===void 0)&&n.length))return{raw:t,restricted:[],hasExcludedProperties:h};const c={},l=[];for(const n in t)if(qd.test(n)&&e){const e=this.filter(t[n],i,!1,s);c[n]=e.raw,h=h||e.hasExcludedProperties,l.push(...e.restricted)}else{const e=i[n],a=e?e.scope!==void 0?e.scope:3:void 0;e!=null&&e.restricted&&l.push(n),!((r=s.exclude)===null||r===void 0)&&r.includes(n)||!(!((o=s.include)===null||o===void 0)&&o.includes(n))&&(a!==void 0&&s.scopes!==void 0&&!s.scopes.includes(a)||s.skipRestricted&&(e!=null&&e.restricted))?h=!0:c[n]=t[n]}return{raw:c,restricted:l,hasExcludedProperties:h}}toOverrides(t,i){const e=[];for(const s of Object.keys(t))if(qd.test(s)){const n={};for(const i in t[s])n[i]=t[s][i];e.push({identifiers:Gd(s),keys:Object.keys(n),contents:Ld(n,i)})}return e}}class JP{constructor(t,i,e,s,n,r,o,h,c,l,a,u,d){this.key=t,this.overrides=i,this._value=e,this.overrideIdentifiers=s,this.defaultConfiguration=n,this.policyConfiguration=r,this.applicationConfiguration=o,this.userConfiguration=h,this.localUserConfiguration=c,this.remoteUserConfiguration=l,this.workspaceConfiguration=a,this.folderConfigurationModel=u,this.memoryConfigurationModel=d}toInspectValue(t){return(t==null?void 0:t.value)!==void 0||(t==null?void 0:t.override)!==void 0||(t==null?void 0:t.overrides)!==void 0?t:void 0}get userInspectValue(){return this._userInspectValue||(this._userInspectValue=this.userConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userInspectValue}get user(){return this.toInspectValue(this.userInspectValue)}}class QP{constructor(t,i,e,s,n=new GP,r=new GP,o=new zf,h=new GP,c=new zf){this._defaultConfiguration=t,this._policyConfiguration=i,this._applicationConfiguration=e,this._localUserConfiguration=s,this._remoteUserConfiguration=n,this._workspaceConfiguration=r,this._folderConfigurations=o,this._memoryConfiguration=h,this._memoryConfigurationByResource=c,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new zf,this._userConfiguration=null}getValue(t,i,e){return this.getConsolidatedConfigurationModel(t,i,e).getValue(t)}updateValue(t,i,e={}){let s;e.resource?(s=this._memoryConfigurationByResource.get(e.resource),s||(s=new GP,this._memoryConfigurationByResource.set(e.resource,s))):s=this._memoryConfiguration,i===void 0?s.removeValue(t):s.setValue(t,i),e.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(t,i,e){const s=this.getConsolidatedConfigurationModel(t,i,e),n=this.getFolderConfigurationModelForResource(i.resource,e),r=i.resource&&this._memoryConfigurationByResource.get(i.resource)||this._memoryConfiguration,o=new Set;for(const i of s.overrides)for(const e of i.identifiers)s.getOverrideValue(t,e)!==void 0&&o.add(e);return new JP(t,i,s.getValue(t),o.size?[...o]:void 0,this._defaultConfiguration,this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,e?this._workspaceConfiguration:void 0,n||void 0,r)}get applicationConfiguration(){return this._applicationConfiguration}get userConfiguration(){return this._userConfiguration||(this._userConfiguration=this._remoteUserConfiguration.isEmpty()?this._localUserConfiguration:this._localUserConfiguration.merge(this._remoteUserConfiguration)),this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}getConsolidatedConfigurationModel(t,i,e){let s=this.getConsolidatedConfigurationModelForResource(i,e);return i.overrideIdentifier&&(s=s.override(i.overrideIdentifier)),this._policyConfiguration.isEmpty()||this._policyConfiguration.getValue(t)===void 0||(s=s.merge(this._policyConfiguration)),s}getConsolidatedConfigurationModelForResource({resource:t},i){let e=this.getWorkspaceConsolidatedConfiguration();if(i&&t){const s=i.getFolder(t);s&&(e=this.getFolderConsolidatedConfiguration(s.uri)||e);const n=this._memoryConfigurationByResource.get(t);n&&(e=e.merge(n))}return e}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration)),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(t){let i=this._foldersConsolidatedConfigurations.get(t);if(!i){const e=this.getWorkspaceConsolidatedConfiguration(),s=this._folderConfigurations.get(t);s?(i=e.merge(s),this._foldersConsolidatedConfigurations.set(t,i)):i=e}return i}getFolderConfigurationModelForResource(t,i){if(i&&t){const e=i.getFolder(t);if(e)return this._folderConfigurations.get(e.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys},user:{contents:this.userConfiguration.contents,overrides:this.userConfiguration.overrides,keys:this.userConfiguration.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce(((t,i)=>{const{contents:e,overrides:s,keys:n}=this._folderConfigurations.get(i);return t.push([i,{contents:e,overrides:s,keys:n}]),t}),[])}}static parse(t){const i=this.parseConfigurationModel(t.defaults),e=this.parseConfigurationModel(t.policy),s=this.parseConfigurationModel(t.application),n=this.parseConfigurationModel(t.user),r=this.parseConfigurationModel(t.workspace),o=t.folders.reduce(((t,i)=>(t.set(as.revive(i[0]),this.parseConfigurationModel(i[1])),t)),new zf);return new QP(i,e,s,n,new GP,r,o,new GP,new zf)}static parseConfigurationModel(t){return new GP(t.contents,t.keys,t.overrides)}}class YP{constructor(t,i,e,s){this.change=t,this.previous=i,this.currentConfiguraiton=e,this.currentWorkspace=s,this._marker=`\n`,this._markerCode1=this._marker.charCodeAt(0),this._markerCode2=46,this.affectedKeys=new Set,this._previousConfiguration=void 0;for(const i of t.keys)this.affectedKeys.add(i);for(const[,i]of t.overrides)for(const t of i)this.affectedKeys.add(t);this._affectsConfigStr=this._marker;for(const t of this.affectedKeys)this._affectsConfigStr+=t+this._marker}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=QP.parse(this.previous.data)),this._previousConfiguration}affectsConfiguration(t,i){var e;const s=this._marker+t,n=this._affectsConfigStr.indexOf(s);if(n<0)return!1;const r=n+s.length;if(r>=this._affectsConfigStr.length)return!1;const o=this._affectsConfigStr.charCodeAt(r);return o!==this._markerCode1&&o!==this._markerCode2?!1:i?!J(this.previousConfiguration?this.previousConfiguration.getValue(t,i,(e=this.previous)===null||e===void 0?void 0:e.workspace):void 0,this.currentConfiguraiton.getValue(t,i,this.currentWorkspace)):!0}}const XP={kind:0},tN={kind:1};class iN{constructor(t,i,e){var s;this._log=e,this._defaultKeybindings=t,this._defaultBoundCommands=new Map;for(const i of t){const t=i.command;t&&t.charAt(0)!=="-"&&this._defaultBoundCommands.set(t,!0)}this._map=new Map,this._lookupMap=new Map,this._keybindings=iN.handleRemovals([].concat(t).concat(i));for(let t=0,i=this._keybindings.length;t<i;t++){const i=this._keybindings[t];if(i.chords.length===0)continue;const e=(s=i.when)===null||s===void 0?void 0:s.substituteConstants();e&&e.type===0||this._addKeyPress(i.chords[0],i)}}static _isTargetedForRemoval(t,i,e){if(i){for(let e=0;e<i.length;e++)if(i[e]!==t.chords[e])return!1}return!(e&&e.type!==1&&(!t.when||!function(t,i){const e=t?t.substituteConstants():void 0,s=i?i.substituteConstants():void 0;return!e&&!s||!(!e||!s)&&e.equals(s)}(e,t.when)))}static handleRemovals(t){const i=new Map;for(let e=0,s=t.length;e<s;e++){const s=t[e];if(s.command&&s.command.charAt(0)==="-"){const t=s.command.substring(1);i.has(t)?i.get(t).push(s):i.set(t,[s])}}if(i.size===0)return t;const e=[];for(let s=0,n=t.length;s<n;s++){const n=t[s];if(!n.command||n.command.length===0){e.push(n);continue}if(n.command.charAt(0)==="-")continue;const r=i.get(n.command);if(!r||!n.isDefault){e.push(n);continue}let o=!1;for(const t of r){const i=t.when;if(this._isTargetedForRemoval(n,t.chords,i)){o=!0;break}}o||e.push(n)}return e}_addKeyPress(t,i){const e=this._map.get(t);if(e===void 0)return this._map.set(t,[i]),void this._addToLookupMap(i);for(let t=e.length-1;t>=0;t--){const s=e[t];if(s.command===i.command)continue;let n=!0;for(let t=1;t<s.chords.length&&t<i.chords.length;t++)if(s.chords[t]!==i.chords[t]){n=!1;break}n&&iN.whenIsEntirelyIncluded(s.when,i.when)&&this._removeFromLookupMap(s)}e.push(i),this._addToLookupMap(i)}_addToLookupMap(t){if(!t.command)return;let i=this._lookupMap.get(t.command);i===void 0?(i=[t],this._lookupMap.set(t.command,i)):i.push(t)}_removeFromLookupMap(t){if(!t.command)return;const i=this._lookupMap.get(t.command);if(i!==void 0){for(let e=0,s=i.length;e<s;e++)if(i[e]===t)return void i.splice(e,1)}}static whenIsEntirelyIncluded(t,i){return!i||i.type===1||!(!t||t.type===1)&&_a(t,i)}getKeybindings(){return this._keybindings}lookupPrimaryKeybinding(t,i){const e=this._lookupMap.get(t);if(e===void 0||e.length===0)return null;if(e.length===1)return e[0];for(let t=e.length-1;t>=0;t--){const s=e[t];if(i.contextMatchesRules(s.when))return s}return e[e.length-1]}resolve(t,i,e){const s=[...i,e];this._log(`| Resolving ${s}`);const n=this._map.get(s[0]);if(n===void 0)return this._log("\\ No keybinding entries."),XP;let r=null;if(s.length<2)r=n;else{r=[];for(let t=0,i=n.length;t<i;t++){const i=n[t];if(s.length>i.chords.length)continue;let e=!0;for(let t=1;t<s.length;t++)if(i.chords[t]!==s[t]){e=!1;break}e&&r.push(i)}}const o=this._findCommand(t,r);return o?s.length<o.chords.length?(this._log(`\\ From ${r.length} keybinding entries, awaiting ${o.chords.length-s.length} more chord(s), when: ${eN(o.when)}, source: ${sN(o)}.`),tN):(this._log(`\\ From ${r.length} keybinding entries, matched ${o.command}, when: ${eN(o.when)}, source: ${sN(o)}.`),h=o.command,c=o.commandArgs,l=o.bubble,{kind:2,commandId:h,commandArgs:c,isBubble:l}):(this._log(`\\ From ${r.length} keybinding entries, no when clauses matched the context.`),XP);var h,c,l}_findCommand(t,i){for(let e=i.length-1;e>=0;e--){const s=i[e];if(iN._contextMatchesRules(t,s.when))return s}return null}static _contextMatchesRules(t,i){return!i||i.evaluate(t)}}function eN(t){return t?`${t.serialize()}`:"no when condition"}function sN(t){return t.extensionId?t.isBuiltinExtension?`built-in extension ${t.extensionId}`:`user extension ${t.extensionId}`:t.isDefault?"built-in":"user"}const nN=/^(cursor|delete|undo|redo|tab|editor\.action\.clipboard)/;class rN extends Qi{get onDidUpdateKeybindings(){return this._onDidUpdateKeybindings?this._onDidUpdateKeybindings.event:ne.None}get inChordMode(){return this._currentChords.length>0}constructor(t,i,e,s,n){super(),this._contextKeyService=t,this._commandService=i,this._telemetryService=e,this._notificationService=s,this._logService=n,this._onDidUpdateKeybindings=this._register(new le),this._currentChords=[],this._currentChordChecker=new ko,this._currentChordStatusMessage=null,this._ignoreSingleModifiers=oN.EMPTY,this._currentSingleModifier=null,this._currentSingleModifierClearTimeout=new yo,this._currentlyDispatchingCommandId=null,this._logging=!1}dispose(){super.dispose()}_log(t){this._logging&&this._logService.info(`[KeybindingService]: ${t}`)}getKeybindings(){return this._getResolver().getKeybindings()}lookupKeybinding(t,i){const e=this._getResolver().lookupPrimaryKeybinding(t,i||this._contextKeyService);if(e)return e.resolvedKeybinding}dispatchEvent(t,i){return this._dispatch(t,i)}softDispatch(t,i){this._log("/ Soft dispatching keyboard event");const e=this.resolveKeyboardEvent(t);if(e.hasMultipleChords())return console.warn("keyboard event should not be mapped to multiple chords"),XP;const[s]=e.getDispatchChords();if(s===null)return this._log("\\ Keyboard event cannot be dispatched"),XP;const n=this._contextKeyService.getContext(i),r=this._currentChords.map((({keypress:t})=>t));return this._getResolver().resolve(n,r,s)}_scheduleLeaveChordMode(){const t=Date.now();this._currentChordChecker.cancelAndSet((()=>{this._documentHasFocus()?Date.now()-t>5e3&&this._leaveChordMode():this._leaveChordMode()}),500)}_expectAnotherChord(t,i){switch(this._currentChords.push({keypress:t,label:i}),this._currentChords.length){case 0:throw ji("impossible");case 1:this._currentChordStatusMessage=this._notificationService.status(tt(0,"({0}) was pressed. Waiting for second key of chord...",i));break;default:{const t=this._currentChords.map((({label:t})=>t)).join(", ");this._currentChordStatusMessage=this._notificationService.status(tt(0,"({0}) was pressed. Waiting for next key of chord...",t))}}this._scheduleLeaveChordMode(),PS.enabled&&PS.disable()}_leaveChordMode(){this._currentChordStatusMessage&&(this._currentChordStatusMessage.dispose(),this._currentChordStatusMessage=null),this._currentChordChecker.cancel(),this._currentChords=[],PS.enable()}_dispatch(t,i){return this._doDispatch(this.resolveKeyboardEvent(t),i,!1)}_singleModifierDispatch(t,i){const e=this.resolveKeyboardEvent(t),[s]=e.getSingleModifierDispatchChords();if(s)return this._ignoreSingleModifiers.has(s)?(this._log(`+ Ignoring single modifier ${s} due to it being pressed together with other keys.`),this._ignoreSingleModifiers=oN.EMPTY,this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1):(this._ignoreSingleModifiers=oN.EMPTY,this._currentSingleModifier===null?(this._log(`+ Storing single modifier for possible chord ${s}.`),this._currentSingleModifier=s,this._currentSingleModifierClearTimeout.cancelAndSet((()=>{this._log("+ Clearing single modifier due to 300ms elapsed."),this._currentSingleModifier=null}),300),!1):s===this._currentSingleModifier?(this._log(`/ Dispatching single modifier chord ${s} ${s}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,this._doDispatch(e,i,!0)):(this._log(`+ Clearing single modifier due to modifier mismatch: ${this._currentSingleModifier} ${s}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1));const[n]=e.getChords();return this._ignoreSingleModifiers=new oN(n),this._currentSingleModifier!==null&&this._log("+ Clearing single modifier due to other key up."),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1}_doDispatch(t,i,e=!1){var s;let n=!1;if(t.hasMultipleChords())return console.warn("Unexpected keyboard event mapped to multiple chords"),!1;let r=null,o=null;if(e){const[i]=t.getSingleModifierDispatchChords();r=i,o=i?[i]:[]}else[r]=t.getDispatchChords(),o=this._currentChords.map((({keypress:t})=>t));if(r===null)return this._log("\\ Keyboard event cannot be dispatched in keydown phase."),n;const h=this._contextKeyService.getContext(i),c=t.getLabel(),l=this._getResolver().resolve(h,o,r);switch(l.kind){case 0:if(this._logService.trace("KeybindingService#dispatch",c,"[ No matching keybinding ]"),this.inChordMode){const t=this._currentChords.map((({label:t})=>t)).join(", ");this._log(`+ Leaving multi-chord mode: Nothing bound to "${t}, ${c}".`),this._notificationService.status(tt(0,"The key combination ({0}, {1}) is not a command.",t,c),{hideAfter:1e4}),this._leaveChordMode(),n=!0}return n;case 1:return this._logService.trace("KeybindingService#dispatch",c,"[ Several keybindings match - more chords needed ]"),n=!0,this._expectAnotherChord(r,c),this._log(this._currentChords.length===1?"+ Entering multi-chord mode...":"+ Continuing multi-chord mode..."),n;case 2:if(this._logService.trace("KeybindingService#dispatch",c,`[ Will dispatch command ${l.commandId} ]`),l.commandId===null||l.commandId===""){if(this.inChordMode){const t=this._currentChords.map((({label:t})=>t)).join(", ");this._log(`+ Leaving chord mode: Nothing bound to "${t}, ${c}".`),this._notificationService.status(tt(0,"The key combination ({0}, {1}) is not a command.",t,c),{hideAfter:1e4}),this._leaveChordMode(),n=!0}}else{this.inChordMode&&this._leaveChordMode(),l.isBubble||(n=!0),this._log(`+ Invoking command ${l.commandId}.`),this._currentlyDispatchingCommandId=l.commandId;try{l.commandArgs===void 0?this._commandService.executeCommand(l.commandId).then(void 0,(t=>this._notificationService.warn(t))):this._commandService.executeCommand(l.commandId,l.commandArgs).then(void 0,(t=>this._notificationService.warn(t)))}finally{this._currentlyDispatchingCommandId=null}nN.test(l.commandId)||this._telemetryService.publicLog2("workbenchActionExecuted",{id:l.commandId,from:"keybinding",detail:(s=t.getUserSettingsLabel())!==null&&s!==void 0?s:void 0})}return n}}mightProducePrintableCharacter(t){return!t.ctrlKey&&!t.metaKey&&(t.keyCode>=31&&t.keyCode<=56||t.keyCode>=21&&t.keyCode<=30)}}class oN{constructor(t){this._ctrlKey=!!t&&t.ctrlKey,this._shiftKey=!!t&&t.shiftKey,this._altKey=!!t&&t.altKey,this._metaKey=!!t&&t.metaKey}has(t){switch(t){case"ctrl":return this._ctrlKey;case"shift":return this._shiftKey;case"alt":return this._altKey;case"meta":return this._metaKey}}}oN.EMPTY=new oN(null);class hN{constructor(t,i,e,s,n,r,o){this._resolvedKeybindingItemBrand=void 0,this.resolvedKeybinding=t,this.chords=t?cN(t.getDispatchChords()):[],t&&this.chords.length===0&&(this.chords=cN(t.getSingleModifierDispatchChords())),this.bubble=!!i&&i.charCodeAt(0)===94,this.command=this.bubble?i.substr(1):i,this.commandArgs=e,this.when=s,this.isDefault=n,this.extensionId=r,this.isBuiltinExtension=o}}function cN(t){const i=[];for(let e=0,s=t.length;e<s;e++){const s=t[e];if(!s)return[];i.push(s)}return i}class lN{constructor(t,i,e=i){this.modifierLabels=[null],this.modifierLabels[2]=t,this.modifierLabels[1]=i,this.modifierLabels[3]=e}toLabel(t,i,e){if(i.length===0)return null;const s=[];for(let n=0,r=i.length;n<r;n++){const r=i[n],o=e(r);if(o===null)return null;s[n]=gN(r,o,this.modifierLabels[t])}return s.join(" ")}}const aN=new lN({ctrlKey:"⌃",shiftKey:"⇧",altKey:"⌥",metaKey:"⌘",separator:""},{ctrlKey:tt(0,"Ctrl"),shiftKey:tt(0,"Shift"),altKey:tt(0,"Alt"),metaKey:tt(0,"Windows"),separator:"+"},{ctrlKey:tt(0,"Ctrl"),shiftKey:tt(0,"Shift"),altKey:tt(0,"Alt"),metaKey:tt(0,"Super"),separator:"+"}),uN=new lN({ctrlKey:tt(0,"Control"),shiftKey:tt(0,"Shift"),altKey:tt(0,"Option"),metaKey:tt(0,"Command"),separator:"+"},{ctrlKey:tt(0,"Control"),shiftKey:tt(0,"Shift"),altKey:tt(0,"Alt"),metaKey:tt(0,"Windows"),separator:"+"},{ctrlKey:tt(0,"Control"),shiftKey:tt(0,"Shift"),altKey:tt(0,"Alt"),metaKey:tt(0,"Super"),separator:"+"}),dN=new lN({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"}),fN=new lN({ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"cmd",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"win",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"meta",separator:"+"});function gN(t,i,e){if(i===null)return"";const s=[];return t.ctrlKey&&s.push(e.ctrlKey),t.shiftKey&&s.push(e.shiftKey),t.altKey&&s.push(e.altKey),t.metaKey&&s.push(e.metaKey),i!==""&&s.push(i),s.join(e.separator)}class pN extends to{constructor(t,i){if(super(),i.length===0)throw Wi("chords");this._os=t,this._chords=i}getLabel(){return aN.toLabel(this._os,this._chords,(t=>this._getLabel(t)))}getAriaLabel(){return uN.toLabel(this._os,this._chords,(t=>this._getAriaLabel(t)))}getElectronAccelerator(){return this._chords.length>1||this._chords[0].isDuplicateModifierCase()?null:dN.toLabel(this._os,this._chords,(t=>this._getElectronAccelerator(t)))}getUserSettingsLabel(){return fN.toLabel(this._os,this._chords,(t=>this._getUserSettingsLabel(t)))}hasMultipleChords(){return this._chords.length>1}getChords(){return this._chords.map((t=>this._getChord(t)))}_getChord(t){return new Xr(t.ctrlKey,t.shiftKey,t.altKey,t.metaKey,this._getLabel(t),this._getAriaLabel(t))}getDispatchChords(){return this._chords.map((t=>this._getChordDispatch(t)))}getSingleModifierDispatchChords(){return this._chords.map((t=>this._getSingleModifierChordDispatch(t)))}}class mN extends pN{constructor(t,i){super(i,t)}_keyCodeToUILabel(t){if(this._os===2)switch(t){case 15:return"←";case 16:return"↑";case 17:return"→";case 18:return"↓"}return Le.toString(t)}_getLabel(t){return t.isDuplicateModifierCase()?"":this._keyCodeToUILabel(t.keyCode)}_getAriaLabel(t){return t.isDuplicateModifierCase()?"":Le.toString(t.keyCode)}_getElectronAccelerator(t){return Le.toElectronAccelerator(t.keyCode)}_getUserSettingsLabel(t){if(t.isDuplicateModifierCase())return"";const i=Le.toUserSettingsUS(t.keyCode);return i&&i.toLowerCase()}_getChordDispatch(t){return mN.getDispatchStr(t)}static getDispatchStr(t){if(t.isModifierKey())return null;let i="";return t.ctrlKey&&(i+="ctrl+"),t.shiftKey&&(i+="shift+"),t.altKey&&(i+="alt+"),t.metaKey&&(i+="meta+"),i+=Le.toString(t.keyCode),i}_getSingleModifierChordDispatch(t){return t.keyCode!==5||t.shiftKey||t.altKey||t.metaKey?t.keyCode!==4||t.ctrlKey||t.altKey||t.metaKey?t.keyCode!==6||t.ctrlKey||t.shiftKey||t.metaKey?t.keyCode!==57||t.ctrlKey||t.shiftKey||t.altKey?null:"meta":"alt":"shift":"ctrl"}static _scanCodeToKeyCode(t){const i=Me[t];if(i!==-1)return i;switch(t){case 10:return 31;case 11:return 32;case 12:return 33;case 13:return 34;case 14:return 35;case 15:return 36;case 16:return 37;case 17:return 38;case 18:return 39;case 19:return 40;case 20:return 41;case 21:return 42;case 22:return 43;case 23:return 44;case 24:return 45;case 25:return 46;case 26:return 47;case 27:return 48;case 28:return 49;case 29:return 50;case 30:return 51;case 31:return 52;case 32:return 53;case 33:return 54;case 34:return 55;case 35:return 56;case 36:return 22;case 37:return 23;case 38:return 24;case 39:return 25;case 40:return 26;case 41:return 27;case 42:return 28;case 43:return 29;case 44:return 30;case 45:return 21;case 51:return 88;case 52:return 86;case 53:return 92;case 54:return 94;case 55:return 93;case 56:return 0;case 57:return 85;case 58:return 95;case 59:return 91;case 60:return 87;case 61:return 89;case 62:return 90;case 106:return 97}return 0}static _toKeyCodeChord(t){if(!t)return null;if(t instanceof Qr)return t;const i=this._scanCodeToKeyCode(t.scanCode);return i===0?null:new Qr(t.ctrlKey,t.shiftKey,t.altKey,t.metaKey,i)}static resolveKeybinding(t,i){const e=cN(t.chords.map((t=>this._toKeyCodeChord(t))));return e.length>0?[new mN(e,i)]:[]}}const wN=_l("labelService"),vN=_l("progressService");class bN{constructor(t){this.callback=t}report(t){this._value=t,this.callback(this._value)}}bN.None=Object.freeze({report(){}});const yN=_l("editorProgressService");class kN{constructor(){this._value="",this._pos=0}reset(t){return this._value=t,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(t){return t.charCodeAt(0)-this._value.charCodeAt(this._pos)}value(){return this._value[this._pos]}}class CN{constructor(t=!0){this._caseSensitive=t}reset(t){return this._value=t,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let t=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===46){if(!t)break;this._from++}else t=!1;return this}cmp(t){return this._caseSensitive?nr(t,this._value,0,t.length,this._from,this._to):or(t,this._value,0,t.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class SN{constructor(t=!0,i=!0){this._splitOnBackslash=t,this._caseSensitive=i}reset(t){this._from=0,this._to=0,this._value=t,this._valueLen=t.length;for(let i=t.length-1;i>=0;i--,this._valueLen--){const t=this._value.charCodeAt(i);if(!(t===47||this._splitOnBackslash&&t===92))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let t=!0;for(;this._to<this._valueLen;this._to++){const i=this._value.charCodeAt(this._to);if(i===47||this._splitOnBackslash&&i===92){if(!t)break;this._from++}else t=!1}return this}cmp(t){return this._caseSensitive?nr(t,this._value,0,t.length,this._from,this._to):or(t,this._value,0,t.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class xN{constructor(t,i){this._ignorePathCasing=t,this._ignoreQueryAndFragment=i,this._states=[],this._stateIdx=0}reset(t){return this._value=t,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new SN(!1,!this._ignorePathCasing(t)),this._pathIterator.reset(t.path),this._pathIterator.value()&&this._states.push(3)),this._ignoreQueryAndFragment(t)||(this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(t){if(this._states[this._stateIdx]===1)return rr(t,this._value.scheme);if(this._states[this._stateIdx]===2)return rr(t,this._value.authority);if(this._states[this._stateIdx]===3)return this._pathIterator.cmp(t);if(this._states[this._stateIdx]===4)return sr(t,this._value.query);if(this._states[this._stateIdx]===5)return sr(t,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===1)return this._value.scheme;if(this._states[this._stateIdx]===2)return this._value.authority;if(this._states[this._stateIdx]===3)return this._pathIterator.value();if(this._states[this._stateIdx]===4)return this._value.query;if(this._states[this._stateIdx]===5)return this._value.fragment;throw new Error}}class DN{constructor(){this.height=1}rotateLeft(){const t=this.right;return this.right=t.left,t.left=this,this.updateHeight(),t.updateHeight(),t}rotateRight(){const t=this.left;return this.left=t.right,t.right=this,this.updateHeight(),t.updateHeight(),t}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){var t,i;return(i=(t=this.left)===null||t===void 0?void 0:t.height)!==null&&i!==void 0?i:0}get heightRight(){var t,i;return(i=(t=this.right)===null||t===void 0?void 0:t.height)!==null&&i!==void 0?i:0}}class EN{static forUris(t=(()=>!1),i=(()=>!1)){return new EN(new xN(t,i))}static forStrings(){return new EN(new kN)}static forConfigKeys(){return new EN(new CN)}constructor(t){this._iter=t}clear(){this._root=void 0}set(t,i){const e=this._iter.reset(t);let s;this._root||(this._root=new DN,this._root.segment=e.value());const n=[];for(s=this._root;;){const t=e.cmp(s.segment);if(t>0)s.left||(s.left=new DN,s.left.segment=e.value()),n.push([-1,s]),s=s.left;else if(t<0)s.right||(s.right=new DN,s.right.segment=e.value()),n.push([1,s]),s=s.right;else{if(!e.hasNext())break;e.next(),s.mid||(s.mid=new DN,s.mid.segment=e.value()),n.push([0,s]),s=s.mid}}const r=s.value;s.value=i,s.key=t;for(let t=n.length-1;t>=0;t--){const i=n[t][1];i.updateHeight();const e=i.balanceFactor();if(e<-1||e>1){const e=n[t][0],s=n[t+1][0];if(e===1&&s===1)n[t][1]=i.rotateLeft();else if(e===-1&&s===-1)n[t][1]=i.rotateRight();else if(e===1&&s===-1)i.right=n[t+1][1]=n[t+1][1].rotateRight(),n[t][1]=i.rotateLeft();else{if(e!==-1||s!==1)throw new Error;i.left=n[t+1][1]=n[t+1][1].rotateLeft(),n[t][1]=i.rotateRight()}if(t>0)switch(n[t-1][0]){case-1:n[t-1][1].left=n[t][1];break;case 1:n[t-1][1].right=n[t][1];break;case 0:n[t-1][1].mid=n[t][1]}else this._root=n[0][1]}}return r}get(t){var i;return(i=this._getNode(t))===null||i===void 0?void 0:i.value}_getNode(t){const i=this._iter.reset(t);let e=this._root;for(;e;){const t=i.cmp(e.segment);if(t>0)e=e.left;else if(t<0)e=e.right;else{if(!i.hasNext())break;i.next(),e=e.mid}}return e}has(t){const i=this._getNode(t);return!((i==null?void 0:i.value)===void 0&&(i==null?void 0:i.mid)===void 0)}delete(t){return this._delete(t,!1)}deleteSuperstr(t){return this._delete(t,!0)}_delete(t,i){var e;const s=this._iter.reset(t),n=[];let r=this._root;for(;r;){const t=s.cmp(r.segment);if(t>0)n.push([-1,r]),r=r.left;else if(t<0)n.push([1,r]),r=r.right;else{if(!s.hasNext())break;s.next(),n.push([0,r]),r=r.mid}}if(r){if(i?(r.left=void 0,r.mid=void 0,r.right=void 0,r.height=1):(r.key=void 0,r.value=void 0),!r.mid&&!r.value)if(r.left&&r.right){const t=this._min(r.right);if(t.key){const{key:i,value:e,segment:s}=t;this._delete(t.key,!1),r.key=i,r.value=e,r.segment=s}}else{const t=(e=r.left)!==null&&e!==void 0?e:r.right;if(n.length>0){const[i,e]=n[n.length-1];switch(i){case-1:e.left=t;break;case 0:e.mid=t;break;case 1:e.right=t}}else this._root=t}for(let t=n.length-1;t>=0;t--){const i=n[t][1];i.updateHeight();const e=i.balanceFactor();if(e>1?(i.right.balanceFactor()>=0||(i.right=i.right.rotateRight()),n[t][1]=i.rotateLeft()):e<-1&&(i.left.balanceFactor()<=0||(i.left=i.left.rotateLeft()),n[t][1]=i.rotateRight()),t>0)switch(n[t-1][0]){case-1:n[t-1][1].left=n[t][1];break;case 1:n[t-1][1].right=n[t][1];break;case 0:n[t-1][1].mid=n[t][1]}else this._root=n[0][1]}}}_min(t){for(;t.left;)t=t.left;return t}findSubstr(t){const i=this._iter.reset(t);let e,s=this._root;for(;s;){const t=i.cmp(s.segment);if(t>0)s=s.left;else if(t<0)s=s.right;else{if(!i.hasNext())break;i.next(),e=s.value||e,s=s.mid}}return s&&s.value||e}findSuperstr(t){return this._findSuperstrOrElement(t,!1)}_findSuperstrOrElement(t,i){const e=this._iter.reset(t);let s=this._root;for(;s;){const t=e.cmp(s.segment);if(t>0)s=s.left;else if(t<0)s=s.right;else{if(!e.hasNext())return s.mid?this._entries(s.mid):i?s.value:void 0;e.next(),s=s.mid}}}forEach(t){for(const[i,e]of this)t(e,i)}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(t){const i=[];return this._dfsEntries(t,i),i[Symbol.iterator]()}_dfsEntries(t,i){t&&(t.left&&this._dfsEntries(t.left,i),t.value&&i.push([t.key,t.value]),t.mid&&this._dfsEntries(t.mid,i),t.right&&this._dfsEntries(t.right,i))}}const AN=_l("contextService");function MN(t){const i=t;return typeof(i==null?void 0:i.id)=="string"&&as.isUri(i.uri)}function LN(t){const i=t;return typeof(i==null?void 0:i.id)=="string"&&!MN(t)&&!function(t){const i=t;return typeof(i==null?void 0:i.id)=="string"&&as.isUri(i.configPath)}(t)}const FN={id:"empty-window"};class TN{constructor(t,i){this.raw=i,this.uri=t.uri,this.index=t.index,this.name=t.name}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}}const RN="code-workspace";tt(0,"Code Workspace");const ON="4064f6ec-cb38-4ad0-af64-ee6467e63c82";var IN,_N,PN,NN,BN,$N,WN,jN;(function(t){t.inspectTokensAction=tt(0,"Developer: Inspect Tokens")})(IN||(IN={})),function(t){t.gotoLineActionLabel=tt(0,"Go to Line/Column...")}(_N||(_N={})),function(t){t.helpQuickAccessActionLabel=tt(0,"Show all Quick Access Providers")}(PN||(PN={})),function(t){t.quickCommandActionLabel=tt(0,"Command Palette"),t.quickCommandHelp=tt(0,"Show And Run Commands")}(NN||(NN={})),function(t){t.quickOutlineActionLabel=tt(0,"Go to Symbol..."),t.quickOutlineByCategoryActionLabel=tt(0,"Go to Symbol by Category...")}(BN||(BN={})),function(t){t.editorViewAccessibleLabel=tt(0,"Editor content"),t.accessibilityHelpMessage=tt(0,"Press Alt+F1 for Accessibility Options.")}($N||($N={})),function(t){t.toggleHighContrast=tt(0,"Toggle High Contrast Theme")}(WN||(WN={})),function(t){t.bulkEditServiceSummary=tt(0,"Made {0} edits in {1} files")}(jN||(jN={}));const HN=_l("workspaceTrustManagementService");let VN=[],zN=[],UN=[];function KN(t,i=!1){(function(t,i,e){const s=function(t,i){return{id:t.id,mime:t.mime,filename:t.filename,extension:t.extension,filepattern:t.filepattern,firstline:t.firstline,userConfigured:i,filenameLowercase:t.filename?t.filename.toLowerCase():void 0,extensionLowercase:t.extension?t.extension.toLowerCase():void 0,filepatternLowercase:t.filepattern?GO(t.filepattern.toLowerCase()):void 0,filepatternOnPath:!!t.filepattern&&t.filepattern.indexOf(Je.sep)>=0}}(t,i);VN.push(s),s.userConfigured?UN.push(s):zN.push(s),e&&!s.userConfigured&&VN.forEach((t=>{t.mime===s.mime||t.userConfigured||(s.extension&&t.extension===s.extension&&console.warn(`Overwriting extension <<${s.extension}>> to now point to mime <<${s.mime}>>`),s.filename&&t.filename===s.filename&&console.warn(`Overwriting filename <<${s.filename}>> to now point to mime <<${s.mime}>>`),s.filepattern&&t.filepattern===s.filepattern&&console.warn(`Overwriting filepattern <<${s.filepattern}>> to now point to mime <<${s.mime}>>`),s.firstline&&t.firstline===s.firstline&&console.warn(`Overwriting firstline <<${s.firstline}>> to now point to mime <<${s.mime}>>`))}))})(t,!1,i)}function qN(t,i){return function(t,i){let e;if(t)switch(t.scheme){case Lh.file:e=t.fsPath;break;case Lh.data:e=RM.parseMetaData(t).get(RM.META_DATA_LABEL);break;case Lh.vscodeNotebookCell:e=void 0;break;default:e=t.path}if(!e)return[{id:"unknown",mime:$d.unknown}];e=e.toLowerCase();const s=is(e),n=GN(e,s,UN);if(n)return[n,{id:Yd,mime:$d.text}];const r=GN(e,s,zN);if(r)return[r,{id:Yd,mime:$d.text}];if(i){const t=function(t){if(Tr(t)&&(t=t.substr(1)),t.length>0)for(let i=VN.length-1;i>=0;i--){const e=VN[i];if(!e.firstline)continue;const s=t.match(e.firstline);if(s&&s.length>0)return e}}(i);if(t)return[t,{id:Yd,mime:$d.text}]}return[{id:"unknown",mime:$d.unknown}]}(t,i).map((t=>t.id))}function GN(t,i,e){var s;let n,r,o;for(let h=e.length-1;h>=0;h--){const c=e[h];if(i===c.filenameLowercase){n=c;break}if(c.filepattern&&(!r||c.filepattern.length>r.filepattern.length)){const e=c.filepatternOnPath?t:i;!((s=c.filepatternLowercase)===null||s===void 0)&&s.call(c,e)&&(r=c)}c.extension&&(!o||c.extension.length>o.extension.length)&&i.endsWith(c.extensionLowercase)&&(o=c)}return n||r||o||void 0}const ZN=Object.prototype.hasOwnProperty,JN="vs.editor.nullLanguage";class QN{constructor(){this._languageIdToLanguage=[],this._languageToLanguageId=new Map,this._register(JN,0),this._register(Yd,1),this._nextLanguageId=2}_register(t,i){this._languageIdToLanguage[i]=t,this._languageToLanguageId.set(t,i)}register(t){if(this._languageToLanguageId.has(t))return;const i=this._nextLanguageId++;this._register(t,i)}encodeLanguageId(t){return this._languageToLanguageId.get(t)||0}decodeLanguageId(t){return this._languageIdToLanguage[t]||JN}}class YN extends Qi{constructor(t=!0,i=!1){super(),this._onDidChange=this._register(new le),this.onDidChange=this._onDidChange.event,YN.instanceCount++,this._warnOnOverwrite=i,this.languageIdCodec=new QN,this._dynamicLanguages=[],this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},t&&(this._initializeFromRegistry(),this._register(Qd.onDidChangeLanguages((t=>{this._initializeFromRegistry()}))))}dispose(){YN.instanceCount--,super.dispose()}_initializeFromRegistry(){this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},VN=VN.filter((t=>t.userConfigured)),zN=[];const t=[].concat(Qd.getLanguages()).concat(this._dynamicLanguages);this._registerLanguages(t)}_registerLanguages(t){for(const i of t)this._registerLanguage(i);this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},Object.keys(this._languages).forEach((t=>{const i=this._languages[t];i.name&&(this._nameMap[i.name]=i.identifier),i.aliases.forEach((t=>{this._lowercaseNameMap[t.toLowerCase()]=i.identifier})),i.mimetypes.forEach((t=>{this._mimeTypesMap[t]=i.identifier}))})),Va.as(Hd).registerOverrideIdentifiers(this.getRegisteredLanguageIds()),this._onDidChange.fire()}_registerLanguage(t){const i=t.id;let e;ZN.call(this._languages,i)?e=this._languages[i]:(this.languageIdCodec.register(i),e={identifier:i,name:null,mimetypes:[],aliases:[],extensions:[],filenames:[],configurationFiles:[],icons:[]},this._languages[i]=e),this._mergeLanguage(e,t)}_mergeLanguage(t,i){const e=i.id;let s=null;if(Array.isArray(i.mimetypes)&&i.mimetypes.length>0&&(t.mimetypes.push(...i.mimetypes),s=i.mimetypes[0]),s||(s=`text/x-${e}`,t.mimetypes.push(s)),Array.isArray(i.extensions)){i.configuration?t.extensions=i.extensions.concat(t.extensions):t.extensions=t.extensions.concat(i.extensions);for(const t of i.extensions)KN({id:e,mime:s,extension:t},this._warnOnOverwrite)}if(Array.isArray(i.filenames))for(const n of i.filenames)KN({id:e,mime:s,filename:n},this._warnOnOverwrite),t.filenames.push(n);if(Array.isArray(i.filenamePatterns))for(const t of i.filenamePatterns)KN({id:e,mime:s,filepattern:t},this._warnOnOverwrite);if(typeof i.firstLine=="string"&&i.firstLine.length>0){let t=i.firstLine;t.charAt(0)!=="^"&&(t="^"+t);try{const i=new RegExp(t);(n=i).source!=="^"&&n.source!=="^$"&&n.source!=="$"&&n.source!=="^\\s*$"&&n.exec("")&&n.lastIndex===0||KN({id:e,mime:s,firstline:i},this._warnOnOverwrite)}catch(e){console.warn(`[${i.id}]: Invalid regular expression \`${t}\`: `,e)}}var n;t.aliases.push(e);let r=null;if(i.aliases!==void 0&&Array.isArray(i.aliases)&&(r=i.aliases.length===0?[null]:i.aliases),r!==null)for(const i of r)i&&i.length!==0&&t.aliases.push(i);const o=r!==null&&r.length>0;if(!(o&&r[0]===null)){const i=(o?r[0]:null)||e;!o&&t.name||(t.name=i)}i.configuration&&t.configurationFiles.push(i.configuration),i.icon&&t.icons.push(i.icon)}isRegisteredLanguageId(t){return!!t&&ZN.call(this._languages,t)}getRegisteredLanguageIds(){return Object.keys(this._languages)}getLanguageIdByLanguageName(t){const i=t.toLowerCase();return ZN.call(this._lowercaseNameMap,i)?this._lowercaseNameMap[i]:null}getLanguageIdByMimeType(t){return t&&ZN.call(this._mimeTypesMap,t)?this._mimeTypesMap[t]:null}guessLanguageIdByFilepathOrFirstLine(t,i){return t||i?qN(t,i):[]}}YN.instanceCount=0;class XN extends Qi{constructor(t=!1){super(),this._onDidRequestBasicLanguageFeatures=this._register(new le),this.onDidRequestBasicLanguageFeatures=this._onDidRequestBasicLanguageFeatures.event,this._onDidRequestRichLanguageFeatures=this._register(new le),this.onDidRequestRichLanguageFeatures=this._onDidRequestRichLanguageFeatures.event,this._onDidChange=this._register(new le({leakWarningThreshold:200})),this.onDidChange=this._onDidChange.event,this._requestedBasicLanguages=new Set,this._requestedRichLanguages=new Set,XN.instanceCount++,this._registry=this._register(new YN(!0,t)),this.languageIdCodec=this._registry.languageIdCodec,this._register(this._registry.onDidChange((()=>this._onDidChange.fire())))}dispose(){XN.instanceCount--,super.dispose()}isRegisteredLanguageId(t){return this._registry.isRegisteredLanguageId(t)}getLanguageIdByLanguageName(t){return this._registry.getLanguageIdByLanguageName(t)}getLanguageIdByMimeType(t){return this._registry.getLanguageIdByMimeType(t)}guessLanguageIdByFilepathOrFirstLine(t,i){return p(this._registry.guessLanguageIdByFilepathOrFirstLine(t,i),null)}createById(t){return new tB(this.onDidChange,(()=>this._createAndGetLanguageIdentifier(t)))}createByFilepathOrFirstLine(t,i){return new tB(this.onDidChange,(()=>{const e=this.guessLanguageIdByFilepathOrFirstLine(t,i);return this._createAndGetLanguageIdentifier(e)}))}_createAndGetLanguageIdentifier(t){return t&&this.isRegisteredLanguageId(t)||(t=Yd),t}requestBasicLanguageFeatures(t){this._requestedBasicLanguages.has(t)||(this._requestedBasicLanguages.add(t),this._onDidRequestBasicLanguageFeatures.fire(t))}requestRichLanguageFeatures(t){this._requestedRichLanguages.has(t)||(this._requestedRichLanguages.add(t),this.requestBasicLanguageFeatures(t),Us.getOrCreate(t),this._onDidRequestRichLanguageFeatures.fire(t))}}XN.instanceCount=0;class tB{constructor(t,i){this._onDidChangeLanguages=t,this._selector=i,this._listener=null,this._emitter=null,this.languageId=this._selector()}_dispose(){this._listener&&(this._listener.dispose(),this._listener=null),this._emitter&&(this._emitter.dispose(),this._emitter=null)}get onDidChange(){return this._listener||(this._listener=this._onDidChangeLanguages((()=>this._evaluate()))),this._emitter||(this._emitter=new le({onDidRemoveLastListener:()=>{this._dispose()}})),this._emitter.event}_evaluate(){var t;const i=this._selector();i!==this.languageId&&(this.languageId=i,(t=this._emitter)===null||t===void 0||t.fire(this.languageId))}}const iB={RESOURCES:"ResourceURLs",DOWNLOAD_URL:"DownloadURL",FILES:"Files",TEXT:$d.text,INTERNAL_URI_LIST:"application/vnd.code.uri-list"};let eB=()=>({get delay(){return-1},dispose:()=>{},showHover:()=>{}});const sB=new Hn((()=>eB("mouse",!1))),nB=new Hn((()=>eB("element",!1)));function rB(t){return t==="element"?nB.value:sB.value}function oB(){return eB("element",!0)}class hB{constructor(t,i,e){this.hoverDelegate=t,this.target=i,this.fadeInAnimation=e}async update(t,i,e){var s;if(this._cancellationTokenSource&&(this._cancellationTokenSource.dispose(!0),this._cancellationTokenSource=void 0),this.isDisposed)return;let n;if(t===void 0||R(t)||t instanceof HTMLElement)n=t;else if(V(t.markdown)){this._hoverWidget||this.show(tt(0,"Loading..."),i),this._cancellationTokenSource=new ye;const e=this._cancellationTokenSource.token;if(n=await t.markdown(e),n===void 0&&(n=t.markdownNotSupportedFallback),this.isDisposed||e.isCancellationRequested)return}else n=(s=t.markdown)!==null&&s!==void 0?s:t.markdownNotSupportedFallback;this.show(n,i,e)}show(t,i,e){const s=this._hoverWidget;if(this.hasContent(t)){const n={content:t,target:this.target,appearance:{showPointer:this.hoverDelegate.placement==="element",skipFadeInAnimation:!this.fadeInAnimation||!!s},position:{hoverPosition:2},...e};this._hoverWidget=this.hoverDelegate.showHover(n,i)}s==null||s.dispose()}hasContent(t){return!!t&&(!R_(t)||!!t.value)}get isDisposed(){var t;return(t=this._hoverWidget)===null||t===void 0?void 0:t.isDisposed}dispose(){var t,i;(t=this._hoverWidget)===null||t===void 0||t.dispose(),(i=this._cancellationTokenSource)===null||i===void 0||i.dispose(!0),this._cancellationTokenSource=void 0}}function cB(t,i){for(i=i??Uh(t).document.body;!t.hasAttribute("custom-hover")&&t!==i;)t=t.parentElement;return t}function lB(t,i,e,s){let n,r;i.setAttribute("custom-hover","true"),i.title!==""&&(console.warn("HTML element already has a title attribute, which will conflict with the custom hover. Please remove the title attribute."),console.trace("Stack trace:",i.title),i.title="");const o=(i,e)=>{var s;const o=r!==void 0;i&&(r==null||r.dispose(),r=void 0),e&&(n==null||n.dispose(),n=void 0),o&&((s=t.onDidHideHover)===null||s===void 0||s.call(t),r=void 0)},h=(n,o,h)=>new yo((async()=>{r&&!r.isDisposed||(r=new hB(t,h||i,n>0),await r.update(typeof e=="function"?e():e,o,s))}),n);let c=!1;const l=sc(i,qc.MOUSE_DOWN,(()=>{c=!0,o(!0,!0)}),!0),a=sc(i,qc.MOUSE_UP,(()=>{c=!1}),!0),u=sc(i,qc.MOUSE_LEAVE,(t=>{c=!1,o(!1,t.fromElement===i)}),!0),d=sc(i,qc.MOUSE_OVER,(e=>{if(n)return;const s=new Ji,r={targetElements:[i],dispose:()=>{}};if(t.placement===void 0||t.placement==="mouse"){const t=t=>{r.x=t.x+10,t.target instanceof HTMLElement&&cB(t.target,i)!==i&&o(!0,!0)};s.add(sc(i,qc.MOUSE_MOVE,t,!0))}n=s,e.target instanceof HTMLElement&&cB(e.target,i)!==i||s.add(h(t.delay,!1,r))}),!0),f=()=>{if(c||n)return;const e={targetElements:[i],dispose:()=>{}},s=new Ji;s.add(sc(i,qc.BLUR,(()=>o(!0,!0)),!0)),s.add(h(t.delay,!1,e)),n=s};let g;const p=i.tagName.toLowerCase();return p!=="input"&&p!=="textarea"&&(g=sc(i,qc.FOCUS,f,!0)),{show:t=>{o(!1,!0),h(0,t)},hide:()=>{o(!0,!0)},update:async(t,i)=>{e=t,await(r==null?void 0:r.update(e,void 0,i))},dispose:()=>{d.dispose(),u.dispose(),l.dispose(),a.dispose(),g==null||g.dispose(),o(!0,!0)}}}class aB{constructor(t){this.spliceables=t}splice(t,i,e){this.spliceables.forEach((s=>s.splice(t,i,e)))}}class uB extends Error{constructor(t,i){super(`ListError [${t}] ${i}`)}}function dB(t,i){const e=[];for(const s of i){if(t.start>=s.range.end)continue;if(t.end<s.range.start)break;const i=CP.intersect(t,s.range);CP.isEmpty(i)||e.push({range:i,size:s.size})}return e}function fB({start:t,end:i},e){return{start:t+e,end:i+e}}class gB{get paddingTop(){return this._paddingTop}set paddingTop(t){this._size=this._size+t-this._paddingTop,this._paddingTop=t}constructor(t){this.groups=[],this._size=0,this._paddingTop=0,this._paddingTop=t??0,this._size=this._paddingTop}splice(t,i,e=[]){const s=e.length-i,n=dB({start:0,end:t},this.groups),r=dB({start:t+i,end:Number.POSITIVE_INFINITY},this.groups).map((t=>({range:fB(t.range,s),size:t.size}))),o=e.map(((i,e)=>({range:{start:t+e,end:t+e+1},size:i.size})));this.groups=function(...t){return function(t){const i=[];let e=null;for(const s of t){const t=s.range.start,n=s.range.end,r=s.size;e&&r===e.size?e.range.end=n:(e={range:{start:t,end:n},size:r},i.push(e))}return i}(t.reduce(((t,i)=>t.concat(i)),[]))}(n,o,r),this._size=this._paddingTop+this.groups.reduce(((t,i)=>t+i.size*(i.range.end-i.range.start)),0)}get count(){const t=this.groups.length;return t?this.groups[t-1].range.end:0}get size(){return this._size}indexAt(t){if(t<0)return-1;if(t<this._paddingTop)return 0;let i=0,e=this._paddingTop;for(const s of this.groups){const n=s.range.end-s.range.start,r=e+n*s.size;if(t<r)return i+Math.floor((t-e)/s.size);i+=n,e=r}return i}indexAfter(t){return Math.min(this.indexAt(t)+1,this.count)}positionAt(t){if(t<0)return-1;let i=0,e=0;for(const s of this.groups){const n=s.range.end-s.range.start,r=e+n;if(t<r)return this._paddingTop+i+(t-e)*s.size;i+=n*s.size,e=r}return-1}}class pB{constructor(t){this.renderers=t,this.cache=new Map,this.transactionNodesPendingRemoval=new Set,this.inTransaction=!1}alloc(t){let i=this.getTemplateCache(t).pop(),e=!1;if(i)e=this.transactionNodesPendingRemoval.has(i.domNode),e&&this.transactionNodesPendingRemoval.delete(i.domNode);else{const e=nl(".monaco-list-row");i={domNode:e,templateId:t,templateData:this.getRenderer(t).renderTemplate(e)}}return{row:i,isReusingConnectedDomNode:e}}release(t){t&&this.releaseRow(t)}transact(t){if(this.inTransaction)throw new Error("Already in transaction");this.inTransaction=!0;try{t()}finally{for(const t of this.transactionNodesPendingRemoval)this.doRemoveNode(t);this.transactionNodesPendingRemoval.clear(),this.inTransaction=!1}}releaseRow(t){const{domNode:i,templateId:e}=t;i&&(this.inTransaction?this.transactionNodesPendingRemoval.add(i):this.doRemoveNode(i)),this.getTemplateCache(e).push(t)}doRemoveNode(t){t.classList.remove("scrolling"),function(t){var i;try{(i=t.parentElement)===null||i===void 0||i.removeChild(t)}catch{}}(t)}getTemplateCache(t){let i=this.cache.get(t);return i||(i=[],this.cache.set(t,i)),i}dispose(){this.cache.forEach(((t,i)=>{for(const e of t)this.getRenderer(i).disposeTemplate(e.templateData),e.templateData=null})),this.cache.clear(),this.transactionNodesPendingRemoval.clear()}getRenderer(t){const i=this.renderers.get(t);if(!i)throw new Error(`No renderer found for ${t}`);return i}}var mB=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o};const wB={CurrentDragAndDropData:void 0},vB={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements:t=>[t],getDragURI:()=>null,onDragStart(){},onDragOver:()=>!1,drop(){},dispose(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0};class bB{constructor(t){this.elements=t}update(){}getData(){return this.elements}}class yB{constructor(t){this.elements=t}update(){}getData(){return this.elements}}class kB{constructor(){this.types=[],this.files=[]}update(t){if(t.types&&this.types.splice(0,this.types.length,...t.types),t.files){this.files.splice(0,this.files.length);for(let i=0;i<t.files.length;i++){const e=t.files.item(i);e&&(e.size||e.type)&&this.files.push(e)}}}getData(){return{types:this.types,files:this.files}}}class CB{constructor(t){t!=null&&t.getSetSize?this.getSetSize=t.getSetSize.bind(t):this.getSetSize=(t,i,e)=>e,t!=null&&t.getPosInSet?this.getPosInSet=t.getPosInSet.bind(t):this.getPosInSet=(t,i)=>i+1,t!=null&&t.getRole?this.getRole=t.getRole.bind(t):this.getRole=t=>"listitem",t!=null&&t.isChecked?this.isChecked=t.isChecked.bind(t):this.isChecked=t=>{}}}class SB{get contentHeight(){return this.rangeMap.size}get onDidScroll(){return this.scrollableElement.onScroll}get scrollableElementDomNode(){return this.scrollableElement.getDomNode()}get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(t){if(t!==this._horizontalScrolling){if(t&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=t,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(const t of this.items)this.measureItemWidth(t);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:kc(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}constructor(t,i,e,s=vB){var n,r,o,h,c,l,a,u,d,f,g,p,m;if(this.virtualDelegate=i,this.domId="list_id_"+ ++SB.InstanceCount,this.renderers=new Map,this.renderWidth=0,this._scrollHeight=0,this.scrollableElementUpdateDisposable=null,this.scrollableElementWidthDelayer=new po(50),this.splicing=!1,this.dragOverAnimationStopDisposable=Qi.None,this.dragOverMouseY=0,this.canDrop=!1,this.currentDragFeedbackDisposable=Qi.None,this.onDragLeaveTimeout=Qi.None,this.disposables=new Ji,this._onDidChangeContentHeight=new le,this._onDidChangeContentWidth=new le,this.onDidChangeContentHeight=ne.latch(this._onDidChangeContentHeight.event,void 0,this.disposables),this._horizontalScrolling=!1,s.horizontalScrolling&&s.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=this.createRangeMap((n=s.paddingTop)!==null&&n!==void 0?n:0);for(const t of e)this.renderers.set(t.templateId,t);this.cache=this.disposables.add(new pB(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support",typeof s.mouseSupport!="boolean"||s.mouseSupport),this._horizontalScrolling=(r=s.horizontalScrolling)!==null&&r!==void 0?r:vB.horizontalScrolling,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.paddingBottom=s.paddingBottom===void 0?0:s.paddingBottom,this.accessibilityProvider=new CB(s.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows",((o=s.transformOptimization)!==null&&o!==void 0?o:vB.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)",this.rowsContainer.style.overflow="hidden",this.rowsContainer.style.contain="strict"),this.disposables.add(Wk.addTarget(this.rowsContainer)),this.scrollable=this.disposables.add(new Jk({forceIntegerValues:!0,smoothScrollDuration:(h=s.smoothScrolling)!==null&&h!==void 0&&h?125:0,scheduleAtNextAnimationFrame:t=>ac(Uh(this.domNode),t)})),this.scrollableElement=this.disposables.add(new nC(this.rowsContainer,{alwaysConsumeMouseWheel:(c=s.alwaysConsumeMouseWheel)!==null&&c!==void 0?c:vB.alwaysConsumeMouseWheel,horizontal:1,vertical:(l=s.verticalScrollMode)!==null&&l!==void 0?l:vB.verticalScrollMode,useShadows:(a=s.useShadows)!==null&&a!==void 0?a:vB.useShadows,mouseWheelScrollSensitivity:s.mouseWheelScrollSensitivity,fastScrollSensitivity:s.fastScrollSensitivity,scrollByPage:s.scrollByPage},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),t.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add(sc(this.rowsContainer,Bk.Change,(t=>this.onTouchChange(t)))),this.disposables.add(sc(this.scrollableElement.getDomNode(),"scroll",(t=>t.target.scrollTop=0))),this.disposables.add(sc(this.domNode,"dragover",(t=>this.onDragOver(this.toDragEvent(t))))),this.disposables.add(sc(this.domNode,"drop",(t=>this.onDrop(this.toDragEvent(t))))),this.disposables.add(sc(this.domNode,"dragleave",(t=>this.onDragLeave(this.toDragEvent(t))))),this.disposables.add(sc(this.domNode,"dragend",(t=>this.onDragEnd(t)))),this.setRowLineHeight=(u=s.setRowLineHeight)!==null&&u!==void 0?u:vB.setRowLineHeight,this.setRowHeight=(d=s.setRowHeight)!==null&&d!==void 0?d:vB.setRowHeight,this.supportDynamicHeights=(f=s.supportDynamicHeights)!==null&&f!==void 0?f:vB.supportDynamicHeights,this.dnd=(g=s.dnd)!==null&&g!==void 0?g:this.disposables.add(vB.dnd),this.layout((p=s.initialSize)===null||p===void 0?void 0:p.height,(m=s.initialSize)===null||m===void 0?void 0:m.width)}updateOptions(t){let i;if(t.paddingBottom!==void 0&&(this.paddingBottom=t.paddingBottom,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),t.smoothScrolling!==void 0&&this.scrollable.setSmoothScrollDuration(t.smoothScrolling?125:0),t.horizontalScrolling!==void 0&&(this.horizontalScrolling=t.horizontalScrolling),t.scrollByPage!==void 0&&(i={...i??{},scrollByPage:t.scrollByPage}),t.mouseWheelScrollSensitivity!==void 0&&(i={...i??{},mouseWheelScrollSensitivity:t.mouseWheelScrollSensitivity}),t.fastScrollSensitivity!==void 0&&(i={...i??{},fastScrollSensitivity:t.fastScrollSensitivity}),i&&this.scrollableElement.updateOptions(i),t.paddingTop!==void 0&&t.paddingTop!==this.rangeMap.paddingTop){const i=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),e=t.paddingTop-this.rangeMap.paddingTop;this.rangeMap.paddingTop=t.paddingTop,this.render(i,Math.max(0,this.lastRenderTop+e),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}}createRangeMap(t){return new gB(t)}splice(t,i,e=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(t,i,e)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(t,i,e=[]){const s=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),n={start:t,end:t+i},r=CP.intersect(s,n),o=new Map;for(let t=r.end-1;t>=r.start;t--){const i=this.items[t];if(i.dragStartDisposable.dispose(),i.checkedDisposable.dispose(),i.row){let e=o.get(i.templateId);e||(e=[],o.set(i.templateId,e));const s=this.renderers.get(i.templateId);s&&s.disposeElement&&s.disposeElement(i.element,t,i.row.templateData,i.size),e.push(i.row)}i.row=null,i.stale=!0}const h={start:t+i,end:this.items.length},c=CP.intersect(h,s),l=CP.relativeComplement(h,s),a=e.map((t=>({id:String(this.itemId++),element:t,templateId:this.virtualDelegate.getTemplateId(t),size:this.virtualDelegate.getHeight(t),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(t),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:Qi.None,checkedDisposable:Qi.None,stale:!1})));let u;t===0&&i>=this.items.length?(this.rangeMap=this.createRangeMap(this.rangeMap.paddingTop),this.rangeMap.splice(0,0,a),u=this.items,this.items=a):(this.rangeMap.splice(t,i,a),u=this.items.splice(t,i,...a));const d=e.length-i,f=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),g=fB(c,d),p=CP.intersect(f,g);for(let t=p.start;t<p.end;t++)this.updateItemInDOM(this.items[t],t);const m=CP.relativeComplement(g,f);for(const t of m)for(let i=t.start;i<t.end;i++)this.removeItemFromDOM(i);const w=l.map((t=>fB(t,d))),v=[{start:t,end:t+e.length},...w].map((t=>CP.intersect(f,t))).reverse();for(const t of v)for(let i=t.end-1;i>=t.start;i--){const t=this.items[i],e=o.get(t.templateId),s=e==null?void 0:e.pop();this.insertItemInDOM(i,s)}for(const t of o.values())for(const i of t)this.cache.release(i);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),u.map((t=>t.element))}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=ac(Uh(this.domNode),(()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null})))}eventuallyUpdateScrollWidth(){this.horizontalScrolling?this.scrollableElementWidthDelayer.trigger((()=>this.updateScrollWidth())):this.scrollableElementWidthDelayer.cancel()}updateScrollWidth(){if(!this.horizontalScrolling)return;let t=0;for(const i of this.items)i.width!==void 0&&(t=Math.max(t,i.width));this.scrollWidth=t,this.scrollableElement.setScrollDimensions({scrollWidth:t===0?0:t+10}),this._onDidChangeContentWidth.fire(this.scrollWidth)}rerender(){if(this.supportDynamicHeights){for(const t of this.items)t.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}get firstVisibleIndex(){return this.getRenderRange(this.lastRenderTop,this.lastRenderHeight).start}element(t){return this.items[t].element}indexOf(t){return this.items.findIndex((i=>i.element===t))}domElement(t){const i=this.items[t].row;return i&&i.domNode}elementHeight(t){return this.items[t].size}elementTop(t){return this.rangeMap.positionAt(t)}indexAt(t){return this.rangeMap.indexAt(t)}indexAfter(t){return this.rangeMap.indexAfter(t)}layout(t,i){const e={height:typeof t=="number"?t:Cc(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,e.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(e),i!==void 0&&(this.renderWidth=i,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:typeof i=="number"?i:kc(this.domNode)})}render(t,i,e,s,n,r=!1){const o=this.getRenderRange(i,e),h=CP.relativeComplement(o,t).reverse(),c=CP.relativeComplement(t,o);if(r){const i=CP.intersect(t,o);for(let t=i.start;t<i.end;t++)this.updateItemInDOM(this.items[t],t)}this.cache.transact((()=>{for(const t of c)for(let i=t.start;i<t.end;i++)this.removeItemFromDOM(i);for(const t of h)for(let i=t.end-1;i>=t.start;i--)this.insertItemInDOM(i)})),s!==void 0&&(this.rowsContainer.style.left=`-${s}px`),this.rowsContainer.style.top=`-${i}px`,this.horizontalScrolling&&n!==void 0&&(this.rowsContainer.style.width=`${Math.max(n,this.renderWidth)}px`),this.lastRenderTop=i,this.lastRenderHeight=e}insertItemInDOM(t,i){var e,s,n;const r=this.items[t];if(!r.row)if(i)r.row=i,r.stale=!0;else{const t=this.cache.alloc(r.templateId);r.row=t.row,r.stale||(r.stale=t.isReusingConnectedDomNode)}const o=this.accessibilityProvider.getRole(r.element)||"listitem";r.row.domNode.setAttribute("role",o);const h=this.accessibilityProvider.isChecked(r.element);if(typeof h=="boolean")r.row.domNode.setAttribute("aria-checked",String(!!h));else if(h){const t=t=>r.row.domNode.setAttribute("aria-checked",String(!!t));t(h.value),r.checkedDisposable=h.onDidChange(t)}if(r.stale||!r.row.domNode.parentElement){const i=(n=(s=(e=this.items.at(t+1))===null||e===void 0?void 0:e.row)===null||s===void 0?void 0:s.domNode)!==null&&n!==void 0?n:null;this.rowsContainer.insertBefore(r.row.domNode,i),r.stale=!1}this.updateItemInDOM(r,t);const c=this.renderers.get(r.templateId);if(!c)throw new Error(`No renderer found for template id ${r.templateId}`);c==null||c.renderElement(r.element,t,r.row.templateData,r.size);const l=this.dnd.getDragURI(r.element);r.dragStartDisposable.dispose(),r.row.domNode.draggable=!!l,l&&(r.dragStartDisposable=sc(r.row.domNode,"dragstart",(t=>this.onDragStart(r.element,l,t)))),this.horizontalScrolling&&(this.measureItemWidth(r),this.eventuallyUpdateScrollWidth())}measureItemWidth(t){if(!t.row||!t.row.domNode)return;t.row.domNode.style.width="fit-content",t.width=kc(t.row.domNode);const i=Uh(t.row.domNode).getComputedStyle(t.row.domNode);i.paddingLeft&&(t.width+=parseFloat(i.paddingLeft)),i.paddingRight&&(t.width+=parseFloat(i.paddingRight)),t.row.domNode.style.width=""}updateItemInDOM(t,i){t.row.domNode.style.top=`${this.elementTop(i)}px`,this.setRowHeight&&(t.row.domNode.style.height=`${t.size}px`),this.setRowLineHeight&&(t.row.domNode.style.lineHeight=`${t.size}px`),t.row.domNode.setAttribute("data-index",`${i}`),t.row.domNode.setAttribute("data-last-element",i===this.length-1?"true":"false"),t.row.domNode.setAttribute("data-parity",i%2==0?"even":"odd"),t.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(t.element,i,this.length))),t.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(t.element,i))),t.row.domNode.setAttribute("id",this.getElementDomId(i)),t.row.domNode.classList.toggle("drop-target",t.dropTarget)}removeItemFromDOM(t){const i=this.items[t];if(i.dragStartDisposable.dispose(),i.checkedDisposable.dispose(),i.row){const e=this.renderers.get(i.templateId);e&&e.disposeElement&&e.disposeElement(i.element,t,i.row.templateData,i.size),this.cache.release(i.row),i.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(t,i){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop:t,reuseAnimation:i})}get scrollTop(){return this.getScrollTop()}set scrollTop(t){this.setScrollTop(t)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.paddingBottom}get onMouseClick(){return ne.map(this.disposables.add(new uC(this.domNode,"click")).event,(t=>this.toMouseEvent(t)),this.disposables)}get onMouseDblClick(){return ne.map(this.disposables.add(new uC(this.domNode,"dblclick")).event,(t=>this.toMouseEvent(t)),this.disposables)}get onMouseMiddleClick(){return ne.filter(ne.map(this.disposables.add(new uC(this.domNode,"auxclick")).event,(t=>this.toMouseEvent(t)),this.disposables),(t=>t.browserEvent.button===1),this.disposables)}get onMouseDown(){return ne.map(this.disposables.add(new uC(this.domNode,"mousedown")).event,(t=>this.toMouseEvent(t)),this.disposables)}get onMouseOver(){return ne.map(this.disposables.add(new uC(this.domNode,"mouseover")).event,(t=>this.toMouseEvent(t)),this.disposables)}get onMouseOut(){return ne.map(this.disposables.add(new uC(this.domNode,"mouseout")).event,(t=>this.toMouseEvent(t)),this.disposables)}get onContextMenu(){return ne.any(ne.map(this.disposables.add(new uC(this.domNode,"contextmenu")).event,(t=>this.toMouseEvent(t)),this.disposables),ne.map(this.disposables.add(new uC(this.domNode,Bk.Contextmenu)).event,(t=>this.toGestureEvent(t)),this.disposables))}get onTouchStart(){return ne.map(this.disposables.add(new uC(this.domNode,"touchstart")).event,(t=>this.toTouchEvent(t)),this.disposables)}get onTap(){return ne.map(this.disposables.add(new uC(this.rowsContainer,Bk.Tap)).event,(t=>this.toGestureEvent(t)),this.disposables)}toMouseEvent(t){const i=this.getItemIndexFromEventTarget(t.target||null),e=i===void 0?void 0:this.items[i];return{browserEvent:t,index:i,element:e&&e.element}}toTouchEvent(t){const i=this.getItemIndexFromEventTarget(t.target||null),e=i===void 0?void 0:this.items[i];return{browserEvent:t,index:i,element:e&&e.element}}toGestureEvent(t){const i=this.getItemIndexFromEventTarget(t.initialTarget||null),e=i===void 0?void 0:this.items[i];return{browserEvent:t,index:i,element:e&&e.element}}toDragEvent(t){const i=this.getItemIndexFromEventTarget(t.target||null),e=i===void 0?void 0:this.items[i];return{browserEvent:t,index:i,element:e&&e.element,sector:this.getTargetSector(t,i)}}onScroll(t){try{const i=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(i,t.scrollTop,t.height,t.scrollLeft,t.scrollWidth),this.supportDynamicHeights&&this._rerender(t.scrollTop,t.height,t.inSmoothScrolling)}catch(i){throw console.error("Got bad scroll event:",t),i}}onTouchChange(t){t.preventDefault(),t.stopPropagation(),this.scrollTop-=t.translationY}onDragStart(t,i,e){var s,n;if(!e.dataTransfer)return;const r=this.dnd.getDragElements(t);if(e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setData(iB.TEXT,i),e.dataTransfer.setDragImage){let t;this.dnd.getDragLabel&&(t=this.dnd.getDragLabel(r,e)),t===void 0&&(t=String(r.length));const i=nl(".monaco-drag-image");i.textContent=t;const s=(t=>{for(;t&&!t.classList.contains("monaco-workbench");)t=t.parentElement;return t||this.domNode.ownerDocument})(this.domNode);s.appendChild(i),e.dataTransfer.setDragImage(i,-10,-10),setTimeout((()=>s.removeChild(i)),0)}this.domNode.classList.add("dragging"),this.currentDragData=new bB(r),wB.CurrentDragAndDropData=new yB(r),(n=(s=this.dnd).onDragStart)===null||n===void 0||n.call(s,this.currentDragData,e)}onDragOver(t){var i,e;if(t.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),wB.CurrentDragAndDropData&&wB.CurrentDragAndDropData.getData()==="vscode-ui"||(this.setupDragAndDropScrollTopAnimation(t.browserEvent),!t.browserEvent.dataTransfer))return!1;if(!this.currentDragData)if(wB.CurrentDragAndDropData)this.currentDragData=wB.CurrentDragAndDropData;else{if(!t.browserEvent.dataTransfer.types)return!1;this.currentDragData=new kB}const s=this.dnd.onDragOver(this.currentDragData,t.element,t.index,t.sector,t.browserEvent);if(this.canDrop=typeof s=="boolean"?s:s.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;let r;t.browserEvent.dataTransfer.dropEffect=typeof s!="boolean"&&((i=s.effect)===null||i===void 0?void 0:i.type)===0?"copy":"move",r=typeof s!="boolean"&&s.feedback?s.feedback:t.index===void 0?[-1]:[t.index],r=g(r).filter((t=>t>=-1&&t<this.length)).sort(((t,i)=>t-i)),r=r[0]===-1?[-1]:r;let o=typeof s!="boolean"&&s.effect&&s.effect.position?s.effect.position:"drop-target";if(h=this.currentDragFeedback,c=r,(Array.isArray(h)&&Array.isArray(c)?n(h,c):h===c)&&this.currentDragFeedbackPosition===o)return!0;var h,c;if(this.currentDragFeedback=r,this.currentDragFeedbackPosition=o,this.currentDragFeedbackDisposable.dispose(),r[0]===-1)this.domNode.classList.add(o),this.rowsContainer.classList.add(o),this.currentDragFeedbackDisposable=Zi((()=>{this.domNode.classList.remove(o),this.rowsContainer.classList.remove(o)}));else{if(r.length>1&&o!=="drop-target")throw new Error("Can't use multiple feedbacks with position different than 'over'");o==="drop-target-after"&&r[0]<this.length-1&&(r[0]+=1,o="drop-target-before");for(const t of r){const i=this.items[t];i.dropTarget=!0,(e=i.row)===null||e===void 0||e.domNode.classList.add(o)}this.currentDragFeedbackDisposable=Zi((()=>{var t;for(const i of r){const e=this.items[i];e.dropTarget=!1,(t=e.row)===null||t===void 0||t.domNode.classList.remove(o)}}))}return!0}onDragLeave(t){var i,e;this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=vo((()=>this.clearDragOverFeedback()),100,this.disposables),this.currentDragData&&((e=(i=this.dnd).onDragLeave)===null||e===void 0||e.call(i,this.currentDragData,t.element,t.index,t.browserEvent))}onDrop(t){if(!this.canDrop)return;const i=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,wB.CurrentDragAndDropData=void 0,i&&t.browserEvent.dataTransfer&&(t.browserEvent.preventDefault(),i.update(t.browserEvent.dataTransfer),this.dnd.drop(i,t.element,t.index,t.sector,t.browserEvent))}onDragEnd(t){var i,e;this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,wB.CurrentDragAndDropData=void 0,(e=(i=this.dnd).onDragEnd)===null||e===void 0||e.call(i,t)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackPosition=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=Qi.None}setupDragAndDropScrollTopAnimation(t){if(!this.dragOverAnimationDisposable){const t=wc(this.domNode).top;this.dragOverAnimationDisposable=function(t,i){const e=()=>{i(),s=ac(t,e)};let s=ac(t,e);return Zi((()=>s.dispose()))}(Uh(this.domNode),this.animateDragAndDropScrollTop.bind(this,t))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=vo((()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}),1e3,this.disposables),this.dragOverMouseY=t.pageY}animateDragAndDropScrollTop(t){if(this.dragOverMouseY===void 0)return;const i=this.dragOverMouseY-t,e=this.renderHeight-35;i<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(i-35))):i>e&&(this.scrollTop+=Math.min(14,Math.floor(.3*(i-e))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getTargetSector(t,i){if(i===void 0)return;const e=t.offsetY/this.items[i].size;return sO(Math.floor(e/.25),0,3)}getItemIndexFromEventTarget(t){const i=this.scrollableElement.getDomNode();let e=t;for(;e instanceof HTMLElement&&e!==this.rowsContainer&&i.contains(e);){const t=e.getAttribute("data-index");if(t){const i=Number(t);if(!isNaN(i))return i}e=e.parentElement}}getRenderRange(t,i){return{start:this.rangeMap.indexAt(t),end:this.rangeMap.indexAfter(t+i-1)}}_rerender(t,i,e){const s=this.getRenderRange(t,i);let n,r;t===this.elementTop(s.start)?(n=s.start,r=0):s.end-s.start>1&&(n=s.start+1,r=this.elementTop(n)-t);let o=0;for(;;){const h=this.getRenderRange(t,i);let c=!1;for(let t=h.start;t<h.end;t++){const i=this.probeDynamicHeight(t);i!==0&&this.rangeMap.splice(t,1,[this.items[t]]),o+=i,c=c||i!==0}if(!c){o!==0&&this.eventuallyUpdateScrollDimensions();const i=CP.relativeComplement(s,h);for(const t of i)for(let i=t.start;i<t.end;i++)this.items[i].row&&this.removeItemFromDOM(i);const c=CP.relativeComplement(h,s).reverse();for(const t of c)for(let i=t.end-1;i>=t.start;i--)this.insertItemInDOM(i);for(let t=h.start;t<h.end;t++)this.items[t].row&&this.updateItemInDOM(this.items[t],t);if(typeof n=="number"){const i=this.scrollable.getFutureScrollPosition().scrollTop-t,s=this.elementTop(n)-r+i;this.setScrollTop(s,e)}return void this._onDidChangeContentHeight.fire(this.contentHeight)}}}probeDynamicHeight(t){var i,e,s;const n=this.items[t];if(this.virtualDelegate.getDynamicHeight){const t=this.virtualDelegate.getDynamicHeight(n.element);if(t!==null){const i=n.size;return n.size=t,n.lastDynamicHeightWidth=this.renderWidth,t-i}}if(!n.hasDynamicHeight||n.lastDynamicHeightWidth===this.renderWidth||this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(n.element))return 0;const r=n.size;if(n.row)return n.row.domNode.style.height="",n.size=n.row.domNode.offsetHeight,n.size!==0||xc(n.row.domNode,Uh(n.row.domNode).document.body)||console.warn("Measuring item node that is not in DOM! Add ListView to the DOM before measuring row height!"),n.lastDynamicHeightWidth=this.renderWidth,n.size-r;const{row:o}=this.cache.alloc(n.templateId);o.domNode.style.height="",this.rowsContainer.appendChild(o.domNode);const h=this.renderers.get(n.templateId);if(!h)throw new zi("Missing renderer for templateId: "+n.templateId);return h.renderElement(n.element,t,o.templateData,void 0),n.size=o.domNode.offsetHeight,(i=h.disposeElement)===null||i===void 0||i.call(h,n.element,t,o.templateData,void 0),(s=(e=this.virtualDelegate).setDynamicHeight)===null||s===void 0||s.call(e,n.element,n.size),n.lastDynamicHeightWidth=this.renderWidth,this.rowsContainer.removeChild(o.domNode),this.cache.release(o),n.size-r}getElementDomId(t){return`${this.domId}_${t}`}dispose(){var t,i;for(const i of this.items)if(i.dragStartDisposable.dispose(),i.checkedDisposable.dispose(),i.row){const e=this.renderers.get(i.row.templateId);e&&((t=e.disposeElement)===null||t===void 0||t.call(e,i.element,-1,i.row.templateData,void 0),e.disposeTemplate(i.row.templateData))}this.items=[],this.domNode&&this.domNode.parentNode&&this.domNode.parentNode.removeChild(this.domNode),(i=this.dragOverAnimationDisposable)===null||i===void 0||i.dispose(),this.disposables.dispose()}}SB.InstanceCount=0,mB([Nk],SB.prototype,"onMouseClick",null),mB([Nk],SB.prototype,"onMouseDblClick",null),mB([Nk],SB.prototype,"onMouseMiddleClick",null),mB([Nk],SB.prototype,"onMouseDown",null),mB([Nk],SB.prototype,"onMouseOver",null),mB([Nk],SB.prototype,"onMouseOut",null),mB([Nk],SB.prototype,"onContextMenu",null),mB([Nk],SB.prototype,"onTouchStart",null),mB([Nk],SB.prototype,"onTap",null);class xB{constructor(t,i,e){this.owner=t,this.debugNameSource=i,this.referenceFn=e}getDebugName(t){return function(t,i){var e;const s=EB.get(t);if(s)return s;const n=function(t,i){const e=EB.get(t);if(e)return e;const s=i.owner?function(t){var i;const e=MB.get(t);if(e)return e;const s=function(t){const i=t.constructor;return i?i.name:"Object"}(t);let n=(i=AB.get(s))!==null&&i!==void 0?i:0;n++,AB.set(s,n);const r=n===1?s:`${s}#${n}`;return MB.set(t,r),r}(i.owner)+".":"";let n;const r=i.debugNameSource;if(r!==void 0){if(typeof r!="function")return s+r;if(n=r(),n!==void 0)return s+n}const o=i.referenceFn;if(o!==void 0&&(n=LB(o),n!==void 0))return s+n;if(i.owner!==void 0){const e=function(t,i){for(const e in t)if(t[e]===i)return e}(i.owner,t);if(e!==void 0)return s+e}}(t,i);if(n){let i=(e=DB.get(n))!==null&&e!==void 0?e:0;i++,DB.set(n,i);const s=i===1?n:`${n}#${i}`;return EB.set(t,s),s}}(t,this)}}const DB=new Map,EB=new WeakMap,AB=new Map,MB=new WeakMap;function LB(t){const i=t.toString(),e=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(i),s=e?e[1]:void 0;return s==null?void 0:s.trim()}let FB,TB,RB;class OB{get TChange(){return null}reportChanges(){this.get()}read(t){return t?t.readObservable(this):this.get()}map(t,i){const e=i===void 0?void 0:t,s=i===void 0?t:i;return TB({owner:e,debugName:()=>{const t=LB(s);if(t!==void 0)return t;const i=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(s.toString());return i?`${this.debugName}.${i[2]}`:e?void 0:`${this.debugName} (mapped)`}},(t=>s(this.read(t),t)))}recomputeInitiallyAndOnChange(t,i){return t.add(FB(this,i)),this}}class IB extends OB{constructor(){super(...arguments),this.observers=new Set}addObserver(t){const i=this.observers.size;this.observers.add(t),i===0&&this.onFirstObserverAdded()}removeObserver(t){this.observers.delete(t)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}}function _B(t,i){const e=new BB(t,i);try{t(e)}finally{e.finish()}}function PB(t){if(RB)t(RB);else{const i=new BB(t,void 0);RB=i;try{t(i)}finally{i.finish(),RB=void 0}}}function NB(t,i,e){t?i(t):_B(i,e)}class BB{constructor(t,i){var e;this._fn=t,this._getDebugName=i,this.updatingObservers=[],(e=void 0)===null||e===void 0||e.handleBeginTransaction(this)}getDebugName(){return this._getDebugName?this._getDebugName():LB(this._fn)}updateObserver(t,i){this.updatingObservers.push({observer:t,observable:i}),t.beginUpdate(i)}finish(){var t;const i=this.updatingObservers;for(let t=0;t<i.length;t++){const{observer:e,observable:s}=i[t];e.endUpdate(s)}this.updatingObservers=null,(t=void 0)===null||t===void 0||t.handleEndTransaction()}}function $B(t,i){return typeof t=="string"?new WB(void 0,t,i):new WB(t,void 0,i)}class WB extends IB{get debugName(){var t;return(t=new xB(this._owner,this._debugName,void 0).getDebugName(this))!==null&&t!==void 0?t:"ObservableValue"}constructor(t,i,e){super(),this._owner=t,this._debugName=i,this._value=e}get(){return this._value}set(t,i,e){var s;if(this._value===t)return;let n;i||(i=n=new BB((()=>{}),(()=>`Setting ${this.debugName}`)));try{const n=this._value;this._setValue(t),(s=void 0)===null||s===void 0||s.handleObservableChanged(this,{oldValue:n,newValue:t,change:e,didChange:!0,hadValue:!0});for(const t of this.observers)i.updateObserver(t,this),t.handleChange(this,e)}finally{n&&n.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(t){this._value=t}}function jB(t,i){return typeof t=="string"?new HB(void 0,t,i):new HB(t,void 0,i)}class HB extends WB{_setValue(t){this._value!==t&&(this._value&&this._value.dispose(),this._value=t)}dispose(){var t;(t=this._value)===null||t===void 0||t.dispose()}}const VB=(t,i)=>t===i;function zB(t,i){return i!==void 0?new GB(new xB(t,void 0,i),i,void 0,void 0,void 0,VB):new GB(new xB(void 0,void 0,t),t,void 0,void 0,void 0,VB)}function UB(t,i){var e;return new GB(new xB(t.owner,t.debugName,t.debugReferenceFn),i,void 0,void 0,t.onLastObserverRemoved,(e=t.equalityComparer)!==null&&e!==void 0?e:VB)}function KB(t,i){let e,s;i===void 0?(e=t,s=void 0):(s=t,e=i);const n=new Ji;return new GB(new xB(s,void 0,e),(t=>(n.clear(),e(t,n))),void 0,void 0,(()=>n.dispose()),VB)}function qB(t,i){let e,s;i===void 0?(e=t,s=void 0):(s=t,e=i);const n=new Ji;return new GB(new xB(s,void 0,e),(t=>{n.clear();const i=e(t);return i&&n.add(i),i}),void 0,void 0,(()=>n.dispose()),VB)}(function(t){TB=t})(UB);class GB extends IB{get debugName(){var t;return(t=this._debugNameData.getDebugName(this))!==null&&t!==void 0?t:"(anonymous)"}constructor(t,i,e,s,n=void 0,r){var o,h;super(),this._debugNameData=t,this._computeFn=i,this.createChangeSummary=e,this._handleChange=s,this._handleLastObserverRemoved=n,this._equalityComparator=r,this.state=0,this.value=void 0,this.updateCount=0,this.dependencies=new Set,this.dependenciesToBeRemoved=new Set,this.changeSummary=void 0,this.changeSummary=(o=this.createChangeSummary)===null||o===void 0?void 0:o.call(this),(h=void 0)===null||h===void 0||h.handleDerivedCreated(this)}onLastObserverRemoved(){var t;this.state=0,this.value=void 0;for(const t of this.dependencies)t.removeObserver(this);this.dependencies.clear(),(t=this._handleLastObserverRemoved)===null||t===void 0||t.call(this)}get(){var t;if(this.observers.size===0){const i=this._computeFn(this,(t=this.createChangeSummary)===null||t===void 0?void 0:t.call(this));return this.onLastObserverRemoved(),i}do{if(this.state===1){for(const t of this.dependencies)if(t.reportChanges(),this.state===2)break}this.state===1&&(this.state=3),this._recomputeIfNeeded()}while(this.state!==3);return this.value}_recomputeIfNeeded(){var t,i;if(this.state===3)return;const e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e;const s=this.state!==0,n=this.value;this.state=3;const r=this.changeSummary;this.changeSummary=(t=this.createChangeSummary)===null||t===void 0?void 0:t.call(this);try{this.value=this._computeFn(this,r)}finally{for(const t of this.dependenciesToBeRemoved)t.removeObserver(this);this.dependenciesToBeRemoved.clear()}const o=s&&!this._equalityComparator(n,this.value);if((i=void 0)===null||i===void 0||i.handleDerivedRecomputed(this,{oldValue:n,newValue:this.value,change:void 0,didChange:o,hadValue:s}),o)for(const t of this.observers)t.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(t){this.updateCount++;const i=this.updateCount===1;if(this.state===3&&(this.state=1,!i))for(const t of this.observers)t.handlePossibleChange(this);if(i)for(const t of this.observers)t.beginUpdate(this)}endUpdate(t){if(this.updateCount--,this.updateCount===0){const t=[...this.observers];for(const i of t)i.endUpdate(this)}ja((()=>this.updateCount>=0))}handlePossibleChange(t){if(this.state===3&&this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)){this.state=1;for(const t of this.observers)t.handlePossibleChange(this)}}handleChange(t,i){if(this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)){const e=!this._handleChange||this._handleChange({changedObservable:t,change:i,didChange:i=>i===t},this.changeSummary),s=this.state===3;if(e&&(this.state===1||s)&&(this.state=2,s))for(const t of this.observers)t.handlePossibleChange(this)}}readObservable(t){t.addObserver(this);const i=t.get();return this.dependencies.add(t),this.dependenciesToBeRemoved.delete(t),i}addObserver(t){const i=!this.observers.has(t)&&this.updateCount>0;super.addObserver(t),i&&t.beginUpdate(this)}removeObserver(t){const i=this.observers.has(t)&&this.updateCount>0;super.removeObserver(t),i&&t.endUpdate(this)}}function ZB(t){return new XB(new xB(void 0,void 0,t),t,void 0,void 0)}function JB(t,i){var e;return new XB(new xB(t.owner,t.debugName,(e=t.debugReferenceFn)!==null&&e!==void 0?e:i),i,void 0,void 0)}function QB(t,i){var e;return new XB(new xB(t.owner,t.debugName,(e=t.debugReferenceFn)!==null&&e!==void 0?e:i),i,t.createEmptyChangeSummary,t.handleChange)}function YB(t){const i=new Ji,e=JB({owner:void 0,debugName:void 0,debugReferenceFn:t},(e=>{i.clear(),t(e,i)}));return Zi((()=>{e.dispose(),i.dispose()}))}class XB{get debugName(){var t;return(t=this._debugNameData.getDebugName(this))!==null&&t!==void 0?t:"(anonymous)"}constructor(t,i,e,s){var n,r;this._debugNameData=t,this._runFn=i,this.createChangeSummary=e,this._handleChange=s,this.state=2,this.updateCount=0,this.disposed=!1,this.dependencies=new Set,this.dependenciesToBeRemoved=new Set,this.changeSummary=(n=this.createChangeSummary)===null||n===void 0?void 0:n.call(this),(r=void 0)===null||r===void 0||r.handleAutorunCreated(this),this._runIfNeeded()}dispose(){this.disposed=!0;for(const t of this.dependencies)t.removeObserver(this);this.dependencies.clear()}_runIfNeeded(){var t,i,e;if(this.state===3)return;const s=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=s,this.state=3;const n=this.disposed;try{if(!n){(t=void 0)===null||t===void 0||t.handleAutorunTriggered(this);const e=this.changeSummary;this.changeSummary=(i=this.createChangeSummary)===null||i===void 0?void 0:i.call(this),this._runFn(this,e)}}finally{n||(e=void 0)===null||e===void 0||e.handleAutorunFinished(this);for(const t of this.dependenciesToBeRemoved)t.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){if(this.updateCount===1)do{if(this.state===1){this.state=3;for(const t of this.dependencies)if(t.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3);this.updateCount--,ja((()=>this.updateCount>=0))}handlePossibleChange(t){this.state===3&&this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)&&(this.state=1)}handleChange(t,i){this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)&&(!this._handleChange||this._handleChange({changedObservable:t,change:i,didChange:i=>i===t},this.changeSummary))&&(this.state=2)}readObservable(t){if(this.disposed)return t.get();t.addObserver(this);const i=t.get();return this.dependencies.add(t),this.dependenciesToBeRemoved.delete(t),i}}function t$(t){return new i$(t)}(function(t){t.Observer=XB})(ZB||(ZB={}));class i$ extends OB{constructor(t){super(),this.value=t}get debugName(){return this.toString()}get(){return this.value}addObserver(t){}removeObserver(t){}toString(){return`Const: ${this.value}`}}function e$(t,i){return new s$(t,i)}class s$ extends IB{constructor(t,i){super(),this.event=t,this._getValue=i,this.hasValue=!1,this.handleEvent=t=>{var i;const e=this._getValue(t),s=this.value,n=!this.hasValue||s!==e;let r=!1;n&&(this.value=e,this.hasValue&&(r=!0,NB(s$.globalTransaction,(t=>{var i;(i=void 0)===null||i===void 0||i.handleFromEventObservableTriggered(this,{oldValue:s,newValue:e,change:void 0,didChange:n,hadValue:this.hasValue});for(const i of this.observers)t.updateObserver(i,this),i.handleChange(this,void 0)}),(()=>{const t=this.getDebugName();return"Event fired"+(t?`: ${t}`:"")}))),this.hasValue=!0),r||(i=void 0)===null||i===void 0||i.handleFromEventObservableTriggered(this,{oldValue:s,newValue:e,change:void 0,didChange:n,hadValue:this.hasValue})}}getDebugName(){return LB(this._getValue)}get debugName(){const t=this.getDebugName();return"From Event"+(t?`: ${t}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this._getValue(void 0)}}function n$(t,i){return new r$(t,i)}(function(t){t.Observer=s$,t.batchEventsGlobally=function(t,i){let e=!1;s$.globalTransaction===void 0&&(s$.globalTransaction=t,e=!0);try{i()}finally{e&&(s$.globalTransaction=void 0)}}})(e$||(e$={}));class r$ extends IB{constructor(t,i){super(),this.debugName=t,this.event=i,this.handleEvent=()=>{_B((t=>{for(const i of this.observers)t.updateObserver(i,this),i.handleChange(this,void 0)}),(()=>this.debugName))}}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0}get(){}}function o$(t){return typeof t=="string"?new h$(t):new h$(void 0,t)}class h$ extends IB{get debugName(){var t;return(t=new xB(this._owner,this._debugName,void 0).getDebugName(this))!==null&&t!==void 0?t:"Observable Signal"}constructor(t,i){super(),this._debugName=t,this._owner=i}trigger(t,i){if(t)for(const e of this.observers)t.updateObserver(e,this),e.handleChange(this,i);else _B((t=>{this.trigger(t,i)}),(()=>`Trigger signal ${this.debugName}`))}get(){}}function c$(t,i){const e=new l$(!0,i);return t.addObserver(e),i?i(t.get()):t.reportChanges(),Zi((()=>{t.removeObserver(e)}))}(function(t){FB=t})(c$);class l${constructor(t,i){this._forceRecompute=t,this._handleValue=i,this._counter=0}beginUpdate(t){this._counter++}endUpdate(t){this._counter--,this._counter===0&&this._forceRecompute&&(this._handleValue?this._handleValue(t.get()):t.reportChanges())}handlePossibleChange(t){}handleChange(t,i){}}class a${constructor(t,i){this._map=t,this._keySelector=i,this._cache=new Map,this._items=[]}dispose(){this._cache.forEach((t=>t.store.dispose())),this._cache.clear()}setItems(t){const i=[],e=new Set(this._cache.keys());for(const s of t){const t=this._keySelector?this._keySelector(s):s;let n=this._cache.get(t);if(n)e.delete(t);else{const i=new Ji;n={out:this._map(s,i),store:i},this._cache.set(t,n)}i.push(n.out)}for(const t of e)this._cache.get(t).store.dispose(),this._cache.delete(t);this._items=i}getItems(){return this._items}}var u$=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o};class d${constructor(t){this.trait=t,this.renderedElements=[]}get templateId(){return`template:${this.trait.name}`}renderTemplate(t){return t}renderElement(t,i,e){const s=this.renderedElements.findIndex((t=>t.templateData===e));if(s>=0){const t=this.renderedElements[s];this.trait.unrender(e),t.index=i}else{const t={index:i,templateData:e};this.renderedElements.push(t)}this.trait.renderIndex(i,e)}splice(t,i,e){const s=[];for(const n of this.renderedElements)n.index<t?s.push(n):n.index>=t+i&&s.push({index:n.index+e-i,templateData:n.templateData});this.renderedElements=s}renderIndexes(t){for(const{index:i,templateData:e}of this.renderedElements)t.indexOf(i)>-1&&this.trait.renderIndex(i,e)}disposeTemplate(t){const i=this.renderedElements.findIndex((i=>i.templateData===t));i<0||this.renderedElements.splice(i,1)}}let f$=class{get name(){return this._trait}get renderer(){return new d$(this)}constructor(t){this._trait=t,this.indexes=[],this.sortedIndexes=[],this._onChange=new le,this.onChange=this._onChange.event}splice(t,i,e){const s=e.length-i,n=t+i,r=[];let o=0;for(;o<this.sortedIndexes.length&&this.sortedIndexes[o]<t;)r.push(this.sortedIndexes[o++]);for(let i=0;i<e.length;i++)e[i]&&r.push(i+t);for(;o<this.sortedIndexes.length&&this.sortedIndexes[o]>=n;)r.push(this.sortedIndexes[o++]+s);this.renderer.splice(t,i,e.length),this._set(r,r)}renderIndex(t,i){i.classList.toggle(this._trait,this.contains(t))}unrender(t){t.classList.remove(this._trait)}set(t,i){return this._set(t,[...t].sort(P$),i)}_set(t,i,e){const s=this.indexes,n=this.sortedIndexes;this.indexes=t,this.sortedIndexes=i;const r=_$(n,t);return this.renderer.renderIndexes(r),this._onChange.fire({indexes:t,browserEvent:e}),s}get(){return this.indexes}contains(t){return r(this.sortedIndexes,t,P$)>=0}dispose(){qi(this._onChange)}};u$([Nk],f$.prototype,"renderer",null);class g$ extends f${constructor(t){super("selected"),this.setAriaSelected=t}renderIndex(t,i){super.renderIndex(t,i),this.setAriaSelected&&(this.contains(t)?i.setAttribute("aria-selected","true"):i.setAttribute("aria-selected","false"))}}class p${constructor(t,i,e){this.trait=t,this.view=i,this.identityProvider=e}splice(t,i,e){if(!this.identityProvider)return this.trait.splice(t,i,new Array(e.length).fill(!1));const s=this.trait.get().map((t=>this.identityProvider.getId(this.view.element(t)).toString()));if(s.length===0)return this.trait.splice(t,i,new Array(e.length).fill(!1));const n=new Set(s),r=e.map((t=>n.has(this.identityProvider.getId(t).toString())));this.trait.splice(t,i,r)}}function m$(t){return t.tagName==="INPUT"||t.tagName==="TEXTAREA"}function w$(t,i){return!!t.classList.contains(i)||!t.classList.contains("monaco-list")&&!!t.parentElement&&w$(t.parentElement,i)}function v$(t){return w$(t,"monaco-editor")}function b$(t){return w$(t,"monaco-tree-sticky-row")}function y$(t){return t.classList.contains("monaco-tree-sticky-container")}function k$(t){return!!(t.tagName==="A"&&t.classList.contains("monaco-button")||t.tagName==="DIV"&&t.classList.contains("monaco-button-dropdown"))||!t.classList.contains("monaco-list")&&!!t.parentElement&&k$(t.parentElement)}class C${get onKeyDown(){return ne.chain(this.disposables.add(new uC(this.view.domNode,"keydown")).event,(t=>t.filter((t=>!m$(t.target))).map((t=>new so(t)))))}constructor(t,i,e){this.list=t,this.view=i,this.disposables=new Ji,this.multipleSelectionDisposables=new Ji,this.multipleSelectionSupport=e.multipleSelectionSupport,this.disposables.add(this.onKeyDown((t=>{switch(t.keyCode){case 3:return this.onEnter(t);case 16:return this.onUpArrow(t);case 18:return this.onDownArrow(t);case 11:return this.onPageUpArrow(t);case 12:return this.onPageDownArrow(t);case 9:return this.onEscape(t);case 31:this.multipleSelectionSupport&&(bt?t.metaKey:t.ctrlKey)&&this.onCtrlA(t)}})))}updateOptions(t){t.multipleSelectionSupport!==void 0&&(this.multipleSelectionSupport=t.multipleSelectionSupport)}onEnter(t){t.preventDefault(),t.stopPropagation(),this.list.setSelection(this.list.getFocus(),t.browserEvent)}onUpArrow(t){t.preventDefault(),t.stopPropagation(),this.list.focusPrevious(1,!1,t.browserEvent);const i=this.list.getFocus()[0];this.list.setAnchor(i),this.list.reveal(i),this.view.domNode.focus()}onDownArrow(t){t.preventDefault(),t.stopPropagation(),this.list.focusNext(1,!1,t.browserEvent);const i=this.list.getFocus()[0];this.list.setAnchor(i),this.list.reveal(i),this.view.domNode.focus()}onPageUpArrow(t){t.preventDefault(),t.stopPropagation(),this.list.focusPreviousPage(t.browserEvent);const i=this.list.getFocus()[0];this.list.setAnchor(i),this.list.reveal(i),this.view.domNode.focus()}onPageDownArrow(t){t.preventDefault(),t.stopPropagation(),this.list.focusNextPage(t.browserEvent);const i=this.list.getFocus()[0];this.list.setAnchor(i),this.list.reveal(i),this.view.domNode.focus()}onCtrlA(t){t.preventDefault(),t.stopPropagation(),this.list.setSelection(m(this.list.length),t.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus()}onEscape(t){this.list.getSelection().length&&(t.preventDefault(),t.stopPropagation(),this.list.setSelection([],t.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}}var S$,x$;u$([Nk],C$.prototype,"onKeyDown",null),function(t){t[t.Automatic=0]="Automatic",t[t.Trigger=1]="Trigger"}(S$||(S$={})),function(t){t[t.Idle=0]="Idle",t[t.Typing=1]="Typing"}(x$||(x$={}));const D$=new class{mightProducePrintableCharacter(t){return!(t.ctrlKey||t.metaKey||t.altKey)&&(t.keyCode>=31&&t.keyCode<=56||t.keyCode>=21&&t.keyCode<=30||t.keyCode>=98&&t.keyCode<=107||t.keyCode>=85&&t.keyCode<=95)}};class E${constructor(t,i,e,s,n){this.list=t,this.view=i,this.keyboardNavigationLabelProvider=e,this.keyboardNavigationEventFilter=s,this.delegate=n,this.enabled=!1,this.state=x$.Idle,this.mode=S$.Automatic,this.triggered=!1,this.previouslyFocused=-1,this.enabledDisposables=new Ji,this.disposables=new Ji,this.updateOptions(t.options)}updateOptions(t){var i,e;(i=t.typeNavigationEnabled)===null||i===void 0||i?this.enable():this.disable(),this.mode=(e=t.typeNavigationMode)!==null&&e!==void 0?e:S$.Automatic}enable(){if(this.enabled)return;let t=!1;const i=ne.chain(this.enabledDisposables.add(new uC(this.view.domNode,"keydown")).event,(i=>i.filter((t=>!m$(t.target))).filter((()=>this.mode===S$.Automatic||this.triggered)).map((t=>new so(t))).filter((i=>t||this.keyboardNavigationEventFilter(i))).filter((t=>this.delegate.mightProducePrintableCharacter(t))).forEach((t=>Zc(t,!0))).map((t=>t.browserEvent.key)))),e=ne.debounce(i,(()=>null),800,void 0,void 0,void 0,this.enabledDisposables);ne.reduce(ne.any(i,e),((t,i)=>i===null?null:(t||"")+i),void 0,this.enabledDisposables)(this.onInput,this,this.enabledDisposables),e(this.onClear,this,this.enabledDisposables),i((()=>t=!0),void 0,this.enabledDisposables),e((()=>t=!1),void 0,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){var t;const i=this.list.getFocus();if(i.length>0&&i[0]===this.previouslyFocused){const e=(t=this.list.options.accessibilityProvider)===null||t===void 0?void 0:t.getAriaLabel(this.list.element(i[0]));typeof e=="string"?rw(e):e&&rw(e.get())}this.previouslyFocused=-1}onInput(t){if(!t)return this.state=x$.Idle,void(this.triggered=!1);const i=this.list.getFocus(),e=i.length>0?i[0]:0,s=this.state===x$.Idle?1:0;this.state=x$.Typing;for(let i=0;i<this.list.length;i++){const n=(e+i+s)%this.list.length,r=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(n)),o=r&&r.toString();if(this.list.options.typeNavigationEnabled){if(o!==void 0){if(FI(t,o))return this.previouslyFocused=e,this.list.setFocus([n]),void this.list.reveal(n);const i=i_(t,o);if(i&&i[0].end-i[0].start>1&&i.length===1)return this.previouslyFocused=e,this.list.setFocus([n]),void this.list.reveal(n)}}else if(o===void 0||FI(t,o))return this.previouslyFocused=e,this.list.setFocus([n]),void this.list.reveal(n)}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}}class A${constructor(t,i){this.list=t,this.view=i,this.disposables=new Ji;const e=ne.chain(this.disposables.add(new uC(i.domNode,"keydown")).event,(t=>t.filter((t=>!m$(t.target))).map((t=>new so(t)))));ne.chain(e,(t=>t.filter((t=>!(t.keyCode!==2||t.ctrlKey||t.metaKey||t.shiftKey||t.altKey)))))(this.onTab,this,this.disposables)}onTab(t){if(t.target!==this.view.domNode)return;const i=this.list.getFocus();if(i.length===0)return;const e=this.view.domElement(i[0]);if(!e)return;const s=e.querySelector("[tabIndex]");if(!(s&&s instanceof HTMLElement&&s.tabIndex!==-1))return;const n=Uh(s).getComputedStyle(s);n.visibility!=="hidden"&&n.display!=="none"&&(t.preventDefault(),t.stopPropagation(),s.focus())}dispose(){this.disposables.dispose()}}function M$(t){return bt?t.browserEvent.metaKey:t.browserEvent.ctrlKey}function L$(t){return t.browserEvent.shiftKey}const F$={isSelectionSingleChangeEvent:M$,isSelectionRangeChangeEvent:L$};class T${constructor(t){this.list=t,this.disposables=new Ji,this._onPointer=new le,this.onPointer=this._onPointer.event,t.options.multipleSelectionSupport!==!1&&(this.multipleSelectionController=this.list.options.multipleSelectionController||F$),this.mouseSupport=t.options.mouseSupport===void 0||!!t.options.mouseSupport,this.mouseSupport&&(t.onMouseDown(this.onMouseDown,this,this.disposables),t.onContextMenu(this.onContextMenu,this,this.disposables),t.onMouseDblClick(this.onDoubleClick,this,this.disposables),t.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add(Wk.addTarget(t.getHTMLElement()))),ne.any(t.onMouseClick,t.onMouseMiddleClick,t.onTap)(this.onViewPointer,this,this.disposables)}updateOptions(t){t.multipleSelectionSupport!==void 0&&(this.multipleSelectionController=void 0,t.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||F$))}isSelectionSingleChangeEvent(t){return!!this.multipleSelectionController&&this.multipleSelectionController.isSelectionSingleChangeEvent(t)}isSelectionRangeChangeEvent(t){return!!this.multipleSelectionController&&this.multipleSelectionController.isSelectionRangeChangeEvent(t)}isSelectionChangeEvent(t){return this.isSelectionSingleChangeEvent(t)||this.isSelectionRangeChangeEvent(t)}onMouseDown(t){v$(t.browserEvent.target)||Lc()!==t.browserEvent.target&&this.list.domFocus()}onContextMenu(t){if(m$(t.browserEvent.target)||v$(t.browserEvent.target))return;const i=t.index===void 0?[]:[t.index];this.list.setFocus(i,t.browserEvent)}onViewPointer(t){if(!this.mouseSupport||m$(t.browserEvent.target)||v$(t.browserEvent.target)||t.browserEvent.isHandledByList)return;t.browserEvent.isHandledByList=!0;const i=t.index;return i===void 0?(this.list.setFocus([],t.browserEvent),this.list.setSelection([],t.browserEvent),void this.list.setAnchor(void 0)):this.isSelectionChangeEvent(t)?this.changeSelection(t):(this.list.setFocus([i],t.browserEvent),this.list.setAnchor(i),Uc(e=t.browserEvent)&&e.button===2||this.list.setSelection([i],t.browserEvent),void this._onPointer.fire(t));var e}onDoubleClick(t){if(m$(t.browserEvent.target)||v$(t.browserEvent.target)||this.isSelectionChangeEvent(t)||t.browserEvent.isHandledByList)return;t.browserEvent.isHandledByList=!0;const i=this.list.getFocus();this.list.setSelection(i,t.browserEvent)}changeSelection(t){const i=t.index;let e=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(t)){if(e===void 0){const t=this.list.getFocus()[0];e=t??i,this.list.setAnchor(e)}const s=m(Math.min(e,i),Math.max(e,i)+1),n=this.list.getSelection(),r=function(t,i){const e=t.indexOf(i);if(e===-1)return[];const s=[];let n=e-1;for(;n>=0&&t[n]===i-(e-n);)s.push(t[n--]);for(s.reverse(),n=e;n<t.length&&t[n]===i+(n-e);)s.push(t[n++]);return s}(_$(n,[e]),e);if(r.length===0)return;const o=_$(s,function(t,i){const e=[];let s=0,n=0;for(;s<t.length||n<i.length;)if(s>=t.length)e.push(i[n++]);else if(n>=i.length)e.push(t[s++]);else{if(t[s]===i[n]){s++,n++;continue}t[s]<i[n]?e.push(t[s++]):n++}return e}(n,r));this.list.setSelection(o,t.browserEvent),this.list.setFocus([i],t.browserEvent)}else if(this.isSelectionSingleChangeEvent(t)){const e=this.list.getSelection(),s=e.filter((t=>t!==i));this.list.setFocus([i]),this.list.setAnchor(i),e.length===s.length?this.list.setSelection([...s,i],t.browserEvent):this.list.setSelection(s,t.browserEvent)}}dispose(){this.disposables.dispose()}}class R${constructor(t,i){this.styleElement=t,this.selectorSuffix=i}style(t){var i,e;const s=this.selectorSuffix&&`.${this.selectorSuffix}`,n=[];t.listBackground&&n.push(`.monaco-list${s} .monaco-list-rows { background: ${t.listBackground}; }`),t.listFocusBackground&&(n.push(`.monaco-list${s}:focus .monaco-list-row.focused { background-color: ${t.listFocusBackground}; }`),n.push(`.monaco-list${s}:focus .monaco-list-row.focused:hover { background-color: ${t.listFocusBackground}; }`)),t.listFocusForeground&&n.push(`.monaco-list${s}:focus .monaco-list-row.focused { color: ${t.listFocusForeground}; }`),t.listActiveSelectionBackground&&(n.push(`.monaco-list${s}:focus .monaco-list-row.selected { background-color: ${t.listActiveSelectionBackground}; }`),n.push(`.monaco-list${s}:focus .monaco-list-row.selected:hover { background-color: ${t.listActiveSelectionBackground}; }`)),t.listActiveSelectionForeground&&n.push(`.monaco-list${s}:focus .monaco-list-row.selected { color: ${t.listActiveSelectionForeground}; }`),t.listActiveSelectionIconForeground&&n.push(`.monaco-list${s}:focus .monaco-list-row.selected .codicon { color: ${t.listActiveSelectionIconForeground}; }`),t.listFocusAndSelectionBackground&&n.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${s}:focus .monaco-list-row.selected.focused { background-color: ${t.listFocusAndSelectionBackground}; }\n\t\t\t`),t.listFocusAndSelectionForeground&&n.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${s}:focus .monaco-list-row.selected.focused { color: ${t.listFocusAndSelectionForeground}; }\n\t\t\t`),t.listInactiveFocusForeground&&(n.push(`.monaco-list${s} .monaco-list-row.focused { color:  ${t.listInactiveFocusForeground}; }`),n.push(`.monaco-list${s} .monaco-list-row.focused:hover { color:  ${t.listInactiveFocusForeground}; }`)),t.listInactiveSelectionIconForeground&&n.push(`.monaco-list${s} .monaco-list-row.focused .codicon { color:  ${t.listInactiveSelectionIconForeground}; }`),t.listInactiveFocusBackground&&(n.push(`.monaco-list${s} .monaco-list-row.focused { background-color:  ${t.listInactiveFocusBackground}; }`),n.push(`.monaco-list${s} .monaco-list-row.focused:hover { background-color:  ${t.listInactiveFocusBackground}; }`)),t.listInactiveSelectionBackground&&(n.push(`.monaco-list${s} .monaco-list-row.selected { background-color:  ${t.listInactiveSelectionBackground}; }`),n.push(`.monaco-list${s} .monaco-list-row.selected:hover { background-color:  ${t.listInactiveSelectionBackground}; }`)),t.listInactiveSelectionForeground&&n.push(`.monaco-list${s} .monaco-list-row.selected { color: ${t.listInactiveSelectionForeground}; }`),t.listHoverBackground&&n.push(`.monaco-list${s}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${t.listHoverBackground}; }`),t.listHoverForeground&&n.push(`.monaco-list${s}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${t.listHoverForeground}; }`);const r=ul(t.listFocusAndSelectionOutline,ul(t.listSelectionOutline,(i=t.listFocusOutline)!==null&&i!==void 0?i:""));r&&n.push(`.monaco-list${s}:focus .monaco-list-row.focused.selected { outline: 1px solid ${r}; outline-offset: -1px;}`),t.listFocusOutline&&n.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${s}:focus .monaco-list-row.focused { outline: 1px solid ${t.listFocusOutline}; outline-offset: -1px; }\n\t\t\t\t.monaco-workbench.context-menu-visible .monaco-list${s}.last-focused .monaco-list-row.focused { outline: 1px solid ${t.listFocusOutline}; outline-offset: -1px; }\n\t\t\t`);const o=ul(t.listSelectionOutline,(e=t.listInactiveFocusOutline)!==null&&e!==void 0?e:"");o&&n.push(`.monaco-list${s} .monaco-list-row.focused.selected { outline: 1px dotted ${o}; outline-offset: -1px; }`),t.listSelectionOutline&&n.push(`.monaco-list${s} .monaco-list-row.selected { outline: 1px dotted ${t.listSelectionOutline}; outline-offset: -1px; }`),t.listInactiveFocusOutline&&n.push(`.monaco-list${s} .monaco-list-row.focused { outline: 1px dotted ${t.listInactiveFocusOutline}; outline-offset: -1px; }`),t.listHoverOutline&&n.push(`.monaco-list${s} .monaco-list-row:hover { outline: 1px dashed ${t.listHoverOutline}; outline-offset: -1px; }`),t.listDropOverBackground&&n.push(`\n\t\t\t\t.monaco-list${s}.drop-target,\n\t\t\t\t.monaco-list${s} .monaco-list-rows.drop-target,\n\t\t\t\t.monaco-list${s} .monaco-list-row.drop-target { background-color: ${t.listDropOverBackground} !important; color: inherit !important; }\n\t\t\t`),t.listDropBetweenBackground&&(n.push(`\n\t\t\t.monaco-list${s} .monaco-list-rows.drop-target-before .monaco-list-row:first-child::before,\n\t\t\t.monaco-list${s} .monaco-list-row.drop-target-before::before {\n\t\t\t\tcontent: ""; position: absolute; top: 0px; left: 0px; width: 100%; height: 1px;\n\t\t\t\tbackground-color: ${t.listDropBetweenBackground};\n\t\t\t}`),n.push(`\n\t\t\t.monaco-list${s} .monaco-list-rows.drop-target-after .monaco-list-row:last-child::after,\n\t\t\t.monaco-list${s} .monaco-list-row.drop-target-after::after {\n\t\t\t\tcontent: ""; position: absolute; bottom: 0px; left: 0px; width: 100%; height: 1px;\n\t\t\t\tbackground-color: ${t.listDropBetweenBackground};\n\t\t\t}`)),t.tableColumnsBorder&&n.push(`\n\t\t\t\t.monaco-table > .monaco-split-view2,\n\t\t\t\t.monaco-table > .monaco-split-view2 .monaco-sash.vertical::before,\n\t\t\t\t.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2,\n\t\t\t\t.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {\n\t\t\t\t\tborder-color: ${t.tableColumnsBorder};\n\t\t\t\t}\n\n\t\t\t\t.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2,\n\t\t\t\t.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2 .monaco-sash.vertical::before {\n\t\t\t\t\tborder-color: transparent;\n\t\t\t\t}\n\t\t\t`),t.tableOddRowsBackgroundColor&&n.push(`\n\t\t\t\t.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,\n\t\t\t\t.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,\n\t\t\t\t.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {\n\t\t\t\t\tbackground-color: ${t.tableOddRowsBackgroundColor};\n\t\t\t\t}\n\t\t\t`),this.styleElement.textContent=n.join(`\n`)}}const O$={listFocusBackground:"#7FB0D0",listActiveSelectionBackground:"#0E639C",listActiveSelectionForeground:"#FFFFFF",listActiveSelectionIconForeground:"#FFFFFF",listFocusAndSelectionOutline:"#90C2F9",listFocusAndSelectionBackground:"#094771",listFocusAndSelectionForeground:"#FFFFFF",listInactiveSelectionBackground:"#3F3F46",listInactiveSelectionIconForeground:"#FFFFFF",listHoverBackground:"#2A2D2E",listDropOverBackground:"#383B3D",listDropBetweenBackground:"#EEEEEE",treeIndentGuidesStroke:"#a9a9a9",treeInactiveIndentGuidesStroke:kp.fromHex("#a9a9a9").transparent(.4).toString(),tableColumnsBorder:kp.fromHex("#cccccc").transparent(.2).toString(),tableOddRowsBackgroundColor:kp.fromHex("#cccccc").transparent(.04).toString(),listBackground:void 0,listFocusForeground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusForeground:void 0,listInactiveFocusBackground:void 0,listHoverForeground:void 0,listFocusOutline:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listHoverOutline:void 0},I$={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI:()=>null,onDragStart(){},onDragOver:()=>!1,drop(){},dispose(){}}};function _$(t,i){const e=[];let s=0,n=0;for(;s<t.length||n<i.length;)if(s>=t.length)e.push(i[n++]);else if(n>=i.length)e.push(t[s++]);else{if(t[s]===i[n]){e.push(t[s]),s++,n++;continue}t[s]<i[n]?e.push(t[s++]):e.push(i[n++])}return e}const P$=(t,i)=>t-i;class N${constructor(t,i){this._templateId=t,this.renderers=i}get templateId(){return this._templateId}renderTemplate(t){return this.renderers.map((i=>i.renderTemplate(t)))}renderElement(t,i,e,s){let n=0;for(const r of this.renderers)r.renderElement(t,i,e[n++],s)}disposeElement(t,i,e,s){var n;let r=0;for(const o of this.renderers)(n=o.disposeElement)===null||n===void 0||n.call(o,t,i,e[r],s),r+=1}disposeTemplate(t){let i=0;for(const e of this.renderers)e.disposeTemplate(t[i++])}}class B${constructor(t){this.accessibilityProvider=t,this.templateId="a18n"}renderTemplate(t){return{container:t,disposables:new Ji}}renderElement(t,i,e){const s=this.accessibilityProvider.getAriaLabel(t),n=s&&typeof s!="string"?s:t$(s);e.disposables.add(ZB((t=>{this.setAriaLabel(t.readObservable(n),e.container)})));const r=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(t);typeof r=="number"?e.container.setAttribute("aria-level",`${r}`):e.container.removeAttribute("aria-level")}setAriaLabel(t,i){t?i.setAttribute("aria-label",t):i.removeAttribute("aria-label")}disposeElement(t,i,e,s){e.disposables.clear()}disposeTemplate(t){t.disposables.dispose()}}class $${constructor(t,i){this.list=t,this.dnd=i}getDragElements(t){const i=this.list.getSelectedElements();return i.indexOf(t)>-1?i:[t]}getDragURI(t){return this.dnd.getDragURI(t)}getDragLabel(t,i){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(t,i)}onDragStart(t,i){var e,s;(s=(e=this.dnd).onDragStart)===null||s===void 0||s.call(e,t,i)}onDragOver(t,i,e,s,n){return this.dnd.onDragOver(t,i,e,s,n)}onDragLeave(t,i,e,s){var n,r;(r=(n=this.dnd).onDragLeave)===null||r===void 0||r.call(n,t,i,e,s)}onDragEnd(t){var i,e;(e=(i=this.dnd).onDragEnd)===null||e===void 0||e.call(i,t)}drop(t,i,e,s,n){this.dnd.drop(t,i,e,s,n)}dispose(){this.dnd.dispose()}}class W${get onDidChangeFocus(){return ne.map(this.eventBufferer.wrapEvent(this.focus.onChange),(t=>this.toListEvent(t)),this.disposables)}get onDidChangeSelection(){return ne.map(this.eventBufferer.wrapEvent(this.selection.onChange),(t=>this.toListEvent(t)),this.disposables)}get domId(){return this.view.domId}get onDidScroll(){return this.view.onDidScroll}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseDown(){return this.view.onMouseDown}get onMouseOver(){return this.view.onMouseOver}get onMouseOut(){return this.view.onMouseOut}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let t=!1;const i=ne.chain(this.disposables.add(new uC(this.view.domNode,"keydown")).event,(i=>i.map((t=>new so(t))).filter((i=>t=i.keyCode===58||i.shiftKey&&i.keyCode===68)).map((t=>Zc(t,!0))).filter((()=>!1)))),e=ne.chain(this.disposables.add(new uC(this.view.domNode,"keyup")).event,(i=>i.forEach((()=>t=!1)).map((t=>new so(t))).filter((t=>t.keyCode===58||t.shiftKey&&t.keyCode===68)).map((t=>Zc(t,!0))).map((({browserEvent:t})=>{const i=this.getFocus(),e=i.length?i[0]:void 0;return{index:e,element:e!==void 0?this.view.element(e):void 0,anchor:e!==void 0?this.view.domElement(e):this.view.domNode,browserEvent:t}})))),s=ne.chain(this.view.onContextMenu,(i=>i.filter((i=>!t)).map((({element:t,index:i,browserEvent:e})=>({element:t,index:i,anchor:new ho(Uh(this.view.domNode),e),browserEvent:e})))));return ne.any(i,e,s)}get onKeyDown(){return this.disposables.add(new uC(this.view.domNode,"keydown")).event}get onDidFocus(){return ne.signal(this.disposables.add(new uC(this.view.domNode,"focus",!0)).event)}get onDidBlur(){return ne.signal(this.disposables.add(new uC(this.view.domNode,"blur",!0)).event)}constructor(t,i,e,s,n=I$){var r,o,h,c;this.user=t,this._options=n,this.focus=new f$("focused"),this.anchor=new f$("anchor"),this.eventBufferer=new pe,this._ariaLabel="",this.disposables=new Ji,this._onDidDispose=new le,this.onDidDispose=this._onDidDispose.event;const l=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?(r=this._options.accessibilityProvider)===null||r===void 0?void 0:r.getWidgetRole():"list";this.selection=new g$(l!=="listbox");const a=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=n.accessibilityProvider,this.accessibilityProvider&&(a.push(new B$(this.accessibilityProvider)),(h=(o=this.accessibilityProvider).onDidChangeActiveDescendant)===null||h===void 0||h.call(o,this.onDidChangeActiveDescendant,this,this.disposables)),s=s.map((t=>new N$(t.templateId,[...a,t])));const u={...n,dnd:n.dnd&&new $$(this,n.dnd)};if(this.view=this.createListView(i,e,s,u),this.view.domNode.setAttribute("role",l),n.styleController)this.styleController=n.styleController(this.view.domId);else{const t=Pc(this.view.domNode);this.styleController=new R$(t,this.view.domId)}if(this.spliceable=new aB([new p$(this.focus,this.view,n.identityProvider),new p$(this.selection,this.view,n.identityProvider),new p$(this.anchor,this.view,n.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new A$(this,this.view)),(typeof n.keyboardSupport!="boolean"||n.keyboardSupport)&&(this.keyboardController=new C$(this,this.view,n),this.disposables.add(this.keyboardController)),n.keyboardNavigationLabelProvider){const t=n.keyboardNavigationDelegate||D$;this.typeNavigationController=new E$(this,this.view,n.keyboardNavigationLabelProvider,(c=n.keyboardNavigationEventFilter)!==null&&c!==void 0?c:()=>!0,t),this.disposables.add(this.typeNavigationController)}this.mouseController=this.createMouseController(n),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider&&(this.ariaLabel=this.accessibilityProvider.getWidgetAriaLabel()),this._options.multipleSelectionSupport!==!1&&this.view.domNode.setAttribute("aria-multiselectable","true")}createListView(t,i,e,s){return new SB(t,i,e,s)}createMouseController(t){return new T$(this)}updateOptions(t={}){var i,e;this._options={...this._options,...t},(i=this.typeNavigationController)===null||i===void 0||i.updateOptions(this._options),this._options.multipleSelectionController!==void 0&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(t),(e=this.keyboardController)===null||e===void 0||e.updateOptions(t),this.view.updateOptions(t)}get options(){return this._options}splice(t,i,e=[]){if(t<0||t>this.view.length)throw new uB(this.user,`Invalid start index: ${t}`);if(i<0)throw new uB(this.user,`Invalid delete count: ${i}`);i===0&&e.length===0||this.eventBufferer.bufferEvents((()=>this.spliceable.splice(t,i,e)))}rerender(){this.view.rerender()}element(t){return this.view.element(t)}indexOf(t){return this.view.indexOf(t)}indexAt(t){return this.view.indexAt(t)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get scrollTop(){return this.view.getScrollTop()}set scrollTop(t){this.view.setScrollTop(t)}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleIndex(){return this.view.firstVisibleIndex}get ariaLabel(){return this._ariaLabel}set ariaLabel(t){this._ariaLabel=t,this.view.domNode.setAttribute("aria-label",t)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(t,i){this.view.layout(t,i)}setSelection(t,i){for(const i of t)if(i<0||i>=this.length)throw new uB(this.user,`Invalid index ${i}`);this.selection.set(t,i)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map((t=>this.view.element(t)))}setAnchor(t){if(t!==void 0){if(t<0||t>=this.length)throw new uB(this.user,`Invalid index ${t}`);this.anchor.set([t])}else this.anchor.set([])}getAnchor(){return p(this.anchor.get(),void 0)}getAnchorElement(){const t=this.getAnchor();return t===void 0?void 0:this.element(t)}setFocus(t,i){for(const i of t)if(i<0||i>=this.length)throw new uB(this.user,`Invalid index ${i}`);this.focus.set(t,i)}focusNext(t=1,i=!1,e,s){if(this.length===0)return;const n=this.focus.get(),r=this.findNextIndex(n.length>0?n[0]+t:0,i,s);r>-1&&this.setFocus([r],e)}focusPrevious(t=1,i=!1,e,s){if(this.length===0)return;const n=this.focus.get(),r=this.findPreviousIndex(n.length>0?n[0]-t:0,i,s);r>-1&&this.setFocus([r],e)}async focusNextPage(t,i){let e=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);e=e===0?0:e-1;const s=this.getFocus()[0];if(s!==e&&(s===void 0||e>s)){const n=this.findPreviousIndex(e,!1,i);n>-1&&s!==n?this.setFocus([n],t):this.setFocus([e],t)}else{const n=this.view.getScrollTop();let r=n+this.view.renderHeight;e>s&&(r-=this.view.elementHeight(e)),this.view.setScrollTop(r),this.view.getScrollTop()!==n&&(this.setFocus([]),await wo(0),await this.focusNextPage(t,i))}}async focusPreviousPage(t,i,e=(()=>0)){let s;const n=e(),r=this.view.getScrollTop()+n;s=r===0?this.view.indexAt(r):this.view.indexAfter(r-1);const o=this.getFocus()[0];if(o!==s&&(o===void 0||o>=s)){const e=this.findNextIndex(s,!1,i);e>-1&&o!==e?this.setFocus([e],t):this.setFocus([s],t)}else{const s=r;this.view.setScrollTop(r-this.view.renderHeight-n),this.view.getScrollTop()+e()!==s&&(this.setFocus([]),await wo(0),await this.focusPreviousPage(t,i,e))}}focusLast(t,i){if(this.length===0)return;const e=this.findPreviousIndex(this.length-1,!1,i);e>-1&&this.setFocus([e],t)}focusFirst(t,i){this.focusNth(0,t,i)}focusNth(t,i,e){if(this.length===0)return;const s=this.findNextIndex(t,!1,e);s>-1&&this.setFocus([s],i)}findNextIndex(t,i=!1,e){for(let s=0;s<this.length;s++){if(t>=this.length&&!i)return-1;if(t%=this.length,!e||e(this.element(t)))return t;t++}return-1}findPreviousIndex(t,i=!1,e){for(let s=0;s<this.length;s++){if(t<0&&!i)return-1;if(t=(this.length+t%this.length)%this.length,!e||e(this.element(t)))return t;t--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map((t=>this.view.element(t)))}reveal(t,i,e=0){if(t<0||t>=this.length)throw new uB(this.user,`Invalid index ${t}`);const s=this.view.getScrollTop(),n=this.view.elementTop(t),r=this.view.elementHeight(t);if(_(i)){const t=r-this.view.renderHeight+e;this.view.setScrollTop(t*sO(i,0,1)+n-e)}else{const t=n+r,i=s+this.view.renderHeight;n<s+e&&t>=i||(n<s+e||t>=i&&r>=this.view.renderHeight?this.view.setScrollTop(n-e):t>=i&&this.view.setScrollTop(t-this.view.renderHeight))}}getRelativeTop(t,i=0){if(t<0||t>=this.length)throw new uB(this.user,`Invalid index ${t}`);const e=this.view.getScrollTop(),s=this.view.elementTop(t),n=this.view.elementHeight(t);if(s<e+i||s+n>e+this.view.renderHeight)return null;const r=n-this.view.renderHeight+i;return Math.abs((e+i-s)/r)}getHTMLElement(){return this.view.domNode}getScrollableElement(){return this.view.scrollableElementDomNode}getElementID(t){return this.view.getElementDomId(t)}getElementTop(t){return this.view.elementTop(t)}style(t){this.styleController.style(t)}toListEvent({indexes:t,browserEvent:i}){return{indexes:t,elements:t.map((t=>this.view.element(t))),browserEvent:i}}_onFocusChange(){const t=this.focus.get();this.view.domNode.classList.toggle("element-focused",t.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){var t;const i=this.focus.get();if(i.length>0){let e;!((t=this.accessibilityProvider)===null||t===void 0)&&t.getActiveDescendantId&&(e=this.accessibilityProvider.getActiveDescendantId(this.view.element(i[0]))),this.view.domNode.setAttribute("aria-activedescendant",e||this.view.getElementDomId(i[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){const t=this.selection.get();this.view.domNode.classList.toggle("selection-none",t.length===0),this.view.domNode.classList.toggle("selection-single",t.length===1),this.view.domNode.classList.toggle("selection-multiple",t.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}}u$([Nk],W$.prototype,"onDidChangeFocus",null),u$([Nk],W$.prototype,"onDidChangeSelection",null),u$([Nk],W$.prototype,"onContextMenu",null),u$([Nk],W$.prototype,"onKeyDown",null),u$([Nk],W$.prototype,"onDidFocus",null),u$([Nk],W$.prototype,"onDidBlur",null);const j$=nl,H$="selectOption.entry.template";class V${get templateId(){return H$}renderTemplate(t){const i=Object.create(null);return i.root=t,i.text=Yc(t,j$(".option-text")),i.detail=Yc(t,j$(".option-detail")),i.decoratorRight=Yc(t,j$(".option-decorator-right")),i}renderElement(t,i,e){const s=e,n=t.text,r=t.detail,o=t.decoratorRight,h=t.isDisabled;s.text.textContent=n,s.detail.textContent=r||"",s.decoratorRight.innerText=o||"",h?s.root.classList.add("option-disabled"):s.root.classList.remove("option-disabled")}disposeTemplate(t){}}class z$ extends Qi{constructor(t,i,e,s,n){super(),this.options=[],this._currentSelection=0,this._hasDetails=!1,this._skipLayout=!1,this._sticky=!1,this._isVisible=!1,this.styles=s,this.selectBoxOptions=n||Object.create(null),typeof this.selectBoxOptions.minBottomMargin!="number"?this.selectBoxOptions.minBottomMargin=z$.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN:this.selectBoxOptions.minBottomMargin<0&&(this.selectBoxOptions.minBottomMargin=0),this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box monaco-select-box-dropdown-padding",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=new le,this._register(this._onDidSelect),this.registerListeners(),this.constructSelectDropDown(e),this.selected=i||0,t&&this.setOptions(t,i),this.initStyleSheet()}setTitle(t){!this._hover&&t?this._hover=this._register(lB(rB("mouse"),this.selectElement,t)):this._hover&&this._hover.update(t)}getHeight(){return 22}getTemplateId(){return H$}constructSelectDropDown(t){this.contextViewProvider=t,this.selectDropDownContainer=nl(".monaco-select-box-dropdown-container"),this.selectDropDownContainer.classList.add("monaco-select-box-dropdown-padding"),this.selectionDetailsPane=Yc(this.selectDropDownContainer,j$(".select-box-details-pane"));const i=Yc(this.selectDropDownContainer,j$(".select-box-dropdown-container-width-control")),e=Yc(i,j$(".width-control-div"));this.widthControlElement=document.createElement("span"),this.widthControlElement.className="option-text-width-control",Yc(e,this.widthControlElement),this._dropDownPosition=0,this.styleElement=Pc(this.selectDropDownContainer),this.selectDropDownContainer.setAttribute("draggable","true"),this._register(sc(this.selectDropDownContainer,qc.DRAG_START,(t=>{Zc(t,!0)})))}registerListeners(){let t;this._register(rc(this.selectElement,"change",(t=>{this.selected=t.target.selectedIndex,this._onDidSelect.fire({index:t.target.selectedIndex,selected:t.target.value}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)}))),this._register(sc(this.selectElement,qc.CLICK,(t=>{Zc(t),this._isVisible?this.hideSelectDropDown(!0):this.showSelectDropDown()}))),this._register(sc(this.selectElement,qc.MOUSE_DOWN,(t=>{Zc(t)}))),this._register(sc(this.selectElement,"touchstart",(i=>{t=this._isVisible}))),this._register(sc(this.selectElement,"touchend",(i=>{Zc(i),t?this.hideSelectDropDown(!0):this.showSelectDropDown()}))),this._register(sc(this.selectElement,qc.KEY_DOWN,(t=>{const i=new so(t);let e=!1;bt?i.keyCode!==18&&i.keyCode!==16&&i.keyCode!==10&&i.keyCode!==3||(e=!0):(i.keyCode===18&&i.altKey||i.keyCode===16&&i.altKey||i.keyCode===10||i.keyCode===3)&&(e=!0),e&&(this.showSelectDropDown(),Zc(t,!0))})))}get onDidSelect(){return this._onDidSelect.event}setOptions(t,i){n(this.options,t)||(this.options=t,this.selectElement.options.length=0,this._hasDetails=!1,this._cachedMaxDetailsHeight=void 0,this.options.forEach(((t,i)=>{this.selectElement.add(this.createOption(t.text,i,t.isDisabled)),typeof t.description=="string"&&(this._hasDetails=!0)}))),i!==void 0&&(this.select(i),this._currentSelection=this.selected)}setOptionsList(){var t;(t=this.selectList)===null||t===void 0||t.splice(0,this.selectList.length,this.options)}select(t){t>=0&&t<this.options.length?this.selected=t:t>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(t){this.selectElement.tabIndex=t?0:-1}render(t){this.container=t,t.classList.add("select-container"),t.appendChild(this.selectElement),this.styleSelectElement()}initStyleSheet(){const t=[];this.styles.listFocusBackground&&t.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { background-color: ${this.styles.listFocusBackground} !important; }`),this.styles.listFocusForeground&&t.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { color: ${this.styles.listFocusForeground} !important; }`),this.styles.decoratorRightForeground&&t.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.focused) .option-decorator-right { color: ${this.styles.decoratorRightForeground}; }`),this.styles.selectBackground&&this.styles.selectBorder&&this.styles.selectBorder!==this.styles.selectBackground?(t.push(`.monaco-select-box-dropdown-container { border: 1px solid ${this.styles.selectBorder} } `),t.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectBorder} } `),t.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectBorder} } `)):this.styles.selectListBorder&&(t.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectListBorder} } `),t.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectListBorder} } `)),this.styles.listHoverForeground&&t.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { color: ${this.styles.listHoverForeground} !important; }`),this.styles.listHoverBackground&&t.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { background-color: ${this.styles.listHoverBackground} !important; }`),this.styles.listFocusOutline&&t.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { outline: 1.6px dotted ${this.styles.listFocusOutline} !important; outline-offset: -1.6px !important; }`),this.styles.listHoverOutline&&t.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { outline: 1.6px dashed ${this.styles.listHoverOutline} !important; outline-offset: -1.6px !important; }`),t.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled.focused { background-color: transparent !important; color: inherit !important; outline: none !important; }"),t.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled:hover { background-color: transparent !important; color: inherit !important; outline: none !important; }"),this.styleElement.textContent=t.join(`\n`)}styleSelectElement(){var t,i,e;const s=(t=this.styles.selectBackground)!==null&&t!==void 0?t:"",n=(i=this.styles.selectForeground)!==null&&i!==void 0?i:"",r=(e=this.styles.selectBorder)!==null&&e!==void 0?e:"";this.selectElement.style.backgroundColor=s,this.selectElement.style.color=n,this.selectElement.style.borderColor=r}styleList(){var t,i;const e=(t=this.styles.selectBackground)!==null&&t!==void 0?t:"",s=ul(this.styles.selectListBackground,e);this.selectDropDownListContainer.style.backgroundColor=s,this.selectionDetailsPane.style.backgroundColor=s;const n=(i=this.styles.focusBorder)!==null&&i!==void 0?i:"";this.selectDropDownContainer.style.outlineColor=n,this.selectDropDownContainer.style.outlineOffset="-1px",this.selectList.style(this.styles)}createOption(t,i,e){const s=document.createElement("option");return s.value=t,s.text=t,s.disabled=!!e,s}showSelectDropDown(){this.selectionDetailsPane.innerText="",this.contextViewProvider&&!this._isVisible&&(this.createSelectList(this.selectDropDownContainer),this.setOptionsList(),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:t=>this.renderSelectDropDown(t,!0),layout:()=>{this.layoutSelectDropDown()},onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._isVisible=!0,this.hideSelectDropDown(!1),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:t=>this.renderSelectDropDown(t),layout:()=>this.layoutSelectDropDown(),onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._currentSelection=this.selected,this._isVisible=!0,this.selectElement.setAttribute("aria-expanded","true"))}hideSelectDropDown(t){this.contextViewProvider&&this._isVisible&&(this._isVisible=!1,this.selectElement.setAttribute("aria-expanded","false"),t&&this.selectElement.focus(),this.contextViewProvider.hideContextView())}renderSelectDropDown(t,i){return t.appendChild(this.selectDropDownContainer),this.layoutSelectDropDown(i),{dispose:()=>{try{t.removeChild(this.selectDropDownContainer)}catch{}}}}measureMaxDetailsHeight(){let t=0;return this.options.forEach(((i,e)=>{this.updateDetail(e),this.selectionDetailsPane.offsetHeight>t&&(t=this.selectionDetailsPane.offsetHeight)})),t}layoutSelectDropDown(t){if(this._skipLayout)return!1;if(this.selectList){this.selectDropDownContainer.classList.add("visible");const i=Uh(this.selectElement),e=vc(this.selectElement),s=Uh(this.selectElement).getComputedStyle(this.selectElement),n=parseFloat(s.getPropertyValue("--dropdown-padding-top"))+parseFloat(s.getPropertyValue("--dropdown-padding-bottom")),r=i.innerHeight-e.top-e.height-(this.selectBoxOptions.minBottomMargin||0),o=e.top-z$.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN,h=this.selectElement.offsetWidth,c=this.setWidthControlElement(this.widthControlElement),l=Math.max(c,Math.round(h)).toString()+"px";this.selectDropDownContainer.style.width=l,this.selectList.getHTMLElement().style.height="",this.selectList.layout();let a=this.selectList.contentHeight;this._hasDetails&&this._cachedMaxDetailsHeight===void 0&&(this._cachedMaxDetailsHeight=this.measureMaxDetailsHeight());const u=this._hasDetails?this._cachedMaxDetailsHeight:0,d=a+n+u,f=Math.floor((r-n-u)/this.getHeight()),g=Math.floor((o-n-u)/this.getHeight());if(t)return!(e.top+e.height>i.innerHeight-22||e.top<z$.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||f<1&&g<1)&&(f<z$.DEFAULT_MINIMUM_VISIBLE_OPTIONS&&g>f&&this.options.length>f?(this._dropDownPosition=1,this.selectDropDownContainer.removeChild(this.selectDropDownListContainer),this.selectDropDownContainer.removeChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectionDetailsPane.classList.remove("border-top"),this.selectionDetailsPane.classList.add("border-bottom")):(this._dropDownPosition=0,this.selectDropDownContainer.removeChild(this.selectDropDownListContainer),this.selectDropDownContainer.removeChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectionDetailsPane.classList.remove("border-bottom"),this.selectionDetailsPane.classList.add("border-top")),!0);if(e.top+e.height>i.innerHeight-22||e.top<z$.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||this._dropDownPosition===0&&f<1||this._dropDownPosition===1&&g<1)return this.hideSelectDropDown(!0),!1;if(this._dropDownPosition===0){if(this._isVisible&&f+g<1)return this.hideSelectDropDown(!0),!1;d>r&&(a=f*this.getHeight())}else d>o&&(a=g*this.getHeight());return this.selectList.layout(a),this.selectList.domFocus(),this.selectList.length>0&&(this.selectList.setFocus([this.selected||0]),this.selectList.reveal(this.selectList.getFocus()[0]||0)),this._hasDetails?(this.selectList.getHTMLElement().style.height=a+n+"px",this.selectDropDownContainer.style.height=""):this.selectDropDownContainer.style.height=a+n+"px",this.updateDetail(this.selected),this.selectDropDownContainer.style.width=l,this.selectDropDownListContainer.setAttribute("tabindex","0"),this.selectElement.classList.add("synthetic-focus"),this.selectDropDownContainer.classList.add("synthetic-focus"),!0}return!1}setWidthControlElement(t){let i=0;if(t){let e=0,s=0;this.options.forEach(((t,i)=>{const n=t.detail?t.detail.length:0,r=t.decoratorRight?t.decoratorRight.length:0,o=t.text.length+n+r;o>s&&(e=i,s=o)})),t.textContent=this.options[e].text+(this.options[e].decoratorRight?this.options[e].decoratorRight+" ":""),i=yc(t)}return i}createSelectList(t){if(this.selectList)return;this.selectDropDownListContainer=Yc(t,j$(".select-box-dropdown-list-container")),this.listRenderer=new V$,this.selectList=new W$("SelectBoxCustom",this.selectDropDownListContainer,this,[this.listRenderer],{useShadows:!1,verticalScrollMode:3,keyboardSupport:!1,mouseSupport:!1,accessibilityProvider:{getAriaLabel:t=>{let i=t.text;return t.detail&&(i+=`. ${t.detail}`),t.decoratorRight&&(i+=`. ${t.decoratorRight}`),t.description&&(i+=`. ${t.description}`),i},getWidgetAriaLabel:()=>tt(0,"Select Box"),getRole:()=>bt?"":"option",getWidgetRole:()=>"listbox"}}),this.selectBoxOptions.ariaLabel&&(this.selectList.ariaLabel=this.selectBoxOptions.ariaLabel);const i=this._register(new uC(this.selectDropDownListContainer,"keydown")),e=ne.chain(i.event,(t=>t.filter((()=>this.selectList.length>0)).map((t=>new so(t)))));this._register(ne.chain(e,(t=>t.filter((t=>t.keyCode===3))))(this.onEnter,this)),this._register(ne.chain(e,(t=>t.filter((t=>t.keyCode===2))))(this.onEnter,this)),this._register(ne.chain(e,(t=>t.filter((t=>t.keyCode===9))))(this.onEscape,this)),this._register(ne.chain(e,(t=>t.filter((t=>t.keyCode===16))))(this.onUpArrow,this)),this._register(ne.chain(e,(t=>t.filter((t=>t.keyCode===18))))(this.onDownArrow,this)),this._register(ne.chain(e,(t=>t.filter((t=>t.keyCode===12))))(this.onPageDown,this)),this._register(ne.chain(e,(t=>t.filter((t=>t.keyCode===11))))(this.onPageUp,this)),this._register(ne.chain(e,(t=>t.filter((t=>t.keyCode===14))))(this.onHome,this)),this._register(ne.chain(e,(t=>t.filter((t=>t.keyCode===13))))(this.onEnd,this)),this._register(ne.chain(e,(t=>t.filter((t=>t.keyCode>=21&&t.keyCode<=56||t.keyCode>=85&&t.keyCode<=113))))(this.onCharacter,this)),this._register(sc(this.selectList.getHTMLElement(),qc.POINTER_UP,(t=>this.onPointerUp(t)))),this._register(this.selectList.onMouseOver((t=>t.index!==void 0&&this.selectList.setFocus([t.index])))),this._register(this.selectList.onDidChangeFocus((t=>this.onListFocus(t)))),this._register(sc(this.selectDropDownContainer,qc.FOCUS_OUT,(t=>{this._isVisible&&!xc(t.relatedTarget,this.selectDropDownContainer)&&this.onListBlur()}))),this.selectList.getHTMLElement().setAttribute("aria-label",this.selectBoxOptions.ariaLabel||""),this.selectList.getHTMLElement().setAttribute("aria-expanded","true"),this.styleList()}onPointerUp(t){if(!this.selectList.length)return;Zc(t);const i=t.target;if(!i||i.classList.contains("slider"))return;const e=i.closest(".monaco-list-row");if(!e)return;const s=Number(e.getAttribute("data-index")),n=e.classList.contains("option-disabled");s>=0&&s<this.options.length&&!n&&(this.selected=s,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0))}onListBlur(){this._sticky||(this.selected!==this._currentSelection&&this.select(this._currentSelection),this.hideSelectDropDown(!1))}renderDescriptionMarkdown(t,i){const e=t=>{for(let i=0;i<t.childNodes.length;i++){const s=t.childNodes.item(i);(s.tagName&&s.tagName.toLowerCase())==="img"?t.removeChild(s):e(s)}},s=V_({value:t,supportThemeIcons:!0},{actionHandler:i});return s.element.classList.add("select-box-description-markdown"),e(s.element),s.element}onListFocus(t){this._isVisible&&this._hasDetails&&this.updateDetail(t.indexes[0])}updateDetail(t){var i,e;this.selectionDetailsPane.innerText="";const s=this.options[t],n=(i=s==null?void 0:s.description)!==null&&i!==void 0?i:"",r=(e=s==null?void 0:s.descriptionIsMarkdown)!==null&&e!==void 0&&e;if(n){if(r){const t=s.descriptionMarkdownActionHandler;this.selectionDetailsPane.appendChild(this.renderDescriptionMarkdown(n,t))}else this.selectionDetailsPane.innerText=n;this.selectionDetailsPane.style.display="block"}else this.selectionDetailsPane.style.display="none";this._skipLayout=!0,this.contextViewProvider.layout(),this._skipLayout=!1}onEscape(t){Zc(t),this.select(this._currentSelection),this.hideSelectDropDown(!0)}onEnter(t){Zc(t),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0)}onDownArrow(t){if(this.selected<this.options.length-1){Zc(t,!0);const i=this.options[this.selected+1].isDisabled;if(i&&this.options.length>this.selected+2)this.selected+=2;else{if(i)return;this.selected++}this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0])}}onUpArrow(t){this.selected>0&&(Zc(t,!0),this.options[this.selected-1].isDisabled&&this.selected>1?this.selected-=2:this.selected--,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]))}onPageUp(t){Zc(t),this.selectList.focusPreviousPage(),setTimeout((()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected<this.options.length-1&&(this.selected++,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)}),1)}onPageDown(t){Zc(t),this.selectList.focusNextPage(),setTimeout((()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected>0&&(this.selected--,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)}),1)}onHome(t){Zc(t),this.options.length<2||(this.selected=0,this.options[this.selected].isDisabled&&this.selected>1&&this.selected++,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onEnd(t){Zc(t),this.options.length<2||(this.selected=this.options.length-1,this.options[this.selected].isDisabled&&this.selected>1&&this.selected--,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onCharacter(t){const i=Le.toString(t.keyCode);let e=-1;for(let s=0;s<this.options.length-1;s++)if(e=(s+this.selected+1)%this.options.length,this.options[e].text.charAt(0).toUpperCase()===i&&!this.options[e].isDisabled){this.select(e),this.selectList.setFocus([e]),this.selectList.reveal(this.selectList.getFocus()[0]),Zc(t);break}}dispose(){this.hideSelectDropDown(!1),super.dispose()}}z$.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN=32,z$.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN=2,z$.DEFAULT_MINIMUM_VISIBLE_OPTIONS=3;class U$ extends Qi{constructor(t,i,e,s){super(),this.selected=0,this.selectBoxOptions=s||Object.create(null),this.options=[],this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=this._register(new le),this.styles=e,this.registerListeners(),this.setOptions(t,i)}registerListeners(){this._register(Wk.addTarget(this.selectElement)),[Bk.Tap].forEach((t=>{this._register(sc(this.selectElement,t,(t=>{this.selectElement.focus()})))})),this._register(rc(this.selectElement,"click",(t=>{Zc(t,!0)}))),this._register(rc(this.selectElement,"change",(t=>{this.selectElement.title=t.target.value,this._onDidSelect.fire({index:t.target.selectedIndex,selected:t.target.value})}))),this._register(rc(this.selectElement,"keydown",(t=>{let i=!1;bt?t.keyCode!==18&&t.keyCode!==16&&t.keyCode!==10||(i=!0):(t.keyCode===18&&t.altKey||t.keyCode===10||t.keyCode===3)&&(i=!0),i&&t.stopPropagation()})))}get onDidSelect(){return this._onDidSelect.event}setOptions(t,i){this.options&&n(this.options,t)||(this.options=t,this.selectElement.options.length=0,this.options.forEach(((t,i)=>{this.selectElement.add(this.createOption(t.text,i,t.isDisabled))}))),i!==void 0&&this.select(i)}select(t){this.options.length===0?this.selected=0:t>=0&&t<this.options.length?this.selected=t:t>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.selected<this.options.length&&typeof this.options[this.selected].text=="string"?this.selectElement.title=this.options[this.selected].text:this.selectElement.title=""}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(t){this.selectElement.tabIndex=t?0:-1}render(t){t.classList.add("select-container"),t.appendChild(this.selectElement),this.setOptions(this.options,this.selected),this.applyStyles()}applyStyles(){var t,i,e;this.selectElement&&(this.selectElement.style.backgroundColor=(t=this.styles.selectBackground)!==null&&t!==void 0?t:"",this.selectElement.style.color=(i=this.styles.selectForeground)!==null&&i!==void 0?i:"",this.selectElement.style.borderColor=(e=this.styles.selectBorder)!==null&&e!==void 0?e:"")}createOption(t,i,e){const s=document.createElement("option");return s.value=t,s.text=t,s.disabled=!!e,s}}class K$ extends jk{constructor(t,i,e,s,n){super(),bt&&!(n!=null&&n.useCustomDrawn)?this.selectBoxDelegate=new U$(t,i,s,n):this.selectBoxDelegate=new z$(t,i,e,s,n),this._register(this.selectBoxDelegate)}get onDidSelect(){return this.selectBoxDelegate.onDidSelect}setOptions(t,i){this.selectBoxDelegate.setOptions(t,i)}select(t){this.selectBoxDelegate.select(t)}focus(){this.selectBoxDelegate.focus()}blur(){this.selectBoxDelegate.blur()}setFocusable(t){this.selectBoxDelegate.setFocusable(t)}render(t){this.selectBoxDelegate.render(t)}}class q$ extends Qi{get action(){return this._action}constructor(t,i,e={}){super(),this.options=e,this._context=t||this,this._action=i,i instanceof $l&&this._register(i.onDidChange((t=>{this.element&&this.handleActionChangeEvent(t)})))}handleActionChangeEvent(t){t.enabled!==void 0&&this.updateEnabled(),t.checked!==void 0&&this.updateChecked(),t.class!==void 0&&this.updateClass(),t.label!==void 0&&(this.updateLabel(),this.updateTooltip()),t.tooltip!==void 0&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new Wl)),this._actionRunner}set actionRunner(t){this._actionRunner=t}isEnabled(){return this._action.enabled}setActionContext(t){this._context=t}render(t){const i=this.element=t;this._register(Wk.addTarget(t));const e=this.options&&this.options.draggable;e&&(t.draggable=!0,Hr&&this._register(sc(t,qc.DRAG_START,(t=>{var i;return(i=t.dataTransfer)===null||i===void 0?void 0:i.setData(iB.TEXT,this._action.label)})))),this._register(sc(i,Bk.Tap,(t=>this.onClick(t,!0)))),this._register(sc(i,qc.MOUSE_DOWN,(t=>{e||Zc(t,!0),this._action.enabled&&t.button===0&&i.classList.add("active")}))),bt&&this._register(sc(i,qc.CONTEXT_MENU,(t=>{t.button===0&&t.ctrlKey===!0&&this.onClick(t)}))),this._register(sc(i,qc.CLICK,(t=>{Zc(t,!0),this.options&&this.options.isMenu||this.onClick(t)}))),this._register(sc(i,qc.DBLCLICK,(t=>{Zc(t,!0)}))),[qc.MOUSE_UP,qc.MOUSE_OUT].forEach((t=>{this._register(sc(i,t,(t=>{Zc(t),i.classList.remove("active")})))}))}onClick(t,i=!1){var e;Zc(t,!0);const s=W(this._context)?!((e=this.options)===null||e===void 0)&&e.useEventAsContext?t:{preserveFocus:i}:this._context;this.actionRunner.run(this._action,s)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(t){this.element&&(this.element.tabIndex=t?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}getClass(){return this.action.class}getTooltip(){return this.action.tooltip}updateTooltip(){var t,i,e;if(!this.element)return;const s=(t=this.getTooltip())!==null&&t!==void 0?t:"";if(this.updateAriaLabel(),(i=this.options.hoverDelegate)===null||i===void 0?void 0:i.showNativeHover)this.element.title=s;else if(this.customHover||s==="")this.customHover&&this.customHover.update(s);else{const t=(e=this.options.hoverDelegate)!==null&&e!==void 0?e:rB("element");this.customHover=this._store.add(lB(t,this.element,s))}}updateAriaLabel(){var t;if(this.element){const i=(t=this.getTooltip())!==null&&t!==void 0?t:"";this.element.setAttribute("aria-label",i)}}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),this._context=void 0,super.dispose()}}class G$ extends q${constructor(t,i,e){super(t,i,e),this.options=e,this.options.icon=e.icon!==void 0&&e.icon,this.options.label=e.label===void 0||e.label,this.cssClass=""}render(t){super.render(t),j(this.element);const i=document.createElement("a");if(i.classList.add("action-label"),i.setAttribute("role",this.getDefaultAriaRole()),this.label=i,this.element.appendChild(i),this.options.label&&this.options.keybinding){const t=document.createElement("span");t.classList.add("keybinding"),t.textContent=this.options.keybinding,this.element.appendChild(t)}this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}getDefaultAriaRole(){return this._action.id===jl.ID?"presentation":this.options.isMenu?"menuitem":"button"}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(t){this.label&&(this.label.tabIndex=t?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.action.label)}getTooltip(){let t=null;return this.action.tooltip?t=this.action.tooltip:!this.options.label&&this.action.label&&this.options.icon&&(t=this.action.label,this.options.keybinding&&(t=tt(0,"{0} ({1})",t,this.options.keybinding))),t??void 0}updateClass(){var t;this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.getClass(),this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):(t=this.label)===null||t===void 0||t.classList.remove("codicon")}updateEnabled(){var t,i;this.action.enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),(t=this.element)===null||t===void 0||t.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),(i=this.element)===null||i===void 0||i.classList.add("disabled"))}updateAriaLabel(){var t;if(this.label){const i=(t=this.getTooltip())!==null&&t!==void 0?t:"";this.label.setAttribute("aria-label",i)}}updateChecked(){this.label&&(this.action.checked!==void 0?(this.label.classList.toggle("checked",this.action.checked),this.label.setAttribute("aria-checked",this.action.checked?"true":"false"),this.label.setAttribute("role","checkbox")):(this.label.classList.remove("checked"),this.label.removeAttribute("aria-checked"),this.label.setAttribute("role",this.getDefaultAriaRole())))}}class Z$ extends q${constructor(t,i,e,s,n,r,o){super(t,i),this.selectBox=new K$(e,s,n,r,o),this.selectBox.setFocusable(!1),this._register(this.selectBox),this.registerListeners()}select(t){this.selectBox.select(t)}registerListeners(){this._register(this.selectBox.onDidSelect((t=>this.runAction(t.selected,t.index))))}runAction(t,i){this.actionRunner.run(this._action,this.getActionContext(t,i))}getActionContext(t,i){return t}setFocusable(t){this.selectBox.setFocusable(t)}focus(){var t;(t=this.selectBox)===null||t===void 0||t.focus()}blur(){var t;(t=this.selectBox)===null||t===void 0||t.blur()}render(t){this.selectBox.render(t)}}class J$ extends Wl{constructor(t,i){super(),this._onDidChangeVisibility=this._register(new le),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._element=Yc(t,nl(".monaco-dropdown")),this._label=Yc(this._element,nl(".dropdown-label"));let e=i.labelRenderer;e||(e=t=>(t.textContent=i.label||"",null));for(const t of[qc.CLICK,qc.MOUSE_DOWN,Bk.Tap])this._register(sc(this.element,t,(t=>Zc(t,!0))));for(const t of[qc.MOUSE_DOWN,Bk.Tap])this._register(sc(this._label,t,(t=>{Uc(t)&&(t.detail>1||t.button!==0)||(this.visible?this.hide():this.show())})));this._register(sc(this._label,qc.KEY_UP,(t=>{const i=new so(t);(i.equals(3)||i.equals(10))&&(Zc(t,!0),this.visible?this.hide():this.show())})));const s=e(this._label);s&&this._register(s),this._register(Wk.addTarget(this._label))}get element(){return this._element}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}}class Q$ extends J${constructor(t,i){super(t,i),this._options=i,this._actions=[],this.actions=i.actions||[]}set menuOptions(t){this._menuOptions=t}get menuOptions(){return this._menuOptions}get actions(){return this._options.actionProvider?this._options.actionProvider.getActions():this._actions}set actions(t){this._actions=t}show(){super.show(),this.element.classList.add("active"),this._options.contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:(t,i)=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(t,i):void 0,getKeyBinding:t=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(t):void 0,getMenuClassName:()=>this._options.menuClassName||"",onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this._options.menuAsChild?this.element:void 0,skipTelemetry:this._options.skipTelemetry})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}}class Y$ extends q${constructor(t,i,e,s=Object.create(null)){super(null,t,s),this.actionItem=null,this._onDidChangeVisibility=this._register(new le),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this.menuActionsOrProvider=i,this.contextMenuProvider=e,this.options=s,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(t){this.actionItem=t;const i=Array.isArray(this.menuActionsOrProvider),e={contextMenuProvider:this.contextMenuProvider,labelRenderer:t=>{var i;this.element=Yc(t,nl("a.action-label"));let e=[];return typeof this.options.classNames=="string"?e=this.options.classNames.split(/\s+/g).filter((t=>!!t)):this.options.classNames&&(e=this.options.classNames),e.find((t=>t==="icon"))||e.push("codicon"),this.element.classList.add(...e),this.element.setAttribute("role","button"),this.element.setAttribute("aria-haspopup","true"),this.element.setAttribute("aria-expanded","false"),this._action.label&&this._register(lB((i=this.options.hoverDelegate)!==null&&i!==void 0?i:rB("mouse"),this.element,this._action.label)),this.element.ariaLabel=this._action.label||"",null},menuAsChild:this.options.menuAsChild,actions:i?this.menuActionsOrProvider:void 0,actionProvider:i?void 0:this.menuActionsOrProvider,skipTelemetry:this.options.skipTelemetry};if(this.dropdownMenu=this._register(new Q$(t,e)),this._register(this.dropdownMenu.onDidChangeVisibility((t=>{var i;(i=this.element)===null||i===void 0||i.setAttribute("aria-expanded",`${t}`),this._onDidChangeVisibility.fire(t)}))),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){const t=this;this.dropdownMenu.menuOptions={...this.dropdownMenu.menuOptions,get anchorAlignment(){return t.options.anchorAlignmentProvider()}}}this.updateTooltip(),this.updateEnabled()}getTooltip(){let t=null;return this.action.tooltip?t=this.action.tooltip:this.action.label&&(t=this.action.label),t??void 0}setActionContext(t){super.setActionContext(t),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=t:this.dropdownMenu.menuOptions={context:t})}show(){var t;(t=this.dropdownMenu)===null||t===void 0||t.show()}updateEnabled(){var t,i;const e=!this.action.enabled;(t=this.actionItem)===null||t===void 0||t.classList.toggle("disabled",e),(i=this.element)===null||i===void 0||i.classList.toggle("disabled",e)}}var X$,tW;(function(t){t[t.STORAGE_DOES_NOT_EXIST=0]="STORAGE_DOES_NOT_EXIST",t[t.STORAGE_IN_MEMORY=1]="STORAGE_IN_MEMORY"})(X$||(X$={})),function(t){t[t.None=0]="None",t[t.Initialized=1]="Initialized",t[t.Closed=2]="Closed"}(tW||(tW={}));class iW extends Qi{constructor(t,i=Object.create(null)){super(),this.database=t,this.options=i,this._onDidChangeStorage=this._register(new ue),this.onDidChangeStorage=this._onDidChangeStorage.event,this.state=tW.None,this.cache=new Map,this.flushDelayer=this._register(new mo(iW.DEFAULT_FLUSH_DELAY)),this.pendingDeletes=new Set,this.pendingInserts=new Map,this.whenFlushedCallbacks=[],this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal((t=>this.onDidChangeItemsExternal(t))))}onDidChangeItemsExternal(t){var i,e;this._onDidChangeStorage.pause();try{(i=t.changed)===null||i===void 0||i.forEach(((t,i)=>this.acceptExternal(i,t))),(e=t.deleted)===null||e===void 0||e.forEach((t=>this.acceptExternal(t,void 0)))}finally{this._onDidChangeStorage.resume()}}acceptExternal(t,i){if(this.state===tW.Closed)return;let e=!1;W(i)?e=this.cache.delete(t):this.cache.get(t)!==i&&(this.cache.set(t,i),e=!0),e&&this._onDidChangeStorage.fire({key:t,external:!0})}get(t,i){const e=this.cache.get(t);return W(e)?i:e}getBoolean(t,i){const e=this.get(t);return W(e)?i:e==="true"}getNumber(t,i){const e=this.get(t);return W(e)?i:parseInt(e,10)}async set(t,i,e=!1){if(this.state===tW.Closed)return;if(W(i))return this.delete(t,e);const s=O(i)||Array.isArray(i)?(n=i,JSON.stringify(n,W_)):String(i);var n;return this.cache.get(t)!==s?(this.cache.set(t,s),this.pendingInserts.set(t,s),this.pendingDeletes.delete(t),this._onDidChangeStorage.fire({key:t,external:e}),this.doFlush()):void 0}async delete(t,i=!1){if(this.state!==tW.Closed)return this.cache.delete(t)?(this.pendingDeletes.has(t)||this.pendingDeletes.add(t),this.pendingInserts.delete(t),this._onDidChangeStorage.fire({key:t,external:i}),this.doFlush()):void 0}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}async flushPending(){if(!this.hasPending)return;const t={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(t).finally((()=>{var t;if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)(t=this.whenFlushedCallbacks.pop())===null||t===void 0||t()}))}async doFlush(t){return this.options.hint===X$.STORAGE_IN_MEMORY?this.flushPending():this.flushDelayer.trigger((()=>this.flushPending()),t)}}iW.DEFAULT_FLUSH_DELAY=100;class eW{constructor(){this.onDidChangeItemsExternal=ne.None,this.items=new Map}async updateItems(t){var i,e;(i=t.insert)===null||i===void 0||i.forEach(((t,i)=>this.items.set(i,t))),(e=t.delete)===null||e===void 0||e.forEach((t=>this.items.delete(t)))}}const sW="__$__targetStorageMarker",nW=_l("storageService");var rW;(function(t){t[t.NONE=0]="NONE",t[t.SHUTDOWN=1]="SHUTDOWN"})(rW||(rW={}));class oW extends Qi{constructor(t={flushInterval:oW.DEFAULT_FLUSH_INTERVAL}){super(),this.options=t,this._onDidChangeValue=this._register(new ue),this._onDidChangeTarget=this._register(new ue),this._onWillSaveState=this._register(new le),this.onWillSaveState=this._onWillSaveState.event,this._workspaceKeyTargets=void 0,this._profileKeyTargets=void 0,this._applicationKeyTargets=void 0}onDidChangeValue(t,i,e){return ne.filter(this._onDidChangeValue.event,(e=>e.scope===t&&(i===void 0||e.key===i)),e)}emitDidChangeValue(t,i){const{key:e,external:s}=i;if(e===sW){switch(t){case-1:this._applicationKeyTargets=void 0;break;case 0:this._profileKeyTargets=void 0;break;case 1:this._workspaceKeyTargets=void 0}this._onDidChangeTarget.fire({scope:t})}else this._onDidChangeValue.fire({scope:t,key:e,target:this.getKeyTargets(t)[e],external:s})}get(t,i,e){var s;return(s=this.getStorage(i))===null||s===void 0?void 0:s.get(t,e)}getBoolean(t,i,e){var s;return(s=this.getStorage(i))===null||s===void 0?void 0:s.getBoolean(t,e)}getNumber(t,i,e){var s;return(s=this.getStorage(i))===null||s===void 0?void 0:s.getNumber(t,e)}store(t,i,e,s,n=!1){W(i)?this.remove(t,e,n):this.withPausedEmitters((()=>{var r;this.updateKeyTarget(t,e,s),(r=this.getStorage(e))===null||r===void 0||r.set(t,i,n)}))}remove(t,i,e=!1){this.withPausedEmitters((()=>{var s;this.updateKeyTarget(t,i,void 0),(s=this.getStorage(i))===null||s===void 0||s.delete(t,e)}))}withPausedEmitters(t){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{t()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}updateKeyTarget(t,i,e,s=!1){var n,r;const o=this.getKeyTargets(i);typeof e=="number"?o[t]!==e&&(o[t]=e,(n=this.getStorage(i))===null||n===void 0||n.set(sW,JSON.stringify(o),s)):typeof o[t]=="number"&&(delete o[t],(r=this.getStorage(i))===null||r===void 0||r.set(sW,JSON.stringify(o),s))}get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(0)),this._profileKeyTargets}get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(-1)),this._applicationKeyTargets}getKeyTargets(t){switch(t){case-1:return this.applicationKeyTargets;case 0:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(t){const i=this.getStorage(t);return i?function(t){const i=t.get(sW);if(i)try{return JSON.parse(i)}catch{}return Object.create(null)}(i):Object.create(null)}}oW.DEFAULT_FLUSH_INTERVAL=6e4;const hW={keybindingLabelBackground:Tw(Vb),keybindingLabelForeground:Tw(zb),keybindingLabelBorder:Tw(Ub),keybindingLabelBottomBorder:Tw(Kb),keybindingLabelShadow:Tw($v)},cW={buttonForeground:Tw(Rb),buttonSeparator:Tw(Ob),buttonBackground:Tw(Ib),buttonHoverBackground:Tw(_b),buttonSecondaryForeground:Tw(Nb),buttonSecondaryBackground:Tw(Bb),buttonSecondaryHoverBackground:Tw($b),buttonBorder:Tw(Pb)},lW={progressBarBackground:Tw(ev)},aW={inputActiveOptionBorder:Tw(mb),inputActiveOptionForeground:Tw(vb),inputActiveOptionBackground:Tw(wb)};Tw(Wb),Tw(Hb),Tw(jb),Tw(rv),Tw(ov),Tw($v),Tw(qw),Tw(eb),Tw(sb),Tw(nb),Tw(Zw);const uW={inputBackground:Tw(fb),inputForeground:Tw(gb),inputBorder:Tw(pb),inputValidationInfoBorder:Tw(kb),inputValidationInfoBackground:Tw(bb),inputValidationInfoForeground:Tw(yb),inputValidationWarningBorder:Tw(xb),inputValidationWarningBackground:Tw(Cb),inputValidationWarningForeground:Tw(Sb),inputValidationErrorBorder:Tw(Ab),inputValidationErrorBackground:Tw(Db),inputValidationErrorForeground:Tw(Eb)},dW={listFilterWidgetBackground:Tw(gy),listFilterWidgetOutline:Tw(py),listFilterWidgetNoMatchesOutline:Tw(my),listFilterWidgetShadow:Tw(wy),inputBoxStyles:uW,toggleStyles:aW},fW={badgeBackground:Tw(Jw),badgeForeground:Tw(Qw),badgeBorder:Tw(qw)};Tw(Vv),Tw(Hv),Tw(zv),Tw(zv),Tw(Uv);const gW={listBackground:void 0,listInactiveFocusForeground:void 0,listFocusBackground:Tw(qb),listFocusForeground:Tw(Gb),listFocusOutline:Tw(Zb),listActiveSelectionBackground:Tw(Qb),listActiveSelectionForeground:Tw(Yb),listActiveSelectionIconForeground:Tw(Xb),listFocusAndSelectionOutline:Tw(Jb),listFocusAndSelectionBackground:Tw(Qb),listFocusAndSelectionForeground:Tw(Yb),listInactiveSelectionBackground:Tw(ty),listInactiveSelectionIconForeground:Tw(ey),listInactiveSelectionForeground:Tw(iy),listInactiveFocusBackground:Tw(sy),listInactiveFocusOutline:Tw(ny),listHoverBackground:Tw(ry),listHoverForeground:Tw(oy),listDropOverBackground:Tw(hy),listDropBetweenBackground:Tw(cy),listSelectionOutline:Tw(Gw),listHoverOutline:Tw(Gw),treeIndentGuidesStroke:Tw(vy),treeInactiveIndentGuidesStroke:Tw(by),tableColumnsBorder:Tw(yy),tableOddRowsBackgroundColor:Tw(ky)};function pW(t){return function(t,i){const e={...i};for(const i in t){const s=t[i];e[i]=s!==void 0?Tw(s):void 0}return e}(t,gW)}const mW={selectBackground:Tw(Mb),selectListBackground:Tw(Lb),selectForeground:Tw(Fb),decoratorRightForeground:Tw(Ry),selectBorder:Tw(Tb),focusBorder:Tw(Kw),listFocusBackground:Tw(Ny),listInactiveSelectionIconForeground:Tw(Py),listFocusForeground:Tw(_y),listFocusOutline:(wW=Gw,vW=kp.transparent.toString(),`var(${Fw(wW)}, ${vW})`),listHoverBackground:Tw(ry),listHoverForeground:Tw(oy),listHoverOutline:Tw(Gw),selectListBorder:Tw(hv),listBackground:void 0,listActiveSelectionBackground:void 0,listActiveSelectionForeground:void 0,listActiveSelectionIconForeground:void 0,listFocusAndSelectionBackground:void 0,listDropOverBackground:void 0,listDropBetweenBackground:void 0,listInactiveSelectionBackground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusBackground:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listFocusAndSelectionForeground:void 0,listFocusAndSelectionOutline:void 0,listInactiveFocusForeground:void 0,tableColumnsBorder:void 0,tableOddRowsBackgroundColor:void 0,treeIndentGuidesStroke:void 0,treeInactiveIndentGuidesStroke:void 0};var wW,vW;const bW={shadowColor:Tw($v),borderColor:Tw(Cy),foregroundColor:Tw(Sy),backgroundColor:Tw(xy),selectionForegroundColor:Tw(Dy),selectionBackgroundColor:Tw(Ey),selectionBorderColor:Tw(Ay),separatorColor:Tw(My),scrollbarShadow:Tw(Yw),scrollbarSliderBackground:Tw(Xw),scrollbarSliderHoverBackground:Tw(tv),scrollbarSliderActiveBackground:Tw(iv)};var yW=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},kW=function(t,i){return function(e,s){i(e,s,t)}};function CW(t,i,e,s,n,r){SW(t.getActions(i),e,!1,typeof s=="string"?t=>t===s:s,n,r)}function SW(t,i,e,s=(t=>t==="navigation"),n=(()=>!1),r=!1){let o,h;Array.isArray(i)?(o=i,h=i):(o=i.primary,h=i.secondary);const c=new Set;for(const[i,n]of t){let t;s(i)?(t=o,t.length>0&&r&&t.push(new jl)):(t=h,t.length>0&&t.push(new jl));for(let s of n){e&&(s=s instanceof eu&&s.alt?s.alt:s);const n=t.push(s);s instanceof Hl&&c.add({group:i,action:s,index:n-1})}}for(const{group:t,action:i,index:e}of c){const r=s(t)?o:h,c=i.actions;n(i,t,r.length)&&r.splice(e,1,...c)}}let xW=class extends G${constructor(t,i,e,s,n,r,o,h){super(void 0,t,{icon:!(!t.class&&!t.item.icon),label:!t.class&&!t.item.icon,draggable:i==null?void 0:i.draggable,keybinding:i==null?void 0:i.keybinding,hoverDelegate:i==null?void 0:i.hoverDelegate}),this._keybindingService=e,this._notificationService=s,this._contextKeyService=n,this._themeService=r,this._contextMenuService=o,this._accessibilityService=h,this._wantsAltCommand=!1,this._itemClassDispose=this._register(new Yi),this._altKey=fl.getInstance()}get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}async onClick(t){t.preventDefault(),t.stopPropagation();try{await this.actionRunner.run(this._commandAction,this._context)}catch(t){this._notificationService.error(t)}}render(t){if(super.render(t),t.classList.add("menu-entry"),this.options.icon&&this._updateItemClass(this._menuItemAction.item),this._menuItemAction.alt){let i=!1;const e=()=>{var t;const e=!!(!((t=this._menuItemAction.alt)===null||t===void 0)&&t.enabled)&&(!this._accessibilityService.isMotionReduced()||i)&&(this._altKey.keyStatus.altKey||this._altKey.keyStatus.shiftKey&&i);e!==this._wantsAltCommand&&(this._wantsAltCommand=e,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._register(this._altKey.event(e)),this._register(sc(t,"mouseleave",(t=>{i=!1,e()}))),this._register(sc(t,"mouseenter",(t=>{i=!0,e()}))),e()}}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}getTooltip(){var t;const i=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),e=i&&i.getLabel(),s=this._commandAction.tooltip||this._commandAction.label;let n=e?tt(0,"{0} ({1})",s,e):s;if(!this._wantsAltCommand&&(!((t=this._menuItemAction.alt)===null||t===void 0)&&t.enabled)){const t=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,i=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),e=i&&i.getLabel(),s=e?tt(0,"{0} ({1})",t,e):t;n=tt(0,`{0}\n[{1}] {2}`,n,aN.modifierLabels[Ft].altKey,s)}return n}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._updateItemClass(this._menuItemAction.item))}_updateItemClass(t){this._itemClassDispose.value=void 0;const{element:i,label:e}=this;if(!i||!e)return;const s=this._commandAction.checked&&(n=t.toggled)&&n.condition!==void 0&&t.toggled.icon?t.toggled.icon:t.icon;var n;if(s)if(Kl.isThemeIcon(s)){const t=Kl.asClassNameArray(s);e.classList.add(...t),this._itemClassDispose.value=Zi((()=>{e.classList.remove(...t)}))}else e.style.backgroundImage=ak(this._themeService.getColorTheme().type)?ll(s.dark):ll(s.light),e.classList.add("icon"),this._itemClassDispose.value=Gi(Zi((()=>{e.style.backgroundImage="",e.classList.remove("icon")})),this._themeService.onDidColorThemeChange((()=>{this.updateClass()})))}};xW=yW([kW(2,NS),kW(3,gR),kW(4,Ra),kW(5,AC),kW(6,oI),kW(7,vw)],xW);let DW=class extends Y${constructor(t,i,e,s,n){var r,o,h;const c={...i,menuAsChild:(r=i==null?void 0:i.menuAsChild)!==null&&r!==void 0&&r,classNames:(o=i==null?void 0:i.classNames)!==null&&o!==void 0?o:Kl.isThemeIcon(t.item.icon)?Kl.asClassName(t.item.icon):void 0,keybindingProvider:(h=i==null?void 0:i.keybindingProvider)!==null&&h!==void 0?h:t=>e.lookupKeybinding(t.id)};super(t,{getActions:()=>t.actions},s,c),this._keybindingService=e,this._contextMenuService=s,this._themeService=n}render(t){super.render(t),j(this.element),t.classList.add("menu-entry");const i=this._action,{icon:e}=i.item;if(e&&!Kl.isThemeIcon(e)){this.element.classList.add("icon");const t=()=>{this.element&&(this.element.style.backgroundImage=ak(this._themeService.getColorTheme().type)?ll(e.dark):ll(e.light))};t(),this._register(this._themeService.onDidColorThemeChange((()=>{t()})))}}};DW=yW([kW(2,NS),kW(3,oI),kW(4,AC)],DW);let EW=class extends q${constructor(t,i,e,s,n,r,o,h){var c,l,a;let u;super(null,t),this._keybindingService=e,this._notificationService=s,this._contextMenuService=n,this._menuService=r,this._instaService=o,this._storageService=h,this._container=null,this._options=i,this._storageKey=`${t.item.submenu.id}_lastActionId`;const d=i!=null&&i.persistLastActionId?h.get(this._storageKey,1):void 0;d&&(u=t.actions.find((t=>d===t.id))),u||(u=t.actions[0]),this._defaultAction=this._instaService.createInstance(xW,u,{keybinding:this._getDefaultActionKeybindingLabel(u)});const f={keybindingProvider:t=>this._keybindingService.lookupKeybinding(t.id),...i,menuAsChild:(c=i==null?void 0:i.menuAsChild)===null||c===void 0||c,classNames:(l=i==null?void 0:i.classNames)!==null&&l!==void 0?l:["codicon","codicon-chevron-down"],actionRunner:(a=i==null?void 0:i.actionRunner)!==null&&a!==void 0?a:new Wl};this._dropdown=new Y$(t,t.actions,this._contextMenuService,f),this._register(this._dropdown.actionRunner.onDidRun((t=>{t.action instanceof eu&&this.update(t.action)})))}update(t){var i;!((i=this._options)===null||i===void 0)&&i.persistLastActionId&&this._storageService.store(this._storageKey,t.id,1,1),this._defaultAction.dispose(),this._defaultAction=this._instaService.createInstance(xW,t,{keybinding:this._getDefaultActionKeybindingLabel(t)}),this._defaultAction.actionRunner=new class extends Wl{async runAction(t,i){await t.run(void 0)}},this._container&&this._defaultAction.render(Xc(this._container,nl(".action-container")))}_getDefaultActionKeybindingLabel(t){var i;let e;if(!((i=this._options)===null||i===void 0)&&i.renderKeybindingWithDefaultActionLabel){const i=this._keybindingService.lookupKeybinding(t.id);i&&(e=`(${i.getLabel()})`)}return e}setActionContext(t){super.setActionContext(t),this._defaultAction.setActionContext(t),this._dropdown.setActionContext(t)}render(t){this._container=t,super.render(this._container),this._container.classList.add("monaco-dropdown-with-default");const i=nl(".action-container");this._defaultAction.render(Yc(this._container,i)),this._register(sc(i,qc.KEY_DOWN,(t=>{const i=new so(t);i.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),i.stopPropagation())})));const e=nl(".dropdown-action-container");this._dropdown.render(Yc(this._container,e)),this._register(sc(e,qc.KEY_DOWN,(t=>{var i;const e=new so(t);e.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),(i=this._defaultAction.element)===null||i===void 0||i.focus(),e.stopPropagation())})))}focus(t){t?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(t){t?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}dispose(){this._defaultAction.dispose(),this._dropdown.dispose(),super.dispose()}};EW=yW([kW(2,NS),kW(3,gR),kW(4,oI),kW(5,Ya),kW(6,Il),kW(7,nW)],EW);let AW=class extends Z${constructor(t,i){super(null,t,t.actions.map((t=>({text:t.id===jl.ID?"─────────":t.label,isDisabled:!t.enabled}))),0,i,mW,{ariaLabel:t.tooltip,optionsAsChildren:!0}),this.select(Math.max(0,t.actions.findIndex((t=>t.checked))))}render(t){super.render(t),t.style.borderColor=Tw(Tb)}runAction(t,i){const e=this.action.actions[i];e&&this.actionRunner.run(e)}};function MW(t,i,e){return i instanceof eu?t.createInstance(xW,i,e):i instanceof iu?i.item.isSelection?t.createInstance(AW,i):i.item.rememberDefaultAction?t.createInstance(EW,i,{...e,persistLastActionId:!0}):t.createInstance(DW,i,e):void 0}AW=yW([kW(1,rI)],AW);class LW extends Qi{constructor(t,i={}){var e,s,n,r,o,h,c;let l,a;switch(super(),this._actionRunnerDisposables=this._register(new Ji),this.viewItemDisposables=this._register(new ie),this.triggerKeyDown=!1,this.focusable=!0,this._onDidBlur=this._register(new le),this.onDidBlur=this._onDidBlur.event,this._onDidCancel=this._register(new le({onWillAddFirstListener:()=>this.cancelHasListener=!0})),this.onDidCancel=this._onDidCancel.event,this.cancelHasListener=!1,this._onDidRun=this._register(new le),this.onDidRun=this._onDidRun.event,this._onWillRun=this._register(new le),this.onWillRun=this._onWillRun.event,this.options=i,this._context=(e=i.context)!==null&&e!==void 0?e:null,this._orientation=(s=this.options.orientation)!==null&&s!==void 0?s:0,this._triggerKeys={keyDown:(r=(n=this.options.triggerKeys)===null||n===void 0?void 0:n.keyDown)!==null&&r!==void 0&&r,keys:(h=(o=this.options.triggerKeys)===null||o===void 0?void 0:o.keys)!==null&&h!==void 0?h:[3,10]},this._hoverDelegate=(c=i.hoverDelegate)!==null&&c!==void 0?c:this._register(oB()),this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new Wl,this._actionRunnerDisposables.add(this._actionRunner)),this._actionRunnerDisposables.add(this._actionRunner.onDidRun((t=>this._onDidRun.fire(t)))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun((t=>this._onWillRun.fire(t)))),this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar",this._orientation){case 0:l=[15],a=[17];break;case 1:l=[16],a=[18],this.domNode.className+=" vertical"}this._register(sc(this.domNode,qc.KEY_DOWN,(t=>{const i=new so(t);let e=!0;const s=typeof this.focusedItem=="number"?this.viewItems[this.focusedItem]:void 0;l&&(i.equals(l[0])||i.equals(l[1]))?e=this.focusPrevious():a&&(i.equals(a[0])||i.equals(a[1]))?e=this.focusNext():i.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():i.equals(14)?e=this.focusFirst():i.equals(13)?e=this.focusLast():i.equals(2)&&s instanceof q$&&s.trapsArrowNavigation?e=this.focusNext():this.isTriggerKeyEvent(i)?this._triggerKeys.keyDown?this.doTrigger(i):this.triggerKeyDown=!0:e=!1,e&&(i.preventDefault(),i.stopPropagation())}))),this._register(sc(this.domNode,qc.KEY_UP,(t=>{const i=new so(t);this.isTriggerKeyEvent(i)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(i)),i.preventDefault(),i.stopPropagation()):(i.equals(2)||i.equals(1026)||i.equals(16)||i.equals(18)||i.equals(15)||i.equals(17))&&this.updateFocusedItem()}))),this.focusTracker=this._register(Qc(this.domNode)),this._register(this.focusTracker.onDidBlur((()=>{Lc()!==this.domNode&&xc(Lc(),this.domNode)||(this._onDidBlur.fire(),this.previouslyFocusedItem=this.focusedItem,this.focusedItem=void 0,this.triggerKeyDown=!1)}))),this._register(this.focusTracker.onDidFocus((()=>this.updateFocusedItem()))),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.options.highlightToggledItems&&this.actionsList.classList.add("highlight-toggled"),this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),t.appendChild(this.domNode)}refreshRole(){this.length()>=1?this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"):this.actionsList.setAttribute("role","presentation")}setFocusable(t){if(this.focusable=t,this.focusable){const t=this.viewItems.find((t=>t instanceof q$&&t.isEnabled()));t instanceof q$&&t.setFocusable(!0)}else this.viewItems.forEach((t=>{t instanceof q$&&t.setFocusable(!1)}))}isTriggerKeyEvent(t){let i=!1;return this._triggerKeys.keys.forEach((e=>{i=i||t.equals(e)})),i}updateFocusedItem(){var t,i;for(let e=0;e<this.actionsList.children.length;e++){const s=this.actionsList.children[e];if(xc(Lc(),s)){this.focusedItem=e,(i=(t=this.viewItems[this.focusedItem])===null||t===void 0?void 0:t.showHover)===null||i===void 0||i.call(t);break}}}get context(){return this._context}set context(t){this._context=t,this.viewItems.forEach((i=>i.setActionContext(t)))}get actionRunner(){return this._actionRunner}set actionRunner(t){this._actionRunner=t,this._actionRunnerDisposables.clear(),this._actionRunnerDisposables.add(this._actionRunner.onDidRun((t=>this._onDidRun.fire(t)))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun((t=>this._onWillRun.fire(t)))),this.viewItems.forEach((i=>i.actionRunner=t))}getContainer(){return this.domNode}getAction(t){var i;if(typeof t=="number")return(i=this.viewItems[t])===null||i===void 0?void 0:i.action;if(t instanceof HTMLElement){for(;t.parentElement!==this.actionsList;){if(!t.parentElement)return;t=t.parentElement}for(let i=0;i<this.actionsList.childNodes.length;i++)if(this.actionsList.childNodes[i]===t)return this.viewItems[i].action}}push(t,i={}){const e=Array.isArray(t)?t:[t];let s=_(i.index)?i.index:null;e.forEach((t=>{const e=document.createElement("li");let n;e.className="action-item",e.setAttribute("role","presentation");const r={hoverDelegate:this._hoverDelegate,...i};this.options.actionViewItemProvider&&(n=this.options.actionViewItemProvider(t,r)),n||(n=new G$(this.context,t,r)),this.options.allowContextMenu||this.viewItemDisposables.set(n,sc(e,qc.CONTEXT_MENU,(t=>{Zc(t,!0)}))),n.actionRunner=this._actionRunner,n.setActionContext(this.context),n.render(e),this.focusable&&n instanceof q$&&this.viewItems.length===0&&n.setFocusable(!0),s===null||s<0||s>=this.actionsList.children.length?(this.actionsList.appendChild(e),this.viewItems.push(n)):(this.actionsList.insertBefore(e,this.actionsList.children[s]),this.viewItems.splice(s,0,n),s++)})),typeof this.focusedItem=="number"&&this.focus(this.focusedItem),this.refreshRole()}clear(){this.isEmpty()||(this.viewItems=qi(this.viewItems),this.viewItemDisposables.clearAndDisposeAll(),ic(this.actionsList),this.refreshRole())}length(){return this.viewItems.length}isEmpty(){return this.viewItems.length===0}focus(t){let i,e=!1;if(t===void 0?e=!0:typeof t=="number"?i=t:typeof t=="boolean"&&(e=t),e&&this.focusedItem===void 0){const t=this.viewItems.findIndex((t=>t.isEnabled()));this.focusedItem=t===-1?void 0:t,this.updateFocus(void 0,void 0,!0)}else i!==void 0&&(this.focusedItem=i),this.updateFocus(void 0,void 0,!0)}focusFirst(){return this.focusedItem=this.length()-1,this.focusNext(!0)}focusLast(){return this.focusedItem=0,this.focusPrevious(!0)}focusNext(t){if(this.focusedItem===void 0)this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;const i=this.focusedItem;let e;do{if(!t&&this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=i,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,e=this.viewItems[this.focusedItem]}while(this.focusedItem!==i&&(this.options.focusOnlyEnabledItems&&!e.isEnabled()||e.action.id===jl.ID));return this.updateFocus(),!0}focusPrevious(t){if(this.focusedItem===void 0)this.focusedItem=0;else if(this.viewItems.length<=1)return!1;const i=this.focusedItem;let e;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(!t&&this.options.preventLoopNavigation)return this.focusedItem=i,!1;this.focusedItem=this.viewItems.length-1}e=this.viewItems[this.focusedItem]}while(this.focusedItem!==i&&(this.options.focusOnlyEnabledItems&&!e.isEnabled()||e.action.id===jl.ID));return this.updateFocus(!0),!0}updateFocus(t,i,e=!1){var s,n;this.focusedItem===void 0&&this.actionsList.focus({preventScroll:i}),this.previouslyFocusedItem!==void 0&&this.previouslyFocusedItem!==this.focusedItem&&((s=this.viewItems[this.previouslyFocusedItem])===null||s===void 0||s.blur());const r=this.focusedItem!==void 0?this.viewItems[this.focusedItem]:void 0;if(r){let s=!0;V(r.focus)||(s=!1),this.options.focusOnlyEnabledItems&&V(r.isEnabled)&&!r.isEnabled()&&(s=!1),r.action.id===jl.ID&&(s=!1),s?(e||this.previouslyFocusedItem!==this.focusedItem)&&(r.focus(t),this.previouslyFocusedItem=this.focusedItem):(this.actionsList.focus({preventScroll:i}),this.previouslyFocusedItem=void 0),s&&((n=r.showHover)===null||n===void 0||n.call(r))}}doTrigger(t){if(this.focusedItem===void 0)return;const i=this.viewItems[this.focusedItem];if(i instanceof q$){const e=i._context===null||i._context===void 0?t:i._context;this.run(i._action,e)}}async run(t,i){await this._actionRunner.run(t,i)}dispose(){this._context=void 0,this.viewItems=qi(this.viewItems),this.getContainer().remove(),super.dispose()}}const FW=/\(&([^\s&])\)|(^|[^&])&([^\s&])/,TW=/(&amp;)?(&amp;)([^\s&])/g;var RW,OW;(function(t){t[t.Right=0]="Right",t[t.Left=1]="Left"})(RW||(RW={})),function(t){t[t.Above=0]="Above",t[t.Below=1]="Below"}(OW||(OW={}));class IW extends LW{constructor(t,i,e,s){t.classList.add("monaco-menu-container"),t.setAttribute("role","presentation");const n=document.createElement("div");n.classList.add("monaco-menu"),n.setAttribute("role","presentation"),super(n,{orientation:1,actionViewItemProvider:t=>this.doGetActionViewItem(t,e,r),context:e.context,actionRunner:e.actionRunner,ariaLabel:e.ariaLabel,ariaRole:"menu",focusOnlyEnabledItems:!0,triggerKeys:{keys:[3,...bt||yt?[10]:[]],keyDown:!0}}),this.menuStyles=s,this.menuElement=n,this.actionsList.tabIndex=0,this.initializeOrUpdateStyleSheet(t,s),this._register(Wk.addTarget(n)),this._register(sc(n,qc.KEY_DOWN,(t=>{new so(t).equals(2)&&t.preventDefault()}))),e.enableMnemonics&&this._register(sc(n,qc.KEY_DOWN,(t=>{const i=t.key.toLocaleLowerCase();if(this.mnemonics.has(i)){Zc(t,!0);const e=this.mnemonics.get(i);if(e.length===1&&(e[0]instanceof PW&&e[0].container&&this.focusItemByElement(e[0].container),e[0].onClick(t)),e.length>1){const t=e.shift();t&&t.container&&(this.focusItemByElement(t.container),e.push(t)),this.mnemonics.set(i,e)}}}))),yt&&this._register(sc(n,qc.KEY_DOWN,(t=>{const i=new so(t);i.equals(14)||i.equals(11)?(this.focusedItem=this.viewItems.length-1,this.focusNext(),Zc(t,!0)):(i.equals(13)||i.equals(12))&&(this.focusedItem=0,this.focusPrevious(),Zc(t,!0))}))),this._register(sc(this.domNode,qc.MOUSE_OUT,(t=>{xc(t.relatedTarget,this.domNode)||(this.focusedItem=void 0,this.updateFocus(),t.stopPropagation())}))),this._register(sc(this.actionsList,qc.MOUSE_OVER,(t=>{let i=t.target;if(i&&xc(i,this.actionsList)&&i!==this.actionsList){for(;i.parentElement!==this.actionsList&&i.parentElement!==null;)i=i.parentElement;if(i.classList.contains("action-item")){const t=this.focusedItem;this.setFocusedItem(i),t!==this.focusedItem&&this.updateFocus()}}}))),this._register(Wk.addTarget(this.actionsList)),this._register(sc(this.actionsList,Bk.Tap,(t=>{let i=t.initialTarget;if(i&&xc(i,this.actionsList)&&i!==this.actionsList){for(;i.parentElement!==this.actionsList&&i.parentElement!==null;)i=i.parentElement;if(i.classList.contains("action-item")){const t=this.focusedItem;this.setFocusedItem(i),t!==this.focusedItem&&this.updateFocus()}}})));const r={parent:this};this.mnemonics=new Map,this.scrollableElement=this._register(new rC(n,{alwaysConsumeMouseWheel:!0,horizontal:2,vertical:3,verticalScrollbarSize:7,handleMouseWheel:!0,useShadows:!0}));const o=this.scrollableElement.getDomNode();o.style.position="",this.styleScrollElement(o,s),this._register(sc(n,Bk.Change,(t=>{Zc(t,!0);const i=this.scrollableElement.getScrollPosition().scrollTop;this.scrollableElement.setScrollPosition({scrollTop:i-t.translationY})}))),this._register(sc(o,qc.MOUSE_UP,(t=>{t.preventDefault()})));const h=Uh(t);n.style.maxHeight=`${Math.max(10,h.innerHeight-t.getBoundingClientRect().top-35)}px`,i=i.filter(((t,s)=>{var n;return!((n=e.submenuIds)===null||n===void 0)&&n.has(t.id)?(console.warn(`Found submenu cycle: ${t.id}`),!1):!(t instanceof jl&&(s===i.length-1||s===0||i[s-1]instanceof jl))})),this.push(i,{icon:!0,label:!0,isMenu:!0}),t.appendChild(this.scrollableElement.getDomNode()),this.scrollableElement.scanDomNode(),this.viewItems.filter((t=>!(t instanceof NW))).forEach(((t,i,e)=>{t.updatePositionInSet(i+1,e.length)}))}initializeOrUpdateStyleSheet(t,i){this.styleSheet||(Ac(t)?this.styleSheet=Pc(t):(IW.globalStyleSheet||(IW.globalStyleSheet=Pc()),this.styleSheet=IW.globalStyleSheet)),this.styleSheet.textContent=function(t,i){let e=`\n.monaco-menu {\n\tfont-size: 13px;\n\tborder-radius: 5px;\n\tmin-width: 160px;\n}\n\n${BW(As.menuSelection)}\n${BW(As.menuSubmenu)}\n\n.monaco-menu .monaco-action-bar {\n\ttext-align: right;\n\toverflow: hidden;\n\twhite-space: nowrap;\n}\n\n.monaco-menu .monaco-action-bar .actions-container {\n\tdisplay: flex;\n\tmargin: 0 auto;\n\tpadding: 0;\n\twidth: 100%;\n\tjustify-content: flex-end;\n}\n\n.monaco-menu .monaco-action-bar.vertical .actions-container {\n\tdisplay: inline-block;\n}\n\n.monaco-menu .monaco-action-bar.reverse .actions-container {\n\tflex-direction: row-reverse;\n}\n\n.monaco-menu .monaco-action-bar .action-item {\n\tcursor: pointer;\n\tdisplay: inline-block;\n\ttransition: transform 50ms ease;\n\tposition: relative;  /* DO NOT REMOVE - this is the key to preventing the ghosting icon bug in Chrome 42 */\n}\n\n.monaco-menu .monaco-action-bar .action-item.disabled {\n\tcursor: default;\n}\n\n.monaco-menu .monaco-action-bar .action-item .icon,\n.monaco-menu .monaco-action-bar .action-item .codicon {\n\tdisplay: inline-block;\n}\n\n.monaco-menu .monaco-action-bar .action-item .codicon {\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.monaco-menu .monaco-action-bar .action-label {\n\tfont-size: 11px;\n\tmargin-right: 4px;\n}\n\n.monaco-menu .monaco-action-bar .action-item.disabled .action-label,\n.monaco-menu .monaco-action-bar .action-item.disabled .action-label:hover {\n\tcolor: var(--vscode-disabledForeground);\n}\n\n/* Vertical actions */\n\n.monaco-menu .monaco-action-bar.vertical {\n\ttext-align: left;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tdisplay: block;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tdisplay: block;\n\tborder-bottom: 1px solid var(--vscode-menu-separatorBackground);\n\tpadding-top: 1px;\n\tpadding: 30px;\n}\n\n.monaco-menu .secondary-actions .monaco-action-bar .action-label {\n\tmargin-left: 6px;\n}\n\n/* Action Items */\n.monaco-menu .monaco-action-bar .action-item.select-container {\n\toverflow: hidden; /* somehow the dropdown overflows its container, we prevent it here to not push */\n\tflex: 1;\n\tmax-width: 170px;\n\tmin-width: 60px;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tmargin-right: 10px;\n}\n\n.monaco-menu .monaco-action-bar.vertical {\n\tmargin-left: 0;\n\toverflow: visible;\n}\n\n.monaco-menu .monaco-action-bar.vertical .actions-container {\n\tdisplay: block;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tpadding: 0;\n\ttransform: none;\n\tdisplay: flex;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item.active {\n\ttransform: none;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item {\n\tflex: 1 1 auto;\n\tdisplay: flex;\n\theight: 2em;\n\talign-items: center;\n\tposition: relative;\n\tmargin: 0 4px;\n\tborder-radius: 4px;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item:hover .keybinding,\n.monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .keybinding {\n\topacity: unset;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label {\n\tflex: 1 1 auto;\n\ttext-decoration: none;\n\tpadding: 0 1em;\n\tbackground: none;\n\tfont-size: 12px;\n\tline-height: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .keybinding,\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\tdisplay: inline-block;\n\tflex: 2 1 auto;\n\tpadding: 0 1em;\n\ttext-align: right;\n\tfont-size: 12px;\n\tline-height: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\theight: 100%;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon {\n\tfont-size: 16px !important;\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon::before {\n\tmargin-left: auto;\n\tmargin-right: -20px;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,\n.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator {\n\topacity: 0.4;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator) {\n\tdisplay: inline-block;\n\tbox-sizing: border-box;\n\tmargin: 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tposition: static;\n\toverflow: visible;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item .monaco-submenu {\n\tposition: absolute;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\twidth: 100%;\n\theight: 0px !important;\n\topacity: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator.text {\n\tpadding: 0.7em 1em 0.1em 1em;\n\tfont-weight: bold;\n\topacity: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:hover {\n\tcolor: inherit;\n}\n\n.monaco-menu .monaco-action-bar.vertical .menu-item-check {\n\tposition: absolute;\n\tvisibility: hidden;\n\twidth: 1em;\n\theight: 100%;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check {\n\tvisibility: visible;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n}\n\n/* Context Menu */\n\n.context-view.monaco-menu-container {\n\toutline: 0;\n\tborder: none;\n\tanimation: fadeIn 0.083s linear;\n\t-webkit-app-region: no-drag;\n}\n\n.context-view.monaco-menu-container :focus,\n.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,\n.context-view.monaco-menu-container .monaco-action-bar.vertical :focus {\n\toutline: 0;\n}\n\n.hc-black .context-view.monaco-menu-container,\n.hc-light .context-view.monaco-menu-container,\n:host-context(.hc-black) .context-view.monaco-menu-container,\n:host-context(.hc-light) .context-view.monaco-menu-container {\n\tbox-shadow: none;\n}\n\n.hc-black .monaco-menu .monaco-action-bar.vertical .action-item.focused,\n.hc-light .monaco-menu .monaco-action-bar.vertical .action-item.focused,\n:host-context(.hc-black) .monaco-menu .monaco-action-bar.vertical .action-item.focused,\n:host-context(.hc-light) .monaco-menu .monaco-action-bar.vertical .action-item.focused {\n\tbackground: none;\n}\n\n/* Vertical Action Bar Styles */\n\n.monaco-menu .monaco-action-bar.vertical {\n\tpadding: 4px 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item {\n\theight: 2em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator),\n.monaco-menu .monaco-action-bar.vertical .keybinding {\n\tfont-size: inherit;\n\tpadding: 0 2em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .menu-item-check {\n\tfont-size: inherit;\n\twidth: 2em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tfont-size: inherit;\n\tmargin: 5px 0 !important;\n\tpadding: 0;\n\tborder-radius: 0;\n}\n\n.linux .monaco-menu .monaco-action-bar.vertical .action-label.separator,\n:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tmargin-left: 0;\n\tmargin-right: 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\tfont-size: 60%;\n\tpadding: 0 1.8em;\n}\n\n.linux .monaco-menu .monaco-action-bar.vertical .submenu-indicator,\n:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\theight: 100%;\n\tmask-size: 10px 10px;\n\t-webkit-mask-size: 10px 10px;\n}\n\n.monaco-menu .action-item {\n\tcursor: default;\n}`;if(i){e+=`\n\t\t\t/* Arrows */\n\t\t\t.monaco-scrollable-element > .scrollbar > .scra {\n\t\t\t\tcursor: pointer;\n\t\t\t\tfont-size: 11px !important;\n\t\t\t}\n\n\t\t\t.monaco-scrollable-element > .visible {\n\t\t\t\topacity: 1;\n\n\t\t\t\t/* Background rule added for IE9 - to allow clicks on dom node */\n\t\t\t\tbackground:rgba(0,0,0,0);\n\n\t\t\t\ttransition: opacity 100ms linear;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .invisible {\n\t\t\t\topacity: 0;\n\t\t\t\tpointer-events: none;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .invisible.fade {\n\t\t\t\ttransition: opacity 800ms linear;\n\t\t\t}\n\n\t\t\t/* Scrollable Content Inset Shadow */\n\t\t\t.monaco-scrollable-element > .shadow {\n\t\t\t\tposition: absolute;\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .shadow.top {\n\t\t\t\tdisplay: block;\n\t\t\t\ttop: 0;\n\t\t\t\tleft: 3px;\n\t\t\t\theight: 3px;\n\t\t\t\twidth: 100%;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .shadow.left {\n\t\t\t\tdisplay: block;\n\t\t\t\ttop: 3px;\n\t\t\t\tleft: 0;\n\t\t\t\theight: 100%;\n\t\t\t\twidth: 3px;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .shadow.top-left-corner {\n\t\t\t\tdisplay: block;\n\t\t\t\ttop: 0;\n\t\t\t\tleft: 0;\n\t\t\t\theight: 3px;\n\t\t\t\twidth: 3px;\n\t\t\t}\n\t\t`;const i=t.scrollbarShadow;i&&(e+=`\n\t\t\t\t.monaco-scrollable-element > .shadow.top {\n\t\t\t\t\tbox-shadow: ${i} 0 6px 6px -6px inset;\n\t\t\t\t}\n\n\t\t\t\t.monaco-scrollable-element > .shadow.left {\n\t\t\t\t\tbox-shadow: ${i} 6px 0 6px -6px inset;\n\t\t\t\t}\n\n\t\t\t\t.monaco-scrollable-element > .shadow.top.left {\n\t\t\t\t\tbox-shadow: ${i} 6px 6px 6px -6px inset;\n\t\t\t\t}\n\t\t\t`);const s=t.scrollbarSliderBackground;s&&(e+=`\n\t\t\t\t.monaco-scrollable-element > .scrollbar > .slider {\n\t\t\t\t\tbackground: ${s};\n\t\t\t\t}\n\t\t\t`);const n=t.scrollbarSliderHoverBackground;n&&(e+=`\n\t\t\t\t.monaco-scrollable-element > .scrollbar > .slider:hover {\n\t\t\t\t\tbackground: ${n};\n\t\t\t\t}\n\t\t\t`);const r=t.scrollbarSliderActiveBackground;r&&(e+=`\n\t\t\t\t.monaco-scrollable-element > .scrollbar > .slider.active {\n\t\t\t\t\tbackground: ${r};\n\t\t\t\t}\n\t\t\t`)}return e}(i,Ac(t))}styleScrollElement(t,i){var e,s;const n=(e=i.foregroundColor)!==null&&e!==void 0?e:"",r=(s=i.backgroundColor)!==null&&s!==void 0?s:"",o=i.borderColor?`1px solid ${i.borderColor}`:"",h=i.shadowColor?`0 2px 8px ${i.shadowColor}`:"";t.style.outline=o,t.style.borderRadius="5px",t.style.color=n,t.style.backgroundColor=r,t.style.boxShadow=h}getContainer(){return this.scrollableElement.getDomNode()}get onScroll(){return this.scrollableElement.onScroll}focusItemByElement(t){const i=this.focusedItem;this.setFocusedItem(t),i!==this.focusedItem&&this.updateFocus()}setFocusedItem(t){for(let i=0;i<this.actionsList.children.length;i++)if(t===this.actionsList.children[i]){this.focusedItem=i;break}}updateFocus(t){super.updateFocus(t,!0,!0),this.focusedItem!==void 0&&this.scrollableElement.setScrollPosition({scrollTop:Math.round(this.menuElement.scrollTop)})}doGetActionViewItem(t,i,e){if(t instanceof jl)return new NW(i.context,t,{icon:!0},this.menuStyles);if(t instanceof Hl){const s=new PW(t,t.actions,e,{...i,submenuIds:new Set([...i.submenuIds||[],t.id])},this.menuStyles);if(i.enableMnemonics){const t=s.getMnemonic();if(t&&s.isEnabled()){let i=[];this.mnemonics.has(t)&&(i=this.mnemonics.get(t)),i.push(s),this.mnemonics.set(t,i)}}return s}{const e={enableMnemonics:i.enableMnemonics,useEventAsContext:i.useEventAsContext};if(i.getKeyBinding){const s=i.getKeyBinding(t);if(s){const t=s.getLabel();t&&(e.keybinding=t)}}const s=new _W(i.context,t,e,this.menuStyles);if(i.enableMnemonics){const t=s.getMnemonic();if(t&&s.isEnabled()){let i=[];this.mnemonics.has(t)&&(i=this.mnemonics.get(t)),i.push(s),this.mnemonics.set(t,i)}}return s}}}class _W extends q${constructor(t,i,e,s){if(e.isMenu=!0,super(i,i,e),this.menuStyle=s,this.options=e,this.options.icon=e.icon!==void 0&&e.icon,this.options.label=e.label===void 0||e.label,this.cssClass="",this.options.label&&e.enableMnemonics){const t=this.action.label;if(t){const i=FW.exec(t);i&&(this.mnemonic=(i[1]?i[1]:i[3]).toLocaleLowerCase())}}this.runOnceToEnableMouseUp=new Co((()=>{this.element&&(this._register(sc(this.element,qc.MOUSE_UP,(t=>{if(Zc(t,!0),Hr){if(new ho(Uh(this.element),t).rightButton)return;this.onClick(t)}else setTimeout((()=>{this.onClick(t)}),0)}))),this._register(sc(this.element,qc.CONTEXT_MENU,(t=>{Zc(t,!0)}))))}),100),this._register(this.runOnceToEnableMouseUp)}render(t){super.render(t),this.element&&(this.container=t,this.item=Yc(this.element,nl("a.action-menu-item")),this._action.id===jl.ID?this.item.setAttribute("role","presentation"):(this.item.setAttribute("role","menuitem"),this.mnemonic&&this.item.setAttribute("aria-keyshortcuts",`${this.mnemonic}`)),this.check=Yc(this.item,nl("span.menu-item-check"+Kl.asCSSSelector(As.menuSelection))),this.check.setAttribute("role","none"),this.label=Yc(this.item,nl("span.action-label")),this.options.label&&this.options.keybinding&&(Yc(this.item,nl("span.keybinding")).textContent=this.options.keybinding),this.runOnceToEnableMouseUp.schedule(),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked(),this.applyStyle())}blur(){super.blur(),this.applyStyle()}focus(){var t;super.focus(),(t=this.item)===null||t===void 0||t.focus(),this.applyStyle()}updatePositionInSet(t,i){this.item&&(this.item.setAttribute("aria-posinset",`${t}`),this.item.setAttribute("aria-setsize",`${i}`))}updateLabel(){var t;if(this.label&&this.options.label){ic(this.label);let i=E_(this.action.label);if(i){const e=function(t){const i=FW,e=i.exec(t);if(!e)return t;const s=!e[1];return t.replace(i,s?"$2$3":"").trim()}(i);this.options.enableMnemonics||(i=e),this.label.setAttribute("aria-label",e.replace(/&&/g,"&"));const s=FW.exec(i);if(s){i=qn(i),TW.lastIndex=0;let e=TW.exec(i);for(;e&&e[1];)e=TW.exec(i);const n=t=>t.replace(/&amp;&amp;/g,"&amp;");e?this.label.append(Jn(n(i.substr(0,e.index))," "),nl("u",{"aria-hidden":"true"},e[3]),Qn(n(i.substr(e.index+e[0].length))," ")):this.label.innerText=n(i).trim(),(t=this.item)===null||t===void 0||t.setAttribute("aria-keyshortcuts",(s[1]?s[1]:s[3]).toLocaleLowerCase())}else this.label.innerText=i.replace(/&&/g,"&").trim()}}}updateTooltip(){}updateClass(){this.cssClass&&this.item&&this.item.classList.remove(...this.cssClass.split(" ")),this.options.icon&&this.label?(this.cssClass=this.action.class||"",this.label.classList.add("icon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" ")),this.updateEnabled()):this.label&&this.label.classList.remove("icon")}updateEnabled(){this.action.enabled?(this.element&&(this.element.classList.remove("disabled"),this.element.removeAttribute("aria-disabled")),this.item&&(this.item.classList.remove("disabled"),this.item.removeAttribute("aria-disabled"),this.item.tabIndex=0)):(this.element&&(this.element.classList.add("disabled"),this.element.setAttribute("aria-disabled","true")),this.item&&(this.item.classList.add("disabled"),this.item.setAttribute("aria-disabled","true")))}updateChecked(){if(!this.item)return;const t=this.action.checked;this.item.classList.toggle("checked",!!t),t!==void 0?(this.item.setAttribute("role","menuitemcheckbox"),this.item.setAttribute("aria-checked",t?"true":"false")):(this.item.setAttribute("role","menuitem"),this.item.setAttribute("aria-checked",""))}getMnemonic(){return this.mnemonic}applyStyle(){const t=this.element&&this.element.classList.contains("focused"),i=t&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor,e=t&&this.menuStyle.selectionBackgroundColor?this.menuStyle.selectionBackgroundColor:void 0,s=t&&this.menuStyle.selectionBorderColor?`1px solid ${this.menuStyle.selectionBorderColor}`:"",n=t&&this.menuStyle.selectionBorderColor?"-1px":"";this.item&&(this.item.style.color=i??"",this.item.style.backgroundColor=e??"",this.item.style.outline=s,this.item.style.outlineOffset=n),this.check&&(this.check.style.color=i??"")}}class PW extends _W{constructor(t,i,e,s,n){super(t,t,s,n),this.submenuActions=i,this.parentData=e,this.submenuOptions=s,this.mysubmenu=null,this.submenuDisposables=this._register(new Ji),this.mouseOver=!1,this.expandDirection=s&&s.expandDirection!==void 0?s.expandDirection:{horizontal:RW.Right,vertical:OW.Below},this.showScheduler=new Co((()=>{this.mouseOver&&(this.cleanupExistingSubmenu(!1),this.createSubmenu(!1))}),250),this.hideScheduler=new Co((()=>{this.element&&!xc(Lc(),this.element)&&this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))}),750)}render(t){super.render(t),this.element&&(this.item&&(this.item.classList.add("monaco-submenu-item"),this.item.tabIndex=0,this.item.setAttribute("aria-haspopup","true"),this.updateAriaExpanded("false"),this.submenuIndicator=Yc(this.item,nl("span.submenu-indicator"+Kl.asCSSSelector(As.menuSubmenu))),this.submenuIndicator.setAttribute("aria-hidden","true")),this._register(sc(this.element,qc.KEY_UP,(t=>{const i=new so(t);(i.equals(17)||i.equals(3))&&(Zc(t,!0),this.createSubmenu(!0))}))),this._register(sc(this.element,qc.KEY_DOWN,(t=>{const i=new so(t);Lc()===this.item&&(i.equals(17)||i.equals(3))&&Zc(t,!0)}))),this._register(sc(this.element,qc.MOUSE_OVER,(t=>{this.mouseOver||(this.mouseOver=!0,this.showScheduler.schedule())}))),this._register(sc(this.element,qc.MOUSE_LEAVE,(t=>{this.mouseOver=!1}))),this._register(sc(this.element,qc.FOCUS_OUT,(t=>{this.element&&!xc(Lc(),this.element)&&this.hideScheduler.schedule()}))),this._register(this.parentData.parent.onScroll((()=>{this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))}))))}updateEnabled(){}onClick(t){Zc(t,!0),this.cleanupExistingSubmenu(!1),this.createSubmenu(!0)}cleanupExistingSubmenu(t){if(this.parentData.submenu&&(t||this.parentData.submenu!==this.mysubmenu)){try{this.parentData.submenu.dispose()}catch{}this.parentData.submenu=void 0,this.updateAriaExpanded("false"),this.submenuContainer&&(this.submenuDisposables.clear(),this.submenuContainer=void 0)}}calculateSubmenuMenuLayout(t,i,e,s){const n={top:0,left:0};return n.left=xP(t.width,i.width,{position:s.horizontal===RW.Right?0:1,offset:e.left,size:e.width}),n.left>=e.left&&n.left<e.left+e.width&&(e.left+10+i.width<=t.width&&(n.left=e.left+10),e.top+=10,e.height=0),n.top=xP(t.height,i.height,{position:0,offset:e.top,size:0}),n.top+i.height===e.top&&n.top+e.height+i.height<=t.height&&(n.top+=e.height),n}createSubmenu(t=!0){if(this.element)if(this.parentData.submenu)this.parentData.submenu.focus(!1);else{this.updateAriaExpanded("true"),this.submenuContainer=Yc(this.element,nl("div.monaco-submenu")),this.submenuContainer.classList.add("menubar-menu-items-holder","context-view");const i=Uh(this.parentData.parent.domNode).getComputedStyle(this.parentData.parent.domNode),e=parseFloat(i.paddingTop||"0")||0;this.submenuContainer.style.zIndex="1",this.submenuContainer.style.position="fixed",this.submenuContainer.style.top="0",this.submenuContainer.style.left="0",this.parentData.submenu=new IW(this.submenuContainer,this.submenuActions.length?this.submenuActions:[new Vl],this.submenuOptions,this.menuStyle);const s=this.element.getBoundingClientRect(),n={top:s.top-e,left:s.left,height:s.height+2*e,width:s.width},r=this.submenuContainer.getBoundingClientRect(),o=Uh(this.element),{top:h,left:c}=this.calculateSubmenuMenuLayout(new mc(o.innerWidth,o.innerHeight),mc.lift(r),n,this.expandDirection);this.submenuContainer.style.left=c-r.left+"px",this.submenuContainer.style.top=h-r.top+"px",this.submenuDisposables.add(sc(this.submenuContainer,qc.KEY_UP,(t=>{new so(t).equals(15)&&(Zc(t,!0),this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0))}))),this.submenuDisposables.add(sc(this.submenuContainer,qc.KEY_DOWN,(t=>{new so(t).equals(15)&&Zc(t,!0)}))),this.submenuDisposables.add(this.parentData.submenu.onDidCancel((()=>{this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0)}))),this.parentData.submenu.focus(t),this.mysubmenu=this.parentData.submenu}}updateAriaExpanded(t){var i;this.item&&((i=this.item)===null||i===void 0||i.setAttribute("aria-expanded",t))}applyStyle(){super.applyStyle();const t=this.element&&this.element.classList.contains("focused")&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor;this.submenuIndicator&&(this.submenuIndicator.style.color=t??"")}dispose(){super.dispose(),this.hideScheduler.dispose(),this.mysubmenu&&(this.mysubmenu.dispose(),this.mysubmenu=null),this.submenuContainer&&(this.submenuContainer=void 0)}}class NW extends G${constructor(t,i,e,s){super(t,i,e),this.menuStyles=s}render(t){super.render(t),this.label&&(this.label.style.borderBottomColor=this.menuStyles.separatorColor?`${this.menuStyles.separatorColor}`:"")}}function BW(t){const i=Es()[t.id];return`.codicon-${t.id}:before { content: '\\${i.toString(16)}'; }`}class $W{constructor(t,i,e,s){this.contextViewService=t,this.telemetryService=i,this.notificationService=e,this.keybindingService=s,this.focusToReturn=null,this.lastContainer=null,this.block=null,this.blockDisposable=null,this.options={blockMouse:!0}}configure(t){this.options=t}showContextMenu(t){const i=t.getActions();if(!i.length)return;let e;this.focusToReturn=Lc();const s=t.domForShadowRoot instanceof HTMLElement?t.domForShadowRoot:void 0;this.contextViewService.showContextView({getAnchor:()=>t.getAnchor(),canRelayout:!1,anchorAlignment:t.anchorAlignment,anchorAxisAlignment:t.anchorAxisAlignment,render:s=>{var n;this.lastContainer=s;const r=t.getMenuClassName?t.getMenuClassName():"";r&&(s.className+=" "+r),this.options.blockMouse&&(this.block=s.appendChild(nl(".context-view-block")),this.block.style.position="fixed",this.block.style.cursor="initial",this.block.style.left="0",this.block.style.top="0",this.block.style.width="100%",this.block.style.height="100%",this.block.style.zIndex="-1",(n=this.blockDisposable)===null||n===void 0||n.dispose(),this.blockDisposable=sc(this.block,qc.MOUSE_DOWN,(t=>t.stopPropagation())));const o=new Ji,h=t.actionRunner||new Wl;h.onWillRun((i=>this.onActionRun(i,!t.skipTelemetry)),this,o),h.onDidRun(this.onDidActionRun,this,o),e=new IW(s,i,{actionViewItemProvider:t.getActionViewItem,context:t.getActionsContext?t.getActionsContext():null,actionRunner:h,getKeyBinding:t.getKeyBinding?t.getKeyBinding:t=>this.keybindingService.lookupKeybinding(t.id)},bW),e.onDidCancel((()=>this.contextViewService.hideContextView(!0)),null,o),e.onDidBlur((()=>this.contextViewService.hideContextView(!0)),null,o);const c=Uh(s);return o.add(sc(c,qc.BLUR,(()=>this.contextViewService.hideContextView(!0)))),o.add(sc(c,qc.MOUSE_DOWN,(t=>{if(t.defaultPrevented)return;const i=new ho(c,t);let e=i.target;if(!i.rightButton){for(;e;){if(e===s)return;e=e.parentElement}this.contextViewService.hideContextView(!0)}}))),Gi(o,e)},focus:()=>{e==null||e.focus(!!t.autoSelectFirstItem)},onHide:i=>{var e,s,n;(e=t.onHide)===null||e===void 0||e.call(t,!!i),this.block&&(this.block.remove(),this.block=null),(s=this.blockDisposable)===null||s===void 0||s.dispose(),this.blockDisposable=null,this.lastContainer&&(Lc()===this.lastContainer||xc(Lc(),this.lastContainer))&&((n=this.focusToReturn)===null||n===void 0||n.focus()),this.lastContainer=null}},s,!!s)}onActionRun(t,i){i&&this.telemetryService.publicLog2("workbenchActionExecuted",{id:t.action.id,from:"contextMenu"}),this.contextViewService.hideContextView(!1)}onDidActionRun(t){t.error&&!Bi(t.error)&&this.notificationService.error(t.error)}}var WW=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},jW=function(t,i){return function(e,s){i(e,s,t)}};let HW=class extends Qi{get contextMenuHandler(){return this._contextMenuHandler||(this._contextMenuHandler=new $W(this.contextViewService,this.telemetryService,this.notificationService,this.keybindingService)),this._contextMenuHandler}constructor(t,i,e,s,n,r){super(),this.telemetryService=t,this.notificationService=i,this.contextViewService=e,this.keybindingService=s,this.menuService=n,this.contextKeyService=r,this._contextMenuHandler=void 0,this._onDidShowContextMenu=this._store.add(new le),this.onDidShowContextMenu=this._onDidShowContextMenu.event,this._onDidHideContextMenu=this._store.add(new le)}configure(t){this.contextMenuHandler.configure(t)}showContextMenu(t){t=VW.transform(t,this.menuService,this.contextKeyService),this.contextMenuHandler.showContextMenu({...t,onHide:i=>{var e;(e=t.onHide)===null||e===void 0||e.call(t,i),this._onDidHideContextMenu.fire()}}),fl.getInstance().resetKeyStatus(),this._onDidShowContextMenu.fire()}};var VW,zW;HW=WW([jW(0,ru),jW(1,gR),jW(2,rI),jW(3,NS),jW(4,Ya),jW(5,Ra)],HW),function(t){t.transform=function(t,i,e){if(!((s=t)&&s.menuId instanceof Qa))return t;var s;const{menuId:n,menuActionOptions:r,contextKeyService:o}=t;return{...t,getActions:()=>{const s=[];if(n){const t=i.createMenu(n,o??e);(function(t,i,e,s){const n=t.getActions(i),r=fl.getInstance();SW(n,e,r.keyStatus.altKey||(vt||yt)&&r.keyStatus.shiftKey,(t=>t==="navigation"))})(t,r,s),t.dispose()}return t.getActions?jl.join(t.getActions(),s):s}}}}(VW||(VW={})),function(t){t[t.API=0]="API",t[t.USER=1]="USER"}(zW||(zW={}));var UW=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},KW=function(t,i){return function(e,s){i(e,s,t)}};let qW=class{constructor(t){this._commandService=t}async open(t,i){if(!Fh(t,Lh.command))return!1;if(!(i!=null&&i.allowCommands)||(typeof t=="string"&&(t=as.parse(t)),Array.isArray(i.allowCommands)&&!i.allowCommands.includes(t.path)))return!0;let e=[];try{e=$_(decodeURIComponent(t.query))}catch{try{e=$_(t.query)}catch{}}return Array.isArray(e)||(e=[e]),await this._commandService.executeCommand(t.path,...e),!0}};qW=UW([KW(0,ql)],qW);let GW=class{constructor(t){this._editorService=t}async open(t,i){typeof t=="string"&&(t=as.parse(t));const{selection:e,uri:s}=function(t){let i;const e=/^L?(\d+)(?:,(\d+))?(-L?(\d+)(?:,(\d+))?)?/.exec(t.fragment);return e&&(i={startLineNumber:parseInt(e[1]),startColumn:e[2]?parseInt(e[2]):1,endLineNumber:e[4]?parseInt(e[4]):void 0,endColumn:e[4]?e[5]?parseInt(e[5]):1:void 0},t=t.with({fragment:""})),{selection:i,uri:t}}(t);return(t=s).scheme===Lh.file&&(t=AM(t)),await this._editorService.openCodeEditor({resource:t,options:{selection:e,source:i!=null&&i.fromUserGesture?zW.USER:zW.API,...i==null?void 0:i.editorOptions}},this._editorService.getFocusedCodeEditor(),i==null?void 0:i.openToSide),!0}};GW=UW([KW(0,Pl)],GW);let ZW=class{constructor(t,i){this._openers=new Ht,this._validators=new Ht,this._resolvers=new Ht,this._resolvedUriTargets=new zf((t=>t.with({path:null,fragment:null,query:null}).toString())),this._externalOpeners=new Ht,this._defaultExternalOpener={openExternal:async t=>(Th(t,Lh.http,Lh.https)?cl(t):Wn.location.href=t,!0)},this._openers.push({open:async(t,i)=>!(!(i!=null&&i.openExternal)&&!Th(t,Lh.mailto,Lh.http,Lh.https,Lh.vsls))&&(await this._doOpenExternal(t,i),!0)}),this._openers.push(new qW(i)),this._openers.push(new GW(t))}registerOpener(t){return{dispose:this._openers.unshift(t)}}async open(t,i){var e;const s=typeof t=="string"?as.parse(t):t,n=(e=this._resolvedUriTargets.get(s))!==null&&e!==void 0?e:t;for(const t of this._validators)if(!await t.shouldOpen(n,i))return!1;for(const e of this._openers)if(await e.open(t,i))return!0;return!1}async resolveExternalUri(t,i){for(const e of this._resolvers)try{const s=await e.resolveExternalUri(t,i);if(s)return this._resolvedUriTargets.has(s.resolved)||this._resolvedUriTargets.set(s.resolved,t),s}catch{}throw new Error("Could not resolve external URI: "+t.toString())}async _doOpenExternal(t,i){const e=typeof t=="string"?as.parse(t):t;let s,n;try{s=(await this.resolveExternalUri(e,i)).resolved}catch{s=e}if(n=typeof t=="string"&&e.toString()===s.toString()?t:encodeURI(s.toString(!0)),i==null?void 0:i.allowContributedOpeners){const t=typeof(i==null?void 0:i.allowContributedOpeners)=="string"?i==null?void 0:i.allowContributedOpeners:void 0;for(const i of this._externalOpeners)if(await i.openExternal(n,{sourceUri:e,preferredOpenerId:t},ve.None))return!0}return this._defaultExternalOpener.openExternal(n,{sourceUri:e},ve.None)}dispose(){this._validators.clear()}};ZW=UW([KW(0,Pl),KW(1,ql)],ZW);const JW=_l("editorWorkerService");var QW,YW;(function(t){t[t.Hint=1]="Hint",t[t.Info=2]="Info",t[t.Warning=4]="Warning",t[t.Error=8]="Error"})(QW||(QW={})),function(t){t.compare=function(t,i){return i-t};const i=Object.create(null);i[t.Error]=tt(0,"Error"),i[t.Warning]=tt(0,"Warning"),i[t.Info]=tt(0,"Info"),t.toString=function(t){return i[t]||""},t.fromSeverity=function(i){switch(i){case dR.Error:return t.Error;case dR.Warning:return t.Warning;case dR.Info:return t.Info;case dR.Ignore:return t.Hint}},t.toSeverity=function(i){switch(i){case t.Error:return dR.Error;case t.Warning:return dR.Warning;case t.Info:return dR.Info;case t.Hint:return dR.Ignore}}}(QW||(QW={})),function(t){const i="";function e(t,e){const s=[i];return t.source?s.push(t.source.replace("¦","\\¦")):s.push(i),t.code?typeof t.code=="string"?s.push(t.code.replace("¦","\\¦")):s.push(t.code.value.replace("¦","\\¦")):s.push(i),t.severity!==void 0&&t.severity!==null?s.push(QW.toString(t.severity)):s.push(i),t.message&&e?s.push(t.message.replace("¦","\\¦")):s.push(i),t.startLineNumber!==void 0&&t.startLineNumber!==null?s.push(t.startLineNumber.toString()):s.push(i),t.startColumn!==void 0&&t.startColumn!==null?s.push(t.startColumn.toString()):s.push(i),t.endLineNumber!==void 0&&t.endLineNumber!==null?s.push(t.endLineNumber.toString()):s.push(i),t.endColumn!==void 0&&t.endColumn!==null?s.push(t.endColumn.toString()):s.push(i),s.push(i),s.join("¦")}t.makeKey=function(t){return e(t,!0)},t.makeKeyOptionalMessage=e}(YW||(YW={}));const XW=_l("markerService");var tj=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},ij=function(t,i){return function(e,s){i(e,s,t)}};let ej=class extends Qi{constructor(t,i){super(),this._markerService=i,this._onDidChangeMarker=this._register(new le),this._markerDecorations=new zf,t.getModels().forEach((t=>this._onModelAdded(t))),this._register(t.onModelAdded(this._onModelAdded,this)),this._register(t.onModelRemoved(this._onModelRemoved,this)),this._register(this._markerService.onMarkerChanged(this._handleMarkerChange,this))}dispose(){super.dispose(),this._markerDecorations.forEach((t=>t.dispose())),this._markerDecorations.clear()}getMarker(t,i){const e=this._markerDecorations.get(t);return e&&e.getMarker(i)||null}_handleMarkerChange(t){t.forEach((t=>{const i=this._markerDecorations.get(t);i&&this._updateDecorations(i)}))}_onModelAdded(t){const i=new sj(t);this._markerDecorations.set(t.uri,i),this._updateDecorations(i)}_onModelRemoved(t){var i;const e=this._markerDecorations.get(t.uri);e&&(e.dispose(),this._markerDecorations.delete(t.uri)),t.uri.scheme!==Lh.inMemory&&t.uri.scheme!==Lh.internal&&t.uri.scheme!==Lh.vscode||(i=this._markerService)===null||i===void 0||i.read({resource:t.uri}).map((t=>t.owner)).forEach((i=>this._markerService.remove(i,[t.uri])))}_updateDecorations(t){const i=this._markerService.read({resource:t.model.uri,take:500});t.update(i)&&this._onDidChangeMarker.fire(t.model)}};ej=tj([ij(0,Nl),ij(1,XW)],ej);class sj extends Qi{constructor(t){super(),this.model=t,this._map=new qf,this._register(Zi((()=>{this.model.deltaDecorations([...this._map.values()],[]),this._map.clear()})))}update(t){const{added:i,removed:e}=function(t,i){const e=[],s=[];for(const s of t)i.has(s)||e.push(s);for(const e of i)t.has(e)||s.push(e);return{removed:e,added:s}}(new Set(this._map.keys()),new Set(t));if(i.length===0&&e.length===0)return!1;const s=e.map((t=>this._map.get(t))),n=i.map((t=>({range:this._createDecorationRange(this.model,t),options:this._createDecorationOption(t)}))),r=this.model.deltaDecorations(s,n);for(const t of e)this._map.delete(t);for(let t=0;t<r.length;t++)this._map.set(i[t],r[t]);return!0}getMarker(t){return this._map.getKey(t.id)}_createDecorationRange(t,i){let e=Cs.lift(i);if(i.severity!==QW.Hint||this._hasMarkerTag(i,1)||this._hasMarkerTag(i,2)||(e=e.setEndPosition(e.startLineNumber,e.startColumn+2)),e=t.validateRange(e),e.isEmpty()){const i=t.getLineLastNonWhitespaceColumn(e.startLineNumber)||t.getLineMaxColumn(e.startLineNumber);if(i===1||e.endColumn>=i)return e;const s=t.getWordAtPosition(e.getStartPosition());s&&(e=new Cs(e.startLineNumber,s.startColumn,e.endLineNumber,s.endColumn))}else if(i.endColumn===Number.MAX_VALUE&&i.startColumn===1&&e.startLineNumber===e.endLineNumber){const s=t.getLineFirstNonWhitespaceColumn(i.startLineNumber);s<e.endColumn&&(e=new Cs(e.startLineNumber,s,e.endLineNumber,e.endColumn),i.startColumn=s)}return e}_createDecorationOption(t){let i,e,s,n,r;switch(t.severity){case QW.Hint:i=this._hasMarkerTag(t,2)?void 0:this._hasMarkerTag(t,1)?"squiggly-unnecessary":"squiggly-hint",s=0;break;case QW.Info:i="squiggly-info",e=MC(fS),s=10,r={color:MC(cb),position:1};break;case QW.Warning:i="squiggly-warning",e=MC(dS),s=20,r={color:MC(lb),position:1};break;case QW.Error:default:i="squiggly-error",e=MC(uS),s=30,r={color:MC(ab),position:1}}return t.tags&&(t.tags.indexOf(1)!==-1&&(n="squiggly-inline-unnecessary"),t.tags.indexOf(2)!==-1&&(n="squiggly-inline-deprecated")),{description:"marker-decoration",stickiness:1,className:i,showIfCollapsed:!0,overviewRuler:{color:e,position:Yf.Right},minimap:r,zIndex:s,inlineClassName:n}}_hasMarkerTag(t,i){return!!t.tags&&t.tags.indexOf(i)>=0}}var nj,rj=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},oj=function(t,i){return function(e,s){i(e,s,t)}};function hj(t){return t.toString()}class cj{constructor(t,i,e){this.model=t,this._modelEventListeners=new Ji,this.model=t,this._modelEventListeners.add(t.onWillDispose((()=>i(t)))),this._modelEventListeners.add(t.onDidChangeLanguage((i=>e(t,i))))}dispose(){this._modelEventListeners.dispose()}}const lj=yt||bt?1:2;class aj{constructor(t,i,e,s,n,r,o,h){this.uri=t,this.initialUndoRedoSnapshot=i,this.time=e,this.sharesUndoRedoStack=s,this.heapSize=n,this.sha1=r,this.versionId=o,this.alternativeVersionId=h}}let uj=nj=class extends Qi{constructor(t,i,e,s,n){super(),this._configurationService=t,this._resourcePropertiesService=i,this._undoRedoService=e,this._languageService=s,this._languageConfigurationService=n,this._onModelAdded=this._register(new le),this.onModelAdded=this._onModelAdded.event,this._onModelRemoved=this._register(new le),this.onModelRemoved=this._onModelRemoved.event,this._onModelModeChanged=this._register(new le),this.onModelLanguageChanged=this._onModelModeChanged.event,this._modelCreationOptionsByLanguageAndResource=Object.create(null),this._models={},this._disposedModels=new Map,this._disposedModelsHeapSize=0,this._register(this._configurationService.onDidChangeConfiguration((t=>this._updateModelOptions(t)))),this._updateModelOptions(void 0)}static _readModelOptions(t,i){var e;let s=$t.tabSize;if(t.editor&&t.editor.tabSize!==void 0){const i=parseInt(t.editor.tabSize,10);isNaN(i)||(s=i),s<1&&(s=1)}let n="tabSize";if(t.editor&&t.editor.indentSize!==void 0&&t.editor.indentSize!=="tabSize"){const i=parseInt(t.editor.indentSize,10);isNaN(i)||(n=Math.max(i,1))}let r=$t.insertSpaces;t.editor&&t.editor.insertSpaces!==void 0&&(r=t.editor.insertSpaces!=="false"&&!!t.editor.insertSpaces);let o=lj;const h=t.eol;h===`\r\n`?o=2:h===`\n`&&(o=1);let c=$t.trimAutoWhitespace;t.editor&&t.editor.trimAutoWhitespace!==void 0&&(c=t.editor.trimAutoWhitespace!=="false"&&!!t.editor.trimAutoWhitespace);let l=$t.detectIndentation;t.editor&&t.editor.detectIndentation!==void 0&&(l=t.editor.detectIndentation!=="false"&&!!t.editor.detectIndentation);let a=$t.largeFileOptimizations;t.editor&&t.editor.largeFileOptimizations!==void 0&&(a=t.editor.largeFileOptimizations!=="false"&&!!t.editor.largeFileOptimizations);let u=$t.bracketPairColorizationOptions;return!((e=t.editor)===null||e===void 0)&&e.bracketPairColorization&&typeof t.editor.bracketPairColorization=="object"&&(u={enabled:!!t.editor.bracketPairColorization.enabled,independentColorPoolPerBracketType:!!t.editor.bracketPairColorization.independentColorPoolPerBracketType}),{isForSimpleWidget:i,tabSize:s,indentSize:n,insertSpaces:r,detectIndentation:l,defaultEOL:o,trimAutoWhitespace:c,largeFileOptimizations:a,bracketPairColorizationOptions:u}}_getEOL(t,i){if(t)return this._resourcePropertiesService.getEOL(t,i);const e=this._configurationService.getValue("files.eol",{overrideIdentifier:i});return e&&typeof e=="string"&&e!=="auto"?e:Ft===3||Ft===2?`\n`:`\r\n`}_shouldRestoreUndoStack(){const t=this._configurationService.getValue("files.restoreUndoStack");return typeof t!="boolean"||t}getCreationOptions(t,i,e){const s=typeof t=="string"?t:t.languageId;let n=this._modelCreationOptionsByLanguageAndResource[s+i];if(!n){const t=this._configurationService.getValue("editor",{overrideIdentifier:s,resource:i}),r=this._getEOL(i,s);n=nj._readModelOptions({editor:t,eol:r},e),this._modelCreationOptionsByLanguageAndResource[s+i]=n}return n}_updateModelOptions(t){const i=this._modelCreationOptionsByLanguageAndResource;this._modelCreationOptionsByLanguageAndResource=Object.create(null);const e=Object.keys(this._models);for(let s=0,n=e.length;s<n;s++){const n=e[s],r=this._models[n],o=r.model.getLanguageId(),h=r.model.uri;if(t&&!t.affectsConfiguration("editor",{overrideIdentifier:o,resource:h})&&!t.affectsConfiguration("files.eol",{overrideIdentifier:o,resource:h}))continue;const c=i[o+h],l=this.getCreationOptions(o,h,r.model.isForSimpleWidget);nj._setModelOptionsForModel(r.model,l,c)}}static _setModelOptionsForModel(t,i,e){e&&e.defaultEOL!==i.defaultEOL&&t.getLineCount()===1&&t.setEOL(i.defaultEOL===1?0:1),e&&e.detectIndentation===i.detectIndentation&&e.insertSpaces===i.insertSpaces&&e.tabSize===i.tabSize&&e.indentSize===i.indentSize&&e.trimAutoWhitespace===i.trimAutoWhitespace&&J(e.bracketPairColorizationOptions,i.bracketPairColorizationOptions)||(i.detectIndentation?(t.detectIndentation(i.insertSpaces,i.tabSize),t.updateOptions({trimAutoWhitespace:i.trimAutoWhitespace,bracketColorizationOptions:i.bracketPairColorizationOptions})):t.updateOptions({insertSpaces:i.insertSpaces,tabSize:i.tabSize,indentSize:i.indentSize,trimAutoWhitespace:i.trimAutoWhitespace,bracketColorizationOptions:i.bracketPairColorizationOptions}))}_insertDisposedModel(t){this._disposedModels.set(hj(t.uri),t),this._disposedModelsHeapSize+=t.heapSize}_removeDisposedModel(t){const i=this._disposedModels.get(hj(t));return i&&(this._disposedModelsHeapSize-=i.heapSize),this._disposedModels.delete(hj(t)),i}_ensureDisposedModelsHeapSize(t){if(this._disposedModelsHeapSize>t){const i=[];for(this._disposedModels.forEach((t=>{t.sharesUndoRedoStack||i.push(t)})),i.sort(((t,i)=>t.time-i.time));i.length>0&&this._disposedModelsHeapSize>t;){const t=i.shift();this._removeDisposedModel(t.uri),t.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(t.initialUndoRedoSnapshot)}}}_createModelData(t,i,e,s){const n=this.getCreationOptions(i,e,s),r=new gF(t,i,n,e,this._undoRedoService,this._languageService,this._languageConfigurationService);if(e&&this._disposedModels.has(hj(e))){const t=this._removeDisposedModel(e),i=this._undoRedoService.getElements(e),s=this._getSHA1Computer(),n=!!s.canComputeSHA1(r)&&s.computeSHA1(r)===t.sha1;if(n||t.sharesUndoRedoStack){for(const t of i.past)BM(t)&&t.matchesResource(e)&&t.setModel(r);for(const t of i.future)BM(t)&&t.matchesResource(e)&&t.setModel(r);this._undoRedoService.setElementsValidFlag(e,!0,(t=>BM(t)&&t.matchesResource(e))),n&&(r._overwriteVersionId(t.versionId),r._overwriteAlternativeVersionId(t.alternativeVersionId),r._overwriteInitialUndoRedoSnapshot(t.initialUndoRedoSnapshot))}else t.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(t.initialUndoRedoSnapshot)}const o=hj(r.uri);if(this._models[o])throw new Error("ModelService: Cannot add model because it already exists!");const h=new cj(r,(t=>this._onWillDispose(t)),((t,i)=>this._onDidChangeLanguage(t,i)));return this._models[o]=h,h}createModel(t,i,e,s=!1){let n;return n=i?this._createModelData(t,i,e,s):this._createModelData(t,Yd,e,s),this._onModelAdded.fire(n.model),n.model}getModels(){const t=[],i=Object.keys(this._models);for(let e=0,s=i.length;e<s;e++){const s=i[e];t.push(this._models[s].model)}return t}getModel(t){const i=hj(t),e=this._models[i];return e?e.model:null}_schemaShouldMaintainUndoRedoElements(t){return t.scheme===Lh.file||t.scheme===Lh.vscodeRemote||t.scheme===Lh.vscodeUserData||t.scheme===Lh.vscodeNotebookCell||t.scheme==="fake-fs"}_onWillDispose(t){const i=hj(t.uri),e=this._models[i],s=this._undoRedoService.getUriComparisonKey(t.uri)!==t.uri.toString();let n=!1,r=0;if(s||this._shouldRestoreUndoStack()&&this._schemaShouldMaintainUndoRedoElements(t.uri)){const i=this._undoRedoService.getElements(t.uri);if(i.past.length>0||i.future.length>0){for(const e of i.past)BM(e)&&e.matchesResource(t.uri)&&(n=!0,r+=e.heapSize(t.uri),e.setModel(t.uri));for(const e of i.future)BM(e)&&e.matchesResource(t.uri)&&(n=!0,r+=e.heapSize(t.uri),e.setModel(t.uri))}}const o=nj.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK,h=this._getSHA1Computer();if(n)if(s||!(r>o)&&h.canComputeSHA1(t))this._ensureDisposedModelsHeapSize(o-r),this._undoRedoService.setElementsValidFlag(t.uri,!1,(i=>BM(i)&&i.matchesResource(t.uri))),this._insertDisposedModel(new aj(t.uri,e.model.getInitialUndoRedoSnapshot(),Date.now(),s,r,h.computeSHA1(t),t.getVersionId(),t.getAlternativeVersionId()));else{const t=e.model.getInitialUndoRedoSnapshot();t!==null&&this._undoRedoService.restoreSnapshot(t)}else if(!s){const t=e.model.getInitialUndoRedoSnapshot();t!==null&&this._undoRedoService.restoreSnapshot(t)}delete this._models[i],e.dispose(),delete this._modelCreationOptionsByLanguageAndResource[t.getLanguageId()+t.uri],this._onModelRemoved.fire(t)}_onDidChangeLanguage(t,i){const e=i.oldLanguage,s=t.getLanguageId(),n=this.getCreationOptions(e,t.uri,t.isForSimpleWidget),r=this.getCreationOptions(s,t.uri,t.isForSimpleWidget);nj._setModelOptionsForModel(t,r,n),this._onModelModeChanged.fire({model:t,oldLanguageId:e})}_getSHA1Computer(){return new dj}};uj.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK=20971520,uj=nj=rj([oj(0,Md),oj(1,Bp),oj(2,sF),oj(3,Id),oj(4,cf)],uj);class dj{canComputeSHA1(t){return t.getValueLength()<=dj.MAX_MODEL_SIZE}computeSHA1(t){const i=new Vh,e=t.createSnapshot();let s;for(;s=e.read();)i.update(s);return i.digest()}}var fj;dj.MAX_MODEL_SIZE=10485760,function(t){t[t.PRESERVE=0]="PRESERVE",t[t.LAST=1]="LAST"}(fj||(fj={}));const gj="workbench.contributions.quickaccess";Va.add(gj,new class{constructor(){this.providers=[],this.defaultProvider=void 0}registerQuickAccessProvider(t){return t.prefix.length===0?this.defaultProvider=t:this.providers.push(t),this.providers.sort(((t,i)=>i.prefix.length-t.prefix.length)),Zi((()=>{this.providers.splice(this.providers.indexOf(t),1),this.defaultProvider===t&&(this.defaultProvider=void 0)}))}getQuickAccessProviders(){return a([this.defaultProvider,...this.providers])}getQuickAccessProvider(t){return t&&this.providers.find((i=>t.startsWith(i.prefix)))||void 0||this.defaultProvider}});const pj={ctrlCmd:!1,alt:!1};var mj,wj;(function(t){t[t.Blur=1]="Blur",t[t.Gesture=2]="Gesture",t[t.Other=3]="Other"})(mj||(mj={})),function(t){t[t.NONE=0]="NONE",t[t.FIRST=1]="FIRST",t[t.SECOND=2]="SECOND",t[t.LAST=3]="LAST"}(wj||(wj={}));const vj=_l("quickInputService");var bj=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},yj=function(t,i){return function(e,s){i(e,s,t)}};let kj=class extends Qi{constructor(t,i){super(),this.quickInputService=t,this.instantiationService=i,this.registry=Va.as(gj),this.mapProviderToDescriptor=new Map,this.lastAcceptedPickerValues=new Map,this.visibleQuickAccess=void 0}show(t="",i){this.doShowOrPick(t,!1,i)}doShowOrPick(t,i,e){var s,n,r;const[o,h]=this.getOrInstantiateProvider(t),c=this.visibleQuickAccess,l=c==null?void 0:c.descriptor;if(c&&h&&l===h)return t===h.prefix||e!=null&&e.preserveValue||(c.picker.value=t),void this.adjustValueSelection(c.picker,h,e);if(h&&!(e!=null&&e.preserveValue)){let i;if(c&&l&&l!==h){const t=c.value.substr(l.prefix.length);t&&(i=`${h.prefix}${t}`)}if(!i){const t=o==null?void 0:o.defaultFilterValue;t===fj.LAST?i=this.lastAcceptedPickerValues.get(h):typeof t=="string"&&(i=`${h.prefix}${t}`)}typeof i=="string"&&(t=i)}const a=(s=c==null?void 0:c.picker)===null||s===void 0?void 0:s.valueSelection,u=(n=c==null?void 0:c.picker)===null||n===void 0?void 0:n.value,d=new Ji,f=d.add(this.quickInputService.createQuickPick());let g;f.value=t,this.adjustValueSelection(f,h,e),f.placeholder=h==null?void 0:h.placeholder,f.quickNavigate=e==null?void 0:e.quickNavigateConfiguration,f.hideInput=!!f.quickNavigate&&!c,(typeof(e==null?void 0:e.itemActivation)=="number"||e!=null&&e.quickNavigateConfiguration)&&(f.itemActivation=(r=e==null?void 0:e.itemActivation)!==null&&r!==void 0?r:wj.SECOND),f.contextKey=h==null?void 0:h.contextKey,f.filterValue=t=>t.substring(h?h.prefix.length:0),i&&(g=new Ao,d.add(ne.once(f.onWillAccept)((t=>{t.veto(),f.hide()})))),d.add(this.registerPickerListeners(f,o,h,t,e==null?void 0:e.providerOptions));const p=d.add(new ye);return o&&d.add(o.provide(f,p.token,e==null?void 0:e.providerOptions)),ne.once(f.onDidHide)((()=>{f.selectedItems.length===0&&p.cancel(),d.dispose(),g==null||g.complete(f.selectedItems.slice(0))})),f.show(),a&&u===t&&(f.valueSelection=a),i?g==null?void 0:g.p:void 0}adjustValueSelection(t,i,e){var s;let n;n=e!=null&&e.preserveValue?[t.value.length,t.value.length]:[(s=i==null?void 0:i.prefix.length)!==null&&s!==void 0?s:0,t.value.length],t.valueSelection=n}registerPickerListeners(t,i,e,s,n){const r=new Ji,o=this.visibleQuickAccess={picker:t,descriptor:e,value:s};return r.add(Zi((()=>{o===this.visibleQuickAccess&&(this.visibleQuickAccess=void 0)}))),r.add(t.onDidChangeValue((t=>{const[e]=this.getOrInstantiateProvider(t);e!==i?this.show(t,{preserveValue:!0,providerOptions:n}):o.value=t}))),e&&r.add(t.onDidAccept((()=>{this.lastAcceptedPickerValues.set(e,t.value)}))),r}getOrInstantiateProvider(t){const i=this.registry.getQuickAccessProvider(t);if(!i)return[void 0,void 0];let e=this.mapProviderToDescriptor.get(i);return e||(e=this.instantiationService.createInstance(i.ctor),this.mapProviderToDescriptor.set(i,e)),[e,i]}};kj=bj([yj(0,vj),yj(1,Il)],kj);class Cj extends jk{constructor(t){var i;super(),this._onChange=this._register(new le),this.onChange=this._onChange.event,this._onKeyDown=this._register(new le),this.onKeyDown=this._onKeyDown.event,this._opts=t,this._checked=this._opts.isChecked;const e=["monaco-custom-toggle"];this._opts.icon&&(this._icon=this._opts.icon,e.push(...Kl.asClassNameArray(this._icon))),this._opts.actionClassName&&e.push(...this._opts.actionClassName.split(" ")),this._checked&&e.push("checked"),this.domNode=document.createElement("div"),this._hover=this._register(lB((i=t.hoverDelegate)!==null&&i!==void 0?i:rB("mouse"),this.domNode,this._opts.title)),this.domNode.classList.add(...e),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.setAttribute("aria-label",this._opts.title),this.applyStyles(),this.onclick(this.domNode,(t=>{this.enabled&&(this.checked=!this._checked,this._onChange.fire(!1),t.preventDefault())})),this._register(this.ignoreGesture(this.domNode)),this.onkeydown(this.domNode,(t=>{if(t.keyCode===10||t.keyCode===3)return this.checked=!this._checked,this._onChange.fire(!0),t.preventDefault(),void t.stopPropagation();this._onKeyDown.fire(t)}))}get enabled(){return this.domNode.getAttribute("aria-disabled")!=="true"}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(t){this._checked=t,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}width(){return 22}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder||"",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground||"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground||"")}enable(){this.domNode.setAttribute("aria-disabled",String(!1))}disable(){this.domNode.setAttribute("aria-disabled",String(!0))}}var Sj=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o};class xj{constructor(t){this.nodes=t}toString(){return this.nodes.map((t=>typeof t=="string"?t:t.label)).join("")}}Sj([Nk],xj.prototype,"toString",null);const Dj=/\[([^\]]+)\]\(((?:https?:\/\/|command:|file:)[^\)\s]+)(?: (["'])(.+?)(\3))?\)/gi,Ej={},Aj=new __("quick-input-button-icon-");function Mj(t,i,e){let s=t.iconClass||function(t){if(!t)return;let i;const e=t.dark.toString();return Ej[e]?i=Ej[e]:(i=Aj.nextId(),Hc(`.${i}, .hc-light .${i}`,`background-image: ${ll(t.light||t.dark)}`),Hc(`.vs-dark .${i}, .hc-black .${i}`,`background-image: ${ll(t.dark)}`),Ej[e]=i),i}(t.iconPath);return t.alwaysVisible&&(s=s?`${s} always-visible`:"always-visible"),{id:i,label:"",tooltip:t.tooltip||"",class:s,enabled:!0,run:e}}function Lj(t,i,e){tl(i);const s=function(t){const i=[];let e,s=0;for(;e=Dj.exec(t);){e.index-s>0&&i.push(t.substring(s,e.index));const[,n,r,,o]=e;o?i.push({label:n,href:r,title:o}):i.push({label:n,href:r}),s=e.index+e[0].length}return s<t.length&&i.push(t.substring(s)),new xj(i)}(t);let n=0;for(const t of s.nodes)if(typeof t=="string")i.append(...bI(t));else{let s=t.title;!s&&t.href.startsWith("command:")?s=tt(0,"Click to execute command '{0}'",t.href.substring(8)):s||(s=t.href);const r=nl("a",{href:t.href,title:s,tabIndex:n++},t.label);r.style.textDecoration="underline";const o=i=>{Gc(i)&&Zc(i,!0),e.callback(t.href)},h=e.disposables.add(new uC(r,qc.CLICK)).event,c=e.disposables.add(new uC(r,qc.KEY_DOWN)).event,l=ne.chain(c,(t=>t.filter((t=>{const i=new so(t);return i.equals(10)||i.equals(3)}))));e.disposables.add(Wk.addTarget(r));const a=e.disposables.add(new uC(r,Bk.Tap)).event;ne.any(h,a,l)(o,null,e.disposables),i.appendChild(r)}}class Fj{get templateId(){return this.renderer.templateId}constructor(t,i){this.renderer=t,this.modelProvider=i}renderTemplate(t){return{data:this.renderer.renderTemplate(t),disposable:Qi.None}}renderElement(t,i,e,s){var n;if((n=e.disposable)===null||n===void 0||n.dispose(),!e.data)return;const r=this.modelProvider();if(r.isResolved(t))return this.renderer.renderElement(r.get(t),t,e.data,s);const o=new ye,h=r.resolve(t,o.token);e.disposable={dispose:()=>o.cancel()},this.renderer.renderPlaceholder(t,e.data),h.then((i=>this.renderer.renderElement(i,t,e.data,s)))}disposeTemplate(t){t.disposable&&(t.disposable.dispose(),t.disposable=void 0),t.data&&(this.renderer.disposeTemplate(t.data),t.data=void 0)}}class Tj{constructor(t,i){this.modelProvider=t,this.accessibilityProvider=i}getWidgetAriaLabel(){return this.accessibilityProvider.getWidgetAriaLabel()}getAriaLabel(t){const i=this.modelProvider();return i.isResolved(t)?this.accessibilityProvider.getAriaLabel(i.get(t)):null}}class Rj{constructor(t,i,e,s,n={}){const r=()=>this.model,o=s.map((t=>new Fj(t,r)));this.list=new W$(t,i,e,o,function(t,i){return{...i,accessibilityProvider:i.accessibilityProvider&&new Tj(t,i.accessibilityProvider)}}(r,n))}updateOptions(t){this.list.updateOptions(t)}getHTMLElement(){return this.list.getHTMLElement()}get onDidFocus(){return this.list.onDidFocus}get widget(){return this.list}get onDidDispose(){return this.list.onDidDispose}get onMouseDblClick(){return ne.map(this.list.onMouseDblClick,(({element:t,index:i,browserEvent:e})=>({element:t===void 0?void 0:this._model.get(t),index:i,browserEvent:e})))}get onPointer(){return ne.map(this.list.onPointer,(({element:t,index:i,browserEvent:e})=>({element:t===void 0?void 0:this._model.get(t),index:i,browserEvent:e})))}get onDidChangeSelection(){return ne.map(this.list.onDidChangeSelection,(({elements:t,indexes:i,browserEvent:e})=>({elements:t.map((t=>this._model.get(t))),indexes:i,browserEvent:e})))}get model(){return this._model}set model(t){this._model=t,this.list.splice(0,this.list.length,m(t.length))}getFocus(){return this.list.getFocus()}getSelection(){return this.list.getSelection()}getSelectedElements(){return this.getSelection().map((t=>this.model.get(t)))}style(t){this.list.style(t)}dispose(){this.list.dispose()}}var Oj=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Ij;(function(t){t.North="north",t.South="south",t.East="east",t.West="west"})(Ij||(Ij={}));const _j=new le,Pj=new le;class Nj{constructor(t){this.el=t,this.disposables=new Ji}get onPointerMove(){return this.disposables.add(new uC(Uh(this.el),"mousemove")).event}get onPointerUp(){return this.disposables.add(new uC(Uh(this.el),"mouseup")).event}dispose(){this.disposables.dispose()}}Oj([Nk],Nj.prototype,"onPointerMove",null),Oj([Nk],Nj.prototype,"onPointerUp",null);class Bj{get onPointerMove(){return this.disposables.add(new uC(this.el,Bk.Change)).event}get onPointerUp(){return this.disposables.add(new uC(this.el,Bk.End)).event}constructor(t){this.el=t,this.disposables=new Ji}dispose(){this.disposables.dispose()}}Oj([Nk],Bj.prototype,"onPointerMove",null),Oj([Nk],Bj.prototype,"onPointerUp",null);class $j{get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}constructor(t){this.factory=t}dispose(){}}Oj([Nk],$j.prototype,"onPointerMove",null),Oj([Nk],$j.prototype,"onPointerUp",null);const Wj="pointer-events-disabled";class jj extends Qi{get state(){return this._state}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}set state(t){this._state!==t&&(this.el.classList.toggle("disabled",t===0),this.el.classList.toggle("minimum",t===1),this.el.classList.toggle("maximum",t===2),this._state=t,this.onDidEnablementChange.fire(t))}set orthogonalStartSash(t){if(this._orthogonalStartSash!==t){if(this.orthogonalStartDragHandleDisposables.clear(),this.orthogonalStartSashDisposables.clear(),t){const i=i=>{this.orthogonalStartDragHandleDisposables.clear(),i!==0&&(this._orthogonalStartDragHandle=Yc(this.el,nl(".orthogonal-drag-handle.start")),this.orthogonalStartDragHandleDisposables.add(Zi((()=>this._orthogonalStartDragHandle.remove()))),this.orthogonalStartDragHandleDisposables.add(new uC(this._orthogonalStartDragHandle,"mouseenter")).event((()=>jj.onMouseEnter(t)),void 0,this.orthogonalStartDragHandleDisposables),this.orthogonalStartDragHandleDisposables.add(new uC(this._orthogonalStartDragHandle,"mouseleave")).event((()=>jj.onMouseLeave(t)),void 0,this.orthogonalStartDragHandleDisposables))};this.orthogonalStartSashDisposables.add(t.onDidEnablementChange.event(i,this)),i(t.state)}this._orthogonalStartSash=t}}set orthogonalEndSash(t){if(this._orthogonalEndSash!==t){if(this.orthogonalEndDragHandleDisposables.clear(),this.orthogonalEndSashDisposables.clear(),t){const i=i=>{this.orthogonalEndDragHandleDisposables.clear(),i!==0&&(this._orthogonalEndDragHandle=Yc(this.el,nl(".orthogonal-drag-handle.end")),this.orthogonalEndDragHandleDisposables.add(Zi((()=>this._orthogonalEndDragHandle.remove()))),this.orthogonalEndDragHandleDisposables.add(new uC(this._orthogonalEndDragHandle,"mouseenter")).event((()=>jj.onMouseEnter(t)),void 0,this.orthogonalEndDragHandleDisposables),this.orthogonalEndDragHandleDisposables.add(new uC(this._orthogonalEndDragHandle,"mouseleave")).event((()=>jj.onMouseLeave(t)),void 0,this.orthogonalEndDragHandleDisposables))};this.orthogonalEndSashDisposables.add(t.onDidEnablementChange.event(i,this)),i(t.state)}this._orthogonalEndSash=t}}constructor(t,i,e){super(),this.hoverDelay=300,this.hoverDelayer=this._register(new po(this.hoverDelay)),this._state=3,this.onDidEnablementChange=this._register(new le),this._onDidStart=this._register(new le),this._onDidChange=this._register(new le),this._onDidReset=this._register(new le),this._onDidEnd=this._register(new le),this.orthogonalStartSashDisposables=this._register(new Ji),this.orthogonalStartDragHandleDisposables=this._register(new Ji),this.orthogonalEndSashDisposables=this._register(new Ji),this.orthogonalEndDragHandleDisposables=this._register(new Ji),this.onDidStart=this._onDidStart.event,this.onDidChange=this._onDidChange.event,this.onDidReset=this._onDidReset.event,this.onDidEnd=this._onDidEnd.event,this.linkedSash=void 0,this.el=Yc(t,nl(".monaco-sash")),e.orthogonalEdge&&this.el.classList.add(`orthogonal-edge-${e.orthogonalEdge}`),bt&&this.el.classList.add("mac");const s=this._register(new uC(this.el,"mousedown")).event;this._register(s((i=>this.onPointerStart(i,new Nj(t))),this));const n=this._register(new uC(this.el,"dblclick")).event;this._register(n(this.onPointerDoublePress,this));const r=this._register(new uC(this.el,"mouseenter")).event;this._register(r((()=>jj.onMouseEnter(this))));const o=this._register(new uC(this.el,"mouseleave")).event;this._register(o((()=>jj.onMouseLeave(this)))),this._register(Wk.addTarget(this.el));const h=this._register(new uC(this.el,Bk.Start)).event;this._register(h((t=>this.onPointerStart(t,new Bj(this.el))),this));const c=this._register(new uC(this.el,Bk.Tap)).event;let l;this._register(c((t=>{if(l)return clearTimeout(l),l=void 0,void this.onPointerDoublePress(t);clearTimeout(l),l=setTimeout((()=>l=void 0),250)}),this)),typeof e.size=="number"?(this.size=e.size,e.orientation===0?this.el.style.width=`${this.size}px`:this.el.style.height=`${this.size}px`):(this.size=4,this._register(_j.event((t=>{this.size=t,this.layout()})))),this._register(Pj.event((t=>this.hoverDelay=t))),this.layoutProvider=i,this.orthogonalStartSash=e.orthogonalStartSash,this.orthogonalEndSash=e.orthogonalEndSash,this.orientation=e.orientation||0,this.orientation===1?(this.el.classList.add("horizontal"),this.el.classList.remove("vertical")):(this.el.classList.remove("horizontal"),this.el.classList.add("vertical")),this.el.classList.toggle("debug",!1),this.layout()}onPointerStart(t,i){Zc(t);let e=!1;if(!t.__orthogonalSashEvent){const s=this.getOrthogonalSash(t);s&&(e=!0,t.__orthogonalSashEvent=!0,s.onPointerStart(t,new $j(i)))}if(this.linkedSash&&!t.__linkedSashEvent&&(t.__linkedSashEvent=!0,this.linkedSash.onPointerStart(t,new $j(i))),!this.state)return;const s=this.el.ownerDocument.getElementsByTagName("iframe");for(const t of s)t.classList.add(Wj);const n=t.pageX,r=t.pageY,o=t.altKey,h={startX:n,currentX:n,startY:r,currentY:r,altKey:o};this.el.classList.add("active"),this._onDidStart.fire(h);const c=Pc(this.el),l=()=>{let t="";t=e?"all-scroll":this.orientation===1?this.state===1?"s-resize":this.state===2?"n-resize":bt?"row-resize":"ns-resize":this.state===1?"e-resize":this.state===2?"w-resize":bt?"col-resize":"ew-resize",c.textContent=`* { cursor: ${t} !important; }`},a=new Ji;l(),e||this.onDidEnablementChange.event(l,null,a),i.onPointerMove((t=>{Zc(t,!1);const i={startX:n,currentX:t.pageX,startY:r,currentY:t.pageY,altKey:o};this._onDidChange.fire(i)}),null,a),i.onPointerUp((t=>{Zc(t,!1),this.el.removeChild(c),this.el.classList.remove("active"),this._onDidEnd.fire(),a.dispose();for(const t of s)t.classList.remove(Wj)}),null,a),a.add(i)}onPointerDoublePress(t){const i=this.getOrthogonalSash(t);i&&i._onDidReset.fire(),this.linkedSash&&this.linkedSash._onDidReset.fire(),this._onDidReset.fire()}static onMouseEnter(t,i=!1){t.el.classList.contains("active")?(t.hoverDelayer.cancel(),t.el.classList.add("hover")):t.hoverDelayer.trigger((()=>t.el.classList.add("hover")),t.hoverDelay).then(void 0,(()=>{})),!i&&t.linkedSash&&jj.onMouseEnter(t.linkedSash,!0)}static onMouseLeave(t,i=!1){t.hoverDelayer.cancel(),t.el.classList.remove("hover"),!i&&t.linkedSash&&jj.onMouseLeave(t.linkedSash,!0)}clearSashHoverState(){jj.onMouseLeave(this)}layout(){if(this.orientation===0){const t=this.layoutProvider;this.el.style.left=t.getVerticalSashLeft(this)-this.size/2+"px",t.getVerticalSashTop&&(this.el.style.top=t.getVerticalSashTop(this)+"px"),t.getVerticalSashHeight&&(this.el.style.height=t.getVerticalSashHeight(this)+"px")}else{const t=this.layoutProvider;this.el.style.top=t.getHorizontalSashTop(this)-this.size/2+"px",t.getHorizontalSashLeft&&(this.el.style.left=t.getHorizontalSashLeft(this)+"px"),t.getHorizontalSashWidth&&(this.el.style.width=t.getHorizontalSashWidth(this)+"px")}}getOrthogonalSash(t){var i;const e=(i=t.initialTarget)!==null&&i!==void 0?i:t.target;if(e&&e instanceof HTMLElement)return e.classList.contains("orthogonal-drag-handle")?e.classList.contains("start")?this.orthogonalStartSash:this.orthogonalEndSash:void 0}dispose(){super.dispose(),this.el.remove()}}const Hj={separatorBorder:kp.transparent};class Vj{set size(t){this._size=t}get size(){return this._size}get visible(){return this._cachedVisibleSize===void 0}setVisible(t,i){var e,s;if(t!==this.visible){t?(this.size=sO(this._cachedVisibleSize,this.viewMinimumSize,this.viewMaximumSize),this._cachedVisibleSize=void 0):(this._cachedVisibleSize=typeof i=="number"?i:this.size,this.size=0),this.container.classList.toggle("visible",t);try{(s=(e=this.view).setVisible)===null||s===void 0||s.call(e,t)}catch(t){console.error("Splitview: Failed to set visible view"),console.error(t)}}}get minimumSize(){return this.visible?this.view.minimumSize:0}get viewMinimumSize(){return this.view.minimumSize}get maximumSize(){return this.visible?this.view.maximumSize:0}get viewMaximumSize(){return this.view.maximumSize}get priority(){return this.view.priority}get proportionalLayout(){var t;return(t=this.view.proportionalLayout)===null||t===void 0||t}get snap(){return!!this.view.snap}set enabled(t){this.container.style.pointerEvents=t?"":"none"}constructor(t,i,e,s){this.container=t,this.view=i,this.disposable=s,this._cachedVisibleSize=void 0,typeof e=="number"?(this._size=e,this._cachedVisibleSize=void 0,t.classList.add("visible")):(this._size=0,this._cachedVisibleSize=e.cachedVisibleSize)}layout(t,i){this.layoutContainer(t);try{this.view.layout(this.size,t,i)}catch(t){console.error("Splitview: Failed to layout view"),console.error(t)}}dispose(){this.disposable.dispose()}}class zj extends Vj{layoutContainer(t){this.container.style.top=`${t}px`,this.container.style.height=`${this.size}px`}}class Uj extends Vj{layoutContainer(t){this.container.style.left=`${t}px`,this.container.style.width=`${this.size}px`}}var Kj,qj;(function(t){t[t.Idle=0]="Idle",t[t.Busy=1]="Busy"})(Kj||(Kj={})),function(t){t.Distribute={type:"distribute"},t.Split=function(t){return{type:"split",index:t}},t.Auto=function(t){return{type:"auto",index:t}},t.Invisible=function(t){return{type:"invisible",cachedVisibleSize:t}}}(qj||(qj={}));class Gj extends Qi{get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}get startSnappingEnabled(){return this._startSnappingEnabled}get endSnappingEnabled(){return this._endSnappingEnabled}set orthogonalStartSash(t){for(const i of this.sashItems)i.sash.orthogonalStartSash=t;this._orthogonalStartSash=t}set orthogonalEndSash(t){for(const i of this.sashItems)i.sash.orthogonalEndSash=t;this._orthogonalEndSash=t}set startSnappingEnabled(t){this._startSnappingEnabled!==t&&(this._startSnappingEnabled=t,this.updateSashEnablement())}set endSnappingEnabled(t){this._endSnappingEnabled!==t&&(this._endSnappingEnabled=t,this.updateSashEnablement())}constructor(t,i={}){var e,s,n,r,o;super(),this.size=0,this._contentSize=0,this.proportions=void 0,this.viewItems=[],this.sashItems=[],this.state=Kj.Idle,this._onDidSashChange=this._register(new le),this._onDidSashReset=this._register(new le),this._startSnappingEnabled=!0,this._endSnappingEnabled=!0,this.onDidSashChange=this._onDidSashChange.event,this.onDidSashReset=this._onDidSashReset.event,this.orientation=(e=i.orientation)!==null&&e!==void 0?e:0,this.inverseAltBehavior=(s=i.inverseAltBehavior)!==null&&s!==void 0&&s,this.proportionalLayout=(n=i.proportionalLayout)===null||n===void 0||n,this.getSashOrthogonalSize=i.getSashOrthogonalSize,this.el=document.createElement("div"),this.el.classList.add("monaco-split-view2"),this.el.classList.add(this.orientation===0?"vertical":"horizontal"),t.appendChild(this.el),this.sashContainer=Yc(this.el,nl(".sash-container")),this.viewContainer=nl(".split-view-container"),this.scrollable=this._register(new Jk({forceIntegerValues:!0,smoothScrollDuration:125,scheduleAtNextAnimationFrame:t=>ac(Uh(this.el),t)})),this.scrollableElement=this._register(new nC(this.viewContainer,{vertical:this.orientation===0?(r=i.scrollbarVisibility)!==null&&r!==void 0?r:1:2,horizontal:this.orientation===1?(o=i.scrollbarVisibility)!==null&&o!==void 0?o:1:2},this.scrollable));const h=this._register(new uC(this.viewContainer,"scroll")).event;this._register(h((t=>{const i=this.scrollableElement.getScrollPosition(),e=Math.abs(this.viewContainer.scrollLeft-i.scrollLeft)<=1?void 0:this.viewContainer.scrollLeft,s=Math.abs(this.viewContainer.scrollTop-i.scrollTop)<=1?void 0:this.viewContainer.scrollTop;e===void 0&&s===void 0||this.scrollableElement.setScrollPosition({scrollLeft:e,scrollTop:s})}))),this.onDidScroll=this.scrollableElement.onScroll,this._register(this.onDidScroll((t=>{t.scrollTopChanged&&(this.viewContainer.scrollTop=t.scrollTop),t.scrollLeftChanged&&(this.viewContainer.scrollLeft=t.scrollLeft)}))),Yc(this.el,this.scrollableElement.getDomNode()),this.style(i.styles||Hj),i.descriptor&&(this.size=i.descriptor.size,i.descriptor.views.forEach(((t,i)=>{const e=B(t.visible)||t.visible?t.size:{type:"invisible",cachedVisibleSize:t.size},s=t.view;this.doAddView(s,e,i,!0)})),this._contentSize=this.viewItems.reduce(((t,i)=>t+i.size),0),this.saveProportions())}style(t){t.separatorBorder.isTransparent()?(this.el.classList.remove("separator-border"),this.el.style.removeProperty("--separator-border")):(this.el.classList.add("separator-border"),this.el.style.setProperty("--separator-border",t.separatorBorder.toString()))}addView(t,i,e=this.viewItems.length,s){this.doAddView(t,i,e,s)}layout(t,i){const e=Math.max(this.size,this._contentSize);if(this.size=t,this.layoutContext=i,this.proportions){let i=0;for(let e=0;e<this.viewItems.length;e++){const s=this.viewItems[e],n=this.proportions[e];typeof n=="number"?i+=n:t-=s.size}for(let e=0;e<this.viewItems.length;e++){const s=this.viewItems[e],n=this.proportions[e];typeof n=="number"&&i>0&&(s.size=sO(Math.round(n*t/i),s.minimumSize,s.maximumSize))}}else{const i=m(this.viewItems.length),s=i.filter((t=>this.viewItems[t].priority===1)),n=i.filter((t=>this.viewItems[t].priority===2));this.resize(this.viewItems.length-1,t-e,void 0,s,n)}this.distributeEmptySpace(),this.layoutViews()}saveProportions(){this.proportionalLayout&&this._contentSize>0&&(this.proportions=this.viewItems.map((t=>t.proportionalLayout&&t.visible?t.size/this._contentSize:void 0)))}onSashStart({sash:t,start:i,alt:e}){for(const t of this.viewItems)t.enabled=!1;const s=this.sashItems.findIndex((i=>i.sash===t)),n=Gi(sc(this.el.ownerDocument.body,"keydown",(t=>r(this.sashDragState.current,t.altKey))),sc(this.el.ownerDocument.body,"keyup",(()=>r(this.sashDragState.current,!1)))),r=(t,i)=>{const e=this.viewItems.map((t=>t.size));let r,o,h=Number.NEGATIVE_INFINITY,c=Number.POSITIVE_INFINITY;if(this.inverseAltBehavior&&(i=!i),i)if(s===this.sashItems.length-1){const t=this.viewItems[s];h=(t.minimumSize-t.size)/2,c=(t.maximumSize-t.size)/2}else{const t=this.viewItems[s+1];h=(t.size-t.maximumSize)/2,c=(t.size-t.minimumSize)/2}if(!i){const t=m(s,-1),i=m(s+1,this.viewItems.length),n=t.reduce(((t,i)=>t+(this.viewItems[i].minimumSize-e[i])),0),h=t.reduce(((t,i)=>t+(this.viewItems[i].viewMaximumSize-e[i])),0),c=i.length===0?Number.POSITIVE_INFINITY:i.reduce(((t,i)=>t+(e[i]-this.viewItems[i].minimumSize)),0),l=i.length===0?Number.NEGATIVE_INFINITY:i.reduce(((t,i)=>t+(e[i]-this.viewItems[i].viewMaximumSize)),0),a=Math.max(n,l),u=Math.min(c,h),d=this.findFirstSnapIndex(t),f=this.findFirstSnapIndex(i);if(typeof d=="number"){const t=this.viewItems[d],i=Math.floor(t.viewMinimumSize/2);r={index:d,limitDelta:t.visible?a-i:a+i,size:t.size}}if(typeof f=="number"){const t=this.viewItems[f],i=Math.floor(t.viewMinimumSize/2);o={index:f,limitDelta:t.visible?u+i:u-i,size:t.size}}}this.sashDragState={start:t,current:t,index:s,sizes:e,minDelta:h,maxDelta:c,alt:i,snapBefore:r,snapAfter:o,disposable:n}};r(i,e)}onSashChange({current:t}){const{index:i,start:e,sizes:s,alt:n,minDelta:r,maxDelta:o,snapBefore:h,snapAfter:c}=this.sashDragState;this.sashDragState.current=t;const l=t-e,a=this.resize(i,l,s,void 0,void 0,r,o,h,c);if(n){const t=i===this.sashItems.length-1,e=this.viewItems.map((t=>t.size)),s=t?i:i+1,n=this.viewItems[s],r=n.size-n.maximumSize,o=n.size-n.minimumSize,h=t?i-1:i+1;this.resize(h,-a,e,void 0,void 0,r,o)}this.distributeEmptySpace(),this.layoutViews()}onSashEnd(t){this._onDidSashChange.fire(t),this.sashDragState.disposable.dispose(),this.saveProportions();for(const t of this.viewItems)t.enabled=!0}onViewChange(t,i){const e=this.viewItems.indexOf(t);e<0||e>=this.viewItems.length||(i=sO(i=typeof i=="number"?i:t.size,t.minimumSize,t.maximumSize),this.inverseAltBehavior&&e>0?(this.resize(e-1,Math.floor((t.size-i)/2)),this.distributeEmptySpace(),this.layoutViews()):(t.size=i,this.relayout([e],void 0)))}resizeView(t,i){if(!(t<0||t>=this.viewItems.length)){if(this.state!==Kj.Idle)throw new Error("Cant modify splitview");this.state=Kj.Busy;try{const e=m(this.viewItems.length).filter((i=>i!==t)),s=[...e.filter((t=>this.viewItems[t].priority===1)),t],n=e.filter((t=>this.viewItems[t].priority===2)),r=this.viewItems[t];i=sO(i=Math.round(i),r.minimumSize,Math.min(r.maximumSize,this.size)),r.size=i,this.relayout(s,n)}finally{this.state=Kj.Idle}}}distributeViewSizes(){const t=[];let i=0;for(const e of this.viewItems)e.maximumSize-e.minimumSize>0&&(t.push(e),i+=e.size);const e=Math.floor(i/t.length);for(const i of t)i.size=sO(e,i.minimumSize,i.maximumSize);const s=m(this.viewItems.length),n=s.filter((t=>this.viewItems[t].priority===1)),r=s.filter((t=>this.viewItems[t].priority===2));this.relayout(n,r)}getViewSize(t){return t<0||t>=this.viewItems.length?-1:this.viewItems[t].size}doAddView(t,i,e=this.viewItems.length,s){if(this.state!==Kj.Idle)throw new Error("Cant modify splitview");this.state=Kj.Busy;try{const n=nl(".split-view-view");e===this.viewItems.length?this.viewContainer.appendChild(n):this.viewContainer.insertBefore(n,this.viewContainer.children.item(e));const r=t.onDidChange((t=>this.onViewChange(c,t))),o=Gi(r,Zi((()=>this.viewContainer.removeChild(n))));let h;typeof i=="number"?h=i:(i.type==="auto"&&(i=this.areViewsDistributed()?{type:"distribute"}:{type:"split",index:i.index}),h=i.type==="split"?this.getViewSize(i.index)/2:i.type==="invisible"?{cachedVisibleSize:i.cachedVisibleSize}:t.minimumSize);const c=this.orientation===0?new zj(n,t,h,o):new Uj(n,t,h,o);if(this.viewItems.splice(e,0,c),this.viewItems.length>1){const t={orthogonalStartSash:this.orthogonalStartSash,orthogonalEndSash:this.orthogonalEndSash},i=this.orientation===0?new jj(this.sashContainer,{getHorizontalSashTop:t=>this.getSashPosition(t),getHorizontalSashWidth:this.getSashOrthogonalSize},{...t,orientation:1}):new jj(this.sashContainer,{getVerticalSashLeft:t=>this.getSashPosition(t),getVerticalSashHeight:this.getSashOrthogonalSize},{...t,orientation:0}),s=this.orientation===0?t=>({sash:i,start:t.startY,current:t.currentY,alt:t.altKey}):t=>({sash:i,start:t.startX,current:t.currentX,alt:t.altKey}),n=ne.map(i.onDidStart,s)(this.onSashStart,this),r=ne.map(i.onDidChange,s)(this.onSashChange,this),o=ne.map(i.onDidEnd,(()=>this.sashItems.findIndex((t=>t.sash===i)))),h=o(this.onSashEnd,this),c=i.onDidReset((()=>{const t=this.sashItems.findIndex((t=>t.sash===i)),e=m(t,-1),s=m(t+1,this.viewItems.length),n=this.findFirstSnapIndex(e),r=this.findFirstSnapIndex(s);(typeof n!="number"||this.viewItems[n].visible)&&(typeof r!="number"||this.viewItems[r].visible)&&this._onDidSashReset.fire(t)})),l=Gi(n,r,h,c,i),a={sash:i,disposable:l};this.sashItems.splice(e-1,0,a)}let l;n.appendChild(t.element),typeof i!="number"&&i.type==="split"&&(l=[i.index]),s||this.relayout([e],l),s||typeof i=="number"||i.type!=="distribute"||this.distributeViewSizes()}finally{this.state=Kj.Idle}}relayout(t,i){const e=this.viewItems.reduce(((t,i)=>t+i.size),0);this.resize(this.viewItems.length-1,this.size-e,void 0,t,i),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}resize(t,i,e=this.viewItems.map((t=>t.size)),s,n,r=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY,h,c){if(t<0||t>=this.viewItems.length)return 0;const l=m(t,-1),a=m(t+1,this.viewItems.length);if(n)for(const t of n)v(l,t),v(a,t);if(s)for(const t of s)b(l,t),b(a,t);const u=l.map((t=>this.viewItems[t])),d=l.map((t=>e[t])),f=a.map((t=>this.viewItems[t])),g=a.map((t=>e[t])),p=l.reduce(((t,i)=>t+(this.viewItems[i].minimumSize-e[i])),0),w=l.reduce(((t,i)=>t+(this.viewItems[i].maximumSize-e[i])),0),y=a.length===0?Number.POSITIVE_INFINITY:a.reduce(((t,i)=>t+(e[i]-this.viewItems[i].minimumSize)),0),k=a.length===0?Number.NEGATIVE_INFINITY:a.reduce(((t,i)=>t+(e[i]-this.viewItems[i].maximumSize)),0),C=Math.max(p,k,r),S=Math.min(y,w,o);let x=!1;if(h){const t=this.viewItems[h.index],e=i>=h.limitDelta;x=e!==t.visible,t.setVisible(e,h.size)}if(!x&&c){const t=this.viewItems[c.index],e=i<c.limitDelta;x=e!==t.visible,t.setVisible(e,c.size)}if(x)return this.resize(t,i,e,s,n,r,o);for(let t=0,e=i=sO(i,C,S);t<u.length;t++){const i=u[t],s=sO(d[t]+e,i.minimumSize,i.maximumSize);e-=s-d[t],i.size=s}for(let t=0,e=i;t<f.length;t++){const i=f[t],s=sO(g[t]-e,i.minimumSize,i.maximumSize);e+=s-g[t],i.size=s}return i}distributeEmptySpace(t){const i=this.viewItems.reduce(((t,i)=>t+i.size),0);let e=this.size-i;const s=m(this.viewItems.length-1,-1),n=s.filter((t=>this.viewItems[t].priority===1)),r=s.filter((t=>this.viewItems[t].priority===2));for(const t of r)v(s,t);for(const t of n)b(s,t);typeof t=="number"&&b(s,t);for(let t=0;e!==0&&t<s.length;t++){const i=this.viewItems[s[t]],n=sO(i.size+e,i.minimumSize,i.maximumSize);e-=n-i.size,i.size=n}}layoutViews(){this._contentSize=this.viewItems.reduce(((t,i)=>t+i.size),0);let t=0;for(const i of this.viewItems)i.layout(t,this.layoutContext),t+=i.size;this.sashItems.forEach((t=>t.sash.layout())),this.updateSashEnablement(),this.updateScrollableElement()}updateScrollableElement(){this.orientation===0?this.scrollableElement.setScrollDimensions({height:this.size,scrollHeight:this._contentSize}):this.scrollableElement.setScrollDimensions({width:this.size,scrollWidth:this._contentSize})}updateSashEnablement(){let t=!1;const i=this.viewItems.map((i=>t=i.size-i.minimumSize>0||t));t=!1;const e=this.viewItems.map((i=>t=i.maximumSize-i.size>0||t)),s=[...this.viewItems].reverse();t=!1;const n=s.map((i=>t=i.size-i.minimumSize>0||t)).reverse();t=!1;const r=s.map((i=>t=i.maximumSize-i.size>0||t)).reverse();let o=0;for(let t=0;t<this.sashItems.length;t++){const{sash:s}=this.sashItems[t];o+=this.viewItems[t].size;const h=!(i[t]&&r[t+1]),c=!(e[t]&&n[t+1]);if(h&&c){const e=m(t,-1),r=m(t+1,this.viewItems.length),h=this.findFirstSnapIndex(e),c=this.findFirstSnapIndex(r),l=typeof h=="number"&&!this.viewItems[h].visible,a=typeof c=="number"&&!this.viewItems[c].visible;l&&n[t]&&(o>0||this.startSnappingEnabled)?s.state=1:a&&i[t]&&(o<this._contentSize||this.endSnappingEnabled)?s.state=2:s.state=0}else s.state=h&&!c?1:!h&&c?2:3}}getSashPosition(t){let i=0;for(let e=0;e<this.sashItems.length;e++)if(i+=this.viewItems[e].size,this.sashItems[e].sash===t)return i;return 0}findFirstSnapIndex(t){for(const i of t){const t=this.viewItems[i];if(t.visible&&t.snap)return i}for(const i of t){const t=this.viewItems[i];if(t.visible&&t.maximumSize-t.minimumSize>0)return;if(!t.visible&&t.snap)return i}}areViewsDistributed(){let t,i;for(const e of this.viewItems)if(t=t===void 0?e.size:Math.min(t,e.size),i=i===void 0?e.size:Math.max(i,e.size),i-t>2)return!1;return!0}dispose(){var t;(t=this.sashDragState)===null||t===void 0||t.disposable.dispose(),qi(this.viewItems),this.viewItems=[],this.sashItems.forEach((t=>t.disposable.dispose())),this.sashItems=[],super.dispose()}}class Zj{constructor(t,i,e){this.columns=t,this.getColumnSize=e,this.templateId=Zj.TemplateId,this.renderedTemplates=new Set;const s=new Map(i.map((t=>[t.templateId,t])));this.renderers=[];for(const i of t){const t=s.get(i.templateId);if(!t)throw new Error(`Table cell renderer for template id ${i.templateId} not found.`);this.renderers.push(t)}}renderTemplate(t){const i=Yc(t,nl(".monaco-table-tr")),e=[],s=[];for(let t=0;t<this.columns.length;t++){const n=this.renderers[t],r=Yc(i,nl(".monaco-table-td",{"data-col-index":t}));r.style.width=`${this.getColumnSize(t)}px`,e.push(r),s.push(n.renderTemplate(r))}const n={container:t,cellContainers:e,cellTemplateData:s};return this.renderedTemplates.add(n),n}renderElement(t,i,e,s){for(let n=0;n<this.columns.length;n++){const r=this.columns[n].project(t);this.renderers[n].renderElement(r,i,e.cellTemplateData[n],s)}}disposeElement(t,i,e,s){for(let n=0;n<this.columns.length;n++){const r=this.renderers[n];if(r.disposeElement){const o=this.columns[n].project(t);r.disposeElement(o,i,e.cellTemplateData[n],s)}}}disposeTemplate(t){for(let i=0;i<this.columns.length;i++)this.renderers[i].disposeTemplate(t.cellTemplateData[i]);ic(t.container),this.renderedTemplates.delete(t)}layoutColumn(t,i){for(const{cellContainers:e}of this.renderedTemplates)e[t].style.width=`${i}px`}}Zj.TemplateId="row";class Jj extends Qi{get minimumSize(){var t;return(t=this.column.minimumWidth)!==null&&t!==void 0?t:120}get maximumSize(){var t;return(t=this.column.maximumWidth)!==null&&t!==void 0?t:Number.POSITIVE_INFINITY}get onDidChange(){var t;return(t=this.column.onDidChangeWidthConstraints)!==null&&t!==void 0?t:ne.None}constructor(t,i){super(),this.column=t,this.index=i,this._onDidLayout=new le,this.onDidLayout=this._onDidLayout.event,this.element=nl(".monaco-table-th",{"data-col-index":i},t.label),t.tooltip&&this._register(lB(rB("mouse"),this.element,t.tooltip))}layout(t){this._onDidLayout.fire([this.index,t])}}class Qj{get onDidChangeFocus(){return this.list.onDidChangeFocus}get onDidChangeSelection(){return this.list.onDidChangeSelection}get onDidScroll(){return this.list.onDidScroll}get onMouseDblClick(){return this.list.onMouseDblClick}get onPointer(){return this.list.onPointer}get onDidFocus(){return this.list.onDidFocus}get scrollTop(){return this.list.scrollTop}set scrollTop(t){this.list.scrollTop=t}get scrollHeight(){return this.list.scrollHeight}get renderHeight(){return this.list.renderHeight}get onDidDispose(){return this.list.onDidDispose}constructor(t,i,e,s,n,r){this.virtualDelegate=e,this.domId="table_id_"+ ++Qj.InstanceCount,this.disposables=new Ji,this.cachedWidth=0,this.cachedHeight=0,this.domNode=Yc(i,nl(`.monaco-table.${this.domId}`));const o=s.map(((t,i)=>this.disposables.add(new Jj(t,i)))),h={size:o.reduce(((t,i)=>t+i.column.weight),0),views:o.map((t=>({size:t.column.weight,view:t})))};this.splitview=this.disposables.add(new Gj(this.domNode,{orientation:1,scrollbarVisibility:2,getSashOrthogonalSize:()=>this.cachedHeight,descriptor:h})),this.splitview.el.style.height=`${e.headerRowHeight}px`,this.splitview.el.style.lineHeight=`${e.headerRowHeight}px`;const c=new Zj(s,n,(t=>this.splitview.getViewSize(t)));var l;this.list=this.disposables.add(new W$(t,this.domNode,(l=e,{getHeight:t=>l.getHeight(t),getTemplateId:()=>Zj.TemplateId}),[c],r)),ne.any(...o.map((t=>t.onDidLayout)))((([t,i])=>c.layoutColumn(t,i)),null,this.disposables),this.splitview.onDidSashReset((t=>{const i=s.reduce(((t,i)=>t+i.weight),0),e=s[t].weight/i*this.cachedWidth;this.splitview.resizeView(t,e)}),null,this.disposables),this.styleElement=Pc(this.domNode),this.style(O$)}updateOptions(t){this.list.updateOptions(t)}splice(t,i,e=[]){this.list.splice(t,i,e)}getHTMLElement(){return this.domNode}style(t){const i=[];i.push(`.monaco-table.${this.domId} > .monaco-split-view2 .monaco-sash.vertical::before {\n\t\t\ttop: ${this.virtualDelegate.headerRowHeight+1}px;\n\t\t\theight: calc(100% - ${this.virtualDelegate.headerRowHeight}px);\n\t\t}`),this.styleElement.textContent=i.join(`\n`),this.list.style(t)}getSelectedElements(){return this.list.getSelectedElements()}getSelection(){return this.list.getSelection()}getFocus(){return this.list.getFocus()}dispose(){this.disposables.dispose()}}Qj.InstanceCount=0;const Yj=tt(0,"Match Case"),Xj=tt(0,"Match Whole Word"),tH=tt(0,"Use Regular Expression");class iH extends Cj{constructor(t){var i;super({icon:As.caseSensitive,title:Yj+t.appendTitle,isChecked:t.isChecked,hoverDelegate:(i=t.hoverDelegate)!==null&&i!==void 0?i:rB("element"),inputActiveOptionBorder:t.inputActiveOptionBorder,inputActiveOptionForeground:t.inputActiveOptionForeground,inputActiveOptionBackground:t.inputActiveOptionBackground})}}class eH extends Cj{constructor(t){var i;super({icon:As.wholeWord,title:Xj+t.appendTitle,isChecked:t.isChecked,hoverDelegate:(i=t.hoverDelegate)!==null&&i!==void 0?i:rB("element"),inputActiveOptionBorder:t.inputActiveOptionBorder,inputActiveOptionForeground:t.inputActiveOptionForeground,inputActiveOptionBackground:t.inputActiveOptionBackground})}}class sH extends Cj{constructor(t){var i;super({icon:As.regex,title:tH+t.appendTitle,isChecked:t.isChecked,hoverDelegate:(i=t.hoverDelegate)!==null&&i!==void 0?i:rB("element"),inputActiveOptionBorder:t.inputActiveOptionBorder,inputActiveOptionForeground:t.inputActiveOptionForeground,inputActiveOptionBackground:t.inputActiveOptionBackground})}}class nH{constructor(t,i=0,e=t.length,s=i-1){this.items=t,this.start=i,this.end=e,this.index=s}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}next(){return this.index=Math.min(this.index+1,this.end),this.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}}class rH{constructor(t=[],i=10){this._initialize(t),this._limit=i,this._onChange()}getHistory(){return this._elements}add(t){this._history.delete(t),this._history.add(t),this._onChange()}next(){return this._navigator.next()}previous(){return this._currentPosition()!==0?this._navigator.previous():null}current(){return this._navigator.current()}first(){return this._navigator.first()}last(){return this._navigator.last()}isLast(){return this._currentPosition()>=this._elements.length-1}isNowhere(){return this._navigator.current()===null}has(t){return this._history.has(t)}_onChange(){this._reduceToLimit();const t=this._elements;this._navigator=new nH(t,0,t.length,t.length)}_reduceToLimit(){const t=this._elements;t.length>this._limit&&this._initialize(t.slice(t.length-this._limit))}_currentPosition(){const t=this._navigator.current();return t?this._elements.indexOf(t):-1}_initialize(t){this._history=new Set;for(const i of t)this._history.add(i)}get _elements(){const t=[];return this._history.forEach((i=>t.push(i))),t}}const oH=nl;let hH=class extends jk{constructor(t,i,e){var s;super(),this.state="idle",this.maxHeight=Number.POSITIVE_INFINITY,this._onDidChange=this._register(new le),this.onDidChange=this._onDidChange.event,this._onDidHeightChange=this._register(new le),this.onDidHeightChange=this._onDidHeightChange.event,this.contextViewProvider=i,this.options=e,this.message=null,this.placeholder=this.options.placeholder||"",this.tooltip=(s=this.options.tooltip)!==null&&s!==void 0?s:this.placeholder||"",this.ariaLabel=this.options.ariaLabel||"",this.options.validationOptions&&(this.validation=this.options.validationOptions.validation),this.element=Yc(t,oH(".monaco-inputbox.idle"));const n=this.options.flexibleHeight?"textarea":"input",r=Yc(this.element,oH(".ibwrapper"));if(this.input=Yc(r,oH(n+".input.empty")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,(()=>this.element.classList.add("synthetic-focus"))),this.onblur(this.input,(()=>this.element.classList.remove("synthetic-focus"))),this.options.flexibleHeight){this.maxHeight=typeof this.options.flexibleMaxHeight=="number"?this.options.flexibleMaxHeight:Number.POSITIVE_INFINITY,this.mirror=Yc(r,oH("div.mirror")),this.mirror.innerText=" ",this.scrollableElement=new sC(this.element,{vertical:1}),this.options.flexibleWidth&&(this.input.setAttribute("wrap","off"),this.mirror.style.whiteSpace="pre",this.mirror.style.wordWrap="initial"),Yc(t,this.scrollableElement.getDomNode()),this._register(this.scrollableElement),this._register(this.scrollableElement.onScroll((t=>this.input.scrollTop=t.scrollTop)));const i=this._register(new uC(t.ownerDocument,"selectionchange")),e=ne.filter(i.event,(()=>{const i=t.ownerDocument.getSelection();return(i==null?void 0:i.anchorNode)===r}));this._register(e(this.updateScrollDimensions,this)),this._register(this.onDidHeightChange(this.updateScrollDimensions,this))}else this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off");this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&!this.options.showPlaceholderOnFocus&&this.setPlaceHolder(this.placeholder),this.tooltip&&this.setTooltip(this.tooltip),this.oninput(this.input,(()=>this.onValueChange())),this.onblur(this.input,(()=>this.onBlur())),this.onfocus(this.input,(()=>this.onFocus())),this._register(this.ignoreGesture(this.input)),setTimeout((()=>this.updateMirror()),0),this.options.actions&&(this.actionbar=this._register(new LW(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder","")}onFocus(){this._showMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder",this.placeholder||"")}setPlaceHolder(t){this.placeholder=t,this.input.setAttribute("placeholder",t)}setTooltip(t){this.tooltip=t,this.hover?this.hover.update(t):this.hover=this._register(lB(rB("mouse"),this.input,t))}get inputElement(){return this.input}get value(){return this.input.value}set value(t){this.input.value!==t&&(this.input.value=t,this.onValueChange())}get height(){return typeof this.cachedHeight=="number"?this.cachedHeight:Sc(this.element)}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return Fc(this.input)}select(t=null){this.input.select(),t&&(this.input.setSelectionRange(t.start,t.end),t.end===this.input.value.length&&(this.input.scrollLeft=this.input.scrollWidth))}isSelectionAtEnd(){return this.input.selectionEnd===this.input.value.length&&this.input.selectionStart===this.input.selectionEnd}getSelection(){var t;const i=this.input.selectionStart;return i===null?null:{start:i,end:(t=this.input.selectionEnd)!==null&&t!==void 0?t:i}}enable(){this.input.removeAttribute("disabled")}disable(){this.blur(),this.input.disabled=!0,this._hideMessage()}set paddingRight(t){this.input.style.width=`calc(100% - ${t}px)`,this.mirror&&(this.mirror.style.paddingRight=t+"px")}updateScrollDimensions(){if(typeof this.cachedContentHeight!="number"||typeof this.cachedHeight!="number"||!this.scrollableElement)return;const t=this.cachedContentHeight,i=this.cachedHeight,e=this.input.scrollTop;this.scrollableElement.setScrollDimensions({scrollHeight:t,height:i}),this.scrollableElement.setScrollPosition({scrollTop:e})}showMessage(t,i){if(this.state==="open"&&J(this.message,t))return;this.message=t,this.element.classList.remove("idle"),this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add(this.classForType(t.type));const e=this.stylesForType(this.message.type);this.element.style.border=`1px solid ${ul(e.border,"transparent")}`,this.message.content&&(this.hasFocus()||i)&&this._showMessage()}hideMessage(){this.message=null,this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add("idle"),this._hideMessage(),this.applyStyles()}validate(){let t=null;return this.validation&&(t=this.validation(this.value),t?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(t)):this.inputElement.hasAttribute("aria-invalid")&&(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),t==null?void 0:t.type}stylesForType(t){const i=this.options.inputBoxStyles;switch(t){case 1:return{border:i.inputValidationInfoBorder,background:i.inputValidationInfoBackground,foreground:i.inputValidationInfoForeground};case 2:return{border:i.inputValidationWarningBorder,background:i.inputValidationWarningBackground,foreground:i.inputValidationWarningForeground};default:return{border:i.inputValidationErrorBorder,background:i.inputValidationErrorBackground,foreground:i.inputValidationErrorForeground}}}classForType(t){switch(t){case 1:return"info";case 2:return"warning";default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return;let t;const i=()=>t.style.width=yc(this.element)+"px";let e;this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:1,render:e=>{var s,n;if(!this.message)return null;t=Yc(e,oH(".monaco-inputbox-container")),i();const r={inline:!0,className:"monaco-inputbox-message"},o=this.message.formatContent?dI(this.message.content,r):function(t,i={}){const e=fI(i);return e.textContent=t,e}(this.message.content,r);o.classList.add(this.classForType(this.message.type));const h=this.stylesForType(this.message.type);return o.style.backgroundColor=(s=h.background)!==null&&s!==void 0?s:"",o.style.color=(n=h.foreground)!==null&&n!==void 0?n:"",o.style.border=h.border?`1px solid ${h.border}`:"",Yc(t,o),null},onHide:()=>{this.state="closed"},layout:i}),e=this.message.type===3?tt(0,"Error: {0}",this.message.content):this.message.type===2?tt(0,"Warning: {0}",this.message.content):tt(0,"Info: {0}",this.message.content),rw(e),this.state="open"}_hideMessage(){this.contextViewProvider&&(this.state==="open"&&this.contextViewProvider.hideContextView(),this.state="idle")}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),this.input.classList.toggle("empty",!this.value),this.state==="open"&&this.contextViewProvider&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return;const t=this.value,i=t.charCodeAt(t.length-1)===10?" ":"";(t+i).replace(/\u000c/g,"")?this.mirror.textContent=t+i:this.mirror.innerText=" ",this.layout()}applyStyles(){var t,i,e;const s=this.options.inputBoxStyles,n=(t=s.inputBackground)!==null&&t!==void 0?t:"",r=(i=s.inputForeground)!==null&&i!==void 0?i:"",o=(e=s.inputBorder)!==null&&e!==void 0?e:"";this.element.style.backgroundColor=n,this.element.style.color=r,this.input.style.backgroundColor="inherit",this.input.style.color=r,this.element.style.border=`1px solid ${ul(o,"transparent")}`}layout(){if(!this.mirror)return;const t=this.cachedContentHeight;this.cachedContentHeight=Sc(this.mirror),t!==this.cachedContentHeight&&(this.cachedHeight=Math.min(this.cachedContentHeight,this.maxHeight),this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedContentHeight))}insertAtCursor(t){const i=this.inputElement,e=i.selectionStart,s=i.selectionEnd,n=i.value;e!==null&&s!==null&&(this.value=n.substr(0,e)+t+n.substr(s),i.setSelectionRange(e+1,e+1),this.layout())}dispose(){var t;this._hideMessage(),this.message=null,(t=this.actionbar)===null||t===void 0||t.dispose(),super.dispose()}};class cH extends hH{constructor(t,i,e){const s=tt(0," or {0} for history","⇅"),n=tt(0," ({0} for history)","⇅");super(t,i,e),this._onDidFocus=this._register(new le),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new le),this.onDidBlur=this._onDidBlur.event,this.history=new rH(e.history,100);const r=()=>{if(e.showHistoryHint&&e.showHistoryHint()&&!this.placeholder.endsWith(s)&&!this.placeholder.endsWith(n)&&this.history.getHistory().length){const t=this.placeholder.endsWith(")")?s:n,i=this.placeholder+t;e.showPlaceholderOnFocus&&!Fc(this.input)?this.placeholder=i:this.setPlaceHolder(i)}};this.observer=new MutationObserver(((t,i)=>{t.forEach((t=>{t.target.textContent||r()}))})),this.observer.observe(this.input,{attributeFilter:["class"]}),this.onfocus(this.input,(()=>r())),this.onblur(this.input,(()=>{const t=t=>{if(this.placeholder.endsWith(t)){const i=this.placeholder.slice(0,this.placeholder.length-t.length);return e.showPlaceholderOnFocus?this.placeholder=i:this.setPlaceHolder(i),!0}return!1};t(n)||t(s)}))}dispose(){super.dispose(),this.observer&&(this.observer.disconnect(),this.observer=void 0)}addToHistory(t){this.value&&(t||this.value!==this.getCurrentValue())&&this.history.add(this.value)}isAtLastInHistory(){return this.history.isLast()}isNowhereInHistory(){return this.history.isNowhere()}showNextValue(){this.history.has(this.value)||this.addToHistory();let t=this.getNextValue();t&&(t=t===this.value?this.getNextValue():t),this.value=t??"",ow(this.value?this.value:tt(0,"Cleared Input"))}showPreviousValue(){this.history.has(this.value)||this.addToHistory();let t=this.getPreviousValue();t&&(t=t===this.value?this.getPreviousValue():t),t&&(this.value=t,ow(this.value))}setPlaceHolder(t){super.setPlaceHolder(t),this.setTooltip(t)}onBlur(){super.onBlur(),this._onDidBlur.fire()}onFocus(){super.onFocus(),this._onDidFocus.fire()}getCurrentValue(){let t=this.history.current();return t||(t=this.history.last(),this.history.next()),t}getPreviousValue(){return this.history.previous()||this.history.first()}getNextValue(){return this.history.next()}}const lH=tt(0,"input");class aH extends jk{constructor(t,i,e){super(),this.fixFocusOnOptionClickEnabled=!0,this.imeSessionInProgress=!1,this.additionalTogglesDisposables=this._register(new Yi),this.additionalToggles=[],this._onDidOptionChange=this._register(new le),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new le),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new le),this.onMouseDown=this._onMouseDown.event,this._onInput=this._register(new le),this._onKeyUp=this._register(new le),this._onCaseSensitiveKeyDown=this._register(new le),this.onCaseSensitiveKeyDown=this._onCaseSensitiveKeyDown.event,this._onRegexKeyDown=this._register(new le),this.onRegexKeyDown=this._onRegexKeyDown.event,this._lastHighlightFindOptions=0,this.placeholder=e.placeholder||"",this.validation=e.validation,this.label=e.label||lH,this.showCommonFindToggles=!!e.showCommonFindToggles;const s=e.appendCaseSensitiveLabel||"",n=e.appendWholeWordsLabel||"",r=e.appendRegexLabel||"",o=e.history||[],h=!!e.flexibleHeight,c=!!e.flexibleWidth,l=e.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new cH(this.domNode,i,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation},history:o,showHistoryHint:e.showHistoryHint,flexibleHeight:h,flexibleWidth:c,flexibleMaxHeight:l,inputBoxStyles:e.inputBoxStyles}));const a=this._register(oB());if(this.showCommonFindToggles){this.regex=this._register(new sH({appendTitle:r,isChecked:!1,hoverDelegate:a,...e.toggleStyles})),this._register(this.regex.onChange((t=>{this._onDidOptionChange.fire(t),!t&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()}))),this._register(this.regex.onKeyDown((t=>{this._onRegexKeyDown.fire(t)}))),this.wholeWords=this._register(new eH({appendTitle:n,isChecked:!1,hoverDelegate:a,...e.toggleStyles})),this._register(this.wholeWords.onChange((t=>{this._onDidOptionChange.fire(t),!t&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()}))),this.caseSensitive=this._register(new iH({appendTitle:s,isChecked:!1,hoverDelegate:a,...e.toggleStyles})),this._register(this.caseSensitive.onChange((t=>{this._onDidOptionChange.fire(t),!t&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()}))),this._register(this.caseSensitive.onKeyDown((t=>{this._onCaseSensitiveKeyDown.fire(t)})));const t=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,(i=>{if(i.equals(15)||i.equals(17)||i.equals(9)){const e=t.indexOf(this.domNode.ownerDocument.activeElement);if(e>=0){let s=-1;i.equals(17)?s=(e+1)%t.length:i.equals(15)&&(s=e===0?t.length-1:e-1),i.equals(9)?(t[e].blur(),this.inputBox.focus()):s>=0&&t[s].focus(),Zc(i,!0)}}}))}this.controls=document.createElement("div"),this.controls.className="controls",this.controls.style.display=this.showCommonFindToggles?"":"none",this.caseSensitive&&this.controls.append(this.caseSensitive.domNode),this.wholeWords&&this.controls.appendChild(this.wholeWords.domNode),this.regex&&this.controls.appendChild(this.regex.domNode),this.setAdditionalToggles(e==null?void 0:e.additionalToggles),this.controls&&this.domNode.appendChild(this.controls),t==null||t.appendChild(this.domNode),this._register(sc(this.inputBox.inputElement,"compositionstart",(t=>{this.imeSessionInProgress=!0}))),this._register(sc(this.inputBox.inputElement,"compositionend",(t=>{this.imeSessionInProgress=!1,this._onInput.fire()}))),this.onkeydown(this.inputBox.inputElement,(t=>this._onKeyDown.fire(t))),this.onkeyup(this.inputBox.inputElement,(t=>this._onKeyUp.fire(t))),this.oninput(this.inputBox.inputElement,(t=>this._onInput.fire())),this.onmousedown(this.inputBox.inputElement,(t=>this._onMouseDown.fire(t)))}get onDidChange(){return this.inputBox.onDidChange}layout(t){this.inputBox.layout(),this.updateInputBoxPadding(t.collapsedFindWidget)}enable(){var t,i,e;this.domNode.classList.remove("disabled"),this.inputBox.enable(),(t=this.regex)===null||t===void 0||t.enable(),(i=this.wholeWords)===null||i===void 0||i.enable(),(e=this.caseSensitive)===null||e===void 0||e.enable();for(const t of this.additionalToggles)t.enable()}disable(){var t,i,e;this.domNode.classList.add("disabled"),this.inputBox.disable(),(t=this.regex)===null||t===void 0||t.disable(),(i=this.wholeWords)===null||i===void 0||i.disable(),(e=this.caseSensitive)===null||e===void 0||e.disable();for(const t of this.additionalToggles)t.disable()}setFocusInputOnOptionClick(t){this.fixFocusOnOptionClickEnabled=t}setEnabled(t){t?this.enable():this.disable()}setAdditionalToggles(t){for(const t of this.additionalToggles)t.domNode.remove();this.additionalToggles=[],this.additionalTogglesDisposables.value=new Ji;for(const i of t??[])this.additionalTogglesDisposables.value.add(i),this.controls.appendChild(i.domNode),this.additionalTogglesDisposables.value.add(i.onChange((t=>{this._onDidOptionChange.fire(t),!t&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus()}))),this.additionalToggles.push(i);this.additionalToggles.length>0&&(this.controls.style.display=""),this.updateInputBoxPadding()}updateInputBoxPadding(t=!1){var i,e,s,n,r,o;this.inputBox.paddingRight=t?0:((e=(i=this.caseSensitive)===null||i===void 0?void 0:i.width())!==null&&e!==void 0?e:0)+((n=(s=this.wholeWords)===null||s===void 0?void 0:s.width())!==null&&n!==void 0?n:0)+((o=(r=this.regex)===null||r===void 0?void 0:r.width())!==null&&o!==void 0?o:0)+this.additionalToggles.reduce(((t,i)=>t+i.width()),0)}getValue(){return this.inputBox.value}setValue(t){this.inputBox.value!==t&&(this.inputBox.value=t)}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){var t,i;return(i=(t=this.caseSensitive)===null||t===void 0?void 0:t.checked)!==null&&i!==void 0&&i}setCaseSensitive(t){this.caseSensitive&&(this.caseSensitive.checked=t)}getWholeWords(){var t,i;return(i=(t=this.wholeWords)===null||t===void 0?void 0:t.checked)!==null&&i!==void 0&&i}setWholeWords(t){this.wholeWords&&(this.wholeWords.checked=t)}getRegex(){var t,i;return(i=(t=this.regex)===null||t===void 0?void 0:t.checked)!==null&&i!==void 0&&i}setRegex(t){this.regex&&(this.regex.checked=t,this.validate())}focusOnCaseSensitive(){var t;(t=this.caseSensitive)===null||t===void 0||t.focus()}highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}showMessage(t){this.inputBox.showMessage(t)}clearMessage(){this.inputBox.hideMessage()}}var uH,dH,fH,gH,pH;(function(t){t[t.Expanded=0]="Expanded",t[t.Collapsed=1]="Collapsed",t[t.PreserveOrExpanded=2]="PreserveOrExpanded",t[t.PreserveOrCollapsed=3]="PreserveOrCollapsed"})(uH||(uH={})),function(t){t[t.Unknown=0]="Unknown",t[t.Twistie=1]="Twistie",t[t.Element=2]="Element",t[t.Filter=3]="Filter"}(dH||(dH={}));class mH extends Error{constructor(t,i){super(`TreeError [${t}] ${i}`)}}class wH{constructor(t){this.fn=t,this._map=new WeakMap}map(t){let i=this._map.get(t);return i||(i=this.fn(t),this._map.set(t,i)),i}}function vH(t){return typeof t=="object"&&"visibility"in t&&"data"in t}function bH(t){switch(t){case!0:return 1;case!1:return 0;default:return t}}function yH(t){return typeof t.collapsible=="boolean"}class kH{constructor(t,i,e,s={}){var n;this.user=t,this.list=i,this.rootRef=[],this.eventBufferer=new pe,this._onDidChangeCollapseState=new le,this.onDidChangeCollapseState=this.eventBufferer.wrapEvent(this._onDidChangeCollapseState.event),this._onDidChangeRenderNodeCount=new le,this.onDidChangeRenderNodeCount=this.eventBufferer.wrapEvent(this._onDidChangeRenderNodeCount.event),this._onDidSplice=new le,this.onDidSplice=this._onDidSplice.event,this.refilterDelayer=new po(lo),this.collapseByDefault=s.collapseByDefault!==void 0&&s.collapseByDefault,this.allowNonCollapsibleParents=(n=s.allowNonCollapsibleParents)!==null&&n!==void 0&&n,this.filter=s.filter,this.autoExpandSingleChildren=s.autoExpandSingleChildren!==void 0&&s.autoExpandSingleChildren,this.root={parent:void 0,element:e,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:!1,collapsed:!1,renderNodeCount:0,visibility:1,visible:!0,filterData:void 0}}splice(t,i,e=Wt.empty(),s={}){if(t.length===0)throw new mH(this.user,"Invalid tree location");s.diffIdentityProvider?this.spliceSmart(s.diffIdentityProvider,t,i,e,s):this.spliceSimple(t,i,e,s)}spliceSmart(t,i,e,s,n,r){var o;s===void 0&&(s=Wt.empty()),r===void 0&&(r=(o=n.diffDepth)!==null&&o!==void 0?o:0);const{parentNode:h}=this.getParentNodeWithListIndex(i);if(!h.lastDiffIds)return this.spliceSimple(i,e,s,n);const c=[...s],l=i[i.length-1],a=new Ef({getElements:()=>h.lastDiffIds},{getElements:()=>[...h.children.slice(0,l),...c,...h.children.slice(l+e)].map((i=>t.getId(i.element).toString()))}).ComputeDiff(!1);if(a.quitEarly)return h.lastDiffIds=void 0,this.spliceSimple(i,e,c,n);const u=i.slice(0,-1),d=(i,e,s)=>{if(r>0)for(let o=0;o<s;o++)i--,e--,this.spliceSmart(t,[...u,i,0],Number.MAX_SAFE_INTEGER,c[e].children,n,r-1)};let f=Math.min(h.children.length,l+e),g=c.length;for(const t of a.changes.sort(((t,i)=>i.originalStart-t.originalStart)))d(f,g,f-(t.originalStart+t.originalLength)),f=t.originalStart,g=t.modifiedStart-l,this.spliceSimple([...u,f],t.originalLength,Wt.slice(c,g,g+t.modifiedLength),n);d(f,g,f)}spliceSimple(t,i,e=Wt.empty(),{onDidCreateNode:s,onDidDeleteNode:n,diffIdentityProvider:r}){const{parentNode:o,listIndex:h,revealed:c,visible:l}=this.getParentNodeWithListIndex(t),a=[],u=Wt.map(e,(t=>this.createTreeNode(t,o,o.visible?1:0,c,a,s))),d=t[t.length-1];let f=0;for(let t=d;t>=0&&t<o.children.length;t--){const i=o.children[t];if(i.visible){f=i.visibleChildIndex;break}}const g=[];let p=0,m=0;for(const t of u)g.push(t),m+=t.renderNodeCount,t.visible&&(t.visibleChildIndex=f+p++);const w=C(o.children,d,i,g);r?o.lastDiffIds?C(o.lastDiffIds,d,i,g.map((t=>r.getId(t.element).toString()))):o.lastDiffIds=o.children.map((t=>r.getId(t.element).toString())):o.lastDiffIds=void 0;let v=0;for(const t of w)t.visible&&v++;if(v!==0)for(let t=d+g.length;t<o.children.length;t++){const i=o.children[t];i.visible&&(i.visibleChildIndex-=v)}if(o.visibleChildrenCount+=p-v,c&&l){const t=w.reduce(((t,i)=>t+(i.visible?i.renderNodeCount:0)),0);this._updateAncestorsRenderNodeCount(o,m-t),this.list.splice(h,t,a)}if(w.length>0&&n){const t=i=>{n(i),i.children.forEach(t)};w.forEach(t)}this._onDidSplice.fire({insertedNodes:g,deletedNodes:w});let b=o;for(;b;){if(b.visibility===2){this.refilterDelayer.trigger((()=>this.refilter()));break}b=b.parent}}rerender(t){if(t.length===0)throw new mH(this.user,"Invalid tree location");const{node:i,listIndex:e,revealed:s}=this.getTreeNodeWithListIndex(t);i.visible&&s&&this.list.splice(e,1,[i])}has(t){return this.hasTreeNode(t)}getListIndex(t){const{listIndex:i,visible:e,revealed:s}=this.getTreeNodeWithListIndex(t);return e&&s?i:-1}getListRenderCount(t){return this.getTreeNode(t).renderNodeCount}isCollapsible(t){return this.getTreeNode(t).collapsible}setCollapsible(t,i){const e=this.getTreeNode(t);i===void 0&&(i=!e.collapsible);const s={collapsible:i};return this.eventBufferer.bufferEvents((()=>this._setCollapseState(t,s)))}isCollapsed(t){return this.getTreeNode(t).collapsed}setCollapsed(t,i,e){const s=this.getTreeNode(t);i===void 0&&(i=!s.collapsed);const n={collapsed:i,recursive:e||!1};return this.eventBufferer.bufferEvents((()=>this._setCollapseState(t,n)))}_setCollapseState(t,i){const{node:e,listIndex:s,revealed:n}=this.getTreeNodeWithListIndex(t),r=this._setListNodeCollapseState(e,s,n,i);if(e!==this.root&&this.autoExpandSingleChildren&&r&&!yH(i)&&e.collapsible&&!e.collapsed&&!i.recursive){let s=-1;for(let t=0;t<e.children.length;t++)if(e.children[t].visible){if(s>-1){s=-1;break}s=t}s>-1&&this._setCollapseState([...t,s],i)}return r}_setListNodeCollapseState(t,i,e,s){const n=this._setNodeCollapseState(t,s,!1);if(!e||!t.visible||!n)return n;const r=t.renderNodeCount,o=this.updateNodeAfterCollapseChange(t),h=r-(i===-1?0:1);return this.list.splice(i+1,h,o.slice(1)),n}_setNodeCollapseState(t,i,e){let s;if(t===this.root?s=!1:(yH(i)?(s=t.collapsible!==i.collapsible,t.collapsible=i.collapsible):t.collapsible?(s=t.collapsed!==i.collapsed,t.collapsed=i.collapsed):s=!1,s&&this._onDidChangeCollapseState.fire({node:t,deep:e})),!yH(i)&&i.recursive)for(const e of t.children)s=this._setNodeCollapseState(e,i,!0)||s;return s}expandTo(t){this.eventBufferer.bufferEvents((()=>{let i=this.getTreeNode(t);for(;i.parent;)i=i.parent,t=t.slice(0,t.length-1),i.collapsed&&this._setCollapseState(t,{collapsed:!1,recursive:!1})}))}refilter(){const t=this.root.renderNodeCount,i=this.updateNodeAfterFilterChange(this.root);this.list.splice(0,t,i),this.refilterDelayer.cancel()}createTreeNode(t,i,e,s,n,r){const o={parent:i,element:t.element,children:[],depth:i.depth+1,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:typeof t.collapsible=="boolean"?t.collapsible:t.collapsed!==void 0,collapsed:t.collapsed===void 0?this.collapseByDefault:t.collapsed,renderNodeCount:1,visibility:1,visible:!0,filterData:void 0},h=this._filterNode(o,e);o.visibility=h,s&&n.push(o);const c=t.children||Wt.empty(),l=s&&h!==0&&!o.collapsed;let a=0,u=1;for(const t of c){const i=this.createTreeNode(t,o,h,l,n,r);o.children.push(i),u+=i.renderNodeCount,i.visible&&(i.visibleChildIndex=a++)}return this.allowNonCollapsibleParents||(o.collapsible=o.collapsible||o.children.length>0),o.visibleChildrenCount=a,o.visible=h===2?a>0:h===1,o.visible?o.collapsed||(o.renderNodeCount=u):(o.renderNodeCount=0,s&&n.pop()),r==null||r(o),o}updateNodeAfterCollapseChange(t){const i=t.renderNodeCount,e=[];return this._updateNodeAfterCollapseChange(t,e),this._updateAncestorsRenderNodeCount(t.parent,e.length-i),e}_updateNodeAfterCollapseChange(t,i){if(t.visible===!1)return 0;if(i.push(t),t.renderNodeCount=1,!t.collapsed)for(const e of t.children)t.renderNodeCount+=this._updateNodeAfterCollapseChange(e,i);return this._onDidChangeRenderNodeCount.fire(t),t.renderNodeCount}updateNodeAfterFilterChange(t){const i=t.renderNodeCount,e=[];return this._updateNodeAfterFilterChange(t,t.visible?1:0,e),this._updateAncestorsRenderNodeCount(t.parent,e.length-i),e}_updateNodeAfterFilterChange(t,i,e,s=!0){let n;if(t!==this.root){if(n=this._filterNode(t,i),n===0)return t.visible=!1,t.renderNodeCount=0,!1;s&&e.push(t)}const r=e.length;t.renderNodeCount=t===this.root?0:1;let o=!1;if(t.collapsed&&n===0)t.visibleChildrenCount=0;else{let i=0;for(const r of t.children)o=this._updateNodeAfterFilterChange(r,n,e,s&&!t.collapsed)||o,r.visible&&(r.visibleChildIndex=i++);t.visibleChildrenCount=i}return t!==this.root&&(t.visible=n===2?o:n===1,t.visibility=n),t.visible?t.collapsed||(t.renderNodeCount+=e.length-r):(t.renderNodeCount=0,s&&e.pop()),this._onDidChangeRenderNodeCount.fire(t),t.visible}_updateAncestorsRenderNodeCount(t,i){if(i!==0)for(;t;)t.renderNodeCount+=i,this._onDidChangeRenderNodeCount.fire(t),t=t.parent}_filterNode(t,i){const e=this.filter?this.filter.filter(t.element,i):1;return typeof e=="boolean"?(t.filterData=void 0,e?1:0):vH(e)?(t.filterData=e.data,bH(e.visibility)):(t.filterData=void 0,bH(e))}hasTreeNode(t,i=this.root){if(!t||t.length===0)return!0;const[e,...s]=t;return!(e<0||e>i.children.length)&&this.hasTreeNode(s,i.children[e])}getTreeNode(t,i=this.root){if(!t||t.length===0)return i;const[e,...s]=t;if(e<0||e>i.children.length)throw new mH(this.user,"Invalid tree location");return this.getTreeNode(s,i.children[e])}getTreeNodeWithListIndex(t){if(t.length===0)return{node:this.root,listIndex:-1,revealed:!0,visible:!1};const{parentNode:i,listIndex:e,revealed:s,visible:n}=this.getParentNodeWithListIndex(t),r=t[t.length-1];if(r<0||r>i.children.length)throw new mH(this.user,"Invalid tree location");const o=i.children[r];return{node:o,listIndex:e,revealed:s,visible:n&&o.visible}}getParentNodeWithListIndex(t,i=this.root,e=0,s=!0,n=!0){const[r,...o]=t;if(r<0||r>i.children.length)throw new mH(this.user,"Invalid tree location");for(let t=0;t<r;t++)e+=i.children[t].renderNodeCount;return s=s&&!i.collapsed,n=n&&i.visible,o.length===0?{parentNode:i,listIndex:e,revealed:s,visible:n}:this.getParentNodeWithListIndex(o,i.children[r],e+1,s,n)}getNode(t=[]){return this.getTreeNode(t)}getNodeLocation(t){const i=[];let e=t;for(;e.parent;)i.push(e.parent.children.indexOf(e)),e=e.parent;return i.reverse()}getParentNodeLocation(t){return t.length===0?void 0:t.length===1?[]:function(t){if(t.length===0)throw new Error("Invalid tail call");return[t.slice(0,t.length-1),t[t.length-1]]}(t)[0]}getFirstElementChild(t){const i=this.getTreeNode(t);if(i.children.length!==0)return i.children[0].element}}class CH extends bB{constructor(t){super(t.elements.map((t=>t.element))),this.data=t}}function SH(t){return t instanceof bB?new CH(t):t}class xH{constructor(t,i){this.modelProvider=t,this.dnd=i,this.autoExpandDisposable=Qi.None,this.disposables=new Ji}getDragURI(t){return this.dnd.getDragURI(t.element)}getDragLabel(t,i){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(t.map((t=>t.element)),i)}onDragStart(t,i){var e,s;(s=(e=this.dnd).onDragStart)===null||s===void 0||s.call(e,SH(t),i)}onDragOver(t,i,e,s,n,r=!0){const o=this.dnd.onDragOver(SH(t),i&&i.element,e,s,n),h=this.autoExpandNode!==i;if(h&&(this.autoExpandDisposable.dispose(),this.autoExpandNode=i),i===void 0)return o;if(h&&typeof o!="boolean"&&o.autoExpand&&(this.autoExpandDisposable=vo((()=>{const t=this.modelProvider(),e=t.getNodeLocation(i);t.isCollapsed(e)&&t.setCollapsed(e,!1),this.autoExpandNode=void 0}),500,this.disposables)),typeof o=="boolean"||!o.accept||o.bubble===void 0||o.feedback)return r?o:{accept:typeof o=="boolean"?o:o.accept,effect:typeof o=="boolean"?void 0:o.effect,feedback:[e]};if(o.bubble===1){const e=this.modelProvider(),r=e.getNodeLocation(i),o=e.getParentNodeLocation(r),h=e.getNode(o),c=o&&e.getListIndex(o);return this.onDragOver(t,h,c,s,n,!1)}const c=this.modelProvider(),l=c.getNodeLocation(i),a=c.getListIndex(l),u=c.getListRenderCount(l);return{...o,feedback:m(a,a+u)}}drop(t,i,e,s,n){this.autoExpandDisposable.dispose(),this.autoExpandNode=void 0,this.dnd.drop(SH(t),i&&i.element,e,s,n)}onDragEnd(t){var i,e;(e=(i=this.dnd).onDragEnd)===null||e===void 0||e.call(i,t)}dispose(){this.disposables.dispose(),this.dnd.dispose()}}class DH{constructor(t){this.delegate=t}getHeight(t){return this.delegate.getHeight(t.element)}getTemplateId(t){return this.delegate.getTemplateId(t.element)}hasDynamicHeight(t){return!!this.delegate.hasDynamicHeight&&this.delegate.hasDynamicHeight(t.element)}setDynamicHeight(t,i){var e,s;(s=(e=this.delegate).setDynamicHeight)===null||s===void 0||s.call(e,t.element,i)}}(function(t){t.None="none",t.OnHover="onHover",t.Always="always"})(fH||(fH={}));class EH{get elements(){return this._elements}constructor(t,i=[]){this._elements=i,this.disposables=new Ji,this.onDidChange=ne.forEach(t,(t=>this._elements=t),this.disposables)}dispose(){this.disposables.dispose()}}class AH{constructor(t,i,e,s,n,r={}){var o;this.renderer=t,this.modelProvider=i,this.activeNodes=s,this.renderedIndentGuides=n,this.renderedElements=new Map,this.renderedNodes=new Map,this.indent=AH.DefaultIndent,this.hideTwistiesOfChildlessElements=!1,this.shouldRenderIndentGuides=!1,this.activeIndentNodes=new Set,this.indentGuidesDisposable=Qi.None,this.disposables=new Ji,this.templateId=t.templateId,this.updateOptions(r),ne.map(e,(t=>t.node))(this.onDidChangeNodeTwistieState,this,this.disposables),(o=t.onDidChangeTwistieState)===null||o===void 0||o.call(t,this.onDidChangeTwistieState,this,this.disposables)}updateOptions(t={}){if(t.indent!==void 0){const i=sO(t.indent,0,40);if(i!==this.indent){this.indent=i;for(const[t,i]of this.renderedNodes)this.renderTreeElement(t,i)}}if(t.renderIndentGuides!==void 0){const i=t.renderIndentGuides!==fH.None;if(i!==this.shouldRenderIndentGuides){this.shouldRenderIndentGuides=i;for(const[t,i]of this.renderedNodes)this._renderIndentGuides(t,i);if(this.indentGuidesDisposable.dispose(),i){const t=new Ji;this.activeNodes.onDidChange(this._onDidChangeActiveNodes,this,t),this.indentGuidesDisposable=t,this._onDidChangeActiveNodes(this.activeNodes.elements)}}}t.hideTwistiesOfChildlessElements!==void 0&&(this.hideTwistiesOfChildlessElements=t.hideTwistiesOfChildlessElements)}renderTemplate(t){const i=Yc(t,nl(".monaco-tl-row")),e=Yc(i,nl(".monaco-tl-indent")),s=Yc(i,nl(".monaco-tl-twistie")),n=Yc(i,nl(".monaco-tl-contents")),r=this.renderer.renderTemplate(n);return{container:t,indent:e,twistie:s,indentGuidesDisposable:Qi.None,templateData:r}}renderElement(t,i,e,s){this.renderedNodes.set(t,e),this.renderedElements.set(t.element,t),this.renderTreeElement(t,e),this.renderer.renderElement(t,i,e.templateData,s)}disposeElement(t,i,e,s){var n,r;e.indentGuidesDisposable.dispose(),(r=(n=this.renderer).disposeElement)===null||r===void 0||r.call(n,t,i,e.templateData,s),typeof s=="number"&&(this.renderedNodes.delete(t),this.renderedElements.delete(t.element))}disposeTemplate(t){this.renderer.disposeTemplate(t.templateData)}onDidChangeTwistieState(t){const i=this.renderedElements.get(t);i&&this.onDidChangeNodeTwistieState(i)}onDidChangeNodeTwistieState(t){const i=this.renderedNodes.get(t);i&&(this._onDidChangeActiveNodes(this.activeNodes.elements),this.renderTreeElement(t,i))}renderTreeElement(t,i){const e=AH.DefaultIndent+(t.depth-1)*this.indent;i.twistie.style.paddingLeft=`${e}px`,i.indent.style.width=e+this.indent-16+"px",t.collapsible?i.container.setAttribute("aria-expanded",String(!t.collapsed)):i.container.removeAttribute("aria-expanded"),i.twistie.classList.remove(...Kl.asClassNameArray(As.treeItemExpanded));let s=!1;this.renderer.renderTwistie&&(s=this.renderer.renderTwistie(t.element,i.twistie)),t.collapsible&&(!this.hideTwistiesOfChildlessElements||t.visibleChildrenCount>0)?(s||i.twistie.classList.add(...Kl.asClassNameArray(As.treeItemExpanded)),i.twistie.classList.add("collapsible"),i.twistie.classList.toggle("collapsed",t.collapsed)):i.twistie.classList.remove("collapsible","collapsed"),this._renderIndentGuides(t,i)}_renderIndentGuides(t,i){if(ic(i.indent),i.indentGuidesDisposable.dispose(),!this.shouldRenderIndentGuides)return;const e=new Ji,s=this.modelProvider();for(;;){const n=s.getNodeLocation(t),r=s.getParentNodeLocation(n);if(!r)break;const o=s.getNode(r),h=nl(".indent-guide",{style:`width: ${this.indent}px`});this.activeIndentNodes.has(o)&&h.classList.add("active"),i.indent.childElementCount===0?i.indent.appendChild(h):i.indent.insertBefore(h,i.indent.firstElementChild),this.renderedIndentGuides.add(o,h),e.add(Zi((()=>this.renderedIndentGuides.delete(o,h)))),t=o}i.indentGuidesDisposable=e}_onDidChangeActiveNodes(t){if(!this.shouldRenderIndentGuides)return;const i=new Set,e=this.modelProvider();t.forEach((t=>{const s=e.getNodeLocation(t);try{const n=e.getParentNodeLocation(s);t.collapsible&&t.children.length>0&&!t.collapsed?i.add(t):n&&i.add(e.getNode(n))}catch{}})),this.activeIndentNodes.forEach((t=>{i.has(t)||this.renderedIndentGuides.forEach(t,(t=>t.classList.remove("active")))})),i.forEach((t=>{this.activeIndentNodes.has(t)||this.renderedIndentGuides.forEach(t,(t=>t.classList.add("active")))})),this.activeIndentNodes=i}dispose(){this.renderedNodes.clear(),this.renderedElements.clear(),this.indentGuidesDisposable.dispose(),qi(this.disposables)}}AH.DefaultIndent=8;class MH{get totalCount(){return this._totalCount}get matchCount(){return this._matchCount}constructor(t,i,e){this.tree=t,this.keyboardNavigationLabelProvider=i,this._filter=e,this._totalCount=0,this._matchCount=0,this._pattern="",this._lowercasePattern="",this.disposables=new Ji,t.onWillRefilter(this.reset,this,this.disposables)}filter(t,i){let e=1;if(this._filter){const s=this._filter.filter(t,i);if(e=typeof s=="boolean"?s?1:0:vH(s)?bH(s.visibility):s,e===0)return!1}if(this._totalCount++,!this._pattern)return this._matchCount++,{data:p_.Default,visibility:e};const s=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t),n=Array.isArray(s)?s:[s];for(const t of n){const i=t&&t.toString();if(i===void 0)return{data:p_.Default,visibility:e};let s;if(this.tree.findMatchType===pH.Contiguous){const t=i.toLowerCase().indexOf(this._lowercasePattern);if(t>-1){s=[Number.MAX_SAFE_INTEGER,0];for(let i=this._lowercasePattern.length;i>0;i--)s.push(t+i-1)}}else s=w_(this._pattern,this._lowercasePattern,0,i,i.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(s)return this._matchCount++,n.length===1?{data:s,visibility:e}:{data:{label:i,score:s},visibility:e}}return this.tree.findMode===gH.Filter?typeof this.tree.options.defaultFindVisibility=="number"?this.tree.options.defaultFindVisibility:this.tree.options.defaultFindVisibility?this.tree.options.defaultFindVisibility(t):2:{data:p_.Default,visibility:e}}reset(){this._totalCount=0,this._matchCount=0}dispose(){qi(this.disposables)}}(function(t){t[t.Highlight=0]="Highlight",t[t.Filter=1]="Filter"})(gH||(gH={})),function(t){t[t.Fuzzy=0]="Fuzzy",t[t.Contiguous=1]="Contiguous"}(pH||(pH={}));let LH=class{get pattern(){return this._pattern}get mode(){return this._mode}set mode(t){t!==this._mode&&(this._mode=t,this.widget&&(this.widget.mode=this._mode),this.tree.refilter(),this.render(),this._onDidChangeMode.fire(t))}get matchType(){return this._matchType}set matchType(t){t!==this._matchType&&(this._matchType=t,this.widget&&(this.widget.matchType=this._matchType),this.tree.refilter(),this.render(),this._onDidChangeMatchType.fire(t))}constructor(t,i,e,s,n,r={}){var o,h;this.tree=t,this.view=e,this.filter=s,this.contextViewProvider=n,this.options=r,this._pattern="",this.width=0,this._onDidChangeMode=new le,this.onDidChangeMode=this._onDidChangeMode.event,this._onDidChangeMatchType=new le,this.onDidChangeMatchType=this._onDidChangeMatchType.event,this._onDidChangePattern=new le,this._onDidChangeOpenState=new le,this.onDidChangeOpenState=this._onDidChangeOpenState.event,this.enabledDisposables=new Ji,this.disposables=new Ji,this._mode=(o=t.options.defaultFindMode)!==null&&o!==void 0?o:gH.Highlight,this._matchType=(h=t.options.defaultFindMatchType)!==null&&h!==void 0?h:pH.Fuzzy,i.onDidSplice(this.onDidSpliceModel,this,this.disposables)}updateOptions(t={}){t.defaultFindMode!==void 0&&(this.mode=t.defaultFindMode),t.defaultFindMatchType!==void 0&&(this.matchType=t.defaultFindMatchType)}onDidSpliceModel(){this.widget&&this.pattern.length!==0&&(this.tree.refilter(),this.render())}render(){var t,i,e,s;const n=this.filter.totalCount>0&&this.filter.matchCount===0;this.pattern&&n?(t=this.tree.options.showNotFoundMessage)===null||t===void 0||t?(i=this.widget)===null||i===void 0||i.showMessage({type:2,content:tt(0,"No elements found.")}):(e=this.widget)===null||e===void 0||e.showMessage({type:2}):(s=this.widget)===null||s===void 0||s.clearMessage()}shouldAllowFocus(t){return!this.widget||!this.pattern||this.filter.totalCount>0&&this.filter.matchCount<=1||!p_.isDefault(t.filterData)}layout(t){var i;this.width=t,(i=this.widget)===null||i===void 0||i.layout(t)}dispose(){this._history=void 0,this._onDidChangePattern.dispose(),this.enabledDisposables.dispose(),this.disposables.dispose()}};function FH(t,i){return t.position===i.position&&TH(t,i)}function TH(t,i){return t.node.element===i.node.element&&t.startIndex===i.startIndex&&t.height===i.height&&t.endIndex===i.endIndex}class RH{constructor(t=[]){this.stickyNodes=t}get count(){return this.stickyNodes.length}equal(t){return n(this.stickyNodes,t.stickyNodes,FH)}lastNodePartiallyVisible(){if(this.count===0)return!1;const t=this.stickyNodes[this.count-1];if(this.count===1)return t.position!==0;const i=this.stickyNodes[this.count-2];return i.position+i.height!==t.position}animationStateChanged(t){if(!n(this.stickyNodes,t.stickyNodes,TH)||this.count===0)return!1;const i=this.stickyNodes[this.count-1],e=t.stickyNodes[t.count-1];return i.position!==e.position}}class OH{constrainStickyScrollNodes(t,i,e){for(let s=0;s<t.length;s++){const n=t[s];if(n.position+n.height>e||s>=i)return t.slice(0,s)}return t}}let IH=class extends Qi{constructor(t,i,e,s,n,r={}){var o;super(),this.tree=t,this.model=i,this.view=e,this.treeDelegate=n,this.maxWidgetViewRatio=.4;const h=this.validateStickySettings(r);this.stickyScrollMaxItemCount=h.stickyScrollMaxItemCount,this.stickyScrollDelegate=(o=r.stickyScrollDelegate)!==null&&o!==void 0?o:new OH,this._widget=this._register(new _H(e.getScrollableElement(),e,t,s,n,r.accessibilityProvider)),this.onDidChangeHasFocus=this._widget.onDidChangeHasFocus,this.onContextMenu=this._widget.onContextMenu,this._register(e.onDidScroll((()=>this.update()))),this._register(e.onDidChangeContentHeight((()=>this.update()))),this._register(t.onDidChangeCollapseState((()=>this.update()))),this.update()}get height(){return this._widget.height}getNodeAtHeight(t){let i;if(i=t===0?this.view.firstVisibleIndex:this.view.indexAt(t+this.view.scrollTop),!(i<0||i>=this.view.length))return this.view.element(i)}update(){const t=this.getNodeAtHeight(0);if(!t||this.tree.scrollTop===0)return void this._widget.setState(void 0);const i=this.findStickyState(t);this._widget.setState(i)}findStickyState(t){const i=[];let e=t,s=0,n=this.getNextStickyNode(e,void 0,s);for(;n&&(i.push(n),s+=n.height,!(i.length<=this.stickyScrollMaxItemCount)||(e=this.getNextVisibleNode(n),e));)n=this.getNextStickyNode(e,n.node,s);const r=this.constrainStickyNodes(i);return r.length?new RH(r):void 0}getNextVisibleNode(t){return this.getNodeAtHeight(t.position+t.height)}getNextStickyNode(t,i,e){const s=this.getAncestorUnderPrevious(t,i);if(s)return s===t&&(!this.nodeIsUncollapsedParent(t)||this.nodeTopAlignsWithStickyNodesBottom(t,e))?void 0:this.createStickyScrollNode(s,e)}nodeTopAlignsWithStickyNodesBottom(t,i){const e=this.getNodeIndex(t),s=this.view.getElementTop(e),n=i;return this.view.scrollTop===s-n}createStickyScrollNode(t,i){const e=this.treeDelegate.getHeight(t),{startIndex:s,endIndex:n}=this.getNodeRange(t);return{node:t,position:this.calculateStickyNodePosition(n,i,e),height:e,startIndex:s,endIndex:n}}getAncestorUnderPrevious(t,i=void 0){let e=t,s=this.getParentNode(e);for(;s;){if(s===i)return e;e=s,s=this.getParentNode(e)}if(i===void 0)return e}calculateStickyNodePosition(t,i,e){let s=this.view.getRelativeTop(t);if(s===null&&this.view.firstVisibleIndex===t&&t+1<this.view.length){const i=this.treeDelegate.getHeight(this.view.element(t)),e=this.view.getRelativeTop(t+1);s=e?e-i/this.view.renderHeight:null}if(s===null)return i;const n=this.view.element(t),r=this.treeDelegate.getHeight(n),o=s*this.view.renderHeight+r;return i+e>o&&i<=o?o-e:i}constrainStickyNodes(t){if(t.length===0)return[];const i=this.view.renderHeight*this.maxWidgetViewRatio,e=t[t.length-1];if(t.length<=this.stickyScrollMaxItemCount&&e.position+e.height<=i)return t;const s=this.stickyScrollDelegate.constrainStickyScrollNodes(t,this.stickyScrollMaxItemCount,i);if(!s.length)return[];const n=s[s.length-1];if(s.length>this.stickyScrollMaxItemCount||n.position+n.height>i)throw new Error("stickyScrollDelegate violates constraints");return s}getParentNode(t){const i=this.model.getNodeLocation(t),e=this.model.getParentNodeLocation(i);return e?this.model.getNode(e):void 0}nodeIsUncollapsedParent(t){const i=this.model.getNodeLocation(t);return this.model.getListRenderCount(i)>1}getNodeIndex(t){const i=this.model.getNodeLocation(t);return this.model.getListIndex(i)}getNodeRange(t){const i=this.model.getNodeLocation(t),e=this.model.getListIndex(i);if(e<0)throw new Error("Node not found in tree");return{startIndex:e,endIndex:e+this.model.getListRenderCount(i)-1}}nodePositionTopBelowWidget(t){const i=[];let e=this.getParentNode(t);for(;e;)i.push(e),e=this.getParentNode(e);let s=0;for(let t=0;t<i.length&&t<this.stickyScrollMaxItemCount;t++)s+=this.treeDelegate.getHeight(i[t]);return s}domFocus(){this._widget.domFocus()}focusedLast(){return this._widget.focusedLast()}updateOptions(t={}){if(!t.stickyScrollMaxItemCount)return;const i=this.validateStickySettings(t);this.stickyScrollMaxItemCount!==i.stickyScrollMaxItemCount&&(this.stickyScrollMaxItemCount=i.stickyScrollMaxItemCount,this.update())}validateStickySettings(t){let i=7;return typeof t.stickyScrollMaxItemCount=="number"&&(i=Math.max(t.stickyScrollMaxItemCount,1)),{stickyScrollMaxItemCount:i}}},_H=class{constructor(t,i,e,s,n,r){this.view=i,this.tree=e,this.treeRenderers=s,this.treeDelegate=n,this.accessibilityProvider=r,this._previousElements=[],this._previousStateDisposables=new Ji,this._rootDomNode=nl(".monaco-tree-sticky-container.empty"),t.appendChild(this._rootDomNode);const o=nl(".monaco-tree-sticky-container-shadow");this._rootDomNode.appendChild(o),this.stickyScrollFocus=new PH(this._rootDomNode,i),this.onDidChangeHasFocus=this.stickyScrollFocus.onDidChangeHasFocus,this.onContextMenu=this.stickyScrollFocus.onContextMenu}get height(){if(!this._previousState)return 0;const t=this._previousState.stickyNodes[this._previousState.count-1];return t.position+t.height}setState(t){const i=!!this._previousState&&this._previousState.count>0,e=!!t&&t.count>0;if(!i&&!e||i&&e&&this._previousState.equal(t))return;if(i!==e&&this.setVisible(e),!e)return this._previousState=void 0,this._previousElements=[],void this._previousStateDisposables.clear();const s=t.stickyNodes[t.count-1];if(this._previousState&&t.animationStateChanged(this._previousState))this._previousElements[this._previousState.count-1].style.top=`${s.position}px`;else{this._previousStateDisposables.clear();const i=Array(t.count);for(let e=t.count-1;e>=0;e--){const s=t.stickyNodes[e],{element:n,disposable:r}=this.createElement(s,e,t.count);i[e]=n,this._rootDomNode.appendChild(n),this._previousStateDisposables.add(r)}this.stickyScrollFocus.updateElements(i,t),this._previousElements=i}this._previousState=t,this._rootDomNode.style.height=`${s.position+s.height}px`}createElement(t,i,e){const s=t.startIndex,n=document.createElement("div");n.style.top=`${t.position}px`,this.tree.options.setRowHeight!==!1&&(n.style.height=`${t.height}px`),this.tree.options.setRowLineHeight!==!1&&(n.style.lineHeight=`${t.height}px`),n.classList.add("monaco-tree-sticky-row"),n.classList.add("monaco-list-row"),n.setAttribute("data-index",`${s}`),n.setAttribute("data-parity",s%2==0?"even":"odd"),n.setAttribute("id",this.view.getElementID(s));const r=this.setAccessibilityAttributes(n,t.node.element,i,e),o=this.treeDelegate.getTemplateId(t.node),h=this.treeRenderers.find((t=>t.templateId===o));if(!h)throw new Error(`No renderer found for template id ${o}`);let c=t.node;c===this.tree.getNode(this.tree.getNodeLocation(t.node))&&(c=new Proxy(t.node,{}));const l=h.renderTemplate(n);h.renderElement(c,t.startIndex,l,t.height);const a=Zi((()=>{r.dispose(),h.disposeElement(c,t.startIndex,l,t.height),h.disposeTemplate(l),n.remove()}));return{element:n,disposable:a}}setAccessibilityAttributes(t,i,e,s){var n;if(!this.accessibilityProvider)return Qi.None;this.accessibilityProvider.getSetSize&&t.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(i,e,s))),this.accessibilityProvider.getPosInSet&&t.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(i,e))),this.accessibilityProvider.getRole&&t.setAttribute("role",(n=this.accessibilityProvider.getRole(i))!==null&&n!==void 0?n:"treeitem");const r=this.accessibilityProvider.getAriaLabel(i),o=r&&typeof r!="string"?r:t$(r),h=ZB((i=>{const e=i.readObservable(o);e?t.setAttribute("aria-label",e):t.removeAttribute("aria-label")}));typeof r=="string"||r&&t.setAttribute("aria-label",r.get());const c=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(i);return typeof c=="number"&&t.setAttribute("aria-level",`${c}`),t.setAttribute("aria-selected",String(!1)),h}setVisible(t){this._rootDomNode.classList.toggle("empty",!t),t||this.stickyScrollFocus.updateElements([],void 0)}domFocus(){this.stickyScrollFocus.domFocus()}focusedLast(){return this.stickyScrollFocus.focusedLast()}dispose(){this.stickyScrollFocus.dispose(),this._previousStateDisposables.dispose(),this._rootDomNode.remove()}};class PH extends Qi{get domHasFocus(){return this._domHasFocus}set domHasFocus(t){t!==this._domHasFocus&&(this._onDidChangeHasFocus.fire(t),this._domHasFocus=t)}constructor(t,i){super(),this.container=t,this.view=i,this.focusedIndex=-1,this.elements=[],this._onDidChangeHasFocus=new le,this.onDidChangeHasFocus=this._onDidChangeHasFocus.event,this._onContextMenu=new le,this.onContextMenu=this._onContextMenu.event,this._domHasFocus=!1,this.container.addEventListener("focus",(()=>this.onFocus())),this.container.addEventListener("blur",(()=>this.onBlur())),this._register(this.view.onDidFocus((()=>this.toggleStickyScrollFocused(!1)))),this._register(this.view.onKeyDown((t=>this.onKeyDown(t)))),this._register(this.view.onMouseDown((t=>this.onMouseDown(t)))),this._register(this.view.onContextMenu((t=>this.handleContextMenu(t))))}handleContextMenu(t){const i=t.browserEvent.target;if(!y$(i)&&!b$(i))return void(this.focusedLast()&&this.view.domFocus());if(!Kc(t.browserEvent)){if(!this.state)throw new Error("Context menu should not be triggered when state is undefined");const i=this.state.stickyNodes.findIndex((i=>{var e;return i.node.element===((e=t.element)===null||e===void 0?void 0:e.element)}));if(i===-1)throw new Error("Context menu should not be triggered when element is not in sticky scroll widget");return this.container.focus(),void this.setFocus(i)}if(!this.state||this.focusedIndex<0)throw new Error("Context menu key should not be triggered when focus is not in sticky scroll widget");const e=this.state.stickyNodes[this.focusedIndex].node.element,s=this.elements[this.focusedIndex];this._onContextMenu.fire({element:e,anchor:s,browserEvent:t.browserEvent,isStickyScroll:!0})}onKeyDown(t){if(this.domHasFocus&&this.state){if(t.key==="ArrowUp")this.setFocusedElement(Math.max(0,this.focusedIndex-1)),t.preventDefault(),t.stopPropagation();else if(t.key==="ArrowDown"||t.key==="ArrowRight"){if(this.focusedIndex>=this.state.count-1){const t=this.state.stickyNodes[this.state.count-1].startIndex+1;this.view.domFocus(),this.view.setFocus([t]),this.scrollNodeUnderWidget(t,this.state)}else this.setFocusedElement(this.focusedIndex+1);t.preventDefault(),t.stopPropagation()}}}onMouseDown(t){const i=t.browserEvent.target;(y$(i)||b$(i))&&(t.browserEvent.preventDefault(),t.browserEvent.stopPropagation())}updateElements(t,i){if(i&&i.count===0)throw new Error("Sticky scroll state must be undefined when there are no sticky nodes");if(i&&i.count!==t.length)throw new Error("Sticky scroll focus received illigel state");const e=this.focusedIndex;if(this.removeFocus(),this.elements=t,this.state=i,i){const t=sO(e,0,i.count-1);this.setFocus(t)}else this.domHasFocus&&this.view.domFocus();this.container.tabIndex=i?0:-1}setFocusedElement(t){const i=this.state;if(!i)throw new Error("Cannot set focus when state is undefined");if(this.setFocus(t),!(t<i.count-1)&&i.lastNodePartiallyVisible()){const e=i.stickyNodes[t];this.scrollNodeUnderWidget(e.endIndex+1,i)}}scrollNodeUnderWidget(t,i){const e=i.stickyNodes[i.count-1],s=i.count>1?i.stickyNodes[i.count-2]:void 0,n=this.view.getElementTop(t),r=s?s.position+s.height+e.height:e.height;this.view.scrollTop=n-r}domFocus(){if(!this.state)throw new Error("Cannot focus when state is undefined");this.container.focus()}focusedLast(){return!!this.state&&this.view.getHTMLElement().classList.contains("sticky-scroll-focused")}removeFocus(){this.focusedIndex!==-1&&(this.toggleElementFocus(this.elements[this.focusedIndex],!1),this.focusedIndex=-1)}setFocus(t){if(0>t)throw new Error("addFocus() can not remove focus");if(!this.state&&t>=0)throw new Error("Cannot set focus index when state is undefined");if(this.state&&t>=this.state.count)throw new Error("Cannot set focus index to an index that does not exist");const i=this.focusedIndex;i>=0&&this.toggleElementFocus(this.elements[i],!1),t>=0&&this.toggleElementFocus(this.elements[t],!0),this.focusedIndex=t}toggleElementFocus(t,i){this.toggleElementActiveFocus(t,i&&this.domHasFocus),this.toggleElementPassiveFocus(t,i)}toggleCurrentElementActiveFocus(t){this.focusedIndex!==-1&&this.toggleElementActiveFocus(this.elements[this.focusedIndex],t)}toggleElementActiveFocus(t,i){t.classList.toggle("focused",i)}toggleElementPassiveFocus(t,i){t.classList.toggle("passive-focused",i)}toggleStickyScrollFocused(t){this.view.getHTMLElement().classList.toggle("sticky-scroll-focused",t)}onFocus(){if(!this.state||this.elements.length===0)throw new Error("Cannot focus when state is undefined or elements are empty");this.domHasFocus=!0,this.toggleStickyScrollFocused(!0),this.toggleCurrentElementActiveFocus(!0),this.focusedIndex===-1&&this.setFocus(0)}onBlur(){this.domHasFocus=!1,this.toggleCurrentElementActiveFocus(!1)}dispose(){this.toggleStickyScrollFocused(!1),this._onDidChangeHasFocus.fire(!1),super.dispose()}}function NH(t){let i=dH.Unknown;return Dc(t.browserEvent.target,"monaco-tl-twistie","monaco-tl-row")?i=dH.Twistie:Dc(t.browserEvent.target,"monaco-tl-contents","monaco-tl-row")?i=dH.Element:Dc(t.browserEvent.target,"monaco-tree-type-filter","monaco-list")&&(i=dH.Filter),{browserEvent:t.browserEvent,element:t.element?t.element.element:null,target:i}}function BH(t){const i=y$(t.browserEvent.target);return{element:t.element?t.element.element:null,browserEvent:t.browserEvent,anchor:t.anchor,isStickyScroll:i}}function $H(t,i){i(t),t.children.forEach((t=>$H(t,i)))}class WH{get nodeSet(){return this._nodeSet||(this._nodeSet=this.createNodeSet()),this._nodeSet}constructor(t,i){this.getFirstViewElementWithTrait=t,this.identityProvider=i,this.nodes=[],this._onDidChange=new le,this.onDidChange=this._onDidChange.event}set(t,i){!(i!=null&&i.__forceEvent)&&n(this.nodes,t)||this._set(t,!1,i)}_set(t,i,e){if(this.nodes=[...t],this.elements=void 0,this._nodeSet=void 0,!i){const t=this;this._onDidChange.fire({get elements(){return t.get()},browserEvent:e})}}get(){return this.elements||(this.elements=this.nodes.map((t=>t.element))),[...this.elements]}getNodes(){return this.nodes}has(t){return this.nodeSet.has(t)}onDidModelSplice({insertedNodes:t,deletedNodes:i}){if(!this.identityProvider){const t=this.createNodeSet(),e=i=>t.delete(i);return i.forEach((t=>$H(t,e))),void this.set([...t.values()])}const e=new Set,s=t=>e.add(this.identityProvider.getId(t.element).toString());i.forEach((t=>$H(t,s)));const n=new Map,r=t=>n.set(this.identityProvider.getId(t.element).toString(),t);t.forEach((t=>$H(t,r)));const o=[];for(const t of this.nodes){const i=this.identityProvider.getId(t.element).toString();if(e.has(i)){const t=n.get(i);t&&t.visible&&o.push(t)}else o.push(t)}if(this.nodes.length>0&&o.length===0){const t=this.getFirstViewElementWithTrait();t&&o.push(t)}this._set(o,!0)}createNodeSet(){const t=new Set;for(const i of this.nodes)t.add(i);return t}}class jH extends T${constructor(t,i,e){super(t),this.tree=i,this.stickyScrollProvider=e}onViewPointer(t){if(k$(t.browserEvent.target)||m$(t.browserEvent.target)||v$(t.browserEvent.target)||t.browserEvent.isHandledByList)return;const i=t.element;if(!i)return super.onViewPointer(t);if(this.isSelectionRangeChangeEvent(t)||this.isSelectionSingleChangeEvent(t))return super.onViewPointer(t);const e=t.browserEvent.target,s=e.classList.contains("monaco-tl-twistie")||e.classList.contains("monaco-icon-label")&&e.classList.contains("folder-icon")&&t.browserEvent.offsetX<16,n=b$(t.browserEvent.target);let r=!1;if(r=!!n||(typeof this.tree.expandOnlyOnTwistieClick=="function"?this.tree.expandOnlyOnTwistieClick(i.element):!!this.tree.expandOnlyOnTwistieClick),n)this.handleStickyScrollMouseEvent(t,i);else{if(r&&!s&&t.browserEvent.detail!==2)return super.onViewPointer(t);if(!this.tree.expandOnDoubleClick&&t.browserEvent.detail===2)return super.onViewPointer(t)}if(i.collapsible&&(!n||s)){const e=this.tree.getNodeLocation(i),n=t.browserEvent.altKey;if(this.tree.setFocus([e]),this.tree.toggleCollapsed(e,n),r&&s)return void(t.browserEvent.isHandledByList=!0)}n||super.onViewPointer(t)}handleStickyScrollMouseEvent(t,i){if(function(t){return w$(t,"monaco-custom-toggle")}(t.browserEvent.target)||function(t){return w$(t,"action-item")}(t.browserEvent.target))return;const e=this.stickyScrollProvider();if(!e)throw new Error("Sticky scroll controller not found");const s=this.list.indexOf(i),n=this.list.getElementTop(s),r=e.nodePositionTopBelowWidget(i);this.tree.scrollTop=n-r,this.list.domFocus(),this.list.setFocus([s]),this.list.setSelection([s])}onDoubleClick(t){!t.browserEvent.target.classList.contains("monaco-tl-twistie")&&this.tree.expandOnDoubleClick&&(t.browserEvent.isHandledByList||super.onDoubleClick(t))}onMouseDown(t){const i=t.browserEvent.target;y$(i)||b$(i)||super.onMouseDown(t)}onContextMenu(t){const i=t.browserEvent.target;y$(i)||b$(i)||super.onContextMenu(t)}}class HH extends W${constructor(t,i,e,s,n,r,o,h){super(t,i,e,s,h),this.focusTrait=n,this.selectionTrait=r,this.anchorTrait=o}createMouseController(t){return new jH(this,t.tree,t.stickyScrollProvider)}splice(t,i,e=[]){if(super.splice(t,i,e),e.length===0)return;const s=[],n=[];let r;e.forEach(((i,e)=>{this.focusTrait.has(i)&&s.push(t+e),this.selectionTrait.has(i)&&n.push(t+e),this.anchorTrait.has(i)&&(r=t+e)})),s.length>0&&super.setFocus(g([...super.getFocus(),...s])),n.length>0&&super.setSelection(g([...super.getSelection(),...n])),typeof r=="number"&&super.setAnchor(r)}setFocus(t,i,e=!1){super.setFocus(t,i),e||this.focusTrait.set(t.map((t=>this.element(t))),i)}setSelection(t,i,e=!1){super.setSelection(t,i),e||this.selectionTrait.set(t.map((t=>this.element(t))),i)}setAnchor(t,i=!1){super.setAnchor(t),i||(t===void 0?this.anchorTrait.set([]):this.anchorTrait.set([this.element(t)]))}}class VH{get onDidScroll(){return this.view.onDidScroll}get onDidChangeFocus(){return this.eventBufferer.wrapEvent(this.focus.onDidChange)}get onDidChangeSelection(){return this.eventBufferer.wrapEvent(this.selection.onDidChange)}get onMouseDblClick(){return ne.filter(ne.map(this.view.onMouseDblClick,NH),(t=>t.target!==dH.Filter))}get onMouseOver(){return ne.map(this.view.onMouseOver,NH)}get onMouseOut(){return ne.map(this.view.onMouseOut,NH)}get onContextMenu(){var t,i;return ne.any(ne.filter(ne.map(this.view.onContextMenu,BH),(t=>!t.isStickyScroll)),(i=(t=this.stickyScrollController)===null||t===void 0?void 0:t.onContextMenu)!==null&&i!==void 0?i:ne.None)}get onPointer(){return ne.map(this.view.onPointer,NH)}get onKeyDown(){return this.view.onKeyDown}get onDidFocus(){return this.view.onDidFocus}get onDidChangeModel(){return ne.signal(this.model.onDidSplice)}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get findMode(){var t,i;return(i=(t=this.findController)===null||t===void 0?void 0:t.mode)!==null&&i!==void 0?i:gH.Highlight}set findMode(t){this.findController&&(this.findController.mode=t)}get findMatchType(){var t,i;return(i=(t=this.findController)===null||t===void 0?void 0:t.matchType)!==null&&i!==void 0?i:pH.Fuzzy}set findMatchType(t){this.findController&&(this.findController.matchType=t)}get expandOnDoubleClick(){return this._options.expandOnDoubleClick===void 0||this._options.expandOnDoubleClick}get expandOnlyOnTwistieClick(){return this._options.expandOnlyOnTwistieClick===void 0||this._options.expandOnlyOnTwistieClick}get onDidDispose(){return this.view.onDidDispose}constructor(t,i,e,s,n={}){var r;this._user=t,this._options=n,this.eventBufferer=new pe,this.onDidChangeFindOpenState=ne.None,this.onDidChangeStickyScrollFocused=ne.None,this.disposables=new Ji,this._onWillRefilter=new le,this.onWillRefilter=this._onWillRefilter.event,this._onDidUpdateOptions=new le,this.treeDelegate=new DH(e);const o=new me,h=new me,c=this.disposables.add(new EH(h.event)),l=new Gf;this.renderers=s.map((t=>new AH(t,(()=>this.model),o.event,c,l,n)));for(const t of this.renderers)this.disposables.add(t);let a;var u,d;n.keyboardNavigationLabelProvider&&(a=new MH(this,n.keyboardNavigationLabelProvider,n.filter),n={...n,filter:a},this.disposables.add(a)),this.focus=new WH((()=>this.view.getFocusedElements()[0]),n.identityProvider),this.selection=new WH((()=>this.view.getSelectedElements()[0]),n.identityProvider),this.anchor=new WH((()=>this.view.getAnchorElement()),n.identityProvider),this.view=new HH(t,i,this.treeDelegate,this.renderers,this.focus,this.selection,this.anchor,{...(u=()=>this.model,d=n,d&&{...d,identityProvider:d.identityProvider&&{getId:t=>d.identityProvider.getId(t.element)},dnd:d.dnd&&new xH(u,d.dnd),multipleSelectionController:d.multipleSelectionController&&{isSelectionSingleChangeEvent:t=>d.multipleSelectionController.isSelectionSingleChangeEvent({...t,element:t.element}),isSelectionRangeChangeEvent:t=>d.multipleSelectionController.isSelectionRangeChangeEvent({...t,element:t.element})},accessibilityProvider:d.accessibilityProvider&&{...d.accessibilityProvider,getSetSize(t){const i=u(),e=i.getNodeLocation(t),s=i.getParentNodeLocation(e);return i.getNode(s).visibleChildrenCount},getPosInSet:t=>t.visibleChildIndex+1,isChecked:d.accessibilityProvider&&d.accessibilityProvider.isChecked?t=>d.accessibilityProvider.isChecked(t.element):void 0,getRole:d.accessibilityProvider&&d.accessibilityProvider.getRole?t=>d.accessibilityProvider.getRole(t.element):()=>"treeitem",getAriaLabel:t=>d.accessibilityProvider.getAriaLabel(t.element),getWidgetAriaLabel:()=>d.accessibilityProvider.getWidgetAriaLabel(),getWidgetRole:d.accessibilityProvider&&d.accessibilityProvider.getWidgetRole?()=>d.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:d.accessibilityProvider&&d.accessibilityProvider.getAriaLevel?t=>d.accessibilityProvider.getAriaLevel(t.element):t=>t.depth,getActiveDescendantId:d.accessibilityProvider.getActiveDescendantId&&(t=>d.accessibilityProvider.getActiveDescendantId(t.element))},keyboardNavigationLabelProvider:d.keyboardNavigationLabelProvider&&{...d.keyboardNavigationLabelProvider,getKeyboardNavigationLabel:t=>d.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t.element)}}),tree:this,stickyScrollProvider:()=>this.stickyScrollController}),this.model=this.createModel(t,this.view,n),o.input=this.model.onDidChangeCollapseState;const f=ne.forEach(this.model.onDidSplice,(t=>{this.eventBufferer.bufferEvents((()=>{this.focus.onDidModelSplice(t),this.selection.onDidModelSplice(t)}))}),this.disposables);f((()=>null),null,this.disposables);const g=this.disposables.add(new le),p=this.disposables.add(new po(0));if(this.disposables.add(ne.any(f,this.focus.onDidChange,this.selection.onDidChange)((()=>{p.trigger((()=>{const t=new Set;for(const i of this.focus.getNodes())t.add(i);for(const i of this.selection.getNodes())t.add(i);g.fire([...t.values()])}))}))),h.input=g.event,n.keyboardSupport!==!1){const t=ne.chain(this.view.onKeyDown,(t=>t.filter((t=>!m$(t.target))).map((t=>new so(t)))));ne.chain(t,(t=>t.filter((t=>t.keyCode===15))))(this.onLeftArrow,this,this.disposables),ne.chain(t,(t=>t.filter((t=>t.keyCode===17))))(this.onRightArrow,this,this.disposables),ne.chain(t,(t=>t.filter((t=>t.keyCode===10))))(this.onSpace,this,this.disposables)}if(((r=n.findWidgetEnabled)===null||r===void 0||r)&&n.keyboardNavigationLabelProvider&&n.contextViewProvider){const t=this.options.findWidgetStyles?{styles:this.options.findWidgetStyles}:void 0;this.findController=new LH(this,this.model,this.view,a,n.contextViewProvider,t),this.focusNavigationFilter=t=>this.findController.shouldAllowFocus(t),this.onDidChangeFindOpenState=this.findController.onDidChangeOpenState,this.disposables.add(this.findController),this.onDidChangeFindMode=this.findController.onDidChangeMode,this.onDidChangeFindMatchType=this.findController.onDidChangeMatchType}else this.onDidChangeFindMode=ne.None,this.onDidChangeFindMatchType=ne.None;n.enableStickyScroll&&(this.stickyScrollController=new IH(this,this.model,this.view,this.renderers,this.treeDelegate,n),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus),this.styleElement=Pc(this.view.getHTMLElement()),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===fH.Always)}updateOptions(t={}){var i;this._options={...this._options,...t};for(const i of this.renderers)i.updateOptions(t);this.view.updateOptions(this._options),(i=this.findController)===null||i===void 0||i.updateOptions(t),this.updateStickyScroll(t),this._onDidUpdateOptions.fire(this._options),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===fH.Always)}get options(){return this._options}updateStickyScroll(t){var i;!this.stickyScrollController&&this._options.enableStickyScroll?(this.stickyScrollController=new IH(this,this.model,this.view,this.renderers,this.treeDelegate,this._options),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus):this.stickyScrollController&&!this._options.enableStickyScroll&&(this.onDidChangeStickyScrollFocused=ne.None,this.stickyScrollController.dispose(),this.stickyScrollController=void 0),(i=this.stickyScrollController)===null||i===void 0||i.updateOptions(t)}getHTMLElement(){return this.view.getHTMLElement()}get scrollTop(){return this.view.scrollTop}set scrollTop(t){this.view.scrollTop=t}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get ariaLabel(){return this.view.ariaLabel}set ariaLabel(t){this.view.ariaLabel=t}domFocus(){var t;!((t=this.stickyScrollController)===null||t===void 0)&&t.focusedLast()?this.stickyScrollController.domFocus():this.view.domFocus()}layout(t,i){var e;this.view.layout(t,i),_(i)&&((e=this.findController)===null||e===void 0||e.layout(i))}style(t){var i;const e=`.${this.view.domId}`,s=[];t.treeIndentGuidesStroke&&(s.push(`.monaco-list${e}:hover .monaco-tl-indent > .indent-guide, .monaco-list${e}.always .monaco-tl-indent > .indent-guide  { border-color: ${t.treeInactiveIndentGuidesStroke}; }`),s.push(`.monaco-list${e} .monaco-tl-indent > .indent-guide.active { border-color: ${t.treeIndentGuidesStroke}; }`)),t.listBackground&&(s.push(`.monaco-list${e} .monaco-scrollable-element .monaco-tree-sticky-container { background-color: ${t.listBackground}; }`),s.push(`.monaco-list${e} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-row { background-color: ${t.listBackground}; }`)),t.listFocusForeground&&(s.push(`.monaco-list${e}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { color: ${t.listFocusForeground}; }`),s.push(`.monaco-list${e}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { color: inherit; }`));const n=ul(t.listFocusAndSelectionOutline,ul(t.listSelectionOutline,(i=t.listFocusOutline)!==null&&i!==void 0?i:""));n&&(s.push(`.monaco-list${e}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused.selected { outline: 1px solid ${n}; outline-offset: -1px;}`),s.push(`.monaco-list${e}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused.selected { outline: inherit;}`)),t.listFocusOutline&&(s.push(`.monaco-list${e}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { outline: 1px solid ${t.listFocusOutline}; outline-offset: -1px; }`),s.push(`.monaco-list${e}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { outline: inherit; }`),s.push(`.monaco-workbench.context-menu-visible .monaco-list${e}.last-focused.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.passive-focused { outline: 1px solid ${t.listFocusOutline}; outline-offset: -1px; }`),s.push(`.monaco-workbench.context-menu-visible .monaco-list${e}.last-focused.sticky-scroll-focused .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`),s.push(`.monaco-workbench.context-menu-visible .monaco-list${e}.last-focused:not(.sticky-scroll-focused) .monaco-tree-sticky-container .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`)),this.styleElement.textContent=s.join(`\n`),this.view.style(t)}getParentElement(t){const i=this.model.getParentNodeLocation(t);return this.model.getNode(i).element}getFirstElementChild(t){return this.model.getFirstElementChild(t)}getNode(t){return this.model.getNode(t)}getNodeLocation(t){return this.model.getNodeLocation(t)}collapse(t,i=!1){return this.model.setCollapsed(t,!0,i)}expand(t,i=!1){return this.model.setCollapsed(t,!1,i)}toggleCollapsed(t,i=!1){return this.model.setCollapsed(t,void 0,i)}isCollapsible(t){return this.model.isCollapsible(t)}setCollapsible(t,i){return this.model.setCollapsible(t,i)}isCollapsed(t){return this.model.isCollapsed(t)}refilter(){this._onWillRefilter.fire(void 0),this.model.refilter()}setSelection(t,i){this.eventBufferer.bufferEvents((()=>{const e=t.map((t=>this.model.getNode(t)));this.selection.set(e,i);const s=t.map((t=>this.model.getListIndex(t))).filter((t=>t>-1));this.view.setSelection(s,i,!0)}))}getSelection(){return this.selection.get()}setFocus(t,i){this.eventBufferer.bufferEvents((()=>{const e=t.map((t=>this.model.getNode(t)));this.focus.set(e,i);const s=t.map((t=>this.model.getListIndex(t))).filter((t=>t>-1));this.view.setFocus(s,i,!0)}))}focusNext(t=1,i=!1,e,s=(Kc(e)&&e.altKey?void 0:this.focusNavigationFilter)){this.view.focusNext(t,i,e,s)}focusPrevious(t=1,i=!1,e,s=(Kc(e)&&e.altKey?void 0:this.focusNavigationFilter)){this.view.focusPrevious(t,i,e,s)}focusNextPage(t,i=(Kc(t)&&t.altKey?void 0:this.focusNavigationFilter)){return this.view.focusNextPage(t,i)}focusPreviousPage(t,i=(Kc(t)&&t.altKey?void 0:this.focusNavigationFilter)){return this.view.focusPreviousPage(t,i,(()=>{var t,i;return(i=(t=this.stickyScrollController)===null||t===void 0?void 0:t.height)!==null&&i!==void 0?i:0}))}focusFirst(t,i=(Kc(t)&&t.altKey?void 0:this.focusNavigationFilter)){this.view.focusFirst(t,i)}getFocus(){return this.focus.get()}reveal(t,i){this.model.expandTo(t);const e=this.model.getListIndex(t);if(e!==-1)if(this.stickyScrollController){const s=this.stickyScrollController.nodePositionTopBelowWidget(this.getNode(t));this.view.reveal(e,i,s)}else this.view.reveal(e,i)}onLeftArrow(t){t.preventDefault(),t.stopPropagation();const i=this.view.getFocusedElements();if(i.length===0)return;const e=i[0],s=this.model.getNodeLocation(e);if(!this.model.setCollapsed(s,!0)){const t=this.model.getParentNodeLocation(s);if(!t)return;const i=this.model.getListIndex(t);this.view.reveal(i),this.view.setFocus([i])}}onRightArrow(t){t.preventDefault(),t.stopPropagation();const i=this.view.getFocusedElements();if(i.length===0)return;const e=i[0],s=this.model.getNodeLocation(e);if(!this.model.setCollapsed(s,!1)){if(!e.children.some((t=>t.visible)))return;const[t]=this.view.getFocus(),i=t+1;this.view.reveal(i),this.view.setFocus([i])}}onSpace(t){t.preventDefault(),t.stopPropagation();const i=this.view.getFocusedElements();if(i.length===0)return;const e=i[0],s=this.model.getNodeLocation(e),n=t.browserEvent.altKey;this.model.setCollapsed(s,void 0,n)}dispose(){var t;qi(this.disposables),(t=this.stickyScrollController)===null||t===void 0||t.dispose(),this.view.dispose()}}class zH{constructor(t,i,e={}){this.user=t,this.rootRef=null,this.nodes=new Map,this.nodesByIdentity=new Map,this.model=new kH(t,i,null,e),this.onDidSplice=this.model.onDidSplice,this.onDidChangeCollapseState=this.model.onDidChangeCollapseState,this.onDidChangeRenderNodeCount=this.model.onDidChangeRenderNodeCount,e.sorter&&(this.sorter={compare:(t,i)=>e.sorter.compare(t.element,i.element)}),this.identityProvider=e.identityProvider}setChildren(t,i=Wt.empty(),e={}){const s=this.getElementLocation(t);this._setChildren(s,this.preserveCollapseState(i),e)}_setChildren(t,i=Wt.empty(),e){const s=new Set,n=new Set;this.model.splice([...t,0],Number.MAX_VALUE,i,{...e,onDidCreateNode:t=>{var i;if(t.element===null)return;const r=t;if(s.add(r.element),this.nodes.set(r.element,r),this.identityProvider){const t=this.identityProvider.getId(r.element).toString();n.add(t),this.nodesByIdentity.set(t,r)}(i=e.onDidCreateNode)===null||i===void 0||i.call(e,r)},onDidDeleteNode:t=>{var i;if(t.element===null)return;const r=t;if(s.has(r.element)||this.nodes.delete(r.element),this.identityProvider){const t=this.identityProvider.getId(r.element).toString();n.has(t)||this.nodesByIdentity.delete(t)}(i=e.onDidDeleteNode)===null||i===void 0||i.call(e,r)}})}preserveCollapseState(t=Wt.empty()){return this.sorter&&(t=[...t].sort(this.sorter.compare.bind(this.sorter))),Wt.map(t,(t=>{let i=this.nodes.get(t.element);if(!i&&this.identityProvider){const e=this.identityProvider.getId(t.element).toString();i=this.nodesByIdentity.get(e)}if(!i){let i;return i=t.collapsed===void 0?void 0:t.collapsed===uH.Collapsed||t.collapsed===uH.PreserveOrCollapsed||t.collapsed!==uH.Expanded&&t.collapsed!==uH.PreserveOrExpanded&&!!t.collapsed,{...t,children:this.preserveCollapseState(t.children),collapsed:i}}const e=typeof t.collapsible=="boolean"?t.collapsible:i.collapsible;let s;return s=t.collapsed===void 0||t.collapsed===uH.PreserveOrCollapsed||t.collapsed===uH.PreserveOrExpanded?i.collapsed:t.collapsed===uH.Collapsed||t.collapsed!==uH.Expanded&&!!t.collapsed,{...t,collapsible:e,collapsed:s,children:this.preserveCollapseState(t.children)}}))}rerender(t){const i=this.getElementLocation(t);this.model.rerender(i)}getFirstElementChild(t=null){const i=this.getElementLocation(t);return this.model.getFirstElementChild(i)}has(t){return this.nodes.has(t)}getListIndex(t){const i=this.getElementLocation(t);return this.model.getListIndex(i)}getListRenderCount(t){const i=this.getElementLocation(t);return this.model.getListRenderCount(i)}isCollapsible(t){const i=this.getElementLocation(t);return this.model.isCollapsible(i)}setCollapsible(t,i){const e=this.getElementLocation(t);return this.model.setCollapsible(e,i)}isCollapsed(t){const i=this.getElementLocation(t);return this.model.isCollapsed(i)}setCollapsed(t,i,e){const s=this.getElementLocation(t);return this.model.setCollapsed(s,i,e)}expandTo(t){const i=this.getElementLocation(t);this.model.expandTo(i)}refilter(){this.model.refilter()}getNode(t=null){if(t===null)return this.model.getNode(this.model.rootRef);const i=this.nodes.get(t);if(!i)throw new mH(this.user,`Tree element not found: ${t}`);return i}getNodeLocation(t){return t.element}getParentNodeLocation(t){if(t===null)throw new mH(this.user,"Invalid getParentNodeLocation call");const i=this.nodes.get(t);if(!i)throw new mH(this.user,`Tree element not found: ${t}`);const e=this.model.getNodeLocation(i),s=this.model.getParentNodeLocation(e);return this.model.getNode(s).element}getElementLocation(t){if(t===null)return[];const i=this.nodes.get(t);if(!i)throw new mH(this.user,`Tree element not found: ${t}`);return this.model.getNodeLocation(i)}}function UH(t){return{element:{elements:[t.element],incompressible:t.incompressible||!1},children:Wt.map(Wt.from(t.children),UH),collapsible:t.collapsible,collapsed:t.collapsed}}function KH(t){const i=[t.element],e=t.incompressible||!1;let s,n;for(;[n,s]=Wt.consume(Wt.from(t.children),2),n.length===1&&!n[0].incompressible;)t=n[0],i.push(t.element);return{element:{elements:i,incompressible:e},children:Wt.map(Wt.concat(n,s),KH),collapsible:t.collapsible,collapsed:t.collapsed}}function qH(t,i=0){let e;return e=i<t.element.elements.length-1?[qH(t,i+1)]:Wt.map(Wt.from(t.children),(t=>qH(t,0))),i===0&&t.element.incompressible?{element:t.element.elements[i],children:e,incompressible:!0,collapsible:t.collapsible,collapsed:t.collapsed}:{element:t.element.elements[i],children:e,collapsible:t.collapsible,collapsed:t.collapsed}}function GH(t){return qH(t,0)}function ZH(t,i,e){return t.element===i?{...t,children:e}:{...t,children:Wt.map(Wt.from(t.children),(t=>ZH(t,i,e)))}}class JH{get onDidSplice(){return this.model.onDidSplice}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}constructor(t,i,e={}){this.user=t,this.rootRef=null,this.nodes=new Map,this.model=new zH(t,i,e),this.enabled=e.compressionEnabled===void 0||e.compressionEnabled,this.identityProvider=e.identityProvider}setChildren(t,i=Wt.empty(),e){const s=e.diffIdentityProvider&&(r=e.diffIdentityProvider,{getId:t=>t.elements.map((t=>r.getId(t).toString())).join("\0")});var r;if(t===null){const t=Wt.map(i,this.enabled?KH:UH);return void this._setChildren(null,t,{diffIdentityProvider:s,diffDepth:1/0})}const o=this.nodes.get(t);if(!o)throw new mH(this.user,"Unknown compressed tree node");const h=this.model.getNode(o),c=this.model.getParentNodeLocation(o),l=this.model.getNode(c),a=ZH(GH(h),t,i),u=(this.enabled?KH:UH)(a),d=e.diffIdentityProvider?(t,i)=>e.diffIdentityProvider.getId(t)===e.diffIdentityProvider.getId(i):void 0;if(n(u.element.elements,h.element.elements,d))return void this._setChildren(o,u.children||Wt.empty(),{diffIdentityProvider:s,diffDepth:1});const f=l.children.map((t=>t===h?u:t));this._setChildren(l.element,f,{diffIdentityProvider:s,diffDepth:h.depth-l.depth})}isCompressionEnabled(){return this.enabled}setCompressionEnabled(t){if(t===this.enabled)return;this.enabled=t;const i=this.model.getNode().children,e=Wt.map(i,GH),s=Wt.map(e,t?KH:UH);this._setChildren(null,s,{diffIdentityProvider:this.identityProvider,diffDepth:1/0})}_setChildren(t,i,e){const s=new Set;this.model.setChildren(t,i,{...e,onDidCreateNode:t=>{for(const i of t.element.elements)s.add(i),this.nodes.set(i,t.element)},onDidDeleteNode:t=>{for(const i of t.element.elements)s.has(i)||this.nodes.delete(i)}})}has(t){return this.nodes.has(t)}getListIndex(t){const i=this.getCompressedNode(t);return this.model.getListIndex(i)}getListRenderCount(t){const i=this.getCompressedNode(t);return this.model.getListRenderCount(i)}getNode(t){if(t===void 0)return this.model.getNode();const i=this.getCompressedNode(t);return this.model.getNode(i)}getNodeLocation(t){const i=this.model.getNodeLocation(t);return i===null?null:i.elements[i.elements.length-1]}getParentNodeLocation(t){const i=this.getCompressedNode(t),e=this.model.getParentNodeLocation(i);return e===null?null:e.elements[e.elements.length-1]}getFirstElementChild(t){const i=this.getCompressedNode(t);return this.model.getFirstElementChild(i)}isCollapsible(t){const i=this.getCompressedNode(t);return this.model.isCollapsible(i)}setCollapsible(t,i){const e=this.getCompressedNode(t);return this.model.setCollapsible(e,i)}isCollapsed(t){const i=this.getCompressedNode(t);return this.model.isCollapsed(i)}setCollapsed(t,i,e){const s=this.getCompressedNode(t);return this.model.setCollapsed(s,i,e)}expandTo(t){const i=this.getCompressedNode(t);this.model.expandTo(i)}rerender(t){const i=this.getCompressedNode(t);this.model.rerender(i)}refilter(){this.model.refilter()}getCompressedNode(t){if(t===null)return null;const i=this.nodes.get(t);if(!i)throw new mH(this.user,`Tree element not found: ${t}`);return i}}const QH=t=>t[t.length-1];class YH{get element(){return this.node.element===null?null:this.unwrapper(this.node.element)}get children(){return this.node.children.map((t=>new YH(this.unwrapper,t)))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(t,i){this.unwrapper=t,this.node=i}}class XH{get onDidSplice(){return ne.map(this.model.onDidSplice,(({insertedNodes:t,deletedNodes:i})=>({insertedNodes:t.map((t=>this.nodeMapper.map(t))),deletedNodes:i.map((t=>this.nodeMapper.map(t)))})))}get onDidChangeCollapseState(){return ne.map(this.model.onDidChangeCollapseState,(({node:t,deep:i})=>({node:this.nodeMapper.map(t),deep:i})))}get onDidChangeRenderNodeCount(){return ne.map(this.model.onDidChangeRenderNodeCount,(t=>this.nodeMapper.map(t)))}constructor(t,i,e={}){this.rootRef=null,this.elementMapper=e.elementMapper||QH;const s=t=>this.elementMapper(t.elements);this.nodeMapper=new wH((t=>new YH(s,t))),this.model=new JH(t,function(t,i){return{splice(e,s,n){i.splice(e,s,n.map((i=>t.map(i))))},updateElementHeight(t,e){i.updateElementHeight(t,e)}}}(this.nodeMapper,i),function(t,i){return{...i,identityProvider:i.identityProvider&&{getId:e=>i.identityProvider.getId(t(e))},sorter:i.sorter&&{compare:(t,e)=>i.sorter.compare(t.elements[0],e.elements[0])},filter:i.filter&&{filter:(e,s)=>i.filter.filter(t(e),s)}}}(s,e))}setChildren(t,i=Wt.empty(),e={}){this.model.setChildren(t,i,e)}isCompressionEnabled(){return this.model.isCompressionEnabled()}setCompressionEnabled(t){this.model.setCompressionEnabled(t)}has(t){return this.model.has(t)}getListIndex(t){return this.model.getListIndex(t)}getListRenderCount(t){return this.model.getListRenderCount(t)}getNode(t){return this.nodeMapper.map(this.model.getNode(t))}getNodeLocation(t){return t.element}getParentNodeLocation(t){return this.model.getParentNodeLocation(t)}getFirstElementChild(t){const i=this.model.getFirstElementChild(t);return i==null?i:this.elementMapper(i.elements)}isCollapsible(t){return this.model.isCollapsible(t)}setCollapsible(t,i){return this.model.setCollapsible(t,i)}isCollapsed(t){return this.model.isCollapsed(t)}setCollapsed(t,i,e){return this.model.setCollapsed(t,i,e)}expandTo(t){return this.model.expandTo(t)}rerender(t){return this.model.rerender(t)}refilter(){return this.model.refilter()}getCompressedTreeNode(t=null){return this.model.getNode(t)}}var tV=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o};class iV extends VH{get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}constructor(t,i,e,s,n={}){super(t,i,e,s,n),this.user=t}setChildren(t,i=Wt.empty(),e){this.model.setChildren(t,i,e)}rerender(t){t!==void 0?this.model.rerender(t):this.view.rerender()}hasElement(t){return this.model.has(t)}createModel(t,i,e){return new zH(t,i,e)}}class eV{get compressedTreeNodeProvider(){return this._compressedTreeNodeProvider()}constructor(t,i,e){this._compressedTreeNodeProvider=t,this.stickyScrollDelegate=i,this.renderer=e,this.templateId=e.templateId,e.onDidChangeTwistieState&&(this.onDidChangeTwistieState=e.onDidChangeTwistieState)}renderTemplate(t){return{compressedTreeNode:void 0,data:this.renderer.renderTemplate(t)}}renderElement(t,i,e,s){let n=this.stickyScrollDelegate.getCompressedNode(t);n||(n=this.compressedTreeNodeProvider.getCompressedTreeNode(t.element)),n.element.elements.length===1?(e.compressedTreeNode=void 0,this.renderer.renderElement(t,i,e.data,s)):(e.compressedTreeNode=n,this.renderer.renderCompressedElements(n,i,e.data,s))}disposeElement(t,i,e,s){var n,r,o,h;e.compressedTreeNode?(r=(n=this.renderer).disposeCompressedElements)===null||r===void 0||r.call(n,e.compressedTreeNode,i,e.data,s):(h=(o=this.renderer).disposeElement)===null||h===void 0||h.call(o,t,i,e.data,s)}disposeTemplate(t){this.renderer.disposeTemplate(t.data)}renderTwistie(t,i){return!!this.renderer.renderTwistie&&this.renderer.renderTwistie(t,i)}}tV([Nk],eV.prototype,"compressedTreeNodeProvider",null);class sV{constructor(t){this.modelProvider=t,this.compressedStickyNodes=new Map}getCompressedNode(t){return this.compressedStickyNodes.get(t)}constrainStickyScrollNodes(t,i,e){if(this.compressedStickyNodes.clear(),t.length===0)return[];for(let s=0;s<t.length;s++){const n=t[s],r=n.position+n.height;if(s+1<t.length&&r+t[s+1].height>e||s>=i-1&&i<t.length){const i=t.slice(0,s),e=t.slice(s);return[...i,this.compressStickyNodes(e)]}}return t}compressStickyNodes(t){if(t.length===0)throw new Error("Can't compress empty sticky nodes");if(!this.modelProvider().isCompressionEnabled())return t[0];const i=[];for(const e of t){const t=this.modelProvider().getCompressedTreeNode(e.node.element);if(t.element){if(t.element.incompressible)break;i.push(...t.element.elements)}}if(i.length<2)return t[0];const e=t[t.length-1],s={elements:i,incompressible:!1},n={...e.node,children:[],element:s},r=new Proxy(t[0].node,{}),o={node:r,startIndex:t[0].startIndex,endIndex:e.endIndex,position:t[0].position,height:t[0].height};return this.compressedStickyNodes.set(r,n),o}}function nV(t,i){return i&&{...i,keyboardNavigationLabelProvider:i.keyboardNavigationLabelProvider&&{getKeyboardNavigationLabel(e){let s;try{s=t().getCompressedTreeNode(e)}catch{return i.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e)}return s.element.elements.length===1?i.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e):i.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(s.element.elements)}}}}class rV extends iV{constructor(t,i,e,s,n={}){const r=()=>this,o=new sV((()=>this.model));super(t,i,e,s.map((t=>new eV(r,o,t))),{...nV(r,n),stickyScrollDelegate:o})}setChildren(t,i=Wt.empty(),e){this.model.setChildren(t,i,e)}createModel(t,i,e){return new XH(t,i,e)}updateOptions(t={}){super.updateOptions(t),t.compressionEnabled!==void 0&&this.model.setCompressionEnabled(t.compressionEnabled)}getCompressedTreeNode(t=null){return this.model.getCompressedTreeNode(t)}}function oV(t){return{...t,children:[],refreshPromise:void 0,stale:!0,slow:!1,forceExpanded:!1}}function hV(t,i){return!!i.parent&&(i.parent===t||hV(t,i.parent))}class cV{get element(){return this.node.element.element}get children(){return this.node.children.map((t=>new cV(t)))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(t){this.node=t}}class lV{constructor(t,i,e){this.renderer=t,this.nodeMapper=i,this.onDidChangeTwistieState=e,this.renderedNodes=new Map,this.templateId=t.templateId}renderTemplate(t){return{templateData:this.renderer.renderTemplate(t)}}renderElement(t,i,e,s){this.renderer.renderElement(this.nodeMapper.map(t),i,e.templateData,s)}renderTwistie(t,i){return t.slow?(i.classList.add(...Kl.asClassNameArray(As.treeItemLoading)),!0):(i.classList.remove(...Kl.asClassNameArray(As.treeItemLoading)),!1)}disposeElement(t,i,e,s){var n,r;(r=(n=this.renderer).disposeElement)===null||r===void 0||r.call(n,this.nodeMapper.map(t),i,e.templateData,s)}disposeTemplate(t){this.renderer.disposeTemplate(t.templateData)}dispose(){this.renderedNodes.clear()}}function aV(t){return{browserEvent:t.browserEvent,elements:t.elements.map((t=>t.element))}}function uV(t){return{browserEvent:t.browserEvent,element:t.element&&t.element.element,target:t.target}}class dV extends bB{constructor(t){super(t.elements.map((t=>t.element))),this.data=t}}function fV(t){return t instanceof bB?new dV(t):t}class gV{constructor(t){this.dnd=t}getDragURI(t){return this.dnd.getDragURI(t.element)}getDragLabel(t,i){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(t.map((t=>t.element)),i)}onDragStart(t,i){var e,s;(s=(e=this.dnd).onDragStart)===null||s===void 0||s.call(e,fV(t),i)}onDragOver(t,i,e,s,n,r=!0){return this.dnd.onDragOver(fV(t),i&&i.element,e,s,n)}drop(t,i,e,s,n){this.dnd.drop(fV(t),i&&i.element,e,s,n)}onDragEnd(t){var i,e;(e=(i=this.dnd).onDragEnd)===null||e===void 0||e.call(i,t)}dispose(){this.dnd.dispose()}}function pV(t){return t&&{...t,collapseByDefault:!0,identityProvider:t.identityProvider&&{getId:i=>t.identityProvider.getId(i.element)},dnd:t.dnd&&new gV(t.dnd),multipleSelectionController:t.multipleSelectionController&&{isSelectionSingleChangeEvent:i=>t.multipleSelectionController.isSelectionSingleChangeEvent({...i,element:i.element}),isSelectionRangeChangeEvent:i=>t.multipleSelectionController.isSelectionRangeChangeEvent({...i,element:i.element})},accessibilityProvider:t.accessibilityProvider&&{...t.accessibilityProvider,getPosInSet:void 0,getSetSize:void 0,getRole:t.accessibilityProvider.getRole?i=>t.accessibilityProvider.getRole(i.element):()=>"treeitem",isChecked:t.accessibilityProvider.isChecked?i=>{var e;return!!(!((e=t.accessibilityProvider)===null||e===void 0)&&e.isChecked(i.element))}:void 0,getAriaLabel:i=>t.accessibilityProvider.getAriaLabel(i.element),getWidgetAriaLabel:()=>t.accessibilityProvider.getWidgetAriaLabel(),getWidgetRole:t.accessibilityProvider.getWidgetRole?()=>t.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:t.accessibilityProvider.getAriaLevel&&(i=>t.accessibilityProvider.getAriaLevel(i.element)),getActiveDescendantId:t.accessibilityProvider.getActiveDescendantId&&(i=>t.accessibilityProvider.getActiveDescendantId(i.element))},filter:t.filter&&{filter:(i,e)=>t.filter.filter(i.element,e)},keyboardNavigationLabelProvider:t.keyboardNavigationLabelProvider&&{...t.keyboardNavigationLabelProvider,getKeyboardNavigationLabel:i=>t.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(i.element)},sorter:void 0,expandOnlyOnTwistieClick:t.expandOnlyOnTwistieClick===void 0?void 0:typeof t.expandOnlyOnTwistieClick!="function"?t.expandOnlyOnTwistieClick:i=>t.expandOnlyOnTwistieClick(i.element),defaultFindVisibility:i=>i.hasChildren&&i.stale?1:typeof t.defaultFindVisibility=="number"?t.defaultFindVisibility:t.defaultFindVisibility===void 0?2:t.defaultFindVisibility(i.element)}}function mV(t,i){i(t),t.children.forEach((t=>mV(t,i)))}class wV{get onDidScroll(){return this.tree.onDidScroll}get onDidChangeFocus(){return ne.map(this.tree.onDidChangeFocus,aV)}get onDidChangeSelection(){return ne.map(this.tree.onDidChangeSelection,aV)}get onMouseDblClick(){return ne.map(this.tree.onMouseDblClick,uV)}get onPointer(){return ne.map(this.tree.onPointer,uV)}get onDidFocus(){return this.tree.onDidFocus}get onDidChangeModel(){return this.tree.onDidChangeModel}get onDidChangeCollapseState(){return this.tree.onDidChangeCollapseState}get onDidChangeFindOpenState(){return this.tree.onDidChangeFindOpenState}get onDidChangeStickyScrollFocused(){return this.tree.onDidChangeStickyScrollFocused}get onDidDispose(){return this.tree.onDidDispose}constructor(t,i,e,s,n,r={}){this.user=t,this.dataSource=n,this.nodes=new Map,this.subTreeRefreshPromises=new Map,this.refreshPromises=new Map,this._onDidRender=new le,this._onDidChangeNodeSlowState=new le,this.nodeMapper=new wH((t=>new cV(t))),this.disposables=new Ji,this.identityProvider=r.identityProvider,this.autoExpandSingleChildren=r.autoExpandSingleChildren!==void 0&&r.autoExpandSingleChildren,this.sorter=r.sorter,this.getDefaultCollapseState=t=>r.collapseByDefault?r.collapseByDefault(t)?uH.PreserveOrCollapsed:uH.PreserveOrExpanded:void 0,this.tree=this.createTree(t,i,e,s,r),this.onDidChangeFindMode=this.tree.onDidChangeFindMode,this.onDidChangeFindMatchType=this.tree.onDidChangeFindMatchType,this.root=oV({element:void 0,parent:null,hasChildren:!0,defaultCollapseState:void 0}),this.identityProvider&&(this.root={...this.root,id:null}),this.nodes.set(null,this.root),this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState,this,this.disposables)}createTree(t,i,e,s,n){const r=new DH(e),o=s.map((t=>new lV(t,this.nodeMapper,this._onDidChangeNodeSlowState.event))),h=pV(n)||{};return new iV(t,i,r,o,h)}updateOptions(t={}){this.tree.updateOptions(t)}getHTMLElement(){return this.tree.getHTMLElement()}get scrollTop(){return this.tree.scrollTop}set scrollTop(t){this.tree.scrollTop=t}get scrollHeight(){return this.tree.scrollHeight}get renderHeight(){return this.tree.renderHeight}domFocus(){this.tree.domFocus()}layout(t,i){this.tree.layout(t,i)}style(t){this.tree.style(t)}getInput(){return this.root.element}async setInput(t,i){this.refreshPromises.forEach((t=>t.cancel())),this.refreshPromises.clear(),this.root.element=t;const e=i&&{viewState:i,focus:[],selection:[]};await this._updateChildren(t,!0,!1,e),e&&(this.tree.setFocus(e.focus),this.tree.setSelection(e.selection)),i&&typeof i.scrollTop=="number"&&(this.scrollTop=i.scrollTop)}async _updateChildren(t=this.root.element,i=!0,e=!1,s,n){if(this.root.element===void 0)throw new mH(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await ne.toPromise(this._onDidRender.event));const r=this.getDataNode(t);if(await this.refreshAndRenderNode(r,i,s,n),e)try{this.tree.rerender(r)}catch{}}rerender(t){if(t===void 0||t===this.root.element)return void this.tree.rerender();const i=this.getDataNode(t);this.tree.rerender(i)}getNode(t=this.root.element){const i=this.getDataNode(t),e=this.tree.getNode(i===this.root?null:i);return this.nodeMapper.map(e)}collapse(t,i=!1){const e=this.getDataNode(t);return this.tree.collapse(e===this.root?null:e,i)}async expand(t,i=!1){if(this.root.element===void 0)throw new mH(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await ne.toPromise(this._onDidRender.event));const e=this.getDataNode(t);if(this.tree.hasElement(e)&&!this.tree.isCollapsible(e)||(e.refreshPromise&&(await this.root.refreshPromise,await ne.toPromise(this._onDidRender.event)),e!==this.root&&!e.refreshPromise&&!this.tree.isCollapsed(e)))return!1;const s=this.tree.expand(e===this.root?null:e,i);return e.refreshPromise&&(await this.root.refreshPromise,await ne.toPromise(this._onDidRender.event)),s}setSelection(t,i){const e=t.map((t=>this.getDataNode(t)));this.tree.setSelection(e,i)}getSelection(){return this.tree.getSelection().map((t=>t.element))}setFocus(t,i){const e=t.map((t=>this.getDataNode(t)));this.tree.setFocus(e,i)}getFocus(){return this.tree.getFocus().map((t=>t.element))}reveal(t,i){this.tree.reveal(this.getDataNode(t),i)}getParentElement(t){const i=this.tree.getParentElement(this.getDataNode(t));return i&&i.element}getFirstElementChild(t=this.root.element){const i=this.getDataNode(t),e=this.tree.getFirstElementChild(i===this.root?null:i);return e&&e.element}getDataNode(t){const i=this.nodes.get(t===this.root.element?null:t);if(!i)throw new mH(this.user,`Data tree node not found: ${t}`);return i}async refreshAndRenderNode(t,i,e,s){await this.refreshNode(t,i,e),this.disposables.isDisposed||this.render(t,e,s)}async refreshNode(t,i,e){let s;return this.subTreeRefreshPromises.forEach(((n,r)=>{!s&&function(t,i){return t===i||hV(t,i)||hV(i,t)}(r,t)&&(s=n.then((()=>this.refreshNode(t,i,e))))})),s||(t!==this.root&&this.tree.getNode(t).collapsed?(t.hasChildren=!!this.dataSource.hasChildren(t.element),t.stale=!0,void this.setChildren(t,[],i,e)):this.doRefreshSubTree(t,i,e))}async doRefreshSubTree(t,i,e){let s;t.refreshPromise=new Promise((t=>s=t)),this.subTreeRefreshPromises.set(t,t.refreshPromise),t.refreshPromise.finally((()=>{t.refreshPromise=void 0,this.subTreeRefreshPromises.delete(t)}));try{const s=await this.doRefreshNode(t,i,e);t.stale=!1,await Mo.settled(s.map((t=>this.doRefreshSubTree(t,i,e))))}finally{s()}}async doRefreshNode(t,i,e){let s;if(t.hasChildren=!!this.dataSource.hasChildren(t.element),t.hasChildren){const i=this.doGetChildren(t);if(P(i))s=Promise.resolve(i);else{const e=wo(800);e.then((()=>{t.slow=!0,this._onDidChangeNodeSlowState.fire(t)}),(t=>null)),s=i.finally((()=>e.cancel()))}}else s=Promise.resolve(Wt.empty());try{const n=await s;return this.setChildren(t,n,i,e)}catch(i){if(t!==this.root&&this.tree.hasElement(t)&&this.tree.collapse(t),Bi(i))return[];throw i}finally{t.slow&&(t.slow=!1,this._onDidChangeNodeSlowState.fire(t))}}doGetChildren(t){let i=this.refreshPromises.get(t);if(i)return i;const e=this.dataSource.getChildren(t.element);return P(e)?this.processChildren(e):(i=uo((async()=>this.processChildren(await e))),this.refreshPromises.set(t,i),i.finally((()=>{this.refreshPromises.delete(t)})))}_onDidChangeCollapseState({node:t,deep:i}){t.element!==null&&!t.collapsed&&t.element.stale&&(i?this.collapse(t.element.element):this.refreshAndRenderNode(t.element,!1).catch(Ii))}setChildren(t,i,e,s){const n=[...i];if(t.children.length===0&&n.length===0)return[];const r=new Map,o=new Map;for(const i of t.children)r.set(i.element,i),this.identityProvider&&o.set(i.id,{node:i,collapsed:this.tree.hasElement(i)&&this.tree.isCollapsed(i)});const h=[],c=n.map((i=>{const n=!!this.dataSource.hasChildren(i);if(!this.identityProvider){const e=oV({element:i,parent:t,hasChildren:n,defaultCollapseState:this.getDefaultCollapseState(i)});return n&&e.defaultCollapseState===uH.PreserveOrExpanded&&h.push(e),e}const c=this.identityProvider.getId(i).toString(),l=o.get(c);if(l){const t=l.node;return r.delete(t.element),this.nodes.delete(t.element),this.nodes.set(i,t),t.element=i,t.hasChildren=n,e?l.collapsed?(t.children.forEach((t=>mV(t,(t=>this.nodes.delete(t.element))))),t.children.splice(0,t.children.length),t.stale=!0):h.push(t):n&&!l.collapsed&&h.push(t),t}const a=oV({element:i,parent:t,id:c,hasChildren:n,defaultCollapseState:this.getDefaultCollapseState(i)});return s&&s.viewState.focus&&s.viewState.focus.indexOf(c)>-1&&s.focus.push(a),s&&s.viewState.selection&&s.viewState.selection.indexOf(c)>-1&&s.selection.push(a),(s&&s.viewState.expanded&&s.viewState.expanded.indexOf(c)>-1||n&&a.defaultCollapseState===uH.PreserveOrExpanded)&&h.push(a),a}));for(const t of r.values())mV(t,(t=>this.nodes.delete(t.element)));for(const t of c)this.nodes.set(t.element,t);return t.children.splice(0,t.children.length,...c),t!==this.root&&this.autoExpandSingleChildren&&c.length===1&&h.length===0&&(c[0].forceExpanded=!0,h.push(c[0])),h}render(t,i,e){const s=t.children.map((t=>this.asTreeElement(t,i))),n=e&&{...e,diffIdentityProvider:e.diffIdentityProvider&&{getId:t=>e.diffIdentityProvider.getId(t.element)}};this.tree.setChildren(t===this.root?null:t,s,n),t!==this.root&&this.tree.setCollapsible(t,t.hasChildren),this._onDidRender.fire()}asTreeElement(t,i){if(t.stale)return{element:t,collapsible:t.hasChildren,collapsed:!0};let e;return i&&i.viewState.expanded&&t.id&&i.viewState.expanded.indexOf(t.id)>-1?e=!1:t.forceExpanded?(e=!1,t.forceExpanded=!1):e=t.defaultCollapseState,{element:t,children:t.hasChildren?Wt.map(t.children,(t=>this.asTreeElement(t,i))):[],collapsible:t.hasChildren,collapsed:e}}processChildren(t){return this.sorter&&(t=[...t].sort(this.sorter.compare.bind(this.sorter))),t}dispose(){this.disposables.dispose(),this.tree.dispose()}}class vV{get element(){return{elements:this.node.element.elements.map((t=>t.element)),incompressible:this.node.element.incompressible}}get children(){return this.node.children.map((t=>new vV(t)))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(t){this.node=t}}class bV{constructor(t,i,e,s){this.renderer=t,this.nodeMapper=i,this.compressibleNodeMapperProvider=e,this.onDidChangeTwistieState=s,this.renderedNodes=new Map,this.disposables=[],this.templateId=t.templateId}renderTemplate(t){return{templateData:this.renderer.renderTemplate(t)}}renderElement(t,i,e,s){this.renderer.renderElement(this.nodeMapper.map(t),i,e.templateData,s)}renderCompressedElements(t,i,e,s){this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(t),i,e.templateData,s)}renderTwistie(t,i){return t.slow?(i.classList.add(...Kl.asClassNameArray(As.treeItemLoading)),!0):(i.classList.remove(...Kl.asClassNameArray(As.treeItemLoading)),!1)}disposeElement(t,i,e,s){var n,r;(r=(n=this.renderer).disposeElement)===null||r===void 0||r.call(n,this.nodeMapper.map(t),i,e.templateData,s)}disposeCompressedElements(t,i,e,s){var n,r;(r=(n=this.renderer).disposeCompressedElements)===null||r===void 0||r.call(n,this.compressibleNodeMapperProvider().map(t),i,e.templateData,s)}disposeTemplate(t){this.renderer.disposeTemplate(t.templateData)}dispose(){this.renderedNodes.clear(),this.disposables=qi(this.disposables)}}class yV extends wV{constructor(t,i,e,s,n,r,o={}){super(t,i,e,n,r,o),this.compressionDelegate=s,this.compressibleNodeMapper=new wH((t=>new vV(t))),this.filter=o.filter}createTree(t,i,e,s,n){const r=new DH(e),o=s.map((t=>new bV(t,this.nodeMapper,(()=>this.compressibleNodeMapper),this._onDidChangeNodeSlowState.event))),h=function(t){const i=t&&pV(t);return i&&{...i,keyboardNavigationLabelProvider:i.keyboardNavigationLabelProvider&&{...i.keyboardNavigationLabelProvider,getCompressedNodeKeyboardNavigationLabel:i=>t.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(i.map((t=>t.element)))}}}(n)||{};return new rV(t,i,r,o,h)}asTreeElement(t,i){return{incompressible:this.compressionDelegate.isIncompressible(t.element),...super.asTreeElement(t,i)}}updateOptions(t={}){this.tree.updateOptions(t)}render(t,i,e){if(!this.identityProvider)return super.render(t,i);const s=t=>this.identityProvider.getId(t).toString(),n=t=>{const i=new Set;for(const e of t){const t=this.tree.getCompressedTreeNode(e===this.root?null:e);if(t.element)for(const e of t.element.elements)i.add(s(e.element))}return i},r=n(this.tree.getSelection()),o=n(this.tree.getFocus());super.render(t,i,e);const h=this.getSelection();let c=!1;const l=this.getFocus();let a=!1;const u=t=>{const i=t.element;if(i)for(let t=0;t<i.elements.length;t++){const e=s(i.elements[t].element),n=i.elements[i.elements.length-1].element;r.has(e)&&h.indexOf(n)===-1&&(h.push(n),c=!0),o.has(e)&&l.indexOf(n)===-1&&(l.push(n),a=!0)}t.children.forEach(u)};u(this.tree.getCompressedTreeNode(t===this.root?null:t)),c&&this.setSelection(h),a&&this.setFocus(l)}processChildren(t){return this.filter&&(t=Wt.filter(t,(t=>{const i=this.filter.filter(t,1),e=typeof(s=i)=="boolean"?s?1:0:vH(s)?bH(s.visibility):bH(s);var s;if(e===2)throw new Error("Recursive tree visibility not supported in async data compressed trees");return e===1}))),super.processChildren(t)}}class kV extends VH{constructor(t,i,e,s,n,r={}){super(t,i,e,s,r),this.user=t,this.dataSource=n,this.identityProvider=r.identityProvider}createModel(t,i,e){return new zH(t,i,e)}}new Ta("isMac",bt,tt(0,"Whether the operating system is macOS")),new Ta("isLinux",yt,tt(0,"Whether the operating system is Linux"));const CV=new Ta("isWindows",vt,tt(0,"Whether the operating system is Windows")),SV=new Ta("isWeb",Ct,tt(0,"Whether the platform is a web browser"));new Ta("isMacNative",bt&&!Ct,tt(0,"Whether the operating system is macOS on a non-browser platform")),new Ta("isIOS",xt,tt(0,"Whether the operating system is iOS")),new Ta("isMobile",Dt,tt(0,"Whether the platform is a mobile web browser")),new Ta("isDevelopment",!1,!0),new Ta("productQualityType","",tt(0,"Quality type of VS Code"));const xV="inputFocus",DV=new Ta(xV,!1,tt(0,"Whether keyboard focus is inside an input box"));var EV=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},AV=function(t,i){return function(e,s){i(e,s,t)}};const MV=_l("listService"),LV=new Ta("listScrollAtBoundary","none");ua.or(LV.isEqualTo("top"),LV.isEqualTo("both")),ua.or(LV.isEqualTo("bottom"),LV.isEqualTo("both"));const FV=new Ta("listFocus",!0),TV=new Ta("treestickyScrollFocused",!1),RV=new Ta("listSupportsMultiselect",!0),OV=ua.and(FV,ua.not(xV),TV.negate()),IV=new Ta("listHasSelectionOrFocus",!1),_V=new Ta("listDoubleSelection",!1),PV=new Ta("listMultiSelection",!1),NV=new Ta("listSelectionNavigation",!1),BV=new Ta("listSupportsFind",!0),$V=new Ta("treeElementCanCollapse",!1),WV=new Ta("treeElementHasParent",!1),jV=new Ta("treeElementCanExpand",!1),HV=new Ta("treeElementHasChild",!1),VV=new Ta("treeFindOpen",!1),zV="listTypeNavigationMode",UV="listAutomaticKeyboardNavigation";function KV(t,i){const e=t.createScoped(i.getHTMLElement());return FV.bindTo(e),e}function qV(t,i){const e=LV.bindTo(t),s=()=>{const t=i.scrollTop===0,s=i.scrollHeight-i.renderHeight-i.scrollTop<1;t&&s?e.set("both"):t?e.set("top"):s?e.set("bottom"):e.set("none")};return s(),i.onDidScroll(s)}const GV="workbench.list.multiSelectModifier",ZV="workbench.list.openMode",JV="workbench.list.horizontalScrolling",QV="workbench.list.defaultFindMode",YV="workbench.list.typeNavigationMode",XV="workbench.list.keyboardNavigation",tz="workbench.list.scrollByPage",iz="workbench.list.defaultFindMatchType",ez="workbench.tree.indent",sz="workbench.tree.renderIndentGuides",nz="workbench.list.smoothScrolling",rz="workbench.list.mouseWheelScrollSensitivity",oz="workbench.list.fastScrollSensitivity",hz="workbench.tree.expandMode",cz="workbench.tree.enableStickyScroll",lz="workbench.tree.stickyScrollMaxItemCount";function az(t){return t.getValue(GV)==="alt"}class uz extends Qi{constructor(t){super(),this.configurationService=t,this.useAltAsMultipleSelectionModifier=az(t),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration((t=>{t.affectsConfiguration(GV)&&(this.useAltAsMultipleSelectionModifier=az(this.configurationService))})))}isSelectionSingleChangeEvent(t){return this.useAltAsMultipleSelectionModifier?t.browserEvent.altKey:M$(t)}isSelectionRangeChangeEvent(t){return L$(t)}}function dz(t,i){var e;const s=t.get(Md),n=t.get(NS),r=new Ji;return[{...i,keyboardNavigationDelegate:{mightProducePrintableCharacter:t=>n.mightProducePrintableCharacter(t)},smoothScrolling:!!s.getValue(nz),mouseWheelScrollSensitivity:s.getValue(rz),fastScrollSensitivity:s.getValue(oz),multipleSelectionController:(e=i.multipleSelectionController)!==null&&e!==void 0?e:r.add(new uz(s)),keyboardNavigationEventFilter:yz(n),scrollByPage:!!s.getValue(tz)},r]}let fz=class extends W${constructor(t,i,e,s,n,r,o,h,c){const l=n.horizontalScrolling!==void 0?n.horizontalScrolling:!!h.getValue(JV),[a,u]=c.invokeFunction(dz,n);super(t,i,e,s,{keyboardSupport:!1,...a,horizontalScrolling:l}),this.disposables.add(u),this.contextKeyService=KV(r,this),this.disposables.add(qV(this.contextKeyService,this)),this.listSupportsMultiSelect=RV.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(n.multipleSelectionSupport!==!1),NV.bindTo(this.contextKeyService).set(!!n.selectionNavigation),this.listHasSelectionOrFocus=IV.bindTo(this.contextKeyService),this.listDoubleSelection=_V.bindTo(this.contextKeyService),this.listMultiSelection=PV.bindTo(this.contextKeyService),this.horizontalScrolling=n.horizontalScrolling,this._useAltAsMultipleSelectionModifier=az(h),this.disposables.add(this.contextKeyService),this.disposables.add(o.register(this)),this.updateStyles(n.overrideStyles),this.disposables.add(this.onDidChangeSelection((()=>{const t=this.getSelection(),i=this.getFocus();this.contextKeyService.bufferChangeEvents((()=>{this.listHasSelectionOrFocus.set(t.length>0||i.length>0),this.listMultiSelection.set(t.length>1),this.listDoubleSelection.set(t.length===2)}))}))),this.disposables.add(this.onDidChangeFocus((()=>{const t=this.getSelection(),i=this.getFocus();this.listHasSelectionOrFocus.set(t.length>0||i.length>0)}))),this.disposables.add(h.onDidChangeConfiguration((t=>{t.affectsConfiguration(GV)&&(this._useAltAsMultipleSelectionModifier=az(h));let i={};if(t.affectsConfiguration(JV)&&this.horizontalScrolling===void 0){const t=!!h.getValue(JV);i={...i,horizontalScrolling:t}}if(t.affectsConfiguration(tz)){const t=!!h.getValue(tz);i={...i,scrollByPage:t}}if(t.affectsConfiguration(nz)){const t=!!h.getValue(nz);i={...i,smoothScrolling:t}}if(t.affectsConfiguration(rz)){const t=h.getValue(rz);i={...i,mouseWheelScrollSensitivity:t}}if(t.affectsConfiguration(oz)){const t=h.getValue(oz);i={...i,fastScrollSensitivity:t}}Object.keys(i).length>0&&this.updateOptions(i)}))),this.navigator=new wz(this,{configurationService:h,...n}),this.disposables.add(this.navigator)}updateOptions(t){super.updateOptions(t),t.overrideStyles!==void 0&&this.updateStyles(t.overrideStyles),t.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!t.multipleSelectionSupport)}updateStyles(t){this.style(t?pW(t):gW)}};fz=EV([AV(5,Ra),AV(6,MV),AV(7,Md),AV(8,Il)],fz);let gz=class extends Rj{constructor(t,i,e,s,n,r,o,h,c){const l=n.horizontalScrolling!==void 0?n.horizontalScrolling:!!h.getValue(JV),[a,u]=c.invokeFunction(dz,n);super(t,i,e,s,{keyboardSupport:!1,...a,horizontalScrolling:l}),this.disposables=new Ji,this.disposables.add(u),this.contextKeyService=KV(r,this),this.disposables.add(qV(this.contextKeyService,this.widget)),this.horizontalScrolling=n.horizontalScrolling,this.listSupportsMultiSelect=RV.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(n.multipleSelectionSupport!==!1),NV.bindTo(this.contextKeyService).set(!!n.selectionNavigation),this._useAltAsMultipleSelectionModifier=az(h),this.disposables.add(this.contextKeyService),this.disposables.add(o.register(this)),this.updateStyles(n.overrideStyles),this.disposables.add(h.onDidChangeConfiguration((t=>{t.affectsConfiguration(GV)&&(this._useAltAsMultipleSelectionModifier=az(h));let i={};if(t.affectsConfiguration(JV)&&this.horizontalScrolling===void 0){const t=!!h.getValue(JV);i={...i,horizontalScrolling:t}}if(t.affectsConfiguration(tz)){const t=!!h.getValue(tz);i={...i,scrollByPage:t}}if(t.affectsConfiguration(nz)){const t=!!h.getValue(nz);i={...i,smoothScrolling:t}}if(t.affectsConfiguration(rz)){const t=h.getValue(rz);i={...i,mouseWheelScrollSensitivity:t}}if(t.affectsConfiguration(oz)){const t=h.getValue(oz);i={...i,fastScrollSensitivity:t}}Object.keys(i).length>0&&this.updateOptions(i)}))),this.navigator=new wz(this,{configurationService:h,...n}),this.disposables.add(this.navigator)}updateOptions(t){super.updateOptions(t),t.overrideStyles!==void 0&&this.updateStyles(t.overrideStyles),t.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!t.multipleSelectionSupport)}updateStyles(t){this.style(t?pW(t):gW)}dispose(){this.disposables.dispose(),super.dispose()}};gz=EV([AV(5,Ra),AV(6,MV),AV(7,Md),AV(8,Il)],gz);let pz=class extends Qj{constructor(t,i,e,s,n,r,o,h,c,l){const a=r.horizontalScrolling!==void 0?r.horizontalScrolling:!!c.getValue(JV),[u,d]=l.invokeFunction(dz,r);super(t,i,e,s,n,{keyboardSupport:!1,...u,horizontalScrolling:a}),this.disposables.add(d),this.contextKeyService=KV(o,this),this.disposables.add(qV(this.contextKeyService,this)),this.listSupportsMultiSelect=RV.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(r.multipleSelectionSupport!==!1),NV.bindTo(this.contextKeyService).set(!!r.selectionNavigation),this.listHasSelectionOrFocus=IV.bindTo(this.contextKeyService),this.listDoubleSelection=_V.bindTo(this.contextKeyService),this.listMultiSelection=PV.bindTo(this.contextKeyService),this.horizontalScrolling=r.horizontalScrolling,this._useAltAsMultipleSelectionModifier=az(c),this.disposables.add(this.contextKeyService),this.disposables.add(h.register(this)),this.updateStyles(r.overrideStyles),this.disposables.add(this.onDidChangeSelection((()=>{const t=this.getSelection(),i=this.getFocus();this.contextKeyService.bufferChangeEvents((()=>{this.listHasSelectionOrFocus.set(t.length>0||i.length>0),this.listMultiSelection.set(t.length>1),this.listDoubleSelection.set(t.length===2)}))}))),this.disposables.add(this.onDidChangeFocus((()=>{const t=this.getSelection(),i=this.getFocus();this.listHasSelectionOrFocus.set(t.length>0||i.length>0)}))),this.disposables.add(c.onDidChangeConfiguration((t=>{t.affectsConfiguration(GV)&&(this._useAltAsMultipleSelectionModifier=az(c));let i={};if(t.affectsConfiguration(JV)&&this.horizontalScrolling===void 0){const t=!!c.getValue(JV);i={...i,horizontalScrolling:t}}if(t.affectsConfiguration(tz)){const t=!!c.getValue(tz);i={...i,scrollByPage:t}}if(t.affectsConfiguration(nz)){const t=!!c.getValue(nz);i={...i,smoothScrolling:t}}if(t.affectsConfiguration(rz)){const t=c.getValue(rz);i={...i,mouseWheelScrollSensitivity:t}}if(t.affectsConfiguration(oz)){const t=c.getValue(oz);i={...i,fastScrollSensitivity:t}}Object.keys(i).length>0&&this.updateOptions(i)}))),this.navigator=new vz(this,{configurationService:c,...r}),this.disposables.add(this.navigator)}updateOptions(t){super.updateOptions(t),t.overrideStyles!==void 0&&this.updateStyles(t.overrideStyles),t.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!t.multipleSelectionSupport)}updateStyles(t){this.style(t?pW(t):gW)}dispose(){this.disposables.dispose(),super.dispose()}};pz=EV([AV(6,Ra),AV(7,MV),AV(8,Md),AV(9,Il)],pz);class mz extends Qi{constructor(t,i){var e;super(),this.widget=t,this._onDidOpen=this._register(new le),this.onDidOpen=this._onDidOpen.event,this._register(ne.filter(this.widget.onDidChangeSelection,(t=>Kc(t.browserEvent)))((t=>this.onSelectionFromKeyboard(t)))),this._register(this.widget.onPointer((t=>this.onPointer(t.element,t.browserEvent)))),this._register(this.widget.onMouseDblClick((t=>this.onMouseDblClick(t.element,t.browserEvent)))),typeof(i==null?void 0:i.openOnSingleClick)!="boolean"&&(i!=null&&i.configurationService)?(this.openOnSingleClick=(i==null?void 0:i.configurationService.getValue(ZV))!=="doubleClick",this._register(i==null?void 0:i.configurationService.onDidChangeConfiguration((t=>{t.affectsConfiguration(ZV)&&(this.openOnSingleClick=(i==null?void 0:i.configurationService.getValue(ZV))!=="doubleClick")})))):this.openOnSingleClick=(e=i==null?void 0:i.openOnSingleClick)===null||e===void 0||e}onSelectionFromKeyboard(t){if(t.elements.length!==1)return;const i=t.browserEvent,e=typeof i.preserveFocus!="boolean"||i.preserveFocus,s=typeof i.pinned=="boolean"?i.pinned:!e;this._open(this.getSelectedElement(),e,s,!1,t.browserEvent)}onPointer(t,i){if(!this.openOnSingleClick||i.detail===2)return;const e=i.button===1,s=i.ctrlKey||i.metaKey||i.altKey;this._open(t,!0,e,s,i)}onMouseDblClick(t,i){if(!i)return;const e=i.target;if(e.classList.contains("monaco-tl-twistie")||e.classList.contains("monaco-icon-label")&&e.classList.contains("folder-icon")&&i.offsetX<16)return;const s=i.ctrlKey||i.metaKey||i.altKey;this._open(t,!1,!0,s,i)}_open(t,i,e,s,n){t&&this._onDidOpen.fire({editorOptions:{preserveFocus:i,pinned:e,revealIfVisible:!0},sideBySide:s,element:t,browserEvent:n})}}class wz extends mz{constructor(t,i){super(t,i),this.widget=t}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class vz extends mz{constructor(t,i){super(t,i)}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class bz extends mz{constructor(t,i){super(t,i)}getSelectedElement(){var t;return(t=this.widget.getSelection()[0])!==null&&t!==void 0?t:void 0}}function yz(t){let i=!1;return e=>{if(e.toKeyCodeChord().isModifierKey())return!1;if(i)return i=!1,!1;const s=t.softDispatch(e,e.target);return s.kind===1?(i=!0,!1):(i=!1,s.kind===0)}}let kz=class extends iV{constructor(t,i,e,s,n,r,o,h,c){const{options:l,getTypeNavigationMode:a,disposable:u}=r.invokeFunction(Mz,n);super(t,i,e,s,l),this.disposables.add(u),this.internals=new Lz(this,n,a,n.overrideStyles,o,h,c),this.disposables.add(this.internals)}updateOptions(t){super.updateOptions(t),this.internals.updateOptions(t)}};kz=EV([AV(5,Il),AV(6,Ra),AV(7,MV),AV(8,Md)],kz);let Cz=class extends rV{constructor(t,i,e,s,n,r,o,h,c){const{options:l,getTypeNavigationMode:a,disposable:u}=r.invokeFunction(Mz,n);super(t,i,e,s,l),this.disposables.add(u),this.internals=new Lz(this,n,a,n.overrideStyles,o,h,c),this.disposables.add(this.internals)}updateOptions(t={}){super.updateOptions(t),t.overrideStyles&&this.internals.updateStyleOverrides(t.overrideStyles),this.internals.updateOptions(t)}};Cz=EV([AV(5,Il),AV(6,Ra),AV(7,MV),AV(8,Md)],Cz);let Sz=class extends kV{constructor(t,i,e,s,n,r,o,h,c,l){const{options:a,getTypeNavigationMode:u,disposable:d}=o.invokeFunction(Mz,r);super(t,i,e,s,n,a),this.disposables.add(d),this.internals=new Lz(this,r,u,r.overrideStyles,h,c,l),this.disposables.add(this.internals)}updateOptions(t={}){super.updateOptions(t),t.overrideStyles!==void 0&&this.internals.updateStyleOverrides(t.overrideStyles),this.internals.updateOptions(t)}};Sz=EV([AV(6,Il),AV(7,Ra),AV(8,MV),AV(9,Md)],Sz);let xz=class extends wV{get onDidOpen(){return this.internals.onDidOpen}constructor(t,i,e,s,n,r,o,h,c,l){const{options:a,getTypeNavigationMode:u,disposable:d}=o.invokeFunction(Mz,r);super(t,i,e,s,n,a),this.disposables.add(d),this.internals=new Lz(this,r,u,r.overrideStyles,h,c,l),this.disposables.add(this.internals)}updateOptions(t={}){super.updateOptions(t),t.overrideStyles&&this.internals.updateStyleOverrides(t.overrideStyles),this.internals.updateOptions(t)}};xz=EV([AV(6,Il),AV(7,Ra),AV(8,MV),AV(9,Md)],xz);let Dz=class extends yV{constructor(t,i,e,s,n,r,o,h,c,l,a){const{options:u,getTypeNavigationMode:d,disposable:f}=h.invokeFunction(Mz,o);super(t,i,e,s,n,r,u),this.disposables.add(f),this.internals=new Lz(this,o,d,o.overrideStyles,c,l,a),this.disposables.add(this.internals)}updateOptions(t){super.updateOptions(t),this.internals.updateOptions(t)}};function Ez(t){const i=t.getValue(QV);if(i==="highlight")return gH.Highlight;if(i==="filter")return gH.Filter;const e=t.getValue(XV);return e==="simple"||e==="highlight"?gH.Highlight:e==="filter"?gH.Filter:void 0}function Az(t){const i=t.getValue(iz);return i==="fuzzy"?pH.Fuzzy:i==="contiguous"?pH.Contiguous:void 0}function Mz(t,i){var e;const s=t.get(Md),n=t.get(rI),r=t.get(Ra),o=t.get(Il),h=i.horizontalScrolling!==void 0?i.horizontalScrolling:!!s.getValue(JV),[c,l]=o.invokeFunction(dz,i),a=i.paddingBottom,u=i.renderIndentGuides!==void 0?i.renderIndentGuides:s.getValue(sz);return{getTypeNavigationMode:()=>{const t=r.getContextKeyValue(zV);if(t==="automatic")return S$.Automatic;if(t==="trigger"||r.getContextKeyValue(UV)===!1)return S$.Trigger;const i=s.getValue(YV);return i==="automatic"?S$.Automatic:i==="trigger"?S$.Trigger:void 0},disposable:l,options:{keyboardSupport:!1,...c,indent:typeof s.getValue(ez)=="number"?s.getValue(ez):void 0,renderIndentGuides:u,smoothScrolling:!!s.getValue(nz),defaultFindMode:Ez(s),defaultFindMatchType:Az(s),horizontalScrolling:h,scrollByPage:!!s.getValue(tz),paddingBottom:a,hideTwistiesOfChildlessElements:i.hideTwistiesOfChildlessElements,expandOnlyOnTwistieClick:(e=i.expandOnlyOnTwistieClick)!==null&&e!==void 0?e:s.getValue(hz)==="doubleClick",contextViewProvider:n,findWidgetStyles:dW,enableStickyScroll:!!s.getValue(cz),stickyScrollMaxItemCount:Number(s.getValue(lz))}}}Dz=EV([AV(7,Il),AV(8,Ra),AV(9,MV),AV(10,Md)],Dz);let Lz=class{get onDidOpen(){return this.navigator.onDidOpen}constructor(t,i,e,s,n,r,o){var h;this.tree=t,this.disposables=[],this.contextKeyService=KV(n,t),this.disposables.push(qV(this.contextKeyService,t)),this.listSupportsMultiSelect=RV.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(i.multipleSelectionSupport!==!1),NV.bindTo(this.contextKeyService).set(!!i.selectionNavigation),this.listSupportFindWidget=BV.bindTo(this.contextKeyService),this.listSupportFindWidget.set((h=i.findWidgetEnabled)===null||h===void 0||h),this.hasSelectionOrFocus=IV.bindTo(this.contextKeyService),this.hasDoubleSelection=_V.bindTo(this.contextKeyService),this.hasMultiSelection=PV.bindTo(this.contextKeyService),this.treeElementCanCollapse=$V.bindTo(this.contextKeyService),this.treeElementHasParent=WV.bindTo(this.contextKeyService),this.treeElementCanExpand=jV.bindTo(this.contextKeyService),this.treeElementHasChild=HV.bindTo(this.contextKeyService),this.treeFindOpen=VV.bindTo(this.contextKeyService),this.treeStickyScrollFocused=TV.bindTo(this.contextKeyService),this._useAltAsMultipleSelectionModifier=az(o),this.updateStyleOverrides(s);const c=()=>{const i=t.getFocus()[0];if(!i)return;const e=t.getNode(i);this.treeElementCanCollapse.set(e.collapsible&&!e.collapsed),this.treeElementHasParent.set(!!t.getParentElement(i)),this.treeElementCanExpand.set(e.collapsible&&e.collapsed),this.treeElementHasChild.set(!!t.getFirstElementChild(i))},l=new Set;l.add(zV),l.add(UV),this.disposables.push(this.contextKeyService,r.register(t),t.onDidChangeSelection((()=>{const i=t.getSelection(),e=t.getFocus();this.contextKeyService.bufferChangeEvents((()=>{this.hasSelectionOrFocus.set(i.length>0||e.length>0),this.hasMultiSelection.set(i.length>1),this.hasDoubleSelection.set(i.length===2)}))})),t.onDidChangeFocus((()=>{const i=t.getSelection(),e=t.getFocus();this.hasSelectionOrFocus.set(i.length>0||e.length>0),c()})),t.onDidChangeCollapseState(c),t.onDidChangeModel(c),t.onDidChangeFindOpenState((t=>this.treeFindOpen.set(t))),t.onDidChangeStickyScrollFocused((t=>this.treeStickyScrollFocused.set(t))),o.onDidChangeConfiguration((s=>{let n={};if(s.affectsConfiguration(GV)&&(this._useAltAsMultipleSelectionModifier=az(o)),s.affectsConfiguration(ez)){const t=o.getValue(ez);n={...n,indent:t}}if(s.affectsConfiguration(sz)&&i.renderIndentGuides===void 0){const t=o.getValue(sz);n={...n,renderIndentGuides:t}}if(s.affectsConfiguration(nz)){const t=!!o.getValue(nz);n={...n,smoothScrolling:t}}if(s.affectsConfiguration(QV)||s.affectsConfiguration(XV)){const t=Ez(o);n={...n,defaultFindMode:t}}if(s.affectsConfiguration(YV)||s.affectsConfiguration(XV)){const t=e();n={...n,typeNavigationMode:t}}if(s.affectsConfiguration(iz)){const t=Az(o);n={...n,defaultFindMatchType:t}}if(s.affectsConfiguration(JV)&&i.horizontalScrolling===void 0){const t=!!o.getValue(JV);n={...n,horizontalScrolling:t}}if(s.affectsConfiguration(tz)){const t=!!o.getValue(tz);n={...n,scrollByPage:t}}if(s.affectsConfiguration(hz)&&i.expandOnlyOnTwistieClick===void 0&&(n={...n,expandOnlyOnTwistieClick:o.getValue(hz)==="doubleClick"}),s.affectsConfiguration(cz)){const t=o.getValue(cz);n={...n,enableStickyScroll:t}}if(s.affectsConfiguration(lz)){const t=Math.max(1,o.getValue(lz));n={...n,stickyScrollMaxItemCount:t}}if(s.affectsConfiguration(rz)){const t=o.getValue(rz);n={...n,mouseWheelScrollSensitivity:t}}if(s.affectsConfiguration(oz)){const t=o.getValue(oz);n={...n,fastScrollSensitivity:t}}Object.keys(n).length>0&&t.updateOptions(n)})),this.contextKeyService.onDidChangeContext((i=>{i.affectsSome(l)&&t.updateOptions({typeNavigationMode:e()})}))),this.navigator=new bz(t,{configurationService:o,...i}),this.disposables.push(this.navigator)}updateOptions(t){t.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!t.multipleSelectionSupport)}updateStyleOverrides(t){this.tree.style(t?pW(t):gW)}dispose(){this.disposables=qi(this.disposables)}};Lz=EV([AV(4,Ra),AV(5,MV),AV(6,Md)],Lz);Va.as(Hd).registerConfiguration({id:"workbench",order:7,title:tt(0,"Workbench"),type:"object",properties:{[GV]:{type:"string",enum:["ctrlCmd","alt"],markdownEnumDescriptions:[tt(0,"Maps to `Control` on Windows and Linux and to `Command` on macOS."),tt(0,"Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],default:"ctrlCmd",description:tt(0,"The modifier to be used to add an item in trees and lists to a multi-selection with the mouse (for example in the explorer, open editors and scm view). The 'Open to Side' mouse gestures - if supported - will adapt such that they do not conflict with the multiselect modifier.")},[ZV]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:tt(0,"Controls how to open items in trees and lists using the mouse (if supported). Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[JV]:{type:"boolean",default:!1,description:tt(0,"Controls whether lists and trees support horizontal scrolling in the workbench. Warning: turning on this setting has a performance implication.")},[tz]:{type:"boolean",default:!1,description:tt(0,"Controls whether clicks in the scrollbar scroll page by page.")},[ez]:{type:"number",default:8,minimum:4,maximum:40,description:tt(0,"Controls tree indentation in pixels.")},[sz]:{type:"string",enum:["none","onHover","always"],default:"onHover",description:tt(0,"Controls whether the tree should render indent guides.")},[nz]:{type:"boolean",default:!1,description:tt(0,"Controls whether lists and trees have smooth scrolling.")},[rz]:{type:"number",default:1,markdownDescription:tt(0,"A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")},[oz]:{type:"number",default:5,markdownDescription:tt(0,"Scrolling speed multiplier when pressing `Alt`.")},[QV]:{type:"string",enum:["highlight","filter"],enumDescriptions:[tt(0,"Highlight elements when searching. Further up and down navigation will traverse only the highlighted elements."),tt(0,"Filter elements when searching.")],default:"highlight",description:tt(0,"Controls the default find mode for lists and trees in the workbench.")},[XV]:{type:"string",enum:["simple","highlight","filter"],enumDescriptions:[tt(0,"Simple keyboard navigation focuses elements which match the keyboard input. Matching is done only on prefixes."),tt(0,"Highlight keyboard navigation highlights elements which match the keyboard input. Further up and down navigation will traverse only the highlighted elements."),tt(0,"Filter keyboard navigation will filter out and hide all the elements which do not match the keyboard input.")],default:"highlight",description:tt(0,"Controls the keyboard navigation style for lists and trees in the workbench. Can be simple, highlight and filter."),deprecated:!0,deprecationMessage:tt(0,"Please use 'workbench.list.defaultFindMode' and\t'workbench.list.typeNavigationMode' instead.")},[iz]:{type:"string",enum:["fuzzy","contiguous"],enumDescriptions:[tt(0,"Use fuzzy matching when searching."),tt(0,"Use contiguous matching when searching.")],default:"fuzzy",description:tt(0,"Controls the type of matching used when searching lists and trees in the workbench.")},[hz]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:tt(0,"Controls how tree folders are expanded when clicking the folder names. Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[cz]:{type:"boolean",default:!0,description:tt(0,"Controls whether sticky scrolling is enabled in trees.")},[lz]:{type:"number",minimum:1,default:7,markdownDescription:tt(0,"Controls the number of sticky elements displayed in the tree when `#workbench.tree.enableStickyScroll#` is enabled.")},[YV]:{type:"string",enum:["automatic","trigger"],default:"automatic",markdownDescription:tt(0,"Controls how type navigation works in lists and trees in the workbench. When set to `trigger`, type navigation begins once the `list.triggerTypeNavigation` command is run.")}}});class Fz extends Qi{constructor(t,i){var e;super(),this.options=i,this.text="",this.title="",this.highlights=[],this.didEverRender=!1,this.supportIcons=(e=i==null?void 0:i.supportIcons)!==null&&e!==void 0&&e,this.domNode=Yc(t,nl("span.monaco-highlighted-label"))}get element(){return this.domNode}set(t,i=[],e="",s){t||(t=""),s&&(t=Fz.escapeNewLines(t,i)),this.didEverRender&&this.text===t&&this.title===e&&J(this.highlights,i)||(this.text=t,this.title=e,this.highlights=i,this.render())}render(){var t,i,e,s;const n=[];let r=0;for(const t of this.highlights){if(t.end===t.start)continue;if(r<t.start){const i=this.text.substring(r,t.start);this.supportIcons?n.push(...bI(i)):n.push(i),r=t.start}const i=this.text.substring(r,t.end),e=nl("span.highlight",void 0,...this.supportIcons?bI(i):[i]);t.extraClasses&&e.classList.add(...t.extraClasses),n.push(e),r=t.end}if(r<this.text.length){const t=this.text.substring(r);this.supportIcons?n.push(...bI(t)):n.push(t)}if(tl(this.domNode,...n),(i=(t=this.options)===null||t===void 0?void 0:t.hoverDelegate)===null||i===void 0?void 0:i.showNativeHover)this.domNode.title=this.title;else if(this.customHover||this.title==="")this.customHover&&this.customHover.update(this.title);else{const t=(s=(e=this.options)===null||e===void 0?void 0:e.hoverDelegate)!==null&&s!==void 0?s:rB("mouse");this.customHover=this._register(lB(t,this.domNode,this.title))}this.didEverRender=!0}static escapeNewLines(t,i){let e=0,s=0;return t.replace(/\r\n|\r|\n/g,((t,n)=>{s=t===`\r\n`?-1:0,n+=e;for(const t of i)t.end<=n||(t.start>=n&&(t.start+=s),t.end>=n&&(t.end+=s));return e+=s,"⏎"}))}}class Tz{constructor(t){this._element=t}get element(){return this._element}set textContent(t){this.disposed||t===this._textContent||(this._textContent=t,this._element.textContent=t)}set className(t){this.disposed||t===this._className||(this._className=t,this._element.className=t)}set empty(t){this.disposed||t===this._empty||(this._empty=t,this._element.style.marginLeft=t?"0":"")}dispose(){this.disposed=!0}}class Rz extends Qi{constructor(t,i){var e;super(),this.customHovers=new Map,this.creationOptions=i,this.domNode=this._register(new Tz(Yc(t,nl(".monaco-icon-label")))),this.labelContainer=Yc(this.domNode.element,nl(".monaco-icon-label-container")),this.nameContainer=Yc(this.labelContainer,nl("span.monaco-icon-name-container")),i!=null&&i.supportHighlights||i!=null&&i.supportIcons?this.nameNode=this._register(new Iz(this.nameContainer,!!i.supportIcons)):this.nameNode=new Oz(this.nameContainer),this.hoverDelegate=(e=i==null?void 0:i.hoverDelegate)!==null&&e!==void 0?e:rB("mouse")}get element(){return this.domNode.element}setLabel(t,i,e){var s;const n=["monaco-icon-label"],r=["monaco-icon-label-container"];let o="";if(e&&(e.extraClasses&&n.push(...e.extraClasses),e.italic&&n.push("italic"),e.strikethrough&&n.push("strikethrough"),e.disabledCommand&&r.push("disabled"),e.title&&(typeof e.title=="string"?o+=e.title:o+=t)),this.domNode.className=n.join(" "),this.domNode.element.setAttribute("aria-label",o),this.labelContainer.className=r.join(" "),this.setupHover(e!=null&&e.descriptionTitle?this.labelContainer:this.element,e==null?void 0:e.title),this.nameNode.setLabel(t,e),i||this.descriptionNode){const t=this.getOrCreateDescriptionNode();t instanceof Fz?(t.set(i||"",e?e.descriptionMatches:void 0,void 0,e==null?void 0:e.labelEscapeNewLines),this.setupHover(t.element,e==null?void 0:e.descriptionTitle)):(t.textContent=i&&(e!=null&&e.labelEscapeNewLines)?Fz.escapeNewLines(i,[]):i||"",this.setupHover(t.element,(e==null?void 0:e.descriptionTitle)||""),t.empty=!i)}(e!=null&&e.suffix||this.suffixNode)&&(this.getOrCreateSuffixNode().textContent=(s=e==null?void 0:e.suffix)!==null&&s!==void 0?s:"")}setupHover(t,i){const e=this.customHovers.get(t);if(e&&(e.dispose(),this.customHovers.delete(t)),i)if(this.hoverDelegate.showNativeHover)(function(t,i){R(i)?t.title=E_(i):i!=null&&i.markdownNotSupportedFallback?t.title=i.markdownNotSupportedFallback:t.removeAttribute("title")})(t,i);else{const e=lB(this.hoverDelegate,t,i);e&&this.customHovers.set(t,e)}else t.removeAttribute("title")}dispose(){super.dispose();for(const t of this.customHovers.values())t.dispose();this.customHovers.clear()}getOrCreateSuffixNode(){if(!this.suffixNode){const e=this._register(new Tz((t=this.nameContainer,i=nl("span.monaco-icon-suffix-container"),t.after(i),i)));this.suffixNode=this._register(new Tz(Yc(e.element,nl("span.label-suffix"))))}var t,i;return this.suffixNode}getOrCreateDescriptionNode(){var t;if(!this.descriptionNode){const i=this._register(new Tz(Yc(this.labelContainer,nl("span.monaco-icon-description-container"))));!((t=this.creationOptions)===null||t===void 0)&&t.supportDescriptionHighlights?this.descriptionNode=this._register(new Fz(Yc(i.element,nl("span.label-description")),{supportIcons:!!this.creationOptions.supportIcons})):this.descriptionNode=this._register(new Tz(Yc(i.element,nl("span.label-description"))))}return this.descriptionNode}}class Oz{constructor(t){this.container=t,this.label=void 0,this.singleLabel=void 0}setLabel(t,i){if(this.label!==t||!J(this.options,i))if(this.label=t,this.options=i,typeof t=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=Yc(this.container,nl("a.label-name",{id:i==null?void 0:i.domId}))),this.singleLabel.textContent=t;else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;for(let e=0;e<t.length;e++){const s=t[e],n=(i==null?void 0:i.domId)&&`${i==null?void 0:i.domId}_${e}`;Yc(this.container,nl("a.label-name",{id:n,"data-icon-label-count":t.length,"data-icon-label-index":e,role:"treeitem"},s)),e<t.length-1&&Yc(this.container,nl("span.label-separator",void 0,(i==null?void 0:i.separator)||"/"))}}}}class Iz extends Qi{constructor(t,i){super(),this.container=t,this.supportIcons=i,this.label=void 0,this.singleLabel=void 0}setLabel(t,i){if(this.label!==t||!J(this.options,i))if(this.label=t,this.options=i,typeof t=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=this._register(new Fz(Yc(this.container,nl("a.label-name",{id:i==null?void 0:i.domId})),{supportIcons:this.supportIcons}))),this.singleLabel.set(t,i==null?void 0:i.matches,void 0,i==null?void 0:i.labelEscapeNewLines);else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;const e=(i==null?void 0:i.separator)||"/",s=function(t,i,e){if(!e)return;let s=0;return t.map((t=>{const n={start:s,end:s+t.length},r=e.map((t=>CP.intersect(n,t))).filter((t=>!CP.isEmpty(t))).map((({start:t,end:i})=>({start:t-s,end:i-s})));return s=n.end+i.length,r}))}(t,e,i==null?void 0:i.matches);for(let n=0;n<t.length;n++){const r=t[n],o=s?s[n]:void 0,h=nl("a.label-name",{id:(i==null?void 0:i.domId)&&`${i==null?void 0:i.domId}_${n}`,"data-icon-label-count":t.length,"data-icon-label-index":n,role:"treeitem"});this._register(new Fz(Yc(this.container,h),{supportIcons:this.supportIcons})).set(r,o,void 0,i==null?void 0:i.labelEscapeNewLines),n<t.length-1&&Yc(h,nl("span.label-separator",void 0,e))}}}}const _z=nl,Pz={keybindingLabelBackground:void 0,keybindingLabelForeground:void 0,keybindingLabelBorder:void 0,keybindingLabelBottomBorder:void 0,keybindingLabelShadow:void 0};class Nz extends Qi{constructor(t,i,e){super(),this.os=i,this.keyElements=new Set,this.options=e||Object.create(null);const s=this.options.keybindingLabelForeground;this.domNode=Yc(t,_z(".monaco-keybinding")),s&&(this.domNode.style.color=s),this.hover=this._register(lB(rB("mouse"),this.domNode,"")),this.didEverRender=!1,t.appendChild(this.domNode)}get element(){return this.domNode}set(t,i){this.didEverRender&&this.keybinding===t&&Nz.areSame(this.matches,i)||(this.keybinding=t,this.matches=i,this.render())}render(){var t;if(this.clear(),this.keybinding){const i=this.keybinding.getChords();i[0]&&this.renderChord(this.domNode,i[0],this.matches?this.matches.firstPart:null);for(let t=1;t<i.length;t++)Yc(this.domNode,_z("span.monaco-keybinding-key-chord-separator",void 0," ")),this.renderChord(this.domNode,i[t],this.matches?this.matches.chordPart:null);const e=(t=this.options.disableTitle)!==null&&t!==void 0&&t?void 0:this.keybinding.getAriaLabel()||void 0;this.hover.update(e),this.domNode.setAttribute("aria-label",e||"")}else this.options&&this.options.renderUnboundKeybindings&&this.renderUnbound(this.domNode);this.didEverRender=!0}clear(){ic(this.domNode),this.keyElements.clear()}renderChord(t,i,e){const s=aN.modifierLabels[this.os];i.ctrlKey&&this.renderKey(t,s.ctrlKey,!!(e!=null&&e.ctrlKey),s.separator),i.shiftKey&&this.renderKey(t,s.shiftKey,!!(e!=null&&e.shiftKey),s.separator),i.altKey&&this.renderKey(t,s.altKey,!!(e!=null&&e.altKey),s.separator),i.metaKey&&this.renderKey(t,s.metaKey,!!(e!=null&&e.metaKey),s.separator);const n=i.keyLabel;n&&this.renderKey(t,n,!!(e!=null&&e.keyCode),"")}renderKey(t,i,e,s){Yc(t,this.createKeyElement(i,e?".highlight":"")),s&&Yc(t,_z("span.monaco-keybinding-key-separator",void 0,s))}renderUnbound(t){Yc(t,this.createKeyElement(tt(0,"Unbound")))}createKeyElement(t,i=""){const e=_z("span.monaco-keybinding-key"+i,void 0,t);return this.keyElements.add(e),this.options.keybindingLabelBackground&&(e.style.backgroundColor=this.options.keybindingLabelBackground),this.options.keybindingLabelBorder&&(e.style.borderColor=this.options.keybindingLabelBorder),this.options.keybindingLabelBottomBorder&&(e.style.borderBottomColor=this.options.keybindingLabelBottomBorder),this.options.keybindingLabelShadow&&(e.style.boxShadow=`inset 0 -1px 0 ${this.options.keybindingLabelShadow}`),e}static areSame(t,i){return t===i||!t&&!i||!!t&&!!i&&J(t.firstPart,i.firstPart)&&J(t.chordPart,i.chordPart)}}const Bz=new Hn((()=>{const t=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:t,collatorIsNumeric:t.resolvedOptions().numeric}}));function $z(t,i,e){const s=t.toLowerCase(),n=i.toLowerCase(),r=function(t,i,e){const s=t.toLowerCase(),n=i.toLowerCase(),r=s.startsWith(e),o=n.startsWith(e);if(r!==o)return r?-1:1;if(r&&o){if(s.length<n.length)return-1;if(s.length>n.length)return 1}return 0}(t,i,e);if(r)return r;const o=s.endsWith(e);if(o!==n.endsWith(e))return o?-1:1;const h=function(t,i,e=!1){const s=t||"",n=i||"",r=Bz.value.collator.compare(s,n);return Bz.value.collatorIsNumeric&&r===0&&s!==n?s<n?-1:1:r}(s,n);return h!==0?h:s.localeCompare(n)}var Wz,jz=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Hz=function(t,i){return function(e,s){i(e,s,t)}};const Vz=nl;var zz,Uz;(function(t){t[t.First=1]="First",t[t.Second=2]="Second",t[t.Last=3]="Last",t[t.Next=4]="Next",t[t.Previous=5]="Previous",t[t.NextPage=6]="NextPage",t[t.PreviousPage=7]="PreviousPage",t[t.NextSeparator=8]="NextSeparator",t[t.PreviousSeparator=9]="PreviousSeparator"})(zz||(zz={}));class Kz{constructor(t,i,e){this.index=t,this.hasCheckbox=i,this._hidden=!1,this._init=new Hn((()=>{var t;const i=(t=e.label)!==null&&t!==void 0?t:"",s=M_(i).text.trim(),n=e.ariaLabel||[i,this.saneDescription,this.saneDetail].map((t=>function(t){return t?t.replace(/\$\((.*?)\)/g,((t,i)=>` ${i} `)).trim():""}(t))).filter((t=>!!t)).join(", ");return{saneLabel:i,saneSortLabel:s,saneAriaLabel:n}})),this._saneDescription=e.description,this._saneTooltip=e.tooltip}get saneLabel(){return this._init.value.saneLabel}get saneSortLabel(){return this._init.value.saneSortLabel}get saneAriaLabel(){return this._init.value.saneAriaLabel}get element(){return this._element}set element(t){this._element=t}get hidden(){return this._hidden}set hidden(t){this._hidden=t}get saneDescription(){return this._saneDescription}set saneDescription(t){this._saneDescription=t}get saneDetail(){return this._saneDetail}set saneDetail(t){this._saneDetail=t}get saneTooltip(){return this._saneTooltip}set saneTooltip(t){this._saneTooltip=t}get labelHighlights(){return this._labelHighlights}set labelHighlights(t){this._labelHighlights=t}get descriptionHighlights(){return this._descriptionHighlights}set descriptionHighlights(t){this._descriptionHighlights=t}get detailHighlights(){return this._detailHighlights}set detailHighlights(t){this._detailHighlights=t}}class qz extends Kz{constructor(t,i,e,s,n,r){var o,h,c;super(t,i,n),this.fireButtonTriggered=e,this._onChecked=s,this.item=n,this._separator=r,this._checked=!1,this.onChecked=i?ne.map(ne.filter(this._onChecked.event,(t=>t.element===this)),(t=>t.checked)):ne.None,this._saneDetail=n.detail,this._labelHighlights=(o=n.highlights)===null||o===void 0?void 0:o.label,this._descriptionHighlights=(h=n.highlights)===null||h===void 0?void 0:h.description,this._detailHighlights=(c=n.highlights)===null||c===void 0?void 0:c.detail}get separator(){return this._separator}set separator(t){this._separator=t}get checked(){return this._checked}set checked(t){t!==this._checked&&(this._checked=t,this._onChecked.fire({element:this,checked:t}))}get checkboxDisabled(){return!!this.item.disabled}}(function(t){t[t.NONE=0]="NONE",t[t.MOUSE_HOVER=1]="MOUSE_HOVER",t[t.ACTIVE_ITEM=2]="ACTIVE_ITEM"})(Uz||(Uz={}));class Gz extends Kz{constructor(t,i,e){super(t,!1,e),this.fireSeparatorButtonTriggered=i,this.separator=e,this.children=new Array,this.focusInsideSeparator=Uz.NONE}}class Zz{getHeight(t){return t instanceof Gz?30:t.saneDetail?44:22}getTemplateId(t){return t instanceof qz?Yz.ID:Xz.ID}}class Jz{getWidgetAriaLabel(){return tt(0,"Quick Input")}getAriaLabel(t){var i;return!((i=t.separator)===null||i===void 0)&&i.label?`${t.saneAriaLabel}, ${t.separator.label}`:t.saneAriaLabel}getWidgetRole(){return"listbox"}getRole(t){return t.hasCheckbox?"checkbox":"option"}isChecked(t){if(t.hasCheckbox&&t instanceof qz)return{value:t.checked,onDidChange:t.onChecked}}}class Qz{constructor(t){this.hoverDelegate=t}renderTemplate(t){const i=Object.create(null);i.toDisposeElement=new Ji,i.toDisposeTemplate=new Ji,i.entry=Yc(t,Vz(".quick-input-list-entry"));const e=Yc(i.entry,Vz("label.quick-input-list-label"));i.toDisposeTemplate.add(rc(e,qc.CLICK,(t=>{i.checkbox.offsetParent||t.preventDefault()}))),i.checkbox=Yc(e,Vz("input.quick-input-list-checkbox")),i.checkbox.type="checkbox";const s=Yc(e,Vz(".quick-input-list-rows")),n=Yc(s,Vz(".quick-input-list-row")),r=Yc(s,Vz(".quick-input-list-row"));i.label=new Rz(n,{supportHighlights:!0,supportDescriptionHighlights:!0,supportIcons:!0,hoverDelegate:this.hoverDelegate}),i.toDisposeTemplate.add(i.label),i.icon=Xc(i.label.element,Vz(".quick-input-list-icon"));const o=Yc(n,Vz(".quick-input-list-entry-keybinding"));i.keybinding=new Nz(o,Ft),i.toDisposeTemplate.add(i.keybinding);const h=Yc(r,Vz(".quick-input-list-label-meta"));return i.detail=new Rz(h,{supportHighlights:!0,supportIcons:!0,hoverDelegate:this.hoverDelegate}),i.toDisposeTemplate.add(i.detail),i.separator=Yc(i.entry,Vz(".quick-input-list-separator")),i.actionBar=new LW(i.entry,this.hoverDelegate?{hoverDelegate:this.hoverDelegate}:void 0),i.actionBar.domNode.classList.add("quick-input-list-entry-action-bar"),i.toDisposeTemplate.add(i.actionBar),i}disposeTemplate(t){t.toDisposeElement.dispose(),t.toDisposeTemplate.dispose()}disposeElement(t,i,e){e.toDisposeElement.clear(),e.actionBar.clear()}}let Yz=Wz=class extends Qz{constructor(t,i){super(t),this.themeService=i,this._itemsWithSeparatorsFrequency=new Map}get templateId(){return Wz.ID}renderTemplate(t){const i=super.renderTemplate(t);return i.toDisposeTemplate.add(rc(i.checkbox,qc.CHANGE,(t=>{i.element.checked=i.checkbox.checked}))),i}renderElement(t,i,e){var s,n,r;const o=t.element;e.element=o,o.element=(s=e.entry)!==null&&s!==void 0?s:void 0;const h=o.item;e.checkbox.checked=o.checked,e.toDisposeElement.add(o.onChecked((t=>e.checkbox.checked=t))),e.checkbox.disabled=o.checkboxDisabled;const{labelHighlights:c,descriptionHighlights:l,detailHighlights:a}=o;if(h.iconPath){const t=ak(this.themeService.getColorTheme().type)?h.iconPath.dark:(n=h.iconPath.light)!==null&&n!==void 0?n:h.iconPath.dark,i=as.revive(t);e.icon.className="quick-input-list-icon",e.icon.style.backgroundImage=ll(i)}else e.icon.style.backgroundImage="",e.icon.className=h.iconClass?`quick-input-list-icon ${h.iconClass}`:"";let u;!o.saneTooltip&&o.saneDescription&&(u={markdown:{value:o.saneDescription,supportThemeIcons:!0},markdownNotSupportedFallback:o.saneDescription});const d={matches:c||[],descriptionTitle:u,descriptionMatches:l||[],labelEscapeNewLines:!0};if(d.extraClasses=h.iconClasses,d.italic=h.italic,d.strikethrough=h.strikethrough,e.entry.classList.remove("quick-input-list-separator-as-item"),e.label.setLabel(o.saneLabel,o.saneDescription,d),e.keybinding.set(h.keybinding),o.saneDetail){let t;o.saneTooltip||(t={markdown:{value:o.saneDetail,supportThemeIcons:!0},markdownNotSupportedFallback:o.saneDetail}),e.detail.element.style.display="",e.detail.setLabel(o.saneDetail,void 0,{matches:a,title:t,labelEscapeNewLines:!0})}else e.detail.element.style.display="none";!((r=o.separator)===null||r===void 0)&&r.label?(e.separator.textContent=o.separator.label,e.separator.style.display="",this.addItemWithSeparator(o)):e.separator.style.display="none",e.entry.classList.toggle("quick-input-list-separator-border",!!o.separator);const f=h.buttons;f&&f.length?(e.actionBar.push(f.map(((t,i)=>Mj(t,`id-${i}`,(()=>o.fireButtonTriggered({button:t,item:o.item}))))),{icon:!0,label:!1}),e.entry.classList.add("has-actions")):e.entry.classList.remove("has-actions")}disposeElement(t,i,e){this.removeItemWithSeparator(t.element),super.disposeElement(t,i,e)}isItemWithSeparatorVisible(t){return this._itemsWithSeparatorsFrequency.has(t)}addItemWithSeparator(t){this._itemsWithSeparatorsFrequency.set(t,(this._itemsWithSeparatorsFrequency.get(t)||0)+1)}removeItemWithSeparator(t){const i=this._itemsWithSeparatorsFrequency.get(t)||0;i>1?this._itemsWithSeparatorsFrequency.set(t,i-1):this._itemsWithSeparatorsFrequency.delete(t)}};Yz.ID="quickpickitem",Yz=Wz=jz([Hz(1,AC)],Yz);class Xz extends Qz{constructor(){super(...arguments),this._visibleSeparatorsFrequency=new Map}get templateId(){return Xz.ID}get visibleSeparators(){return[...this._visibleSeparatorsFrequency.keys()]}isSeparatorVisible(t){return this._visibleSeparatorsFrequency.has(t)}renderElement(t,i,e){var s;const n=t.element;e.element=n,n.element=(s=e.entry)!==null&&s!==void 0?s:void 0,n.element.classList.toggle("focus-inside",!!n.focusInsideSeparator);const r=n.separator,{labelHighlights:o,descriptionHighlights:h,detailHighlights:c}=n;let l;e.icon.style.backgroundImage="",e.icon.className="",!n.saneTooltip&&n.saneDescription&&(l={markdown:{value:n.saneDescription,supportThemeIcons:!0},markdownNotSupportedFallback:n.saneDescription});const a={matches:o||[],descriptionTitle:l,descriptionMatches:h||[],labelEscapeNewLines:!0};if(e.entry.classList.add("quick-input-list-separator-as-item"),e.label.setLabel(n.saneLabel,n.saneDescription,a),n.saneDetail){let t;n.saneTooltip||(t={markdown:{value:n.saneDetail,supportThemeIcons:!0},markdownNotSupportedFallback:n.saneDetail}),e.detail.element.style.display="",e.detail.setLabel(n.saneDetail,void 0,{matches:c,title:t,labelEscapeNewLines:!0})}else e.detail.element.style.display="none";e.separator.style.display="none",e.entry.classList.add("quick-input-list-separator-border");const u=r.buttons;u&&u.length?(e.actionBar.push(u.map(((t,i)=>Mj(t,`id-${i}`,(()=>n.fireSeparatorButtonTriggered({button:t,separator:n.separator}))))),{icon:!0,label:!1}),e.entry.classList.add("has-actions")):e.entry.classList.remove("has-actions"),this.addSeparator(n)}disposeElement(t,i,e){var s;this.removeSeparator(t.element),this.isSeparatorVisible(t.element)||(s=t.element.element)===null||s===void 0||s.classList.remove("focus-inside"),super.disposeElement(t,i,e)}addSeparator(t){this._visibleSeparatorsFrequency.set(t,(this._visibleSeparatorsFrequency.get(t)||0)+1)}removeSeparator(t){const i=this._visibleSeparatorsFrequency.get(t)||0;i>1?this._visibleSeparatorsFrequency.set(t,i-1):this._visibleSeparatorsFrequency.delete(t)}}Xz.ID="quickpickseparator";let tU=class extends Qi{constructor(t,i,e,s,n){super(),this.parent=t,this.hoverDelegate=i,this.linkOpenerDelegate=e,this._onKeyDown=new le,this.onKeyDown=this._onKeyDown.event,this._onLeave=new le,this.onLeave=this._onLeave.event,this._onChangedAllVisibleChecked=new le,this.onChangedAllVisibleChecked=this._onChangedAllVisibleChecked.event,this._onChangedCheckedCount=new le,this.onChangedCheckedCount=this._onChangedCheckedCount.event,this._onChangedVisibleCount=new le,this.onChangedVisibleCount=this._onChangedVisibleCount.event,this._onChangedCheckedElements=new le,this.onChangedCheckedElements=this._onChangedCheckedElements.event,this._onButtonTriggered=new le,this.onButtonTriggered=this._onButtonTriggered.event,this._onSeparatorButtonTriggered=new le,this.onSeparatorButtonTriggered=this._onSeparatorButtonTriggered.event,this._onTriggerEmptySelectionOrFocus=new le,this._elementChecked=new le,this._inputElements=new Array,this._elementTree=new Array,this._itemElements=new Array,this._elementDisposable=this._register(new Ji),this._shouldFireCheckedEvents=!0,this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._matchOnLabelMode="fuzzy",this._sortByLabel=!0,this._container=Yc(this.parent,Vz(".quick-input-list")),this._separatorRenderer=new Xz(i),this._itemRenderer=n.createInstance(Yz,i),this._tree=this._register(n.createInstance(kz,"QuickInput",this._container,new Zz,[this._itemRenderer,this._separatorRenderer],{accessibilityProvider:new Jz,setRowLineHeight:!1,multipleSelectionSupport:!1,hideTwistiesOfChildlessElements:!0,renderIndentGuides:fH.None,findWidgetEnabled:!1,indent:0,horizontalScrolling:!1,allowNonCollapsibleParents:!0,identityProvider:{getId:t=>{var i,e,s,n,r,o,h,c;return(c=(o=(n=(e=(i=t.item)===null||i===void 0?void 0:i.id)!==null&&e!==void 0?e:(s=t.item)===null||s===void 0?void 0:s.label)!==null&&n!==void 0?n:(r=t.separator)===null||r===void 0?void 0:r.id)!==null&&o!==void 0?o:(h=t.separator)===null||h===void 0?void 0:h.label)!==null&&c!==void 0?c:""}},alwaysConsumeMouseWheel:!0})),this._tree.getHTMLElement().id=s,this._registerListeners()}get onDidChangeFocus(){return ne.map(ne.any(this._tree.onDidChangeFocus,this._onTriggerEmptySelectionOrFocus.event),(t=>t.elements.filter((t=>t instanceof qz)).map((t=>t.item))))}get onDidChangeSelection(){return ne.map(ne.any(this._tree.onDidChangeSelection,this._onTriggerEmptySelectionOrFocus.event),(t=>({items:t.elements.filter((t=>t instanceof qz)).map((t=>t.item)),event:t.browserEvent})))}get scrollTop(){return this._tree.scrollTop}set scrollTop(t){this._tree.scrollTop=t}get ariaLabel(){return this._tree.ariaLabel}set ariaLabel(t){this._tree.ariaLabel=t??""}set enabled(t){this._tree.getHTMLElement().style.pointerEvents=t?"":"none"}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(t){this._matchOnDescription=t}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(t){this._matchOnDetail=t}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(t){this._matchOnLabel=t}get matchOnLabelMode(){return this._matchOnLabelMode}set matchOnLabelMode(t){this._matchOnLabelMode=t}get sortByLabel(){return this._sortByLabel}set sortByLabel(t){this._sortByLabel=t}_registerListeners(){this._registerOnKeyDown(),this._registerOnContainerClick(),this._registerOnMouseMiddleClick(),this._registerOnElementChecked(),this._registerOnContextMenu(),this._registerHoverListeners(),this._registerSelectionChangeListener(),this._registerSeparatorActionShowingListeners()}_registerOnKeyDown(){this._register(this._tree.onKeyDown((t=>{const i=new so(t);switch(i.keyCode){case 10:this.toggleCheckbox();break;case 31:(bt?t.metaKey:t.ctrlKey)&&this._tree.setFocus(this._itemElements);break;case 16:{const t=this._tree.getFocus();t.length===1&&t[0]===this._itemElements[0]&&this._onLeave.fire();break}case 18:{const t=this._tree.getFocus();t.length===1&&t[0]===this._itemElements[this._itemElements.length-1]&&this._onLeave.fire();break}}this._onKeyDown.fire(i)})))}_registerOnContainerClick(){this._register(sc(this._container,qc.CLICK,(t=>{(t.x||t.y)&&this._onLeave.fire()})))}_registerOnMouseMiddleClick(){this._register(sc(this._container,qc.AUXCLICK,(t=>{t.button===1&&this._onLeave.fire()})))}_registerOnElementChecked(){this._register(this._elementChecked.event((t=>this._fireCheckedEvents())))}_registerOnContextMenu(){this._register(this._tree.onContextMenu((t=>{t.element&&(t.browserEvent.preventDefault(),this._tree.setSelection([t.element]))})))}_registerHoverListeners(){const t=this._register(new mo(this.hoverDelegate.delay));this._register(this._tree.onMouseOver((async i=>{var e;if(i.browserEvent.target instanceof HTMLAnchorElement)t.cancel();else if(i.browserEvent.relatedTarget instanceof HTMLAnchorElement||!xc(i.browserEvent.relatedTarget,(e=i.element)===null||e===void 0?void 0:e.element))try{await t.trigger((async()=>{i.element instanceof qz&&this.showHover(i.element)}))}catch(t){if(!Bi(t))throw t}}))),this._register(this._tree.onMouseOut((i=>{var e;xc(i.browserEvent.relatedTarget,(e=i.element)===null||e===void 0?void 0:e.element)||t.cancel()})))}_registerSeparatorActionShowingListeners(){this._register(this._tree.onDidChangeFocus((t=>{const i=t.elements[0]?this._tree.getParentElement(t.elements[0]):null;for(const t of this._separatorRenderer.visibleSeparators){const e=t===i;!!(t.focusInsideSeparator&Uz.ACTIVE_ITEM)!==e&&(e?t.focusInsideSeparator|=Uz.ACTIVE_ITEM:t.focusInsideSeparator&=~Uz.ACTIVE_ITEM,this._tree.rerender(t))}}))),this._register(this._tree.onMouseOver((t=>{const i=t.element?this._tree.getParentElement(t.element):null;for(const t of this._separatorRenderer.visibleSeparators)t===i&&(t.focusInsideSeparator&Uz.MOUSE_HOVER||(t.focusInsideSeparator|=Uz.MOUSE_HOVER,this._tree.rerender(t)))}))),this._register(this._tree.onMouseOut((t=>{const i=t.element?this._tree.getParentElement(t.element):null;for(const t of this._separatorRenderer.visibleSeparators)t===i&&t.focusInsideSeparator&Uz.MOUSE_HOVER&&(t.focusInsideSeparator&=~Uz.MOUSE_HOVER,this._tree.rerender(t))})))}_registerSelectionChangeListener(){this._register(this._tree.onDidChangeSelection((t=>{const i=t.elements.filter((t=>t instanceof qz));i.length!==t.elements.length&&(t.elements.length===1&&t.elements[0]instanceof Gz&&(this._tree.setFocus([t.elements[0].children[0]]),this._tree.reveal(t.elements[0],0)),this._tree.setSelection(i))})))}getAllVisibleChecked(){return this._allVisibleChecked(this._itemElements,!1)}getCheckedCount(){return this._itemElements.filter((t=>t.checked)).length}getVisibleCount(){return this._itemElements.filter((t=>!t.hidden)).length}setAllVisibleChecked(t){try{this._shouldFireCheckedEvents=!1,this._itemElements.forEach((i=>{i.hidden||i.checkboxDisabled||(i.checked=t)}))}finally{this._shouldFireCheckedEvents=!0,this._fireCheckedEvents()}}setElements(t){this._elementDisposable.clear(),this._inputElements=t;const i=this.parent.classList.contains("show-checkboxes");let e;this._itemElements=new Array,this._elementTree=t.reduce(((s,n,r)=>{let o;if(n.type==="separator"){if(!n.buttons)return s;e=new Gz(r,(t=>this.fireSeparatorButtonTriggered(t)),n),o=e}else{const h=r>0?t[r-1]:void 0;let c;h&&h.type==="separator"&&!h.buttons&&(e=void 0,c=h);const l=new qz(r,i,(t=>this.fireButtonTriggered(t)),this._elementChecked,n,c);if(this._itemElements.push(l),e)return e.children.push(l),s;o=l}return s.push(o),s}),new Array);const s=new Array;let n=0;for(const t of this._elementTree)t instanceof Gz?(s.push({element:t,collapsible:!1,collapsed:!1,children:t.children.map((t=>({element:t,collapsible:!1,collapsed:!1})))}),n+=t.children.length+1):(s.push({element:t,collapsible:!1,collapsed:!1}),n++);this._tree.setChildren(null,s),this._onChangedVisibleCount.fire(n)}setFocusedElements(t){const i=t.map((t=>this._itemElements.find((i=>i.item===t)))).filter((t=>!!t));if(this._tree.setFocus(i),t.length>0){const t=this._tree.getFocus()[0];t&&this._tree.reveal(t)}}getActiveDescendant(){return this._tree.getHTMLElement().getAttribute("aria-activedescendant")}setSelectedElements(t){const i=t.map((t=>this._itemElements.find((i=>i.item===t)))).filter((t=>!!t));this._tree.setSelection(i)}getCheckedElements(){return this._itemElements.filter((t=>t.checked)).map((t=>t.item))}setCheckedElements(t){try{this._shouldFireCheckedEvents=!1;const i=new Set;for(const e of t)i.add(e);for(const t of this._itemElements)t.checked=i.has(t.item)}finally{this._shouldFireCheckedEvents=!0,this._fireCheckedEvents()}}focus(t){var i;if(this._itemElements.length)switch(t===zz.Second&&this._itemElements.length<2&&(t=zz.First),t){case zz.First:this._tree.scrollTop=0,this._tree.focusFirst(void 0,(t=>t.element instanceof qz));break;case zz.Second:this._tree.scrollTop=0,this._tree.setFocus([this._itemElements[1]]);break;case zz.Last:this._tree.scrollTop=this._tree.scrollHeight,this._tree.setFocus([this._itemElements[this._itemElements.length-1]]);break;case zz.Next:this._tree.focusNext(void 0,!0,void 0,(t=>t.element instanceof qz&&(this._tree.reveal(t.element),!0)));break;case zz.Previous:this._tree.focusPrevious(void 0,!0,void 0,(t=>{if(!(t.element instanceof qz))return!1;const i=this._tree.getParentElement(t.element);return i===null||i.children[0]!==t.element?this._tree.reveal(t.element):this._tree.reveal(i),!0}));break;case zz.NextPage:this._tree.focusNextPage(void 0,(t=>t.element instanceof qz&&(this._tree.reveal(t.element),!0)));break;case zz.PreviousPage:this._tree.focusPreviousPage(void 0,(t=>{if(!(t.element instanceof qz))return!1;const i=this._tree.getParentElement(t.element);return i===null||i.children[0]!==t.element?this._tree.reveal(t.element):this._tree.reveal(i),!0}));break;case zz.NextSeparator:{let t=!1;const i=this._tree.getFocus()[0];this._tree.focusNext(void 0,!0,void 0,(i=>{if(t)return!0;if(i.element instanceof Gz)t=!0,this._separatorRenderer.isSeparatorVisible(i.element)?this._tree.reveal(i.element.children[0]):this._tree.reveal(i.element,0);else if(i.element instanceof qz){if(i.element.separator)return this._itemRenderer.isItemWithSeparatorVisible(i.element)?this._tree.reveal(i.element):this._tree.reveal(i.element,0),!0;if(i.element===this._elementTree[0])return this._tree.reveal(i.element,0),!0}return!1})),i===this._tree.getFocus()[0]&&(this._tree.scrollTop=this._tree.scrollHeight,this._tree.setFocus([this._itemElements[this._itemElements.length-1]]));break}case zz.PreviousSeparator:{let t,e=!!(!((i=this._tree.getFocus()[0])===null||i===void 0)&&i.separator);this._tree.focusPrevious(void 0,!0,void 0,(i=>{if(i.element instanceof Gz)e?t||(this._separatorRenderer.isSeparatorVisible(i.element)?this._tree.reveal(i.element):this._tree.reveal(i.element,0),t=i.element.children[0]):e=!0;else if(i.element instanceof qz&&!t){if(i.element.separator)this._itemRenderer.isItemWithSeparatorVisible(i.element)?this._tree.reveal(i.element):this._tree.reveal(i.element,0),t=i.element;else if(i.element===this._elementTree[0])return this._tree.reveal(i.element,0),!0}return!1})),t&&this._tree.setFocus([t]);break}}}clearFocus(){this._tree.setFocus([])}domFocus(){this._tree.domFocus()}layout(t){this._tree.getHTMLElement().style.maxHeight=t?44*Math.floor(t/44)+6+"px":"",this._tree.layout()}filter(t){if(!(this._sortByLabel||this._matchOnLabel||this._matchOnDescription||this._matchOnDetail))return this._tree.layout(),!1;const i=t;if((t=t.trim())&&(this.matchOnLabel||this.matchOnDescription||this.matchOnDetail)){let e;this._elementTree.forEach((s=>{var n,r,o,h;let c;c=this.matchOnLabelMode==="fuzzy"?this.matchOnLabel&&(n=L_(t,M_(s.saneLabel)))!==null&&n!==void 0?n:void 0:this.matchOnLabel&&(r=function(t,i){const{text:e,iconOffsets:s}=i;if(!s||s.length===0)return iU(t,e);const n=Jn(e," "),r=e.length-n.length,o=iU(t,n);if(o)for(const t of o){const i=s[t.start+r]+r;t.start+=i,t.end+=i}return o}(i,M_(s.saneLabel)))!==null&&r!==void 0?r:void 0;const l=this.matchOnDescription&&(o=L_(t,M_(s.saneDescription||"")))!==null&&o!==void 0?o:void 0,a=this.matchOnDetail&&(h=L_(t,M_(s.saneDetail||"")))!==null&&h!==void 0?h:void 0;if(c||l||a?(s.labelHighlights=c,s.descriptionHighlights=l,s.detailHighlights=a,s.hidden=!1):(s.labelHighlights=void 0,s.descriptionHighlights=void 0,s.detailHighlights=void 0,s.hidden=!s.item||!s.item.alwaysShow),s.item?s.separator=void 0:s.separator&&(s.hidden=!0),!this.sortByLabel){const t=s.index&&this._inputElements[s.index-1];e=t&&t.type==="separator"?t:e,e&&!s.hidden&&(s.separator=e,e=void 0)}}))}else this._itemElements.forEach((t=>{t.labelHighlights=void 0,t.descriptionHighlights=void 0,t.detailHighlights=void 0,t.hidden=!1;const i=t.index&&this._inputElements[t.index-1];t.item&&(t.separator=i&&i.type==="separator"&&!i.buttons?i:void 0)}));const e=this._elementTree.filter((t=>!t.hidden));if(this.sortByLabel&&t){const i=t.toLowerCase();e.sort(((t,e)=>function(t,i,e){const s=t.labelHighlights||[],n=i.labelHighlights||[];return s.length&&!n.length?-1:!s.length&&n.length?1:s.length===0&&n.length===0?0:$z(t.saneSortLabel,i.saneSortLabel,e)}(t,e,i)))}let s;const n=e.reduce(((t,i,e)=>(i instanceof qz?s?s.children.push(i):t.push(i):i instanceof Gz&&(i.children=[],s=i,t.push(i)),t)),new Array),r=new Array;for(const t of n)t instanceof Gz?r.push({element:t,collapsible:!1,collapsed:!1,children:t.children.map((t=>({element:t,collapsible:!1,collapsed:!1})))}):r.push({element:t,collapsible:!1,collapsed:!1});const o=this._tree.getFocus().length;return this._tree.setChildren(null,r),o>0&&r.length===0&&this._onTriggerEmptySelectionOrFocus.fire({elements:[]}),this._tree.layout(),this._onChangedAllVisibleChecked.fire(this.getAllVisibleChecked()),this._onChangedVisibleCount.fire(e.length),!0}toggleCheckbox(){try{this._shouldFireCheckedEvents=!1;const t=this._tree.getFocus().filter((t=>t instanceof qz)),i=this._allVisibleChecked(t);for(const e of t)e.checkboxDisabled||(e.checked=!i)}finally{this._shouldFireCheckedEvents=!0,this._fireCheckedEvents()}}display(t){this._container.style.display=t?"":"none"}isDisplayed(){return this._container.style.display!=="none"}style(t){this._tree.style(t)}toggleHover(){const t=this._tree.getFocus()[0];if(!(t!=null&&t.saneTooltip&&t instanceof qz))return;if(this._lastHover&&!this._lastHover.isDisposed)return void this._lastHover.dispose();this.showHover(t);const i=new Ji;i.add(this._tree.onDidChangeFocus((t=>{t.elements[0]instanceof qz&&this.showHover(t.elements[0])}))),this._lastHover&&i.add(this._lastHover),this._elementDisposable.add(i)}_allVisibleChecked(t,i=!0){for(let e=0,s=t.length;e<s;e++){const s=t[e];if(!s.hidden){if(!s.checked)return!1;i=!0}}return i}_fireCheckedEvents(){this._shouldFireCheckedEvents&&(this._onChangedAllVisibleChecked.fire(this.getAllVisibleChecked()),this._onChangedCheckedCount.fire(this.getCheckedCount()),this._onChangedCheckedElements.fire(this.getCheckedElements()))}fireButtonTriggered(t){this._onButtonTriggered.fire(t)}fireSeparatorButtonTriggered(t){this._onSeparatorButtonTriggered.fire(t)}showHover(t){var i,e,s;this._lastHover&&!this._lastHover.isDisposed&&((e=(i=this.hoverDelegate).onDidHideHover)===null||e===void 0||e.call(i),(s=this._lastHover)===null||s===void 0||s.dispose()),t.element&&t.saneTooltip&&(this._lastHover=this.hoverDelegate.showHover({content:t.saneTooltip,target:t.element,linkHandler:t=>{this.linkOpenerDelegate(t)},appearance:{showPointer:!0},container:this._container,position:{hoverPosition:1}},!1))}};function iU(t,i){const e=i.toLowerCase().indexOf(t.toLowerCase());return e!==-1?[{start:e,end:e+t.length}]:null}jz([Nk],tU.prototype,"onDidChangeFocus",null),jz([Nk],tU.prototype,"onDidChangeSelection",null),tU=jz([Hz(4,Il)],tU);var eU=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},sU=function(t,i){return function(e,s){i(e,s,t)}};const nU={iconClass:Kl.asClassName(As.quickInputBack),tooltip:tt(0,"Back"),handle:-1};class rU extends Qi{constructor(t){super(),this.ui=t,this._widgetUpdated=!1,this.visible=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!1,this._buttons=[],this.buttonsUpdated=!1,this._toggles=[],this.togglesUpdated=!1,this.noValidationMessage=rU.noPromptMessage,this._severity=dR.Ignore,this.onDidTriggerButtonEmitter=this._register(new le),this.onDidHideEmitter=this._register(new le),this.onWillHideEmitter=this._register(new le),this.onDisposeEmitter=this._register(new le),this.visibleDisposables=this._register(new Ji),this.onDidHide=this.onDidHideEmitter.event}get title(){return this._title}set title(t){this._title=t,this.update()}get description(){return this._description}set description(t){this._description=t,this.update()}get step(){return this._steps}set step(t){this._steps=t,this.update()}get totalSteps(){return this._totalSteps}set totalSteps(t){this._totalSteps=t,this.update()}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this.update()}get contextKey(){return this._contextKey}set contextKey(t){this._contextKey=t,this.update()}get busy(){return this._busy}set busy(t){this._busy=t,this.update()}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(t){const i=this._ignoreFocusOut!==t&&!xt;this._ignoreFocusOut=t&&!xt,i&&this.update()}get buttons(){return this._buttons}set buttons(t){this._buttons=t,this.buttonsUpdated=!0,this.update()}get toggles(){return this._toggles}set toggles(t){this._toggles=t??[],this.togglesUpdated=!0,this.update()}get validationMessage(){return this._validationMessage}set validationMessage(t){this._validationMessage=t,this.update()}get severity(){return this._severity}set severity(t){this._severity=t,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.onDidTriggerButton((t=>{this.buttons.indexOf(t)!==-1&&this.onDidTriggerButtonEmitter.fire(t)}))),this.ui.show(this),this.visible=!0,this._lastValidationMessage=void 0,this._lastSeverity=void 0,this.buttons.length&&(this.buttonsUpdated=!0),this.toggles.length&&(this.togglesUpdated=!0),this.update())}hide(){this.visible&&this.ui.hide()}didHide(t=mj.Other){this.visible=!1,this.visibleDisposables.clear(),this.onDidHideEmitter.fire({reason:t})}willHide(t=mj.Other){this.onWillHideEmitter.fire({reason:t})}update(){var t,i;if(!this.visible)return;const e=this.getTitle();e&&this.ui.title.textContent!==e?this.ui.title.textContent=e:e||this.ui.title.innerHTML==="&nbsp;"||(this.ui.title.innerText=" ");const s=this.getDescription();if(this.ui.description1.textContent!==s&&(this.ui.description1.textContent=s),this.ui.description2.textContent!==s&&(this.ui.description2.textContent=s),this._widgetUpdated&&(this._widgetUpdated=!1,this._widget?tl(this.ui.widget,this._widget):tl(this.ui.widget)),this.busy&&!this.busyDelay&&(this.busyDelay=new yo,this.busyDelay.setIfNotSet((()=>{this.visible&&this.ui.progressBar.infinite()}),800)),!this.busy&&this.busyDelay&&(this.ui.progressBar.stop(),this.busyDelay.cancel(),this.busyDelay=void 0),this.buttonsUpdated){this.buttonsUpdated=!1,this.ui.leftActionBar.clear();const t=this.buttons.filter((t=>t===nU)).map(((t,i)=>Mj(t,`id-${i}`,(async()=>this.onDidTriggerButtonEmitter.fire(t)))));this.ui.leftActionBar.push(t,{icon:!0,label:!1}),this.ui.rightActionBar.clear();const i=this.buttons.filter((t=>t!==nU)).map(((t,i)=>Mj(t,`id-${i}`,(async()=>this.onDidTriggerButtonEmitter.fire(t)))));this.ui.rightActionBar.push(i,{icon:!0,label:!1})}if(this.togglesUpdated){this.togglesUpdated=!1;const e=(i=(t=this.toggles)===null||t===void 0?void 0:t.filter((t=>t instanceof Cj)))!==null&&i!==void 0?i:[];this.ui.inputBox.toggles=e}this.ui.ignoreFocusOut=this.ignoreFocusOut,this.ui.setEnabled(this.enabled),this.ui.setContextKey(this.contextKey);const n=this.validationMessage||this.noValidationMessage;this._lastValidationMessage!==n&&(this._lastValidationMessage=n,tl(this.ui.message),Lj(n,this.ui.message,{callback:t=>{this.ui.linkOpenerDelegate(t)},disposables:this.visibleDisposables})),this._lastSeverity!==this.severity&&(this._lastSeverity=this.severity,this.showMessageDecoration(this.severity))}getTitle(){return this.title&&this.step?`${this.title} (${this.getSteps()})`:this.title?this.title:this.step?this.getSteps():""}getDescription(){return this.description||""}getSteps(){return this.step&&this.totalSteps?tt(0,"{0}/{1}",this.step,this.totalSteps):this.step?String(this.step):""}showMessageDecoration(t){if(this.ui.inputBox.showDecoration(t),t!==dR.Ignore){const i=this.ui.inputBox.stylesForType(t);this.ui.message.style.color=i.foreground?`${i.foreground}`:"",this.ui.message.style.backgroundColor=i.background?`${i.background}`:"",this.ui.message.style.border=i.border?`1px solid ${i.border}`:"",this.ui.message.style.marginBottom="-2px"}else this.ui.message.style.color="",this.ui.message.style.backgroundColor="",this.ui.message.style.border="",this.ui.message.style.marginBottom=""}dispose(){this.hide(),this.onDisposeEmitter.fire(),super.dispose()}}rU.noPromptMessage=tt(0,"Press 'Enter' to confirm your input or 'Escape' to cancel");class oU extends rU{constructor(){super(...arguments),this._value="",this.onDidChangeValueEmitter=this._register(new le),this.onWillAcceptEmitter=this._register(new le),this.onDidAcceptEmitter=this._register(new le),this.onDidCustomEmitter=this._register(new le),this._items=[],this.itemsUpdated=!1,this._canSelectMany=!1,this._canAcceptInBackground=!1,this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._matchOnLabelMode="fuzzy",this._sortByLabel=!0,this._keepScrollPosition=!1,this._itemActivation=wj.FIRST,this._activeItems=[],this.activeItemsUpdated=!1,this.activeItemsToConfirm=[],this.onDidChangeActiveEmitter=this._register(new le),this._selectedItems=[],this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=[],this.onDidChangeSelectionEmitter=this._register(new le),this.onDidTriggerItemButtonEmitter=this._register(new le),this.onDidTriggerSeparatorButtonEmitter=this._register(new le),this.valueSelectionUpdated=!0,this._ok="default",this._customButton=!1,this.filterValue=t=>t,this.onDidChangeValue=this.onDidChangeValueEmitter.event,this.onWillAccept=this.onWillAcceptEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event,this.onDidChangeActive=this.onDidChangeActiveEmitter.event,this.onDidChangeSelection=this.onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this.onDidTriggerItemButtonEmitter.event,this.onDidTriggerSeparatorButton=this.onDidTriggerSeparatorButtonEmitter.event}get quickNavigate(){return this._quickNavigate}set quickNavigate(t){this._quickNavigate=t,this.update()}get value(){return this._value}set value(t){this.doSetValue(t)}doSetValue(t,i){this._value!==t&&(this._value=t,i||this.update(),this.visible&&this.ui.list.filter(this.filterValue(this._value))&&this.trySelectFirst(),this.onDidChangeValueEmitter.fire(this._value))}set ariaLabel(t){this._ariaLabel=t,this.update()}get ariaLabel(){return this._ariaLabel}get placeholder(){return this._placeholder}set placeholder(t){this._placeholder=t,this.update()}get items(){return this._items}get scrollTop(){return this.ui.list.scrollTop}set scrollTop(t){this.ui.list.scrollTop=t}set items(t){this._items=t,this.itemsUpdated=!0,this.update()}get canSelectMany(){return this._canSelectMany}set canSelectMany(t){this._canSelectMany=t,this.update()}get canAcceptInBackground(){return this._canAcceptInBackground}set canAcceptInBackground(t){this._canAcceptInBackground=t}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(t){this._matchOnDescription=t,this.update()}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(t){this._matchOnDetail=t,this.update()}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(t){this._matchOnLabel=t,this.update()}get matchOnLabelMode(){return this._matchOnLabelMode}set matchOnLabelMode(t){this._matchOnLabelMode=t,this.update()}get sortByLabel(){return this._sortByLabel}set sortByLabel(t){this._sortByLabel=t,this.update()}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(t){this._keepScrollPosition=t}get itemActivation(){return this._itemActivation}set itemActivation(t){this._itemActivation=t}get activeItems(){return this._activeItems}set activeItems(t){this._activeItems=t,this.activeItemsUpdated=!0,this.update()}get selectedItems(){return this._selectedItems}set selectedItems(t){this._selectedItems=t,this.selectedItemsUpdated=!0,this.update()}get keyMods(){return this._quickNavigate?pj:this.ui.keyMods}get valueSelection(){const t=this.ui.inputBox.getSelection();if(t)return[t.start,t.end]}set valueSelection(t){this._valueSelection=t,this.valueSelectionUpdated=!0,this.update()}get customButton(){return this._customButton}set customButton(t){this._customButton=t,this.update()}get customLabel(){return this._customButtonLabel}set customLabel(t){this._customButtonLabel=t,this.update()}get customHover(){return this._customButtonHover}set customHover(t){this._customButtonHover=t,this.update()}get ok(){return this._ok}set ok(t){this._ok=t,this.update()}get hideInput(){return!!this._hideInput}set hideInput(t){this._hideInput=t,this.update()}trySelectFirst(){this.canSelectMany||this.ui.list.focus(zz.First)}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange((t=>{this.doSetValue(t,!0)}))),this.visibleDisposables.add((this._hideInput?this.ui.list:this.ui.inputBox).onKeyDown((t=>{switch(t.keyCode){case 18:(bt?t.metaKey:t.altKey)?this.ui.list.focus(zz.NextSeparator):this.ui.list.focus(zz.Next),this.canSelectMany&&this.ui.list.domFocus(),Zc(t,!0);break;case 16:(bt?t.metaKey:t.altKey)?this.ui.list.focus(zz.PreviousSeparator):this.ui.list.focus(zz.Previous),this.canSelectMany&&this.ui.list.domFocus(),Zc(t,!0);break;case 12:this.ui.list.focus(zz.NextPage),this.canSelectMany&&this.ui.list.domFocus(),Zc(t,!0);break;case 11:this.ui.list.focus(zz.PreviousPage),this.canSelectMany&&this.ui.list.domFocus(),Zc(t,!0);break;case 17:if(!this._canAcceptInBackground||!this.ui.inputBox.isSelectionAtEnd())return;this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!0));break;case 14:!t.ctrlKey&&!t.metaKey||t.shiftKey||t.altKey||(this.ui.list.focus(zz.First),Zc(t,!0));break;case 13:!t.ctrlKey&&!t.metaKey||t.shiftKey||t.altKey||(this.ui.list.focus(zz.Last),Zc(t,!0))}}))),this.visibleDisposables.add(this.ui.onDidAccept((()=>{this.canSelectMany?this.ui.list.getCheckedElements().length||(this._selectedItems=[],this.onDidChangeSelectionEmitter.fire(this.selectedItems)):this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems)),this.handleAccept(!1)}))),this.visibleDisposables.add(this.ui.onDidCustom((()=>{this.onDidCustomEmitter.fire()}))),this.visibleDisposables.add(this.ui.list.onDidChangeFocus((t=>{this.activeItemsUpdated||this.activeItemsToConfirm!==this._activeItems&&n(t,this._activeItems,((t,i)=>t===i))||(this._activeItems=t,this.onDidChangeActiveEmitter.fire(t))}))),this.visibleDisposables.add(this.ui.list.onDidChangeSelection((({items:t,event:i})=>{this.canSelectMany?t.length&&this.ui.list.setSelectedElements([]):this.selectedItemsToConfirm!==this._selectedItems&&n(t,this._selectedItems,((t,i)=>t===i))||(this._selectedItems=t,this.onDidChangeSelectionEmitter.fire(t),t.length&&this.handleAccept(Uc(i)&&i.button===1))}))),this.visibleDisposables.add(this.ui.list.onChangedCheckedElements((t=>{this.canSelectMany&&(this.selectedItemsToConfirm!==this._selectedItems&&n(t,this._selectedItems,((t,i)=>t===i))||(this._selectedItems=t,this.onDidChangeSelectionEmitter.fire(t)))}))),this.visibleDisposables.add(this.ui.list.onButtonTriggered((t=>this.onDidTriggerItemButtonEmitter.fire(t)))),this.visibleDisposables.add(this.ui.list.onSeparatorButtonTriggered((t=>this.onDidTriggerSeparatorButtonEmitter.fire(t)))),this.visibleDisposables.add(this.registerQuickNavigation()),this.valueSelectionUpdated=!0),super.show()}handleAccept(t){let i=!1;this.onWillAcceptEmitter.fire({veto:()=>i=!0}),i||this.onDidAcceptEmitter.fire({inBackground:t})}registerQuickNavigation(){return sc(this.ui.container,qc.KEY_UP,(t=>{if(this.canSelectMany||!this._quickNavigate)return;const i=new so(t),e=i.keyCode;this._quickNavigate.keybindings.some((t=>{const s=t.getChords();return!(s.length>1)&&(s[0].shiftKey&&e===4?!(i.ctrlKey||i.altKey||i.metaKey):!(!s[0].altKey||e!==6)||!(!s[0].ctrlKey||e!==5)||!(!s[0].metaKey||e!==57))}))&&(this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!1)),this._quickNavigate=void 0)}))}update(){if(!this.visible)return;const t=this.keepScrollPosition?this.scrollTop:0,i=!!this.description,e={title:!!this.title||!!this.step||!!this.buttons.length,description:i,checkAll:this.canSelectMany&&!this._hideCheckAll,checkBox:this.canSelectMany,inputBox:!this._hideInput,progressBar:!this._hideInput||i,visibleCount:!0,count:this.canSelectMany&&!this._hideCountBadge,ok:this.ok==="default"?this.canSelectMany:this.ok,list:!0,message:!!this.validationMessage,customButton:this.customButton};this.ui.setVisibilities(e),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||"");let s=this.ariaLabel;if(!s&&e.inputBox&&(s=this.placeholder||oU.DEFAULT_ARIA_LABEL,this.title&&(s+=` - ${this.title}`)),this.ui.list.ariaLabel!==s&&(this.ui.list.ariaLabel=s??null),this.ui.list.matchOnDescription=this.matchOnDescription,this.ui.list.matchOnDetail=this.matchOnDetail,this.ui.list.matchOnLabel=this.matchOnLabel,this.ui.list.matchOnLabelMode=this.matchOnLabelMode,this.ui.list.sortByLabel=this.sortByLabel,this.itemsUpdated){this.itemsUpdated=!1;const t=this._activeItems;switch(this.ui.list.setElements(this.items),this.ui.list.filter(this.filterValue(this.ui.inputBox.value)),this.ui.checkAll.checked=this.ui.list.getAllVisibleChecked(),this.ui.visibleCount.setCount(this.ui.list.getVisibleCount()),this.ui.count.setCount(this.ui.list.getCheckedCount()),this._itemActivation){case wj.NONE:t.length>0&&(this._activeItems=[],this.onDidChangeActiveEmitter.fire(this._activeItems)),this._itemActivation=wj.FIRST;break;case wj.SECOND:this.ui.list.focus(zz.Second),this._itemActivation=wj.FIRST;break;case wj.LAST:this.ui.list.focus(zz.Last),this._itemActivation=wj.FIRST;break;default:this.trySelectFirst()}}this.ui.container.classList.contains("show-checkboxes")!==!!this.canSelectMany&&(this.canSelectMany?this.ui.list.clearFocus():this.trySelectFirst()),this.activeItemsUpdated&&(this.activeItemsUpdated=!1,this.activeItemsToConfirm=this._activeItems,this.ui.list.setFocusedElements(this.activeItems),this.activeItemsToConfirm===this._activeItems&&(this.activeItemsToConfirm=null)),this.selectedItemsUpdated&&(this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=this._selectedItems,this.canSelectMany?this.ui.list.setCheckedElements(this.selectedItems):this.ui.list.setSelectedElements(this.selectedItems),this.selectedItemsToConfirm===this._selectedItems&&(this.selectedItemsToConfirm=null)),this.ui.customButton.label=this.customLabel||"",this.ui.customButton.element.title=this.customHover||"",e.inputBox||(this.ui.list.domFocus(),this.canSelectMany&&this.ui.list.focus(zz.First)),this.keepScrollPosition&&(this.scrollTop=t)}}oU.DEFAULT_ARIA_LABEL=tt(0,"Type to narrow down results.");class hU extends rU{constructor(){super(...arguments),this._value="",this.valueSelectionUpdated=!0,this._password=!1,this.onDidValueChangeEmitter=this._register(new le),this.onDidAcceptEmitter=this._register(new le),this.onDidChangeValue=this.onDidValueChangeEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event}get value(){return this._value}set value(t){this._value=t||"",this.update()}get placeholder(){return this._placeholder}set placeholder(t){this._placeholder=t,this.update()}get password(){return this._password}set password(t){this._password=t,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange((t=>{t!==this.value&&(this._value=t,this.onDidValueChangeEmitter.fire(t))}))),this.visibleDisposables.add(this.ui.onDidAccept((()=>this.onDidAcceptEmitter.fire()))),this.valueSelectionUpdated=!0),super.show()}update(){if(!this.visible)return;this.ui.container.classList.remove("hidden-input");const t={title:!!this.title||!!this.step||!!this.buttons.length,description:!!this.description||!!this.step,inputBox:!0,message:!0,progressBar:!0};this.ui.setVisibilities(t),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||""),this.ui.inputBox.password!==this.password&&(this.ui.inputBox.password=this.password)}}let cU=class extends nI{constructor(t,i){super("element",!1,(t=>this.getOverrideOptions(t)),t,i)}getOverrideOptions(t){var i;return{persistence:{hideOnKeyDown:!1},appearance:{showHoverHint:(t.content instanceof HTMLElement?(i=t.content.textContent)!==null&&i!==void 0?i:"":typeof t.content=="string"?t.content:t.content.value).includes(`\n`),skipFadeInAnimation:!0}}}};cU=eU([sU(0,Md),sU(1,sI)],cU),kp.white.toString(),kp.white.toString();class lU extends Qi{get onDidClick(){return this._onDidClick.event}constructor(t,i){super(),this._label="",this._onDidClick=this._register(new le),this._onDidEscape=this._register(new le),this.options=i,this._element=document.createElement("a"),this._element.classList.add("monaco-button"),this._element.tabIndex=0,this._element.setAttribute("role","button"),this._element.classList.toggle("secondary",!!i.secondary);const e=i.secondary?i.buttonSecondaryBackground:i.buttonBackground,s=i.secondary?i.buttonSecondaryForeground:i.buttonForeground;this._element.style.color=s||"",this._element.style.backgroundColor=e||"",i.supportShortLabel&&(this._labelShortElement=document.createElement("div"),this._labelShortElement.classList.add("monaco-button-label-short"),this._element.appendChild(this._labelShortElement),this._labelElement=document.createElement("div"),this._labelElement.classList.add("monaco-button-label"),this._element.appendChild(this._labelElement),this._element.classList.add("monaco-text-button-with-short-label")),typeof i.title=="string"&&this.setTitle(i.title),typeof i.ariaLabel=="string"&&this._element.setAttribute("aria-label",i.ariaLabel),t.appendChild(this._element),this._register(Wk.addTarget(this._element)),[qc.CLICK,Bk.Tap].forEach((t=>{this._register(sc(this._element,t,(t=>{this.enabled?this._onDidClick.fire(t):Zc(t)})))})),this._register(sc(this._element,qc.KEY_DOWN,(t=>{const i=new so(t);let e=!1;this.enabled&&(i.equals(3)||i.equals(10))?(this._onDidClick.fire(t),e=!0):i.equals(9)&&(this._onDidEscape.fire(t),this._element.blur(),e=!0),e&&Zc(i,!0)}))),this._register(sc(this._element,qc.MOUSE_OVER,(t=>{this._element.classList.contains("disabled")||this.updateBackground(!0)}))),this._register(sc(this._element,qc.MOUSE_OUT,(t=>{this.updateBackground(!1)}))),this.focusTracker=this._register(Qc(this._element)),this._register(this.focusTracker.onDidFocus((()=>{this.enabled&&this.updateBackground(!0)}))),this._register(this.focusTracker.onDidBlur((()=>{this.enabled&&this.updateBackground(!1)})))}dispose(){super.dispose(),this._element.remove()}getContentElements(t){const i=[];for(let e of bI(t))if(typeof e=="string"){if(e=e.trim(),e==="")continue;const t=document.createElement("span");t.textContent=e,i.push(t)}else i.push(e);return i}updateBackground(t){let i;i=this.options.secondary?t?this.options.buttonSecondaryHoverBackground:this.options.buttonSecondaryBackground:t?this.options.buttonHoverBackground:this.options.buttonBackground,i&&(this._element.style.backgroundColor=i)}get element(){return this._element}set label(t){var i,e,s;if(this._label===t||R_(this._label)&&R_(t)&&((e=this._label)===(s=t)||e&&s&&e.value===s.value&&e.isTrusted===s.isTrusted&&e.supportThemeIcons===s.supportThemeIcons&&e.supportHtml===s.supportHtml&&(e.baseUri===s.baseUri||e.baseUri&&s.baseUri&&kM(as.from(e.baseUri),as.from(s.baseUri)))))return;this._element.classList.add("monaco-text-button");const n=this.options.supportShortLabel?this._labelElement:this._element;if(R_(t)){const e=V_(t,{inline:!0});e.dispose();const s=(i=e.element.querySelector("p"))===null||i===void 0?void 0:i.innerHTML;if(s){const t=Eh(s,{ADD_TAGS:["b","i","u","code","span"],ALLOWED_ATTR:["class"],RETURN_TRUSTED_TYPE:!0});n.innerHTML=t}else tl(n)}else this.options.supportIcons?tl(n,...this.getContentElements(t)):n.textContent=t;let r="";typeof this.options.title=="string"?r=this.options.title:this.options.title&&(r=G_(t)),this.setTitle(r),typeof this.options.ariaLabel=="string"?this._element.setAttribute("aria-label",this.options.ariaLabel):this.options.ariaLabel&&this._element.setAttribute("aria-label",r),this._label=t}get label(){return this._label}set icon(t){this._element.classList.add(...Kl.asClassNameArray(t))}set enabled(t){t?(this._element.classList.remove("disabled"),this._element.setAttribute("aria-disabled",String(!1)),this._element.tabIndex=0):(this._element.classList.add("disabled"),this._element.setAttribute("aria-disabled",String(!0)))}get enabled(){return!this._element.classList.contains("disabled")}setTitle(t){var i;this._hover||t===""?this._hover&&this._hover.update(t):this._hover=this._register(lB((i=this.options.hoverDelegate)!==null&&i!==void 0?i:rB("mouse"),this._element,t))}}class aU{constructor(t,i,e){this.options=i,this.styles=e,this.count=0,this.element=Yc(t,nl(".monaco-count-badge")),this.countFormat=this.options.countFormat||"{0}",this.titleFormat=this.options.titleFormat||"",this.setCount(this.options.count||0)}setCount(t){this.count=t,this.render()}setTitleFormat(t){this.titleFormat=t,this.render()}render(){var t,i;this.element.textContent=Kn(this.countFormat,this.count),this.element.title=Kn(this.titleFormat,this.count),this.element.style.backgroundColor=(t=this.styles.badgeBackground)!==null&&t!==void 0?t:"",this.element.style.color=(i=this.styles.badgeForeground)!==null&&i!==void 0?i:"",this.styles.badgeBorder&&(this.element.style.border=`1px solid ${this.styles.badgeBorder}`)}}const uU="done",dU="active",fU="infinite",gU="infinite-long-running",pU="discrete";class mU extends Qi{constructor(t,i){super(),this.workedVal=0,this.showDelayedScheduler=this._register(new Co((()=>rl(this.element)),0)),this.longRunningScheduler=this._register(new Co((()=>this.infiniteLongRunning()),mU.LONG_RUNNING_INFINITE_THRESHOLD)),this.create(t,i)}create(t,i){this.element=document.createElement("div"),this.element.classList.add("monaco-progress-container"),this.element.setAttribute("role","progressbar"),this.element.setAttribute("aria-valuemin","0"),t.appendChild(this.element),this.bit=document.createElement("div"),this.bit.classList.add("progress-bit"),this.bit.style.backgroundColor=(i==null?void 0:i.progressBarBackground)||"#0E70C0",this.element.appendChild(this.bit)}off(){this.bit.style.width="inherit",this.bit.style.opacity="1",this.element.classList.remove(dU,fU,gU,pU),this.workedVal=0,this.totalWork=void 0,this.longRunningScheduler.cancel()}stop(){return this.doDone(!1)}doDone(t){return this.element.classList.add(uU),this.element.classList.contains(fU)?(this.bit.style.opacity="0",t?setTimeout((()=>this.off()),200):this.off()):(this.bit.style.width="inherit",t?setTimeout((()=>this.off()),200):this.off()),this}infinite(){return this.bit.style.width="2%",this.bit.style.opacity="1",this.element.classList.remove(pU,uU,gU),this.element.classList.add(dU,fU),this.longRunningScheduler.schedule(),this}infiniteLongRunning(){this.element.classList.add(gU)}getContainer(){return this.element}}mU.LONG_RUNNING_INFINITE_THRESHOLD=1e4;const wU=nl;class vU extends Qi{constructor(t,i,e){super(),this.parent=t,this.onKeyDown=t=>rc(this.findInput.inputBox.inputElement,qc.KEY_DOWN,t),this.onDidChange=t=>this.findInput.onDidChange(t),this.container=Yc(this.parent,wU(".quick-input-box")),this.findInput=this._register(new aH(this.container,void 0,{label:"",inputBoxStyles:i,toggleStyles:e}));const s=this.findInput.inputBox.inputElement;s.role="combobox",s.ariaHasPopup="menu",s.ariaAutoComplete="list",s.ariaExpanded="true"}get value(){return this.findInput.getValue()}set value(t){this.findInput.setValue(t)}select(t=null){this.findInput.inputBox.select(t)}getSelection(){return this.findInput.inputBox.getSelection()}isSelectionAtEnd(){return this.findInput.inputBox.isSelectionAtEnd()}get placeholder(){return this.findInput.inputBox.inputElement.getAttribute("placeholder")||""}set placeholder(t){this.findInput.inputBox.setPlaceHolder(t)}get password(){return this.findInput.inputBox.inputElement.type==="password"}set password(t){this.findInput.inputBox.inputElement.type=t?"password":"text"}set enabled(t){this.findInput.inputBox.inputElement.toggleAttribute("readonly",!t)}set toggles(t){this.findInput.setAdditionalToggles(t)}setAttribute(t,i){this.findInput.inputBox.inputElement.setAttribute(t,i)}showDecoration(t){t===dR.Ignore?this.findInput.clearMessage():this.findInput.showMessage({type:t===dR.Info?1:t===dR.Warning?2:3,content:""})}stylesForType(t){return this.findInput.inputBox.stylesForType(t===dR.Info?1:t===dR.Warning?2:3)}setFocus(){this.findInput.focus()}layout(){this.findInput.inputBox.layout()}}var bU,yU=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},kU=function(t,i){return function(e,s){i(e,s,t)}};const CU=nl;let SU=bU=class extends Qi{get container(){return this._container}constructor(t,i,e){super(),this.options=t,this.layoutService=i,this.instantiationService=e,this.enabled=!0,this.onDidAcceptEmitter=this._register(new le),this.onDidCustomEmitter=this._register(new le),this.onDidTriggerButtonEmitter=this._register(new le),this.keyMods={ctrlCmd:!1,alt:!1},this.controller=null,this.onShowEmitter=this._register(new le),this.onShow=this.onShowEmitter.event,this.onHideEmitter=this._register(new le),this.onHide=this.onHideEmitter.event,this.idPrefix=t.idPrefix,this._container=t.container,this.styles=t.styles,this._register(ne.runAndSubscribe(Yh,(({window:t,disposables:i})=>this.registerKeyModsListeners(t,i)),{window:Wn,disposables:this._store})),this._register(Xh((t=>{this.ui&&Uh(this.ui.container)===t&&(this.reparentUI(this.layoutService.mainContainer),this.layout(this.layoutService.mainContainerDimension,this.layoutService.mainContainerOffset.quickPickTop))})))}registerKeyModsListeners(t,i){const e=t=>{this.keyMods.ctrlCmd=t.ctrlKey||t.metaKey,this.keyMods.alt=t.altKey};for(const s of[qc.KEY_DOWN,qc.KEY_UP,qc.MOUSE_DOWN])i.add(sc(t,s,e,!0))}getUI(t){if(this.ui)return t&&Uh(this._container)!==Uh(this.layoutService.activeContainer)&&(this.reparentUI(this.layoutService.activeContainer),this.layout(this.layoutService.activeContainerDimension,this.layoutService.activeContainerOffset.quickPickTop)),this.ui;const i=Yc(this._container,CU(".quick-input-widget.show-file-icons"));i.tabIndex=-1,i.style.display="none";const e=Pc(i),s=Yc(i,CU(".quick-input-titlebar")),n=this._register(new LW(s,{hoverDelegate:this.options.hoverDelegate}));n.domNode.classList.add("quick-input-left-action-bar");const r=Yc(s,CU(".quick-input-title")),o=this._register(new LW(s,{hoverDelegate:this.options.hoverDelegate}));o.domNode.classList.add("quick-input-right-action-bar");const h=Yc(i,CU(".quick-input-header")),c=Yc(h,CU("input.quick-input-check-all"));c.type="checkbox",c.setAttribute("aria-label",tt(0,"Toggle all checkboxes")),this._register(rc(c,qc.CHANGE,(t=>{const i=c.checked;E.setAllVisibleChecked(i)}))),this._register(sc(c,qc.CLICK,(t=>{(t.x||t.y)&&d.setFocus()})));const l=Yc(h,CU(".quick-input-description")),a=Yc(h,CU(".quick-input-and-message")),u=Yc(a,CU(".quick-input-filter")),d=this._register(new vU(u,this.styles.inputBox,this.styles.toggle));d.setAttribute("aria-describedby",`${this.idPrefix}message`);const f=Yc(u,CU(".quick-input-visible-count"));f.setAttribute("aria-live","polite"),f.setAttribute("aria-atomic","true");const g=new aU(f,{countFormat:tt(0,"{0} Results")},this.styles.countBadge),p=Yc(u,CU(".quick-input-count"));p.setAttribute("aria-live","polite");const m=new aU(p,{countFormat:tt(0,"{0} Selected")},this.styles.countBadge),w=Yc(h,CU(".quick-input-action")),v=this._register(new lU(w,this.styles.button));v.label=tt(0,"OK"),this._register(v.onDidClick((t=>{this.onDidAcceptEmitter.fire()})));const b=Yc(h,CU(".quick-input-action")),y=this._register(new lU(b,{...this.styles.button,supportIcons:!0}));y.label=tt(0,"Custom"),this._register(y.onDidClick((t=>{this.onDidCustomEmitter.fire()})));const k=Yc(a,CU(`#${this.idPrefix}message.quick-input-message`)),C=this._register(new mU(i,this.styles.progressBar));C.getContainer().classList.add("quick-input-progress");const S=Yc(i,CU(".quick-input-html-widget"));S.tabIndex=-1;const x=Yc(i,CU(".quick-input-description")),D=this.idPrefix+"list",E=this._register(this.instantiationService.createInstance(tU,i,this.options.hoverDelegate,this.options.linkOpenerDelegate,D));d.setAttribute("aria-controls",D),this._register(E.onDidChangeFocus((()=>{var t;d.setAttribute("aria-activedescendant",(t=E.getActiveDescendant())!==null&&t!==void 0?t:"")}))),this._register(E.onChangedAllVisibleChecked((t=>{c.checked=t}))),this._register(E.onChangedVisibleCount((t=>{g.setCount(t)}))),this._register(E.onChangedCheckedCount((t=>{m.setCount(t)}))),this._register(E.onLeave((()=>{setTimeout((()=>{this.controller&&(d.setFocus(),this.controller instanceof oU&&this.controller.canSelectMany&&E.clearFocus())}),0)})));const A=Qc(i);return this._register(A),this._register(sc(i,qc.FOCUS,(t=>{xc(t.relatedTarget,i)||(this.previousFocusElement=t.relatedTarget instanceof HTMLElement?t.relatedTarget:void 0)}),!0)),this._register(A.onDidBlur((()=>{this.getUI().ignoreFocusOut||this.options.ignoreFocusOut()||this.hide(mj.Blur),this.previousFocusElement=void 0}))),this._register(sc(i,qc.FOCUS,(t=>{d.setFocus()}))),this._register(rc(i,qc.KEY_DOWN,(t=>{if(!xc(t.target,S))switch(t.keyCode){case 3:Zc(t,!0),this.enabled&&this.onDidAcceptEmitter.fire();break;case 9:Zc(t,!0),this.hide(mj.Gesture);break;case 2:if(!t.altKey&&!t.ctrlKey&&!t.metaKey){const e=[".quick-input-list .monaco-action-bar .always-visible",".quick-input-list-entry:hover .monaco-action-bar",".monaco-list-row.focused .monaco-action-bar"];if(i.classList.contains("show-checkboxes")?e.push("input"):e.push("input[type=text]"),this.getUI().list.isDisplayed()&&e.push(".monaco-list"),this.getUI().message&&e.push(".quick-input-message a"),this.getUI().widget){if(xc(t.target,this.getUI().widget))break;e.push(".quick-input-html-widget")}const s=i.querySelectorAll(e.join(", "));t.shiftKey&&t.target===s[0]?(Zc(t,!0),E.clearFocus()):!t.shiftKey&&xc(t.target,s[s.length-1])&&(Zc(t,!0),s[0].focus())}break;case 10:t.ctrlKey&&(Zc(t,!0),this.getUI().list.toggleHover())}}))),this.ui={container:i,styleSheet:e,leftActionBar:n,titleBar:s,title:r,description1:x,description2:l,widget:S,rightActionBar:o,checkAll:c,inputContainer:a,filterContainer:u,inputBox:d,visibleCountContainer:f,visibleCount:g,countContainer:p,count:m,okContainer:w,ok:v,message:k,customButtonContainer:b,customButton:y,list:E,progressBar:C,onDidAccept:this.onDidAcceptEmitter.event,onDidCustom:this.onDidCustomEmitter.event,onDidTriggerButton:this.onDidTriggerButtonEmitter.event,ignoreFocusOut:!1,keyMods:this.keyMods,show:t=>this.show(t),hide:()=>this.hide(),setVisibilities:t=>this.setVisibilities(t),setEnabled:t=>this.setEnabled(t),setContextKey:t=>this.options.setContextKey(t),linkOpenerDelegate:t=>this.options.linkOpenerDelegate(t)},this.updateStyles(),this.ui}reparentUI(t){this.ui&&(this._container=t,Yc(this._container,this.ui.container))}pick(t,i={},e=ve.None){return new Promise(((s,n)=>{let r=t=>{var e;r=s,(e=i.onKeyMods)===null||e===void 0||e.call(i,o.keyMods),s(t)};if(e.isCancellationRequested)return void r(void 0);const o=this.createQuickPick();let h;const c=[o,o.onDidAccept((()=>{if(o.canSelectMany)r(o.selectedItems.slice()),o.hide();else{const t=o.activeItems[0];t&&(r(t),o.hide())}})),o.onDidChangeActive((t=>{const e=t[0];e&&i.onDidFocus&&i.onDidFocus(e)})),o.onDidChangeSelection((t=>{if(!o.canSelectMany){const i=t[0];i&&(r(i),o.hide())}})),o.onDidTriggerItemButton((t=>i.onDidTriggerItemButton&&i.onDidTriggerItemButton({...t,removeItem:()=>{const i=o.items.indexOf(t.item);if(i!==-1){const t=o.items.slice(),e=t.splice(i,1),s=o.activeItems.filter((t=>t!==e[0])),n=o.keepScrollPosition;o.keepScrollPosition=!0,o.items=t,s&&(o.activeItems=s),o.keepScrollPosition=n}}}))),o.onDidTriggerSeparatorButton((t=>{var e;return(e=i.onDidTriggerSeparatorButton)===null||e===void 0?void 0:e.call(i,t)})),o.onDidChangeValue((t=>{!h||t||o.activeItems.length===1&&o.activeItems[0]===h||(o.activeItems=[h])})),e.onCancellationRequested((()=>{o.hide()})),o.onDidHide((()=>{qi(c),r(void 0)}))];o.title=i.title,o.canSelectMany=!!i.canPickMany,o.placeholder=i.placeHolder,o.ignoreFocusOut=!!i.ignoreFocusLost,o.matchOnDescription=!!i.matchOnDescription,o.matchOnDetail=!!i.matchOnDetail,o.matchOnLabel=i.matchOnLabel===void 0||i.matchOnLabel,o.quickNavigate=i.quickNavigate,o.hideInput=!!i.hideInput,o.contextKey=i.contextKey,o.busy=!0,Promise.all([t,i.activeItem]).then((([t,i])=>{h=i,o.busy=!1,o.items=t,o.canSelectMany&&(o.selectedItems=t.filter((t=>t.type!=="separator"&&t.picked))),h&&(o.activeItems=[h])})),o.show(),Promise.resolve(t).then(void 0,(t=>{n(t),o.hide()}))}))}createQuickPick(){const t=this.getUI(!0);return new oU(t)}createInputBox(){const t=this.getUI(!0);return new hU(t)}show(t){const i=this.getUI(!0);this.onShowEmitter.fire();const e=this.controller;this.controller=t,e==null||e.didHide(),this.setEnabled(!0),i.leftActionBar.clear(),i.title.textContent="",i.description1.textContent="",i.description2.textContent="",tl(i.widget),i.rightActionBar.clear(),i.checkAll.checked=!1,i.inputBox.placeholder="",i.inputBox.password=!1,i.inputBox.showDecoration(dR.Ignore),i.visibleCount.setCount(0),i.count.setCount(0),tl(i.message),i.progressBar.stop(),i.list.setElements([]),i.list.matchOnDescription=!1,i.list.matchOnDetail=!1,i.list.matchOnLabel=!0,i.list.sortByLabel=!0,i.ignoreFocusOut=!1,i.inputBox.toggles=void 0;const s=this.options.backKeybindingLabel();nU.tooltip=s?tt(0,"Back ({0})",s):tt(0,"Back"),i.container.style.display="",this.updateLayout(),i.inputBox.setFocus()}isVisible(){return!!this.ui&&this.ui.container.style.display!=="none"}setVisibilities(t){const i=this.getUI();i.title.style.display=t.title?"":"none",i.description1.style.display=t.description&&(t.inputBox||t.checkAll)?"":"none",i.description2.style.display=!t.description||t.inputBox||t.checkAll?"none":"",i.checkAll.style.display=t.checkAll?"":"none",i.inputContainer.style.display=t.inputBox?"":"none",i.filterContainer.style.display=t.inputBox?"":"none",i.visibleCountContainer.style.display=t.visibleCount?"":"none",i.countContainer.style.display=t.count?"":"none",i.okContainer.style.display=t.ok?"":"none",i.customButtonContainer.style.display=t.customButton?"":"none",i.message.style.display=t.message?"":"none",i.progressBar.getContainer().style.display=t.progressBar?"":"none",i.list.display(!!t.list),i.container.classList.toggle("show-checkboxes",!!t.checkBox),i.container.classList.toggle("hidden-input",!t.inputBox&&!t.description),this.updateLayout()}setEnabled(t){if(t!==this.enabled){this.enabled=t;for(const i of this.getUI().leftActionBar.viewItems)i.action.enabled=t;for(const i of this.getUI().rightActionBar.viewItems)i.action.enabled=t;this.getUI().checkAll.disabled=!t,this.getUI().inputBox.enabled=t,this.getUI().ok.enabled=t,this.getUI().list.enabled=t}}hide(t){var i,e;const s=this.controller;if(!s)return;s.willHide(t);const n=(i=this.ui)===null||i===void 0?void 0:i.container,r=n&&!Tc(n);if(this.controller=null,this.onHideEmitter.fire(),n&&(n.style.display="none"),!r){let t=this.previousFocusElement;for(;t&&!t.offsetParent;)t=(e=t.parentElement)!==null&&e!==void 0?e:void 0;t!=null&&t.offsetParent?(t.focus(),this.previousFocusElement=void 0):this.options.returnFocus()}s.didHide(t)}layout(t,i){this.dimension=t,this.titleBarOffset=i,this.updateLayout()}updateLayout(){if(this.ui&&this.isVisible()){this.ui.container.style.top=`${this.titleBarOffset}px`;const t=this.ui.container.style,i=Math.min(.62*this.dimension.width,bU.MAX_WIDTH);t.width=i+"px",t.marginLeft="-"+i/2+"px",this.ui.inputBox.layout(),this.ui.list.layout(this.dimension&&.4*this.dimension.height)}}applyStyles(t){this.styles=t,this.updateStyles()}updateStyles(){if(this.ui){const{quickInputTitleBackground:t,quickInputBackground:i,quickInputForeground:e,widgetBorder:s,widgetShadow:n}=this.styles.widget;this.ui.titleBar.style.backgroundColor=t??"",this.ui.container.style.backgroundColor=i??"",this.ui.container.style.color=e??"",this.ui.container.style.border=s?`1px solid ${s}`:"",this.ui.container.style.boxShadow=n?`0 0 8px 2px ${n}`:"",this.ui.list.style(this.styles.list);const r=[];this.styles.pickerGroup.pickerGroupBorder&&r.push(`.quick-input-list .quick-input-list-entry { border-top-color:  ${this.styles.pickerGroup.pickerGroupBorder}; }`),this.styles.pickerGroup.pickerGroupForeground&&r.push(`.quick-input-list .quick-input-list-separator { color:  ${this.styles.pickerGroup.pickerGroupForeground}; }`),this.styles.pickerGroup.pickerGroupForeground&&r.push(".quick-input-list .quick-input-list-separator-as-item { color: var(--vscode-descriptionForeground); }"),(this.styles.keybindingLabel.keybindingLabelBackground||this.styles.keybindingLabel.keybindingLabelBorder||this.styles.keybindingLabel.keybindingLabelBottomBorder||this.styles.keybindingLabel.keybindingLabelShadow||this.styles.keybindingLabel.keybindingLabelForeground)&&(r.push(".quick-input-list .monaco-keybinding > .monaco-keybinding-key {"),this.styles.keybindingLabel.keybindingLabelBackground&&r.push(`background-color: ${this.styles.keybindingLabel.keybindingLabelBackground};`),this.styles.keybindingLabel.keybindingLabelBorder&&r.push(`border-color: ${this.styles.keybindingLabel.keybindingLabelBorder};`),this.styles.keybindingLabel.keybindingLabelBottomBorder&&r.push(`border-bottom-color: ${this.styles.keybindingLabel.keybindingLabelBottomBorder};`),this.styles.keybindingLabel.keybindingLabelShadow&&r.push(`box-shadow: inset 0 -1px 0 ${this.styles.keybindingLabel.keybindingLabelShadow};`),this.styles.keybindingLabel.keybindingLabelForeground&&r.push(`color: ${this.styles.keybindingLabel.keybindingLabelForeground};`),r.push("}"));const o=r.join(`\n`);o!==this.ui.styleSheet.textContent&&(this.ui.styleSheet.textContent=o)}}};SU.MAX_WIDTH=600,SU=bU=yU([kU(1,BR),kU(2,Il)],SU);var xU=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},DU=function(t,i){return function(e,s){i(e,s,t)}};let EU=class extends OC{get controller(){return this._controller||(this._controller=this._register(this.createController())),this._controller}get hasController(){return!!this._controller}get quickAccess(){return this._quickAccess||(this._quickAccess=this._register(this.instantiationService.createInstance(kj))),this._quickAccess}constructor(t,i,e,s,n){super(e),this.instantiationService=t,this.contextKeyService=i,this.layoutService=s,this.configurationService=n,this._onShow=this._register(new le),this._onHide=this._register(new le),this.contexts=new Map}createController(t=this.layoutService,i){const e={idPrefix:"quickInput_",container:t.activeContainer,ignoreFocusOut:()=>!1,backKeybindingLabel:()=>{},setContextKey:t=>this.setContextKey(t),linkOpenerDelegate:t=>{this.instantiationService.invokeFunction((i=>{i.get(uI).open(t,{allowCommands:!0,fromUserGesture:!0})}))},returnFocus:()=>t.focus(),styles:this.computeStyles(),hoverDelegate:this._register(this.instantiationService.createInstance(cU))},s=this._register(this.instantiationService.createInstance(SU,{...e,...i}));return s.layout(t.activeContainerDimension,t.activeContainerOffset.quickPickTop),this._register(t.onDidLayoutActiveContainer((i=>{Uh(t.activeContainer)===Uh(s.container)&&s.layout(i,t.activeContainerOffset.quickPickTop)}))),this._register(t.onDidChangeActiveContainer((()=>{s.isVisible()||s.layout(t.activeContainerDimension,t.activeContainerOffset.quickPickTop)}))),this._register(s.onShow((()=>{this.resetContextKeys(),this._onShow.fire()}))),this._register(s.onHide((()=>{this.resetContextKeys(),this._onHide.fire()}))),s}setContextKey(t){let i;t&&(i=this.contexts.get(t),i||(i=new Ta(t,!1).bindTo(this.contextKeyService),this.contexts.set(t,i))),i&&i.get()||(this.resetContextKeys(),i==null||i.set(!0))}resetContextKeys(){this.contexts.forEach((t=>{t.get()&&t.reset()}))}pick(t,i={},e=ve.None){return this.controller.pick(t,i,e)}createQuickPick(){return this.controller.createQuickPick()}createInputBox(){return this.controller.createInputBox()}updateStyles(){this.hasController&&this.controller.applyStyles(this.computeStyles())}computeStyles(){return{widget:{quickInputBackground:Tw(Ly),quickInputForeground:Tw(Fy),quickInputTitleBackground:Tw(Ty),widgetBorder:Tw(Wv),widgetShadow:Tw($v)},inputBox:uW,toggle:aW,countBadge:fW,button:cW,progressBar:lW,keybindingLabel:hW,list:pW({listBackground:Ly,listFocusBackground:Ny,listFocusForeground:_y,listInactiveFocusForeground:_y,listInactiveSelectionIconForeground:Py,listInactiveFocusBackground:Ny,listFocusOutline:Gw,listInactiveFocusOutline:Gw}),pickerGroup:{pickerGroupBorder:Tw(Oy),pickerGroupForeground:Tw(Ry)}}}};EU=xU([DU(0,Il),DU(1,Ra),DU(2,AC),DU(3,BR),DU(4,Md)],EU);var AU=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},MU=function(t,i){return function(e,s){i(e,s,t)}};let LU=class extends EU{constructor(t,i,e,s,n,r){super(i,e,s,new HR(t.getContainerDomNode(),n),r),this.host=void 0;const o=TU.get(t);if(o){const i=o.widget;this.host={_serviceBrand:void 0,get mainContainer(){return i.getDomNode()},getContainer:()=>i.getDomNode(),whenContainerStylesLoaded(){},get containers(){return[i.getDomNode()]},get activeContainer(){return i.getDomNode()},get mainContainerDimension(){return t.getLayoutInfo()},get activeContainerDimension(){return t.getLayoutInfo()},get onDidLayoutMainContainer(){return t.onDidLayoutChange},get onDidLayoutActiveContainer(){return t.onDidLayoutChange},get onDidLayoutContainer(){return ne.map(t.onDidLayoutChange,(t=>({container:i.getDomNode(),dimension:t})))},get onDidChangeActiveContainer(){return ne.None},get onDidAddContainer(){return ne.None},get mainContainerOffset(){return{top:0,quickPickTop:0}},get activeContainerOffset(){return{top:0,quickPickTop:0}},focus:()=>t.focus()}}else this.host=void 0}createController(){return super.createController(this.host)}};LU=AU([MU(1,Il),MU(2,Ra),MU(3,AC),MU(4,Pl),MU(5,Md)],LU);let FU=class{get activeService(){const t=this.codeEditorService.getFocusedCodeEditor();if(!t)throw new Error("Quick input service needs a focused editor to work.");let i=this.mapEditorToService.get(t);if(!i){const e=i=this.instantiationService.createInstance(LU,t);this.mapEditorToService.set(t,i),Ui(t.onDidDispose)((()=>{e.dispose(),this.mapEditorToService.delete(t)}))}return i}get quickAccess(){return this.activeService.quickAccess}constructor(t,i){this.instantiationService=t,this.codeEditorService=i,this.mapEditorToService=new Map}pick(t,i={},e=ve.None){return this.activeService.pick(t,i,e)}createQuickPick(){return this.activeService.createQuickPick()}createInputBox(){return this.activeService.createInputBox()}};FU=AU([MU(0,Il),MU(1,Pl)],FU);class TU{static get(t){return t.getContribution(TU.ID)}constructor(t){this.editor=t,this.widget=new RU(this.editor)}dispose(){this.widget.dispose()}}TU.ID="editor.controller.quickInput";class RU{constructor(t){this.codeEditor=t,this.domNode=document.createElement("div"),this.codeEditor.addOverlayWidget(this)}getId(){return RU.ID}getDomNode(){return this.domNode}getPosition(){return{preference:2}}dispose(){this.codeEditor.removeOverlayWidget(this)}}RU.ID="editor.contrib.quickInputWidget",Su(TU.ID,TU,4);class OU{constructor(t,i,e,s,n){this._parsedThemeRuleBrand=void 0,this.token=t,this.index=i,this.fontStyle=e,this.foreground=s,this.background=n}}const IU=/^#?([0-9A-Fa-f]{6})([0-9A-Fa-f]{2})?$/;class _U{constructor(){this._lastColorId=0,this._id2color=[],this._color2id=new Map}getId(t){if(t===null)return 0;const i=t.match(IU);if(!i)throw new Error("Illegal value for token color: "+t);t=i[1].toUpperCase();let e=this._color2id.get(t);return e||(e=++this._lastColorId,this._color2id.set(t,e),this._id2color[e]=kp.fromHex("#"+t),e)}getColorMap(){return this._id2color.slice(0)}}class PU{static createFromRawTokenTheme(t,i){return this.createFromParsedTokenTheme(function(t){if(!t||!Array.isArray(t))return[];const i=[];let e=0;for(let s=0,n=t.length;s<n;s++){const n=t[s];let r=-1;if(typeof n.fontStyle=="string"){r=0;const t=n.fontStyle.split(" ");for(let i=0,e=t.length;i<e;i++)switch(t[i]){case"italic":r|=1;break;case"bold":r|=2;break;case"underline":r|=4;break;case"strikethrough":r|=8}}let o=null;typeof n.foreground=="string"&&(o=n.foreground);let h=null;typeof n.background=="string"&&(h=n.background),i[e++]=new OU(n.token||"",s,r,o,h)}return i}(t),i)}static createFromParsedTokenTheme(t,i){return function(t,i){t.sort(((t,i)=>{const e=function(t,i){return t<i?-1:t>i?1:0}(t.token,i.token);return e!==0?e:t.index-i.index}));let e=0,s="000000",n="ffffff";for(;t.length>=1&&t[0].token==="";){const i=t.shift();i.fontStyle!==-1&&(e=i.fontStyle),i.foreground!==null&&(s=i.foreground),i.background!==null&&(n=i.background)}const r=new _U;for(const t of i)r.getId(t);const o=r.getId(s),h=r.getId(n),c=new BU(e,o,h),l=new $U(c);for(let i=0,e=t.length;i<e;i++){const e=t[i];l.insert(e.token,e.fontStyle,r.getId(e.foreground),r.getId(e.background))}return new PU(r,l)}(t,i)}constructor(t,i){this._colorMap=t,this._root=i,this._cache=new Map}getColorMap(){return this._colorMap.getColorMap()}_match(t){return this._root.match(t)}match(t,i){let e=this._cache.get(i);if(e===void 0){const t=this._match(i),s=function(t){const i=t.match(NU);if(!i)return 0;switch(i[1]){case"comment":return 1;case"string":return 2;case"regex":case"regexp":return 3}throw new Error("Unexpected match for standard token type!")}(i);e=(t.metadata|s<<8)>>>0,this._cache.set(i,e)}return(e|t)>>>0}}const NU=/\b(comment|string|regex|regexp)\b/;class BU{constructor(t,i,e){this._themeTrieElementRuleBrand=void 0,this._fontStyle=t,this._foreground=i,this._background=e,this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}clone(){return new BU(this._fontStyle,this._foreground,this._background)}acceptOverwrite(t,i,e){t!==-1&&(this._fontStyle=t),i!==0&&(this._foreground=i),e!==0&&(this._background=e),this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}}class $U{constructor(t){this._themeTrieElementBrand=void 0,this._mainRule=t,this._children=new Map}match(t){if(t==="")return this._mainRule;const i=t.indexOf(".");let e,s;i===-1?(e=t,s=""):(e=t.substring(0,i),s=t.substring(i+1));const n=this._children.get(e);return n!==void 0?n.match(s):this._mainRule}insert(t,i,e,s){if(t==="")return void this._mainRule.acceptOverwrite(i,e,s);const n=t.indexOf(".");let r,o;n===-1?(r=t,o=""):(r=t.substring(0,n),o=t.substring(n+1));let h=this._children.get(r);h===void 0&&(h=new $U(this._mainRule.clone()),this._children.set(r,h)),h.insert(o,i,e,s)}}const WU={base:"vs",inherit:!1,rules:[{token:"",foreground:"000000",background:"fffffe"},{token:"invalid",foreground:"cd3131"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"001188"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"delimiter.xml",foreground:"0000FF"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"FF0000"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"FF0000"},{token:"attribute.value",foreground:"0451A5"},{token:"attribute.value.number",foreground:"098658"},{token:"attribute.value.unit",foreground:"098658"},{token:"attribute.value.html",foreground:"0000FF"},{token:"attribute.value.xml",foreground:"0000FF"},{token:"string",foreground:"A31515"},{token:"string.html",foreground:"0000FF"},{token:"string.sql",foreground:"FF0000"},{token:"string.yaml",foreground:"0451A5"},{token:"keyword",foreground:"0000FF"},{token:"keyword.json",foreground:"0451A5"},{token:"keyword.flow",foreground:"AF00DB"},{token:"keyword.flow.scss",foreground:"0000FF"},{token:"operator.scss",foreground:"666666"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[sv]:"#FFFFFE",[nv]:"#000000",[bv]:"#E5EBF1",[KC]:"#D3D3D3",[YC]:"#939393",[yv]:"#ADD6FF4D"}},jU={base:"vs-dark",inherit:!1,rules:[{token:"",foreground:"D4D4D4",background:"1E1E1E"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"74B0DF"},{token:"variable.predefined",foreground:"4864AA"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"B5CEA8"},{token:"number.hex",foreground:"5BB498"},{token:"regexp",foreground:"B46695"},{token:"annotation",foreground:"cc6666"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"DCDCDC"},{token:"delimiter.html",foreground:"808080"},{token:"delimiter.xml",foreground:"808080"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"A79873"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"DD6A6F"},{token:"metatag.content.html",foreground:"9CDCFE"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key.json",foreground:"9CDCFE"},{token:"string.value.json",foreground:"CE9178"},{token:"attribute.name",foreground:"9CDCFE"},{token:"attribute.value",foreground:"CE9178"},{token:"attribute.value.number.css",foreground:"B5CEA8"},{token:"attribute.value.unit.css",foreground:"B5CEA8"},{token:"attribute.value.hex.css",foreground:"D4D4D4"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"keyword.json",foreground:"CE9178"},{token:"keyword.flow.scss",foreground:"569CD6"},{token:"operator.scss",foreground:"909090"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[sv]:"#1E1E1E",[nv]:"#D4D4D4",[bv]:"#3A3D41",[KC]:"#404040",[YC]:"#707070",[yv]:"#ADD6FF26"}},HU={base:"hc-black",inherit:!1,rules:[{token:"",foreground:"FFFFFF",background:"000000"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"1AEBFF"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"FFFFFF"},{token:"regexp",foreground:"C0C0C0"},{token:"annotation",foreground:"569CD6"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"FFFF00"},{token:"delimiter.html",foreground:"FFFF00"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta",foreground:"D4D4D4"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"569CD6"},{token:"metatag.content.html",foreground:"1AEBFF"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key",foreground:"9CDCFE"},{token:"string.value",foreground:"CE9178"},{token:"attribute.name",foreground:"569CD6"},{token:"attribute.value",foreground:"3FF23F"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[sv]:"#000000",[nv]:"#FFFFFF",[KC]:"#FFFFFF",[YC]:"#FFFFFF"}},VU={base:"hc-light",inherit:!1,rules:[{token:"",foreground:"292929",background:"FFFFFF"},{token:"invalid",foreground:"B5200D"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"264F70"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"B5200D"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"264F78"},{token:"attribute.value",foreground:"0451A5"},{token:"string",foreground:"A31515"},{token:"string.sql",foreground:"B5200D"},{token:"keyword",foreground:"0000FF"},{token:"keyword.flow",foreground:"AF00DB"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[sv]:"#FFFFFF",[nv]:"#292929",[KC]:"#292929",[YC]:"#292929"}};var zU,UU;(function(t){t.getDefinition=function(t,i){let e=t.defaults;for(;Kl.isThemeIcon(e);){const t=KU.getIcon(e.id);if(!t)return;e=t.defaults}return e}})(zU||(zU={})),function(t){t.toJSONObject=function(t){return{weight:t.weight,style:t.style,src:t.src.map((t=>({format:t.format,location:t.location.toString()})))}},t.fromJSONObject=function(t){const i=t=>R(t)?t:void 0;if(t&&Array.isArray(t.src)&&t.src.every((t=>R(t.format)&&R(t.location))))return{weight:i(t.weight),style:i(t.style),src:t.src.map((t=>({format:t.format,location:as.parse(t.location)})))}}}(UU||(UU={}));const KU=new class{constructor(){this._onDidChange=new le,this.onDidChange=this._onDidChange.event,this.iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:tt(0,"The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:tt(0,"The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.iconReferenceSchema={type:"string",pattern:`^${Kl.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.iconsById={},this.iconFontsById={}}registerIcon(t,i,e,s){const n=this.iconsById[t];if(n){if(e&&!n.description){n.description=e,this.iconSchema.properties[t].markdownDescription=`${e} $(${t})`;const i=this.iconReferenceSchema.enum.indexOf(t);i!==-1&&(this.iconReferenceSchema.enumDescriptions[i]=e),this._onDidChange.fire()}return n}const r={id:t,description:e,defaults:i,deprecationMessage:s};this.iconsById[t]=r;const o={$ref:"#/definitions/icons"};return s&&(o.deprecationMessage=s),e&&(o.markdownDescription=`${e}: $(${t})`),this.iconSchema.properties[t]=o,this.iconReferenceSchema.enum.push(t),this.iconReferenceSchema.enumDescriptions.push(e||""),this._onDidChange.fire(),{id:t}}getIcons(){return Object.keys(this.iconsById).map((t=>this.iconsById[t]))}getIcon(t){return this.iconsById[t]}getIconSchema(){return this.iconSchema}toString(){const t=(t,i)=>t.id.localeCompare(i.id),i=t=>{for(;Kl.isThemeIcon(t.defaults);)t=this.iconsById[t.defaults.id];return`codicon codicon-${t?t.id:""}`},e=[];e.push("| preview     | identifier                        | default codicon ID                | description"),e.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const s=Object.keys(this.iconsById).map((t=>this.iconsById[t]));for(const n of s.filter((t=>!!t.description)).sort(t))e.push(`|<i class="${i(n)}"></i>|${n.id}|${Kl.isThemeIcon(n.defaults)?n.defaults.id:n.id}|${n.description||""}|`);e.push("| preview     | identifier                        "),e.push("| ----------- | --------------------------------- |");for(const n of s.filter((t=>!Kl.isThemeIcon(t.defaults))).sort(t))e.push(`|<i class="${i(n)}"></i>|${n.id}|`);return e.join(`\n`)}};function qU(t,i,e,s){return KU.registerIcon(t,i,e,s)}function GU(){return KU}Va.add("base.contributions.icons",KU),function(){const t=Es();for(const i in t){const e="\\"+t[i].toString(16);KU.registerIcon(i,{fontCharacter:e})}}();const ZU="vscode://schemas/icons",JU=Va.as(Wd);JU.registerSchema(ZU,KU.getIconSchema());const QU=new Co((()=>JU.notifySchemaChanged(ZU)),200);KU.onDidChange((()=>{QU.isScheduled()||QU.schedule()}));const YU=qU("widget-close",As.close,tt(0,"Icon for the close action in widgets."));qU("goto-previous-location",As.arrowUp,tt(0,"Icon for goto previous editor location.")),qU("goto-next-location",As.arrowDown,tt(0,"Icon for goto next editor location.")),Kl.modify(As.sync,"spin"),Kl.modify(As.loading,"spin");class XU{getIcon(t){const i=GU();let e=t.defaults;for(;Kl.isThemeIcon(e);){const t=i.getIcon(e.id);if(!t)return;e=t.defaults}return e}}const tK="vs",iK="vs-dark",eK="hc-black",sK="hc-light",nK=Va.as(Rw),rK=Va.as(FC);class oK{constructor(t,i){this.semanticHighlighting=!1,this.themeData=i;const e=i.base;t.length>0?(hK(t)?this.id=t:this.id=e+" "+t,this.themeName=t):(this.id=e,this.themeName=e),this.colors=null,this.defaultColors=Object.create(null),this._tokenTheme=null}get base(){return this.themeData.base}notifyBaseUpdated(){this.themeData.inherit&&(this.colors=null,this._tokenTheme=null)}getColors(){if(!this.colors){const t=new Map;for(const i in this.themeData.colors)t.set(i,kp.fromHex(this.themeData.colors[i]));if(this.themeData.inherit){const i=cK(this.themeData.base);for(const e in i.colors)t.has(e)||t.set(e,kp.fromHex(i.colors[e]))}this.colors=t}return this.colors}getColor(t,i){return this.getColors().get(t)||(i!==!1?this.getDefault(t):void 0)}getDefault(t){let i=this.defaultColors[t];return i||(i=nK.resolveDefaultColor(t,this),this.defaultColors[t]=i,i)}defines(t){return this.getColors().has(t)}get type(){switch(this.base){case tK:return ck.LIGHT;case eK:return ck.HIGH_CONTRAST_DARK;case sK:return ck.HIGH_CONTRAST_LIGHT;default:return ck.DARK}}get tokenTheme(){if(!this._tokenTheme){let t=[],i=[];if(this.themeData.inherit){const e=cK(this.themeData.base);t=e.rules,e.encodedTokensColors&&(i=e.encodedTokensColors)}const e=this.themeData.colors["editor.foreground"],s=this.themeData.colors["editor.background"];if(e||s){const i={token:""};e&&(i.foreground=e),s&&(i.background=s),t.push(i)}t=t.concat(this.themeData.rules),this.themeData.encodedTokensColors&&(i=this.themeData.encodedTokensColors),this._tokenTheme=PU.createFromRawTokenTheme(t,i)}return this._tokenTheme}getTokenStyleMetadata(t,i,e){const s=this.tokenTheme._match([t].concat(i).join(".")).metadata,n=em.getForeground(s),r=em.getFontStyle(s);return{foreground:n,italic:!!(1&r),bold:!!(2&r),underline:!!(4&r),strikethrough:!!(8&r)}}}function hK(t){return t===tK||t===iK||t===eK||t===sK}function cK(t){switch(t){case tK:return WU;case iK:return jU;case eK:return HU;case sK:return VU}}function lK(t){const i=cK(t);return new oK(t,i)}const aK=_l("themeService");var uK=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},dK=function(t,i){return function(e,s){i(e,s,t)}};let fK=class extends Qi{constructor(t,i,e){super(),this._contextKeyService=t,this._layoutService=i,this._configurationService=e,this._accessibilitySupport=0,this._onDidChangeScreenReaderOptimized=new le,this._onDidChangeReducedMotion=new le,this._accessibilityModeEnabledContext=bw.bindTo(this._contextKeyService);const s=()=>this._accessibilityModeEnabledContext.set(this.isScreenReaderOptimized());this._register(this._configurationService.onDidChangeConfiguration((t=>{t.affectsConfiguration("editor.accessibilitySupport")&&(s(),this._onDidChangeScreenReaderOptimized.fire()),t.affectsConfiguration("workbench.reduceMotion")&&(this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this._onDidChangeReducedMotion.fire())}))),s(),this._register(this.onDidChangeScreenReaderOptimized((()=>s())));const n=Wn.matchMedia("(prefers-reduced-motion: reduce)");this._systemMotionReduced=n.matches,this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this.initReducedMotionListeners(n)}initReducedMotionListeners(t){this._register(sc(t,"change",(()=>{this._systemMotionReduced=t.matches,this._configMotionReduced==="auto"&&this._onDidChangeReducedMotion.fire()})));const i=()=>{const t=this.isMotionReduced();this._layoutService.mainContainer.classList.toggle("reduce-motion",t),this._layoutService.mainContainer.classList.toggle("enable-motion",!t)};i(),this._register(this.onDidChangeReducedMotion((()=>i())))}get onDidChangeScreenReaderOptimized(){return this._onDidChangeScreenReaderOptimized.event}isScreenReaderOptimized(){const t=this._configurationService.getValue("editor.accessibilitySupport");return t==="on"||t==="auto"&&this._accessibilitySupport===2}get onDidChangeReducedMotion(){return this._onDidChangeReducedMotion.event}isMotionReduced(){const t=this._configMotionReduced;return t==="on"||t==="auto"&&this._systemMotionReduced}getAccessibilitySupport(){return this._accessibilitySupport}};fK=uK([dK(0,Ra),dK(1,BR),dK(2,Md)],fK);var gK,pK,mK=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},wK=function(t,i){return function(e,s){i(e,s,t)}};let vK=class{constructor(t,i){this._commandService=t,this._hiddenStates=new bK(i)}createMenu(t,i,e){return new kK(t,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...e},this._commandService,i)}resetHiddenStates(t){this._hiddenStates.reset(t)}};vK=mK([wK(0,ql),wK(1,nW)],vK);let bK=gK=class{constructor(t){this._storageService=t,this._disposables=new Ji,this._onDidChange=new le,this.onDidChange=this._onDidChange.event,this._ignoreChangeEvent=!1,this._hiddenByDefaultCache=new Map;try{const i=t.get(gK._key,0,"{}");this._data=JSON.parse(i)}catch{this._data=Object.create(null)}this._disposables.add(t.onDidChangeValue(0,gK._key,this._disposables)((()=>{if(!this._ignoreChangeEvent)try{const i=t.get(gK._key,0,"{}");this._data=JSON.parse(i)}catch(t){console.log("FAILED to read storage after UPDATE",t)}this._onDidChange.fire()})))}dispose(){this._onDidChange.dispose(),this._disposables.dispose()}_isHiddenByDefault(t,i){var e;return(e=this._hiddenByDefaultCache.get(`${t.id}/${i}`))!==null&&e!==void 0&&e}setDefaultState(t,i,e){this._hiddenByDefaultCache.set(`${t.id}/${i}`,e)}isHidden(t,i){var e,s;const n=this._isHiddenByDefault(t,i),r=(s=(e=this._data[t.id])===null||e===void 0?void 0:e.includes(i))!==null&&s!==void 0&&s;return n?!r:r}updateHidden(t,i,e){this._isHiddenByDefault(t,i)&&(e=!e);const s=this._data[t.id];if(e)s?s.indexOf(i)<0&&s.push(i):this._data[t.id]=[i];else if(s){const e=s.indexOf(i);e>=0&&function(t,i){const e=t.length-1;i<e&&(t[i]=t[e]),t.pop()}(s,e),s.length===0&&delete this._data[t.id]}this._persist()}reset(t){if(t===void 0)this._data=Object.create(null),this._persist();else{for(const{id:i}of t)this._data[i]&&delete this._data[i];this._persist()}}_persist(){try{this._ignoreChangeEvent=!0;const t=JSON.stringify(this._data);this._storageService.store(gK._key,t,0,0)}finally{this._ignoreChangeEvent=!1}}};bK._key="menu.hiddenCommands",bK=gK=mK([wK(0,nW)],bK);let yK=pK=class{constructor(t,i,e,s,n){this._id=t,this._hiddenStates=i,this._collectContextKeysForSubmenus=e,this._commandService=s,this._contextKeyService=n,this._menuGroups=[],this._structureContextKeys=new Set,this._preconditionContextKeys=new Set,this._toggledContextKeys=new Set,this.refresh()}get structureContextKeys(){return this._structureContextKeys}get preconditionContextKeys(){return this._preconditionContextKeys}get toggledContextKeys(){return this._toggledContextKeys}refresh(){this._menuGroups.length=0,this._structureContextKeys.clear(),this._preconditionContextKeys.clear(),this._toggledContextKeys.clear();const t=tu.getMenuItems(this._id);let i;t.sort(pK._compareMenuItems);for(const e of t){const t=e.group||"";i&&i[0]===t||(i=[t,[]],this._menuGroups.push(i)),i[1].push(e),this._collectContextKeys(e)}}_collectContextKeys(t){if(pK._fillInKbExprKeys(t.when,this._structureContextKeys),Ja(t)){if(t.command.precondition&&pK._fillInKbExprKeys(t.command.precondition,this._preconditionContextKeys),t.command.toggled){const i=t.command.toggled.condition||t.command.toggled;pK._fillInKbExprKeys(i,this._toggledContextKeys)}}else this._collectContextKeysForSubmenus&&tu.getMenuItems(t.submenu).forEach(this._collectContextKeys,this)}createActionGroups(t){const i=[];for(const e of this._menuGroups){const[s,n]=e,r=[];for(const i of n)if(this._contextKeyService.contextMatchesRules(i.when)){const e=Ja(i);e&&this._hiddenStates.setDefaultState(this._id,i.command.id,!!i.isHiddenByDefault);const s=CK(this._id,e?i.command:i,this._hiddenStates);if(e)r.push(new eu(i.command,i.alt,t,s,this._contextKeyService,this._commandService));else{const e=new pK(i.submenu,this._hiddenStates,this._collectContextKeysForSubmenus,this._commandService,this._contextKeyService).createActionGroups(t),n=jl.join(...e.map((t=>t[1])));n.length>0&&r.push(new iu(i,s,n))}}r.length>0&&i.push([s,r])}return i}static _fillInKbExprKeys(t,i){if(t)for(const e of t.keys())i.add(e)}static _compareMenuItems(t,i){const e=t.group,s=i.group;if(e!==s){if(!e)return 1;if(!s||e==="navigation")return-1;if(s==="navigation")return 1;const t=e.localeCompare(s);if(t!==0)return t}const n=t.order||0,r=i.order||0;return n<r?-1:n>r?1:pK._compareTitles(Ja(t)?t.command.title:t.title,Ja(i)?i.command.title:i.title)}static _compareTitles(t,i){const e=typeof t=="string"?t:t.original,s=typeof i=="string"?i:i.original;return e.localeCompare(s)}};yK=pK=mK([wK(3,ql),wK(4,Ra)],yK);let kK=class{constructor(t,i,e,s,n){this._disposables=new Ji,this._menuInfo=new yK(t,i,e.emitEventsForSubmenuChanges,s,n);const r=new Co((()=>{this._menuInfo.refresh(),this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!0,isToggleChange:!0})}),e.eventDebounceDelay);this._disposables.add(r),this._disposables.add(tu.onDidChangeMenu((i=>{i.has(t)&&r.schedule()})));const o=this._disposables.add(new Ji);this._onDidChange=new de({onWillAddFirstListener:()=>{o.add(n.onDidChangeContext((t=>{const i=t.affectsSome(this._menuInfo.structureContextKeys),e=t.affectsSome(this._menuInfo.preconditionContextKeys),s=t.affectsSome(this._menuInfo.toggledContextKeys);(i||e||s)&&this._onDidChange.fire({menu:this,isStructuralChange:i,isEnablementChange:e,isToggleChange:s})}))),o.add(i.onDidChange((t=>{this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!1,isToggleChange:!1})})))},onDidRemoveLastListener:o.clear.bind(o),delay:e.eventDebounceDelay,merge:t=>{let i=!1,e=!1,s=!1;for(const n of t)if(i=i||n.isStructuralChange,e=e||n.isEnablementChange,s=s||n.isToggleChange,i&&e&&s)break;return{menu:this,isStructuralChange:i,isEnablementChange:e,isToggleChange:s}}}),this.onDidChange=this._onDidChange.event}getActions(t){return this._menuInfo.createActionGroups(t)}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}};function CK(t,i,e){const s=i.submenu!==void 0?i.submenu.id:i.id,n=typeof i.title=="string"?i.title:i.title.value,r=zl({id:`hide/${t.id}/${s}`,label:tt(0,"Hide '{0}'",n),run(){e.updateHidden(t,s,!0)}}),o=zl({id:`toggle/${t.id}/${s}`,label:n,get checked(){return!e.isHidden(t,s)},run(){e.updateHidden(t,s,!!this.checked)}});return{hide:r,toggle:o,get isHidden(){return!o.checked}}}kK=mK([wK(3,ql),wK(4,Ra)],kK);var SK,xK=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},DK=function(t,i){return function(e,s){i(e,s,t)}};let EK=SK=class extends Qi{constructor(t,i){super(),this.layoutService=t,this.logService=i,this.mapTextToType=new Map,this.findText="",this.resources=[],this.resourcesStateHash=void 0,(Ur||Kr)&&this.installWebKitWriteTextWorkaround(),this._register(ne.runAndSubscribe(Yh,(({window:t,disposables:i})=>{i.add(sc(t.document,"copy",(()=>this.clearResources())))}),{window:Wn,disposables:this._store}))}installWebKitWriteTextWorkaround(){const t=()=>{const t=new Ao;this.webKitPendingClipboardWritePromise&&!this.webKitPendingClipboardWritePromise.isSettled&&this.webKitPendingClipboardWritePromise.cancel(),this.webKitPendingClipboardWritePromise=t,navigator.clipboard.write([new ClipboardItem({"text/plain":t.p})]).catch((async i=>{i instanceof Error&&i.name==="NotAllowedError"&&t.isRejected||this.logService.error(i)}))};this._register(ne.runAndSubscribe(this.layoutService.onDidAddContainer,(({container:i,disposables:e})=>{e.add(sc(i,"click",t)),e.add(sc(i,"keydown",t))}),{container:this.layoutService.mainContainer,disposables:this._store}))}async writeText(t,i){if(this.writeResources([]),i)this.mapTextToType.set(i,t);else{if(this.webKitPendingClipboardWritePromise)return this.webKitPendingClipboardWritePromise.complete(t);try{return await navigator.clipboard.writeText(t)}catch(t){console.error(t)}this.fallbackWriteText(t)}}fallbackWriteText(t){const i=Rc(),e=i.activeElement,s=i.body.appendChild(nl("textarea",{"aria-hidden":!0}));s.style.height="1px",s.style.width="1px",s.style.position="absolute",s.value=t,s.focus(),s.select(),i.execCommand("copy"),e instanceof HTMLElement&&e.focus(),i.body.removeChild(s)}async readText(t){if(t)return this.mapTextToType.get(t)||"";try{return await navigator.clipboard.readText()}catch(t){console.error(t)}return""}async readFindText(){return this.findText}async writeFindText(t){this.findText=t}async writeResources(t){t.length===0?this.clearResources():(this.resources=t,this.resourcesStateHash=await this.computeResourcesStateHash())}async readResources(){const t=await this.computeResourcesStateHash();return this.resourcesStateHash!==t&&this.clearResources(),this.resources}async computeResourcesStateHash(){if(this.resources.length!==0)return Ph((await this.readText()).substring(0,SK.MAX_RESOURCE_STATE_SOURCE_LENGTH))}clearResources(){this.resources=[],this.resourcesStateHash=void 0}};EK.MAX_RESOURCE_STATE_SOURCE_LENGTH=1e3,EK=SK=xK([DK(0,BR),DK(1,ou)],EK);const AK=_l("clipboardService");var MK=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},LK=function(t,i){return function(e,s){i(e,s,t)}};const FK="data-keybinding-context";let TK=class{constructor(t,i){this._id=t,this._parent=i,this._value=Object.create(null),this._value._contextId=t}get value(){return{...this._value}}setValue(t,i){return this._value[t]!==i&&(this._value[t]=i,!0)}removeValue(t){return t in this._value&&(delete this._value[t],!0)}getValue(t){const i=this._value[t];return i===void 0&&this._parent?this._parent.getValue(t):i}};class RK extends TK{constructor(){super(-1,null)}setValue(t,i){return!1}removeValue(t){return!1}getValue(t){}}RK.INSTANCE=new RK;class OK extends TK{constructor(t,i,e){super(t,null),this._configurationService=i,this._values=EN.forConfigKeys(),this._listener=this._configurationService.onDidChangeConfiguration((t=>{if(t.source===7){const t=Array.from(this._values,(([t])=>t));this._values.clear(),e.fire(new PK(t))}else{const i=[];for(const e of t.affectedKeys){const t=`config.${e}`,s=this._values.findSuperstr(t);s!==void 0&&(i.push(...Wt.map(s,(([t])=>t))),this._values.deleteSuperstr(t)),this._values.has(t)&&(i.push(t),this._values.delete(t))}e.fire(new PK(i))}}))}dispose(){this._listener.dispose()}getValue(t){if(t.indexOf(OK._keyPrefix)!==0)return super.getValue(t);if(this._values.has(t))return this._values.get(t);const i=t.substr(OK._keyPrefix.length),e=this._configurationService.getValue(i);let s;switch(typeof e){case"number":case"boolean":case"string":s=e;break;default:s=Array.isArray(e)?JSON.stringify(e):e}return this._values.set(t,s),s}setValue(t,i){return super.setValue(t,i)}removeValue(t){return super.removeValue(t)}}OK._keyPrefix="config.";class IK{constructor(t,i,e){this._service=t,this._key=i,this._defaultValue=e,this.reset()}set(t){this._service.setContext(this._key,t)}reset(){this._defaultValue===void 0?this._service.removeContext(this._key):this._service.setContext(this._key,this._defaultValue)}get(){return this._service.getContextKeyValue(this._key)}}class _K{constructor(t){this.key=t}affectsSome(t){return t.has(this.key)}allKeysContainedIn(t){return this.affectsSome(t)}}class PK{constructor(t){this.keys=t}affectsSome(t){for(const i of this.keys)if(t.has(i))return!0;return!1}allKeysContainedIn(t){return this.keys.every((i=>t.has(i)))}}class NK{constructor(t){this.events=t}affectsSome(t){for(const i of this.events)if(i.affectsSome(t))return!0;return!1}allKeysContainedIn(t){return this.events.every((i=>i.allKeysContainedIn(t)))}}class BK extends Qi{constructor(t){super(),this._onDidChangeContext=this._register(new ue({merge:t=>new NK(t)})),this.onDidChangeContext=this._onDidChangeContext.event,this._isDisposed=!1,this._myContextId=t}createKey(t,i){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new IK(this,t,i)}bufferChangeEvents(t){this._onDidChangeContext.pause();try{t()}finally{this._onDidChangeContext.resume()}}createScoped(t){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new WK(this,t)}contextMatchesRules(t){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");const i=this.getContextValuesContainer(this._myContextId);return!t||t.evaluate(i)}getContextKeyValue(t){if(!this._isDisposed)return this.getContextValuesContainer(this._myContextId).getValue(t)}setContext(t,i){if(this._isDisposed)return;const e=this.getContextValuesContainer(this._myContextId);e&&e.setValue(t,i)&&this._onDidChangeContext.fire(new _K(t))}removeContext(t){this._isDisposed||this.getContextValuesContainer(this._myContextId).removeValue(t)&&this._onDidChangeContext.fire(new _K(t))}getContext(t){return this._isDisposed?RK.INSTANCE:this.getContextValuesContainer(function(t){for(;t;){if(t.hasAttribute(FK)){const i=t.getAttribute(FK);return i?parseInt(i,10):NaN}t=t.parentElement}return 0}(t))}dispose(){super.dispose(),this._isDisposed=!0}}let $K=class extends BK{constructor(t){super(0),this._contexts=new Map,this._lastContextId=0;const i=this._register(new OK(this._myContextId,t,this._onDidChangeContext));this._contexts.set(this._myContextId,i)}getContextValuesContainer(t){return this._isDisposed?RK.INSTANCE:this._contexts.get(t)||RK.INSTANCE}createChildContext(t=this._myContextId){if(this._isDisposed)throw new Error("ContextKeyService has been disposed");const i=++this._lastContextId;return this._contexts.set(i,new TK(i,this.getContextValuesContainer(t))),i}disposeContext(t){this._isDisposed||this._contexts.delete(t)}};$K=MK([LK(0,Md)],$K);class WK extends BK{constructor(t,i){if(super(t.createChildContext()),this._parentChangeListener=this._register(new Yi),this._parent=t,this._updateParentChangeListener(),this._domNode=i,this._domNode.hasAttribute(FK)){let t="";this._domNode.classList&&(t=Array.from(this._domNode.classList.values()).join(", ")),console.error("Element already has context attribute"+(t?": "+t:""))}this._domNode.setAttribute(FK,String(this._myContextId))}_updateParentChangeListener(){this._parentChangeListener.value=this._parent.onDidChangeContext((t=>{const i=this._parent.getContextValuesContainer(this._myContextId).value;var e;e=i,t.allKeysContainedIn(new Set(Object.keys(e)))||this._onDidChangeContext.fire(t)}))}dispose(){this._isDisposed||(this._parent.disposeContext(this._myContextId),this._domNode.removeAttribute(FK),super.dispose())}getContextValuesContainer(t){return this._isDisposed?RK.INSTANCE:this._parent.getContextValuesContainer(t)}createChildContext(t=this._myContextId){if(this._isDisposed)throw new Error("ScopedContextKeyService has been disposed");return this._parent.createChildContext(t)}disposeContext(t){this._isDisposed||this._parent.disposeContext(t)}}Gl.registerCommand("_setContext",(function(t,i,e){t.get(Ra).createKey(String(i),function(t){return q(t,(t=>typeof t=="object"&&t.$mid===1?as.revive(t).toString():t instanceof as?t.toString():void 0))}(e))})),Gl.registerCommand({id:"getContextKeyInfo",handler:()=>[...Ta.all()].sort(((t,i)=>t.key.localeCompare(i.key))),metadata:{description:tt(0,"A command that returns information about context keys"),args:[]}}),Gl.registerCommand("_generateContextKeyInfo",(function(){const t=[],i=new Set;for(const e of Ta.all())i.has(e.key)||(i.add(e.key),t.push(e));t.sort(((t,i)=>t.key.localeCompare(i.key))),console.log(JSON.stringify(t,void 0,2))}));let jK=class{constructor(t,i){this.key=t,this.data=i,this.incoming=new Map,this.outgoing=new Map}};class HK{constructor(t){this._hashFn=t,this._nodes=new Map}roots(){const t=[];for(const i of this._nodes.values())i.outgoing.size===0&&t.push(i);return t}insertEdge(t,i){const e=this.lookupOrInsertNode(t),s=this.lookupOrInsertNode(i);e.outgoing.set(s.key,s),s.incoming.set(e.key,e)}removeNode(t){const i=this._hashFn(t);this._nodes.delete(i);for(const t of this._nodes.values())t.outgoing.delete(i),t.incoming.delete(i)}lookupOrInsertNode(t){const i=this._hashFn(t);let e=this._nodes.get(i);return e||(e=new jK(i,t),this._nodes.set(i,e)),e}isEmpty(){return this._nodes.size===0}toString(){const t=[];for(const[i,e]of this._nodes)t.push(`${i}\n\t(-> incoming)[${[...e.incoming.keys()].join(", ")}]\n\t(outgoing ->)[${[...e.outgoing.keys()].join(",")}]\n`);return t.join(`\n`)}findCycleSlow(){for(const[t,i]of this._nodes){const e=new Set([t]),s=this._findCycle(i,e);if(s)return s}}_findCycle(t,i){for(const[e,s]of t.outgoing){if(i.has(e))return[...i,e].join(" -> ");i.add(e);const t=this._findCycle(s,i);if(t)return t;i.delete(e)}}}class VK extends Error{constructor(t){var i;super("cyclic dependency between services"),this.message=(i=t.findCycleSlow())!==null&&i!==void 0?i:`UNABLE to detect cycle, dumping graph: \n${t.toString()}`}}class zK{constructor(t=new aR,i=!1,e,s=!1){var n;this._services=t,this._strict=i,this._parent=e,this._enableTracing=s,this._activeInstantiations=new Set,this._services.set(Il,this),this._globalGraph=s?(n=e==null?void 0:e._globalGraph)!==null&&n!==void 0?n:new HK((t=>t)):void 0}createChild(t){return new zK(t,this._strict,this,this._enableTracing)}invokeFunction(t,...i){const e=UK.traceInvocation(this._enableTracing,t);let s=!1;try{return t({get:t=>{if(s)throw ji("service accessor is only valid during the invocation of its target method");const i=this._getOrCreateServiceInstance(t,e);if(!i)throw new Error(`[invokeFunction] unknown service '${t}'`);return i}},...i)}finally{s=!0,e.stop()}}createInstance(t,...i){let e,s;return t instanceof _d?(e=UK.traceCreation(this._enableTracing,t.ctor),s=this._createInstance(t.ctor,t.staticArguments.concat(i),e)):(e=UK.traceCreation(this._enableTracing,t),s=this._createInstance(t,i,e)),e.stop(),s}_createInstance(t,i=[],e){const s=Ol.getServiceDependencies(t).sort(((t,i)=>t.index-i.index)),n=[];for(const i of s){const s=this._getOrCreateServiceInstance(i.id,e);s||this._throwIfStrict(`[createInstance] ${t.name} depends on UNKNOWN service ${i.id}.`,!1),n.push(s)}const r=s.length>0?s[0].index:i.length;if(i.length!==r){console.trace(`[createInstance] First service dependency of ${t.name} at position ${r+1} conflicts with ${i.length} static arguments`);const e=r-i.length;i=e>0?i.concat(new Array(e)):i.slice(0,r)}return Reflect.construct(t,i.concat(n))}_setServiceInstance(t,i){if(this._services.get(t)instanceof _d)this._services.set(t,i);else{if(!this._parent)throw new Error("illegalState - setting UNKNOWN service instance");this._parent._setServiceInstance(t,i)}}_getServiceInstanceOrDescriptor(t){const i=this._services.get(t);return!i&&this._parent?this._parent._getServiceInstanceOrDescriptor(t):i}_getOrCreateServiceInstance(t,i){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(t));const e=this._getServiceInstanceOrDescriptor(t);return e instanceof _d?this._safeCreateAndCacheServiceInstance(t,e,i.branch(t,!0)):(i.branch(t,!1),e)}_safeCreateAndCacheServiceInstance(t,i,e){if(this._activeInstantiations.has(t))throw new Error(`illegal state - RECURSIVELY instantiating service '${t}'`);this._activeInstantiations.add(t);try{return this._createAndCacheServiceInstance(t,i,e)}finally{this._activeInstantiations.delete(t)}}_createAndCacheServiceInstance(t,i,e){var s;const n=new HK((t=>t.id.toString()));let r=0;const o=[{id:t,desc:i,_trace:e}];for(;o.length;){const i=o.pop();if(n.lookupOrInsertNode(i),r++>1e3)throw new VK(n);for(const e of Ol.getServiceDependencies(i.desc.ctor)){const r=this._getServiceInstanceOrDescriptor(e.id);if(r||this._throwIfStrict(`[createInstance] ${t} depends on ${e.id} which is NOT registered.`,!0),(s=this._globalGraph)===null||s===void 0||s.insertEdge(String(i.id),String(e.id)),r instanceof _d){const t={id:e.id,desc:r,_trace:i._trace.branch(e.id,!0)};n.insertEdge(i,t),o.push(t)}}}for(;;){const t=n.roots();if(t.length===0){if(!n.isEmpty())throw new VK(n);break}for(const{data:i}of t){if(this._getServiceInstanceOrDescriptor(i.id)instanceof _d){const t=this._createServiceInstanceWithOwner(i.id,i.desc.ctor,i.desc.staticArguments,i.desc.supportsDelayedInstantiation,i._trace);this._setServiceInstance(i.id,t)}n.removeNode(i)}}return this._getServiceInstanceOrDescriptor(t)}_createServiceInstanceWithOwner(t,i,e=[],s,n){if(this._services.get(t)instanceof _d)return this._createServiceInstance(t,i,e,s,n);if(this._parent)return this._parent._createServiceInstanceWithOwner(t,i,e,s,n);throw new Error(`illegalState - creating UNKNOWN service instance ${i.name}`)}_createServiceInstance(t,i,e=[],s,n){if(s){const s=new zK(void 0,this._strict,this,this._enableTracing);s._globalGraphImplicitDependency=String(t);const r=new Map,o=new Eo((()=>{const t=s._createInstance(i,e,n);for(const[i,e]of r){const s=t[i];if(typeof s=="function")for(const i of e)i.disposable=s.apply(t,i.listener)}return r.clear(),t}));return new Proxy(Object.create(null),{get(t,i){if(!o.isInitialized&&typeof i=="string"&&(i.startsWith("onDid")||i.startsWith("onWill"))){let t=r.get(i);return t||(t=new Ht,r.set(i,t)),(e,s,n)=>{if(o.isInitialized)return o.value[i](e,s,n);{const i={listener:[e,s,n],disposable:void 0},r=t.push(i);return Zi((()=>{var t;r(),(t=i.disposable)===null||t===void 0||t.dispose()}))}}}if(i in t)return t[i];const e=o.value;let s=e[i];return typeof s!="function"||(s=s.bind(e),t[i]=s),s},set:(t,i,e)=>(o.value[i]=e,!0),getPrototypeOf:t=>i.prototype})}return this._createInstance(i,e,n)}_throwIfStrict(t,i){if(i&&console.warn(t),this._strict)throw new Error(t)}}class UK{static traceInvocation(t,i){return t?new UK(2,i.name||(new Error).stack.split(`\n`).slice(3,4).join(`\n`)):UK._None}static traceCreation(t,i){return t?new UK(1,i.name):UK._None}constructor(t,i){this.type=t,this.name=i,this._start=Date.now(),this._dep=[]}branch(t,i){const e=new UK(3,t.toString());return this._dep.push([t,i,e]),e}stop(){const t=Date.now()-this._start;UK._totals+=t;let i=!1;const e=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${function t(e,s){const n=[],r=new Array(e+1).join("\t");for(const[o,h,c]of s._dep)if(h&&c){i=!0,n.push(`${r}CREATES -> ${o}`);const s=t(e+1,c);s&&n.push(s)}else n.push(`${r}uses -> ${o}`);return n.join(`\n`)}(1,this)}`,`DONE, took ${t.toFixed(2)}ms (grand total ${UK._totals.toFixed(2)}ms)`];(t>2||i)&&UK.all.add(e.join(`\n`))}}UK.all=new Set,UK._None=new class extends UK{constructor(){super(0,null)}stop(){}branch(){return this}},UK._totals=0;const KK=new Set([Lh.inMemory,Lh.vscodeSourceControl,Lh.walkThrough,Lh.walkThroughSnippet,Lh.vscodeChatCodeBlock]);class qK{constructor(){this._byResource=new zf,this._byOwner=new Map}set(t,i,e){let s=this._byResource.get(t);s||(s=new Map,this._byResource.set(t,s)),s.set(i,e);let n=this._byOwner.get(i);n||(n=new zf,this._byOwner.set(i,n)),n.set(t,e)}get(t,i){const e=this._byResource.get(t);return e==null?void 0:e.get(i)}delete(t,i){let e=!1,s=!1;const n=this._byResource.get(t);n&&(e=n.delete(i));const r=this._byOwner.get(i);if(r&&(s=r.delete(t)),e!==s)throw new Error("illegal state");return e&&s}values(t){var i,e,s,n;return typeof t=="string"?(e=(i=this._byOwner.get(t))===null||i===void 0?void 0:i.values())!==null&&e!==void 0?e:Wt.empty():as.isUri(t)?(n=(s=this._byResource.get(t))===null||s===void 0?void 0:s.values())!==null&&n!==void 0?n:Wt.empty():Wt.map(Wt.concat(...this._byOwner.values()),(t=>t[1]))}}class GK{constructor(t){this.errors=0,this.infos=0,this.warnings=0,this.unknowns=0,this._data=new zf,this._service=t,this._subscription=t.onMarkerChanged(this._update,this)}dispose(){this._subscription.dispose()}_update(t){for(const i of t){const t=this._data.get(i);t&&this._substract(t);const e=this._resourceStats(i);this._add(e),this._data.set(i,e)}}_resourceStats(t){const i={errors:0,warnings:0,infos:0,unknowns:0};if(KK.has(t.scheme))return i;for(const{severity:e}of this._service.read({resource:t}))e===QW.Error?i.errors+=1:e===QW.Warning?i.warnings+=1:e===QW.Info?i.infos+=1:i.unknowns+=1;return i}_substract(t){this.errors-=t.errors,this.warnings-=t.warnings,this.infos-=t.infos,this.unknowns-=t.unknowns}_add(t){this.errors+=t.errors,this.warnings+=t.warnings,this.infos+=t.infos,this.unknowns+=t.unknowns}}class ZK{constructor(){this._onMarkerChanged=new de({delay:0,merge:ZK._merge}),this.onMarkerChanged=this._onMarkerChanged.event,this._data=new qK,this._stats=new GK(this)}dispose(){this._stats.dispose(),this._onMarkerChanged.dispose()}remove(t,i){for(const e of i||[])this.changeOne(t,e,[])}changeOne(t,i,e){if(d(e))this._data.delete(i,t)&&this._onMarkerChanged.fire([i]);else{const s=[];for(const n of e){const e=ZK._toMarker(t,i,n);e&&s.push(e)}this._data.set(i,t,s),this._onMarkerChanged.fire([i])}}static _toMarker(t,i,e){let{code:s,severity:n,message:r,source:o,startLineNumber:h,startColumn:c,endLineNumber:l,endColumn:a,relatedInformation:u,tags:d}=e;if(r)return h=h>0?h:1,c=c>0?c:1,l=l>=h?l:h,a=a>0?a:c,{resource:i,owner:t,code:s,severity:n,message:r,source:o,startLineNumber:h,startColumn:c,endLineNumber:l,endColumn:a,relatedInformation:u,tags:d}}changeAll(t,i){const e=[],s=this._data.values(t);if(s)for(const i of s){const s=Wt.first(i);s&&(e.push(s.resource),this._data.delete(s.resource,t))}if(f(i)){const s=new zf;for(const{resource:n,marker:r}of i){const i=ZK._toMarker(t,n,r);if(!i)continue;const o=s.get(n);o?o.push(i):(s.set(n,[i]),e.push(n))}for(const[i,e]of s)this._data.set(i,t,e)}e.length>0&&this._onMarkerChanged.fire(e)}read(t=Object.create(null)){let{owner:i,resource:e,severities:s,take:n}=t;if((!n||n<0)&&(n=-1),i&&e){const t=this._data.get(e,i);if(t){const i=[];for(const e of t)if(ZK._accept(e,s)){const t=i.push(e);if(n>0&&t===n)break}return i}return[]}if(i||e){const t=this._data.values(e??i),r=[];for(const i of t)for(const t of i)if(ZK._accept(t,s)){const i=r.push(t);if(n>0&&i===n)return r}return r}{const t=[];for(const i of this._data.values())for(const e of i)if(ZK._accept(e,s)){const i=t.push(e);if(n>0&&i===n)return t}return t}}static _accept(t,i){return i===void 0||(i&t.severity)===t.severity}static _merge(t){const i=new zf;for(const e of t)for(const t of e)i.set(t,!0);return Array.from(i.keys())}}class JK extends Qi{constructor(){super(...arguments),this._configurationModel=new GP}get configurationModel(){return this._configurationModel}reload(){return this.resetConfigurationModel(),this.configurationModel}getConfigurationDefaultOverrides(){return{}}resetConfigurationModel(){this._configurationModel=new GP;const t=Va.as(Hd).getConfigurationProperties();this.updateConfigurationModel(Object.keys(t),t)}updateConfigurationModel(t,i){const e=this.getConfigurationDefaultOverrides();for(const s of t){const t=e[s],n=i[s];t!==void 0?this._configurationModel.addValue(s,t):n?this._configurationModel.addValue(s,n.default):this._configurationModel.removeValue(s)}}}const QK=_l("accessibilitySignalService");class YK{static register(t){return new YK(t.fileName)}constructor(t){this.fileName=t}}YK.error=YK.register({fileName:"error.mp3"}),YK.warning=YK.register({fileName:"warning.mp3"}),YK.foldedArea=YK.register({fileName:"foldedAreas.mp3"}),YK.break=YK.register({fileName:"break.mp3"}),YK.quickFixes=YK.register({fileName:"quickFixes.mp3"}),YK.taskCompleted=YK.register({fileName:"taskCompleted.mp3"}),YK.taskFailed=YK.register({fileName:"taskFailed.mp3"}),YK.terminalBell=YK.register({fileName:"terminalBell.mp3"}),YK.diffLineInserted=YK.register({fileName:"diffLineInserted.mp3"}),YK.diffLineDeleted=YK.register({fileName:"diffLineDeleted.mp3"}),YK.diffLineModified=YK.register({fileName:"diffLineModified.mp3"}),YK.chatRequestSent=YK.register({fileName:"chatRequestSent.mp3"}),YK.chatResponsePending=YK.register({fileName:"chatResponsePending.mp3"}),YK.chatResponseReceived1=YK.register({fileName:"chatResponseReceived1.mp3"}),YK.chatResponseReceived2=YK.register({fileName:"chatResponseReceived2.mp3"}),YK.chatResponseReceived3=YK.register({fileName:"chatResponseReceived3.mp3"}),YK.chatResponseReceived4=YK.register({fileName:"chatResponseReceived4.mp3"}),YK.clear=YK.register({fileName:"clear.mp3"}),YK.save=YK.register({fileName:"save.mp3"}),YK.format=YK.register({fileName:"format.mp3"}),YK.voiceRecordingStarted=YK.register({fileName:"voiceRecordingStarted.mp3"}),YK.voiceRecordingStopped=YK.register({fileName:"voiceRecordingStopped.mp3"});class XK{constructor(t){this.randomOneOf=t}}class tq{static register(t){const i=new XK("randomOneOf"in t.sound?t.sound.randomOneOf:[t.sound]),e=new tq(i,t.name,t.legacySoundSettingsKey,t.settingsKey,t.legacyAnnouncementSettingsKey,t.announcementMessage);return tq._signals.add(e),e}constructor(t,i,e,s,n,r){this.sound=t,this.name=i,this.legacySoundSettingsKey=e,this.settingsKey=s,this.legacyAnnouncementSettingsKey=n,this.announcementMessage=r}}tq._signals=new Set,tq.error=tq.register({name:tt(0,"Error on Line"),sound:YK.error,legacySoundSettingsKey:"audioCues.lineHasError",legacyAnnouncementSettingsKey:"accessibility.alert.error",announcementMessage:tt(0,"Error"),settingsKey:"accessibility.signals.lineHasError"}),tq.warning=tq.register({name:tt(0,"Warning on Line"),sound:YK.warning,legacySoundSettingsKey:"audioCues.lineHasWarning",legacyAnnouncementSettingsKey:"accessibility.alert.warning",announcementMessage:tt(0,"Warning"),settingsKey:"accessibility.signals.lineHasWarning"}),tq.foldedArea=tq.register({name:tt(0,"Folded Area on Line"),sound:YK.foldedArea,legacySoundSettingsKey:"audioCues.lineHasFoldedArea",legacyAnnouncementSettingsKey:"accessibility.alert.foldedArea",announcementMessage:tt(0,"Folded"),settingsKey:"accessibility.signals.lineHasFoldedArea"}),tq.break=tq.register({name:tt(0,"Breakpoint on Line"),sound:YK.break,legacySoundSettingsKey:"audioCues.lineHasBreakpoint",legacyAnnouncementSettingsKey:"accessibility.alert.breakpoint",announcementMessage:tt(0,"Breakpoint"),settingsKey:"accessibility.signals.lineHasBreakpoint"}),tq.inlineSuggestion=tq.register({name:tt(0,"Inline Suggestion on Line"),sound:YK.quickFixes,legacySoundSettingsKey:"audioCues.lineHasInlineSuggestion",settingsKey:"accessibility.signals.lineHasInlineSuggestion"}),tq.terminalQuickFix=tq.register({name:tt(0,"Terminal Quick Fix"),sound:YK.quickFixes,legacySoundSettingsKey:"audioCues.terminalQuickFix",legacyAnnouncementSettingsKey:"accessibility.alert.terminalQuickFix",announcementMessage:tt(0,"Quick Fix"),settingsKey:"accessibility.signals.terminalQuickFix"}),tq.onDebugBreak=tq.register({name:tt(0,"Debugger Stopped on Breakpoint"),sound:YK.break,legacySoundSettingsKey:"audioCues.onDebugBreak",legacyAnnouncementSettingsKey:"accessibility.alert.onDebugBreak",announcementMessage:tt(0,"Breakpoint"),settingsKey:"accessibility.signals.onDebugBreak"}),tq.noInlayHints=tq.register({name:tt(0,"No Inlay Hints on Line"),sound:YK.error,legacySoundSettingsKey:"audioCues.noInlayHints",legacyAnnouncementSettingsKey:"accessibility.alert.noInlayHints",announcementMessage:tt(0,"No Inlay Hints"),settingsKey:"accessibility.signals.noInlayHints"}),tq.taskCompleted=tq.register({name:tt(0,"Task Completed"),sound:YK.taskCompleted,legacySoundSettingsKey:"audioCues.taskCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.taskCompleted",announcementMessage:tt(0,"Task Completed"),settingsKey:"accessibility.signals.taskCompleted"}),tq.taskFailed=tq.register({name:tt(0,"Task Failed"),sound:YK.taskFailed,legacySoundSettingsKey:"audioCues.taskFailed",legacyAnnouncementSettingsKey:"accessibility.alert.taskFailed",announcementMessage:tt(0,"Task Failed"),settingsKey:"accessibility.signals.taskFailed"}),tq.terminalCommandFailed=tq.register({name:tt(0,"Terminal Command Failed"),sound:YK.error,legacySoundSettingsKey:"audioCues.terminalCommandFailed",legacyAnnouncementSettingsKey:"accessibility.alert.terminalCommandFailed",announcementMessage:tt(0,"Command Failed"),settingsKey:"accessibility.signals.terminalCommandFailed"}),tq.terminalBell=tq.register({name:tt(0,"Terminal Bell"),sound:YK.terminalBell,legacySoundSettingsKey:"audioCues.terminalBell",legacyAnnouncementSettingsKey:"accessibility.alert.terminalBell",announcementMessage:tt(0,"Terminal Bell"),settingsKey:"accessibility.signals.terminalBell"}),tq.notebookCellCompleted=tq.register({name:tt(0,"Notebook Cell Completed"),sound:YK.taskCompleted,legacySoundSettingsKey:"audioCues.notebookCellCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellCompleted",announcementMessage:tt(0,"Notebook Cell Completed"),settingsKey:"accessibility.signals.notebookCellCompleted"}),tq.notebookCellFailed=tq.register({name:tt(0,"Notebook Cell Failed"),sound:YK.taskFailed,legacySoundSettingsKey:"audioCues.notebookCellFailed",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellFailed",announcementMessage:tt(0,"Notebook Cell Failed"),settingsKey:"accessibility.signals.notebookCellFailed"}),tq.diffLineInserted=tq.register({name:tt(0,"Diff Line Inserted"),sound:YK.diffLineInserted,legacySoundSettingsKey:"audioCues.diffLineInserted",settingsKey:"accessibility.signals.diffLineInserted"}),tq.diffLineDeleted=tq.register({name:tt(0,"Diff Line Deleted"),sound:YK.diffLineDeleted,legacySoundSettingsKey:"audioCues.diffLineDeleted",settingsKey:"accessibility.signals.diffLineDeleted"}),tq.diffLineModified=tq.register({name:tt(0,"Diff Line Modified"),sound:YK.diffLineModified,legacySoundSettingsKey:"audioCues.diffLineModified",settingsKey:"accessibility.signals.diffLineModified"}),tq.chatRequestSent=tq.register({name:tt(0,"Chat Request Sent"),sound:YK.chatRequestSent,legacySoundSettingsKey:"audioCues.chatRequestSent",legacyAnnouncementSettingsKey:"accessibility.alert.chatRequestSent",announcementMessage:tt(0,"Chat Request Sent"),settingsKey:"accessibility.signals.chatRequestSent"}),tq.chatResponseReceived=tq.register({name:tt(0,"Chat Response Received"),legacySoundSettingsKey:"audioCues.chatResponseReceived",sound:{randomOneOf:[YK.chatResponseReceived1,YK.chatResponseReceived2,YK.chatResponseReceived3,YK.chatResponseReceived4]},settingsKey:"accessibility.signals.chatResponseReceived"}),tq.chatResponsePending=tq.register({name:tt(0,"Chat Response Pending"),sound:YK.chatResponsePending,legacySoundSettingsKey:"audioCues.chatResponsePending",legacyAnnouncementSettingsKey:"accessibility.alert.chatResponsePending",announcementMessage:tt(0,"Chat Response Pending"),settingsKey:"accessibility.signals.chatResponsePending"}),tq.clear=tq.register({name:tt(0,"Clear"),sound:YK.clear,legacySoundSettingsKey:"audioCues.clear",legacyAnnouncementSettingsKey:"accessibility.alert.clear",announcementMessage:tt(0,"Clear"),settingsKey:"accessibility.signals.clear"}),tq.save=tq.register({name:tt(0,"Save"),sound:YK.save,legacySoundSettingsKey:"audioCues.save",legacyAnnouncementSettingsKey:"accessibility.alert.save",announcementMessage:tt(0,"Save"),settingsKey:"accessibility.signals.save"}),tq.format=tq.register({name:tt(0,"Format"),sound:YK.format,legacySoundSettingsKey:"audioCues.format",legacyAnnouncementSettingsKey:"accessibility.alert.format",announcementMessage:tt(0,"Format"),settingsKey:"accessibility.signals.format"}),tq.voiceRecordingStarted=tq.register({name:tt(0,"Voice Recording Started"),sound:YK.voiceRecordingStarted,legacySoundSettingsKey:"audioCues.voiceRecordingStarted",settingsKey:"accessibility.signals.voiceRecordingStarted"}),tq.voiceRecordingStopped=tq.register({name:tt(0,"Voice Recording Stopped"),sound:YK.voiceRecordingStopped,legacySoundSettingsKey:"audioCues.voiceRecordingStopped",settingsKey:"accessibility.signals.voiceRecordingStopped"});class iq extends Qi{constructor(t,i=[]){super(),this.logger=new uu([t,...i]),this._register(t.onDidChangeLogLevel((t=>this.setLevel(t))))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(t){this.logger.setLevel(t)}getLevel(){return this.logger.getLevel()}trace(t,...i){this.logger.trace(t,...i)}debug(t,...i){this.logger.debug(t,...i)}info(t,...i){this.logger.info(t,...i)}warn(t,...i){this.logger.warn(t,...i)}error(t,...i){this.logger.error(t,...i)}}const eq=[];function sq(t){eq.push(t)}function nq(){return eq.slice(0)}var rq=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},oq=function(t,i){return function(e,s){i(e,s,t)}};class hq{constructor(t){this.disposed=!1,this.model=t,this._onWillDispose=new le}get textEditorModel(){return this.model}dispose(){this.disposed=!0,this._onWillDispose.fire()}}let cq=class{constructor(t){this.modelService=t}createModelReference(t){const i=this.modelService.getModel(t);return i?Promise.resolve(new te(new hq(i))):Promise.reject(new Error("Model not found"))}};cq=rq([oq(0,Nl)],cq);class lq{show(){return lq.NULL_PROGRESS_RUNNER}async showWhile(t,i){await t}}lq.NULL_PROGRESS_RUNNER={done:()=>{},total:()=>{},worked:()=>{}};class aq{info(t){return this.notify({severity:dR.Info,message:t})}warn(t){return this.notify({severity:dR.Warning,message:t})}error(t){return this.notify({severity:dR.Error,message:t})}notify(t){switch(t.severity){case dR.Error:console.error(t.message);break;case dR.Warning:console.warn(t.message);break;default:console.log(t.message)}return aq.NO_OP}prompt(t,i,e,s){return aq.NO_OP}status(t,i){return Qi.None}}aq.NO_OP=new class{};let uq=class{constructor(t){this._onWillExecuteCommand=new le,this._onDidExecuteCommand=new le,this.onDidExecuteCommand=this._onDidExecuteCommand.event,this._instantiationService=t}executeCommand(t,...i){const e=Gl.getCommand(t);if(!e)return Promise.reject(new Error(`command '${t}' not found`));try{this._onWillExecuteCommand.fire({commandId:t,args:i});const s=this._instantiationService.invokeFunction.apply(this._instantiationService,[e.handler,...i]);return this._onDidExecuteCommand.fire({commandId:t,args:i}),Promise.resolve(s)}catch(t){return Promise.reject(t)}}};uq=rq([oq(0,Il)],uq);let dq=class extends rN{constructor(t,i,e,s,n,r){super(t,i,e,s,n),this._cachedResolver=null,this._dynamicKeybindings=[],this._domNodeListeners=[];const o=t=>{const i=new Ji;i.add(sc(t,qc.KEY_DOWN,(t=>{const i=new so(t);this._dispatch(i,i.target)&&(i.preventDefault(),i.stopPropagation())}))),i.add(sc(t,qc.KEY_UP,(t=>{const i=new so(t);this._singleModifierDispatch(i,i.target)&&i.preventDefault()}))),this._domNodeListeners.push(new fq(t,i))},h=t=>{for(let i=0;i<this._domNodeListeners.length;i++){const e=this._domNodeListeners[i];e.domNode===t&&(this._domNodeListeners.splice(i,1),e.dispose())}},c=t=>{t.getOption(61)||o(t.getContainerDomNode())};this._register(r.onCodeEditorAdd(c)),this._register(r.onCodeEditorRemove((t=>{t.getOption(61)||h(t.getContainerDomNode())}))),r.listCodeEditors().forEach(c);const l=t=>{o(t.getContainerDomNode())};this._register(r.onDiffEditorAdd(l)),this._register(r.onDiffEditorRemove((t=>{h(t.getContainerDomNode())}))),r.listDiffEditors().forEach(l)}addDynamicKeybinding(t,i,e,s){return Gi(Gl.registerCommand(t,e),this.addDynamicKeybindings([{keybinding:i,command:t,when:s}]))}addDynamicKeybindings(t){const i=t.map((t=>{var i;return{keybinding:Zr(t.keybinding,Ft),command:(i=t.command)!==null&&i!==void 0?i:null,commandArgs:t.commandArgs,when:t.when,weight1:1e3,weight2:0,extensionId:null,isBuiltinExtension:!1}}));return this._dynamicKeybindings=this._dynamicKeybindings.concat(i),this.updateResolver(),Zi((()=>{for(let t=0;t<this._dynamicKeybindings.length;t++)if(this._dynamicKeybindings[t]===i[0])return this._dynamicKeybindings.splice(t,i.length),void this.updateResolver()}))}updateResolver(){this._cachedResolver=null,this._onDidUpdateKeybindings.fire()}_getResolver(){if(!this._cachedResolver){const t=this._toNormalizedKeybindingItems(Ua.getDefaultKeybindings(),!0),i=this._toNormalizedKeybindingItems(this._dynamicKeybindings,!1);this._cachedResolver=new iN(t,i,(t=>this._log(t)))}return this._cachedResolver}_documentHasFocus(){return Wn.document.hasFocus()}_toNormalizedKeybindingItems(t,i){const e=[];let s=0;for(const n of t){const t=n.when||void 0,r=n.keybinding;if(r){const o=mN.resolveKeybinding(r,Ft);for(const r of o)e[s++]=new hN(r,n.command,n.commandArgs,t,i,null,!1)}else e[s++]=new hN(void 0,n.command,n.commandArgs,t,i,null,!1)}return e}resolveKeyboardEvent(t){const i=new Qr(t.ctrlKey,t.shiftKey,t.altKey,t.metaKey,t.keyCode);return new mN([i],Ft)}};dq=rq([oq(0,Ra),oq(1,ql),oq(2,ru),oq(3,gR),oq(4,ou),oq(5,Pl)],dq);class fq extends Qi{constructor(t,i){super(),this.domNode=t,this._register(i)}}function gq(t){return t&&typeof t=="object"&&(!t.overrideIdentifier||typeof t.overrideIdentifier=="string")&&(!t.resource||t.resource instanceof as)}class pq{constructor(){this._onDidChangeConfiguration=new le,this.onDidChangeConfiguration=this._onDidChangeConfiguration.event;const t=new JK;this._configuration=new QP(t.reload(),new GP,new GP,new GP),t.dispose()}getValue(t,i){const e=typeof t=="string"?t:void 0,s=gq(t)?t:gq(i)?i:{};return this._configuration.getValue(e,s,void 0)}updateValues(t){const i={data:this._configuration.toData()},e=[];for(const i of t){const[t,s]=i;this.getValue(t)!==s&&(this._configuration.updateValue(t,s),e.push(t))}if(e.length>0){const t=new YP({keys:e,overrides:[]},i,this._configuration);t.source=8,this._onDidChangeConfiguration.fire(t)}return Promise.resolve()}updateValue(t,i,e,s){return this.updateValues([[t,i]])}inspect(t,i={}){return this._configuration.inspect(t,i,void 0)}}let mq=class{constructor(t,i,e){this.configurationService=t,this.modelService=i,this.languageService=e,this._onDidChangeConfiguration=new le,this.configurationService.onDidChangeConfiguration((t=>{this._onDidChangeConfiguration.fire({affectedKeys:t.affectedKeys,affectsConfiguration:(i,e)=>t.affectsConfiguration(e)})}))}getValue(t,i,e){const s=ks.isIPosition(i)?i:null,n=s?typeof e=="string"?e:void 0:typeof i=="string"?i:void 0,r=t?this.getLanguage(t,s):void 0;return n===void 0?this.configurationService.getValue({resource:t,overrideIdentifier:r}):this.configurationService.getValue(n,{resource:t,overrideIdentifier:r})}getLanguage(t,i){const e=this.modelService.getModel(t);return e?i?e.getLanguageIdAtPosition(i.lineNumber,i.column):e.getLanguageId():this.languageService.guessLanguageIdByFilepathOrFirstLine(t)}};mq=rq([oq(0,Md),oq(1,Nl),oq(2,Id)],mq);let wq=class{constructor(t){this.configurationService=t}getEOL(t,i){const e=this.configurationService.getValue("files.eol",{overrideIdentifier:i,resource:t});return e&&typeof e=="string"&&e!=="auto"?e:yt||bt?`\n`:`\r\n`}};wq=rq([oq(0,Md)],wq);class vq{constructor(){const t=as.from({scheme:vq.SCHEME,authority:"model",path:"/"});this.workspace={id:ON,folders:[new TN({uri:t,name:"",index:0})]}}getWorkspace(){return this.workspace}getWorkspaceFolder(t){return t&&t.scheme===vq.SCHEME?this.workspace.folders[0]:null}}function bq(t,i,e){if(!i||!(t instanceof pq))return;const s=[];Object.keys(i).forEach((t=>{(function(t){return UP()[`editor.${t}`]||!1})(t)&&s.push([`editor.${t}`,i[t]]),e&&function(t){return UP()[`diffEditor.${t}`]||!1}(t)&&s.push([`diffEditor.${t}`,i[t]])})),s.length>0&&t.updateValues(s)}vq.SCHEME="inmemory";let yq=class{constructor(t){this._modelService=t}hasPreviewHandler(){return!1}async apply(t,i){const e=Array.isArray(t)?t:NP.convert(t),s=new Map;for(const t of e){if(!(t instanceof BP))throw new Error("bad edit - only text edits are supported");const i=this._modelService.getModel(t.resource);if(!i)throw new Error("bad edit - model not found");if(typeof t.versionId=="number"&&i.getVersionId()!==t.versionId)throw new Error("bad state - model changed in the meantime");let e=s.get(i);e||(e=[],s.set(i,e)),e.push(KP.replaceMove(Cs.lift(t.textEdit.range),t.textEdit.text))}let n=0,r=0;for(const[t,i]of s)t.pushStackElement(),t.pushEditOperations([],i,(()=>[])),t.pushStackElement(),r+=1,n+=i.length;return{ariaSummary:Kn(jN.bulkEditServiceSummary,n,r),isApplied:n>0}}};yq=rq([oq(0,Nl)],yq);let kq=class extends FP{constructor(t,i){super(t),this._codeEditorService=i}showContextView(t,i,e){if(!i){const t=this._codeEditorService.getFocusedCodeEditor()||this._codeEditorService.getActiveCodeEditor();t&&(i=t.getContainerDomNode())}return super.showContextView(t,i,e)}};kq=rq([oq(0,BR),oq(1,Pl)],kq);let Cq=class extends HW{constructor(t,i,e,s,n,r){super(t,i,e,s,n,r),this.configure({blockMouse:!1})}};Cq=rq([oq(0,ru),oq(1,gR),oq(2,rI),oq(3,NS),oq(4,Ya),oq(5,Ra)],Cq);var Sq;Nd(Md,pq,0),Nd(Np,mq,0),Nd(Bp,wq,0),Nd(AN,vq,0),Nd(wN,class{getUriLabel(t,i){return t.scheme==="file"?t.fsPath:t.path}getUriBasenameLabel(t){return SM(t)}},0),Nd(ru,class{publicLog2(){}},0),Nd(VR,class{async confirm(t){return{confirmed:this.doConfirm(t.message,t.detail),checkboxChecked:!1}}doConfirm(t,i){let e=t;return i&&(e=e+`\n\n`+i),Wn.confirm(e)}async prompt(t){var i,e;let s;if(this.doConfirm(t.message,t.detail)){const n=[...(i=t.buttons)!==null&&i!==void 0?i:[]];t.cancelButton&&typeof t.cancelButton!="string"&&typeof t.cancelButton!="boolean"&&n.push(t.cancelButton),s=await((e=n[0])===null||e===void 0?void 0:e.run({checkboxChecked:!1}))}return{result:s}}async error(t,i){await this.prompt({type:dR.Error,message:t,detail:i})}},0),Nd(oO,class{constructor(){this.isExtensionDevelopment=!1,this.isBuilt=!1}},0),Nd(gR,aq,0),Nd(XW,ZK,0),Nd(Id,class extends XN{constructor(){super()}},0),Nd(aK,class extends Qi{constructor(){super(),this._onColorThemeChange=this._register(new le),this.onDidColorThemeChange=this._onColorThemeChange.event,this._onProductIconThemeChange=this._register(new le),this.onDidProductIconThemeChange=this._onProductIconThemeChange.event,this._environment=Object.create(null),this._builtInProductIconTheme=new XU,this._autoDetectHighContrast=!0,this._knownThemes=new Map,this._knownThemes.set(tK,lK(tK)),this._knownThemes.set(iK,lK(iK)),this._knownThemes.set(eK,lK(eK)),this._knownThemes.set(sK,lK(sK));const t=this._register(function(t){const i=new Ji,e=i.add(new le),s=GU();return i.add(s.onDidChange((()=>e.fire()))),t&&i.add(t.onDidProductIconThemeChange((()=>e.fire()))),{dispose:()=>i.dispose(),onDidChange:e.event,getCSS(){const i=t?t.getProductIconTheme():new XU,e={},n=t=>{const s=i.getIcon(t);if(!s)return;const n=s.font;return n?(e[n.id]=n.definition,`.codicon-${t.id}:before { content: '${s.fontCharacter}'; font-family: ${al(n.id)}; }`):`.codicon-${t.id}:before { content: '${s.fontCharacter}'; }`},r=[];for(const t of s.getIcons()){const i=n(t);i&&r.push(i)}for(const t in e){const i=e[t],s=i.weight?`font-weight: ${i.weight};`:"",n=i.style?`font-style: ${i.style};`:"",o=i.src.map((t=>`${ll(t.location)} format('${t.format}')`)).join(", ");r.push(`@font-face { src: ${o}; font-family: ${al(t)};${s}${n} font-display: block; }`)}return r.join(`\n`)}}}(this));this._codiconCSS=t.getCSS(),this._themeCSS="",this._allCSS=`${this._codiconCSS}\n${this._themeCSS}`,this._globalStyleElement=null,this._styleElements=[],this._colorMapOverride=null,this.setTheme(tK),this._onOSSchemeChanged(),this._register(t.onDidChange((()=>{this._codiconCSS=t.getCSS(),this._updateCSS()}))),Wr(Wn,"(forced-colors: active)",(()=>{this._onOSSchemeChanged()}))}registerEditorContainer(t){return Ac(t)?this._registerShadowDomContainer(t):this._registerRegularEditorContainer()}_registerRegularEditorContainer(){return this._globalStyleElement||(this._globalStyleElement=Pc(void 0,(t=>{t.className="monaco-colors",t.textContent=this._allCSS})),this._styleElements.push(this._globalStyleElement)),Qi.None}_registerShadowDomContainer(t){const i=Pc(t,(t=>{t.className="monaco-colors",t.textContent=this._allCSS}));return this._styleElements.push(i),{dispose:()=>{for(let t=0;t<this._styleElements.length;t++)if(this._styleElements[t]===i)return void this._styleElements.splice(t,1)}}}defineTheme(t,i){if(!/^[a-z0-9\-]+$/i.test(t))throw new Error("Illegal theme name!");if(!hK(i.base)&&!hK(t))throw new Error("Illegal theme base!");this._knownThemes.set(t,new oK(t,i)),hK(t)&&this._knownThemes.forEach((i=>{i.base===t&&i.notifyBaseUpdated()})),this._theme.themeName===t&&this.setTheme(t)}getColorTheme(){return this._theme}setColorMapOverride(t){this._colorMapOverride=t,this._updateThemeOrColorMap()}setTheme(t){let i;i=this._knownThemes.has(t)?this._knownThemes.get(t):this._knownThemes.get(tK),this._updateActualTheme(i)}_updateActualTheme(t){t&&this._theme!==t&&(this._theme=t,this._updateThemeOrColorMap())}_onOSSchemeChanged(){if(this._autoDetectHighContrast){const t=Wn.matchMedia("(forced-colors: active)").matches;if(t!==lk(this._theme.type)){let i;i=ak(this._theme.type)?t?eK:iK:t?sK:tK,this._updateActualTheme(this._knownThemes.get(i))}}}setAutoDetectHighContrast(t){this._autoDetectHighContrast=t,this._onOSSchemeChanged()}_updateThemeOrColorMap(){const t=[],i={},e={addRule:e=>{i[e]||(t.push(e),i[e]=!0)}};rK.getThemingParticipants().forEach((t=>t(this._theme,e,this._environment)));const s=[];for(const t of nK.getColors()){const i=this._theme.getColor(t.id,!0);i&&s.push(`${Fw(t.id)}: ${i.toString()};`)}e.addRule(`.monaco-editor, .monaco-diff-editor, .monaco-component { ${s.join(`\n`)} }`);const n=this._colorMapOverride||this._theme.tokenTheme.getColorMap();e.addRule(function(t){const i=[];for(let e=1,s=t.length;e<s;e++){const s=t[e];i[e]=`.mtk${e} { color: ${s}; }`}return i.push(".mtki { font-style: italic; }"),i.push(".mtkb { font-weight: bold; }"),i.push(".mtku { text-decoration: underline; text-underline-position: under; }"),i.push(".mtks { text-decoration: line-through; }"),i.push(".mtks.mtku { text-decoration: underline line-through; text-underline-position: under; }"),i.join(`\n`)}(n)),this._themeCSS=t.join(`\n`),this._updateCSS(),Us.setColorMap(n),this._onColorThemeChange.fire(this._theme)}_updateCSS(){this._allCSS=`${this._codiconCSS}\n${this._themeCSS}`,this._styleElements.forEach((t=>t.textContent=this._allCSS))}getFileIconTheme(){return{hasFileIcons:!1,hasFolderIcons:!1,hidesExplorerArrows:!1}}getProductIconTheme(){return this._builtInProductIconTheme}},0),Nd(ou,class extends iq{constructor(){super(new au)}},0),Nd(Nl,uj,0),Nd(cw,ej,0),Nd(Ra,$K,0),Nd(vN,class{withProgress(t,i,e){return i({report:()=>{}})}},0),Nd(yN,lq,0),Nd(nW,class extends oW{constructor(){super(),this.applicationStorage=this._register(new iW(new eW,{hint:X$.STORAGE_IN_MEMORY})),this.profileStorage=this._register(new iW(new eW,{hint:X$.STORAGE_IN_MEMORY})),this.workspaceStorage=this._register(new iW(new eW,{hint:X$.STORAGE_IN_MEMORY})),this._register(this.workspaceStorage.onDidChangeStorage((t=>this.emitDidChangeValue(1,t)))),this._register(this.profileStorage.onDidChangeStorage((t=>this.emitDidChangeValue(0,t)))),this._register(this.applicationStorage.onDidChangeStorage((t=>this.emitDidChangeValue(-1,t))))}getStorage(t){switch(t){case-1:return this.applicationStorage;case 0:return this.profileStorage;default:return this.workspaceStorage}}},0),Nd(JW,zp,0),Nd(PP,yq,0),Nd(HN,class{constructor(){this._neverEmitter=new le,this.onDidChangeTrust=this._neverEmitter.event}isWorkspaceTrusted(){return!0}},0),Nd(Bl,cq,0),Nd(vw,fK,0),Nd(MV,class{get lastFocusedList(){return this._lastFocusedWidget}constructor(){this.disposables=new Ji,this.lists=[],this._lastFocusedWidget=void 0,this._hasCreatedStyleController=!1}setLastFocusedList(t){var i,e;t!==this._lastFocusedWidget&&((i=this._lastFocusedWidget)===null||i===void 0||i.getHTMLElement().classList.remove("last-focused"),this._lastFocusedWidget=t,(e=this._lastFocusedWidget)===null||e===void 0||e.getHTMLElement().classList.add("last-focused"))}register(t,i){if(this._hasCreatedStyleController||(this._hasCreatedStyleController=!0,new R$(Pc(),"").style(gW)),this.lists.some((i=>i.widget===t)))throw new Error("Cannot register the same widget multiple times");const e={widget:t,extraContextKeys:i};return this.lists.push(e),Fc(t.getHTMLElement())&&this.setLastFocusedList(t),Gi(t.onDidFocus((()=>this.setLastFocusedList(t))),Zi((()=>this.lists.splice(this.lists.indexOf(e),1))),t.onDidDispose((()=>{this.lists=this.lists.filter((t=>t!==e)),this._lastFocusedWidget===t&&this.setLastFocusedList(void 0)})))}dispose(){this.disposables.dispose()}},0),Nd(ql,uq,0),Nd(NS,dq,0),Nd(vj,FU,0),Nd(rI,kq,0),Nd(uI,ZW,0),Nd(AK,EK,0),Nd(oI,Cq,0),Nd(Ya,vK,0),Nd(QK,class{async playSignal(t,i){}},0),function(t){const i=new aR;for(const[t,e]of Bd())i.set(t,e);const e=new zK(i,!0);i.set(Il,e),t.get=function(t){s||r({});const n=i.get(t);if(!n)throw new Error("Missing service "+t);return n instanceof _d?e.invokeFunction((i=>i.get(t))):n};let s=!1;const n=new le;function r(t){if(s)return e;s=!0;for(const[t,e]of Bd())i.get(t)||i.set(t,e);for(const e in t)if(t.hasOwnProperty(e)){const s=_l(e);i.get(s)instanceof _d&&i.set(s,t[e])}const r=nq();for(const t of r)try{e.createInstance(t)}catch(t){Ii(t)}return n.fire(),e}t.initialize=r,t.withServices=function(t){if(s)return t();const i=new Ji,e=i.add(n.event((()=>{e.dispose(),i.add(t())})));return i}}(Sq||(Sq={}));class xq{static capture(t){if(t.getScrollTop()===0||t.hasPendingScrollAnimation())return new xq(t.getScrollTop(),t.getContentHeight(),null,0,null);let i=null,e=0;const s=t.getVisibleRanges();if(s.length>0){i=s[0].getStartPosition();const n=t.getTopForPosition(i.lineNumber,i.column);e=t.getScrollTop()-n}return new xq(t.getScrollTop(),t.getContentHeight(),i,e,t.getPosition())}constructor(t,i,e,s,n){this._initialScrollTop=t,this._initialContentHeight=i,this._visiblePosition=e,this._visiblePositionScrollDelta=s,this._cursorPosition=n}restore(t){if((this._initialContentHeight!==t.getContentHeight()||this._initialScrollTop!==t.getScrollTop())&&this._visiblePosition){const i=t.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);t.setScrollTop(i+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(t){if(this._initialContentHeight===t.getContentHeight()&&this._initialScrollTop===t.getScrollTop())return;const i=t.getPosition();if(!this._cursorPosition||!i)return;const e=t.getTopForLineNumber(i.lineNumber)-t.getTopForLineNumber(this._cursorPosition.lineNumber);t.setScrollTop(t.getScrollTop()+e)}}function Dq(){return Ie&&!!Ie.VSCODE_DEV}function Eq(t){if(Dq()){const i=function(){Aq||(Aq=new Set);const t=globalThis;return t.$hotReload_applyNewExports||(t.$hotReload_applyNewExports=t=>{const i={config:{mode:void 0},...t};for(const t of Aq){const e=t(i);if(e)return e}}),Aq}();return i.add(t),{dispose(){i.delete(t)}}}return{dispose(){}}}let Aq;function Mq(t,i){const e=new Ji,s=t.createDecorationsCollection();return e.add(JB({debugName:()=>`Apply decorations from ${i.debugName}`},(t=>{const e=i.read(t);s.set(e)}))),e.add({dispose:()=>{s.clear()}}),e}function Lq(t,i){return t.appendChild(i),Zi((()=>{t.removeChild(i)}))}Dq()&&Eq((({oldExports:t,newSrc:i,config:e})=>{if(e.mode==="patch-prototype")return i=>{var e,s;for(const n in i){const r=i[n];if(console.log(`[hot-reload] Patching prototype methods of '${n}'`,{exportedItem:r}),typeof r=="function"&&r.prototype){const o=t[n];if(o){for(const t of Object.getOwnPropertyNames(r.prototype)){const i=Object.getOwnPropertyDescriptor(r.prototype,t),h=Object.getOwnPropertyDescriptor(o.prototype,t);((e=i==null?void 0:i.value)===null||e===void 0?void 0:e.toString())!==((s=h==null?void 0:h.value)===null||s===void 0?void 0:s.toString())&&console.log(`[hot-reload] Patching prototype method '${n}.${t}'`),Object.defineProperty(o.prototype,t,i)}i[n]=o}}}return!0}}));class Fq extends Qi{get width(){return this._width}get height(){return this._height}constructor(t,i){super(),this.elementSizeObserver=this._register(new dw(t,i)),this._width=$B(this,this.elementSizeObserver.getWidth()),this._height=$B(this,this.elementSizeObserver.getHeight()),this._register(this.elementSizeObserver.onDidChange((t=>_B((t=>{this._width.set(this.elementSizeObserver.getWidth(),t),this._height.set(this.elementSizeObserver.getHeight(),t)})))))}observe(t){this.elementSizeObserver.observe(t)}setAutomaticLayout(t){t?this.elementSizeObserver.startObserving():this.elementSizeObserver.stopObserving()}}function Tq(t,i,e){let s=i.get(),n=s,r=s;const o=$B("animatedValue",s);let h=-1,c;function l(){const i=Date.now()-h;var e,a,u,d;r=Math.floor((a=n,u=s-n,(e=i)===(d=300)?a+u:u*(1-Math.pow(2,-10*e/d))+a)),i<300?c=t.requestAnimationFrame(l):r=s,o.set(r,void 0)}return e.add(QB({createEmptyChangeSummary:()=>({animate:!1}),handleChange:(t,e)=>(t.didChange(i)&&(e.animate=e.animate||t.change),!0)},((e,o)=>{c!==void 0&&(t.cancelAnimationFrame(c),c=void 0),n=r,s=i.read(e),h=Date.now()-(o.animate?0:300),l()}))),o}class Rq extends Qi{constructor(t,i,e){super(),this._register(new Iq(t,e)),this._register(_q(e,{height:i.actualHeight,top:i.actualTop}))}}class Oq{get afterLineNumber(){return this._afterLineNumber.get()}constructor(t,i){this._afterLineNumber=t,this.heightInPx=i,this.domNode=document.createElement("div"),this._actualTop=$B(this,void 0),this._actualHeight=$B(this,void 0),this.actualTop=this._actualTop,this.actualHeight=this._actualHeight,this.showInHiddenAreas=!0,this.onChange=this._afterLineNumber,this.onDomNodeTop=t=>{this._actualTop.set(t,void 0)},this.onComputedHeight=t=>{this._actualHeight.set(t,void 0)}}}class Iq{constructor(t,i){this._editor=t,this._domElement=i,this._overlayWidgetId="managedOverlayWidget-"+Iq._counter++,this._overlayWidget={getId:()=>this._overlayWidgetId,getDomNode:()=>this._domElement,getPosition:()=>null},this._editor.addOverlayWidget(this._overlayWidget)}dispose(){this._editor.removeOverlayWidget(this._overlayWidget)}}function _q(t,i){return ZB((e=>{for(let[s,n]of Object.entries(i))n&&typeof n=="object"&&"read"in n&&(n=n.read(e)),typeof n=="number"&&(n=`${n}px`),s=s.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase())),t.style[s]=n}))}function Pq(t,i){return function(t,i){Dq()&&n$("reload",(i=>Eq((({oldExports:e})=>{if([...Object.values(e)].some((i=>t.includes(i))))return t=>(i(void 0),!0)})))).read(i)}([t],i),t}function Nq(t,i,e,s){const n=new Ji,r=[];return n.add(YB(((n,o)=>{const h=i.read(n),c=new Map,l=new Map;e&&e(!0),t.changeViewZones((t=>{for(const i of r)t.removeZone(i),s==null||s.delete(i);r.length=0;for(const i of h){const e=t.addZone(i);i.setZoneId&&i.setZoneId(e),r.push(e),s==null||s.add(e),c.set(i,e)}})),e&&e(!1),o.add(QB({createEmptyChangeSummary:()=>({zoneIds:[]}),handleChange(t,i){const e=l.get(t.changedObservable);return e!==void 0&&i.zoneIds.push(e),!0}},((i,s)=>{for(const t of h)t.onChange&&(l.set(t.onChange,c.get(t)),t.onChange.read(i));e&&e(!0),t.changeViewZones((t=>{for(const i of s.zoneIds)t.layoutZone(i)})),e&&e(!1)})))}))),n.add({dispose(){e&&e(!0),t.changeViewZones((t=>{for(const i of r)t.removeZone(i)})),s==null||s.clear(),e&&e(!1)}}),n}Iq._counter=0;class Bq extends ye{dispose(){super.dispose(!0)}}function $q(t,i){const e=yg(i,(i=>i.original.startLineNumber<=t.lineNumber));if(!e)return Cs.fromPositions(t);if(e.original.endLineNumberExclusive<=t.lineNumber){const i=t.lineNumber-e.original.endLineNumberExclusive+e.modified.endLineNumberExclusive;return Cs.fromPositions(new ks(i,t.column))}if(!e.innerChanges)return Cs.fromPositions(new ks(e.modified.startLineNumber,1));const s=yg(e.innerChanges,(i=>i.originalRange.getStartPosition().isBeforeOrEqual(t)));if(!s){const i=t.lineNumber-e.original.startLineNumber+e.modified.startLineNumber;return Cs.fromPositions(new ks(i,t.column))}if(s.originalRange.containsPosition(t))return s.modifiedRange;{const i=(n=s.originalRange.getEndPosition(),r=t,n.lineNumber===r.lineNumber?new eA(0,r.column-n.column):new eA(r.lineNumber-n.lineNumber,r.column-1));return Cs.fromPositions(i.addToPosition(s.modifiedRange.getEndPosition()))}var n,r}function Wq(t,i,e){const s=t.bindTo(i);return JB({debugName:()=>`Set Context Key "${t.key}"`},(t=>{s.set(e(t))}))}var jq=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Hq=function(t,i){return function(e,s){i(e,s,t)}};const Vq=qU("diff-review-insert",As.add,tt(0,"Icon for 'Insert' in accessible diff viewer.")),zq=qU("diff-review-remove",As.remove,tt(0,"Icon for 'Remove' in accessible diff viewer.")),Uq=qU("diff-review-close",As.close,tt(0,"Icon for 'Close' in accessible diff viewer."));let Kq=class extends Qi{constructor(t,i,e,s,n,r,o,h,c){super(),this._parentNode=t,this._visible=i,this._setVisible=e,this._canClose=s,this._width=n,this._height=r,this._diffs=o,this._models=h,this._instantiationService=c,this._state=KB(this,((t,i)=>{const e=this._visible.read(t);if(this._parentNode.style.visibility=e?"visible":"hidden",!e)return null;const s=i.add(this._instantiationService.createInstance(qq,this._diffs,this._models,this._setVisible,this._canClose));return{model:s,view:i.add(this._instantiationService.createInstance(iG,this._parentNode,s,this._width,this._height,this._models))}})).recomputeInitiallyAndOnChange(this._store)}next(){_B((t=>{const i=this._visible.get();this._setVisible(!0,t),i&&this._state.get().model.nextGroup(t)}))}prev(){_B((t=>{this._setVisible(!0,t),this._state.get().model.previousGroup(t)}))}close(){_B((t=>{this._setVisible(!1,t)}))}};Kq._ttPolicy=ju("diffReview",{createHTML:t=>t}),Kq=jq([Hq(8,Il)],Kq);let qq=class extends Qi{constructor(t,i,e,s,n){super(),this._diffs=t,this._models=i,this._setVisible=e,this.canClose=s,this._accessibilitySignalService=n,this._groups=$B(this,[]),this._currentGroupIdx=$B(this,0),this._currentElementIdx=$B(this,0),this.groups=this._groups,this.currentGroup=this._currentGroupIdx.map(((t,i)=>this._groups.read(i)[t])),this.currentGroupIndex=this._currentGroupIdx,this.currentElement=this._currentElementIdx.map(((t,i)=>{var e;return(e=this.currentGroup.read(i))===null||e===void 0?void 0:e.lines[t]})),this._register(ZB((t=>{const i=this._diffs.read(t);if(!i)return void this._groups.set([],void 0);const e=function(t,i,e){const s=[];for(const n of c(t,((t,i)=>i.modified.startLineNumber-t.modified.endLineNumberExclusive<2*Gq))){const t=[];t.push(new Qq);const r=new Ag(Math.max(1,n[0].original.startLineNumber-Gq),Math.min(n[n.length-1].original.endLineNumberExclusive+Gq,i+1)),o=new Ag(Math.max(1,n[0].modified.startLineNumber-Gq),Math.min(n[n.length-1].modified.endLineNumberExclusive+Gq,e+1));l(n,((i,e)=>{const s=new Ag(i?i.original.endLineNumberExclusive:r.startLineNumber,e?e.original.startLineNumber:r.endLineNumberExclusive),n=new Ag(i?i.modified.endLineNumberExclusive:o.startLineNumber,e?e.modified.startLineNumber:o.endLineNumberExclusive);s.forEach((i=>{t.push(new tG(i,n.startLineNumber+(i-s.startLineNumber)))})),e&&(e.original.forEach((i=>{t.push(new Yq(e,i))})),e.modified.forEach((i=>{t.push(new Xq(e,i))})))}));const h=n[0].modified.join(n[n.length-1].modified),c=n[0].original.join(n[n.length-1].original);s.push(new Jq(new Lg(h,c),t))}return s}(i,this._models.getOriginalModel().getLineCount(),this._models.getModifiedModel().getLineCount());_B((t=>{const i=this._models.getModifiedPosition();if(i){const s=e.findIndex((t=>(i==null?void 0:i.lineNumber)<t.range.modified.endLineNumberExclusive));s!==-1&&this._currentGroupIdx.set(s,t)}this._groups.set(e,t)}))}))),this._register(ZB((t=>{const i=this.currentElement.read(t);(i==null?void 0:i.type)===Zq.Deleted?this._accessibilitySignalService.playSignal(tq.diffLineDeleted,{source:"accessibleDiffViewer.currentElementChanged"}):(i==null?void 0:i.type)===Zq.Added&&this._accessibilitySignalService.playSignal(tq.diffLineInserted,{source:"accessibleDiffViewer.currentElementChanged"})}))),this._register(ZB((t=>{var i;const e=this.currentElement.read(t);if(e&&e.type!==Zq.Header){const t=(i=e.modifiedLineNumber)!==null&&i!==void 0?i:e.diff.modified.startLineNumber;this._models.modifiedSetSelection(Cs.fromPositions(new ks(t,1)))}})))}_goToGroupDelta(t,i){const e=this.groups.get();!e||e.length<=1||NB(i,(i=>{this._currentGroupIdx.set(vg.ofLength(e.length).clipCyclic(this._currentGroupIdx.get()+t),i),this._currentElementIdx.set(0,i)}))}nextGroup(t){this._goToGroupDelta(1,t)}previousGroup(t){this._goToGroupDelta(-1,t)}_goToLineDelta(t){const i=this.currentGroup.get();!i||i.lines.length<=1||_B((e=>{this._currentElementIdx.set(vg.ofLength(i.lines.length).clip(this._currentElementIdx.get()+t),e)}))}goToNextLine(){this._goToLineDelta(1)}goToPreviousLine(){this._goToLineDelta(-1)}goToLine(t){const i=this.currentGroup.get();if(!i)return;const e=i.lines.indexOf(t);e!==-1&&_B((t=>{this._currentElementIdx.set(e,t)}))}revealCurrentElementInEditor(){if(!this.canClose.get())return;this._setVisible(!1,void 0);const t=this.currentElement.get();t&&(t.type===Zq.Deleted?this._models.originalReveal(Cs.fromPositions(new ks(t.originalLineNumber,1))):this._models.modifiedReveal(t.type!==Zq.Header?Cs.fromPositions(new ks(t.modifiedLineNumber,1)):void 0))}close(){this.canClose.get()&&(this._setVisible(!1,void 0),this._models.modifiedFocus())}};qq=jq([Hq(4,QK)],qq);const Gq=3;var Zq;(function(t){t[t.Header=0]="Header",t[t.Unchanged=1]="Unchanged",t[t.Deleted=2]="Deleted",t[t.Added=3]="Added"})(Zq||(Zq={}));class Jq{constructor(t,i){this.range=t,this.lines=i}}class Qq{constructor(){this.type=Zq.Header}}class Yq{constructor(t,i){this.diff=t,this.originalLineNumber=i,this.type=Zq.Deleted,this.modifiedLineNumber=void 0}}class Xq{constructor(t,i){this.diff=t,this.modifiedLineNumber=i,this.type=Zq.Added,this.originalLineNumber=void 0}}class tG{constructor(t,i){this.originalLineNumber=t,this.modifiedLineNumber=i,this.type=Zq.Unchanged}}let iG=class extends Qi{constructor(t,i,e,s,n,r){super(),this._element=t,this._model=i,this._width=e,this._height=s,this._models=n,this._languageService=r,this.domNode=this._element,this.domNode.className="monaco-component diff-review monaco-editor-background";const o=document.createElement("div");o.className="diff-review-actions",this._actionBar=this._register(new LW(o)),this._register(ZB((t=>{this._actionBar.clear(),this._model.canClose.read(t)&&this._actionBar.push(new $l("diffreview.close",tt(0,"Close"),"close-diff-review "+Kl.asClassName(Uq),!0,(async()=>i.close())),{label:!1,icon:!0})}))),this._content=document.createElement("div"),this._content.className="diff-review-content",this._content.setAttribute("role","code"),this._scrollbar=this._register(new rC(this._content,{})),tl(this.domNode,this._scrollbar.getDomNode(),o),this._register(ZB((t=>{this._height.read(t),this._width.read(t),this._scrollbar.scanDomNode()}))),this._register(Zi((()=>{tl(this.domNode)}))),this._register(_q(this.domNode,{width:this._width,height:this._height})),this._register(_q(this._content,{width:this._width,height:this._height})),this._register(YB(((t,i)=>{this._model.currentGroup.read(t),this._render(i)}))),this._register(rc(this.domNode,"keydown",(t=>{(t.equals(18)||t.equals(2066)||t.equals(530))&&(t.preventDefault(),this._model.goToNextLine()),(t.equals(16)||t.equals(2064)||t.equals(528))&&(t.preventDefault(),this._model.goToPreviousLine()),(t.equals(9)||t.equals(2057)||t.equals(521)||t.equals(1033))&&(t.preventDefault(),this._model.close()),(t.equals(10)||t.equals(3))&&(t.preventDefault(),this._model.revealCurrentElementInEditor())})))}_render(t){const i=this._models.getOriginalOptions(),e=this._models.getModifiedOptions(),s=document.createElement("div");s.className="diff-review-table",s.setAttribute("role","list"),s.setAttribute("aria-label",tt(0,"Accessible Diff Viewer. Use arrow up and down to navigate.")),xl(s,e.get(50)),tl(this._content,s);const n=this._models.getOriginalModel(),r=this._models.getModifiedModel();if(!n||!r)return;const o=n.getOptions(),h=r.getOptions(),c=e.get(67),l=this._model.currentGroup.get();for(const a of(l==null?void 0:l.lines)||[]){if(!l)break;let u;if(a.type===Zq.Header){const t=document.createElement("div");t.className="diff-review-row",t.setAttribute("role","listitem");const i=l.range,e=this._model.currentGroupIndex.get(),s=this._model.groups.get().length,n=t=>t===0?tt(0,"no lines changed"):t===1?tt(0,"1 line changed"):tt(0,"{0} lines changed",t),r=n(i.original.length),o=n(i.modified.length);t.setAttribute("aria-label",tt(0,"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",e+1,s,i.original.startLineNumber,r,i.modified.startLineNumber,o));const h=document.createElement("div");h.className="diff-review-cell diff-review-summary",h.appendChild(document.createTextNode(`${e+1}/${s}: @@ -${i.original.startLineNumber},${i.original.length} +${i.modified.startLineNumber},${i.modified.length} @@`)),t.appendChild(h),u=t}else u=this._createRow(a,c,this._width.get(),i,n,o,e,r,h);s.appendChild(u);const d=zB((t=>this._model.currentElement.read(t)===a));t.add(ZB((t=>{const i=d.read(t);u.tabIndex=i?0:-1,i&&u.focus()}))),t.add(sc(u,"focus",(()=>{this._model.goToLine(a)})))}this._scrollbar.scanDomNode()}_createRow(t,i,e,s,n,r,o,h,c){const l=s.get(145),a=l.glyphMarginWidth+l.lineNumbersWidth,u=o.get(145),d=10+u.glyphMarginWidth+u.lineNumbersWidth;let f="diff-review-row",g="",p=null;switch(t.type){case Zq.Added:f="diff-review-row line-insert",g=" char-insert",p=Vq;break;case Zq.Deleted:f="diff-review-row line-delete",g=" char-delete",p=zq}const m=document.createElement("div");m.style.minWidth=e+"px",m.className=f,m.setAttribute("role","listitem"),m.ariaLevel="";const w=document.createElement("div");w.className="diff-review-cell",w.style.height=`${i}px`,m.appendChild(w);const v=document.createElement("span");v.style.width=a+"px",v.style.minWidth=a+"px",v.className="diff-review-line-number"+g,t.originalLineNumber!==void 0?v.appendChild(document.createTextNode(String(t.originalLineNumber))):v.innerText=" ",w.appendChild(v);const b=document.createElement("span");b.style.width=d+"px",b.style.minWidth=d+"px",b.style.paddingRight="10px",b.className="diff-review-line-number"+g,t.modifiedLineNumber!==void 0?b.appendChild(document.createTextNode(String(t.modifiedLineNumber))):b.innerText=" ",w.appendChild(b);const y=document.createElement("span");if(y.className="diff-review-spacer",p){const t=document.createElement("span");t.className=Kl.asClassName(p),t.innerText="  ",y.appendChild(t)}else y.innerText="  ";let k;if(w.appendChild(y),t.modifiedLineNumber!==void 0){let i=this._getLineHtml(h,o,c.tabSize,t.modifiedLineNumber,this._languageService.languageIdCodec);Kq._ttPolicy&&(i=Kq._ttPolicy.createHTML(i)),w.insertAdjacentHTML("beforeend",i),k=h.getLineContent(t.modifiedLineNumber)}else{let i=this._getLineHtml(n,s,r.tabSize,t.originalLineNumber,this._languageService.languageIdCodec);Kq._ttPolicy&&(i=Kq._ttPolicy.createHTML(i)),w.insertAdjacentHTML("beforeend",i),k=n.getLineContent(t.originalLineNumber)}k.length===0&&(k=tt(0,"blank"));let C="";switch(t.type){case Zq.Unchanged:C=t.originalLineNumber===t.modifiedLineNumber?tt(0,"{0} unchanged line {1}",k,t.originalLineNumber):tt(0,"{0} original line {1} modified line {2}",k,t.originalLineNumber,t.modifiedLineNumber);break;case Zq.Added:C=tt(0,"+ {0} modified line {1}",k,t.modifiedLineNumber);break;case Zq.Deleted:C=tt(0,"- {0} original line {1}",k,t.originalLineNumber)}return m.setAttribute("aria-label",C),m}_getLineHtml(t,i,e,s,n){const r=t.getLineContent(s),o=i.get(50),h=sm.createEmpty(r,n),c=xm.isBasicASCII(r,t.mightContainNonBasicASCII()),l=xm.containsRTL(r,c,t.mightContainRTL());return wm(new um(o.isMonospace&&!i.get(33),o.canUseHalfwidthRightwardsArrow,r,!1,c,l,0,h,[],e,0,o.spaceWidth,o.middotWidth,o.wsmiddotWidth,i.get(117),i.get(99),i.get(94),i.get(51)!==gi.OFF,null)).html}};iG=jq([Hq(5,Id)],iG);class eG{constructor(t){this.editors=t}getOriginalModel(){return this.editors.original.getModel()}getOriginalOptions(){return this.editors.original.getOptions()}originalReveal(t){this.editors.original.revealRange(t),this.editors.original.setSelection(t),this.editors.original.focus()}getModifiedModel(){return this.editors.modified.getModel()}getModifiedOptions(){return this.editors.modified.getOptions()}modifiedReveal(t){t&&(this.editors.modified.revealRange(t),this.editors.modified.setSelection(t)),this.editors.modified.focus()}modifiedSetSelection(t){this.editors.modified.setSelection(t)}modifiedFocus(){this.editors.modified.focus()}getModifiedPosition(){var t;return(t=this.editors.modified.getPosition())!==null&&t!==void 0?t:void 0}}class sG extends Qi{constructor(t,i,e,s,n){super(),this._rootElement=t,this._diffModel=i,this._originalEditorLayoutInfo=e,this._modifiedEditorLayoutInfo=s,this._editors=n,this._originalScrollTop=e$(this._editors.original.onDidScrollChange,(()=>this._editors.original.getScrollTop())),this._modifiedScrollTop=e$(this._editors.modified.onDidScrollChange,(()=>this._editors.modified.getScrollTop())),this._viewZonesChanged=n$("onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this.width=$B(this,0),this._modifiedViewZonesChangedSignal=n$("modified.onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this._originalViewZonesChangedSignal=n$("original.onDidChangeViewZones",this._editors.original.onDidChangeViewZones),this._state=KB(this,((t,i)=>{var e;this._element.replaceChildren();const s=this._diffModel.read(t),n=(e=s==null?void 0:s.diff.read(t))===null||e===void 0?void 0:e.movedTexts;if(!n||n.length===0)return void this.width.set(0,void 0);this._viewZonesChanged.read(t);const r=this._originalEditorLayoutInfo.read(t),o=this._modifiedEditorLayoutInfo.read(t);if(!r||!o)return void this.width.set(0,void 0);this._modifiedViewZonesChangedSignal.read(t),this._originalViewZonesChangedSignal.read(t);const h=n.map((i=>{function e(t,i){return(i.getTopForLineNumber(t.startLineNumber,!0)+i.getTopForLineNumber(t.endLineNumberExclusive,!0))/2}const s=e(i.lineRangeMapping.original,this._editors.original),n=this._originalScrollTop.read(t),r=e(i.lineRangeMapping.modified,this._editors.modified),o=s-n,h=r-this._modifiedScrollTop.read(t),c=Math.min(s,r),l=Math.max(s,r);return{range:new vg(c,l),from:o,to:h,fromWithoutScroll:s,toWithoutScroll:r,move:i}}));h.sort(function(...t){return(i,e)=>{for(const s of t){const t=s(i,e);if(!x.isNeitherLessOrGreaterThan(t))return t}return x.neitherLessOrGreaterThan}}(D((t=>t.fromWithoutScroll>t.toWithoutScroll),A),D((t=>t.fromWithoutScroll>t.toWithoutScroll?t.fromWithoutScroll:-t.toWithoutScroll),E)));const c=nG.compute(h.map((t=>t.range))),l=r.verticalScrollbarWidth,a=10*(c.getTrackCount()-1)+20,u=l+a+(o.contentLeft-sG.movedCodeBlockPadding);let d=0;for(const t of h){const e=l+10+10*c.getTrack(d),n=15,r=15,h=u,a=o.glyphMarginWidth+o.lineNumbersWidth,f=18,g=document.createElementNS("http://www.w3.org/2000/svg","rect");g.classList.add("arrow-rectangle"),g.setAttribute("x",""+(h-a)),g.setAttribute("y",""+(t.to-f/2)),g.setAttribute("width",`${a}`),g.setAttribute("height",`${f}`),this._element.appendChild(g);const p=document.createElementNS("http://www.w3.org/2000/svg","g"),m=document.createElementNS("http://www.w3.org/2000/svg","path");m.setAttribute("d",`M 0 ${t.from} L ${e} ${t.from} L ${e} ${t.to} L ${h-r} ${t.to}`),m.setAttribute("fill","none"),p.appendChild(m);const w=document.createElementNS("http://www.w3.org/2000/svg","polygon");w.classList.add("arrow"),i.add(ZB((i=>{m.classList.toggle("currentMove",t.move===s.activeMovedText.read(i)),w.classList.toggle("currentMove",t.move===s.activeMovedText.read(i))}))),w.setAttribute("points",`${h-r},${t.to-n/2} ${h},${t.to} ${h-r},${t.to+n/2}`),p.appendChild(w),this._element.appendChild(p),d++}this.width.set(a,void 0)})),this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("class","moved-blocks-lines"),this._rootElement.appendChild(this._element),this._register(Zi((()=>this._element.remove()))),this._register(ZB((t=>{const i=this._originalEditorLayoutInfo.read(t),e=this._modifiedEditorLayoutInfo.read(t);i&&e&&(this._element.style.left=i.width-i.verticalScrollbarWidth+"px",this._element.style.height=`${i.height}px`,this._element.style.width=`${i.verticalScrollbarWidth+i.contentLeft-sG.movedCodeBlockPadding+this.width.read(t)}px`)}))),this._register(c$(this._state));const r=zB((t=>{const i=this._diffModel.read(t),e=i==null?void 0:i.diff.read(t);return e?e.movedTexts.map((t=>({move:t,original:new Oq(t$(t.lineRangeMapping.original.startLineNumber-1),18),modified:new Oq(t$(t.lineRangeMapping.modified.startLineNumber-1),18)}))):[]}));this._register(Nq(this._editors.original,r.map((t=>t.map((t=>t.original)))))),this._register(Nq(this._editors.modified,r.map((t=>t.map((t=>t.modified)))))),this._register(YB(((t,i)=>{const e=r.read(t);for(const t of e)i.add(new rG(this._editors.original,t.original,t.move,"original",this._diffModel.get())),i.add(new rG(this._editors.modified,t.modified,t.move,"modified",this._diffModel.get()))})));const o=n$("original.onDidFocusEditorWidget",(t=>this._editors.original.onDidFocusEditorWidget((()=>setTimeout((()=>t(void 0)),0))))),h=n$("modified.onDidFocusEditorWidget",(t=>this._editors.modified.onDidFocusEditorWidget((()=>setTimeout((()=>t(void 0)),0)))));let c="modified";this._register(QB({createEmptyChangeSummary:()=>{},handleChange:(t,i)=>(t.didChange(o)&&(c="original"),t.didChange(h)&&(c="modified"),!0)},(t=>{o.read(t),h.read(t);const i=this._diffModel.read(t);if(!i)return;const e=i.diff.read(t);let s;if(e&&c==="original"){const i=this._editors.originalCursor.read(t);i&&(s=e.movedTexts.find((t=>t.lineRangeMapping.original.contains(i.lineNumber))))}if(e&&c==="modified"){const i=this._editors.modifiedCursor.read(t);i&&(s=e.movedTexts.find((t=>t.lineRangeMapping.modified.contains(i.lineNumber))))}s!==i.movedTextToCompare.get()&&i.movedTextToCompare.set(void 0,void 0),i.setActiveMovedText(s)})))}}sG.movedCodeBlockPadding=4;class nG{static compute(t){const i=[],e=[];for(const s of t){let t=i.findIndex((t=>!t.intersectsStrict(s)));t===-1&&(i.length>=6?t=Eg(i,D((t=>t.intersectWithRangeLength(s)),E)):(t=i.length,i.push(new bg))),i[t].addRange(s),e.push(t)}return new nG(i.length,e)}constructor(t,i){this._trackCount=t,this.trackPerLineIdx=i}getTrack(t){return this.trackPerLineIdx[t]}getTrackCount(){return this._trackCount}}class rG extends Rq{constructor(t,i,e,s,n){const r=ml("div.diff-hidden-lines-widget");super(t,i,r.root),this._editor=t,this._move=e,this._kind=s,this._diffModel=n,this._nodes=ml("div.diff-moved-code-block",{style:{marginRight:"4px"}},[ml("div.text-content@textContent"),ml("div.action-bar@actionBar")]),r.root.appendChild(this._nodes.root);const o=e$(this._editor.onDidLayoutChange,(()=>this._editor.getLayoutInfo()));let h;this._register(_q(this._nodes.root,{paddingRight:o.map((t=>t.verticalScrollbarWidth))})),h=e.changes.length>0?this._kind==="original"?tt(0,"Code moved with changes to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):tt(0,"Code moved with changes from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1):this._kind==="original"?tt(0,"Code moved to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):tt(0,"Code moved from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1);const c=this._register(new LW(this._nodes.actionBar,{highlightToggledItems:!0})),l=new $l("",h,"",!1);c.push(l,{icon:!1,label:!0});const a=new $l("","Compare",Kl.asClassName(As.compareChanges),!0,(()=>{this._editor.focus(),this._diffModel.movedTextToCompare.set(this._diffModel.movedTextToCompare.get()===e?void 0:this._move,void 0)}));this._register(ZB((t=>{const i=this._diffModel.movedTextToCompare.read(t)===e;a.checked=i}))),c.push(a,{icon:!1,label:!0})}}Iw("diffEditor.move.border",{dark:"#8b8b8b9c",light:"#8b8b8b9c",hcDark:"#8b8b8b9c",hcLight:"#8b8b8b9c"},tt(0,"The border color for text that got moved in the diff editor.")),Iw("diffEditor.moveActive.border",{dark:"#FFA500",light:"#FFA500",hcDark:"#FFA500",hcLight:"#FFA500"},tt(0,"The active border color for text that got moved in the diff editor.")),Iw("diffEditor.unchangedRegionShadow",{dark:"#000000",light:"#737373BF",hcDark:"#000000",hcLight:"#737373BF"},tt(0,"The color of the shadow around unchanged region widgets."));const oG=qU("diff-insert",As.add,tt(0,"Line decoration for inserts in the diff editor.")),hG=qU("diff-remove",As.remove,tt(0,"Line decoration for removals in the diff editor.")),cG=xF.register({className:"line-insert",description:"line-insert",isWholeLine:!0,linesDecorationsClassName:"insert-sign "+Kl.asClassName(oG),marginClassName:"gutter-insert"}),lG=xF.register({className:"line-delete",description:"line-delete",isWholeLine:!0,linesDecorationsClassName:"delete-sign "+Kl.asClassName(hG),marginClassName:"gutter-delete"}),aG=xF.register({className:"line-insert",description:"line-insert",isWholeLine:!0,marginClassName:"gutter-insert"}),uG=xF.register({className:"line-delete",description:"line-delete",isWholeLine:!0,marginClassName:"gutter-delete"}),dG=xF.register({className:"char-insert",description:"char-insert",shouldFillLineOnLineBreak:!0}),fG=xF.register({className:"char-insert",description:"char-insert",isWholeLine:!0}),gG=xF.register({className:"char-insert diff-range-empty",description:"char-insert diff-range-empty"}),pG=xF.register({className:"char-delete",description:"char-delete",shouldFillLineOnLineBreak:!0}),mG=xF.register({className:"char-delete",description:"char-delete",isWholeLine:!0}),wG=xF.register({className:"char-delete diff-range-empty",description:"char-delete diff-range-empty"});class vG extends Qi{constructor(t,i,e,s){super(),this._editors=t,this._diffModel=i,this._options=e,this._decorations=zB(this,(t=>{var i;const e=(i=this._diffModel.read(t))===null||i===void 0?void 0:i.diff.read(t);if(!e)return null;const s=this._diffModel.read(t).movedTextToCompare.read(t),n=this._options.renderIndicators.read(t),r=this._options.showEmptyDecorations.read(t),o=[],h=[];if(!s)for(const t of e.mappings)if(t.lineRangeMapping.original.isEmpty||o.push({range:t.lineRangeMapping.original.toInclusiveRange(),options:n?lG:uG}),t.lineRangeMapping.modified.isEmpty||h.push({range:t.lineRangeMapping.modified.toInclusiveRange(),options:n?cG:aG}),t.lineRangeMapping.modified.isEmpty||t.lineRangeMapping.original.isEmpty)t.lineRangeMapping.original.isEmpty||o.push({range:t.lineRangeMapping.original.toInclusiveRange(),options:mG}),t.lineRangeMapping.modified.isEmpty||h.push({range:t.lineRangeMapping.modified.toInclusiveRange(),options:fG});else for(const i of t.lineRangeMapping.innerChanges||[])t.lineRangeMapping.original.contains(i.originalRange.startLineNumber)&&o.push({range:i.originalRange,options:i.originalRange.isEmpty()&&r?wG:pG}),t.lineRangeMapping.modified.contains(i.modifiedRange.startLineNumber)&&h.push({range:i.modifiedRange,options:i.modifiedRange.isEmpty()&&r?gG:dG});if(s)for(const t of s.changes){const i=t.original.toInclusiveRange();i&&o.push({range:i,options:n?lG:uG});const e=t.modified.toInclusiveRange();e&&h.push({range:e,options:n?cG:aG});for(const i of t.innerChanges||[])o.push({range:i.originalRange,options:pG}),h.push({range:i.modifiedRange,options:dG})}const c=this._diffModel.read(t).activeMovedText.read(t);for(const t of e.movedTexts)o.push({range:t.lineRangeMapping.original.toInclusiveRange(),options:{description:"moved",blockClassName:"movedOriginal"+(t===c?" currentMove":""),blockPadding:[sG.movedCodeBlockPadding,0,sG.movedCodeBlockPadding,sG.movedCodeBlockPadding]}}),h.push({range:t.lineRangeMapping.modified.toInclusiveRange(),options:{description:"moved",blockClassName:"movedModified"+(t===c?" currentMove":""),blockPadding:[4,0,4,4]}});return{originalDecorations:o,modifiedDecorations:h}})),this._register(Mq(this._editors.original,this._decorations.map((t=>(t==null?void 0:t.originalDecorations)||[])))),this._register(Mq(this._editors.modified,this._decorations.map((t=>(t==null?void 0:t.modifiedDecorations)||[]))))}}class bG extends Qi{constructor(t,i,e,s){super(),this._options=t,this._domNode=i,this._dimensions=e,this._sashes=s,this._sashRatio=$B(this,void 0),this.sashLeft=zB(this,(t=>{var i;const e=(i=this._sashRatio.read(t))!==null&&i!==void 0?i:this._options.splitViewDefaultRatio.read(t);return this._computeSashLeft(e,t)})),this._sash=this._register(new jj(this._domNode,{getVerticalSashTop:t=>0,getVerticalSashLeft:t=>this.sashLeft.get(),getVerticalSashHeight:t=>this._dimensions.height.get()},{orientation:0})),this._startSashPosition=void 0,this._register(this._sash.onDidStart((()=>{this._startSashPosition=this.sashLeft.get()}))),this._register(this._sash.onDidChange((t=>{const i=this._dimensions.width.get(),e=this._computeSashLeft((this._startSashPosition+(t.currentX-t.startX))/i,void 0);this._sashRatio.set(e/i,void 0)}))),this._register(this._sash.onDidEnd((()=>this._sash.layout()))),this._register(this._sash.onDidReset((()=>this._sashRatio.set(void 0,void 0)))),this._register(ZB((t=>{const i=this._sashes.read(t);i&&(this._sash.orthogonalEndSash=i.bottom)}))),this._register(ZB((t=>{const i=this._options.enableSplitViewResizing.read(t);this._sash.state=i?3:0,this.sashLeft.read(t),this._dimensions.height.read(t),this._sash.layout()})))}_computeSashLeft(t,i){const e=this._dimensions.width.read(i),s=Math.floor(this._options.splitViewDefaultRatio.read(i)*e),n=this._options.enableSplitViewResizing.read(i)?Math.floor(t*e):s,r=100;return e<=200?s:n<r?r:n>e-r?e-r:n}}var yG,kG=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},CG=function(t,i){return function(e,s){i(e,s,t)}};const SG=_l("diffProviderFactoryService");let xG=class{constructor(t){this.instantiationService=t}createDiffProvider(t){return this.instantiationService.createInstance(DG,t)}};xG=kG([CG(0,Il)],xG),Nd(SG,xG,1);let DG=yG=class{constructor(t,i,e){this.editorWorkerService=i,this.telemetryService=e,this.onDidChangeEventEmitter=new le,this.onDidChange=this.onDidChangeEventEmitter.event,this.diffAlgorithm="advanced",this.diffAlgorithmOnDidChangeSubscription=void 0,this.setOptions(t)}dispose(){var t;(t=this.diffAlgorithmOnDidChangeSubscription)===null||t===void 0||t.dispose()}async computeDiff(t,i,e,s){var n,r;if(typeof this.diffAlgorithm!="string")return this.diffAlgorithm.computeDiff(t,i,e,s);if(t.getLineCount()===1&&t.getLineMaxColumn(1)===1)return i.getLineCount()===1&&i.getLineMaxColumn(1)===1?{changes:[],identical:!0,quitEarly:!1,moves:[]}:{changes:[new Fg(new Ag(1,2),new Ag(1,i.getLineCount()+1),[new Tg(t.getFullModelRange(),i.getFullModelRange())])],identical:!1,quitEarly:!1,moves:[]};const o=JSON.stringify([t.uri.toString(),i.uri.toString()]),h=JSON.stringify([t.id,i.id,t.getAlternativeVersionId(),i.getAlternativeVersionId(),JSON.stringify(e)]),c=yG.diffCache.get(o);if(c&&c.context===h)return c.result;const l=se.create(),a=await this.editorWorkerService.computeDiff(t.uri,i.uri,e,this.diffAlgorithm),u=l.elapsed();if(this.telemetryService.publicLog2("diffEditor.computeDiff",{timeMs:u,timedOut:(n=a==null?void 0:a.quitEarly)===null||n===void 0||n,detectedMoves:e.computeMoves?(r=a==null?void 0:a.moves.length)!==null&&r!==void 0?r:0:-1}),s.isCancellationRequested)return{changes:[],identical:!1,quitEarly:!0,moves:[]};if(!a)throw new Error("no diff result available");return yG.diffCache.size>10&&yG.diffCache.delete(yG.diffCache.keys().next().value),yG.diffCache.set(o,{result:a,context:h}),a}setOptions(t){var i;let e=!1;t.diffAlgorithm&&this.diffAlgorithm!==t.diffAlgorithm&&((i=this.diffAlgorithmOnDidChangeSubscription)===null||i===void 0||i.dispose(),this.diffAlgorithmOnDidChangeSubscription=void 0,this.diffAlgorithm=t.diffAlgorithm,typeof t.diffAlgorithm!="string"&&(this.diffAlgorithmOnDidChangeSubscription=t.diffAlgorithm.onDidChange((()=>this.onDidChangeEventEmitter.fire()))),e=!0),e&&this.onDidChangeEventEmitter.fire()}};DG.diffCache=new Map,DG=yG=kG([CG(1,JW),CG(2,ru)],DG);var EG=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},AG=function(t,i){return function(e,s){i(e,s,t)}};let MG=class extends Qi{setActiveMovedText(t){this._activeMovedText.set(t,void 0)}constructor(t,i,e){super(),this.model=t,this._options=i,this._diffProviderFactoryService=e,this._isDiffUpToDate=$B(this,!1),this.isDiffUpToDate=this._isDiffUpToDate,this._diff=$B(this,void 0),this.diff=this._diff,this._unchangedRegions=$B(this,void 0),this.unchangedRegions=zB(this,(t=>{var i,e;return this._options.hideUnchangedRegions.read(t)?(e=(i=this._unchangedRegions.read(t))===null||i===void 0?void 0:i.regions)!==null&&e!==void 0?e:[]:(_B((t=>{var i;for(const e of((i=this._unchangedRegions.get())===null||i===void 0?void 0:i.regions)||[])e.collapseAll(t)})),[])})),this.movedTextToCompare=$B(this,void 0),this._activeMovedText=$B(this,void 0),this._hoveredMovedText=$B(this,void 0),this.activeMovedText=zB(this,(t=>{var i,e;return(e=(i=this.movedTextToCompare.read(t))!==null&&i!==void 0?i:this._hoveredMovedText.read(t))!==null&&e!==void 0?e:this._activeMovedText.read(t)})),this._cancellationTokenSource=new ye,this._diffProvider=zB(this,(t=>{const i=this._diffProviderFactoryService.createDiffProvider({diffAlgorithm:this._options.diffAlgorithm.read(t)});return{diffProvider:i,onChangeSignal:n$("onDidChange",i.onDidChange)}})),this._register(Zi((()=>this._cancellationTokenSource.cancel())));const s=o$("contentChangedSignal"),n=this._register(new Co((()=>s.trigger(void 0)),200));this._register(ZB((i=>{const e=this._unchangedRegions.read(i);if(!e||e.regions.some((t=>t.isDragged.read(i))))return;const s=e.originalDecorationIds.map((i=>t.original.getDecorationRange(i))).map((t=>t?Ag.fromRangeInclusive(t):void 0)),n=e.modifiedDecorationIds.map((i=>t.modified.getDecorationRange(i))).map((t=>t?Ag.fromRangeInclusive(t):void 0)),r=e.regions.map(((t,e)=>s[e]&&n[e]?new TG(s[e].startLineNumber,n[e].startLineNumber,s[e].length,t.visibleLineCountTop.read(i),t.visibleLineCountBottom.read(i)):void 0)).filter($),o=[];let h=!1;for(const t of c(r,((t,e)=>t.getHiddenModifiedRange(i).endLineNumberExclusive===e.getHiddenModifiedRange(i).startLineNumber)))if(t.length>1){h=!0;const i=t.reduce(((t,i)=>t+i.lineCount),0),e=new TG(t[0].originalLineNumber,t[0].modifiedLineNumber,i,t[0].visibleLineCountTop.get(),t[t.length-1].visibleLineCountBottom.get());o.push(e)}else o.push(t[0]);if(h){const i=t.original.deltaDecorations(e.originalDecorationIds,o.map((t=>({range:t.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})))),s=t.modified.deltaDecorations(e.modifiedDecorationIds,o.map((t=>({range:t.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))));_B((t=>{this._unchangedRegions.set({regions:o,originalDecorationIds:i,modifiedDecorationIds:s},t)}))}})));const r=(i,e,s)=>{const n=TG.fromDiffs(i.changes,t.original.getLineCount(),t.modified.getLineCount(),this._options.hideUnchangedRegionsMinimumLineCount.read(s),this._options.hideUnchangedRegionsContextLineCount.read(s));let r;const o=this._unchangedRegions.get();if(o){const i=o.originalDecorationIds.map((i=>t.original.getDecorationRange(i))).map((t=>t?Ag.fromRangeInclusive(t):void 0)),e=o.modifiedDecorationIds.map((i=>t.modified.getDecorationRange(i))).map((t=>t?Ag.fromRangeInclusive(t):void 0));let n=function(t,i){let e;return t.filter((t=>{const s=i(t,e);return e=t,s}))}(o.regions.map(((t,s)=>{if(!i[s]||!e[s])return;const n=i[s].length;return new TG(i[s].startLineNumber,e[s].startLineNumber,n,Math.min(t.visibleLineCountTop.get(),n),Math.min(t.visibleLineCountBottom.get(),n-t.visibleLineCountTop.get()))})).filter($),((t,i)=>!i||t.modifiedLineNumber>=i.modifiedLineNumber+i.lineCount&&t.originalLineNumber>=i.originalLineNumber+i.lineCount)).map((t=>new Lg(t.getHiddenOriginalRange(s),t.getHiddenModifiedRange(s))));n=Lg.clip(n,Ag.ofLength(1,t.original.getLineCount()),Ag.ofLength(1,t.modified.getLineCount())),r=Lg.inverse(n,t.original.getLineCount(),t.modified.getLineCount())}const h=[];if(r)for(const t of n){const i=r.filter((i=>i.original.intersectsStrict(t.originalUnchangedRange)&&i.modified.intersectsStrict(t.modifiedUnchangedRange)));h.push(...t.setVisibleRanges(i,e))}else h.push(...n);const c=t.original.deltaDecorations((o==null?void 0:o.originalDecorationIds)||[],h.map((t=>({range:t.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})))),l=t.modified.deltaDecorations((o==null?void 0:o.modifiedDecorationIds)||[],h.map((t=>({range:t.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))));this._unchangedRegions.set({regions:h,originalDecorationIds:c,modifiedDecorationIds:l},e)};this._register(t.modified.onDidChangeContent((t=>{if(this._diff.get()){wA.fromModelContentChanges(t.changes)}this._isDiffUpToDate.set(!1,void 0),n.schedule()}))),this._register(t.original.onDidChangeContent((t=>{if(this._diff.get()){wA.fromModelContentChanges(t.changes)}this._isDiffUpToDate.set(!1,void 0),n.schedule()}))),this._register(YB((async(i,e)=>{var o,h;this._options.hideUnchangedRegionsMinimumLineCount.read(i),this._options.hideUnchangedRegionsContextLineCount.read(i),n.cancel(),s.read(i);const c=this._diffProvider.read(i);c.onChangeSignal.read(i),Pq(fp,i),Pq(cp,i),this._isDiffUpToDate.set(!1,void 0);let l=[];e.add(t.original.onDidChangeContent((t=>{const i=wA.fromModelContentChanges(t.changes);l=JA(l,i)})));let a=[];e.add(t.modified.onDidChangeContent((t=>{const i=wA.fromModelContentChanges(t.changes);a=JA(a,i)})));let u=await c.diffProvider.computeDiff(t.original,t.modified,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace.read(i),maxComputationTimeMs:this._options.maxComputationTimeMs.read(i),computeMoves:this._options.showMoves.read(i)},this._cancellationTokenSource.token);var d,f,g;this._cancellationTokenSource.token.isCancellationRequested||(d=u,f=t.original,g=t.modified,u={changes:d.changes.map((t=>new Fg(t.original,t.modified,t.innerChanges?t.innerChanges.map((t=>function(t,i,e){let s=t.originalRange,n=t.modifiedRange;return(s.endColumn!==1||n.endColumn!==1)&&s.endColumn===i.getLineMaxColumn(s.endLineNumber)&&n.endColumn===e.getLineMaxColumn(n.endLineNumber)&&s.endLineNumber<i.getLineCount()&&n.endLineNumber<e.getLineCount()&&(s=s.setEndPosition(s.endLineNumber+1,1),n=n.setEndPosition(n.endLineNumber+1,1)),new Tg(s,n)}(t,f,g))):void 0))),moves:d.moves,identical:d.identical,quitEarly:d.quitEarly},u=(o=void 0)!==null&&o!==void 0?o:u,u=(h=void 0)!==null&&h!==void 0?h:u,_B((t=>{r(u,t),this._lastDiff=u;const i=LG.fromDiffResult(u);this._diff.set(i,t),this._isDiffUpToDate.set(!0,t);const e=this.movedTextToCompare.get();this.movedTextToCompare.set(e?this._lastDiff.moves.find((t=>t.lineRangeMapping.modified.intersect(e.lineRangeMapping.modified))):void 0,t)})))})))}ensureModifiedLineIsVisible(t,i,e){var s,n;if(((s=this.diff.get())===null||s===void 0?void 0:s.mappings.length)===0)return;const r=((n=this._unchangedRegions.get())===null||n===void 0?void 0:n.regions)||[];for(const s of r)if(s.getHiddenModifiedRange(void 0).contains(t))return void s.showModifiedLine(t,i,e)}ensureOriginalLineIsVisible(t,i,e){var s,n;if(((s=this.diff.get())===null||s===void 0?void 0:s.mappings.length)===0)return;const r=((n=this._unchangedRegions.get())===null||n===void 0?void 0:n.regions)||[];for(const s of r)if(s.getHiddenOriginalRange(void 0).contains(t))return void s.showOriginalLine(t,i,e)}async waitForDiff(){var t,i;await(t=this.isDiffUpToDate,i=t=>t,new Promise(((e,s)=>{let n=!0,r=!1;const o=t.map((t=>({isFinished:i(t),error:!1,state:t}))),h=ZB((t=>{const{isFinished:i,error:c,state:l}=o.read(t);(i||c)&&(n?r=!0:h.dispose(),c?s(c===!0?l:c):e(l))}));n=!1,r&&h.dispose()})))}serializeState(){const t=this._unchangedRegions.get();return{collapsedRegions:t==null?void 0:t.regions.map((t=>({range:t.getHiddenModifiedRange(void 0).serialize()})))}}restoreSerializedState(t){var i;const e=(i=t.collapsedRegions)===null||i===void 0?void 0:i.map((t=>Ag.deserialize(t.range))),s=this._unchangedRegions.get();s&&e&&_B((t=>{for(const i of s.regions)for(const s of e)if(i.modifiedUnchangedRange.intersect(s)){i.setHiddenModifiedRange(s,t);break}}))}};MG=EG([AG(2,SG)],MG);class LG{static fromDiffResult(t){return new LG(t.changes.map((t=>new FG(t))),t.moves||[],t.identical,t.quitEarly)}constructor(t,i,e,s){this.mappings=t,this.movedTexts=i,this.identical=e,this.quitEarly=s}}class FG{constructor(t){this.lineRangeMapping=t}}class TG{static fromDiffs(t,i,e,s,n){const r=Fg.inverse(t,i,e),o=[];for(const t of r){let r=t.original.startLineNumber,h=t.modified.startLineNumber,c=t.original.length;const l=r===1&&h===1,a=r+c===i+1&&h+c===e+1;(l||a)&&c>=n+s?(l&&!a&&(c-=n),a&&!l&&(r+=n,h+=n,c-=n),o.push(new TG(r,h,c,0,0))):c>=2*n+s&&(r+=n,h+=n,c-=2*n,o.push(new TG(r,h,c,0,0)))}return o}get originalUnchangedRange(){return Ag.ofLength(this.originalLineNumber,this.lineCount)}get modifiedUnchangedRange(){return Ag.ofLength(this.modifiedLineNumber,this.lineCount)}constructor(t,i,e,s,n){this.originalLineNumber=t,this.modifiedLineNumber=i,this.lineCount=e,this._visibleLineCountTop=$B(this,0),this.visibleLineCountTop=this._visibleLineCountTop,this._visibleLineCountBottom=$B(this,0),this.visibleLineCountBottom=this._visibleLineCountBottom,this._shouldHideControls=zB(this,(t=>this.visibleLineCountTop.read(t)+this.visibleLineCountBottom.read(t)===this.lineCount&&!this.isDragged.read(t))),this.isDragged=$B(this,void 0);const r=Math.max(Math.min(s,this.lineCount),0),o=Math.max(Math.min(n,this.lineCount-s),0);Wa(s===r),Wa(n===o),this._visibleLineCountTop.set(r,void 0),this._visibleLineCountBottom.set(o,void 0)}setVisibleRanges(t,i){const e=[],s=new Mg(t.map((t=>t.modified))).subtractFrom(this.modifiedUnchangedRange);let n=this.originalLineNumber,r=this.modifiedLineNumber;const o=this.modifiedLineNumber+this.lineCount;if(s.ranges.length===0)this.showAll(i),e.push(this);else{let t=0;for(const h of s.ranges){const c=t===s.ranges.length-1;t++;const l=(c?o:h.endLineNumberExclusive)-r,a=new TG(n,r,l,0,0);a.setHiddenModifiedRange(h,i),e.push(a),n=a.originalUnchangedRange.endLineNumberExclusive,r=a.modifiedUnchangedRange.endLineNumberExclusive}}return e}shouldHideControls(t){return this._shouldHideControls.read(t)}getHiddenOriginalRange(t){return Ag.ofLength(this.originalLineNumber+this._visibleLineCountTop.read(t),this.lineCount-this._visibleLineCountTop.read(t)-this._visibleLineCountBottom.read(t))}getHiddenModifiedRange(t){return Ag.ofLength(this.modifiedLineNumber+this._visibleLineCountTop.read(t),this.lineCount-this._visibleLineCountTop.read(t)-this._visibleLineCountBottom.read(t))}setHiddenModifiedRange(t,i){const e=t.startLineNumber-this.modifiedLineNumber,s=this.modifiedLineNumber+this.lineCount-t.endLineNumberExclusive;this.setState(e,s,i)}getMaxVisibleLineCountTop(){return this.lineCount-this._visibleLineCountBottom.get()}getMaxVisibleLineCountBottom(){return this.lineCount-this._visibleLineCountTop.get()}showMoreAbove(t=10,i){const e=this.getMaxVisibleLineCountTop();this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+t,e),i)}showMoreBelow(t=10,i){const e=this.lineCount-this._visibleLineCountTop.get();this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+t,e),i)}showAll(t){this._visibleLineCountBottom.set(this.lineCount-this._visibleLineCountTop.get(),t)}showModifiedLine(t,i,e){const s=t+1-(this.modifiedLineNumber+this._visibleLineCountTop.get()),n=this.modifiedLineNumber-this._visibleLineCountBottom.get()+this.lineCount-t;i===0&&s<n||i===1?this._visibleLineCountTop.set(this._visibleLineCountTop.get()+s,e):this._visibleLineCountBottom.set(this._visibleLineCountBottom.get()+n,e)}showOriginalLine(t,i,e){const s=t-this.originalLineNumber,n=this.originalLineNumber+this.lineCount-t;i===0&&s<n||i===1?this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+n-s,this.getMaxVisibleLineCountTop()),e):this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+s-n,this.getMaxVisibleLineCountBottom()),e)}collapseAll(t){this._visibleLineCountTop.set(0,t),this._visibleLineCountBottom.set(0,t)}setState(t,i,e){t=Math.max(Math.min(t,this.lineCount),0),i=Math.max(Math.min(i,this.lineCount-t),0),this._visibleLineCountTop.set(t,e),this._visibleLineCountBottom.set(i,e)}}class RG extends Qi{get visibility(){return this._visibility}set visibility(t){this._visibility!==t&&(this._visibility=t,this._diffActions.style.visibility=t?"visible":"hidden")}constructor(t,i,e,s,n,r,o,h,c){super(),this._getViewZoneId=t,this._marginDomNode=i,this._modifiedEditor=e,this._diff=s,this._editor=n,this._viewLineCounts=r,this._originalTextModel=o,this._contextMenuService=h,this._clipboardService=c,this._visibility=!1,this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=Kl.asClassName(As.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";const l=this._modifiedEditor.getOption(67);this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${l}px`,this._diffActions.style.lineHeight=`${l}px`,this._marginDomNode.appendChild(this._diffActions);let a=0;const u=e.getOption(127)&&!xt,d=(t,i)=>{var n;this._contextMenuService.showContextMenu({domForShadowRoot:u&&(n=e.getDomNode())!==null&&n!==void 0?n:void 0,getAnchor:()=>({x:t,y:i}),getActions:()=>{const t=[],i=s.modified.isEmpty;return t.push(new $l("diff.clipboard.copyDeletedContent",i?s.original.length>1?tt(0,"Copy deleted lines"):tt(0,"Copy deleted line"):s.original.length>1?tt(0,"Copy changed lines"):tt(0,"Copy changed line"),void 0,!0,(async()=>{const t=this._originalTextModel.getValueInRange(s.original.toExclusiveRange());await this._clipboardService.writeText(t)}))),s.original.length>1&&t.push(new $l("diff.clipboard.copyDeletedLineContent",tt(0,i?"Copy deleted line ({0})":"Copy changed line ({0})",s.original.startLineNumber+a),void 0,!0,(async()=>{let t=this._originalTextModel.getLineContent(s.original.startLineNumber+a);t===""&&(t=this._originalTextModel.getEndOfLineSequence()===0?`\n`:`\r\n`),await this._clipboardService.writeText(t)}))),e.getOption(91)||t.push(new $l("diff.inline.revertChange",tt(0,"Revert this change"),void 0,!0,(async()=>{this._editor.revert(this._diff)}))),t},autoSelectFirstItem:!0})};this._register(rc(this._diffActions,"mousedown",(t=>{if(!t.leftButton)return;const{top:i,height:e}=vc(this._diffActions),s=Math.floor(l/3);t.preventDefault(),d(t.posx,i+e+s)}))),this._register(e.onMouseMove((t=>{t.target.type!==8&&t.target.type!==5||t.target.detail.viewZoneId!==this._getViewZoneId()?this.visibility=!1:(a=this._updateLightBulbPosition(this._marginDomNode,t.event.browserEvent.y,l),this.visibility=!0)}))),this._register(e.onMouseDown((t=>{t.event.leftButton&&(t.target.type===8||t.target.type===5)&&t.target.detail.viewZoneId===this._getViewZoneId()&&(t.event.preventDefault(),a=this._updateLightBulbPosition(this._marginDomNode,t.event.browserEvent.y,l),d(t.event.posx,t.event.posy+l))})))}_updateLightBulbPosition(t,i,e){const{top:s}=vc(t),n=i-s,r=Math.floor(n/e),o=r*e;if(this._diffActions.style.top=`${o}px`,this._viewLineCounts){let t=0;for(let i=0;i<this._viewLineCounts.length;i++)if(t+=this._viewLineCounts[i],r<t)return i}return r}}const OG=ju("diffEditorWidget",{createHTML:t=>t});function IG(t,i,e,s){xl(s,i.fontInfo);const n=e.length>0,r=new gd(1e4);let o=0,h=0;const c=[];for(let s=0;s<t.lineTokens.length;s++){const l=s+1,a=t.lineTokens[s],u=t.lineBreakData[s],d=rm.filter(e,l,1,Number.MAX_SAFE_INTEGER);if(u){let e=0;for(const s of u.breakOffsets){const c=a.sliceAndInflate(e,s,0);o=Math.max(o,NG(h,c,rm.extractWrapped(d,e,s),n,t.mightContainNonBasicASCII,t.mightContainRTL,i,r)),h++,e=s}c.push(u.breakOffsets.length)}else c.push(1),o=Math.max(o,NG(h,a,d,n,t.mightContainNonBasicASCII,t.mightContainRTL,i,r)),h++}o+=i.scrollBeyondLastColumn;const l=r.build(),a=OG?OG.createHTML(l):l;return s.innerHTML=a,{heightInLines:h,minWidthInPx:o*i.typicalHalfwidthCharacterWidth,viewLineCounts:c}}class _G{constructor(t,i,e,s){this.lineTokens=t,this.lineBreakData=i,this.mightContainNonBasicASCII=e,this.mightContainRTL=s}}class PG{static fromEditor(t){var i;const e=t.getOptions(),s=e.get(50),n=e.get(145);return new PG(((i=t.getModel())===null||i===void 0?void 0:i.getOptions().tabSize)||0,s,e.get(33),s.typicalHalfwidthCharacterWidth,e.get(104),e.get(67),n.decorationsWidth,e.get(117),e.get(99),e.get(94),e.get(51))}constructor(t,i,e,s,n,r,o,h,c,l,a){this.tabSize=t,this.fontInfo=i,this.disableMonospaceOptimizations=e,this.typicalHalfwidthCharacterWidth=s,this.scrollBeyondLastColumn=n,this.lineHeight=r,this.lineDecorationsWidth=o,this.stopRenderingLineAfter=h,this.renderWhitespace=c,this.renderControlCharacters=l,this.fontLigatures=a}}function NG(t,i,e,s,n,r,o,h){h.appendString('<div class="view-line'),s||h.appendString(" char-delete"),h.appendString('" style="top:'),h.appendString(String(t*o.lineHeight)),h.appendString('px;width:1000000px;">');const c=i.getLineContent(),l=xm.isBasicASCII(c,n),a=xm.containsRTL(c,l,r),u=pm(new um(o.fontInfo.isMonospace&&!o.disableMonospaceOptimizations,o.fontInfo.canUseHalfwidthRightwardsArrow,c,!1,l,a,0,i,e,o.tabSize,0,o.fontInfo.spaceWidth,o.fontInfo.middotWidth,o.fontInfo.wsmiddotWidth,o.stopRenderingLineAfter,o.renderWhitespace,o.renderControlCharacters,o.fontLigatures!==gi.OFF,null),h);return h.appendString("</div>"),u.characterMapping.getHorizontalOffset(u.characterMapping.length)}var BG=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},$G=function(t,i){return function(e,s){i(e,s,t)}};let WG=class extends Qi{constructor(t,i,e,s,n,r,o,h,c,l){super(),this._targetWindow=t,this._editors=i,this._diffModel=e,this._options=s,this._diffEditorWidget=n,this._canIgnoreViewZoneUpdateEvent=r,this._origViewZonesToIgnore=o,this._modViewZonesToIgnore=h,this._clipboardService=c,this._contextMenuService=l,this._originalTopPadding=$B(this,0),this._originalScrollOffset=$B(this,0),this._originalScrollOffsetAnimated=Tq(this._targetWindow,this._originalScrollOffset,this._store),this._modifiedTopPadding=$B(this,0),this._modifiedScrollOffset=$B(this,0),this._modifiedScrollOffsetAnimated=Tq(this._targetWindow,this._modifiedScrollOffset,this._store);const a=$B("invalidateAlignmentsState",0),u=this._register(new Co((()=>{a.set(a.get()+1,void 0)}),0));this._register(this._editors.original.onDidChangeViewZones((t=>{this._canIgnoreViewZoneUpdateEvent()||u.schedule()}))),this._register(this._editors.modified.onDidChangeViewZones((t=>{this._canIgnoreViewZoneUpdateEvent()||u.schedule()}))),this._register(this._editors.original.onDidChangeConfiguration((t=>{(t.hasChanged(146)||t.hasChanged(67))&&u.schedule()}))),this._register(this._editors.modified.onDidChangeConfiguration((t=>{(t.hasChanged(146)||t.hasChanged(67))&&u.schedule()})));const d=this._diffModel.map((t=>t?e$(t.model.original.onDidChangeTokens,(()=>t.model.original.tokenization.backgroundTokenizationState===2)):void 0)).map(((t,i)=>t==null?void 0:t.read(i))),f=zB((t=>{const i=this._diffModel.read(t),e=i==null?void 0:i.diff.read(t);if(!i||!e)return null;a.read(t);const s=this._options.renderSideBySide.read(t);return jG(this._editors.original,this._editors.modified,e.mappings,this._origViewZonesToIgnore,this._modViewZonesToIgnore,s)})),g=zB((t=>{var i;const e=(i=this._diffModel.read(t))===null||i===void 0?void 0:i.movedTextToCompare.read(t);if(!e)return null;a.read(t);const s=e.changes.map((t=>new FG(t)));return jG(this._editors.original,this._editors.modified,s,this._origViewZonesToIgnore,this._modViewZonesToIgnore,!0)}));function p(){const t=document.createElement("div");return t.className="diagonal-fill",t}const m=this._register(new Ji);this.viewZones=KB(this,((t,i)=>{var e,s,r,o,h,c,l,a;m.clear();const u=f.read(t)||[],w=[],v=[],b=this._modifiedTopPadding.read(t);b>0&&v.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:b,showInHiddenAreas:!0,suppressMouseDown:!0});const y=this._originalTopPadding.read(t);y>0&&w.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:y,showInHiddenAreas:!0,suppressMouseDown:!0});const k=this._options.renderSideBySide.read(t),C=k||(e=this._editors.modified._getViewModel())===null||e===void 0?void 0:e.createLineBreaksComputer();if(C){const t=this._editors.original.getModel();for(const i of u)if(i.diff)for(let e=i.originalRange.startLineNumber;e<i.originalRange.endLineNumberExclusive;e++){if(e>t.getLineCount())return{orig:w,mod:v};C==null||C.addRequest(t.getLineContent(e),null,null)}}const S=(s=C==null?void 0:C.finalize())!==null&&s!==void 0?s:[];let x=0;const D=this._editors.modified.getOption(67),E=(r=this._diffModel.read(t))===null||r===void 0?void 0:r.movedTextToCompare.read(t),A=(h=(o=this._editors.original.getModel())===null||o===void 0?void 0:o.mightContainNonBasicASCII())!==null&&h!==void 0&&h,M=(l=(c=this._editors.original.getModel())===null||c===void 0?void 0:c.mightContainRTL())!==null&&l!==void 0&&l,L=PG.fromEditor(this._editors.modified);for(const e of u)if(e.diff&&!k){if(!e.originalRange.isEmpty){d.read(t);const i=document.createElement("div");i.classList.add("view-lines","line-delete","monaco-mouse-cursor-text");const s=this._editors.original.getModel();if(e.originalRange.endLineNumberExclusive-1>s.getLineCount())return{orig:w,mod:v};const n=new _G(e.originalRange.mapToLineArray((t=>s.tokenization.getLineTokens(t))),e.originalRange.mapToLineArray((t=>S[x++])),A,M),r=[];for(const t of e.diff.innerChanges||[])r.push(new Dm(t.originalRange.delta(-(e.diff.original.startLineNumber-1)),pG.className,0));const o=IG(n,L,r,i),h=document.createElement("div");if(h.className="inline-deleted-margin-view-zone",xl(h,L.fontInfo),this._options.renderIndicators.read(t))for(let t=0;t<o.heightInLines;t++){const i=document.createElement("div");i.className=`delete-sign ${Kl.asClassName(hG)}`,i.setAttribute("style",`position:absolute;top:${t*D}px;width:${L.lineDecorationsWidth}px;height:${D}px;right:0;`),h.appendChild(i)}let c;m.add(new RG((()=>H(c)),h,this._editors.modified,e.diff,this._diffEditorWidget,o.viewLineCounts,this._editors.original.getModel(),this._contextMenuService,this._clipboardService));for(let t=0;t<o.viewLineCounts.length;t++){const i=o.viewLineCounts[t];i>1&&w.push({afterLineNumber:e.originalRange.startLineNumber+t,domNode:p(),heightInPx:(i-1)*D,showInHiddenAreas:!0,suppressMouseDown:!0})}v.push({afterLineNumber:e.modifiedRange.startLineNumber-1,domNode:i,heightInPx:o.heightInLines*D,minWidthInPx:o.minWidthInPx,marginDomNode:h,setZoneId(t){c=t},showInHiddenAreas:!0,suppressMouseDown:!0})}const i=document.createElement("div");i.className="gutter-delete",w.push({afterLineNumber:e.originalRange.endLineNumberExclusive-1,domNode:p(),heightInPx:e.modifiedHeightInPx,marginDomNode:i,showInHiddenAreas:!0,suppressMouseDown:!0})}else{const s=e.modifiedHeightInPx-e.originalHeightInPx;if(s>0){if(E!=null&&E.lineRangeMapping.original.delta(-1).deltaLength(2).contains(e.originalRange.endLineNumberExclusive-1))continue;w.push({afterLineNumber:e.originalRange.endLineNumberExclusive-1,domNode:p(),heightInPx:s,showInHiddenAreas:!0,suppressMouseDown:!0})}else{let r=function(){const t=document.createElement("div");return t.className="arrow-revert-change "+Kl.asClassName(As.arrowRight),i.add(sc(t,"mousedown",(t=>t.stopPropagation()))),i.add(sc(t,"click",(t=>{t.stopPropagation(),n.revert(e.diff)}))),nl("div",{},t)};if(E!=null&&E.lineRangeMapping.modified.delta(-1).deltaLength(2).contains(e.modifiedRange.endLineNumberExclusive-1))continue;let o;e.diff&&e.diff.modified.isEmpty&&this._options.shouldRenderOldRevertArrows.read(t)&&(o=r()),v.push({afterLineNumber:e.modifiedRange.endLineNumberExclusive-1,domNode:p(),heightInPx:-s,marginDomNode:o,showInHiddenAreas:!0,suppressMouseDown:!0})}}for(const i of(a=g.read(t))!==null&&a!==void 0?a:[]){if(!(E!=null&&E.lineRangeMapping.original.intersect(i.originalRange))||!(E!=null&&E.lineRangeMapping.modified.intersect(i.modifiedRange)))continue;const t=i.modifiedHeightInPx-i.originalHeightInPx;t>0?w.push({afterLineNumber:i.originalRange.endLineNumberExclusive-1,domNode:p(),heightInPx:t,showInHiddenAreas:!0,suppressMouseDown:!0}):v.push({afterLineNumber:i.modifiedRange.endLineNumberExclusive-1,domNode:p(),heightInPx:-t,showInHiddenAreas:!0,suppressMouseDown:!0})}return{orig:w,mod:v}}));let w=!1;this._register(this._editors.original.onDidScrollChange((t=>{t.scrollLeftChanged&&!w&&(w=!0,this._editors.modified.setScrollLeft(t.scrollLeft),w=!1)}))),this._register(this._editors.modified.onDidScrollChange((t=>{t.scrollLeftChanged&&!w&&(w=!0,this._editors.original.setScrollLeft(t.scrollLeft),w=!1)}))),this._originalScrollTop=e$(this._editors.original.onDidScrollChange,(()=>this._editors.original.getScrollTop())),this._modifiedScrollTop=e$(this._editors.modified.onDidScrollChange,(()=>this._editors.modified.getScrollTop())),this._register(ZB((t=>{const i=this._originalScrollTop.read(t)-(this._originalScrollOffsetAnimated.get()-this._modifiedScrollOffsetAnimated.read(t))-(this._originalTopPadding.get()-this._modifiedTopPadding.read(t));i!==this._editors.modified.getScrollTop()&&this._editors.modified.setScrollTop(i,1)}))),this._register(ZB((t=>{const i=this._modifiedScrollTop.read(t)-(this._modifiedScrollOffsetAnimated.get()-this._originalScrollOffsetAnimated.read(t))-(this._modifiedTopPadding.get()-this._originalTopPadding.read(t));i!==this._editors.original.getScrollTop()&&this._editors.original.setScrollTop(i,1)}))),this._register(ZB((t=>{var i;const e=(i=this._diffModel.read(t))===null||i===void 0?void 0:i.movedTextToCompare.read(t);let s=0;if(e){const t=this._editors.original.getTopForLineNumber(e.lineRangeMapping.original.startLineNumber,!0)-this._originalTopPadding.get();s=this._editors.modified.getTopForLineNumber(e.lineRangeMapping.modified.startLineNumber,!0)-this._modifiedTopPadding.get()-t}s>0?(this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(s,void 0)):s<0?(this._modifiedTopPadding.set(-s,void 0),this._originalTopPadding.set(0,void 0)):setTimeout((()=>{this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(0,void 0)}),400),this._editors.modified.hasTextFocus()?this._originalScrollOffset.set(this._modifiedScrollOffset.get()-s,void 0,!0):this._modifiedScrollOffset.set(this._originalScrollOffset.get()+s,void 0,!0)})))}};function jG(t,i,e,s,n,r){const o=new L(HG(t,s)),h=new L(HG(i,n)),c=t.getOption(67),l=i.getOption(67),a=[];let u=0,d=0;function f(t,i){for(;;){let e=o.peek(),s=h.peek();if(e&&e.lineNumber>=t&&(e=void 0),s&&s.lineNumber>=i&&(s=void 0),!e&&!s)break;const n=e?e.lineNumber-u:Number.MAX_VALUE,r=s?s.lineNumber-d:Number.MAX_VALUE;n<r?(o.dequeue(),s={lineNumber:e.lineNumber-u+d,heightInPx:0}):n>r?(h.dequeue(),e={lineNumber:s.lineNumber-d+u,heightInPx:0}):(o.dequeue(),h.dequeue()),a.push({originalRange:Ag.ofLength(e.lineNumber,1),modifiedRange:Ag.ofLength(s.lineNumber,1),originalHeightInPx:c+e.heightInPx,modifiedHeightInPx:l+s.heightInPx,diff:void 0})}}for(const i of e){let e=function(t,e){var s,r,u,d;if(t<p||e<g)return;if(n)n=!1;else if(t===p||e===g)return;const f=new Ag(p,t),m=new Ag(g,e);if(f.isEmpty&&m.isEmpty)return;const w=(r=(s=o.takeWhile((i=>i.lineNumber<t)))===null||s===void 0?void 0:s.reduce(((t,i)=>t+i.heightInPx),0))!==null&&r!==void 0?r:0,v=(d=(u=h.takeWhile((t=>t.lineNumber<e)))===null||u===void 0?void 0:u.reduce(((t,i)=>t+i.heightInPx),0))!==null&&d!==void 0?d:0;a.push({originalRange:f,modifiedRange:m,originalHeightInPx:f.length*c+w,modifiedHeightInPx:m.length*l+v,diff:i.lineRangeMapping}),p=t,g=e};const s=i.lineRangeMapping;f(s.original.startLineNumber,s.modified.startLineNumber);let n=!0,g=s.modified.startLineNumber,p=s.original.startLineNumber;if(r)for(const i of s.innerChanges||[]){i.originalRange.startColumn>1&&i.modifiedRange.startColumn>1&&e(i.originalRange.startLineNumber,i.modifiedRange.startLineNumber);const s=t.getModel(),n=i.originalRange.endLineNumber<=s.getLineCount()?s.getLineMaxColumn(i.originalRange.endLineNumber):Number.MAX_SAFE_INTEGER;i.originalRange.endColumn<n&&e(i.originalRange.endLineNumber,i.modifiedRange.endLineNumber)}e(s.original.endLineNumberExclusive,s.modified.endLineNumberExclusive),u=s.original.endLineNumberExclusive,d=s.modified.endLineNumberExclusive}return f(Number.MAX_VALUE,Number.MAX_VALUE),a}function HG(t,i){const e=[],s=[],n=t.getOption(146).wrappingColumn!==-1,r=t._getViewModel().coordinatesConverter,o=t.getOption(67);if(n)for(let i=1;i<=t.getModel().getLineCount();i++){const t=r.getModelLineViewLineCount(i);t>1&&s.push({lineNumber:i,heightInPx:o*(t-1)})}for(const s of t.getWhitespaces()){if(i.has(s.id))continue;const t=s.afterLineNumber===0?0:r.convertViewPositionToModelPosition(new ks(s.afterLineNumber,1)).lineNumber;e.push({lineNumber:t,heightInPx:s.height})}return function(t,i,e,s){if(t.length===0)return i;if(i.length===0)return t;const n=[];let r=0,o=0;for(;r<t.length&&o<i.length;){const h=t[r],c=i[o],l=e(h),a=e(c);l<a?(n.push(h),r++):l>a?(n.push(c),o++):(n.push(s(h,c)),r++,o++)}for(;r<t.length;)n.push(t[r]),r++;for(;o<i.length;)n.push(i[o]),o++;return n}(e,s,(t=>t.lineNumber),((t,i)=>({lineNumber:t.lineNumber,heightInPx:t.heightInPx+i.heightInPx})))}WG=BG([$G(8,AK),$G(9,oI)],WG);var VG,zG=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},UG=function(t,i){return function(e,s){i(e,s,t)}};let KG=VG=class extends Qi{static setBreadcrumbsSourceFactory(t){this._breadcrumbsSourceFactory.set(t,void 0)}get isUpdatingHiddenAreas(){return this._isUpdatingHiddenAreas}constructor(t,i,e,s){super(),this._editors=t,this._diffModel=i,this._options=e,this._instantiationService=s,this._modifiedOutlineSource=qB(this,(t=>{const i=this._editors.modifiedModel.read(t),e=VG._breadcrumbsSourceFactory.read(t);return i&&e?e(i,this._instantiationService):void 0})),this._isUpdatingHiddenAreas=!1,this._register(this._editors.original.onDidChangeCursorPosition((t=>{if(t.reason===1)return;const i=this._diffModel.get();_B((t=>{for(const e of this._editors.original.getSelections()||[])i==null||i.ensureOriginalLineIsVisible(e.getStartPosition().lineNumber,0,t),i==null||i.ensureOriginalLineIsVisible(e.getEndPosition().lineNumber,0,t)}))}))),this._register(this._editors.modified.onDidChangeCursorPosition((t=>{if(t.reason===1)return;const i=this._diffModel.get();_B((t=>{for(const e of this._editors.modified.getSelections()||[])i==null||i.ensureModifiedLineIsVisible(e.getStartPosition().lineNumber,0,t),i==null||i.ensureModifiedLineIsVisible(e.getEndPosition().lineNumber,0,t)}))})));const n=this._diffModel.map(((t,i)=>{var e,s;const n=(e=t==null?void 0:t.unchangedRegions.read(i))!==null&&e!==void 0?e:[];return n.length===1&&n[0].modifiedLineNumber===1&&n[0].lineCount===((s=this._editors.modifiedModel.read(i))===null||s===void 0?void 0:s.getLineCount())?[]:n}));this.viewZones=KB(this,((t,i)=>{const e=this._modifiedOutlineSource.read(t);if(!e)return{origViewZones:[],modViewZones:[]};const s=[],r=[],o=this._options.renderSideBySide.read(t),h=n.read(t);for(const n of h)if(!n.shouldHideControls(t)){{const t=zB(this,(t=>n.getHiddenOriginalRange(t).startLineNumber-1)),r=new Oq(t,24);s.push(r),i.add(new qG(this._editors.original,r,n,n.originalUnchangedRange,!o,e,(t=>this._diffModel.get().ensureModifiedLineIsVisible(t,2,void 0)),this._options))}{const t=zB(this,(t=>n.getHiddenModifiedRange(t).startLineNumber-1)),s=new Oq(t,24);r.push(s),i.add(new qG(this._editors.modified,s,n,n.modifiedUnchangedRange,!1,e,(t=>this._diffModel.get().ensureModifiedLineIsVisible(t,2,void 0)),this._options))}}return{origViewZones:s,modViewZones:r}}));const r={description:"unchanged lines",className:"diff-unchanged-lines",isWholeLine:!0},o={description:"Fold Unchanged",glyphMarginHoverMessage:new F_(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(tt(0,"Fold Unchanged Region")),glyphMarginClassName:"fold-unchanged "+Kl.asClassName(As.fold),zIndex:10001};this._register(Mq(this._editors.original,zB(this,(t=>{const i=n.read(t),e=i.map((t=>({range:t.originalUnchangedRange.toInclusiveRange(),options:r})));for(const s of i)s.shouldHideControls(t)&&e.push({range:Cs.fromPositions(new ks(s.originalLineNumber,1)),options:o});return e})))),this._register(Mq(this._editors.modified,zB(this,(t=>{const i=n.read(t),e=i.map((t=>({range:t.modifiedUnchangedRange.toInclusiveRange(),options:r})));for(const s of i)s.shouldHideControls(t)&&e.push({range:Ag.ofLength(s.modifiedLineNumber,1).toInclusiveRange(),options:o});return e})))),this._register(ZB((t=>{const i=n.read(t);this._isUpdatingHiddenAreas=!0;try{this._editors.original.setHiddenAreas(i.map((i=>i.getHiddenOriginalRange(t).toInclusiveRange())).filter($)),this._editors.modified.setHiddenAreas(i.map((i=>i.getHiddenModifiedRange(t).toInclusiveRange())).filter($))}finally{this._isUpdatingHiddenAreas=!1}}))),this._register(this._editors.modified.onMouseUp((t=>{var i;if(!t.event.rightButton&&t.target.position&&(!((i=t.target.element)===null||i===void 0)&&i.className.includes("fold-unchanged"))){const i=t.target.position.lineNumber,e=this._diffModel.get();if(!e)return;const s=e.unchangedRegions.get().find((t=>t.modifiedUnchangedRange.includes(i)));if(!s)return;s.collapseAll(void 0),t.event.stopPropagation(),t.event.preventDefault()}}))),this._register(this._editors.original.onMouseUp((t=>{var i;if(!t.event.rightButton&&t.target.position&&(!((i=t.target.element)===null||i===void 0)&&i.className.includes("fold-unchanged"))){const i=t.target.position.lineNumber,e=this._diffModel.get();if(!e)return;const s=e.unchangedRegions.get().find((t=>t.originalUnchangedRange.includes(i)));if(!s)return;s.collapseAll(void 0),t.event.stopPropagation(),t.event.preventDefault()}})))}};KG._breadcrumbsSourceFactory=$B("breadcrumbsSourceFactory",void 0),KG=VG=zG([UG(3,Il)],KG);class qG extends Rq{constructor(t,i,e,s,n,r,o,h){const c=ml("div.diff-hidden-lines-widget");super(t,i,c.root),this._editor=t,this._unchangedRegion=e,this._unchangedRegionRange=s,this._hide=n,this._modifiedOutlineSource=r,this._revealModifiedHiddenLine=o,this._options=h,this._nodes=ml("div.diff-hidden-lines",[ml("div.top@top",{title:tt(0,"Click or drag to show more above")}),ml("div.center@content",{style:{display:"flex"}},[ml("div@first",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexShrink:"0"}},[nl("a",{title:tt(0,"Show Unchanged Region"),role:"button",onclick:()=>{this._unchangedRegion.showAll(void 0)}},...bI("$(unfold)"))]),ml("div@others",{style:{display:"flex",justifyContent:"center",alignItems:"center"}})]),ml("div.bottom@bottom",{title:tt(0,"Click or drag to show more below"),role:"button"})]),c.root.appendChild(this._nodes.root);const l=e$(this._editor.onDidLayoutChange,(()=>this._editor.getLayoutInfo()));this._hide?tl(this._nodes.first):this._register(_q(this._nodes.first,{width:l.map((t=>t.contentLeft))})),this._register(ZB((t=>{const i=this._unchangedRegion.visibleLineCountTop.read(t)+this._unchangedRegion.visibleLineCountBottom.read(t)===this._unchangedRegion.lineCount;this._nodes.bottom.classList.toggle("canMoveTop",!i),this._nodes.bottom.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(t)>0),this._nodes.top.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(t)>0),this._nodes.top.classList.toggle("canMoveBottom",!i);const e=this._unchangedRegion.isDragged.read(t),s=this._editor.getDomNode();s&&(s.classList.toggle("draggingUnchangedRegion",!!e),e==="top"?(s.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(t)>0),s.classList.toggle("canMoveBottom",!i)):e==="bottom"?(s.classList.toggle("canMoveTop",!i),s.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(t)>0)):(s.classList.toggle("canMoveTop",!1),s.classList.toggle("canMoveBottom",!1)))})));const a=this._editor;this._register(sc(this._nodes.top,"mousedown",(t=>{if(t.button!==0)return;this._nodes.top.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),t.preventDefault();const i=t.clientY;let e=!1;const s=this._unchangedRegion.visibleLineCountTop.get();this._unchangedRegion.isDragged.set("top",void 0);const n=Uh(this._nodes.top),r=sc(n,"mousemove",(t=>{const n=t.clientY-i;e=e||Math.abs(n)>2;const r=Math.round(n/a.getOption(67)),o=Math.max(0,Math.min(s+r,this._unchangedRegion.getMaxVisibleLineCountTop()));this._unchangedRegion.visibleLineCountTop.set(o,void 0)})),o=sc(n,"mouseup",(t=>{e||this._unchangedRegion.showMoreAbove(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0),this._nodes.top.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),this._unchangedRegion.isDragged.set(void 0,void 0),r.dispose(),o.dispose()}))}))),this._register(sc(this._nodes.bottom,"mousedown",(t=>{if(t.button!==0)return;this._nodes.bottom.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),t.preventDefault();const i=t.clientY;let e=!1;const s=this._unchangedRegion.visibleLineCountBottom.get();this._unchangedRegion.isDragged.set("bottom",void 0);const n=Uh(this._nodes.bottom),r=sc(n,"mousemove",(t=>{const n=t.clientY-i;e=e||Math.abs(n)>2;const r=Math.round(n/a.getOption(67)),o=Math.max(0,Math.min(s-r,this._unchangedRegion.getMaxVisibleLineCountBottom())),h=this._unchangedRegionRange.endLineNumberExclusive>a.getModel().getLineCount()?a.getContentHeight():a.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.visibleLineCountBottom.set(o,void 0);const c=this._unchangedRegionRange.endLineNumberExclusive>a.getModel().getLineCount()?a.getContentHeight():a.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);a.setScrollTop(a.getScrollTop()+(c-h))})),o=sc(n,"mouseup",(t=>{if(this._unchangedRegion.isDragged.set(void 0,void 0),!e){const t=a.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.showMoreBelow(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0);const i=a.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);a.setScrollTop(a.getScrollTop()+(i-t))}this._nodes.bottom.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),r.dispose(),o.dispose()}))}))),this._register(ZB((t=>{const i=[];if(!this._hide){const s=tt(0,"{0} hidden lines",e.getHiddenModifiedRange(t).length),n=nl("span",{title:tt(0,"Double click to unfold")},s);n.addEventListener("dblclick",(t=>{t.button===0&&(t.preventDefault(),this._unchangedRegion.showAll(void 0))})),i.push(n);const r=this._unchangedRegion.getHiddenModifiedRange(t),o=this._modifiedOutlineSource.getBreadcrumbItems(r,t);if(o.length>0){i.push(nl("span",void 0,"  |  "));for(let t=0;t<o.length;t++){const e=o[t],s=ml("div.breadcrumb-item",{style:{display:"flex",alignItems:"center"}},[yI($s.toIcon(e.kind))," ",e.name,...t===o.length-1?[]:[yI(As.chevronRight)]]).root;i.push(s),s.onclick=()=>{this._revealModifiedHiddenLine(e.startLineNumber)}}}}tl(this._nodes.others,...i)})))}}var GG,ZG=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},JG=function(t,i){return function(e,s){i(e,s,t)}};let QG=GG=class extends Qi{constructor(t,i,e,s,n,r,o){super(),this._editors=t,this._rootElement=i,this._diffModel=e,this._rootWidth=s,this._rootHeight=n,this._modifiedEditorLayoutInfo=r,this._themeService=o,this.width=GG.ENTIRE_DIFF_OVERVIEW_WIDTH;const h=e$(this._themeService.onDidColorThemeChange,(()=>this._themeService.getColorTheme())),c=zB((t=>{const i=h.read(t);return{insertColor:i.getColor(Nv)||(i.getColor(_v)||Ov).transparent(2),removeColor:i.getColor(Bv)||(i.getColor(Pv)||Iv).transparent(2)}})),l=Sl(document.createElement("div"));l.setClassName("diffViewport"),l.setPosition("absolute");const a=ml("div.diffOverview",{style:{position:"absolute",top:"0px",width:GG.ENTIRE_DIFF_OVERVIEW_WIDTH+"px"}}).root;this._register(Lq(a,l.domNode)),this._register(rc(a,qc.POINTER_DOWN,(t=>{this._editors.modified.delegateVerticalScrollbarPointerDown(t)}))),this._register(sc(a,qc.MOUSE_WHEEL,(t=>{this._editors.modified.delegateScrollFromMouseWheelEvent(t)}),{passive:!1})),this._register(Lq(this._rootElement,a)),this._register(YB(((t,i)=>{const e=this._diffModel.read(t),s=this._editors.original.createOverviewRuler("original diffOverviewRuler");s&&(i.add(s),i.add(Lq(a,s.getDomNode())));const n=this._editors.modified.createOverviewRuler("modified diffOverviewRuler");if(n&&(i.add(n),i.add(Lq(a,n.getDomNode()))),!s||!n)return;const r=n$("viewZoneChanged",this._editors.original.onDidChangeViewZones),o=n$("viewZoneChanged",this._editors.modified.onDidChangeViewZones),h=n$("hiddenRangesChanged",this._editors.original.onDidChangeHiddenAreas),u=n$("hiddenRangesChanged",this._editors.modified.onDidChangeHiddenAreas);i.add(ZB((t=>{var i;r.read(t),o.read(t),h.read(t),u.read(t);const l=c.read(t),a=(i=e==null?void 0:e.diff.read(t))===null||i===void 0?void 0:i.mappings;function d(t,i,e){const s=e._getViewModel();return s?t.filter((t=>t.length>0)).map((t=>{const e=s.coordinatesConverter.convertModelPositionToViewPosition(new ks(t.startLineNumber,1)),n=s.coordinatesConverter.convertModelPositionToViewPosition(new ks(t.endLineNumberExclusive,1)),r=n.lineNumber-e.lineNumber;return new nE(e.lineNumber,n.lineNumber,r,i.toString())})):[]}const f=d((a||[]).map((t=>t.lineRangeMapping.original)),l.removeColor,this._editors.original),g=d((a||[]).map((t=>t.lineRangeMapping.modified)),l.insertColor,this._editors.modified);s==null||s.setZones(f),n==null||n.setZones(g)}))),i.add(ZB((t=>{const i=this._rootHeight.read(t),e=this._rootWidth.read(t),r=this._modifiedEditorLayoutInfo.read(t);if(r){const e=GG.ENTIRE_DIFF_OVERVIEW_WIDTH-2*GG.ONE_OVERVIEW_WIDTH;s.setLayout({top:0,height:i,right:e+GG.ONE_OVERVIEW_WIDTH,width:GG.ONE_OVERVIEW_WIDTH}),n.setLayout({top:0,height:i,right:0,width:GG.ONE_OVERVIEW_WIDTH});const o=this._editors.modifiedScrollTop.read(t),h=this._editors.modifiedScrollHeight.read(t),c=this._editors.modified.getOption(103),a=new Kk(c.verticalHasArrows?c.arrowSize:0,c.verticalScrollbarSize,0,r.height,h,o);l.setTop(a.getSliderPosition()),l.setHeight(a.getSliderSize())}else l.setTop(0),l.setHeight(0);a.style.height=i+"px",a.style.left=e-GG.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",l.setWidth(GG.ENTIRE_DIFF_OVERVIEW_WIDTH)})))})))}};QG.ONE_OVERVIEW_WIDTH=15,QG.ENTIRE_DIFF_OVERVIEW_WIDTH=2*GG.ONE_OVERVIEW_WIDTH,QG=GG=ZG([JG(6,AC)],QG);const YG=[];class XG extends Qi{constructor(t,i,e,s){super(),this._editors=t,this._diffModel=i,this._options=e,this._widget=s,this._selectedDiffs=zB(this,(t=>{const i=this._diffModel.read(t),e=i==null?void 0:i.diff.read(t);if(!e)return YG;const s=this._editors.modifiedSelections.read(t);if(s.every((t=>t.isEmpty())))return YG;const n=new Mg(s.map((t=>Ag.fromRangeInclusive(t)))),r=e.mappings.filter((t=>t.lineRangeMapping.innerChanges&&n.intersects(t.lineRangeMapping.modified))).map((t=>({mapping:t,rangeMappings:t.lineRangeMapping.innerChanges.filter((t=>s.some((i=>Cs.areIntersecting(t.modifiedRange,i)))))})));return r.length===0||r.every((t=>t.rangeMappings.length===0))?YG:r})),this._register(YB(((t,i)=>{if(!this._options.shouldRenderOldRevertArrows.read(t))return;const e=this._diffModel.read(t),s=e==null?void 0:e.diff.read(t);if(!e||!s||e.movedTextToCompare.read(t))return;const n=[],r=this._selectedDiffs.read(t),o=new Set(r.map((t=>t.mapping)));if(r.length>0){const e=this._editors.modifiedSelections.read(t),s=i.add(new tZ(e[e.length-1].positionLineNumber,this._widget,r.flatMap((t=>t.rangeMappings)),!0));this._editors.modified.addGlyphMarginWidget(s),n.push(s)}for(const t of s.mappings)if(!o.has(t)&&!t.lineRangeMapping.modified.isEmpty&&t.lineRangeMapping.innerChanges){const e=i.add(new tZ(t.lineRangeMapping.modified.startLineNumber,this._widget,t.lineRangeMapping,!1));this._editors.modified.addGlyphMarginWidget(e),n.push(e)}i.add(Zi((()=>{for(const t of n)this._editors.modified.removeGlyphMarginWidget(t)})))})))}}class tZ extends Qi{getId(){return this._id}constructor(t,i,e,s){super(),this._lineNumber=t,this._widget=i,this._diffs=e,this._revertSelection=s,this._id="revertButton"+tZ.counter++,this._domNode=ml("div.revertButton",{title:this._revertSelection?tt(0,"Revert Selected Changes"):tt(0,"Revert Change")},[yI(As.arrowRight)]).root,this._register(sc(this._domNode,qc.MOUSE_DOWN,(t=>{t.button!==2&&(t.stopPropagation(),t.preventDefault())}))),this._register(sc(this._domNode,qc.MOUSE_UP,(t=>{t.stopPropagation(),t.preventDefault()}))),this._register(sc(this._domNode,qc.CLICK,(t=>{this._diffs instanceof Lg?this._widget.revert(this._diffs):this._widget.revertRangeMappings(this._diffs),t.stopPropagation(),t.preventDefault()})))}getDomNode(){return this._domNode}getPosition(){return{lane:Xf.Right,range:{startColumn:1,startLineNumber:this._lineNumber,endColumn:1,endLineNumber:this._lineNumber},zIndex:10001}}}tZ.counter=0;var iZ=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},eZ=function(t,i){return function(e,s){i(e,s,t)}};let sZ=class extends Qi{get onDidContentSizeChange(){return this._onDidContentSizeChange.event}constructor(t,i,e,s,n,r,o){super(),this.originalEditorElement=t,this.modifiedEditorElement=i,this._options=e,this._argCodeEditorWidgetOptions=s,this._createInnerEditor=n,this._instantiationService=r,this._keybindingService=o,this.original=this._register(this._createLeftHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.originalEditor||{})),this.modified=this._register(this._createRightHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.modifiedEditor||{})),this._onDidContentSizeChange=this._register(new le),this.modifiedScrollTop=e$(this.modified.onDidScrollChange,(()=>this.modified.getScrollTop())),this.modifiedScrollHeight=e$(this.modified.onDidScrollChange,(()=>this.modified.getScrollHeight())),this.modifiedModel=e$(this.modified.onDidChangeModel,(()=>this.modified.getModel())),this.modifiedSelections=e$(this.modified.onDidChangeCursorSelection,(()=>{var t;return(t=this.modified.getSelections())!==null&&t!==void 0?t:[]})),this.modifiedCursor=UB({owner:this,equalityComparer:ks.equals},(t=>{var i,e;return(e=(i=this.modifiedSelections.read(t)[0])===null||i===void 0?void 0:i.getPosition())!==null&&e!==void 0?e:new ks(1,1)})),this.originalCursor=e$(this.original.onDidChangeCursorPosition,(()=>{var t;return(t=this.original.getPosition())!==null&&t!==void 0?t:new ks(1,1)})),this._argCodeEditorWidgetOptions=null,this._register(QB({createEmptyChangeSummary:()=>({}),handleChange:(t,i)=>(t.didChange(e.editorOptions)&&Object.assign(i,t.change.changedOptions),!0)},((t,i)=>{e.editorOptions.read(t),this._options.renderSideBySide.read(t),this.modified.updateOptions(this._adjustOptionsForRightHandSide(t,i)),this.original.updateOptions(this._adjustOptionsForLeftHandSide(t,i))})))}_createLeftHandSideEditor(t,i){const e=this._adjustOptionsForLeftHandSide(void 0,t),s=this._constructInnerEditor(this._instantiationService,this.originalEditorElement,e,i);return s.setContextValue("isInDiffLeftEditor",!0),s}_createRightHandSideEditor(t,i){const e=this._adjustOptionsForRightHandSide(void 0,t),s=this._constructInnerEditor(this._instantiationService,this.modifiedEditorElement,e,i);return s.setContextValue("isInDiffRightEditor",!0),s}_constructInnerEditor(t,i,e,s){const n=this._createInnerEditor(t,i,e,s);return this._register(n.onDidContentSizeChange((t=>{const i=this.original.getContentWidth()+this.modified.getContentWidth()+QG.ENTIRE_DIFF_OVERVIEW_WIDTH,e=Math.max(this.modified.getContentHeight(),this.original.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:e,contentWidth:i,contentHeightChanged:t.contentHeightChanged,contentWidthChanged:t.contentWidthChanged})}))),n}_adjustOptionsForLeftHandSide(t,i){const e=this._adjustOptionsForSubEditor(i);return this._options.renderSideBySide.get()?(e.unicodeHighlight=this._options.editorOptions.get().unicodeHighlight||{},e.wordWrapOverride1=this._options.diffWordWrap.get()):(e.wordWrapOverride1="off",e.wordWrapOverride2="off",e.stickyScroll={enabled:!1},e.unicodeHighlight={nonBasicASCII:!1,ambiguousCharacters:!1,invisibleCharacters:!1}),e.glyphMargin=this._options.renderSideBySide.get(),i.originalAriaLabel&&(e.ariaLabel=i.originalAriaLabel),e.ariaLabel=this._updateAriaLabel(e.ariaLabel),e.readOnly=!this._options.originalEditable.get(),e.dropIntoEditor={enabled:!e.readOnly},e.extraEditorClassName="original-in-monaco-diff-editor",e}_adjustOptionsForRightHandSide(t,i){const e=this._adjustOptionsForSubEditor(i);return i.modifiedAriaLabel&&(e.ariaLabel=i.modifiedAriaLabel),e.ariaLabel=this._updateAriaLabel(e.ariaLabel),e.wordWrapOverride1=this._options.diffWordWrap.get(),e.revealHorizontalRightPadding=Ri.revealHorizontalRightPadding.defaultValue+QG.ENTIRE_DIFF_OVERVIEW_WIDTH,e.scrollbar.verticalHasArrows=!1,e.extraEditorClassName="modified-in-monaco-diff-editor",e}_adjustOptionsForSubEditor(t){const i={...t,dimension:{height:0,width:0}};return i.inDiffEditor=!0,i.automaticLayout=!1,i.scrollbar={...i.scrollbar||{}},i.folding=!1,i.codeLens=this._options.diffCodeLens.get(),i.fixedOverflowWidgets=!0,i.minimap={...i.minimap||{}},i.minimap.enabled=!1,this._options.hideUnchangedRegions.get()?i.stickyScroll={enabled:!1}:i.stickyScroll=this._options.editorOptions.get().stickyScroll,i}_updateAriaLabel(t){var i;t||(t="");const e=tt(0," use {0} to open the accessibility help.",(i=this._keybindingService.lookupKeybinding("editor.action.accessibilityHelp"))===null||i===void 0?void 0:i.getAriaLabel());return this._options.accessibilityVerbose.get()?t+e:t?t.replaceAll(e,""):""}};sZ=iZ([eZ(5,Il),eZ(6,NS)],sZ);class nZ extends Qi{constructor(){super(...arguments),this._id=++nZ.idCounter,this._onDidDispose=this._register(new le),this.onDidDispose=this._onDidDispose.event}getId(){return this.getEditorType()+":v2:"+this._id}getVisibleColumnFromPosition(t){return this._targetEditor.getVisibleColumnFromPosition(t)}getPosition(){return this._targetEditor.getPosition()}setPosition(t,i="api"){this._targetEditor.setPosition(t,i)}revealLine(t,i=0){this._targetEditor.revealLine(t,i)}revealLineInCenter(t,i=0){this._targetEditor.revealLineInCenter(t,i)}revealLineInCenterIfOutsideViewport(t,i=0){this._targetEditor.revealLineInCenterIfOutsideViewport(t,i)}revealLineNearTop(t,i=0){this._targetEditor.revealLineNearTop(t,i)}revealPosition(t,i=0){this._targetEditor.revealPosition(t,i)}revealPositionInCenter(t,i=0){this._targetEditor.revealPositionInCenter(t,i)}revealPositionInCenterIfOutsideViewport(t,i=0){this._targetEditor.revealPositionInCenterIfOutsideViewport(t,i)}revealPositionNearTop(t,i=0){this._targetEditor.revealPositionNearTop(t,i)}getSelection(){return this._targetEditor.getSelection()}getSelections(){return this._targetEditor.getSelections()}setSelection(t,i="api"){this._targetEditor.setSelection(t,i)}setSelections(t,i="api"){this._targetEditor.setSelections(t,i)}revealLines(t,i,e=0){this._targetEditor.revealLines(t,i,e)}revealLinesInCenter(t,i,e=0){this._targetEditor.revealLinesInCenter(t,i,e)}revealLinesInCenterIfOutsideViewport(t,i,e=0){this._targetEditor.revealLinesInCenterIfOutsideViewport(t,i,e)}revealLinesNearTop(t,i,e=0){this._targetEditor.revealLinesNearTop(t,i,e)}revealRange(t,i=0,e=!1,s=!0){this._targetEditor.revealRange(t,i,e,s)}revealRangeInCenter(t,i=0){this._targetEditor.revealRangeInCenter(t,i)}revealRangeInCenterIfOutsideViewport(t,i=0){this._targetEditor.revealRangeInCenterIfOutsideViewport(t,i)}revealRangeNearTop(t,i=0){this._targetEditor.revealRangeNearTop(t,i)}revealRangeNearTopIfOutsideViewport(t,i=0){this._targetEditor.revealRangeNearTopIfOutsideViewport(t,i)}revealRangeAtTop(t,i=0){this._targetEditor.revealRangeAtTop(t,i)}getSupportedActions(){return this._targetEditor.getSupportedActions()}focus(){this._targetEditor.focus()}trigger(t,i,e){this._targetEditor.trigger(t,i,e)}createDecorationsCollection(t){return this._targetEditor.createDecorationsCollection(t)}changeDecorations(t){return this._targetEditor.changeDecorations(t)}}nZ.idCounter=0;var rZ=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},oZ=function(t,i){return function(e,s){i(e,s,t)}};let hZ=class{get editorOptions(){return this._options}constructor(t,i){this._accessibilityService=i,this._diffEditorWidth=$B(this,0),this._screenReaderMode=e$(this._accessibilityService.onDidChangeScreenReaderOptimized,(()=>this._accessibilityService.isScreenReaderOptimized())),this.couldShowInlineViewBecauseOfSize=zB(this,(t=>this._options.read(t).renderSideBySide&&this._diffEditorWidth.read(t)<=this._options.read(t).renderSideBySideInlineBreakpoint)),this.renderOverviewRuler=zB(this,(t=>this._options.read(t).renderOverviewRuler)),this.renderSideBySide=zB(this,(t=>this._options.read(t).renderSideBySide&&!(this._options.read(t).useInlineViewWhenSpaceIsLimited&&this.couldShowInlineViewBecauseOfSize.read(t)&&!this._screenReaderMode.read(t)))),this.readOnly=zB(this,(t=>this._options.read(t).readOnly)),this.shouldRenderOldRevertArrows=zB(this,(t=>!!this._options.read(t).renderMarginRevertIcon&&!!this.renderSideBySide.read(t)&&!this.readOnly.read(t)&&!this.shouldRenderGutterMenu.read(t))),this.shouldRenderGutterMenu=zB(this,(t=>this._options.read(t).renderGutterMenu)),this.renderIndicators=zB(this,(t=>this._options.read(t).renderIndicators)),this.enableSplitViewResizing=zB(this,(t=>this._options.read(t).enableSplitViewResizing)),this.splitViewDefaultRatio=zB(this,(t=>this._options.read(t).splitViewDefaultRatio)),this.ignoreTrimWhitespace=zB(this,(t=>this._options.read(t).ignoreTrimWhitespace)),this.maxComputationTimeMs=zB(this,(t=>this._options.read(t).maxComputationTime)),this.showMoves=zB(this,(t=>this._options.read(t).experimental.showMoves&&this.renderSideBySide.read(t))),this.isInEmbeddedEditor=zB(this,(t=>this._options.read(t).isInEmbeddedEditor)),this.diffWordWrap=zB(this,(t=>this._options.read(t).diffWordWrap)),this.originalEditable=zB(this,(t=>this._options.read(t).originalEditable)),this.diffCodeLens=zB(this,(t=>this._options.read(t).diffCodeLens)),this.accessibilityVerbose=zB(this,(t=>this._options.read(t).accessibilityVerbose)),this.diffAlgorithm=zB(this,(t=>this._options.read(t).diffAlgorithm)),this.showEmptyDecorations=zB(this,(t=>this._options.read(t).experimental.showEmptyDecorations)),this.onlyShowAccessibleDiffViewer=zB(this,(t=>this._options.read(t).onlyShowAccessibleDiffViewer)),this.hideUnchangedRegions=zB(this,(t=>this._options.read(t).hideUnchangedRegions.enabled)),this.hideUnchangedRegionsRevealLineCount=zB(this,(t=>this._options.read(t).hideUnchangedRegions.revealLineCount)),this.hideUnchangedRegionsContextLineCount=zB(this,(t=>this._options.read(t).hideUnchangedRegions.contextLineCount)),this.hideUnchangedRegionsMinimumLineCount=zB(this,(t=>this._options.read(t).hideUnchangedRegions.minimumLineCount));const e={...t,...cZ(t,WP)};this._options=$B(this,e)}updateOptions(t){const i=cZ(t,this._options.get()),e={...this._options.get(),...t,...i};this._options.set(e,void 0,{changedOptions:t})}setWidth(t){this._diffEditorWidth.set(t,void 0)}};function cZ(t,i){var e,s,n,r,o,h,c,l;return{enableSplitViewResizing:ei(t.enableSplitViewResizing,i.enableSplitViewResizing),splitViewDefaultRatio:oi(t.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:ei(t.renderSideBySide,i.renderSideBySide),renderMarginRevertIcon:ei(t.renderMarginRevertIcon,i.renderMarginRevertIcon),maxComputationTime:ni(t.maxComputationTime,i.maxComputationTime,0,1073741824),maxFileSize:ni(t.maxFileSize,i.maxFileSize,0,1073741824),ignoreTrimWhitespace:ei(t.ignoreTrimWhitespace,i.ignoreTrimWhitespace),renderIndicators:ei(t.renderIndicators,i.renderIndicators),originalEditable:ei(t.originalEditable,i.originalEditable),diffCodeLens:ei(t.diffCodeLens,i.diffCodeLens),renderOverviewRuler:ei(t.renderOverviewRuler,i.renderOverviewRuler),diffWordWrap:li(t.diffWordWrap,i.diffWordWrap,["off","on","inherit"]),diffAlgorithm:li(t.diffAlgorithm,i.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:ei(t.accessibilityVerbose,i.accessibilityVerbose),experimental:{showMoves:ei((e=t.experimental)===null||e===void 0?void 0:e.showMoves,i.experimental.showMoves),showEmptyDecorations:ei((s=t.experimental)===null||s===void 0?void 0:s.showEmptyDecorations,i.experimental.showEmptyDecorations)},hideUnchangedRegions:{enabled:ei((r=(n=t.hideUnchangedRegions)===null||n===void 0?void 0:n.enabled)!==null&&r!==void 0?r:(o=t.experimental)===null||o===void 0?void 0:o.collapseUnchangedRegions,i.hideUnchangedRegions.enabled),contextLineCount:ni((h=t.hideUnchangedRegions)===null||h===void 0?void 0:h.contextLineCount,i.hideUnchangedRegions.contextLineCount,0,1073741824),minimumLineCount:ni((c=t.hideUnchangedRegions)===null||c===void 0?void 0:c.minimumLineCount,i.hideUnchangedRegions.minimumLineCount,0,1073741824),revealLineCount:ni((l=t.hideUnchangedRegions)===null||l===void 0?void 0:l.revealLineCount,i.hideUnchangedRegions.revealLineCount,0,1073741824)},isInEmbeddedEditor:ei(t.isInEmbeddedEditor,i.isInEmbeddedEditor),onlyShowAccessibleDiffViewer:ei(t.onlyShowAccessibleDiffViewer,i.onlyShowAccessibleDiffViewer),renderSideBySideInlineBreakpoint:ni(t.renderSideBySideInlineBreakpoint,i.renderSideBySideInlineBreakpoint,0,1073741824),useInlineViewWhenSpaceIsLimited:ei(t.useInlineViewWhenSpaceIsLimited,i.useInlineViewWhenSpaceIsLimited),renderGutterMenu:ei(t.renderGutterMenu,i.renderGutterMenu)}}hZ=rZ([oZ(1,vw)],hZ);class lZ extends Qi{constructor(t,i,e){super(),this._editor=t,this._domNode=i,this.itemProvider=e,this.scrollTop=e$(this._editor.onDidScrollChange,(t=>this._editor.getScrollTop())),this.isScrollTopZero=this.scrollTop.map((t=>t===0)),this.modelAttached=e$(this._editor.onDidChangeModel,(t=>this._editor.hasModel())),this.editorOnDidChangeViewZones=n$("onDidChangeViewZones",this._editor.onDidChangeViewZones),this.editorOnDidContentSizeChange=n$("onDidContentSizeChange",this._editor.onDidContentSizeChange),this.domNodeSizeChanged=o$("domNodeSizeChanged"),this.views=new Map,this._domNode.className="gutter monaco-editor";const s=this._domNode.appendChild(ml("div.scroll-decoration",{role:"presentation",ariaHidden:"true",style:{width:"100%"}}).root),n=new ResizeObserver((()=>{_B((t=>{this.domNodeSizeChanged.trigger(t)}))}));n.observe(this._domNode),this._register(Zi((()=>n.disconnect()))),this._register(ZB((t=>{s.className=this.isScrollTopZero.read(t)?"":"scroll-decoration"}))),this._register(ZB((t=>this.render(t))))}dispose(){super.dispose(),tl(this._domNode)}render(t){if(!this.modelAttached.read(t))return;this.domNodeSizeChanged.read(t),this.editorOnDidChangeViewZones.read(t),this.editorOnDidContentSizeChange.read(t);const i=this.scrollTop.read(t),e=this._editor.getVisibleRanges(),s=new Set(this.views.keys()),n=vg.ofStartAndLength(0,this._domNode.clientHeight);if(!n.isEmpty)for(const r of e){const e=new Ag(r.startLineNumber,r.endLineNumber+1),o=this.itemProvider.getIntersectingGutterItems(e,t);_B((t=>{for(const r of o){if(!r.range.intersect(e))continue;s.delete(r.id);let o=this.views.get(r.id);if(o)o.item.set(r,t);else{const t=document.createElement("div");this._domNode.appendChild(t);const i=$B("item",r),e=this.itemProvider.createView(i,t);o=new aZ(i,e,t),this.views.set(r.id,o)}const h=r.range.startLineNumber<=this._editor.getModel().getLineCount()?this._editor.getTopForLineNumber(r.range.startLineNumber,!0)-i:this._editor.getBottomForLineNumber(r.range.startLineNumber-1,!1)-i,c=(r.range.isEmpty?h:this._editor.getBottomForLineNumber(r.range.endLineNumberExclusive-1,!0)-i)-h;o.domNode.style.top=`${h}px`,o.domNode.style.height=`${c}px`,o.gutterItemView.layout(vg.ofStartAndLength(h,c),n)}}))}for(const t of s){const i=this.views.get(t);i.gutterItemView.dispose(),this._domNode.removeChild(i.domNode),this.views.delete(t)}}}class aZ{constructor(t,i,e){this.item=t,this.gutterItemView=i,this.domNode=e}}class uZ extends Wl{constructor(t){super(),this._getContext=t}runAction(t,i){const e=this._getContext();return super.runAction(t,e)}}class dZ{constructor(t){this.text=t,this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let i=0;i<t.length;i++)t.charAt(i)===`\n`&&this.lineStartOffsetByLineIdx.push(i+1)}getOffset(t){return this.lineStartOffsetByLineIdx[t.lineNumber-1]+t.column-1}getOffsetRange(t){return new vg(this.getOffset(t.getStartPosition()),this.getOffset(t.getEndPosition()))}get textLength(){const t=this.lineStartOffsetByLineIdx.length-1;return new eA(t,this.text.length-this.lineStartOffsetByLineIdx[t])}}class fZ{constructor(t){this.edits=t,ja((()=>Ha(t,((t,i)=>t.range.getEndPosition().isBeforeOrEqual(i.range.getStartPosition())))))}apply(t){let i="",e=new ks(1,1);for(const s of this.edits){const n=s.range,r=n.getStartPosition(),o=n.getEndPosition(),h=pZ(e,r);h.isEmpty()||(i+=t.getValueOfRange(h)),i+=s.text,e=o}const s=pZ(e,t.endPositionExclusive);return s.isEmpty()||(i+=t.getValueOfRange(s)),i}applyToString(t){const i=new wZ(t);return this.apply(i)}getNewRanges(){const t=[];let i=0,e=0,s=0;for(const n of this.edits){const r=eA.ofText(n.text),o=ks.lift({lineNumber:n.range.startLineNumber+e,column:n.range.startColumn+(n.range.startLineNumber===i?s:0)}),h=r.createRange(o);t.push(h),e=h.endLineNumber-n.range.endLineNumber,s=h.endColumn-n.range.endColumn,i=n.range.endLineNumber}return t}}class gZ{constructor(t,i){this.range=t,this.text=i}}function pZ(t,i){if(!t.isBeforeOrEqual(i))throw new zi("start must be before end");return new Cs(t.lineNumber,t.column,i.lineNumber,i.column)}class mZ{get endPositionExclusive(){return this.length.addToPosition(new ks(1,1))}}class wZ extends mZ{constructor(t){super(),this.value=t,this._t=new dZ(this.value)}getValueOfRange(t){return this._t.getOffsetRange(t).substring(this.value)}get length(){return this._t.textLength}}class vZ extends mZ{constructor(t){super(),this._textModel=t}getValueOfRange(t){return this._textModel.getValueInRange(t)}get length(){const t=this._textModel.getLineCount(),i=this._textModel.getLineLength(t);return new eA(t-1,i)}}class bZ extends Qi{constructor(t,i,e={orientation:0}){var s;super(),this.submenuActionViewItems=[],this.hasSecondaryActions=!1,this._onDidChangeDropdownVisibility=this._register(new ge),this.onDidChangeDropdownVisibility=this._onDidChangeDropdownVisibility.event,this.disposables=this._register(new Ji),e.hoverDelegate=(s=e.hoverDelegate)!==null&&s!==void 0?s:this._register(oB()),this.options=e,this.lookupKeybindings=typeof this.options.getKeyBinding=="function",this.toggleMenuAction=this._register(new yZ((()=>{var t;return(t=this.toggleMenuActionViewItem)===null||t===void 0?void 0:t.show()}),e.toggleMenuTitle)),this.element=document.createElement("div"),this.element.className="monaco-toolbar",t.appendChild(this.element),this.actionBar=this._register(new LW(this.element,{orientation:e.orientation,ariaLabel:e.ariaLabel,actionRunner:e.actionRunner,allowContextMenu:e.allowContextMenu,highlightToggledItems:e.highlightToggledItems,hoverDelegate:e.hoverDelegate,actionViewItemProvider:(t,s)=>{var n;if(t.id===yZ.ID)return this.toggleMenuActionViewItem=new Y$(t,t.menuActions,i,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:Kl.asClassNameArray((n=e.moreIcon)!==null&&n!==void 0?n:As.toolBarMore),anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,isMenu:!0,hoverDelegate:this.options.hoverDelegate}),this.toggleMenuActionViewItem.setActionContext(this.actionBar.context),this.disposables.add(this._onDidChangeDropdownVisibility.add(this.toggleMenuActionViewItem.onDidChangeVisibility)),this.toggleMenuActionViewItem;if(e.actionViewItemProvider){const i=e.actionViewItemProvider(t,s);if(i)return i}if(t instanceof Hl){const e=new Y$(t,t.actions,i,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:t.class,anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,hoverDelegate:this.options.hoverDelegate});return e.setActionContext(this.actionBar.context),this.submenuActionViewItems.push(e),this.disposables.add(this._onDidChangeDropdownVisibility.add(e.onDidChangeVisibility)),e}}}))}set actionRunner(t){this.actionBar.actionRunner=t}get actionRunner(){return this.actionBar.actionRunner}getElement(){return this.element}getItemAction(t){return this.actionBar.getAction(t)}setActions(t,i){this.clear();const e=t?t.slice(0):[];this.hasSecondaryActions=!!(i&&i.length>0),this.hasSecondaryActions&&i&&(this.toggleMenuAction.menuActions=i.slice(0),e.push(this.toggleMenuAction)),e.forEach((t=>{this.actionBar.push(t,{icon:!0,label:!1,keybinding:this.getKeybindingLabel(t)})}))}getKeybindingLabel(t){var i,e,s;const n=this.lookupKeybindings?(e=(i=this.options).getKeyBinding)===null||e===void 0?void 0:e.call(i,t):void 0;return(s=n==null?void 0:n.getLabel())!==null&&s!==void 0?s:void 0}clear(){this.submenuActionViewItems=[],this.disposables.clear(),this.actionBar.clear()}dispose(){this.clear(),this.disposables.dispose(),super.dispose()}}class yZ extends $l{constructor(t,i){i=i||tt(0,"More Actions..."),super(yZ.ID,i,void 0,!0),this._menuActions=[],this.toggleDropdownMenu=t}async run(){this.toggleDropdownMenu()}get menuActions(){return this._menuActions}set menuActions(t){this._menuActions=t}}yZ.ID="toolbar.toggle.more";var kZ=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},CZ=function(t,i){return function(e,s){i(e,s,t)}};let SZ=class extends bZ{constructor(t,i,e,s,n,r,o){super(t,n,{getKeyBinding:t=>{var i;return(i=r.lookupKeybinding(t.id))!==null&&i!==void 0?i:void 0},...i,allowContextMenu:!0,skipTelemetry:typeof(i==null?void 0:i.telemetrySource)=="string"}),this._options=i,this._menuService=e,this._contextKeyService=s,this._contextMenuService=n,this._sessionDisposables=this._store.add(new Ji);const h=i==null?void 0:i.telemetrySource;h&&this._store.add(this.actionBar.onDidRun((t=>o.publicLog2("workbenchActionExecuted",{id:t.action.id,from:h}))))}setActions(t,i=[],e){var s,n,r;this._sessionDisposables.clear();const o=t.slice(),h=i.slice(),c=[];let l=0;const a=[];let d=!1;if(((s=this._options)===null||s===void 0?void 0:s.hiddenItemStrategy)!==-1)for(let t=0;t<o.length;t++){const i=o[t];(i instanceof eu||i instanceof iu)&&i.hideActions&&(c.push(i.hideActions.toggle),i.hideActions.toggle.checked&&l++,i.hideActions.isHidden&&(d=!0,o[t]=void 0,((n=this._options)===null||n===void 0?void 0:n.hiddenItemStrategy)!==0&&(a[t]=i)))}if(((r=this._options)===null||r===void 0?void 0:r.overflowBehavior)!==void 0){const t=function(t,i){const e=new Set;for(const s of i)t.has(s)&&e.add(s);return e}(new Set(this._options.overflowBehavior.exempted),Wt.map(o,(t=>t==null?void 0:t.id))),i=this._options.overflowBehavior.maxItems-t.size;let e=0;for(let s=0;s<o.length;s++){const n=o[s];n&&(e++,t.has(n.id)||e>=i&&(o[s]=void 0,a[s]=n))}}u(o),u(a),super.setActions(o,jl.join(a,h)),c.length>0&&this._sessionDisposables.add(sc(this.getElement(),"contextmenu",(t=>{var i,s,n,r,o;const h=new ho(Uh(this.getElement()),t),a=this.getItemAction(h.target);if(!a)return;h.preventDefault(),h.stopPropagation();let u,f=!1;if(l===1&&((i=this._options)===null||i===void 0?void 0:i.hiddenItemStrategy)===0){f=!0;for(let t=0;t<c.length;t++)if(c[t].checked){c[t]=zl({id:a.id,label:a.label,checked:!0,enabled:!1,run(){}});break}}if(!f&&(a instanceof eu||a instanceof iu)){if(!a.hideActions)return;u=a.hideActions.hide}else u=zl({id:"label",label:tt(0,"Hide"),enabled:!1,run(){}});const g=jl.join([u],c);!((s=this._options)===null||s===void 0)&&s.resetMenu&&!e&&(e=[this._options.resetMenu]),d&&e&&(g.push(new jl),g.push(zl({id:"resetThisMenu",label:tt(0,"Reset Menu"),run:()=>this._menuService.resetHiddenStates(e)}))),this._contextMenuService.showContextMenu({getAnchor:()=>h,getActions:()=>g,menuId:(n=this._options)===null||n===void 0?void 0:n.contextMenu,menuActionOptions:{renderShortTitle:!0,...(r=this._options)===null||r===void 0?void 0:r.menuOptions},skipTelemetry:typeof((o=this._options)===null||o===void 0?void 0:o.telemetrySource)=="string",contextKeyService:this._contextKeyService})})))}};SZ=kZ([CZ(2,Ya),CZ(3,Ra),CZ(4,oI),CZ(5,NS),CZ(6,ru)],SZ);let xZ=class extends SZ{constructor(t,i,e,s,n,r,o,h){super(t,{resetMenu:i,...e},s,n,r,o,h),this._onDidChangeMenuItems=this._store.add(new le),this.onDidChangeMenuItems=this._onDidChangeMenuItems.event;const c=this._store.add(s.createMenu(i,n,{emitEventsForSubmenuChanges:!0})),l=()=>{var i,s,n;const r=[],o=[];CW(c,e==null?void 0:e.menuOptions,{primary:r,secondary:o},(i=e==null?void 0:e.toolbarOptions)===null||i===void 0?void 0:i.primaryGroup,(s=e==null?void 0:e.toolbarOptions)===null||s===void 0?void 0:s.shouldInlineSubmenu,(n=e==null?void 0:e.toolbarOptions)===null||n===void 0?void 0:n.useSeparatorsInPrimaryActions),t.classList.toggle("has-no-actions",r.length===0&&o.length===0),super.setActions(r,o)};this._store.add(c.onDidChange((()=>{l(),this._onDidChangeMenuItems.fire(this)}))),l()}setActions(){throw new zi("This toolbar is populated from a menu.")}};xZ=kZ([CZ(3,Ya),CZ(4,Ra),CZ(5,oI),CZ(6,NS),CZ(7,ru)],xZ);var DZ=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},EZ=function(t,i){return function(e,s){i(e,s,t)}};const AZ=[];let MZ=class extends Qi{constructor(t,i,e,s,n,r){var o,h;super(),this._diffModel=i,this._editors=e,this._instantiationService=s,this._contextKeyService=n,this._menuService=r,this._menu=this._register(this._menuService.createMenu(Qa.DiffEditorHunkToolbar,this._contextKeyService)),this._actions=e$(this._menu.onDidChange,(()=>this._menu.getActions())),this._hasActions=this._actions.map((t=>t.length>0)),this.width=zB(this,(t=>this._hasActions.read(t)?35:0)),this.elements=ml("div.gutter@gutter",{style:{position:"absolute",height:"100%",width:"35px"}},[]),this._currentDiff=zB(this,(t=>{var i;const e=this._diffModel.read(t);if(!e)return;const s=(i=e.diff.read(t))===null||i===void 0?void 0:i.mappings,n=this._editors.modifiedCursor.read(t);return n?s==null?void 0:s.find((t=>t.lineRangeMapping.modified.contains(n.lineNumber))):void 0})),this._selectedDiffs=zB(this,(t=>{const i=this._diffModel.read(t),e=i==null?void 0:i.diff.read(t);if(!e)return AZ;const s=this._editors.modifiedSelections.read(t);if(s.every((t=>t.isEmpty())))return AZ;const n=new Mg(s.map((t=>Ag.fromRangeInclusive(t)))),r=e.mappings.filter((t=>t.lineRangeMapping.innerChanges&&n.intersects(t.lineRangeMapping.modified))).map((t=>({mapping:t,rangeMappings:t.lineRangeMapping.innerChanges.filter((t=>s.some((i=>Cs.areIntersecting(t.modifiedRange,i)))))})));return r.length===0||r.every((t=>t.rangeMappings.length===0))?AZ:r})),this._register((o=t,h=this.elements.root,o.prepend(h),Zi((()=>{o.removeChild(h)})))),this._register(sc(this.elements.root,"click",(()=>{this._editors.modified.focus()}))),this._register(_q(this.elements.root,{display:this._hasActions.map((t=>t?"block":"none"))})),this._register(new lZ(this._editors.modified,this.elements.root,{getIntersectingGutterItems:(t,i)=>{const e=this._diffModel.read(i);if(!e)return[];const s=e.diff.read(i);if(!s)return[];const n=this._selectedDiffs.read(i);if(n.length>0){const t=Fg.fromRangeMappings(n.flatMap((t=>t.rangeMappings)));return[new LZ(t,!0,Qa.DiffEditorSelectionToolbar,void 0,e.model.original.uri,e.model.modified.uri)]}const r=this._currentDiff.read(i);return s.mappings.map((t=>new LZ(t.lineRangeMapping.withInnerChangesFromLineRanges(),t.lineRangeMapping===(r==null?void 0:r.lineRangeMapping),Qa.DiffEditorHunkToolbar,void 0,e.model.original.uri,e.model.modified.uri)))},createView:(t,i)=>this._instantiationService.createInstance(FZ,t,i,this)})),this._register(sc(this.elements.gutter,qc.MOUSE_WHEEL,(t=>{this._editors.modified.getOption(103).handleMouseWheel&&this._editors.modified.delegateScrollFromMouseWheelEvent(t)}),{passive:!1}))}computeStagedValue(t){var i;const e=(i=t.innerChanges)!==null&&i!==void 0?i:[];return new fZ(e.map((t=>new gZ(t.originalRange,this._editors.modifiedModel.get().getValueInRange(t.modifiedRange))))).apply(new vZ(this._editors.original.getModel()))}layout(t){this.elements.gutter.style.left=t+"px"}};MZ=DZ([EZ(3,Il),EZ(4,Ra),EZ(5,Ya)],MZ);class LZ{constructor(t,i,e,s,n,r){this.mapping=t,this.showAlways=i,this.menuId=e,this.rangeOverride=s,this.originalUri=n,this.modifiedUri=r}get id(){return this.mapping.modified.toString()}get range(){var t;return(t=this.rangeOverride)!==null&&t!==void 0?t:this.mapping.modified}}let FZ=class extends Qi{constructor(t,i,e,s){super(),this._item=t,this._elements=ml("div.gutterItem",{style:{height:"20px",width:"34px"}},[ml("div.background@background",{},[]),ml("div.buttons@buttons",{},[])]),this._showAlways=this._item.map(this,(t=>t.showAlways)),this._menuId=this._item.map(this,(t=>t.menuId)),this._isSmall=$B(this,!1),this._lastItemRange=void 0,this._lastViewRange=void 0;const n=this._register(s.createInstance(nI,"element",!0,{position:{hoverPosition:1}}));this._register(Lq(i,this._elements.root)),this._register(ZB((t=>{const i=this._showAlways.read(t);this._elements.root.classList.toggle("noTransition",!0),this._elements.root.classList.toggle("showAlways",i),setTimeout((()=>{this._elements.root.classList.toggle("noTransition",!1)}),0)}))),this._register(YB(((t,i)=>{this._elements.buttons.replaceChildren();const r=i.add(s.createInstance(xZ,this._elements.buttons,this._menuId.read(t),{orientation:1,hoverDelegate:n,toolbarOptions:{primaryGroup:t=>t.startsWith("primary")},overflowBehavior:{maxItems:this._isSmall.read(t)?1:3},hiddenItemStrategy:0,actionRunner:new uZ((()=>{const t=this._item.get(),i=t.mapping;return{mapping:i,originalWithModifiedChanges:e.computeStagedValue(i),originalUri:t.originalUri,modifiedUri:t.modifiedUri}})),menuOptions:{shouldForwardArgs:!0}}));i.add(r.onDidChangeMenuItems((()=>{this._lastItemRange&&this.layout(this._lastItemRange,this._lastViewRange)})))})))}layout(t,i){this._lastItemRange=t,this._lastViewRange=i;let e=this._elements.buttons.clientHeight;this._isSmall.set(this._item.get().mapping.original.startLineNumber===1&&t.length<30,void 0),e=this._elements.buttons.clientHeight,this._elements.root.style.top=t.start+"px",this._elements.root.style.height=t.length+"px";const s=t.length/2-e/2,n=e;let r=t.start+s;const o=vg.tryCreate(n,i.endExclusive-n-e),h=vg.tryCreate(t.start+n,t.endExclusive-e-n);h&&o&&h.start<h.endExclusive&&(r=o.clip(r),r=h.clip(r)),this._elements.buttons.style.top=r-t.start+"px"}};FZ=DZ([EZ(3,Il)],FZ);var TZ=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},RZ=function(t,i){return function(e,s){i(e,s,t)}};let OZ=class extends nZ{get onDidContentSizeChange(){return this._editors.onDidContentSizeChange}constructor(t,i,e,s,n,r,o,h){var c;super(),this._domElement=t,this._parentContextKeyService=s,this._parentInstantiationService=n,this._accessibilitySignalService=o,this._editorProgressService=h,this.elements=ml("div.monaco-diff-editor.side-by-side",{style:{position:"relative",height:"100%"}},[ml("div.noModificationsOverlay@overlay",{style:{position:"absolute",height:"100%",visibility:"hidden"}},[nl("span",{},"No Changes")]),ml("div.editor.original@original",{style:{position:"absolute",height:"100%"}}),ml("div.editor.modified@modified",{style:{position:"absolute",height:"100%"}}),ml("div.accessibleDiffViewer@accessibleDiffViewer",{style:{position:"absolute",height:"100%"}})]),this._diffModel=$B(this,void 0),this._shouldDisposeDiffModel=!1,this.onDidChangeModel=ne.fromObservableLight(this._diffModel),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._domElement)),this._instantiationService=this._parentInstantiationService.createChild(new aR([Ra,this._contextKeyService])),this._boundarySashes=$B(this,void 0),this._accessibleDiffViewerShouldBeVisible=$B(this,!1),this._accessibleDiffViewerVisible=zB(this,(t=>!!this._options.onlyShowAccessibleDiffViewer.read(t)||this._accessibleDiffViewerShouldBeVisible.read(t))),this._movedBlocksLinesPart=$B(this,void 0),this._layoutInfo=zB(this,(t=>{var i,e,s,n,r;const o=this._rootSizeObserver.width.read(t),h=this._rootSizeObserver.height.read(t),c=this._sash.read(t),l=this._gutter.read(t),a=(i=l==null?void 0:l.width.read(t))!==null&&i!==void 0?i:0,u=(s=(e=this._overviewRulerPart.read(t))===null||e===void 0?void 0:e.width)!==null&&s!==void 0?s:0;let d,f,g,p,m;if(c){const i=c.sashLeft.read(t);d=0,f=i-a-((r=(n=this._movedBlocksLinesPart.read(t))===null||n===void 0?void 0:n.width.read(t))!==null&&r!==void 0?r:0),m=i-a,g=i,p=o-g-u}else m=0,d=a,f=Math.max(5,this._editors.original.getLayoutInfo().decorationsLeft),g=a+f,p=o-g-u;return this.elements.original.style.left=d+"px",this.elements.original.style.width=f+"px",this._editors.original.layout({width:f,height:h},!0),l==null||l.layout(m),this.elements.modified.style.left=g+"px",this.elements.modified.style.width=p+"px",this._editors.modified.layout({width:p,height:h},!0),{modifiedEditor:this._editors.modified.getLayoutInfo(),originalEditor:this._editors.original.getLayoutInfo()}})),this._diffValue=this._diffModel.map(((t,i)=>t==null?void 0:t.diff.read(i))),this.onDidUpdateDiff=ne.fromObservableLight(this._diffValue),r.willCreateDiffEditor(),this._contextKeyService.createKey("isInDiffEditor",!0),this._domElement.appendChild(this.elements.root),this._register(Zi((()=>this._domElement.removeChild(this.elements.root)))),this._rootSizeObserver=this._register(new Fq(this.elements.root,i.dimension)),this._rootSizeObserver.setAutomaticLayout((c=i.automaticLayout)!==null&&c!==void 0&&c),this._options=this._instantiationService.createInstance(hZ,i),this._register(ZB((t=>{this._options.setWidth(this._rootSizeObserver.width.read(t))}))),this._contextKeyService.createKey(Ox.isEmbeddedDiffEditor.key,!1),this._register(Wq(Ox.isEmbeddedDiffEditor,this._contextKeyService,(t=>this._options.isInEmbeddedEditor.read(t)))),this._register(Wq(Ox.comparingMovedCode,this._contextKeyService,(t=>{var i;return!!(!((i=this._diffModel.read(t))===null||i===void 0)&&i.movedTextToCompare.read(t))}))),this._register(Wq(Ox.diffEditorRenderSideBySideInlineBreakpointReached,this._contextKeyService,(t=>this._options.couldShowInlineViewBecauseOfSize.read(t)))),this._register(Wq(Ox.diffEditorInlineMode,this._contextKeyService,(t=>!this._options.renderSideBySide.read(t)))),this._register(Wq(Ox.hasChanges,this._contextKeyService,(t=>{var i,e,s;return((s=(e=(i=this._diffModel.read(t))===null||i===void 0?void 0:i.diff.read(t))===null||e===void 0?void 0:e.mappings.length)!==null&&s!==void 0?s:0)>0}))),this._editors=this._register(this._instantiationService.createInstance(sZ,this.elements.original,this.elements.modified,this._options,e,((t,i,e,s)=>this._createInnerEditor(t,i,e,s)))),this._register(Wq(Ox.diffEditorOriginalWritable,this._contextKeyService,(t=>this._options.originalEditable.read(t)))),this._register(Wq(Ox.diffEditorModifiedWritable,this._contextKeyService,(t=>!this._options.readOnly.read(t)))),this._register(Wq(Ox.diffEditorOriginalUri,this._contextKeyService,(t=>{var i,e;return(e=(i=this._diffModel.read(t))===null||i===void 0?void 0:i.model.original.uri.toString())!==null&&e!==void 0?e:""}))),this._register(Wq(Ox.diffEditorModifiedUri,this._contextKeyService,(t=>{var i,e;return(e=(i=this._diffModel.read(t))===null||i===void 0?void 0:i.model.modified.uri.toString())!==null&&e!==void 0?e:""}))),this._overviewRulerPart=qB(this,(t=>this._options.renderOverviewRuler.read(t)?this._instantiationService.createInstance(Pq(QG,t),this._editors,this.elements.root,this._diffModel,this._rootSizeObserver.width,this._rootSizeObserver.height,this._layoutInfo.map((t=>t.modifiedEditor))):void 0)).recomputeInitiallyAndOnChange(this._store),this._sash=qB(this,(t=>{const i=this._options.renderSideBySide.read(t);return this.elements.root.classList.toggle("side-by-side",i),i?new bG(this._options,this.elements.root,{height:this._rootSizeObserver.height,width:this._rootSizeObserver.width.map(((t,i)=>{var e,s;return t-((s=(e=this._overviewRulerPart.read(i))===null||e===void 0?void 0:e.width)!==null&&s!==void 0?s:0)}))},this._boundarySashes):void 0})).recomputeInitiallyAndOnChange(this._store);const l=qB(this,(t=>this._instantiationService.createInstance(Pq(KG,t),this._editors,this._diffModel,this._options))).recomputeInitiallyAndOnChange(this._store);qB(this,(t=>this._instantiationService.createInstance(Pq(vG,t),this._editors,this._diffModel,this._options,this))).recomputeInitiallyAndOnChange(this._store);const a=new Set,u=new Set;let d=!1;const f=qB(this,(t=>this._instantiationService.createInstance(Pq(WG,t),Uh(this._domElement),this._editors,this._diffModel,this._options,this,(()=>d||l.get().isUpdatingHiddenAreas),a,u))).recomputeInitiallyAndOnChange(this._store),g=zB(this,(t=>{const i=f.read(t).viewZones.read(t).orig,e=l.read(t).viewZones.read(t).origViewZones;return i.concat(e)})),p=zB(this,(t=>{const i=f.read(t).viewZones.read(t).mod,e=l.read(t).viewZones.read(t).modViewZones;return i.concat(e)}));let m;this._register(Nq(this._editors.original,g,(t=>{d=t}),a)),this._register(Nq(this._editors.modified,p,(t=>{d=t,d?m=xq.capture(this._editors.modified):(m==null||m.restore(this._editors.modified),m=void 0)}),u)),this._accessibleDiffViewer=qB(this,(t=>this._instantiationService.createInstance(Pq(Kq,t),this.elements.accessibleDiffViewer,this._accessibleDiffViewerVisible,((t,i)=>this._accessibleDiffViewerShouldBeVisible.set(t,i)),this._options.onlyShowAccessibleDiffViewer.map((t=>!t)),this._rootSizeObserver.width,this._rootSizeObserver.height,this._diffModel.map(((t,i)=>{var e;return(e=t==null?void 0:t.diff.read(i))===null||e===void 0?void 0:e.mappings.map((t=>t.lineRangeMapping))})),new eG(this._editors)))).recomputeInitiallyAndOnChange(this._store);const w=this._accessibleDiffViewerVisible.map((t=>t?"hidden":"visible"));this._register(_q(this.elements.modified,{visibility:w})),this._register(_q(this.elements.original,{visibility:w})),this._createDiffEditorContributions(),r.addDiffEditor(this),this._gutter=qB(this,(t=>this._options.shouldRenderGutterMenu.read(t)?this._instantiationService.createInstance(Pq(MZ,t),this.elements.root,this._diffModel,this._editors):void 0)),this._register(c$(this._layoutInfo)),qB(this,(t=>new(Pq(sG,t))(this.elements.root,this._diffModel,this._layoutInfo.map((t=>t.originalEditor)),this._layoutInfo.map((t=>t.modifiedEditor)),this._editors))).recomputeInitiallyAndOnChange(this._store,(t=>{this._movedBlocksLinesPart.set(t,void 0)})),this._register(_q(this.elements.overlay,{width:this._layoutInfo.map(((t,i)=>t.originalEditor.width+(this._options.renderSideBySide.read(i)?0:t.modifiedEditor.width))),visibility:zB((t=>{var i,e;return this._options.hideUnchangedRegions.read(t)&&((e=(i=this._diffModel.read(t))===null||i===void 0?void 0:i.diff.read(t))===null||e===void 0?void 0:e.mappings.length)===0?"visible":"hidden"}))})),this._register(ne.runAndSubscribe(this._editors.modified.onDidChangeCursorPosition,(t=>this._handleCursorPositionChange(t,!0)))),this._register(ne.runAndSubscribe(this._editors.original.onDidChangeCursorPosition,(t=>this._handleCursorPositionChange(t,!1))));const v=this._diffModel.map(this,((t,i)=>{if(t)return t.diff.read(i)===void 0&&!t.isDiffUpToDate.read(i)}));this._register(YB(((t,i)=>{if(v.read(t)===!0){const t=this._editorProgressService.show(!0,1e3);i.add(Zi((()=>t.done())))}}))),this._register(Zi((()=>{var t;this._shouldDisposeDiffModel&&((t=this._diffModel.get())===null||t===void 0||t.dispose())}))),this._register(YB(((t,i)=>{i.add(new(Pq(XG,t))(this._editors,this._diffModel,this._options,this))})))}_createInnerEditor(t,i,e,s){return t.createInstance(vR,i,e,s)}_createDiffEditorContributions(){const t=xu.getDiffEditorContributions();for(const i of t)try{this._register(this._instantiationService.createInstance(i.ctor,this))}catch(t){Ii(t)}}get _targetEditor(){return this._editors.modified}getEditorType(){return Yp.IDiffEditor}layout(t){this._rootSizeObserver.observe(t)}hasTextFocus(){return this._editors.original.hasTextFocus()||this._editors.modified.hasTextFocus()}saveViewState(){var t;return{original:this._editors.original.saveViewState(),modified:this._editors.modified.saveViewState(),modelState:(t=this._diffModel.get())===null||t===void 0?void 0:t.serializeState()}}restoreViewState(t){var i;if(t&&t.original&&t.modified){const e=t;this._editors.original.restoreViewState(e.original),this._editors.modified.restoreViewState(e.modified),e.modelState&&((i=this._diffModel.get())===null||i===void 0||i.restoreSerializedState(e.modelState))}}handleInitialized(){this._editors.original.handleInitialized(),this._editors.modified.handleInitialized()}createViewModel(t){return this._instantiationService.createInstance(MG,t,this._options)}getModel(){var t,i;return(i=(t=this._diffModel.get())===null||t===void 0?void 0:t.model)!==null&&i!==void 0?i:null}setModel(t,i){!t&&this._diffModel.get()&&this._accessibleDiffViewer.get().close();const e=t?"model"in t?{model:t,shouldDispose:!1}:{model:this.createViewModel(t),shouldDispose:!0}:void 0;this._diffModel.get()!==(e==null?void 0:e.model)&&NB(i,(t=>{var i;e$.batchEventsGlobally(t,(()=>{this._editors.original.setModel(e?e.model.model.original:null),this._editors.modified.setModel(e?e.model.model.modified:null)}));const s=this._diffModel.get(),n=this._shouldDisposeDiffModel;this._shouldDisposeDiffModel=(i=e==null?void 0:e.shouldDispose)!==null&&i!==void 0&&i,this._diffModel.set(e==null?void 0:e.model,t),n&&(s==null||s.dispose())}))}updateOptions(t){this._options.updateOptions(t)}getContainerDomNode(){return this._domElement}getOriginalEditor(){return this._editors.original}getModifiedEditor(){return this._editors.modified}getLineChanges(){var t;const i=(t=this._diffModel.get())===null||t===void 0?void 0:t.diff.get();return i?i.mappings.map((t=>{const i=t.lineRangeMapping;let e,s,n,r,o=i.innerChanges;return i.original.isEmpty?(e=i.original.startLineNumber-1,s=0,o=void 0):(e=i.original.startLineNumber,s=i.original.endLineNumberExclusive-1),i.modified.isEmpty?(n=i.modified.startLineNumber-1,r=0,o=void 0):(n=i.modified.startLineNumber,r=i.modified.endLineNumberExclusive-1),{originalStartLineNumber:e,originalEndLineNumber:s,modifiedStartLineNumber:n,modifiedEndLineNumber:r,charChanges:o==null?void 0:o.map((t=>({originalStartLineNumber:t.originalRange.startLineNumber,originalStartColumn:t.originalRange.startColumn,originalEndLineNumber:t.originalRange.endLineNumber,originalEndColumn:t.originalRange.endColumn,modifiedStartLineNumber:t.modifiedRange.startLineNumber,modifiedStartColumn:t.modifiedRange.startColumn,modifiedEndLineNumber:t.modifiedRange.endLineNumber,modifiedEndColumn:t.modifiedRange.endColumn})))}})):null}revert(t){const i=this._diffModel.get();i&&i.isDiffUpToDate.get()&&this._editors.modified.executeEdits("diffEditor",[{range:t.modified.toExclusiveRange(),text:i.model.original.getValueInRange(t.original.toExclusiveRange())}])}revertRangeMappings(t){const i=this._diffModel.get();if(!i||!i.isDiffUpToDate.get())return;const e=t.map((t=>({range:t.modifiedRange,text:i.model.original.getValueInRange(t.originalRange)})));this._editors.modified.executeEdits("diffEditor",e)}_goTo(t){this._editors.modified.setPosition(new ks(t.lineRangeMapping.modified.startLineNumber,1)),this._editors.modified.revealRangeInCenter(t.lineRangeMapping.modified.toExclusiveRange())}goToDiff(t){var i,e,s,n;const r=(e=(i=this._diffModel.get())===null||i===void 0?void 0:i.diff.get())===null||e===void 0?void 0:e.mappings;if(!r||r.length===0)return;const o=this._editors.modified.getPosition().lineNumber;let h;h=t==="next"?(s=r.find((t=>t.lineRangeMapping.modified.startLineNumber>o)))!==null&&s!==void 0?s:r[0]:(n=yg(r,(t=>t.lineRangeMapping.modified.startLineNumber<o)))!==null&&n!==void 0?n:r[r.length-1],this._goTo(h),h.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(tq.diffLineDeleted,{source:"diffEditor.goToDiff"}):h.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(tq.diffLineInserted,{source:"diffEditor.goToDiff"}):h&&this._accessibilitySignalService.playSignal(tq.diffLineModified,{source:"diffEditor.goToDiff"})}revealFirstDiff(){const t=this._diffModel.get();t&&this.waitForDiff().then((()=>{var i;const e=(i=t.diff.get())===null||i===void 0?void 0:i.mappings;e&&e.length!==0&&this._goTo(e[0])}))}accessibleDiffViewerNext(){this._accessibleDiffViewer.get().next()}accessibleDiffViewerPrev(){this._accessibleDiffViewer.get().prev()}async waitForDiff(){const t=this._diffModel.get();t&&await t.waitForDiff()}mapToOtherSide(){var t,i;const e=this._editors.modified.hasWidgetFocus(),s=e?this._editors.modified:this._editors.original,n=e?this._editors.original:this._editors.modified;let r;const o=s.getSelection();if(o){const s=(i=(t=this._diffModel.get())===null||t===void 0?void 0:t.diff.get())===null||i===void 0?void 0:i.mappings.map((t=>e?t.lineRangeMapping.flip():t.lineRangeMapping));if(s){const t=$q(o.getStartPosition(),s),i=$q(o.getEndPosition(),s);r=Cs.plusRange(t,i)}}return{destination:n,destinationSelection:r}}switchSide(){const{destination:t,destinationSelection:i}=this.mapToOtherSide();t.focus(),i&&t.setSelection(i)}exitCompareMove(){const t=this._diffModel.get();t&&t.movedTextToCompare.set(void 0,void 0)}collapseAllUnchangedRegions(){var t;const i=(t=this._diffModel.get())===null||t===void 0?void 0:t.unchangedRegions.get();i&&_B((t=>{for(const e of i)e.collapseAll(t)}))}showAllUnchangedRegions(){var t;const i=(t=this._diffModel.get())===null||t===void 0?void 0:t.unchangedRegions.get();i&&_B((t=>{for(const e of i)e.showAll(t)}))}_handleCursorPositionChange(t,i){var e,s;if((t==null?void 0:t.reason)===3){const n=(s=(e=this._diffModel.get())===null||e===void 0?void 0:e.diff.get())===null||s===void 0?void 0:s.mappings.find((e=>i?e.lineRangeMapping.modified.contains(t.position.lineNumber):e.lineRangeMapping.original.contains(t.position.lineNumber)));n!=null&&n.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(tq.diffLineDeleted,{source:"diffEditor.cursorPositionChanged"}):n!=null&&n.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(tq.diffLineInserted,{source:"diffEditor.cursorPositionChanged"}):n&&this._accessibilitySignalService.playSignal(tq.diffLineModified,{source:"diffEditor.cursorPositionChanged"})}}};OZ=TZ([RZ(3,Ra),RZ(4,Il),RZ(5,Pl),RZ(6,QK),RZ(7,yN)],OZ);var IZ=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},_Z=function(t,i){return function(e,s){i(e,s,t)}};let PZ=0,NZ=!1;function BZ(t){if(!t){if(NZ)return;NZ=!0}(function(t){tw=document.createElement("div"),tw.className="monaco-aria-container";const i=()=>{const t=document.createElement("div");return t.className="monaco-alert",t.setAttribute("role","alert"),t.setAttribute("aria-atomic","true"),tw.appendChild(t),t};iw=i(),ew=i();const e=()=>{const t=document.createElement("div");return t.className="monaco-status",t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),tw.appendChild(t),t};sw=e(),nw=e(),t.appendChild(tw)})(t||Wn.document.body)}let $Z=class extends vR{constructor(t,i,e,s,n,r,o,h,c,l,a,u){const d={...i};d.ariaLabel=d.ariaLabel||$N.editorViewAccessibleLabel,d.ariaLabel=d.ariaLabel+";"+$N.accessibilityHelpMessage,super(t,d,{},e,s,n,r,h,c,l,a,u),this._standaloneKeybindingService=o instanceof dq?o:null,BZ(d.ariaContainerElement),eB=(t,i)=>e.createInstance(nI,t,i,{})}addCommand(t,i,e){if(!this._standaloneKeybindingService)return console.warn("Cannot add command because the editor is configured with an unrecognized KeybindingService"),null;const s="DYNAMIC_"+ ++PZ,n=ua.deserialize(e);return this._standaloneKeybindingService.addDynamicKeybinding(s,t,i,n),s}createContextKey(t,i){return this._contextKeyService.createKey(t,i)}addAction(t){if(typeof t.id!="string"||typeof t.label!="string"||typeof t.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");if(!this._standaloneKeybindingService)return console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),Qi.None;const i=t.id,e=t.label,s=ua.and(ua.equals("editorId",this.getId()),ua.deserialize(t.precondition)),n=t.keybindings,r=ua.and(s,ua.deserialize(t.keybindingContext)),o=t.contextMenuGroupId||null,h=t.contextMenuOrder||0,c=(i,...e)=>Promise.resolve(t.run(this,...e)),l=new Ji,a=this.getId()+":"+i;if(l.add(Gl.registerCommand(a,c)),o){const t={command:{id:a,title:e},when:s,group:o,order:h};l.add(tu.appendMenuItem(Qa.EditorContext,t))}if(Array.isArray(n))for(const t of n)l.add(this._standaloneKeybindingService.addDynamicKeybinding(a,t,c,r));const u=new QE(a,e,e,void 0,s,((...i)=>Promise.resolve(t.run(this,...i))),this._contextKeyService);return this._actions.set(i,u),l.add(Zi((()=>{this._actions.delete(i)}))),l}_triggerCommand(t,i){if(this._codeEditorService instanceof NR)try{this._codeEditorService.setActiveCodeEditor(this),super._triggerCommand(t,i)}finally{this._codeEditorService.setActiveCodeEditor(null)}else super._triggerCommand(t,i)}};$Z=IZ([_Z(2,Il),_Z(3,Pl),_Z(4,ql),_Z(5,Ra),_Z(6,NS),_Z(7,AC),_Z(8,gR),_Z(9,vw),_Z(10,cf),_Z(11,$p)],$Z);let WZ=class extends $Z{constructor(t,i,e,s,n,r,o,h,c,l,a,u,d,f,g){const p={...i};bq(l,p,!1);const m=h.registerEditorContainer(t);typeof p.theme=="string"&&h.setTheme(p.theme),p.autoDetectHighContrast!==void 0&&h.setAutoDetectHighContrast(!!p.autoDetectHighContrast);const w=p.model;let v;if(delete p.model,super(t,p,e,s,n,r,o,h,c,a,f,g),this._configurationService=l,this._standaloneThemeService=h,this._register(m),w===void 0){const t=d.getLanguageIdByMimeType(p.language)||p.language||Yd;v=HZ(u,d,p.value||"",t,void 0),this._ownsModel=!0}else v=w,this._ownsModel=!1;if(this._attachModel(v),v){const t={oldModelUrl:null,newModelUrl:v.uri};this._onDidChangeModel.fire(t)}}dispose(){super.dispose()}updateOptions(t){bq(this._configurationService,t,!1),typeof t.theme=="string"&&this._standaloneThemeService.setTheme(t.theme),t.autoDetectHighContrast!==void 0&&this._standaloneThemeService.setAutoDetectHighContrast(!!t.autoDetectHighContrast),super.updateOptions(t)}_postDetachModelCleanup(t){super._postDetachModelCleanup(t),t&&this._ownsModel&&(t.dispose(),this._ownsModel=!1)}};WZ=IZ([_Z(2,Il),_Z(3,Pl),_Z(4,ql),_Z(5,Ra),_Z(6,NS),_Z(7,aK),_Z(8,gR),_Z(9,Md),_Z(10,vw),_Z(11,Nl),_Z(12,Id),_Z(13,cf),_Z(14,$p)],WZ);let jZ=class extends OZ{constructor(t,i,e,s,n,r,o,h,c,l,a,u){const d={...i};bq(h,d,!0);const f=r.registerEditorContainer(t);typeof d.theme=="string"&&r.setTheme(d.theme),d.autoDetectHighContrast!==void 0&&r.setAutoDetectHighContrast(!!d.autoDetectHighContrast),super(t,d,{},s,e,n,u,l),this._configurationService=h,this._standaloneThemeService=r,this._register(f)}dispose(){super.dispose()}updateOptions(t){bq(this._configurationService,t,!0),typeof t.theme=="string"&&this._standaloneThemeService.setTheme(t.theme),t.autoDetectHighContrast!==void 0&&this._standaloneThemeService.setAutoDetectHighContrast(!!t.autoDetectHighContrast),super.updateOptions(t)}_createInnerEditor(t,i,e){return t.createInstance($Z,i,e)}getOriginalEditor(){return super.getOriginalEditor()}getModifiedEditor(){return super.getModifiedEditor()}addCommand(t,i,e){return this.getModifiedEditor().addCommand(t,i,e)}createContextKey(t,i){return this.getModifiedEditor().createContextKey(t,i)}addAction(t){return this.getModifiedEditor().addAction(t)}};function HZ(t,i,e,s,n){if(e=e||"",!s){const s=e.indexOf(`\n`);let r=e;return s!==-1&&(r=e.substring(0,s)),VZ(t,e,i.createByFilepathOrFirstLine(n||null,r),n)}return VZ(t,e,i.createById(s),n)}function VZ(t,i,e,s){return t.createModel(i,e,s)}jZ=IZ([_Z(2,Il),_Z(3,Ra),_Z(4,Pl),_Z(5,aK),_Z(6,gR),_Z(7,Md),_Z(8,oI),_Z(9,yN),_Z(10,AK),_Z(11,QK)],jZ);var zZ=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},UZ=function(t,i){return function(e,s){i(e,s,t)}};class KZ{constructor(t,i){this.viewModel=t,this.deltaScrollVertical=i}getId(){return this.viewModel}}let qZ=class extends Qi{constructor(t,i,e,s){super(),this._container=t,this._overflowWidgetsDomNode=i,this._workbenchUIElementFactory=e,this._instantiationService=s,this._viewModel=$B(this,void 0),this._collapsed=zB(this,(t=>{var i;return(i=this._viewModel.read(t))===null||i===void 0?void 0:i.collapsed.read(t)})),this._editorContentHeight=$B(this,500),this.contentHeight=zB(this,(t=>(this._collapsed.read(t)?0:this._editorContentHeight.read(t))+this._outerEditorHeight)),this._modifiedContentWidth=$B(this,0),this._modifiedWidth=$B(this,0),this._originalContentWidth=$B(this,0),this._originalWidth=$B(this,0),this.maxScroll=zB(this,(t=>{const i=this._modifiedContentWidth.read(t)-this._modifiedWidth.read(t),e=this._originalContentWidth.read(t)-this._originalWidth.read(t);return i>e?{maxScroll:i,width:this._modifiedWidth.read(t)}:{maxScroll:e,width:this._originalWidth.read(t)}})),this._elements=ml("div.multiDiffEntry",[ml("div.header@header",[ml("div.header-content",[ml("div.collapse-button@collapseButton"),ml("div.file-path",[ml("div.title.modified.show-file-icons@primaryPath",[]),ml("div.status.deleted@status",["R"]),ml("div.title.original.show-file-icons@secondaryPath",[])]),ml("div.actions@actions")])]),ml("div.editorParent",[ml("div.editorContainer@editor")])]),this.editor=this._register(this._instantiationService.createInstance(OZ,this._elements.editor,{overflowWidgetsDomNode:this._overflowWidgetsDomNode},{})),this.isModifedFocused=GZ(this.editor.getModifiedEditor()),this.isOriginalFocused=GZ(this.editor.getOriginalEditor()),this.isFocused=zB(this,(t=>this.isModifedFocused.read(t)||this.isOriginalFocused.read(t))),this._resourceLabel=this._workbenchUIElementFactory.createResourceLabel?this._register(this._workbenchUIElementFactory.createResourceLabel(this._elements.primaryPath)):void 0,this._resourceLabel2=this._workbenchUIElementFactory.createResourceLabel?this._register(this._workbenchUIElementFactory.createResourceLabel(this._elements.secondaryPath)):void 0,this._dataStore=new Ji,this._headerHeight=40,this._lastScrollTop=-1,this._isSettingScrollTop=!1;const n=new lU(this._elements.collapseButton,{});this._register(ZB((t=>{n.element.className="",n.icon=this._collapsed.read(t)?As.chevronRight:As.chevronDown}))),this._register(n.onDidClick((()=>{var t;(t=this._viewModel.get())===null||t===void 0||t.collapsed.set(!this._collapsed.get(),void 0)}))),this._register(ZB((t=>{this._elements.editor.style.display=this._collapsed.read(t)?"none":"block"}))),this._register(this.editor.getModifiedEditor().onDidLayoutChange((t=>{const i=this.editor.getModifiedEditor().getLayoutInfo().contentWidth;this._modifiedWidth.set(i,void 0)}))),this._register(this.editor.getOriginalEditor().onDidLayoutChange((t=>{const i=this.editor.getOriginalEditor().getLayoutInfo().contentWidth;this._originalWidth.set(i,void 0)}))),this._register(this.editor.onDidContentSizeChange((t=>{PB((i=>{this._editorContentHeight.set(t.contentHeight,i),this._modifiedContentWidth.set(this.editor.getModifiedEditor().getContentWidth(),i),this._originalContentWidth.set(this.editor.getOriginalEditor().getContentWidth(),i)}))}))),this._register(this.editor.getOriginalEditor().onDidScrollChange((t=>{if(this._isSettingScrollTop||!t.scrollTopChanged||!this._data)return;const i=t.scrollTop-this._lastScrollTop;this._data.deltaScrollVertical(i)}))),this._register(ZB((t=>{const i=this.isFocused.read(t);this._elements.root.classList.toggle("focused",i)}))),this._container.appendChild(this._elements.root),this._outerEditorHeight=this._headerHeight,this._register(this._instantiationService.createInstance(xZ,this._elements.actions,Qa.MultiDiffEditorFileToolbar,{actionRunner:this._register(new uZ((()=>{var t;return(t=this._viewModel.get())===null||t===void 0?void 0:t.modifiedUri}))),menuOptions:{shouldForwardArgs:!0},toolbarOptions:{primaryGroup:t=>t.startsWith("navigation")},actionViewItemProvider:(t,i)=>MW(s,t,i)}))}setScrollLeft(t){this._modifiedContentWidth.get()-this._modifiedWidth.get()>this._originalContentWidth.get()-this._originalWidth.get()?this.editor.getModifiedEditor().setScrollLeft(t):this.editor.getOriginalEditor().setScrollLeft(t)}setData(t){function i(t){return{...t,scrollBeyondLastLine:!1,hideUnchangedRegions:{enabled:!0},scrollbar:{vertical:"hidden",horizontal:"hidden",handleMouseWheel:!1,useShadows:!1},renderOverviewRuler:!1,fixedOverflowWidgets:!0,overviewRulerBorder:!1}}this._data=t;const e=t.viewModel.entry.value;e.onOptionsDidChange&&this._dataStore.add(e.onOptionsDidChange((()=>{var t;this.editor.updateOptions(i((t=e.options)!==null&&t!==void 0?t:{}))}))),PB((s=>{var n,r,o,h;(n=this._resourceLabel)===null||n===void 0||n.setUri((r=t.viewModel.modifiedUri)!==null&&r!==void 0?r:t.viewModel.originalUri,{strikethrough:t.viewModel.modifiedUri===void 0});let c=!1,l=!1,a=!1,u="";t.viewModel.modifiedUri&&t.viewModel.originalUri&&t.viewModel.modifiedUri.path!==t.viewModel.originalUri.path?(u="R",c=!0):t.viewModel.modifiedUri?t.viewModel.originalUri||(u="A",a=!0):(u="D",l=!0),this._elements.status.classList.toggle("renamed",c),this._elements.status.classList.toggle("deleted",l),this._elements.status.classList.toggle("added",a),this._elements.status.innerText=u,(o=this._resourceLabel2)===null||o===void 0||o.setUri(c?t.viewModel.originalUri:void 0,{strikethrough:!0}),this._dataStore.clear(),this._viewModel.set(t.viewModel,s),this.editor.setModel(t.viewModel.diffEditorViewModel,s),this.editor.updateOptions(i((h=e.options)!==null&&h!==void 0?h:{}))}))}render(t,i,e,s){this._elements.root.style.visibility="visible",this._elements.root.style.top=`${t.start}px`,this._elements.root.style.height=`${t.length}px`,this._elements.root.style.width=`${i}px`,this._elements.root.style.position="absolute";const n=t.length-this._headerHeight,r=Math.max(0,Math.min(s.start-t.start,n));this._elements.header.style.transform=`translateY(${r}px)`,PB((e=>{this.editor.layout({width:i-16-2,height:t.length-this._outerEditorHeight})}));try{this._isSettingScrollTop=!0,this._lastScrollTop=e,this.editor.getOriginalEditor().setScrollTop(e)}finally{this._isSettingScrollTop=!1}this._elements.header.classList.toggle("shadow",r>0||e>0),this._elements.header.classList.toggle("collapsed",r===n)}hide(){this._elements.root.style.top="-100000px",this._elements.root.style.visibility="hidden"}};function GZ(t){return e$((i=>{const e=new Ji;return e.add(t.onDidFocusEditorWidget((()=>i(!0)))),e.add(t.onDidBlurEditorWidget((()=>i(!1)))),e}),(()=>t.hasTextFocus()))}qZ=zZ([UZ(3,Il)],qZ);class ZZ{constructor(t){this._create=t,this._unused=new Set,this._used=new Set,this._itemData=new Map}getUnusedObj(t){var i;let e;if(this._unused.size===0)e=this._create(t),this._itemData.set(e,t);else{const s=[...this._unused.values()];e=(i=s.find((i=>this._itemData.get(i).getId()===t.getId())))!==null&&i!==void 0?i:s[0],this._unused.delete(e),this._itemData.set(e,t),e.setData(t)}return this._used.add(e),{object:e,dispose:()=>{this._used.delete(e),this._unused.size>5?e.dispose():this._unused.add(e)}}}dispose(){for(const t of this._used)t.dispose();for(const t of this._unused)t.dispose();this._used.clear(),this._unused.clear()}}var JZ=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},QZ=function(t,i){return function(e,s){i(e,s,t)}};let YZ=class extends Qi{constructor(t,i,e,s,n,r){super(),this._element=t,this._dimension=i,this._viewModel=e,this._workbenchUIElementFactory=s,this._parentContextKeyService=n,this._parentInstantiationService=r,this._elements=ml("div.monaco-component.multiDiffEditor",[ml("div@content",{style:{overflow:"hidden"}}),ml("div.monaco-editor@overflowWidgetsDomNode",{})]),this._sizeObserver=this._register(new Fq(this._element,void 0)),this._objectPool=this._register(new ZZ((t=>{const i=this._instantiationService.createInstance(qZ,this._elements.content,this._elements.overflowWidgetsDomNode,this._workbenchUIElementFactory);return i.setData(t),i}))),this._scrollable=this._register(new Jk({forceIntegerValues:!1,scheduleAtNextAnimationFrame:t=>ac(Uh(this._element),t),smoothScrollDuration:100})),this._scrollableElement=this._register(new nC(this._elements.root,{vertical:1,horizontal:1,useShadows:!1},this._scrollable)),this.scrollTop=e$(this._scrollableElement.onScroll,(()=>this._scrollableElement.getScrollPosition().scrollTop)),this.scrollLeft=e$(this._scrollableElement.onScroll,(()=>this._scrollableElement.getScrollPosition().scrollLeft)),this._viewItems=KB(this,((t,i)=>{const e=this._viewModel.read(t);return e?e.items.read(t).map((t=>{var e;const s=i.add(new XZ(t,this._objectPool,this.scrollLeft,(t=>{this._scrollableElement.setScrollPosition({scrollTop:this._scrollableElement.getScrollPosition().scrollTop+t})}))),n=(e=this._lastDocStates)===null||e===void 0?void 0:e[s.getKey()];return n&&_B((t=>{s.setViewState(n,t)})),s})):[]})),this._spaceBetweenPx=0,this._totalHeight=this._viewItems.map(this,((t,i)=>t.reduce(((t,e)=>t+e.contentHeight.read(i)+this._spaceBetweenPx),0))),this.activeDiffItem=zB(this,(t=>this._viewItems.read(t).find((i=>{var e;return(e=i.template.read(t))===null||e===void 0?void 0:e.isFocused.read(t)})))),this.lastActiveDiffItem=function(t){let i;return zB((e=>(i=t(e,i),i)))}(((t,i)=>{var e;return(e=this.activeDiffItem.read(t))!==null&&e!==void 0?e:i})),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._element)),this._instantiationService=this._parentInstantiationService.createChild(new aR([Ra,this._contextKeyService])),this._lastDocStates={},this._contextKeyService.createKey(Ox.inMultiDiffEditor.key,!0),this._register(YB(((t,i)=>{const e=this._viewModel.read(t);if(e&&e.contextKeys)for(const[t,s]of Object.entries(e.contextKeys)){const e=this._contextKeyService.createKey(t,void 0);e.set(s),i.add(Zi((()=>e.reset())))}})));const o=this._parentContextKeyService.createKey(Ox.multiDiffEditorAllCollapsed.key,!1);this._register(ZB((t=>{const i=this._viewModel.read(t);if(i){const e=i.items.read(t).every((i=>i.collapsed.read(t)));o.set(e)}}))),this._register(ZB((t=>{const i=this.lastActiveDiffItem.read(t);_B((e=>{var s;(s=this._viewModel.read(t))===null||s===void 0||s.activeDiffItem.set(i==null?void 0:i.viewModel,e)}))}))),this._register(ZB((t=>{const i=this._dimension.read(t);this._sizeObserver.observe(i)}))),this._elements.content.style.position="relative",this._register(ZB((t=>{const i=this._sizeObserver.height.read(t);this._elements.root.style.height=`${i}px`;const e=this._totalHeight.read(t);this._elements.content.style.height=`${e}px`;const s=this._sizeObserver.width.read(t);let n=s;const r=Dg(this._viewItems.read(t),(i=>i.maxScroll.read(t).maxScroll));r&&(n=s+r.maxScroll.read(t).maxScroll),this._scrollableElement.setScrollDimensions({width:s,height:i,scrollHeight:e,scrollWidth:n})}))),t.replaceChildren(this._scrollableElement.getDomNode()),this._register(Zi((()=>{t.replaceChildren()}))),this._register(this._register(ZB((t=>{PB((i=>{this.render(t)}))}))))}render(t){const i=this.scrollTop.read(t);let e=0,s=0,n=0;const r=this._sizeObserver.height.read(t),o=vg.ofStartAndLength(i,r),h=this._sizeObserver.width.read(t);for(const c of this._viewItems.read(t)){const l=c.contentHeight.read(t),a=Math.min(l,r),u=vg.ofStartAndLength(s,a),d=vg.ofStartAndLength(n,l);if(d.isBefore(o))e-=l-a,c.hide();else if(d.isAfter(o))c.hide();else{const t=Math.max(0,Math.min(o.start-d.start,l-a));e-=t;const s=vg.ofStartAndLength(i+e,r);c.render(u,t,h,s)}s+=a+this._spaceBetweenPx,n+=l+this._spaceBetweenPx}this._elements.content.style.transform=`translateY(${-(i+e)}px)`}};YZ=JZ([QZ(4,Ra),QZ(5,Il)],YZ);class XZ extends Qi{constructor(t,i,e,s){super(),this.viewModel=t,this._objectPool=i,this._scrollLeft=e,this._deltaScrollVertical=s,this._templateRef=this._register(jB(this,void 0)),this.contentHeight=zB(this,(t=>{var i,e,s;return(s=(e=(i=this._templateRef.read(t))===null||i===void 0?void 0:i.object.contentHeight)===null||e===void 0?void 0:e.read(t))!==null&&s!==void 0?s:this.viewModel.lastTemplateData.read(t).contentHeight})),this.maxScroll=zB(this,(t=>{var i,e;return(e=(i=this._templateRef.read(t))===null||i===void 0?void 0:i.object.maxScroll.read(t))!==null&&e!==void 0?e:{maxScroll:0,scrollWidth:0}})),this.template=zB(this,(t=>{var i;return(i=this._templateRef.read(t))===null||i===void 0?void 0:i.object})),this._isHidden=$B(this,!1),this._register(ZB((t=>{var i;const e=this._scrollLeft.read(t);(i=this._templateRef.read(t))===null||i===void 0||i.object.setScrollLeft(e)}))),this._register(ZB((t=>{const i=this._templateRef.read(t);i&&this._isHidden.read(t)&&(i.object.isFocused.read(t)||this._clear())})))}dispose(){this._clear(),super.dispose()}toString(){var t;return`VirtualViewItem(${(t=this.viewModel.entry.value.modified)===null||t===void 0?void 0:t.uri.toString()})`}getKey(){return this.viewModel.getKey()}setViewState(t,i){var e;this.viewModel.collapsed.set(t.collapsed,i),this._updateTemplateData(i);const s=this.viewModel.lastTemplateData.get(),n=(e=t.selections)===null||e===void 0?void 0:e.map(Ss.liftSelection);this.viewModel.lastTemplateData.set({...s,selections:n},i);const r=this._templateRef.get();r&&n&&r.object.editor.setSelections(n)}_updateTemplateData(t){var i;const e=this._templateRef.get();e&&this.viewModel.lastTemplateData.set({contentHeight:e.object.contentHeight.get(),selections:(i=e.object.editor.getSelections())!==null&&i!==void 0?i:void 0},t)}_clear(){const t=this._templateRef.get();t&&_B((i=>{this._updateTemplateData(i),t.object.hide(),this._templateRef.set(void 0,i)}))}hide(){this._isHidden.set(!0,void 0)}render(t,i,e,s){this._isHidden.set(!1,void 0);let n=this._templateRef.get();if(!n){n=this._objectPool.getUnusedObj(new KZ(this.viewModel,this._deltaScrollVertical)),this._templateRef.set(n,void 0);const t=this.viewModel.lastTemplateData.get().selections;t&&n.object.editor.setSelections(t)}n.object.render(t,e,i,s)}}Iw("multiDiffEditor.headerBackground",{dark:"#262626",light:"tab.inactiveBackground",hcDark:"tab.inactiveBackground",hcLight:"tab.inactiveBackground"},tt(0,"The background color of the diff editor's header")),Iw("multiDiffEditor.background",{dark:"editorBackground",light:"editorBackground",hcDark:"editorBackground",hcLight:"editorBackground"},tt(0,"The background color of the multi file diff editor")),Iw("multiDiffEditor.border",{dark:"sideBarSectionHeader.border",light:"#cccccc",hcDark:"sideBarSectionHeader.border",hcLight:"#cccccc"},tt(0,"The border color of the multi file diff editor"));var tJ=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},iJ=function(t,i){return function(e,s){i(e,s,t)}};let eJ=class extends Qi{constructor(t,i,e){super(),this._element=t,this._workbenchUIElementFactory=i,this._instantiationService=e,this._dimension=$B(this,void 0),this._viewModel=$B(this,void 0),this._widgetImpl=KB(this,((t,i)=>(Pq(qZ,t),i.add(this._instantiationService.createInstance(Pq(YZ,t),this._element,this._dimension,this._viewModel,this._workbenchUIElementFactory))))),this._register(c$(this._widgetImpl))}};function sJ(t,i,e){return Sq.initialize(e||{}).createInstance(WZ,t,i)}function nJ(t){return Sq.get(Pl).onCodeEditorAdd((i=>{t(i)}))}function rJ(t){return Sq.get(Pl).onDiffEditorAdd((i=>{t(i)}))}function oJ(){return Sq.get(Pl).listCodeEditors()}function hJ(){return Sq.get(Pl).listDiffEditors()}function cJ(t,i,e){return Sq.initialize(e||{}).createInstance(jZ,t,i)}function lJ(t,i){const e=Sq.initialize(i||{});return new eJ(t,{},e)}function aJ(t){if(typeof t.id!="string"||typeof t.run!="function")throw new Error("Invalid command descriptor, `id` and `run` are required properties!");return Gl.registerCommand(t.id,t.run)}function uJ(t){if(typeof t.id!="string"||typeof t.label!="string"||typeof t.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");const i=ua.deserialize(t.precondition),e=new Ji;if(e.add(Gl.registerCommand(t.id,((e,...s)=>pu.runEditorCommand(e,s,i,((i,e,s)=>Promise.resolve(t.run(e,...s))))))),t.contextMenuGroupId){const s={command:{id:t.id,title:t.label},when:i,group:t.contextMenuGroupId,order:t.contextMenuOrder||0};e.add(tu.appendMenuItem(Qa.EditorContext,s))}if(Array.isArray(t.keybindings)){const s=Sq.get(NS);if(s instanceof dq){const n=ua.and(i,ua.deserialize(t.keybindingContext));e.add(s.addDynamicKeybindings(t.keybindings.map((i=>({keybinding:i,command:t.id,when:n})))))}else console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService")}return e}function dJ(t){return fJ([t])}function fJ(t){const i=Sq.get(NS);return i instanceof dq?i.addDynamicKeybindings(t.map((t=>({keybinding:t.keybinding,command:t.command,commandArgs:t.commandArgs,when:ua.deserialize(t.when)})))):(console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),Qi.None)}function gJ(t,i,e){const s=Sq.get(Id),n=s.getLanguageIdByMimeType(i)||i;return HZ(Sq.get(Nl),s,t,n,e)}function pJ(t,i){const e=Sq.get(Id),s=e.getLanguageIdByMimeType(i)||i||Yd;t.setLanguage(e.createById(s))}function mJ(t,i,e){t&&Sq.get(XW).changeOne(i,t.uri,e)}function wJ(t){Sq.get(XW).changeAll(t,[])}function vJ(t){return Sq.get(XW).read(t)}function bJ(t){return Sq.get(XW).onMarkerChanged(t)}function yJ(t){return Sq.get(Nl).getModel(t)}function kJ(){return Sq.get(Nl).getModels()}function CJ(t){return Sq.get(Nl).onModelAdded(t)}function SJ(t){return Sq.get(Nl).onModelRemoved(t)}function xJ(t){return Sq.get(Nl).onModelLanguageChanged((i=>{t({model:i.model,oldLanguage:i.oldLanguageId})}))}function DJ(t){return function(t,i,e){return new Qp(t,i,e)}(Sq.get(Nl),Sq.get(cf),t)}function EJ(t,i){const e=Sq.get(Id),s=Sq.get(aK);return Qm.colorizeElement(s,e,t,i).then((()=>{s.registerEditorContainer(t)}))}function AJ(t,i,e){const s=Sq.get(Id);return Sq.get(aK).registerEditorContainer(Wn.document.body),Qm.colorize(s,t,i,e)}function MJ(t,i,e=4){return Sq.get(aK).registerEditorContainer(Wn.document.body),Qm.colorizeModelLine(t,i,e)}function LJ(t,i){Us.getOrCreate(i);const e=function(t){return Us.get(t)||{getInitialState:()=>Xp,tokenize:(i,e,s)=>tm(t,s)}}(i),s=Xn(t),n=[];let r=e.getInitialState();for(let t=0,i=s.length;t<i;t++){const i=s[t],o=e.tokenize(i,!0,r);n[t]=o.tokens,r=o.endState}return n}function FJ(t,i){Sq.get(aK).defineTheme(t,i)}function TJ(t){Sq.get(aK).setTheme(t)}function RJ(){Rl.clearAllFontInfos()}function OJ(t,i){return Gl.registerCommand({id:t,handler:i})}function IJ(t){return Sq.get(uI).registerOpener({open:async i=>(typeof i=="string"&&(i=as.parse(i)),t.open(i))})}function _J(t){return Sq.get(Pl).registerCodeEditorOpenHandler((async(i,e,s)=>{var n;if(!e)return null;const r=(n=i.options)===null||n===void 0?void 0:n.selection;let o;return r&&typeof r.endLineNumber=="number"&&typeof r.endColumn=="number"?o=r:r&&(o={lineNumber:r.startLineNumber,column:r.startColumn}),await t.openCodeEditor(e,i.resource,o)?e:null}))}function PJ(t,i){return typeof t=="boolean"?t:i}function NJ(t,i){return typeof t=="string"?t:i}function BJ(t,i=!1){i&&(t=t.map((function(t){return t.toLowerCase()})));const e=function(t){const i={};for(const e of t)i[e]=!0;return i}(t);return i?function(t){return e[t.toLowerCase()]!==void 0&&e.hasOwnProperty(t.toLowerCase())}:function(t){return e[t]!==void 0&&e.hasOwnProperty(t)}}function $J(t,i,e){i=i.replace(/@@/g,"");let s,n=0;do{s=!1,i=i.replace(/@(\w+)/g,(function(e,n){s=!0;let r="";if(typeof t[n]=="string")r=t[n];else{if(!(t[n]&&t[n]instanceof RegExp))throw t[n]===void 0?_m(t,"language definition does not contain attribute '"+n+"', used at: "+i):_m(t,"attribute reference '"+n+"' must be a string, used at: "+i);r=t[n].source}return Rm(r)?"":"(?:"+r+")"})),n++}while(s&&n<5);i=i.replace(/\x01/g,"@");const r=(t.ignoreCase?"i":"")+(t.unicode?"u":"");if(e&&i.match(/\$[sS](\d\d?)/g)){let e=null,s=null;return n=>(s&&e===n||(e=n,s=new RegExp(function(t,i,e){let s=null;return i.replace(/\$[sS](\d\d?)/g,(function(i,n){return s===null&&(s=e.split("."),s.unshift(e)),!Rm(n)&&n<s.length?Om(t,s[n]):""}))}(t,i,n),r)),s)}return new RegExp(i,r)}function WJ(t,i,e,s){let n=-1,r=e,o=e.match(/^\$(([sS]?)(\d\d?)|#)(.*)$/);o&&(o[3]&&(n=parseInt(o[3]),o[2]&&(n+=100)),r=o[4]);let h,c="~",l=r;if(r&&r.length!==0?/^\w*$/.test(l)?c="==":(o=r.match(/^(@|!@|~|!~|==|!=)(.*)$/),o&&(c=o[1],l=o[2])):(c="!=",l=""),c!=="~"&&c!=="!~"||!/^(\w|\|)*$/.test(l))if(c==="@"||c==="!@"){const e=t[l];if(!e)throw _m(t,"the @ match target '"+l+"' is not defined, in rule: "+i);if(!function(t,i){if(!i||!Array.isArray(i))return!1;for(const e of i)if(!t(e))return!1;return!0}((function(t){return typeof t=="string"}),e))throw _m(t,"the @ match target '"+l+"' must be an array of strings, in rule: "+i);const s=BJ(e,t.ignoreCase);h=function(t){return c==="@"?s(t):!s(t)}}else if(c==="~"||c==="!~")if(l.indexOf("$")<0){const i=$J(t,"^"+l+"$",!1);h=function(t){return c==="~"?i.test(t):!i.test(t)}}else h=function(i,e,s,n){return $J(t,"^"+Pm(t,l,e,s,n)+"$",!1).test(i)};else if(l.indexOf("$")<0){const i=Om(t,l);h=function(t){return c==="=="?t===i:t!==i}}else{const i=Om(t,l);h=function(e,s,n,r,o){const h=Pm(t,i,s,n,r);return c==="=="?e===h:e!==h}}else{const i=BJ(l.split("|"),t.ignoreCase);h=function(t){return c==="~"?i(t):!i(t)}}return n===-1?{name:e,value:s,test:function(t,i,e,s){return h(t,t,i,e,s)}}:{name:e,value:s,test:function(t,i,e,s){const r=function(t,i,e,s){if(s<0)return t;if(s<i.length)return i[s];if(s>=100){s-=100;const t=e.split(".");if(t.unshift(e),s<t.length)return t[s]}return null}(t,i,e,n);return h(r||"",t,i,e,s)}}}function jJ(t,i,e){if(e){if(typeof e=="string")return e;if(e.token||e.token===""){if(typeof e.token!="string")throw _m(t,"a 'token' attribute must be of type string, in rule: "+i);{const s={token:e.token};if(e.token.indexOf("$")>=0&&(s.tokenSubst=!0),typeof e.bracket=="string")if(e.bracket==="@open")s.bracket=1;else{if(e.bracket!=="@close")throw _m(t,"a 'bracket' attribute must be either '@open' or '@close', in rule: "+i);s.bracket=-1}if(e.next){if(typeof e.next!="string")throw _m(t,"the next state must be a string value in rule: "+i);{let n=e.next;if(!/^(@pop|@push|@popall)$/.test(n)&&(n[0]==="@"&&(n=n.substr(1)),n.indexOf("$")<0&&!function(t,i){let e=i;for(;e&&e.length>0;){if(t.stateNames[e])return!0;const i=e.lastIndexOf(".");e=i<0?null:e.substr(0,i)}return!1}(t,Pm(t,n,"",[],""))))throw _m(t,"the next state '"+e.next+"' is not defined in rule: "+i);s.next=n}}return typeof e.goBack=="number"&&(s.goBack=e.goBack),typeof e.switchTo=="string"&&(s.switchTo=e.switchTo),typeof e.log=="string"&&(s.log=e.log),typeof e.nextEmbedded=="string"&&(s.nextEmbedded=e.nextEmbedded,t.usesEmbedded=!0),s}}if(Array.isArray(e)){const s=[];for(let n=0,r=e.length;n<r;n++)s[n]=jJ(t,i,e[n]);return{group:s}}if(e.cases){const s=[];for(const n in e.cases)if(e.cases.hasOwnProperty(n)){const r=jJ(t,i,e.cases[n]);n==="@default"||n==="@"||n===""?s.push({test:void 0,value:r,name:n}):n==="@eos"?s.push({test:function(t,i,e,s){return s},value:r,name:n}):s.push(WJ(t,i,n,r))}const n=t.defaultToken;return{test:function(t,i,e,r){for(const n of s)if(!n.test||n.test(t,i,e,r))return n.value;return n}}}throw _m(t,"an action must be a string, an object with a 'token' or 'cases' attribute, or an array of actions; in rule: "+i)}return{token:""}}eJ=tJ([iJ(2,Il)],eJ);class HJ{constructor(t){this.regex=new RegExp(""),this.action={token:""},this.matchOnlyAtLineStart=!1,this.name="",this.name=t}setRegex(t,i){let e;if(typeof i=="string")e=i;else{if(!(i instanceof RegExp))throw _m(t,"rules must start with a match string or regular expression: "+this.name);e=i.source}this.matchOnlyAtLineStart=e.length>0&&e[0]==="^",this.name=this.name+": "+e,this.regex=$J(t,"^(?:"+(this.matchOnlyAtLineStart?e.substr(1):e)+")",!0)}setAction(t,i){this.action=jJ(t,this.name,i)}resolveRegex(t){return this.regex instanceof RegExp?this.regex:this.regex(t)}}function VJ(t,i){if(!i||typeof i!="object")throw new Error("Monarch: expecting a language definition object");const e={};e.languageId=t,e.includeLF=PJ(i.includeLF,!1),e.noThrow=!1,e.maxStack=100,e.start=typeof i.start=="string"?i.start:null,e.ignoreCase=PJ(i.ignoreCase,!1),e.unicode=PJ(i.unicode,!1),e.tokenPostfix=NJ(i.tokenPostfix,"."+e.languageId),e.defaultToken=NJ(i.defaultToken,"source"),e.usesEmbedded=!1;const s=i;function n(t,r,o){for(const h of o){let o=h.include;if(o){if(typeof o!="string")throw _m(e,"an 'include' attribute must be a string at: "+t);if(o[0]==="@"&&(o=o.substr(1)),!i.tokenizer[o])throw _m(e,"include target '"+o+"' is not defined at: "+t);n(t+"."+o,r,i.tokenizer[o])}else{const i=new HJ(t);if(Array.isArray(h)&&h.length>=1&&h.length<=3)if(i.setRegex(s,h[0]),h.length>=3)if(typeof h[1]=="string")i.setAction(s,{token:h[1],next:h[2]});else{if(typeof h[1]!="object")throw _m(e,"a next state as the last element of a rule can only be given if the action is either an object or a string, at: "+t);{const t=h[1];t.next=h[2],i.setAction(s,t)}}else i.setAction(s,h[1]);else{if(!h.regex)throw _m(e,"a rule must either be an array, or an object with a 'regex' or 'include' field at: "+t);h.name&&typeof h.name=="string"&&(i.name=h.name),h.matchOnlyAtStart&&(i.matchOnlyAtLineStart=PJ(h.matchOnlyAtLineStart,!1)),i.setRegex(s,h.regex),i.setAction(s,h.action)}r.push(i)}}}if(s.languageId=t,s.includeLF=e.includeLF,s.ignoreCase=e.ignoreCase,s.unicode=e.unicode,s.noThrow=e.noThrow,s.usesEmbedded=e.usesEmbedded,s.stateNames=i.tokenizer,s.defaultToken=e.defaultToken,!i.tokenizer||typeof i.tokenizer!="object")throw _m(e,"a language definition must define the 'tokenizer' attribute as an object");e.tokenizer=[];for(const t in i.tokenizer)if(i.tokenizer.hasOwnProperty(t)){e.start||(e.start=t);const s=i.tokenizer[t];e.tokenizer[t]=new Array,n("tokenizer."+t,e.tokenizer[t],s)}if(e.usesEmbedded=s.usesEmbedded,i.brackets){if(!Array.isArray(i.brackets))throw _m(e,"the 'brackets' attribute must be defined as an array")}else i.brackets=[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"},{open:"<",close:">",token:"delimiter.angle"}];const r=[];for(const t of i.brackets){let i=t;if(i&&Array.isArray(i)&&i.length===3&&(i={token:i[2],open:i[0],close:i[1]}),i.open===i.close)throw _m(e,"open and close brackets in a 'brackets' attribute must be different: "+i.open+`\n hint: use the 'bracket' attribute if matching on equal brackets is required.`);if(typeof i.open!="string"||typeof i.token!="string"||typeof i.close!="string")throw _m(e,"every element in the 'brackets' array must be a '{open,close,token}' object or array");r.push({token:i.token+e.tokenPostfix,open:Om(e,i.open),close:Om(e,i.close)})}return e.brackets=r,e.noThrow=!0,e}function zJ(t){Qd.registerLanguage(t)}function UJ(){let t=[];return t=t.concat(Qd.getLanguages()),t}function KJ(t){return Sq.get(Id).languageIdCodec.encodeLanguageId(t)}function qJ(t,i){return Sq.withServices((()=>{const e=Sq.get(Id).onDidRequestRichLanguageFeatures((s=>{s===t&&(e.dispose(),i())}));return e}))}function GJ(t,i){return Sq.withServices((()=>{const e=Sq.get(Id).onDidRequestBasicLanguageFeatures((s=>{s===t&&(e.dispose(),i())}));return e}))}function ZJ(t,i){if(!Sq.get(Id).isRegisteredLanguageId(t))throw new Error(`Cannot set configuration for unknown language ${t}`);return Sq.get(cf).register(t,i,100)}class JJ{constructor(t,i){this._languageId=t,this._actual=i}dispose(){}getInitialState(){return this._actual.getInitialState()}tokenize(t,i,e){if(typeof this._actual.tokenize=="function")return QJ.adaptTokenize(this._languageId,this._actual,t,e);throw new Error("Not supported!")}tokenizeEncoded(t,i,e){const s=this._actual.tokenizeEncoded(t,e);return new Ts(s.tokens,s.endState)}}class QJ{constructor(t,i,e,s){this._languageId=t,this._actual=i,this._languageService=e,this._standaloneThemeService=s}dispose(){}getInitialState(){return this._actual.getInitialState()}static _toClassicTokens(t,i){const e=[];let s=0;for(let n=0,r=t.length;n<r;n++){const r=t[n];let o=r.startIndex;n===0?o=0:o<s&&(o=s),e[n]=new Ls(o,r.scopes,i),s=o}return e}static adaptTokenize(t,i,e,s){const n=i.tokenize(e,s),r=QJ._toClassicTokens(n.tokens,t);let o;return o=n.endState.equals(s)?s:n.endState,new Fs(r,o)}tokenize(t,i,e){return QJ.adaptTokenize(this._languageId,this._actual,t,e)}_toBinaryTokens(t,i){const e=t.encodeLanguageId(this._languageId),s=this._standaloneThemeService.getColorTheme().tokenTheme,n=[];let r=0,o=0;for(let t=0,h=i.length;t<h;t++){const h=i[t],c=1024|s.match(e,h.scopes);if(r>0&&n[r-1]===c)continue;let l=h.startIndex;t===0?l=0:l<o&&(l=o),n[r++]=l,n[r++]=c,o=l}const h=new Uint32Array(r);for(let t=0;t<r;t++)h[t]=n[t];return h}tokenizeEncoded(t,i,e){const s=this._actual.tokenize(t,e),n=this._toBinaryTokens(this._languageService.languageIdCodec,s.tokens);let r;return r=s.endState.equals(e)?e:s.endState,new Ts(n,r)}}function YJ(t){return t&&typeof t.then=="function"}function XJ(t){const i=Sq.get(aK);if(t){const e=[null];for(let i=1,s=t.length;i<s;i++)e[i]=kp.fromHex(t[i]);i.setColorMapOverride(e)}else i.setColorMapOverride(null)}function tQ(t,i){return function(t){return"tokenizeEncoded"in t}(i)?new JJ(t,i):new QJ(t,i,Sq.get(Id),Sq.get(aK))}function iQ(t,i){const e=new zs((async()=>{const e=await Promise.resolve(i.create());return e?typeof e.getInitialState=="function"?tQ(t,e):new Gm(Sq.get(Id),Sq.get(aK),t,VJ(t,e),Sq.get(Md)):null}));return Us.registerFactory(t,e)}function eQ(t,i){if(!Sq.get(Id).isRegisteredLanguageId(t))throw new Error(`Cannot set tokens provider for unknown language ${t}`);return YJ(i)?iQ(t,{create:()=>i}):Us.register(t,tQ(t,i))}function sQ(t,i){return YJ(i)?iQ(t,{create:()=>i}):Us.register(t,(i=>new Gm(Sq.get(Id),Sq.get(aK),t,VJ(t,i),Sq.get(Md)))(i))}function nQ(t,i){return Sq.get($p).referenceProvider.register(t,i)}function rQ(t,i){return Sq.get($p).renameProvider.register(t,i)}function oQ(t,i){return Sq.get($p).newSymbolNamesProvider.register(t,i)}function hQ(t,i){return Sq.get($p).signatureHelpProvider.register(t,i)}function cQ(t,i){return Sq.get($p).hoverProvider.register(t,{provideHover:(t,e,s)=>{const n=t.getWordAtPosition(e);return Promise.resolve(i.provideHover(t,e,s)).then((t=>{if(t)return!t.range&&n&&(t.range=new Cs(e.lineNumber,n.startColumn,e.lineNumber,n.endColumn)),t.range||(t.range=new Cs(e.lineNumber,e.column,e.lineNumber,e.column)),t}))}})}function lQ(t,i){return Sq.get($p).documentSymbolProvider.register(t,i)}function aQ(t,i){return Sq.get($p).documentHighlightProvider.register(t,i)}function uQ(t,i){return Sq.get($p).linkedEditingRangeProvider.register(t,i)}function dQ(t,i){return Sq.get($p).definitionProvider.register(t,i)}function fQ(t,i){return Sq.get($p).implementationProvider.register(t,i)}function gQ(t,i){return Sq.get($p).typeDefinitionProvider.register(t,i)}function pQ(t,i){return Sq.get($p).codeLensProvider.register(t,i)}function mQ(t,i,e){return Sq.get($p).codeActionProvider.register(t,{providedCodeActionKinds:e==null?void 0:e.providedCodeActionKinds,documentation:e==null?void 0:e.documentation,provideCodeActions:(t,e,s,n)=>{const r=Sq.get(XW).read({resource:t.uri}).filter((t=>Cs.areIntersectingOrTouching(t,e)));return i.provideCodeActions(t,e,{markers:r,only:s.only,trigger:s.trigger},n)},resolveCodeAction:i.resolveCodeAction})}function wQ(t,i){return Sq.get($p).documentFormattingEditProvider.register(t,i)}function vQ(t,i){return Sq.get($p).documentRangeFormattingEditProvider.register(t,i)}function bQ(t,i){return Sq.get($p).onTypeFormattingEditProvider.register(t,i)}function yQ(t,i){return Sq.get($p).linkProvider.register(t,i)}function kQ(t,i){return Sq.get($p).completionProvider.register(t,i)}function CQ(t,i){return Sq.get($p).colorProvider.register(t,i)}function SQ(t,i){return Sq.get($p).foldingRangeProvider.register(t,i)}function xQ(t,i){return Sq.get($p).declarationProvider.register(t,i)}function DQ(t,i){return Sq.get($p).selectionRangeProvider.register(t,i)}function EQ(t,i){return Sq.get($p).documentSemanticTokensProvider.register(t,i)}function AQ(t,i){return Sq.get($p).documentRangeSemanticTokensProvider.register(t,i)}function MQ(t,i){return Sq.get($p).inlineCompletionsProvider.register(t,i)}function LQ(t,i){return Sq.get($p).inlineEditProvider.register(t,i)}function FQ(t,i){return Sq.get($p).inlayHintsProvider.register(t,i)}const TQ=_l("IEditorCancelService"),RQ=new Ta("cancellableOperation",!1,tt(0,"Whether the editor runs a cancellable operation, e.g. like 'Peek References'"));Nd(TQ,class{constructor(){this._tokens=new WeakMap}add(t,i){let e,s=this._tokens.get(t);return s||(s=t.invokeWithinContext((t=>({key:RQ.bindTo(t.get(Ra)),tokens:new Ht}))),this._tokens.set(t,s)),s.key.set(!0),e=s.tokens.push(i),()=>{e&&(e(),s.key.set(!s.tokens.isEmpty()),e=void 0)}}cancel(t){const i=this._tokens.get(t);if(!i)return;const e=i.tokens.pop();e&&(e.cancel(),i.key.set(!i.tokens.isEmpty()))}},1);class OQ extends ye{constructor(t,i){super(i),this.editor=t,this._unregister=t.invokeWithinContext((i=>i.get(TQ).add(t,this)))}dispose(){this._unregister(),super.dispose()}}yu(new class extends pu{constructor(){super({id:"editor.cancelOperation",kbOpts:{weight:100,primary:9},precondition:RQ})}runEditorCommand(t,i){t.get(TQ).cancel(i)}});let IQ=class t{constructor(t,i){if(this.flags=i,1&this.flags){const i=t.getModel();this.modelVersionId=i?Kn("{0}#{1}",i.uri.toString(),i.getVersionId()):null}else this.modelVersionId=null;4&this.flags?this.position=t.getPosition():this.position=null,2&this.flags?this.selection=t.getSelection():this.selection=null,8&this.flags?(this.scrollLeft=t.getScrollLeft(),this.scrollTop=t.getScrollTop()):(this.scrollLeft=-1,this.scrollTop=-1)}_equals(i){if(!(i instanceof t))return!1;const e=i;return this.modelVersionId===e.modelVersionId&&this.scrollLeft===e.scrollLeft&&this.scrollTop===e.scrollTop&&!(!this.position&&e.position||this.position&&!e.position||this.position&&e.position&&!this.position.equals(e.position))&&!(!this.selection&&e.selection||this.selection&&!e.selection||this.selection&&e.selection&&!this.selection.equalsRange(e.selection))}validate(i){return this._equals(new t(i,this.flags))}};class _Q extends OQ{constructor(t,i,e,s){super(t,s),this._listener=new Ji,4&i&&this._listener.add(t.onDidChangeCursorPosition((t=>{e&&Cs.containsPosition(e,t.position)||this.cancel()}))),2&i&&this._listener.add(t.onDidChangeCursorSelection((t=>{e&&Cs.containsRange(e,t.selection)||this.cancel()}))),8&i&&this._listener.add(t.onDidScrollChange((t=>this.cancel()))),1&i&&(this._listener.add(t.onDidChangeModel((t=>this.cancel()))),this._listener.add(t.onDidChangeModelContent((t=>this.cancel()))))}dispose(){this._listener.dispose(),super.dispose()}}class PQ extends ye{constructor(t,i){super(i),this._listener=t.onDidChangeContent((()=>this.cancel()))}dispose(){this._listener.dispose(),super.dispose()}}function NQ(t){return!(!t||typeof t.getEditorType!="function")&&t.getEditorType()===Yp.ICodeEditor}function BQ(t){return!(!t||typeof t.getEditorType!="function")&&t.getEditorType()===Yp.IDiffEditor}function $Q(t){return NQ(t)?t:BQ(t)?t.getModifiedEditor():function(t){return!!t&&typeof t=="object"&&typeof t.onDidChangeActiveEditor=="function"}(t)&&NQ(t.activeCodeEditor)?t.activeCodeEditor:null}class WQ{static _handleEolEdits(t,i){let e;const s=[];for(const t of i)typeof t.eol=="number"&&(e=t.eol),t.range&&typeof t.text=="string"&&s.push(t);return typeof e=="number"&&t.hasModel()&&t.getModel().pushEOL(e),s}static _isFullModelReplaceEdit(t,i){if(!t.hasModel())return!1;const e=t.getModel(),s=e.validateRange(i.range);return e.getFullModelRange().equalsRange(s)}static execute(t,i,e){e&&t.pushUndoStop();const s=xq.capture(t),n=WQ._handleEolEdits(t,i);n.length===1&&WQ._isFullModelReplaceEdit(t,n[0])?t.executeEdits("formatEditsCommand",n.map((t=>KP.replace(Cs.lift(t.range),t.text)))):t.executeEdits("formatEditsCommand",n.map((t=>KP.replaceMove(Cs.lift(t.range),t.text)))),e&&t.pushUndoStop(),s.restoreRelativeVerticalPositionOfCursor(t)}}class jQ{constructor(t){this.value=t,this._lower=t.toLowerCase()}static toKey(t){return typeof t=="string"?t.toLowerCase():t._lower}}class HQ{constructor(t){if(this._set=new Set,t)for(const i of t)this.add(i)}add(t){this._set.add(jQ.toKey(t))}has(t){return this._set.has(jQ.toKey(t))}}function VQ(t,i,e){const s=[],n=new HQ,r=t.ordered(e);for(const t of r)s.push(t),t.extensionId&&n.add(t.extensionId);const o=i.ordered(e);for(const t of o){if(t.extensionId){if(n.has(t.extensionId))continue;n.add(t.extensionId)}s.push({displayName:t.displayName,extensionId:t.extensionId,provideDocumentFormattingEdits:(i,e,s)=>t.provideDocumentRangeFormattingEdits(i,i.getFullModelRange(),e,s)})}return s}class zQ{static setFormatterSelector(t){return{dispose:zQ._selectors.unshift(t)}}static async select(t,i,e,s){if(t.length===0)return;const n=Wt.first(zQ._selectors);return n?await n(t,i,e,s):void 0}}async function UQ(t,i,e,s,n,r,o){const h=t.get(Il),{documentRangeFormattingEditProvider:c}=t.get($p),l=NQ(i)?i.getModel():i,a=c.ordered(l),u=await zQ.select(a,l,s,2);u&&(n.report(u),await h.invokeFunction(KQ,u,i,e,r,o))}async function KQ(t,i,e,s,n,r){var o,h;const c=t.get(JW),l=t.get(ou),a=t.get(QK);let u,d;NQ(e)?(u=e.getModel(),d=new _Q(e,5,void 0,n)):(u=e,d=new PQ(e,n));const f=[];let g=0;for(const t of k(s).sort(Cs.compareRangesUsingStarts))g>0&&Cs.areIntersectingOrTouching(f[g-1],t)?f[g-1]=Cs.fromPositions(f[g-1].getStartPosition(),t.getEndPosition()):g=f.push(t);const p=async t=>{var e,s;l.trace("[format][provideDocumentRangeFormattingEdits] (request)",(e=i.extensionId)===null||e===void 0?void 0:e.value,t);const n=await i.provideDocumentRangeFormattingEdits(u,t,u.getFormattingOptions(),d.token)||[];return l.trace("[format][provideDocumentRangeFormattingEdits] (response)",(s=i.extensionId)===null||s===void 0?void 0:s.value,n),n},m=(t,i)=>{if(!t.length||!i.length)return!1;const e=t.reduce(((t,i)=>Cs.plusRange(t,i.range)),t[0].range);if(!i.some((t=>Cs.intersectRanges(e,t.range))))return!1;for(const e of t)for(const t of i)if(Cs.intersectRanges(e.range,t.range))return!0;return!1},w=[],v=[];try{if(typeof i.provideDocumentRangesFormattingEdits=="function"){l.trace("[format][provideDocumentRangeFormattingEdits] (request)",(o=i.extensionId)===null||o===void 0?void 0:o.value,f);const t=await i.provideDocumentRangesFormattingEdits(u,f,u.getFormattingOptions(),d.token)||[];l.trace("[format][provideDocumentRangeFormattingEdits] (response)",(h=i.extensionId)===null||h===void 0?void 0:h.value,t),v.push(t)}else{for(const t of f){if(d.token.isCancellationRequested)return!0;v.push(await p(t))}for(let t=0;t<f.length;++t)for(let i=t+1;i<f.length;++i){if(d.token.isCancellationRequested)return!0;if(m(v[t],v[i])){const e=Cs.plusRange(f[t],f[i]),s=await p(e);f.splice(i,1),f.splice(t,1),f.push(e),v.splice(i,1),v.splice(t,1),v.push(s),t=0,i=0}}}for(const t of v){if(d.token.isCancellationRequested)return!0;const i=await c.computeMoreMinimalEdits(u.uri,t);i&&w.push(...i)}}finally{d.dispose()}if(w.length===0)return!1;if(NQ(e))WQ.execute(e,w,!0),e.revealPositionInCenterIfOutsideViewport(e.getPosition(),1);else{const[{range:t}]=w,i=new Ss(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn);u.pushEditOperations([i],w.map((t=>({text:t.text,range:Cs.lift(t.range),forceMoveMarkers:!0}))),(t=>{for(const{range:e}of t)if(Cs.areIntersectingOrTouching(e,i))return[new Ss(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn)];return null}))}return a.playSignal(tq.format,{userGesture:r}),!0}async function qQ(t,i,e,s,n,r){const o=t.get(Il),h=t.get($p),c=NQ(i)?i.getModel():i,l=VQ(h.documentFormattingEditProvider,h.documentRangeFormattingEditProvider,c),a=await zQ.select(l,c,e,1);a&&(s.report(a),await o.invokeFunction(GQ,a,i,e,n,r))}async function GQ(t,i,e,s,n,r){const o=t.get(JW),h=t.get(QK);let c,l,a;NQ(e)?(c=e.getModel(),l=new _Q(e,5,void 0,n)):(c=e,l=new PQ(e,n));try{const t=await i.provideDocumentFormattingEdits(c,c.getFormattingOptions(),l.token);if(a=await o.computeMoreMinimalEdits(c.uri,t),l.token.isCancellationRequested)return!0}finally{l.dispose()}if(!a||a.length===0)return!1;if(NQ(e))WQ.execute(e,a,s!==2),s!==2&&e.revealPositionInCenterIfOutsideViewport(e.getPosition(),1);else{const[{range:t}]=a,i=new Ss(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn);c.pushEditOperations([i],a.map((t=>({text:t.text,range:Cs.lift(t.range),forceMoveMarkers:!0}))),(t=>{for(const{range:e}of t)if(Cs.areIntersectingOrTouching(e,i))return[new Ss(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn)];return null}))}return h.playSignal(tq.format,{userGesture:r}),!0}function ZQ(t,i,e,s,n,r,o){const h=i.onTypeFormattingEditProvider.ordered(e);return h.length===0||h[0].autoFormatTriggerCharacters.indexOf(n)<0?Promise.resolve(void 0):Promise.resolve(h[0].provideOnTypeFormattingEdits(e,s,n,r,o)).catch(_i).then((i=>t.computeMoreMinimalEdits(e.uri,i)))}zQ._selectors=new Ht,Gl.registerCommand("_executeFormatRangeProvider",(async function(t,...i){const[e,s,n]=i;j(as.isUri(e)),j(Cs.isIRange(s));const r=t.get(Bl),o=t.get(JW),h=t.get($p),c=await r.createModelReference(e);try{return async function(t,i,e,s,n,r){const o=i.documentRangeFormattingEditProvider.ordered(e);for(const i of o){const o=await Promise.resolve(i.provideDocumentRangeFormattingEdits(e,s,n,r)).catch(_i);if(f(o))return await t.computeMoreMinimalEdits(e.uri,o)}}(o,h,c.object.textEditorModel,Cs.lift(s),n,ve.None)}finally{c.dispose()}})),Gl.registerCommand("_executeFormatDocumentProvider",(async function(t,...i){const[e,s]=i;j(as.isUri(e));const n=t.get(Bl),r=t.get(JW),o=t.get($p),h=await n.createModelReference(e);try{return async function(t,i,e,s,n){const r=VQ(i.documentFormattingEditProvider,i.documentRangeFormattingEditProvider,e);for(const i of r){const r=await Promise.resolve(i.provideDocumentFormattingEdits(e,s,n)).catch(_i);if(f(r))return await t.computeMoreMinimalEdits(e.uri,r)}}(r,o,h.object.textEditorModel,s,ve.None)}finally{h.dispose()}})),Gl.registerCommand("_executeFormatOnTypeProvider",(async function(t,...i){const[e,s,n,r]=i;j(as.isUri(e)),j(ks.isIPosition(s)),j(typeof n=="string");const o=t.get(Bl),h=t.get(JW),c=t.get($p),l=await o.createModelReference(e);try{return ZQ(h,c,l.object.textEditorModel,ks.lift(s),n,r,ve.None)}finally{l.dispose()}})),Ri.wrappingIndent.defaultValue=0,Ri.glyphMargin.defaultValue=!1,Ri.autoIndent.defaultValue=3,Ri.overviewRulerLanes.defaultValue=2,zQ.setFormatterSelector(((t,i,e)=>Promise.resolve(t[0])));const JQ=$n();JQ.editor={create:sJ,getEditors:oJ,getDiffEditors:hJ,onDidCreateEditor:nJ,onDidCreateDiffEditor:rJ,createDiffEditor:cJ,addCommand:aJ,addEditorAction:uJ,addKeybindingRule:dJ,addKeybindingRules:fJ,createModel:gJ,setModelLanguage:pJ,setModelMarkers:mJ,getModelMarkers:vJ,removeAllMarkers:wJ,onDidChangeMarkers:bJ,getModels:kJ,getModel:yJ,onDidCreateModel:CJ,onWillDisposeModel:SJ,onDidChangeModelLanguage:xJ,createWebWorker:DJ,colorizeElement:EJ,colorize:AJ,colorizeModelLine:MJ,tokenize:LJ,defineTheme:FJ,setTheme:TJ,remeasureFonts:RJ,registerCommand:OJ,registerLinkOpener:IJ,registerEditorOpener:_J,AccessibilitySupport:qs,ContentWidgetPositionPreference:Xs,CursorChangeReason:tn,DefaultEndOfLine:en,EditorAutoIndentStrategy:nn,EditorOption:rn,EndOfLinePreference:on,EndOfLineSequence:hn,MinimapPosition:wn,MinimapSectionHeaderStyle:vn,MouseTargetType:bn,OverlayWidgetPositionPreference:kn,OverviewRulerLane:Cn,GlyphMarginLane:cn,RenderLineNumbersType:Dn,RenderMinimap:En,ScrollbarVisibility:Mn,ScrollType:An,TextEditorCursorBlinkingStyle:In,TextEditorCursorStyle:_n,TrackedRangeStickiness:Pn,WrappingIndent:Nn,InjectedTextCursorStops:an,PositionAffinity:xn,ShowLightbulbIconMode:Fn,ConfigurationChangedEvent:Zt,BareFontInfo:Ll,FontInfo:Fl,TextModelResolvedOptions:ig,FindMatch:eg,ApplyUpdateResult:Yt,EditorZoom:Al,createMultiFileDiffEditor:lJ,EditorType:Yp,EditorOptions:Ri},JQ.languages={register:zJ,getLanguages:UJ,onLanguage:qJ,onLanguageEncountered:GJ,getEncodedLanguageId:KJ,setLanguageConfiguration:ZJ,setColorMap:XJ,registerTokensProviderFactory:iQ,setTokensProvider:eQ,setMonarchTokensProvider:sQ,registerReferenceProvider:nQ,registerRenameProvider:rQ,registerNewSymbolNameProvider:oQ,registerCompletionItemProvider:kQ,registerSignatureHelpProvider:hQ,registerHoverProvider:cQ,registerDocumentSymbolProvider:lQ,registerDocumentHighlightProvider:aQ,registerLinkedEditingRangeProvider:uQ,registerDefinitionProvider:dQ,registerImplementationProvider:fQ,registerTypeDefinitionProvider:gQ,registerCodeLensProvider:pQ,registerCodeActionProvider:mQ,registerDocumentFormattingEditProvider:wQ,registerDocumentRangeFormattingEditProvider:vQ,registerOnTypeFormattingEditProvider:bQ,registerLinkProvider:yQ,registerColorProvider:CQ,registerFoldingRangeProvider:SQ,registerDeclarationProvider:xQ,registerSelectionRangeProvider:DQ,registerDocumentSemanticTokensProvider:EQ,registerDocumentRangeSemanticTokensProvider:AQ,registerInlineCompletionsProvider:MQ,registerInlineEditProvider:LQ,registerInlayHintsProvider:FQ,DocumentHighlightKind:sn,CompletionItemKind:Js,CompletionItemTag:Qs,CompletionItemInsertTextRule:Zs,SymbolKind:Rn,SymbolTag:On,IndentAction:ln,CompletionTriggerKind:Ys,SignatureHelpTriggerKind:Tn,InlayHintKind:un,InlineCompletionTriggerKind:dn,InlineEditTriggerKind:fn,CodeActionTriggerType:Gs,NewSymbolNameTag:yn,PartialAcceptTriggerKind:Sn,FoldingRangeKind:Vs,SelectedSuggestionInfo:Ns};const QQ=JQ.CancellationTokenSource,YQ=JQ.Emitter,XQ=JQ.KeyCode,tY=JQ.KeyMod,iY=JQ.Position,eY=JQ.Range,sY=JQ.Selection,nY=JQ.SelectionDirection,rY=JQ.MarkerSeverity,oY=JQ.MarkerTag,hY=JQ.Uri,cY=JQ.Token,lY=JQ.editor,aY=JQ.languages,uY=globalThis.MonacoEnvironment;(uY!=null&&uY.globalAPI||typeof define=="function"&&define.amd)&&(globalThis.monaco=JQ),globalThis.require!==void 0&&typeof globalThis.require.config=="function"&&globalThis.require.config({ignoreDuplicateModules:["vscode-languageserver-types","vscode-languageserver-types/main","vscode-languageserver-textdocument","vscode-languageserver-textdocument/main","vscode-nls","vscode-nls/vscode-nls","jsonc-parser","jsonc-parser/main","vscode-uri","vscode-uri/index","vs/basic-languages/typescript/typescript"]});const dY=Object.freeze(Object.defineProperty({__proto__:null,CancellationTokenSource:QQ,Emitter:YQ,KeyCode:XQ,KeyMod:tY,MarkerSeverity:rY,MarkerTag:oY,Position:iY,Range:eY,Selection:sY,SelectionDirection:nY,Token:cY,Uri:hY,editor:lY,languages:aY},Symbol.toStringTag,{value:"Module"}));var fY=Object.defineProperty,gY=Object.getOwnPropertyDescriptor,pY=Object.getOwnPropertyNames,mY=Object.prototype.hasOwnProperty,wY={};((t,i,e,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let n of pY(i))mY.call(t,n)||n===e||fY(t,n,{get:()=>i[n],enumerable:!(s=gY(i,n))||s.enumerable})})(wY,dY,"default");var vY={},bY={},yY=class t{static getOrCreate(i){return bY[i]||(bY[i]=new t(i)),bY[i]}constructor(t){this._languageId=t,this._loadingTriggered=!1,this._lazyLoadPromise=new Promise(((t,i)=>{this._lazyLoadPromiseResolve=t,this._lazyLoadPromiseReject=i}))}load(){return this._loadingTriggered||(this._loadingTriggered=!0,vY[this._languageId].loader().then((t=>this._lazyLoadPromiseResolve(t)),(t=>this._lazyLoadPromiseReject(t)))),this._lazyLoadPromise}};function kY(t){const i=t.id;vY[i]=t,wY.languages.register(t);const e=yY.getOrCreate(i);wY.languages.registerTokensProviderFactory(i,{create:async()=>(await e.load()).language}),wY.languages.onLanguageEncountered(i,(async()=>{const t=await e.load();wY.languages.setLanguageConfiguration(i,t.conf)}))}kY({id:"abap",extensions:[".abap"],aliases:["abap","ABAP"],loader:()=>import("./p-5213953b.js")}),kY({id:"apex",extensions:[".cls"],aliases:["Apex","apex"],mimetypes:["text/x-apex-source","text/x-apex"],loader:()=>import("./p-43aeb2aa.js")}),kY({id:"azcli",extensions:[".azcli"],aliases:["Azure CLI","azcli"],loader:()=>import("./p-b573dac8.js")}),kY({id:"bat",extensions:[".bat",".cmd"],aliases:["Batch","bat"],loader:()=>import("./p-c31ecc89.js")}),kY({id:"bicep",extensions:[".bicep"],aliases:["Bicep"],loader:()=>import("./p-90563e28.js")}),kY({id:"cameligo",extensions:[".mligo"],aliases:["Cameligo"],loader:()=>import("./p-5315745f.js")}),kY({id:"clojure",extensions:[".clj",".cljs",".cljc",".edn"],aliases:["clojure","Clojure"],loader:()=>import("./p-c9595ee2.js")}),kY({id:"coffeescript",extensions:[".coffee"],aliases:["CoffeeScript","coffeescript","coffee"],mimetypes:["text/x-coffeescript","text/coffeescript"],loader:()=>import("./p-66dc0073.js")}),kY({id:"c",extensions:[".c",".h"],aliases:["C","c"],loader:()=>import("./p-a8f7d24a.js")}),kY({id:"cpp",extensions:[".cpp",".cc",".cxx",".hpp",".hh",".hxx"],aliases:["C++","Cpp","cpp"],loader:()=>import("./p-a8f7d24a.js")}),kY({id:"csharp",extensions:[".cs",".csx",".cake"],aliases:["C#","csharp"],loader:()=>import("./p-661bc589.js")}),kY({id:"csp",extensions:[],aliases:["CSP","csp"],loader:()=>import("./p-553b36b7.js")}),kY({id:"css",extensions:[".css"],aliases:["CSS","css"],mimetypes:["text/css"],loader:()=>import("./p-9aeddd7f.js")}),kY({id:"cypher",extensions:[".cypher",".cyp"],aliases:["Cypher","OpenCypher"],loader:()=>import("./p-543c867b.js")}),kY({id:"dart",extensions:[".dart"],aliases:["Dart","dart"],mimetypes:["text/x-dart-source","text/x-dart"],loader:()=>import("./p-f7409685.js")}),kY({id:"dockerfile",extensions:[".dockerfile"],filenames:["Dockerfile"],aliases:["Dockerfile"],loader:()=>import("./p-9e010723.js")}),kY({id:"ecl",extensions:[".ecl"],aliases:["ECL","Ecl","ecl"],loader:()=>import("./p-94d4e154.js")}),kY({id:"elixir",extensions:[".ex",".exs"],aliases:["Elixir","elixir","ex"],loader:()=>import("./p-d34540f2.js")}),kY({id:"flow9",extensions:[".flow"],aliases:["Flow9","Flow","flow9","flow"],loader:()=>import("./p-f64be741.js")}),kY({id:"fsharp",extensions:[".fs",".fsi",".ml",".mli",".fsx",".fsscript"],aliases:["F#","FSharp","fsharp"],loader:()=>import("./p-b79e80d9.js")}),kY({id:"freemarker2",extensions:[".ftl",".ftlh",".ftlx"],aliases:["FreeMarker2","Apache FreeMarker2"],loader:()=>import("./p-3f9303a5.js").then((t=>t.TagAutoInterpolationDollar))}),kY({id:"freemarker2.tag-angle.interpolation-dollar",aliases:["FreeMarker2 (Angle/Dollar)","Apache FreeMarker2 (Angle/Dollar)"],loader:()=>import("./p-3f9303a5.js").then((t=>t.TagAngleInterpolationDollar))}),kY({id:"freemarker2.tag-bracket.interpolation-dollar",aliases:["FreeMarker2 (Bracket/Dollar)","Apache FreeMarker2 (Bracket/Dollar)"],loader:()=>import("./p-3f9303a5.js").then((t=>t.TagBracketInterpolationDollar))}),kY({id:"freemarker2.tag-angle.interpolation-bracket",aliases:["FreeMarker2 (Angle/Bracket)","Apache FreeMarker2 (Angle/Bracket)"],loader:()=>import("./p-3f9303a5.js").then((t=>t.TagAngleInterpolationBracket))}),kY({id:"freemarker2.tag-bracket.interpolation-bracket",aliases:["FreeMarker2 (Bracket/Bracket)","Apache FreeMarker2 (Bracket/Bracket)"],loader:()=>import("./p-3f9303a5.js").then((t=>t.TagBracketInterpolationBracket))}),kY({id:"freemarker2.tag-auto.interpolation-dollar",aliases:["FreeMarker2 (Auto/Dollar)","Apache FreeMarker2 (Auto/Dollar)"],loader:()=>import("./p-3f9303a5.js").then((t=>t.TagAutoInterpolationDollar))}),kY({id:"freemarker2.tag-auto.interpolation-bracket",aliases:["FreeMarker2 (Auto/Bracket)","Apache FreeMarker2 (Auto/Bracket)"],loader:()=>import("./p-3f9303a5.js").then((t=>t.TagAutoInterpolationBracket))}),kY({id:"go",extensions:[".go"],aliases:["Go"],loader:()=>import("./p-1aa44dfa.js")}),kY({id:"graphql",extensions:[".graphql",".gql"],aliases:["GraphQL","graphql","gql"],mimetypes:["application/graphql"],loader:()=>import("./p-b675e862.js")}),kY({id:"handlebars",extensions:[".handlebars",".hbs"],aliases:["Handlebars","handlebars","hbs"],mimetypes:["text/x-handlebars-template"],loader:()=>import("./p-76c73565.js")}),kY({id:"hcl",extensions:[".tf",".tfvars",".hcl"],aliases:["Terraform","tf","HCL","hcl"],loader:()=>import("./p-a2b8e3bb.js")}),kY({id:"html",extensions:[".html",".htm",".shtml",".xhtml",".mdoc",".jsp",".asp",".aspx",".jshtm"],aliases:["HTML","htm","html","xhtml"],mimetypes:["text/html","text/x-jshtm","text/template","text/ng-template"],loader:()=>import("./p-fc22a593.js")}),kY({id:"ini",extensions:[".ini",".properties",".gitconfig"],filenames:["config",".gitattributes",".gitconfig",".editorconfig"],aliases:["Ini","ini"],loader:()=>import("./p-dc7cfdf6.js")}),kY({id:"java",extensions:[".java",".jav"],aliases:["Java","java"],mimetypes:["text/x-java-source","text/x-java"],loader:()=>import("./p-f023e899.js")}),kY({id:"javascript",extensions:[".js",".es6",".jsx",".mjs",".cjs"],firstLine:"^#!.*\\bnode",filenames:["jakefile"],aliases:["JavaScript","javascript","js"],mimetypes:["text/javascript"],loader:()=>import("./p-5c789389.js")}),kY({id:"julia",extensions:[".jl"],aliases:["julia","Julia"],loader:()=>import("./p-d70cbde7.js")}),kY({id:"kotlin",extensions:[".kt",".kts"],aliases:["Kotlin","kotlin"],mimetypes:["text/x-kotlin-source","text/x-kotlin"],loader:()=>import("./p-870c8be2.js")}),kY({id:"less",extensions:[".less"],aliases:["Less","less"],mimetypes:["text/x-less","text/less"],loader:()=>import("./p-4de7939b.js")}),kY({id:"lexon",extensions:[".lex"],aliases:["Lexon"],loader:()=>import("./p-a44492ee.js")}),kY({id:"lua",extensions:[".lua"],aliases:["Lua","lua"],loader:()=>import("./p-818f9acf.js")}),kY({id:"liquid",extensions:[".liquid",".html.liquid"],aliases:["Liquid","liquid"],mimetypes:["application/liquid"],loader:()=>import("./p-ce14f3b4.js")}),kY({id:"m3",extensions:[".m3",".i3",".mg",".ig"],aliases:["Modula-3","Modula3","modula3","m3"],loader:()=>import("./p-21fa4c4d.js")}),kY({id:"markdown",extensions:[".md",".markdown",".mdown",".mkdn",".mkd",".mdwn",".mdtxt",".mdtext"],aliases:["Markdown","markdown"],loader:()=>import("./p-f21dc0eb.js")}),kY({id:"mdx",extensions:[".mdx"],aliases:["MDX","mdx"],loader:()=>import("./p-7d8f207c.js")}),kY({id:"mips",extensions:[".s"],aliases:["MIPS","MIPS-V"],mimetypes:["text/x-mips","text/mips","text/plaintext"],loader:()=>import("./p-9223912c.js")}),kY({id:"msdax",extensions:[".dax",".msdax"],aliases:["DAX","MSDAX"],loader:()=>import("./p-40bb707c.js")}),kY({id:"mysql",extensions:[],aliases:["MySQL","mysql"],loader:()=>import("./p-5e153133.js")}),kY({id:"objective-c",extensions:[".m"],aliases:["Objective-C"],loader:()=>import("./p-81a686ed.js")}),kY({id:"pascal",extensions:[".pas",".p",".pp"],aliases:["Pascal","pas"],mimetypes:["text/x-pascal-source","text/x-pascal"],loader:()=>import("./p-3a5035b5.js")}),kY({id:"pascaligo",extensions:[".ligo"],aliases:["Pascaligo","ligo"],loader:()=>import("./p-fc1123ec.js")}),kY({id:"perl",extensions:[".pl",".pm"],aliases:["Perl","pl"],loader:()=>import("./p-819e4100.js")}),kY({id:"pgsql",extensions:[],aliases:["PostgreSQL","postgres","pg","postgre"],loader:()=>import("./p-d0a2a50e.js")}),kY({id:"php",extensions:[".php",".php4",".php5",".phtml",".ctp"],aliases:["PHP","php"],mimetypes:["application/x-php"],loader:()=>import("./p-c39167be.js")}),kY({id:"pla",extensions:[".pla"],loader:()=>import("./p-f9600264.js")}),kY({id:"postiats",extensions:[".dats",".sats",".hats"],aliases:["ATS","ATS/Postiats"],loader:()=>import("./p-35c36bb0.js")}),kY({id:"powerquery",extensions:[".pq",".pqm"],aliases:["PQ","M","Power Query","Power Query M"],loader:()=>import("./p-de0cadeb.js")}),kY({id:"powershell",extensions:[".ps1",".psm1",".psd1"],aliases:["PowerShell","powershell","ps","ps1"],loader:()=>import("./p-e6d38b37.js")}),kY({id:"proto",extensions:[".proto"],aliases:["protobuf","Protocol Buffers"],loader:()=>import("./p-c6d52eb8.js")}),kY({id:"pug",extensions:[".jade",".pug"],aliases:["Pug","Jade","jade"],loader:()=>import("./p-683f7b71.js")}),kY({id:"python",extensions:[".py",".rpy",".pyw",".cpy",".gyp",".gypi"],aliases:["Python","py"],firstLine:"^#!/.*\\bpython[0-9.-]*\\b",loader:()=>import("./p-ce1b1e6a.js")}),kY({id:"qsharp",extensions:[".qs"],aliases:["Q#","qsharp"],loader:()=>import("./p-d5d00ebf.js")}),kY({id:"r",extensions:[".r",".rhistory",".rmd",".rprofile",".rt"],aliases:["R","r"],loader:()=>import("./p-78a51c9a.js")}),kY({id:"razor",extensions:[".cshtml"],aliases:["Razor","razor"],mimetypes:["text/x-cshtml"],loader:()=>import("./p-35943764.js")}),kY({id:"redis",extensions:[".redis"],aliases:["redis"],loader:()=>import("./p-a79da0d6.js")}),kY({id:"redshift",extensions:[],aliases:["Redshift","redshift"],loader:()=>import("./p-3151abe6.js")}),kY({id:"restructuredtext",extensions:[".rst"],aliases:["reStructuredText","restructuredtext"],loader:()=>import("./p-2faa094f.js")}),kY({id:"ruby",extensions:[".rb",".rbx",".rjs",".gemspec",".pp"],filenames:["rakefile","Gemfile"],aliases:["Ruby","rb"],loader:()=>import("./p-b2ec7609.js")}),kY({id:"rust",extensions:[".rs",".rlib"],aliases:["Rust","rust"],loader:()=>import("./p-3a6e1c5e.js")}),kY({id:"sb",extensions:[".sb"],aliases:["Small Basic","sb"],loader:()=>import("./p-8d874a5e.js")}),kY({id:"scala",extensions:[".scala",".sc",".sbt"],aliases:["Scala","scala","SBT","Sbt","sbt","Dotty","dotty"],mimetypes:["text/x-scala-source","text/x-scala","text/x-sbt","text/x-dotty"],loader:()=>import("./p-ce30a76f.js")}),kY({id:"scheme",extensions:[".scm",".ss",".sch",".rkt"],aliases:["scheme","Scheme"],loader:()=>import("./p-0bea0da3.js")}),kY({id:"scss",extensions:[".scss"],aliases:["Sass","sass","scss"],mimetypes:["text/x-scss","text/scss"],loader:()=>import("./p-294c6e3b.js")}),kY({id:"shell",extensions:[".sh",".bash"],aliases:["Shell","sh"],loader:()=>import("./p-61d19265.js")}),kY({id:"sol",extensions:[".sol"],aliases:["sol","solidity","Solidity"],loader:()=>import("./p-05b3a218.js")}),kY({id:"aes",extensions:[".aes"],aliases:["aes","sophia","Sophia"],loader:()=>import("./p-534ac15a.js")}),kY({id:"sparql",extensions:[".rq"],aliases:["sparql","SPARQL"],loader:()=>import("./p-802e0f6b.js")}),kY({id:"sql",extensions:[".sql"],aliases:["SQL"],loader:()=>import("./p-19955ebb.js")}),kY({id:"st",extensions:[".st",".iecst",".iecplc",".lc3lib",".TcPOU",".TcDUT",".TcGVL",".TcIO"],aliases:["StructuredText","scl","stl"],loader:()=>import("./p-9dbc072c.js")}),kY({id:"swift",aliases:["Swift","swift"],extensions:[".swift"],mimetypes:["text/swift"],loader:()=>import("./p-b580040c.js")}),kY({id:"systemverilog",extensions:[".sv",".svh"],aliases:["SV","sv","SystemVerilog","systemverilog"],loader:()=>import("./p-74150766.js")}),kY({id:"verilog",extensions:[".v",".vh"],aliases:["V","v","Verilog","verilog"],loader:()=>import("./p-74150766.js")}),kY({id:"tcl",extensions:[".tcl"],aliases:["tcl","Tcl","tcltk","TclTk","tcl/tk","Tcl/Tk"],loader:()=>import("./p-24a84268.js")}),kY({id:"twig",extensions:[".twig"],aliases:["Twig","twig"],mimetypes:["text/x-twig"],loader:()=>import("./p-79294ebd.js")}),kY({id:"typescript",extensions:[".ts",".tsx",".cts",".mts"],aliases:["TypeScript","ts","typescript"],mimetypes:["text/typescript"],loader:()=>import("./p-ef676278.js")}),kY({id:"vb",extensions:[".vb"],aliases:["Visual Basic","vb"],loader:()=>import("./p-22b734c1.js")}),kY({id:"wgsl",extensions:[".wgsl"],aliases:["WebGPU Shading Language","WGSL","wgsl"],loader:()=>import("./p-0e24d50c.js")}),kY({id:"xml",extensions:[".xml",".xsd",".dtd",".ascx",".csproj",".config",".props",".targets",".wxi",".wxl",".wxs",".xaml",".svg",".svgz",".opf",".xslt",".xsl"],firstLine:"(\\<\\?xml.*)|(\\<svg)|(\\<\\!doctype\\s+svg)",aliases:["XML","xml"],mimetypes:["text/xml","application/xml","application/xaml+xml","application/xml-dtd"],loader:()=>import("./p-52d46f23.js")}),kY({id:"yaml",extensions:[".yaml",".yml"],aliases:["YAML","yaml","YML","yml"],mimetypes:["application/x-yaml","text/x-yaml"],loader:()=>import("./p-3a32d869.js")});var CY=Object.defineProperty,SY=Object.getOwnPropertyDescriptor,xY=Object.getOwnPropertyNames,DY=Object.prototype.hasOwnProperty,EY={};((t,i,e)=>{((t,i,e,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let n of xY(i))DY.call(t,n)||n===e||CY(t,n,{get:()=>i[n],enumerable:!(s=SY(i,n))||s.enumerable})})(t,i,"default")})(EY,dY);var AY=class{constructor(t,i,e){this._onDidChange=new EY.Emitter,this._languageId=t,this.setOptions(i),this.setModeConfiguration(e)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get modeConfiguration(){return this._modeConfiguration}get diagnosticsOptions(){return this.options}get options(){return this._options}setOptions(t){this._options=t||Object.create(null),this._onDidChange.fire(this)}setDiagnosticsOptions(t){this.setOptions(t)}setModeConfiguration(t){this._modeConfiguration=t||Object.create(null),this._onDidChange.fire(this)}},MY={validate:!0,lint:{compatibleVendorPrefixes:"ignore",vendorPrefix:"warning",duplicateProperties:"warning",emptyRules:"warning",importStatement:"ignore",boxModel:"ignore",universalSelector:"ignore",zeroUnits:"ignore",fontFaceProperties:"warning",hexColorLength:"error",argumentsInColorFunction:"error",unknownProperties:"warning",ieHack:"ignore",unknownVendorSpecificProperties:"ignore",propertyIgnoredDueToDisplay:"warning",important:"ignore",float:"ignore",idSelector:"ignore"},data:{useDefaultDataProvider:!0},format:{newlineBetweenSelectors:!0,newlineBetweenRules:!0,spaceAroundSelectorSeparator:!1,braceStyle:"collapse",maxPreserveNewLines:void 0,preserveNewLines:!0}},LY={completionItems:!0,hovers:!0,documentSymbols:!0,definitions:!0,references:!0,documentHighlights:!0,rename:!0,colors:!0,foldingRanges:!0,diagnostics:!0,selectionRanges:!0,documentFormattingEdits:!0,documentRangeFormattingEdits:!0},FY=new AY("css",MY,LY),TY=new AY("scss",MY,LY),RY=new AY("less",MY,LY);function OY(){return import("./p-b7a06cb6.js")}EY.languages.css={cssDefaults:FY,lessDefaults:RY,scssDefaults:TY},EY.languages.onLanguage("less",(()=>{OY().then((t=>t.setupMode(RY)))})),EY.languages.onLanguage("scss",(()=>{OY().then((t=>t.setupMode(TY)))})),EY.languages.onLanguage("css",(()=>{OY().then((t=>t.setupMode(FY)))}));var IY=Object.defineProperty,_Y=Object.getOwnPropertyDescriptor,PY=Object.getOwnPropertyNames,NY=Object.prototype.hasOwnProperty,BY={};((t,i,e)=>{((t,i,e,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let n of PY(i))NY.call(t,n)||n===e||IY(t,n,{get:()=>i[n],enumerable:!(s=_Y(i,n))||s.enumerable})})(t,i,"default")})(BY,dY);var $Y=class{constructor(t,i,e){this._onDidChange=new BY.Emitter,this._languageId=t,this.setOptions(i),this.setModeConfiguration(e)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get options(){return this._options}get modeConfiguration(){return this._modeConfiguration}setOptions(t){this._options=t||Object.create(null),this._onDidChange.fire(this)}setModeConfiguration(t){this._modeConfiguration=t||Object.create(null),this._onDidChange.fire(this)}},WY={format:{tabSize:4,insertSpaces:!1,wrapLineLength:120,unformatted:'default": "a, abbr, acronym, b, bdo, big, br, button, cite, code, dfn, em, i, img, input, kbd, label, map, object, q, samp, select, small, span, strong, sub, sup, textarea, tt, var',contentUnformatted:"pre",indentInnerHtml:!1,preserveNewLines:!0,maxPreserveNewLines:void 0,indentHandlebars:!1,endWithNewline:!1,extraLiners:"head, body, /html",wrapAttributes:"auto"},suggest:{},data:{useDefaultDataProvider:!0}};function jY(t){return{completionItems:!0,hovers:!0,documentSymbols:!0,links:!0,documentHighlights:!0,rename:!0,colors:!0,foldingRanges:!0,selectionRanges:!0,diagnostics:t===HY,documentFormattingEdits:t===HY,documentRangeFormattingEdits:t===HY}}var HY="html",VY="handlebars",zY="razor",UY=QY(HY,WY,jY(HY)),KY=UY.defaults,qY=QY(VY,WY,jY(VY)),GY=qY.defaults,ZY=QY(zY,WY,jY(zY)),JY=ZY.defaults;function QY(t,i=WY,e=jY(t)){const s=new $Y(t,i,e);let n;const r=BY.languages.onLanguage(t,(async()=>{n=(await import("./p-0c68c50e.js")).setupMode(s)}));return{defaults:s,dispose(){r.dispose(),n==null||n.dispose(),n=void 0}}}BY.languages.html={htmlDefaults:KY,razorDefaults:JY,handlebarDefaults:GY,htmlLanguageService:UY,handlebarLanguageService:qY,razorLanguageService:ZY,registerHTMLLanguageService:QY};var YY=new class{constructor(t,i,e){this._onDidChange=new YQ,this._languageId=t,this.setDiagnosticsOptions(i),this.setModeConfiguration(e)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get modeConfiguration(){return this._modeConfiguration}get diagnosticsOptions(){return this._diagnosticsOptions}setDiagnosticsOptions(t){this._diagnosticsOptions=t||Object.create(null),this._onDidChange.fire(this)}setModeConfiguration(t){this._modeConfiguration=t||Object.create(null),this._onDidChange.fire(this)}}("json",{validate:!0,allowComments:!0,schemas:[],enableSchemaRequest:!1,schemaRequest:"warning",schemaValidation:"warning",comments:"error",trailingCommas:"error"},{documentFormattingEdits:!0,documentRangeFormattingEdits:!0,completionItems:!0,hovers:!0,documentSymbols:!0,tokens:!0,colors:!0,foldingRanges:!0,diagnostics:!0,selectionRanges:!0});function XY(){return import("./p-0a5d5220.js")}aY.json={jsonDefaults:YY,getWorker:()=>XY().then((t=>t.getWorker()))},aY.register({id:"json",extensions:[".json",".bowerrc",".jshintrc",".jscsrc",".eslintrc",".babelrc",".har"],aliases:["JSON","json"],mimetypes:["application/json"]}),aY.onLanguage("json",(()=>{XY().then((t=>t.setupMode(YY)))}));var tX=Object.defineProperty,iX=Object.getOwnPropertyDescriptor,eX=Object.getOwnPropertyNames,sX=Object.prototype.hasOwnProperty,nX={};((t,i,e)=>{((t,i,e,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let n of eX(i))sX.call(t,n)||n===e||tX(t,n,{get:()=>i[n],enumerable:!(s=iX(i,n))||s.enumerable})})(t,i,"default")})(nX,dY);var rX=(t=>(t[t.None=0]="None",t[t.CommonJS=1]="CommonJS",t[t.AMD=2]="AMD",t[t.UMD=3]="UMD",t[t.System=4]="System",t[t.ES2015=5]="ES2015",t[t.ESNext=99]="ESNext",t))(rX||{}),oX=(t=>(t[t.None=0]="None",t[t.Preserve=1]="Preserve",t[t.React=2]="React",t[t.ReactNative=3]="ReactNative",t[t.ReactJSX=4]="ReactJSX",t[t.ReactJSXDev=5]="ReactJSXDev",t))(oX||{}),hX=(t=>(t[t.CarriageReturnLineFeed=0]="CarriageReturnLineFeed",t[t.LineFeed=1]="LineFeed",t))(hX||{}),cX=(t=>(t[t.ES3=0]="ES3",t[t.ES5=1]="ES5",t[t.ES2015=2]="ES2015",t[t.ES2016=3]="ES2016",t[t.ES2017=4]="ES2017",t[t.ES2018=5]="ES2018",t[t.ES2019=6]="ES2019",t[t.ES2020=7]="ES2020",t[t.ESNext=99]="ESNext",t[t.JSON=100]="JSON",t[t.Latest=99]="Latest",t))(cX||{}),lX=(t=>(t[t.Classic=1]="Classic",t[t.NodeJs=2]="NodeJs",t))(lX||{}),aX=class{constructor(t,i,e,s,n){this._onDidChange=new nX.Emitter,this._onDidExtraLibsChange=new nX.Emitter,this._extraLibs=Object.create(null),this._removedExtraLibs=Object.create(null),this._eagerModelSync=!1,this.setCompilerOptions(t),this.setDiagnosticsOptions(i),this.setWorkerOptions(e),this.setInlayHintsOptions(s),this.setModeConfiguration(n),this._onDidExtraLibsChangeTimeout=-1}get onDidChange(){return this._onDidChange.event}get onDidExtraLibsChange(){return this._onDidExtraLibsChange.event}get modeConfiguration(){return this._modeConfiguration}get workerOptions(){return this._workerOptions}get inlayHintsOptions(){return this._inlayHintsOptions}getExtraLibs(){return this._extraLibs}addExtraLib(t,i){let e;if(e=i===void 0?`ts:extralib-${Math.random().toString(36).substring(2,15)}`:i,this._extraLibs[e]&&this._extraLibs[e].content===t)return{dispose:()=>{}};let s=1;return this._removedExtraLibs[e]&&(s=this._removedExtraLibs[e]+1),this._extraLibs[e]&&(s=this._extraLibs[e].version+1),this._extraLibs[e]={content:t,version:s},this._fireOnDidExtraLibsChangeSoon(),{dispose:()=>{let t=this._extraLibs[e];t&&t.version===s&&(delete this._extraLibs[e],this._removedExtraLibs[e]=s,this._fireOnDidExtraLibsChangeSoon())}}}setExtraLibs(t){for(const t in this._extraLibs)this._removedExtraLibs[t]=this._extraLibs[t].version;if(this._extraLibs=Object.create(null),t&&t.length>0)for(const i of t){const t=i.filePath||`ts:extralib-${Math.random().toString(36).substring(2,15)}`,e=i.content;let s=1;this._removedExtraLibs[t]&&(s=this._removedExtraLibs[t]+1),this._extraLibs[t]={content:e,version:s}}this._fireOnDidExtraLibsChangeSoon()}_fireOnDidExtraLibsChangeSoon(){this._onDidExtraLibsChangeTimeout===-1&&(this._onDidExtraLibsChangeTimeout=window.setTimeout((()=>{this._onDidExtraLibsChangeTimeout=-1,this._onDidExtraLibsChange.fire(void 0)}),0))}getCompilerOptions(){return this._compilerOptions}setCompilerOptions(t){this._compilerOptions=t||Object.create(null),this._onDidChange.fire(void 0)}getDiagnosticsOptions(){return this._diagnosticsOptions}setDiagnosticsOptions(t){this._diagnosticsOptions=t||Object.create(null),this._onDidChange.fire(void 0)}setWorkerOptions(t){this._workerOptions=t||Object.create(null),this._onDidChange.fire(void 0)}setInlayHintsOptions(t){this._inlayHintsOptions=t||Object.create(null),this._onDidChange.fire(void 0)}setMaximumWorkerIdleTime(t){}setEagerModelSync(t){this._eagerModelSync=t}getEagerModelSync(){return this._eagerModelSync}setModeConfiguration(t){this._modeConfiguration=t||Object.create(null),this._onDidChange.fire(void 0)}},uX={completionItems:!0,hovers:!0,documentSymbols:!0,definitions:!0,references:!0,documentHighlights:!0,rename:!0,diagnostics:!0,documentRangeFormattingEdits:!0,signatureHelp:!0,onTypeFormattingEdits:!0,codeActions:!0,inlayHints:!0},dX=new aX({allowNonTsExtensions:!0,target:99},{noSemanticValidation:!1,noSyntaxValidation:!1,onlyVisible:!1},{},{},uX),fX=new aX({allowNonTsExtensions:!0,allowJs:!0,target:99},{noSemanticValidation:!0,noSyntaxValidation:!1,onlyVisible:!1},{},{},uX);function gX(){return import("./p-fcb12e05.js")}nX.languages.typescript={ModuleKind:rX,JsxEmit:oX,NewLineKind:hX,ScriptTarget:cX,ModuleResolutionKind:lX,typescriptVersion:"5.0.2",typescriptDefaults:dX,javascriptDefaults:fX,getTypeScriptWorker:()=>gX().then((t=>t.getTypeScriptWorker())),getJavaScriptWorker:()=>gX().then((t=>t.getJavaScriptWorker()))},nX.languages.onLanguage("typescript",(()=>gX().then((t=>t.setupTypeScript(dX))))),nX.languages.onLanguage("javascript",(()=>gX().then((t=>t.setupJavaScript(fX)))));class pX extends su{constructor(){super({id:"diffEditor.toggleShowMovedCodeBlocks",title:it(0,"Toggle Show Moved Code Blocks"),precondition:ua.has("isInDiffEditor")})}run(t,...i){const e=t.get(Md),s=!e.getValue("diffEditor.experimental.showMoves");e.updateValue("diffEditor.experimental.showMoves",s)}}class mX extends su{constructor(){super({id:"diffEditor.toggleUseInlineViewWhenSpaceIsLimited",title:it(0,"Toggle Use Inline View When Space Is Limited"),precondition:ua.has("isInDiffEditor")})}run(t,...i){const e=t.get(Md),s=!e.getValue("diffEditor.useInlineViewWhenSpaceIsLimited");e.updateValue("diffEditor.useInlineViewWhenSpaceIsLimited",s)}}const wX=it(0,"Diff Editor");class vX extends su{constructor(){super({id:"diffEditor.revert",title:it(0,"Revert"),f1:!1,category:wX})}run(t,i){var e;const s=function(t,i,e){return t.get(Pl).listDiffEditors().find((t=>{var s,n;const r=t.getModifiedEditor(),o=t.getOriginalEditor();return r&&((s=r.getModel())===null||s===void 0?void 0:s.uri.toString())===e.toString()&&o&&((n=o.getModel())===null||n===void 0?void 0:n.uri.toString())===i.toString()}))||null}(t,i.originalUri,i.modifiedUri);s instanceof OZ&&s.revertRangeMappings((e=i.mapping.innerChanges)!==null&&e!==void 0?e:[])}}const bX=it(0,"Accessible Diff Viewer");class yX extends su{constructor(){super({id:yX.id,title:it(0,"Go to Next Difference"),category:bX,precondition:ua.has("isInDiffEditor"),keybinding:{primary:65,weight:100},f1:!0})}run(t){const i=CX(t);i==null||i.accessibleDiffViewerNext()}}yX.id="editor.action.accessibleDiffViewer.next";class kX extends su{constructor(){super({id:kX.id,title:it(0,"Go to Previous Difference"),category:bX,precondition:ua.has("isInDiffEditor"),keybinding:{primary:1089,weight:100},f1:!0})}run(t){const i=CX(t);i==null||i.accessibleDiffViewerPrev()}}function CX(t){const i=t.get(Pl).listDiffEditors(),e=Lc();if(e){for(const t of i)if(SX(t.getContainerDomNode(),e))return t}return null}function SX(t,i){let e=i;for(;e;){if(e===t)return!0;e=e.parentElement}return!1}kX.id="editor.action.accessibleDiffViewer.prev",nu(class extends su{constructor(){super({id:"diffEditor.toggleCollapseUnchangedRegions",title:it(0,"Toggle Collapse Unchanged Regions"),icon:As.map,toggled:ua.has("config.diffEditor.hideUnchangedRegions.enabled"),precondition:ua.has("isInDiffEditor"),menu:{when:ua.has("isInDiffEditor"),id:Qa.EditorTitle,order:22,group:"navigation"}})}run(t,...i){const e=t.get(Md),s=!e.getValue("diffEditor.hideUnchangedRegions.enabled");e.updateValue("diffEditor.hideUnchangedRegions.enabled",s)}}),nu(pX),nu(mX),tu.appendMenuItem(Qa.EditorTitle,{command:{id:(new mX).desc.id,title:tt(0,"Use Inline View When Space Is Limited"),toggled:ua.has("config.diffEditor.useInlineViewWhenSpaceIsLimited"),precondition:ua.has("isInDiffEditor")},order:11,group:"1_diff",when:ua.and(Ox.diffEditorRenderSideBySideInlineBreakpointReached,ua.has("isInDiffEditor"))}),tu.appendMenuItem(Qa.EditorTitle,{command:{id:(new pX).desc.id,title:tt(0,"Show Moved Code Blocks"),icon:As.move,toggled:ma.create("config.diffEditor.experimental.showMoves",!0),precondition:ua.has("isInDiffEditor")},order:10,group:"1_diff",when:ua.has("isInDiffEditor")}),nu(vX);for(const t of[{icon:As.arrowRight,key:Ox.diffEditorInlineMode.toNegated()},{icon:As.discard,key:Ox.diffEditorInlineMode}])tu.appendMenuItem(Qa.DiffEditorHunkToolbar,{command:{id:(new vX).desc.id,title:tt(0,"Revert Block"),icon:t.icon},when:ua.and(Ox.diffEditorModifiedWritable,t.key),order:5,group:"primary"}),tu.appendMenuItem(Qa.DiffEditorSelectionToolbar,{command:{id:(new vX).desc.id,title:tt(0,"Revert Selection"),icon:t.icon},when:ua.and(Ox.diffEditorModifiedWritable,t.key),order:5,group:"primary"});nu(class extends vu{constructor(){super({id:"diffEditor.switchSide",title:it(0,"Switch Side"),icon:As.arrowSwap,precondition:ua.has("isInDiffEditor"),f1:!0,category:wX})}runEditorCommand(t,i,e){const s=CX(t);if(s instanceof OZ){if(e&&e.dryRun)return{destinationSelection:s.mapToOtherSide().destinationSelection};s.switchSide()}}}),nu(class extends vu{constructor(){super({id:"diffEditor.exitCompareMove",title:it(0,"Exit Compare Move"),icon:As.close,precondition:Ox.comparingMovedCode,f1:!1,category:wX,keybinding:{weight:1e4,primary:9}})}runEditorCommand(t,i,...e){const s=CX(t);s instanceof OZ&&s.exitCompareMove()}}),nu(class extends vu{constructor(){super({id:"diffEditor.collapseAllUnchangedRegions",title:it(0,"Collapse All Unchanged Regions"),icon:As.fold,precondition:ua.has("isInDiffEditor"),f1:!0,category:wX})}runEditorCommand(t,i,...e){const s=CX(t);s instanceof OZ&&s.collapseAllUnchangedRegions()}}),nu(class extends vu{constructor(){super({id:"diffEditor.showAllUnchangedRegions",title:it(0,"Show All Unchanged Regions"),icon:As.unfold,precondition:ua.has("isInDiffEditor"),f1:!0,category:wX})}runEditorCommand(t,i,...e){const s=CX(t);s instanceof OZ&&s.showAllUnchangedRegions()}}),tu.appendMenuItem(Qa.EditorTitle,{command:{id:yX.id,title:tt(0,"Open Accessible Diff Viewer"),precondition:ua.has("isInDiffEditor")},order:10,group:"2_diff",when:ua.and(Ox.accessibleDiffViewerVisible.negate(),ua.has("isInDiffEditor"))}),Gl.registerCommandAlias("editor.action.diffReview.next",yX.id),nu(yX),Gl.registerCommandAlias("editor.action.diffReview.prev",kX.id),nu(kX);var xX,DX=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},EX=function(t,i){return function(e,s){i(e,s,t)}};const AX=new Ta("selectionAnchorSet",!1);let MX=xX=class{static get(t){return t.getContribution(xX.ID)}constructor(t,i){this.editor=t,this.selectionAnchorSetContextKey=AX.bindTo(i),this.modelChangeListener=t.onDidChangeModel((()=>this.selectionAnchorSetContextKey.reset()))}setSelectionAnchor(){if(this.editor.hasModel()){const t=this.editor.getPosition();this.editor.changeDecorations((i=>{this.decorationId&&i.removeDecoration(this.decorationId),this.decorationId=i.addDecoration(Ss.fromPositions(t,t),{description:"selection-anchor",stickiness:1,hoverMessage:(new F_).appendText(tt(0,"Selection Anchor")),className:"selection-anchor"})})),this.selectionAnchorSetContextKey.set(!!this.decorationId),rw(tt(0,"Anchor set at {0}:{1}",t.lineNumber,t.column))}}goToSelectionAnchor(){if(this.editor.hasModel()&&this.decorationId){const t=this.editor.getModel().getDecorationRange(this.decorationId);t&&this.editor.setPosition(t.getStartPosition())}}selectFromAnchorToCursor(){if(this.editor.hasModel()&&this.decorationId){const t=this.editor.getModel().getDecorationRange(this.decorationId);if(t){const i=this.editor.getPosition();this.editor.setSelection(Ss.fromPositions(t.getStartPosition(),i)),this.cancelSelectionAnchor()}}}cancelSelectionAnchor(){if(this.decorationId){const t=this.decorationId;this.editor.changeDecorations((i=>{i.removeDecoration(t),this.decorationId=void 0})),this.selectionAnchorSetContextKey.set(!1)}}dispose(){this.cancelSelectionAnchor(),this.modelChangeListener.dispose()}};MX.ID="editor.contrib.selectionAnchorController",MX=xX=DX([EX(1,Ra)],MX);Su(MX.ID,MX,4),ku(class extends mu{constructor(){super({id:"editor.action.setSelectionAnchor",label:tt(0,"Set Selection Anchor"),alias:"Set Selection Anchor",precondition:void 0,kbOpts:{kbExpr:Ox.editorTextFocus,primary:Fe(2089,2080),weight:100}})}async run(t,i){var e;(e=MX.get(i))===null||e===void 0||e.setSelectionAnchor()}}),ku(class extends mu{constructor(){super({id:"editor.action.goToSelectionAnchor",label:tt(0,"Go to Selection Anchor"),alias:"Go to Selection Anchor",precondition:AX})}async run(t,i){var e;(e=MX.get(i))===null||e===void 0||e.goToSelectionAnchor()}}),ku(class extends mu{constructor(){super({id:"editor.action.selectFromAnchorToCursor",label:tt(0,"Select from Anchor to Cursor"),alias:"Select from Anchor to Cursor",precondition:AX,kbOpts:{kbExpr:Ox.editorTextFocus,primary:Fe(2089,2089),weight:100}})}async run(t,i){var e;(e=MX.get(i))===null||e===void 0||e.selectFromAnchorToCursor()}}),ku(class extends mu{constructor(){super({id:"editor.action.cancelSelectionAnchor",label:tt(0,"Cancel Selection Anchor"),alias:"Cancel Selection Anchor",precondition:AX,kbOpts:{kbExpr:Ox.editorTextFocus,primary:9,weight:100}})}async run(t,i){var e;(e=MX.get(i))===null||e===void 0||e.cancelSelectionAnchor()}});const LX=Iw("editorOverviewRuler.bracketMatchForeground",{dark:"#A0A0A0",light:"#A0A0A0",hcDark:"#A0A0A0",hcLight:"#A0A0A0"},tt(0,"Overview ruler marker color for matching brackets."));class FX{constructor(t,i,e){this.position=t,this.brackets=i,this.options=e}}class TX extends Qi{static get(t){return t.getContribution(TX.ID)}constructor(t){super(),this._editor=t,this._lastBracketsData=[],this._lastVersionId=0,this._decorations=this._editor.createDecorationsCollection(),this._updateBracketsSoon=this._register(new Co((()=>this._updateBrackets()),50)),this._matchBrackets=this._editor.getOption(72),this._updateBracketsSoon.schedule(),this._register(t.onDidChangeCursorPosition((t=>{this._matchBrackets!=="never"&&this._updateBracketsSoon.schedule()}))),this._register(t.onDidChangeModelContent((t=>{this._updateBracketsSoon.schedule()}))),this._register(t.onDidChangeModel((t=>{this._lastBracketsData=[],this._updateBracketsSoon.schedule()}))),this._register(t.onDidChangeModelLanguageConfiguration((t=>{this._lastBracketsData=[],this._updateBracketsSoon.schedule()}))),this._register(t.onDidChangeConfiguration((t=>{t.hasChanged(72)&&(this._matchBrackets=this._editor.getOption(72),this._decorations.clear(),this._lastBracketsData=[],this._lastVersionId=0,this._updateBracketsSoon.schedule())}))),this._register(t.onDidBlurEditorWidget((()=>{this._updateBracketsSoon.schedule()}))),this._register(t.onDidFocusEditorWidget((()=>{this._updateBracketsSoon.schedule()})))}jumpToBracket(){if(!this._editor.hasModel())return;const t=this._editor.getModel(),i=this._editor.getSelections().map((i=>{const e=i.getStartPosition(),s=t.bracketPairs.matchBracket(e);let n=null;if(s)s[0].containsPosition(e)&&!s[1].containsPosition(e)?n=s[1].getStartPosition():s[1].containsPosition(e)&&(n=s[0].getStartPosition());else{const i=t.bracketPairs.findEnclosingBrackets(e);if(i)n=i[1].getStartPosition();else{const i=t.bracketPairs.findNextBracket(e);i&&i.range&&(n=i.range.getStartPosition())}}return n?new Ss(n.lineNumber,n.column,n.lineNumber,n.column):new Ss(e.lineNumber,e.column,e.lineNumber,e.column)}));this._editor.setSelections(i),this._editor.revealRange(i[0])}selectToBracket(t){if(!this._editor.hasModel())return;const i=this._editor.getModel(),e=[];this._editor.getSelections().forEach((s=>{const n=s.getStartPosition();let r=i.bracketPairs.matchBracket(n);if(!r&&(r=i.bracketPairs.findEnclosingBrackets(n),!r)){const t=i.bracketPairs.findNextBracket(n);t&&t.range&&(r=i.bracketPairs.matchBracket(t.range.getStartPosition()))}let o=null,h=null;if(r){r.sort(Cs.compareRangesUsingStarts);const[i,e]=r;if(o=t?i.getStartPosition():i.getEndPosition(),h=t?e.getEndPosition():e.getStartPosition(),e.containsPosition(n)){const t=o;o=h,h=t}}o&&h&&e.push(new Ss(o.lineNumber,o.column,h.lineNumber,h.column))})),e.length>0&&(this._editor.setSelections(e),this._editor.revealRange(e[0]))}removeBrackets(t){if(!this._editor.hasModel())return;const i=this._editor.getModel();this._editor.getSelections().forEach((e=>{const s=e.getPosition();let n=i.bracketPairs.matchBracket(s);n||(n=i.bracketPairs.findEnclosingBrackets(s)),n&&(this._editor.pushUndoStop(),this._editor.executeEdits(t,[{range:n[0],text:""},{range:n[1],text:""}]),this._editor.pushUndoStop())}))}_updateBrackets(){if(this._matchBrackets==="never")return;this._recomputeBrackets();const t=[];let i=0;for(const e of this._lastBracketsData){const s=e.brackets;s&&(t[i++]={range:s[0],options:e.options},t[i++]={range:s[1],options:e.options})}this._decorations.set(t)}_recomputeBrackets(){if(!this._editor.hasModel()||!this._editor.hasWidgetFocus())return this._lastBracketsData=[],void(this._lastVersionId=0);const t=this._editor.getSelections();if(t.length>100)return this._lastBracketsData=[],void(this._lastVersionId=0);const i=this._editor.getModel(),e=i.getVersionId();let s=[];this._lastVersionId===e&&(s=this._lastBracketsData);const n=[];let r=0;for(let i=0,e=t.length;i<e;i++){const e=t[i];e.isEmpty()&&(n[r++]=e.getStartPosition())}n.length>1&&n.sort(ks.compare);const o=[];let h=0,c=0;const l=s.length;for(let t=0,e=n.length;t<e;t++){const e=n[t];for(;c<l&&s[c].position.isBefore(e);)c++;if(c<l&&s[c].position.equals(e))o[h++]=s[c];else{let t=i.bracketPairs.matchBracket(e,20),s=TX._DECORATION_OPTIONS_WITH_OVERVIEW_RULER;t||this._matchBrackets!=="always"||(t=i.bracketPairs.findEnclosingBrackets(e,20),s=TX._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER),o[h++]=new FX(e,t,s)}}this._lastBracketsData=o,this._lastVersionId=e}}TX.ID="editor.contrib.bracketMatchingController",TX._DECORATION_OPTIONS_WITH_OVERVIEW_RULER=xF.register({description:"bracket-match-overview",stickiness:1,className:"bracket-match",overviewRuler:{color:MC(LX),position:Yf.Center}}),TX._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER=xF.register({description:"bracket-match-no-overview",stickiness:1,className:"bracket-match"}),Su(TX.ID,TX,1),ku(class extends mu{constructor(){super({id:"editor.action.selectToBracket",label:tt(0,"Select to Bracket"),alias:"Select to Bracket",precondition:void 0,metadata:{description:it(0,"Select the text inside and including the brackets or curly braces"),args:[{name:"args",schema:{type:"object",properties:{selectBrackets:{type:"boolean",default:!0}}}}]}})}run(t,i,e){var s;let n=!0;e&&e.selectBrackets===!1&&(n=!1),(s=TX.get(i))===null||s===void 0||s.selectToBracket(n)}}),ku(class extends mu{constructor(){super({id:"editor.action.jumpToBracket",label:tt(0,"Go to Bracket"),alias:"Go to Bracket",precondition:void 0,kbOpts:{kbExpr:Ox.editorTextFocus,primary:3165,weight:100}})}run(t,i){var e;(e=TX.get(i))===null||e===void 0||e.jumpToBracket()}}),ku(class extends mu{constructor(){super({id:"editor.action.removeBrackets",label:tt(0,"Remove Brackets"),alias:"Remove Brackets",precondition:void 0,kbOpts:{kbExpr:Ox.editorTextFocus,primary:2561,weight:100}})}run(t,i){var e;(e=TX.get(i))===null||e===void 0||e.removeBrackets(this.id)}}),tu.appendMenuItem(Qa.MenubarGoMenu,{group:"5_infile_nav",command:{id:"editor.action.jumpToBracket",title:tt(0,"Go to &&Bracket")},order:2});class RX{constructor(t,i){this._selection=t,this._isMovingLeft=i}getEditOperations(t,i){if(this._selection.startLineNumber!==this._selection.endLineNumber||this._selection.isEmpty())return;const e=this._selection.startLineNumber,s=this._selection.startColumn,n=this._selection.endColumn;if((!this._isMovingLeft||s!==1)&&(this._isMovingLeft||n!==t.getLineMaxColumn(e)))if(this._isMovingLeft){const r=new Cs(e,s-1,e,s),o=t.getValueInRange(r);i.addEditOperation(r,null),i.addEditOperation(new Cs(e,n,e,n),o)}else{const r=new Cs(e,n,e,n+1),o=t.getValueInRange(r);i.addEditOperation(r,null),i.addEditOperation(new Cs(e,s,e,s),o)}}computeCursorState(t,i){return this._isMovingLeft?new Ss(this._selection.startLineNumber,this._selection.startColumn-1,this._selection.endLineNumber,this._selection.endColumn-1):new Ss(this._selection.startLineNumber,this._selection.startColumn+1,this._selection.endLineNumber,this._selection.endColumn+1)}}class OX extends mu{constructor(t,i){super(i),this.left=t}run(t,i){if(!i.hasModel())return;const e=[],s=i.getSelections();for(const t of s)e.push(new RX(t,this.left));i.pushUndoStop(),i.executeCommands(this.id,e),i.pushUndoStop()}}ku(class extends OX{constructor(){super(!0,{id:"editor.action.moveCarretLeftAction",label:tt(0,"Move Selected Text Left"),alias:"Move Selected Text Left",precondition:Ox.writable})}}),ku(class extends OX{constructor(){super(!1,{id:"editor.action.moveCarretRightAction",label:tt(0,"Move Selected Text Right"),alias:"Move Selected Text Right",precondition:Ox.writable})}});ku(class extends mu{constructor(){super({id:"editor.action.transposeLetters",label:tt(0,"Transpose Letters"),alias:"Transpose Letters",precondition:Ox.writable,kbOpts:{kbExpr:Ox.textInputFocus,primary:0,mac:{primary:306},weight:100}})}run(t,i){if(!i.hasModel())return;const e=i.getModel(),s=[],n=i.getSelections();for(const t of n){if(!t.isEmpty())continue;const i=t.startLineNumber,n=t.startColumn,r=e.getLineMaxColumn(i);if(i===1&&(n===1||n===2&&r===2))continue;const o=n===r?t.getPosition():hx.rightPosition(e,t.getPosition().lineNumber,t.getPosition().column),h=hx.leftPosition(e,o),c=hx.leftPosition(e,h),l=e.getValueInRange(Cs.fromPositions(c,h)),a=e.getValueInRange(Cs.fromPositions(h,o)),u=Cs.fromPositions(c,o);s.push(new ix(u,a+l))}s.length>0&&(i.pushUndoStop(),i.executeCommands(this.id,s),i.pushUndoStop())}});const IX=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let t;t=typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?crypto.getRandomValues.bind(crypto):function(t){for(let i=0;i<t.length;i++)t[i]=Math.floor(256*Math.random());return t};const i=new Uint8Array(16),e=[];for(let t=0;t<256;t++)e.push(t.toString(16).padStart(2,"0"));return function(){t(i),i[6]=15&i[6]|64,i[8]=63&i[8]|128;let s=0,n="";return n+=e[i[s++]],n+=e[i[s++]],n+=e[i[s++]],n+=e[i[s++]],n+="-",n+=e[i[s++]],n+=e[i[s++]],n+="-",n+=e[i[s++]],n+=e[i[s++]],n+="-",n+=e[i[s++]],n+=e[i[s++]],n+="-",n+=e[i[s++]],n+=e[i[s++]],n+=e[i[s++]],n+=e[i[s++]],n+=e[i[s++]],n+=e[i[s++]],n}}();function _X(t){return{asString:async()=>t,asFile:()=>{},value:typeof t=="string"?t:void 0}}class PX{constructor(){this._entries=new Map}get size(){let t=0;for(const i of this._entries)t++;return t}has(t){return this._entries.has(this.toKey(t))}matches(t){const i=[...this._entries.keys()];return Wt.some(this,(([t,i])=>i.asFile()))&&i.push("files"),$X(NX(t),i)}get(t){var i;return(i=this._entries.get(this.toKey(t)))===null||i===void 0?void 0:i[0]}append(t,i){const e=this._entries.get(t);e?e.push(i):this._entries.set(this.toKey(t),[i])}replace(t,i){this._entries.set(this.toKey(t),[i])}delete(t){this._entries.delete(this.toKey(t))}*[Symbol.iterator](){for(const[t,i]of this._entries)for(const e of i)yield[t,e]}toKey(t){return NX(t)}}function NX(t){return t.toLowerCase()}function BX(t,i){return $X(NX(t),i.map(NX))}function $X(t,i){if(t==="*/*")return i.length>0;if(i.includes(t))return!0;const e=t.match(/^([a-z]+)\/([a-z]+|\*)$/i);if(!e)return!1;const[s,n,r]=e;return r==="*"&&i.some((t=>t.startsWith(n+"/")))}const WX=Object.freeze({create:t=>g(t.map((t=>t.toString()))).join(`\r\n`),split:t=>t.split(`\r\n`),parse:t=>WX.split(t).filter((t=>!t.startsWith("#")))});class jX{constructor(t){this.value=t}equals(t){return this.value===t.value}contains(t){return this.equals(t)||this.value===""||t.value.startsWith(this.value+jX.sep)}intersects(t){return this.contains(t)||t.contains(this)}append(...t){return new jX((this.value?[this.value,...t]:t).join(jX.sep))}}jX.sep=".",jX.None=new jX("@@none@@"),jX.Empty=new jX("");const HX="CodeEditors",VX="CodeFiles";Va.add("workbench.contributions.dragAndDrop",new class{});class zX{constructor(){}static getInstance(){return zX.INSTANCE}hasData(t){return t&&t===this.proto}getData(t){if(this.hasData(t))return this.data}}function UX(t){const i=new PX;for(const e of t.items){const t=e.type;if(e.kind==="string"){const s=new Promise((t=>e.getAsString(t)));i.append(t,_X(s))}else if(e.kind==="file"){const s=e.getAsFile();s&&i.append(t,KX(s))}}return i}function KX(t){const i=t.path?as.parse(t.path):void 0;return function(t,i,e){const s={id:IX(),name:t,uri:i,data:e};return{asString:async()=>"",asFile:()=>s,value:void 0}}(t.name,i,(async()=>new Uint8Array(await t.arrayBuffer())))}zX.INSTANCE=new zX;const qX=Object.freeze([HX,VX,iB.RESOURCES,iB.INTERNAL_URI_LIST]);function GX(t,i=!1){const e=UX(t),s=e.get(iB.INTERNAL_URI_LIST);if(s)e.replace($d.uriList,s);else if(i||!e.has($d.uriList)){const i=[];for(const e of t.items){const t=e.getAsFile();if(t){const e=t.path;try{e?i.push(as.file(e).toString()):i.push(as.parse(t.name,!0).toString())}catch{}}}i.length&&e.replace($d.uriList,_X(WX.create(i)))}for(const t of qX)e.delete(t);return e}var ZX=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},JX=function(t,i){return function(e,s){i(e,s,t)}};class QX{async provideDocumentPasteEdits(t,i,e,s,n){const r=await this.getEdit(e,n);if(r)return{dispose(){},edits:[{insertText:r.insertText,title:r.title,kind:r.kind,handledMimeType:r.handledMimeType,yieldTo:r.yieldTo}]}}async provideDocumentOnDropEdits(t,i,e,s){const n=await this.getEdit(e,s);return n?[{insertText:n.insertText,title:n.title,kind:n.kind,handledMimeType:n.handledMimeType,yieldTo:n.yieldTo}]:void 0}}class YX extends QX{constructor(){super(...arguments),this.kind=YX.kind,this.dropMimeTypes=[$d.text],this.pasteMimeTypes=[$d.text]}async getEdit(t,i){const e=t.get($d.text);if(!e||t.has($d.uriList))return;const s=await e.asString();return{handledMimeType:$d.text,title:tt(0,"Insert Plain Text"),insertText:s,kind:this.kind}}}YX.id="text",YX.kind=new jX("text.plain");class XX extends QX{constructor(){super(...arguments),this.kind=new jX("uri.absolute"),this.dropMimeTypes=[$d.uriList],this.pasteMimeTypes=[$d.uriList]}async getEdit(t,i){const e=await e0(t);if(!e.length||i.isCancellationRequested)return;let s=0;const n=e.map((({uri:t,originalText:i})=>t.scheme===Lh.file?t.fsPath:(s++,i))).join(" ");let r;return r=s>0?e.length>1?tt(0,"Insert Uris"):tt(0,"Insert Uri"):e.length>1?tt(0,"Insert Paths"):tt(0,"Insert Path"),{handledMimeType:$d.uriList,insertText:n,title:r,kind:this.kind}}}let t0=class extends QX{constructor(t){super(),this._workspaceContextService=t,this.kind=new jX("uri.relative"),this.dropMimeTypes=[$d.uriList],this.pasteMimeTypes=[$d.uriList]}async getEdit(t,i){const e=await e0(t);if(!e.length||i.isCancellationRequested)return;const s=a(e.map((({uri:t})=>{const i=this._workspaceContextService.getWorkspaceFolder(t);return i?MM(i.uri,t):void 0})));return s.length?{handledMimeType:$d.uriList,insertText:s.join(" "),title:e.length>1?tt(0,"Insert Relative Paths"):tt(0,"Insert Relative Path"),kind:this.kind}:void 0}};t0=ZX([JX(0,AN)],t0);class i0{constructor(){this.kind=new jX("html"),this.pasteMimeTypes=["text/html"],this._yieldTo=[{mimeType:$d.text}]}async provideDocumentPasteEdits(t,i,e,s,n){var r;if(s.triggerKind!==Is.PasteAs&&!(!((r=s.only)===null||r===void 0)&&r.contains(this.kind)))return;const o=e.get("text/html"),h=await(o==null?void 0:o.asString());return h&&!n.isCancellationRequested?{dispose(){},edits:[{insertText:h,yieldTo:this._yieldTo,title:tt(0,"Insert HTML"),kind:this.kind}]}:void 0}}async function e0(t){const i=t.get($d.uriList);if(!i)return[];const e=await i.asString(),s=[];for(const t of WX.parse(e))try{s.push({uri:as.parse(t),originalText:t})}catch{}return s}let s0=class extends Qi{constructor(t,i){super(),this._register(t.documentOnDropEditProvider.register("*",new YX)),this._register(t.documentOnDropEditProvider.register("*",new XX)),this._register(t.documentOnDropEditProvider.register("*",new t0(i)))}};s0=ZX([JX(0,$p),JX(1,AN)],s0);let n0=class extends Qi{constructor(t,i){super(),this._register(t.documentPasteEditProvider.register("*",new YX)),this._register(t.documentPasteEditProvider.register("*",new XX)),this._register(t.documentPasteEditProvider.register("*",new t0(i))),this._register(t.documentPasteEditProvider.register("*",new i0))}};n0=ZX([JX(0,$p),JX(1,AN)],n0);class r0{constructor(){this.value="",this.pos=0}static isDigitCharacter(t){return t>=48&&t<=57}static isVariableCharacter(t){return t===95||t>=97&&t<=122||t>=65&&t<=90}text(t){this.value=t,this.pos=0}tokenText(t){return this.value.substr(t.pos,t.len)}next(){if(this.pos>=this.value.length)return{type:14,pos:this.pos,len:0};const t=this.pos;let i,e=0,s=this.value.charCodeAt(t);if(i=r0._table[s],typeof i=="number")return this.pos+=1,{type:i,pos:t,len:1};if(r0.isDigitCharacter(s)){i=8;do{e+=1,s=this.value.charCodeAt(t+e)}while(r0.isDigitCharacter(s));return this.pos+=e,{type:i,pos:t,len:e}}if(r0.isVariableCharacter(s)){i=9;do{s=this.value.charCodeAt(t+ ++e)}while(r0.isVariableCharacter(s)||r0.isDigitCharacter(s));return this.pos+=e,{type:i,pos:t,len:e}}i=10;do{e+=1,s=this.value.charCodeAt(t+e)}while(!isNaN(s)&&r0._table[s]===void 0&&!r0.isDigitCharacter(s)&&!r0.isVariableCharacter(s));return this.pos+=e,{type:i,pos:t,len:e}}}r0._table={36:0,58:1,44:2,123:3,125:4,92:5,47:6,124:7,43:11,45:12,63:13};class o0{constructor(){this._children=[]}appendChild(t){return t instanceof h0&&this._children[this._children.length-1]instanceof h0?this._children[this._children.length-1].value+=t.value:(t.parent=this,this._children.push(t)),this}replace(t,i){const{parent:e}=t,s=e.children.indexOf(t),n=e.children.slice(0);n.splice(s,1,...i),e._children=n,function t(i,e){for(const s of i)s.parent=e,t(s.children,s)}(i,e)}get children(){return this._children}get rightMostDescendant(){return this._children.length>0?this._children[this._children.length-1].rightMostDescendant:this}get snippet(){let t=this;for(;;){if(!t)return;if(t instanceof p0)return t;t=t.parent}}toString(){return this.children.reduce(((t,i)=>t+i.toString()),"")}len(){return 0}}class h0 extends o0{constructor(t){super(),this.value=t}toString(){return this.value}len(){return this.value.length}clone(){return new h0(this.value)}}class c0 extends o0{}class l0 extends c0{static compareByIndex(t,i){return t.index===i.index?0:t.isFinalTabstop?1:i.isFinalTabstop||t.index<i.index?-1:t.index>i.index?1:0}constructor(t){super(),this.index=t}get isFinalTabstop(){return this.index===0}get choice(){return this._children.length===1&&this._children[0]instanceof a0?this._children[0]:void 0}clone(){const t=new l0(this.index);return this.transform&&(t.transform=this.transform.clone()),t._children=this.children.map((t=>t.clone())),t}}class a0 extends o0{constructor(){super(...arguments),this.options=[]}appendChild(t){return t instanceof h0&&(t.parent=this,this.options.push(t)),this}toString(){return this.options[0].value}len(){return this.options[0].len()}clone(){const t=new a0;return this.options.forEach(t.appendChild,t),t}}class u0 extends o0{constructor(){super(...arguments),this.regexp=new RegExp("")}resolve(t){const i=this;let e=!1,s=t.replace(this.regexp,(function(){return e=!0,i._replace(Array.prototype.slice.call(arguments,0,-2))}));return!e&&this._children.some((t=>t instanceof d0&&!!t.elseValue))&&(s=this._replace([])),s}_replace(t){let i="";for(const e of this._children)if(e instanceof d0){let s=t[e.index]||"";s=e.resolve(s),i+=s}else i+=e.toString();return i}toString(){return""}clone(){const t=new u0;return t.regexp=new RegExp(this.regexp.source,(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")),t._children=this.children.map((t=>t.clone())),t}}class d0 extends o0{constructor(t,i,e,s){super(),this.index=t,this.shorthandName=i,this.ifValue=e,this.elseValue=s}resolve(t){return this.shorthandName==="upcase"?t?t.toLocaleUpperCase():"":this.shorthandName==="downcase"?t?t.toLocaleLowerCase():"":this.shorthandName==="capitalize"?t?t[0].toLocaleUpperCase()+t.substr(1):"":this.shorthandName==="pascalcase"?t?this._toPascalCase(t):"":this.shorthandName==="camelcase"?t?this._toCamelCase(t):"":t&&typeof this.ifValue=="string"?this.ifValue:t||typeof this.elseValue!="string"?t||"":this.elseValue}_toPascalCase(t){const i=t.match(/[a-z0-9]+/gi);return i?i.map((t=>t.charAt(0).toUpperCase()+t.substr(1))).join(""):t}_toCamelCase(t){const i=t.match(/[a-z0-9]+/gi);return i?i.map(((t,i)=>i===0?t.charAt(0).toLowerCase()+t.substr(1):t.charAt(0).toUpperCase()+t.substr(1))).join(""):t}clone(){return new d0(this.index,this.shorthandName,this.ifValue,this.elseValue)}}class f0 extends c0{constructor(t){super(),this.name=t}resolve(t){let i=t.resolve(this);return this.transform&&(i=this.transform.resolve(i||"")),i!==void 0&&(this._children=[new h0(i)],!0)}clone(){const t=new f0(this.name);return this.transform&&(t.transform=this.transform.clone()),t._children=this.children.map((t=>t.clone())),t}}function g0(t,i){const e=[...t];for(;e.length>0;){const t=e.shift();if(!i(t))break;e.unshift(...t.children)}}class p0 extends o0{get placeholderInfo(){if(!this._placeholders){const t=[];let i;this.walk((function(e){return e instanceof l0&&(t.push(e),i=!i||i.index<e.index?e:i),!0})),this._placeholders={all:t,last:i}}return this._placeholders}get placeholders(){const{all:t}=this.placeholderInfo;return t}offset(t){let i=0,e=!1;return this.walk((s=>s===t?(e=!0,!1):(i+=s.len(),!0))),e?i:-1}fullLen(t){let i=0;return g0([t],(t=>(i+=t.len(),!0))),i}enclosingPlaceholders(t){const i=[];let{parent:e}=t;for(;e;)e instanceof l0&&i.push(e),e=e.parent;return i}resolveVariables(t){return this.walk((i=>(i instanceof f0&&i.resolve(t)&&(this._placeholders=void 0),!0))),this}appendChild(t){return this._placeholders=void 0,super.appendChild(t)}replace(t,i){return this._placeholders=void 0,super.replace(t,i)}clone(){const t=new p0;return this._children=this.children.map((t=>t.clone())),t}walk(t){g0(this.children,t)}}class m0{constructor(){this._scanner=new r0,this._token={type:14,pos:0,len:0}}static escape(t){return t.replace(/\$|}|\\/g,"\\$&")}static guessNeedsClipboard(t){return/\${?CLIPBOARD/.test(t)}parse(t,i,e){const s=new p0;return this.parseFragment(t,s),this.ensureFinalTabstop(s,e!=null&&e,i!=null&&i),s}parseFragment(t,i){const e=i.children.length;for(this._scanner.text(t),this._token=this._scanner.next();this._parse(i););const s=new Map,n=[];i.walk((t=>(t instanceof l0&&(t.isFinalTabstop?s.set(0,void 0):!s.has(t.index)&&t.children.length>0?s.set(t.index,t.children):n.push(t)),!0)));const r=(t,e)=>{const n=s.get(t.index);if(!n)return;const o=new l0(t.index);o.transform=t.transform;for(const t of n){const i=t.clone();o.appendChild(i),i instanceof l0&&s.has(i.index)&&!e.has(i.index)&&(e.add(i.index),r(i,e),e.delete(i.index))}i.replace(t,[o])},o=new Set;for(const t of n)r(t,o);return i.children.slice(e)}ensureFinalTabstop(t,i,e){(i||e&&t.placeholders.length>0)&&(t.placeholders.find((t=>t.index===0))||t.appendChild(new l0(0)))}_accept(t,i){if(t===void 0||this._token.type===t){const t=!i||this._scanner.tokenText(this._token);return this._token=this._scanner.next(),t}return!1}_backTo(t){return this._scanner.pos=t.pos+t.len,this._token=t,!1}_until(t){const i=this._token;for(;this._token.type!==t;){if(this._token.type===14)return!1;if(this._token.type===5){const t=this._scanner.next();if(t.type!==0&&t.type!==4&&t.type!==5)return!1}this._token=this._scanner.next()}const e=this._scanner.value.substring(i.pos,this._token.pos).replace(/\\(\$|}|\\)/g,"$1");return this._token=this._scanner.next(),e}_parse(t){return this._parseEscaped(t)||this._parseTabstopOrVariableName(t)||this._parseComplexPlaceholder(t)||this._parseComplexVariable(t)||this._parseAnything(t)}_parseEscaped(t){let i;return!!(i=this._accept(5,!0))&&(i=this._accept(0,!0)||this._accept(4,!0)||this._accept(5,!0)||i,t.appendChild(new h0(i)),!0)}_parseTabstopOrVariableName(t){let i;const e=this._token;return this._accept(0)&&(i=this._accept(9,!0)||this._accept(8,!0))?(t.appendChild(/^\d+$/.test(i)?new l0(Number(i)):new f0(i)),!0):this._backTo(e)}_parseComplexPlaceholder(t){let i;const e=this._token;if(!(this._accept(0)&&this._accept(3)&&(i=this._accept(8,!0))))return this._backTo(e);const s=new l0(Number(i));if(this._accept(1))for(;;){if(this._accept(4))return t.appendChild(s),!0;if(!this._parse(s))return t.appendChild(new h0("${"+i+":")),s.children.forEach(t.appendChild,t),!0}else{if(!(s.index>0&&this._accept(7)))return this._accept(6)?this._parseTransform(s)?(t.appendChild(s),!0):(this._backTo(e),!1):this._accept(4)?(t.appendChild(s),!0):this._backTo(e);{const i=new a0;for(;;){if(this._parseChoiceElement(i)){if(this._accept(2))continue;if(this._accept(7)&&(s.appendChild(i),this._accept(4)))return t.appendChild(s),!0}return this._backTo(e),!1}}}}_parseChoiceElement(t){const i=this._token,e=[];for(;this._token.type!==2&&this._token.type!==7;){let t;if(t=(t=this._accept(5,!0))?this._accept(2,!0)||this._accept(7,!0)||this._accept(5,!0)||t:this._accept(void 0,!0),!t)return this._backTo(i),!1;e.push(t)}return e.length===0?(this._backTo(i),!1):(t.appendChild(new h0(e.join(""))),!0)}_parseComplexVariable(t){let i;const e=this._token;if(!(this._accept(0)&&this._accept(3)&&(i=this._accept(9,!0))))return this._backTo(e);const s=new f0(i);if(!this._accept(1))return this._accept(6)?this._parseTransform(s)?(t.appendChild(s),!0):(this._backTo(e),!1):this._accept(4)?(t.appendChild(s),!0):this._backTo(e);for(;;){if(this._accept(4))return t.appendChild(s),!0;if(!this._parse(s))return t.appendChild(new h0("${"+i+":")),s.children.forEach(t.appendChild,t),!0}}_parseTransform(t){const i=new u0;let e="",s="";for(;!this._accept(6);){let t;if(t=this._accept(5,!0))t=this._accept(6,!0)||t,e+=t;else{if(this._token.type===14)return!1;e+=this._accept(void 0,!0)}}for(;!this._accept(6);){let t;if(t=this._accept(5,!0))t=this._accept(5,!0)||this._accept(6,!0)||t,i.appendChild(new h0(t));else if(!this._parseFormatString(i)&&!this._parseAnything(i))return!1}for(;!this._accept(4);){if(this._token.type===14)return!1;s+=this._accept(void 0,!0)}try{i.regexp=new RegExp(e,s)}catch{return!1}return t.transform=i,!0}_parseFormatString(t){const i=this._token;if(!this._accept(0))return!1;let e=!1;this._accept(3)&&(e=!0);const s=this._accept(8,!0);if(!s)return this._backTo(i),!1;if(!e)return t.appendChild(new d0(Number(s))),!0;if(this._accept(4))return t.appendChild(new d0(Number(s))),!0;if(!this._accept(1))return this._backTo(i),!1;if(this._accept(6)){const e=this._accept(9,!0);return e&&this._accept(4)?(t.appendChild(new d0(Number(s),e)),!0):(this._backTo(i),!1)}if(this._accept(11)){const i=this._until(4);if(i)return t.appendChild(new d0(Number(s),void 0,i,void 0)),!0}else if(this._accept(12)){const i=this._until(4);if(i)return t.appendChild(new d0(Number(s),void 0,void 0,i)),!0}else if(this._accept(13)){const i=this._until(1);if(i){const e=this._until(4);if(e)return t.appendChild(new d0(Number(s),void 0,i,e)),!0}}else{const i=this._until(4);if(i)return t.appendChild(new d0(Number(s),void 0,void 0,i)),!0}return this._backTo(i),!1}_parseAnything(t){return this._token.type!==14&&(t.appendChild(new h0(this._scanner.tokenText(this._token))),this._accept(void 0),!0)}}function w0(t,i,e){var s,n,r,o;return(typeof e.insertText=="string"?e.insertText==="":e.insertText.snippet==="")?{edits:(n=(s=e.additionalEdit)===null||s===void 0?void 0:s.edits)!==null&&n!==void 0?n:[]}:{edits:[...i.map((i=>new BP(t,{range:i,text:typeof e.insertText=="string"?m0.escape(e.insertText)+"$0":e.insertText.snippet,insertAsSnippet:!0}))),...(o=(r=e.additionalEdit)===null||r===void 0?void 0:r.edits)!==null&&o!==void 0?o:[]]}}function v0(t){var i;function e(t,i){return"mimeType"in t?t.mimeType===i.handledMimeType:!!i.kind&&t.kind.contains(i.kind)}const s=new Map;for(const n of t)for(const r of(i=n.yieldTo)!==null&&i!==void 0?i:[])for(const i of t)if(i!==n&&e(r,i)){let t=s.get(n);t||(t=[],s.set(n,t)),t.push(i)}if(!s.size)return Array.from(t);const n=new Set,r=[];return function t(i){if(!i.length)return[];const e=i[0];if(r.includes(e))return console.warn("Yield to cycle detected",e),i;if(n.has(e))return t(i.slice(1));let o=[];const h=s.get(e);return h&&(r.push(e),o=t(h),r.pop()),n.add(e),[...o,e,...t(i.slice(1))]}(Array.from(t))}var b0=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},y0=function(t,i){return function(e,s){i(e,s,t)}};const k0=xF.register({description:"inline-progress-widget",stickiness:1,showIfCollapsed:!0,after:{content:" ",inlineClassName:"inline-editor-progress-decoration",inlineClassNameAffectsLetterSpacing:!0}});class C0 extends Qi{constructor(t,i,e,s,n){super(),this.typeId=t,this.editor=i,this.range=e,this.delegate=n,this.allowEditorOverflow=!1,this.suppressMouseDown=!0,this.create(s),this.editor.addContentWidget(this),this.editor.layoutContentWidget(this)}create(t){this.domNode=nl(".inline-progress-widget"),this.domNode.role="button",this.domNode.title=t;const i=nl("span.icon");this.domNode.append(i),i.classList.add(...Kl.asClassNameArray(As.loading),"codicon-modifier-spin");const e=()=>{const t=this.editor.getOption(67);this.domNode.style.height=`${t}px`,this.domNode.style.width=`${Math.ceil(.8*t)}px`};e(),this._register(this.editor.onDidChangeConfiguration((t=>{(t.hasChanged(52)||t.hasChanged(67))&&e()}))),this._register(sc(this.domNode,qc.CLICK,(t=>{this.delegate.cancel()})))}getId(){return C0.baseId+"."+this.typeId}getDomNode(){return this.domNode}getPosition(){return{position:{lineNumber:this.range.startLineNumber,column:this.range.startColumn},preference:[0]}}dispose(){super.dispose(),this.editor.removeContentWidget(this)}}C0.baseId="editor.widget.inlineProgressWidget";let S0=class extends Qi{constructor(t,i,e){super(),this.id=t,this._editor=i,this._instantiationService=e,this._showDelay=500,this._showPromise=this._register(new Yi),this._currentWidget=new Yi,this._operationIdPool=0,this._currentDecorations=i.createDecorationsCollection()}async showWhile(t,i,e){const s=this._operationIdPool++;this._currentOperation=s,this.clear(),this._showPromise.value=vo((()=>{const s=Cs.fromPositions(t);this._currentDecorations.set([{range:s,options:k0}]).length>0&&(this._currentWidget.value=this._instantiationService.createInstance(C0,this.id,this._editor,s,i,e))}),this._showDelay);try{return await e}finally{this._currentOperation===s&&(this.clear(),this._currentOperation=void 0)}}clear(){this._showPromise.clear(),this._currentDecorations.clear(),this._currentWidget.clear()}};S0=b0([y0(2,Il)],S0);var x0,D0=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},E0=function(t,i){return function(e,s){i(e,s,t)}};let A0=x0=class{static get(t){return t.getContribution(x0.ID)}constructor(t,i,e){this._openerService=e,this._messageWidget=new Yi,this._messageListeners=new Ji,this._mouseOverMessage=!1,this._editor=t,this._visible=x0.MESSAGE_VISIBLE.bindTo(i)}dispose(){var t;(t=this._message)===null||t===void 0||t.dispose(),this._messageListeners.dispose(),this._messageWidget.dispose(),this._visible.reset()}showMessage(t,i){let e;rw(R_(t)?t.value:t),this._visible.set(!0),this._messageWidget.clear(),this._messageListeners.clear(),this._message=R_(t)?V_(t,{actionHandler:{callback:i=>{this.closeMessage(),gP(this._openerService,i,R_(t)?t.isTrusted:void 0)},disposables:this._messageListeners}}):void 0,this._messageWidget.value=new M0(this._editor,i,typeof t=="string"?t:this._message.element),this._messageListeners.add(ne.debounce(this._editor.onDidBlurEditorText,((t,i)=>i),0)((()=>{this._mouseOverMessage||this._messageWidget.value&&xc(Lc(),this._messageWidget.value.getDomNode())||this.closeMessage()}))),this._messageListeners.add(this._editor.onDidChangeCursorPosition((()=>this.closeMessage()))),this._messageListeners.add(this._editor.onDidDispose((()=>this.closeMessage()))),this._messageListeners.add(this._editor.onDidChangeModel((()=>this.closeMessage()))),this._messageListeners.add(sc(this._messageWidget.value.getDomNode(),qc.MOUSE_ENTER,(()=>this._mouseOverMessage=!0),!0)),this._messageListeners.add(sc(this._messageWidget.value.getDomNode(),qc.MOUSE_LEAVE,(()=>this._mouseOverMessage=!1),!0)),this._messageListeners.add(this._editor.onMouseMove((t=>{t.target.position&&(e?e.containsPosition(t.target.position)||this.closeMessage():e=new Cs(i.lineNumber-3,1,t.target.position.lineNumber+3,1))})))}closeMessage(){this._visible.reset(),this._messageListeners.clear(),this._messageWidget.value&&this._messageListeners.add(M0.fadeOut(this._messageWidget.value))}};A0.ID="editor.contrib.messageController",A0.MESSAGE_VISIBLE=new Ta("messageVisible",!1,tt(0,"Whether the editor is currently showing an inline message")),A0=x0=D0([E0(1,Ra),E0(2,uI)],A0);yu(new(pu.bindToContribution(A0.get))({id:"leaveEditorMessage",precondition:A0.MESSAGE_VISIBLE,handler:t=>t.closeMessage(),kbOpts:{weight:130,primary:9}}));let M0=class{static fadeOut(t){const i=()=>{t.dispose(),clearTimeout(e),t.getDomNode().removeEventListener("animationend",i)},e=setTimeout(i,110);return t.getDomNode().addEventListener("animationend",i),t.getDomNode().classList.add("fadeOut"),{dispose:i}}constructor(t,{lineNumber:i,column:e},s){this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._editor=t,this._editor.revealLinesInCenterIfOutsideViewport(i,i,0),this._position={lineNumber:i,column:e},this._domNode=document.createElement("div"),this._domNode.classList.add("monaco-editor-overlaymessage"),this._domNode.style.marginLeft="-6px";const n=document.createElement("div");n.classList.add("anchor","top"),this._domNode.appendChild(n);const r=document.createElement("div");typeof s=="string"?(r.classList.add("message"),r.textContent=s):(s.classList.add("message"),r.appendChild(s)),this._domNode.appendChild(r);const o=document.createElement("div");o.classList.add("anchor","below"),this._domNode.appendChild(o),this._editor.addContentWidget(this),this._domNode.classList.add("fadeIn")}dispose(){this._editor.removeContentWidget(this)}getId(){return"messageoverlay"}getDomNode(){return this._domNode}getPosition(){return{position:this._position,preference:[1,2],positionAffinity:1}}afterRender(t){this._domNode.classList.toggle("below",t===2)}};Su(A0.ID,A0,4);var L0,F0=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},T0=function(t,i){return function(e,s){i(e,s,t)}};let R0=L0=class extends Qi{constructor(t,i,e,s,n,r,o,h,c,l){super(),this.typeId=t,this.editor=i,this.showCommand=s,this.range=n,this.edits=r,this.onSelectNewEdit=o,this._contextMenuService=h,this._keybindingService=l,this.allowEditorOverflow=!0,this.suppressMouseDown=!0,this.create(),this.visibleContext=e.bindTo(c),this.visibleContext.set(!0),this._register(Zi((()=>this.visibleContext.reset()))),this.editor.addContentWidget(this),this.editor.layoutContentWidget(this),this._register(Zi((()=>this.editor.removeContentWidget(this)))),this._register(this.editor.onDidChangeCursorPosition((t=>{n.containsPosition(t.position)||this.dispose()}))),this._register(ne.runAndSubscribe(l.onDidUpdateKeybindings,(()=>{this._updateButtonTitle()})))}_updateButtonTitle(){var t;const i=(t=this._keybindingService.lookupKeybinding(this.showCommand.id))===null||t===void 0?void 0:t.getLabel();this.button.element.title=this.showCommand.label+(i?` (${i})`:"")}create(){this.domNode=nl(".post-edit-widget"),this.button=this._register(new lU(this.domNode,{supportIcons:!0})),this.button.label="$(insert)",this._register(sc(this.domNode,qc.CLICK,(()=>this.showSelector())))}getId(){return L0.baseId+"."+this.typeId}getDomNode(){return this.domNode}getPosition(){return{position:this.range.getEndPosition(),preference:[2]}}showSelector(){this._contextMenuService.showContextMenu({getAnchor:()=>{const t=vc(this.button.element);return{x:t.left+t.width,y:t.top+t.height}},getActions:()=>this.edits.allEdits.map(((t,i)=>zl({id:"",label:t.title,checked:i===this.edits.activeEditIndex,run:()=>{if(i!==this.edits.activeEditIndex)return this.onSelectNewEdit(i)}})))})}};R0.baseId="editor.widget.postEditWidget",R0=L0=F0([T0(7,oI),T0(8,Ra),T0(9,NS)],R0);let O0=class extends Qi{constructor(t,i,e,s,n,r){super(),this._id=t,this._editor=i,this._visibleContext=e,this._showCommand=s,this._instantiationService=n,this._bulkEditService=r,this._currentWidget=this._register(new Yi),this._register(ne.any(i.onDidChangeModel,i.onDidChangeModelContent)((()=>this.clear())))}async applyEditAndShowIfNeeded(t,i,e,s,n){const r=this._editor.getModel();if(!r||!t.length)return;const o=i.allEdits.at(i.activeEditIndex);if(!o)return;const h=await s(o,n),c=w0(r.uri,t,h),l=t[0],a=r.deltaDecorations([],[{range:l,options:{description:"paste-line-suffix",stickiness:0}}]);let u,d;try{u=await this._bulkEditService.apply(c,{editor:this._editor,token:n}),d=r.getDecorationRange(a[0])}finally{r.deltaDecorations(a,[])}e&&u.isApplied&&i.allEdits.length>1&&this.show(d??l,i,(async r=>{const o=this._editor.getModel();o&&(await o.undo(),this.applyEditAndShowIfNeeded(t,{activeEditIndex:r,allEdits:i.allEdits},e,s,n))}))}show(t,i,e){this.clear(),this._editor.hasModel()&&(this._currentWidget.value=this._instantiationService.createInstance(R0,this._id,this._editor,this._visibleContext,this._showCommand,t,i,e))}clear(){this._currentWidget.clear()}tryShowSelector(){var t;(t=this._currentWidget.value)===null||t===void 0||t.showSelector()}};O0=F0([T0(4,Il),T0(5,PP)],O0);var I0,_0=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},P0=function(t,i){return function(e,s){i(e,s,t)}};const N0="editor.changePasteType",B0=new Ta("pasteWidgetVisible",!1,tt(0,"Whether the paste widget is showing")),$0="application/vnd.code.copyMetadata";let W0=I0=class extends Qi{static get(t){return t.getContribution(I0.ID)}constructor(t,i,e,s,n,r,o){super(),this._bulkEditService=e,this._clipboardService=s,this._languageFeaturesService=n,this._quickInputService=r,this._progressService=o,this._editor=t;const h=t.getContainerDomNode();this._register(sc(h,"copy",(t=>this.handleCopy(t)))),this._register(sc(h,"cut",(t=>this.handleCopy(t)))),this._register(sc(h,"paste",(t=>this.handlePaste(t)),!0)),this._pasteProgressManager=this._register(new S0("pasteIntoEditor",t,i)),this._postPasteWidgetManager=this._register(i.createInstance(O0,"pasteIntoEditor",t,B0,{id:N0,label:tt(0,"Show paste options...")}))}changePasteType(){this._postPasteWidgetManager.tryShowSelector()}pasteAs(t){this._editor.focus();try{this._pasteAsActionContext={preferred:t},Rc().execCommand("paste")}finally{this._pasteAsActionContext=void 0}}clearWidgets(){this._postPasteWidgetManager.clear()}isPasteAsEnabled(){return this._editor.getOption(85).enabled&&!this._editor.getOption(91)}async finishedPaste(){await this._currentPasteOperation}handleCopy(t){var i,e;if(!this._editor.hasTextFocus()||(Ct&&this._clipboardService.writeResources([]),!t.clipboardData||!this.isPasteAsEnabled()))return;const s=this._editor.getModel(),n=this._editor.getSelections();if(!s||!(n!=null&&n.length))return;const r=this._editor.getOption(37);let o=n;const h=n.length===1&&n[0].isEmpty();if(h){if(!r)return;o=[new Cs(o[0].startLineNumber,1,o[0].startLineNumber,1+s.getLineLength(o[0].startLineNumber))]}const c=(i=this._editor._getViewModel())===null||i===void 0?void 0:i.getPlainTextToCopy(n,r,vt),l={multicursorText:Array.isArray(c)?c:null,pasteOnNewLine:h,mode:null},u=this._languageFeaturesService.documentPasteEditProvider.ordered(s).filter((t=>!!t.prepareDocumentPaste));if(!u.length)return void this.setCopyMetadata(t.clipboardData,{defaultPastePayload:l});const d=UX(t.clipboardData),f=u.flatMap((t=>{var i;return(i=t.copyMimeTypes)!==null&&i!==void 0?i:[]})),g=IX();this.setCopyMetadata(t.clipboardData,{id:g,providerCopyMimeTypes:f,defaultPastePayload:l});const p=uo((async t=>{const i=a(await Promise.all(u.map((async i=>{try{return await i.prepareDocumentPaste(s,o,d,t)}catch(t){return void console.error(t)}}))));i.reverse();for(const t of i)for(const[i,e]of t)d.replace(i,e);return d}));(e=I0._currentCopyOperation)===null||e===void 0||e.dataTransferPromise.cancel(),I0._currentCopyOperation={handle:g,dataTransferPromise:p}}async handlePaste(t){var i,e,s,n;if(!t.clipboardData||!this._editor.hasTextFocus())return;(i=A0.get(this._editor))===null||i===void 0||i.closeMessage(),(e=this._currentPasteOperation)===null||e===void 0||e.cancel(),this._currentPasteOperation=void 0;const r=this._editor.getModel(),o=this._editor.getSelections();if(!(o!=null&&o.length)||!r||!this.isPasteAsEnabled()&&!this._pasteAsActionContext)return;const h=this.fetchCopyMetadata(t),c=GX(t.clipboardData);c.delete($0);const l=[...t.clipboardData.types,...(s=h==null?void 0:h.providerCopyMimeTypes)!==null&&s!==void 0?s:[],$d.uriList],a=this._languageFeaturesService.documentPasteEditProvider.ordered(r).filter((t=>{var i,e;const s=(i=this._pasteAsActionContext)===null||i===void 0?void 0:i.preferred;return!(s&&t.providedPasteEditKinds&&!this.providerMatchesPreference(t,s))&&((e=t.pasteMimeTypes)===null||e===void 0?void 0:e.some((t=>BX(t,l))))}));a.length?(t.preventDefault(),t.stopImmediatePropagation(),this._pasteAsActionContext?this.showPasteAsPick(this._pasteAsActionContext.preferred,a,o,c,h):this.doPasteInline(a,o,c,h,t)):!((n=this._pasteAsActionContext)===null||n===void 0)&&n.preferred&&this.showPasteAsNoEditMessage(o,this._pasteAsActionContext.preferred)}showPasteAsNoEditMessage(t,i){var e;(e=A0.get(this._editor))===null||e===void 0||e.showMessage(tt(0,"No paste edits for '{0}' found",i instanceof jX?i.value:i.providerId),t[0].getStartPosition())}doPasteInline(t,i,e,s,n){const r=uo((async o=>{const h=this._editor;if(!h.hasModel())return;const c=h.getModel(),l=new _Q(h,3,void 0,o);try{if(await this.mergeInDataFromCopy(e,s,l.token),l.token.isCancellationRequested)return;const r=t.filter((t=>this.isSupportedPasteProvider(t,e)));if(!r.length||r.length===1&&r[0]instanceof YX)return this.applyDefaultPasteHandler(e,s,l.token,n);const o={triggerKind:Is.Automatic},a=await this.getPasteEdits(r,e,c,i,o,l.token);if(l.token.isCancellationRequested)return;if(a.length===1&&a[0].provider instanceof YX)return this.applyDefaultPasteHandler(e,s,l.token,n);if(a.length){const t=h.getOption(85).showPasteSelector==="afterPaste";return this._postPasteWidgetManager.applyEditAndShowIfNeeded(i,{activeEditIndex:0,allEdits:a},t,(async(t,i)=>{var e,s;const n=await((s=(e=t.provider).resolveDocumentPasteEdit)===null||s===void 0?void 0:s.call(e,t,i));return n&&(t.additionalEdit=n.additionalEdit),t}),l.token)}await this.applyDefaultPasteHandler(e,s,l.token,n)}finally{l.dispose(),this._currentPasteOperation===r&&(this._currentPasteOperation=void 0)}}));this._pasteProgressManager.showWhile(i[0].getEndPosition(),tt(0,"Running paste handlers. Click to cancel"),r),this._currentPasteOperation=r}showPasteAsPick(t,i,e,s,n){const r=uo((async o=>{const h=this._editor;if(!h.hasModel())return;const c=h.getModel(),l=new _Q(h,3,void 0,o);try{if(await this.mergeInDataFromCopy(s,n,l.token),l.token.isCancellationRequested)return;let r=i.filter((i=>this.isSupportedPasteProvider(i,s,t)));t&&(r=r.filter((i=>this.providerMatchesPreference(i,t))));const o={triggerKind:Is.PasteAs,only:t&&t instanceof jX?t:void 0};let h,a=await this.getPasteEdits(r,s,c,e,o,l.token);if(l.token.isCancellationRequested)return;if(t&&(a=a.filter((i=>t instanceof jX?t.contains(i.kind):t.providerId===i.provider.id))),!a.length)return void(o.only&&this.showPasteAsNoEditMessage(e,o.only));if(t)h=a.at(0);else{const t=await this._quickInputService.pick(a.map((t=>{var i;return{label:t.title,description:(i=t.kind)===null||i===void 0?void 0:i.value,edit:t}})),{placeHolder:tt(0,"Select Paste Action")});h=t==null?void 0:t.edit}if(!h)return;const u=w0(c.uri,e,h);await this._bulkEditService.apply(u,{editor:this._editor})}finally{l.dispose(),this._currentPasteOperation===r&&(this._currentPasteOperation=void 0)}}));this._progressService.withProgress({location:10,title:tt(0,"Running paste handlers")},(()=>r))}setCopyMetadata(t,i){t.setData($0,JSON.stringify(i))}fetchCopyMetadata(t){var i;if(!t.clipboardData)return;const e=t.clipboardData.getData($0);if(e)try{return JSON.parse(e)}catch{return}const[s,n]=kC.getTextData(t.clipboardData);return n?{defaultPastePayload:{mode:n.mode,multicursorText:(i=n.multicursorText)!==null&&i!==void 0?i:null,pasteOnNewLine:!!n.isFromEmptySelection}}:void 0}async mergeInDataFromCopy(t,i,e){var s;if(i!=null&&i.id&&((s=I0._currentCopyOperation)===null||s===void 0?void 0:s.handle)===i.id){const i=await I0._currentCopyOperation.dataTransferPromise;if(e.isCancellationRequested)return;for(const[e,s]of i)t.replace(e,s)}if(!t.has($d.uriList)){const i=await this._clipboardService.readResources();if(e.isCancellationRequested)return;i.length&&t.append($d.uriList,_X(WX.create(i)))}}async getPasteEdits(t,i,e,s,n,r){const o=await fo(Promise.all(t.map((async t=>{var o,h;try{const c=await((o=t.provideDocumentPasteEdits)===null||o===void 0?void 0:o.call(t,e,s,i,n,r));return(h=c==null?void 0:c.edits)===null||h===void 0?void 0:h.map((i=>({...i,provider:t})))}catch(t){console.error(t)}}))),r);return v0(a(o??[]).flat().filter((t=>!n.only||n.only.contains(t.kind))))}async applyDefaultPasteHandler(t,i,e,s){var n,r,o,h;const c=(n=t.get($d.text))!==null&&n!==void 0?n:t.get("text"),l=(r=await(c==null?void 0:c.asString()))!==null&&r!==void 0?r:"";if(e.isCancellationRequested)return;const a={clipboardEvent:s,text:l,pasteOnNewLine:(o=i==null?void 0:i.defaultPastePayload.pasteOnNewLine)!==null&&o!==void 0&&o,multicursorText:(h=i==null?void 0:i.defaultPastePayload.multicursorText)!==null&&h!==void 0?h:null,mode:null};this._editor.trigger("keyboard","paste",a)}isSupportedPasteProvider(t,i,e){var s;return!!(!((s=t.pasteMimeTypes)===null||s===void 0)&&s.some((t=>i.matches(t))))&&(!e||this.providerMatchesPreference(t,e))}providerMatchesPreference(t,i){return i instanceof jX?!t.providedPasteEditKinds||t.providedPasteEditKinds.some((t=>i.contains(t))):t.id===i.providerId}};W0.ID="editor.contrib.copyPasteActionController",W0=I0=_0([P0(1,Il),P0(2,PP),P0(3,AK),P0(4,$p),P0(5,vj),P0(6,vN)],W0);const j0="9_cutcopypaste",H0=kt||document.queryCommandSupported("cut"),V0=kt||document.queryCommandSupported("copy"),z0=navigator.clipboard!==void 0&&!Hr||document.queryCommandSupported("paste");function U0(t){return t.register(),t}const K0=H0?U0(new fu({id:"editor.action.clipboardCutAction",precondition:void 0,kbOpts:kt?{primary:2102,win:{primary:2102,secondary:[1044]},weight:100}:void 0,menuOpts:[{menuId:Qa.MenubarEditMenu,group:"2_ccp",title:tt(0,"Cu&&t"),order:1},{menuId:Qa.EditorContext,group:j0,title:tt(0,"Cut"),when:Ox.writable,order:1},{menuId:Qa.CommandPalette,group:"",title:tt(0,"Cut"),order:1},{menuId:Qa.SimpleEditorContext,group:j0,title:tt(0,"Cut"),when:Ox.writable,order:1}]})):void 0,q0=V0?U0(new fu({id:"editor.action.clipboardCopyAction",precondition:void 0,kbOpts:kt?{primary:2081,win:{primary:2081,secondary:[2067]},weight:100}:void 0,menuOpts:[{menuId:Qa.MenubarEditMenu,group:"2_ccp",title:tt(0,"&&Copy"),order:2},{menuId:Qa.EditorContext,group:j0,title:tt(0,"Copy"),order:2},{menuId:Qa.CommandPalette,group:"",title:tt(0,"Copy"),order:1},{menuId:Qa.SimpleEditorContext,group:j0,title:tt(0,"Copy"),order:2}]})):void 0;tu.appendMenuItem(Qa.MenubarEditMenu,{submenu:Qa.MenubarCopy,title:it(0,"Copy As"),group:"2_ccp",order:3}),tu.appendMenuItem(Qa.EditorContext,{submenu:Qa.EditorContextCopy,title:it(0,"Copy As"),group:j0,order:3}),tu.appendMenuItem(Qa.EditorContext,{submenu:Qa.EditorContextShare,title:it(0,"Share"),group:"11_share",order:-1,when:ua.and(ua.notEquals("resourceScheme","output"),Ox.editorTextFocus)}),tu.appendMenuItem(Qa.EditorTitleContext,{submenu:Qa.EditorTitleContextShare,title:it(0,"Share"),group:"11_share",order:-1}),tu.appendMenuItem(Qa.ExplorerContext,{submenu:Qa.ExplorerContextShare,title:it(0,"Share"),group:"11_share",order:-1});const G0=z0?U0(new fu({id:"editor.action.clipboardPasteAction",precondition:void 0,kbOpts:kt?{primary:2100,win:{primary:2100,secondary:[1043]},linux:{primary:2100,secondary:[1043]},weight:100}:void 0,menuOpts:[{menuId:Qa.MenubarEditMenu,group:"2_ccp",title:tt(0,"&&Paste"),order:4},{menuId:Qa.EditorContext,group:j0,title:tt(0,"Paste"),when:Ox.writable,order:4},{menuId:Qa.CommandPalette,group:"",title:tt(0,"Paste"),order:1},{menuId:Qa.SimpleEditorContext,group:j0,title:tt(0,"Paste"),when:Ox.writable,order:4}]})):void 0;class Z0 extends mu{constructor(){super({id:"editor.action.clipboardCopyWithSyntaxHighlightingAction",label:tt(0,"Copy With Syntax Highlighting"),alias:"Copy With Syntax Highlighting",precondition:void 0,kbOpts:{kbExpr:Ox.textInputFocus,primary:0,weight:100}})}run(t,i){i.hasModel()&&(!i.getOption(37)&&i.getSelection().isEmpty()||(wC.forceCopyWithSyntaxHighlighting=!0,i.focus(),i.getContainerDomNode().ownerDocument.execCommand("copy"),wC.forceCopyWithSyntaxHighlighting=!1))}}function J0(t,i){t&&(t.addImplementation(1e4,"code-editor",((t,e)=>{const s=t.get(Pl).getFocusedCodeEditor();if(s&&s.hasTextFocus()){const t=s.getOption(37),e=s.getSelection();return e&&e.isEmpty()&&!t||s.getContainerDomNode().ownerDocument.execCommand(i),!0}return!1})),t.addImplementation(0,"generic-dom",((t,e)=>(Rc().execCommand(i),!0))))}J0(K0,"cut"),J0(q0,"copy"),G0&&(G0.addImplementation(1e4,"code-editor",((t,i)=>{var e,s;const n=t.get(Pl),r=t.get(AK),o=n.getFocusedCodeEditor();return o&&o.hasTextFocus()?o.getContainerDomNode().ownerDocument.execCommand("paste")?(s=(e=W0.get(o))===null||e===void 0?void 0:e.finishedPaste())!==null&&s!==void 0?s:Promise.resolve():!Ct||(async()=>{const t=await r.readText();if(t!==""){const i=vC.INSTANCE.get(t);let e=!1,s=null,n=null;i&&(e=o.getOption(37)&&!!i.isFromEmptySelection,s=i.multicursorText!==void 0?i.multicursorText:null,n=i.mode),o.trigger("keyboard","paste",{text:t,pasteOnNewLine:e,multicursorText:s,mode:n})}})():!1})),G0.addImplementation(0,"generic-dom",((t,i)=>(Rc().execCommand("paste"),!0)))),V0&&ku(Z0);const Q0=new class{constructor(){this.QuickFix=new jX("quickfix"),this.Refactor=new jX("refactor"),this.RefactorExtract=this.Refactor.append("extract"),this.RefactorInline=this.Refactor.append("inline"),this.RefactorMove=this.Refactor.append("move"),this.RefactorRewrite=this.Refactor.append("rewrite"),this.Notebook=new jX("notebook"),this.Source=new jX("source"),this.SourceOrganizeImports=this.Source.append("organizeImports"),this.SourceFixAll=this.Source.append("fixAll"),this.SurroundWith=this.Refactor.append("surround")}};var Y0;function X0(t,i,e){return!!i.contains(t)&&(!e||!i.contains(e))}(function(t){t.Refactor="refactor",t.RefactorPreview="refactor preview",t.Lightbulb="lightbulb",t.Default="other (default)",t.SourceAction="source action",t.QuickFix="quick fix action",t.FixAll="fix all",t.OrganizeImports="organize imports",t.AutoFix="auto fix",t.QuickFixHover="quick fix hover window",t.OnSave="save participants",t.ProblemsView="problems view"})(Y0||(Y0={}));class t1{static fromUser(t,i){return t&&typeof t=="object"?new t1(t1.getKindFromUser(t,i.kind),t1.getApplyFromUser(t,i.apply),t1.getPreferredUser(t)):new t1(i.kind,i.apply,!1)}static getApplyFromUser(t,i){switch(typeof t.apply=="string"?t.apply.toLowerCase():""){case"first":return"first";case"never":return"never";case"ifsingle":return"ifSingle";default:return i}}static getKindFromUser(t,i){return typeof t.kind=="string"?new jX(t.kind):i}static getPreferredUser(t){return typeof t.preferred=="boolean"&&t.preferred}constructor(t,i,e){this.kind=t,this.apply=i,this.preferred=e}}class i1{constructor(t,i,e){this.action=t,this.provider=i,this.highlightRange=e}async resolve(t){var i;if(!((i=this.provider)===null||i===void 0)&&i.resolveCodeAction&&!this.action.edit){let i;try{i=await this.provider.resolveCodeAction(this.action,t)}catch(t){_i(t)}i&&(this.action.edit=i.edit)}return this}}const e1="editor.action.codeAction",s1="editor.action.quickFix",n1="editor.action.autoFix",r1="editor.action.refactor",o1="editor.action.sourceAction",h1="editor.action.organizeImports",c1="editor.action.fixAll";class l1 extends Qi{static codeActionsPreferredComparator(t,i){return t.isPreferred&&!i.isPreferred?-1:!t.isPreferred&&i.isPreferred?1:0}static codeActionsComparator({action:t},{action:i}){return t.isAI&&!i.isAI?1:!t.isAI&&i.isAI?-1:f(t.diagnostics)?f(i.diagnostics)?l1.codeActionsPreferredComparator(t,i):-1:f(i.diagnostics)?1:l1.codeActionsPreferredComparator(t,i)}constructor(t,i,e){super(),this.documentation=i,this._register(e),this.allActions=[...t].sort(l1.codeActionsComparator),this.validActions=this.allActions.filter((({action:t})=>!t.disabled))}get hasAutoFix(){return this.validActions.some((({action:t})=>!!t.kind&&Q0.QuickFix.contains(new jX(t.kind))&&!!t.isPreferred))}get hasAIFix(){return this.validActions.some((({action:t})=>!!t.isAI))}get allAIFixes(){return this.validActions.every((({action:t})=>!!t.isAI))}}const a1={actions:[],documentation:void 0};async function u1(t,i,e,s,r,o){var h;const c=s.filter||{},l={...c,excludes:[...c.excludes||[],Q0.Notebook]},u={only:(h=c.include)===null||h===void 0?void 0:h.value,trigger:s.type},d=new PQ(i,o),f=s.type===2,g=function(t,i,e){return t.all(i).filter((t=>!t.providedCodeActionKinds||t.providedCodeActionKinds.some((t=>function(t,i){return!(t.include&&!t.include.intersects(i)||t.excludes&&t.excludes.some((e=>X0(i,e,t.include)))||!t.includeSourceActions&&Q0.Source.contains(i))}(e,new jX(t))))))}(t,i,f?l:c),p=new Ji,m=g.map((async t=>{try{r.report(t);const s=await t.provideCodeActions(i,e,u,d.token);if(s&&p.add(s),d.token.isCancellationRequested)return a1;const n=((s==null?void 0:s.actions)||[]).filter((t=>t&&function(t,i){const e=i.kind?new jX(i.kind):void 0;return!(!(!t.include||e&&t.include.contains(e))||t.excludes&&e&&t.excludes.some((i=>X0(e,i,t.include)))||!t.includeSourceActions&&e&&Q0.Source.contains(e)||t.onlyIncludePreferredActions&&!i.isPreferred)}(c,t))),o=function(t,i,e){if(!t.documentation)return;const s=t.documentation.map((t=>({kind:new jX(t.kind),command:t.command})));if(e){let t;for(const i of s)i.kind.contains(e)&&(t?t.kind.contains(i.kind)&&(t=i):t=i);if(t)return t==null?void 0:t.command}for(const t of i)if(t.kind){for(const i of s)if(i.kind.contains(new jX(t.kind)))return i.command}}(t,n,c.include);return{actions:n.map((i=>new i1(i,t))),documentation:o}}catch(t){if(Bi(t))throw t;return _i(t),a1}})),w=t.onDidChange((()=>{n(t.all(i),g)||d.cancel()}));try{const e=await Promise.all(m),n=e.map((t=>t.actions)).flat(),r=[...a(e.map((t=>t.documentation))),...d1(t,i,s,n)];return new l1(n,r,p)}finally{w.dispose(),d.dispose()}}function*d1(t,i,e,s){var n,r,o;if(i&&s.length)for(const h of t.all(i))h._getAdditionalMenuItems&&(yield*(n=h._getAdditionalMenuItems)===null||n===void 0?void 0:n.call(h,{trigger:e.type,only:(o=(r=e.filter)===null||r===void 0?void 0:r.include)===null||o===void 0?void 0:o.value},s.map((t=>t.action))))}var f1;async function g1(t,i,e,s,n=ve.None){var r;const o=t.get(PP),h=t.get(ql),c=t.get(ru),l=t.get(gR);if(c.publicLog2("codeAction.applyCodeAction",{codeActionTitle:i.action.title,codeActionKind:i.action.kind,codeActionIsPreferred:!!i.action.isPreferred,reason:e}),await i.resolve(n),!n.isCancellationRequested){if(!((r=i.action.edit)===null||r===void 0)&&r.edits.length&&!(await o.apply(i.action.edit,{editor:s==null?void 0:s.editor,label:i.action.title,quotableLabel:i.action.title,code:"undoredo.codeAction",respectAutoSaveConfig:e!==f1.OnSave,showPreview:s==null?void 0:s.preview})).isApplied)return;if(i.action.command)try{await h.executeCommand(i.action.command.id,...i.action.command.arguments||[])}catch(t){const i=function(t){return typeof t=="string"?t:t instanceof Error&&typeof t.message=="string"?t.message:void 0}(t);l.error(typeof i=="string"?i:tt(0,"An unknown error occurred while applying the code action"))}}}(function(t){t.OnSave="onSave",t.FromProblemsView="fromProblemsView",t.FromCodeActions="fromCodeActions",t.FromAILightbulb="fromAILightbulb"})(f1||(f1={})),Gl.registerCommand("_executeCodeActionProvider",(async function(t,i,e,s,n){if(!(i instanceof as))throw Wi();const{codeActionProvider:r}=t.get($p),o=t.get(Nl).getModel(i);if(!o)throw Wi();const h=Ss.isISelection(e)?Ss.liftSelection(e):Cs.isIRange(e)?o.validateRange(e):void 0;if(!h)throw Wi();const c=typeof s=="string"?new jX(s):void 0,l=await u1(r,o,h,{type:1,triggerAction:Y0.Default,filter:{includeSourceActions:!0,include:c}},bN.None,ve.None),a=[],u=Math.min(l.validActions.length,typeof n=="number"?n:0);for(let t=0;t<u;t++)a.push(l.validActions[t].resolve(ve.None));try{return await Promise.all(a),l.validActions.map((t=>t.action))}finally{setTimeout((()=>l.dispose()),100)}}));var p1,m1=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},w1=function(t,i){return function(e,s){i(e,s,t)}};let v1=p1=class{constructor(t){this.keybindingService=t}getResolver(){const t=new Hn((()=>this.keybindingService.getKeybindings().filter((t=>p1.codeActionCommands.indexOf(t.command)>=0)).filter((t=>t.resolvedKeybinding)).map((t=>{let i=t.commandArgs;return t.command===h1?i={kind:Q0.SourceOrganizeImports.value}:t.command===c1&&(i={kind:Q0.SourceFixAll.value}),{resolvedKeybinding:t.resolvedKeybinding,...t1.fromUser(i,{kind:jX.None,apply:"never"})}}))));return i=>{if(i.kind){const e=this.bestKeybindingForCodeAction(i,t.value);return e==null?void 0:e.resolvedKeybinding}}}bestKeybindingForCodeAction(t,i){if(!t.kind)return;const e=new jX(t.kind);return i.filter((t=>t.kind.contains(e))).filter((i=>!i.preferred||t.isPreferred)).reduceRight(((t,i)=>t?t.kind.contains(i.kind)?i:t:i),void 0)}};v1.codeActionCommands=[r1,e1,o1,h1,c1],v1=p1=m1([w1(0,NS)],v1),Iw("symbolIcon.arrayForeground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.booleanForeground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.classForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},tt(0,"The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.colorForeground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.constantForeground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.constructorForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},tt(0,"The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.enumeratorForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},tt(0,"The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.enumeratorMemberForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},tt(0,"The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.eventForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},tt(0,"The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.fieldForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},tt(0,"The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.fileForeground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.folderForeground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.functionForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},tt(0,"The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.interfaceForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},tt(0,"The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.keyForeground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.keywordForeground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.methodForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},tt(0,"The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.moduleForeground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.namespaceForeground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.nullForeground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.numberForeground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.objectForeground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.operatorForeground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.packageForeground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.propertyForeground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.referenceForeground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.snippetForeground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.stringForeground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.structForeground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.textForeground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.typeParameterForeground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.unitForeground",{dark:zw,light:zw,hcDark:zw,hcLight:zw},tt(0,"The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Iw("symbolIcon.variableForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},tt(0,"The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));const b1=Object.freeze({kind:jX.Empty,title:tt(0,"More Actions...")}),y1=Object.freeze([{kind:Q0.QuickFix,title:tt(0,"Quick Fix")},{kind:Q0.RefactorExtract,title:tt(0,"Extract"),icon:As.wrench},{kind:Q0.RefactorInline,title:tt(0,"Inline"),icon:As.wrench},{kind:Q0.RefactorRewrite,title:tt(0,"Rewrite"),icon:As.wrench},{kind:Q0.RefactorMove,title:tt(0,"Move"),icon:As.wrench},{kind:Q0.SurroundWith,title:tt(0,"Surround With"),icon:As.surroundWith},{kind:Q0.Source,title:tt(0,"Source Action"),icon:As.symbolFile},b1]);var k1,C1,S1=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},x1=function(t,i){return function(e,s){i(e,s,t)}};(function(t){t.Hidden={type:0},t.Showing=class{constructor(t,i,e,s){this.actions=t,this.trigger=i,this.editorPosition=e,this.widgetPosition=s,this.type=1}}})(C1||(C1={}));let D1=k1=class extends Qi{constructor(t,i,e){super(),this._editor=t,this._keybindingService=i,this._onClick=this._register(new le),this.onClick=this._onClick.event,this._state=C1.Hidden,this._iconClasses=[],this._domNode=nl("div.lightBulbWidget"),this._register(Wk.ignoreTarget(this._domNode)),this._editor.addContentWidget(this),this._register(this._editor.onDidChangeModelContent((t=>{const i=this._editor.getModel();(this.state.type!==1||!i||this.state.editorPosition.lineNumber>=i.getLineCount())&&this.hide()}))),this._register(oc(this._domNode,(t=>{if(this.state.type!==1)return;this._editor.focus(),t.preventDefault();const{top:i,height:e}=vc(this._domNode),s=this._editor.getOption(67);let n=Math.floor(s/3);this.state.widgetPosition.position!==null&&this.state.widgetPosition.position.lineNumber<this.state.editorPosition.lineNumber&&(n+=s),this._onClick.fire({x:t.posx,y:i+e+n,actions:this.state.actions,trigger:this.state.trigger})}))),this._register(sc(this._domNode,"mouseenter",(t=>{1&~t.buttons||this.hide()}))),this._register(ne.runAndSubscribe(this._keybindingService.onDidUpdateKeybindings,(()=>{var t,i,e,s;this._preferredKbLabel=(i=(t=this._keybindingService.lookupKeybinding(n1))===null||t===void 0?void 0:t.getLabel())!==null&&i!==void 0?i:void 0,this._quickFixKbLabel=(s=(e=this._keybindingService.lookupKeybinding(s1))===null||e===void 0?void 0:e.getLabel())!==null&&s!==void 0?s:void 0,this._updateLightBulbTitleAndIcon()})))}dispose(){super.dispose(),this._editor.removeContentWidget(this)}getId(){return"LightBulbWidget"}getDomNode(){return this._domNode}getPosition(){return this._state.type===1?this._state.widgetPosition:null}update(t,i,e){if(t.validActions.length<=0)return this.hide();if(!this._editor.getOptions().get(65).enabled)return this.hide();const s=this._editor.getModel();if(!s)return this.hide();const{lineNumber:n,column:r}=s.validatePosition(e),o=s.getOptions().tabSize,h=this._editor.getOptions().get(50),c=CD(s.getLineContent(n),o),l=t=>t>2&&this._editor.getTopForLineNumber(t)===this._editor.getTopForLineNumber(t-1);let a=n,u=1;if(!(h.spaceWidth*c>22)){if(n>1&&!l(n-1))a-=1;else if(n<s.getLineCount()&&!l(n+1))a+=1;else if(r*h.spaceWidth<22)return this.hide();u=/^\S\s*$/.test(s.getLineContent(a))?2:1}this.state=new C1.Showing(t,i,e,{position:{lineNumber:a,column:u},preference:k1._posPref}),this._editor.layoutContentWidget(this)}hide(){this.state!==C1.Hidden&&(this.state=C1.Hidden,this._editor.layoutContentWidget(this))}get state(){return this._state}set state(t){this._state=t,this._updateLightBulbTitleAndIcon()}_updateLightBulbTitleAndIcon(){if(this._domNode.classList.remove(...this._iconClasses),this._iconClasses=[],this.state.type!==1)return;let t,i=!1;this.state.actions.allAIFixes?(t=As.sparkleFilled,this.state.actions.validActions.length===1&&(i=!0)):t=this.state.actions.hasAutoFix?this.state.actions.hasAIFix?As.lightbulbSparkleAutofix:As.lightbulbAutofix:this.state.actions.hasAIFix?As.lightbulbSparkle:As.lightBulb,this._updateLightbulbTitle(this.state.actions.hasAutoFix,i),this._iconClasses=Kl.asClassNameArray(t),this._domNode.classList.add(...this._iconClasses)}_updateLightbulbTitle(t,i){this.state.type===1&&(i?this.title=tt(0,"Run: {0}",this.state.actions.validActions[0].action.title):t&&this._preferredKbLabel?this.title=tt(0,"Show Code Actions. Preferred Quick Fix Available ({0})",this._preferredKbLabel):!t&&this._quickFixKbLabel?this.title=tt(0,"Show Code Actions ({0})",this._quickFixKbLabel):t||(this.title=tt(0,"Show Code Actions")))}set title(t){this._domNode.title=t}};D1.ID="editor.contrib.lightbulbWidget",D1._posPref=[0],D1=k1=S1([x1(1,NS),x1(2,ql)],D1);var E1=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},A1=function(t,i){return function(e,s){i(e,s,t)}};const M1="acceptSelectedCodeAction",L1="previewSelectedCodeAction";class F1{get templateId(){return"header"}renderTemplate(t){t.classList.add("group-header");const i=document.createElement("span");return t.append(i),{container:t,text:i}}renderElement(t,i,e){var s,n;e.text.textContent=(n=(s=t.group)===null||s===void 0?void 0:s.title)!==null&&n!==void 0?n:""}disposeTemplate(t){}}let T1=class{get templateId(){return"action"}constructor(t,i){this._supportsPreview=t,this._keybindingService=i}renderTemplate(t){t.classList.add(this.templateId);const i=document.createElement("div");i.className="icon",t.append(i);const e=document.createElement("span");return e.className="title",t.append(e),{container:t,icon:i,text:e,keybinding:new Nz(t,Ft)}}renderElement(t,i,e){var s,n,r;if(!((s=t.group)===null||s===void 0)&&s.icon?(e.icon.className=Kl.asClassName(t.group.icon),t.group.icon.color&&(e.icon.style.color=Tw(t.group.icon.color.id))):(e.icon.className=Kl.asClassName(As.lightBulb),e.icon.style.color="var(--vscode-editorLightBulb-foreground)"),!t.item||!t.label)return;e.text.textContent=P1(t.label),e.keybinding.set(t.keybinding),function(t,...i){t?rl(...i):ol(...i)}(!!t.keybinding,e.keybinding.element);const o=(n=this._keybindingService.lookupKeybinding(M1))===null||n===void 0?void 0:n.getLabel(),h=(r=this._keybindingService.lookupKeybinding(L1))===null||r===void 0?void 0:r.getLabel();e.container.classList.toggle("option-disabled",t.disabled),t.disabled?e.container.title=t.label:o&&h?this._supportsPreview&&t.canPreview?e.container.title=tt(0,"{0} to Apply, {1} to Preview",o,h):e.container.title=tt(0,"{0} to Apply",o):e.container.title=""}disposeTemplate(t){t.keybinding.dispose()}};T1=E1([A1(1,NS)],T1);class R1 extends UIEvent{constructor(){super("acceptSelectedAction")}}class O1 extends UIEvent{constructor(){super("previewSelectedAction")}}function I1(t){if(t.kind==="action")return t.label}let _1=class extends Qi{constructor(t,i,e,s,n,r){super(),this._delegate=s,this._contextViewService=n,this._keybindingService=r,this._actionLineHeight=24,this._headerLineHeight=26,this.cts=this._register(new ye),this.domNode=document.createElement("div"),this.domNode.classList.add("actionList");const o={getHeight:t=>t.kind==="header"?this._headerLineHeight:this._actionLineHeight,getTemplateId:t=>t.kind};this._list=this._register(new W$(t,this.domNode,o,[new T1(i,this._keybindingService),new F1],{keyboardSupport:!1,typeNavigationEnabled:!0,keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:I1},accessibilityProvider:{getAriaLabel:t=>{if(t.kind==="action"){let i=t.label?P1(t==null?void 0:t.label):"";return t.disabled&&(i=tt(0,"{0}, Disabled Reason: {1}",i,t.disabled)),i}return null},getWidgetAriaLabel:()=>tt(0,"Action Widget"),getRole:t=>t.kind==="action"?"option":"separator",getWidgetRole:()=>"listbox"}})),this._list.style(gW),this._register(this._list.onMouseClick((t=>this.onListClick(t)))),this._register(this._list.onMouseOver((t=>this.onListHover(t)))),this._register(this._list.onDidChangeFocus((()=>this.onFocus()))),this._register(this._list.onDidChangeSelection((t=>this.onListSelection(t)))),this._allMenuItems=e,this._list.splice(0,this._list.length,this._allMenuItems),this._list.length&&this.focusNext()}focusCondition(t){return!t.disabled&&t.kind==="action"}hide(t){this._delegate.onHide(t),this.cts.cancel(),this._contextViewService.hideContextView()}layout(t){const i=this._allMenuItems.filter((t=>t.kind==="header")).length,e=this._allMenuItems.length*this._actionLineHeight+i*this._headerLineHeight-i*this._actionLineHeight;this._list.layout(e);let s=t;if(this._allMenuItems.length>=50)s=380;else{const i=this._allMenuItems.map(((t,i)=>{const e=this.domNode.ownerDocument.getElementById(this._list.getElementID(i));if(e){e.style.width="auto";const t=e.getBoundingClientRect().width;return e.style.width="",t}return 0}));s=Math.max(...i,t)}const n=Math.min(e,.7*this.domNode.ownerDocument.body.clientHeight);return this._list.layout(n,s),this.domNode.style.height=`${n}px`,this._list.domFocus(),s}focusPrevious(){this._list.focusPrevious(1,!0,void 0,this.focusCondition)}focusNext(){this._list.focusNext(1,!0,void 0,this.focusCondition)}acceptSelected(t){const i=this._list.getFocus();if(i.length===0)return;const e=i[0],s=this._list.element(e);if(!this.focusCondition(s))return;const n=t?new O1:new R1;this._list.setSelection([e],n)}onListSelection(t){if(!t.elements.length)return;const i=t.elements[0];i.item&&this.focusCondition(i)?this._delegate.onSelect(i.item,t.browserEvent instanceof O1):this._list.setSelection([])}onFocus(){var t,i;const e=this._list.getFocus();if(e.length===0)return;const s=e[0],n=this._list.element(s);(i=(t=this._delegate).onFocus)===null||i===void 0||i.call(t,n.item)}async onListHover(t){const i=t.element;if(i&&i.item&&this.focusCondition(i)){if(this._delegate.onHover&&!i.disabled&&i.kind==="action"){const t=await this._delegate.onHover(i.item,this.cts.token);i.canPreview=t?t.canPreview:void 0}t.index&&this._list.splice(t.index,1,[i])}this._list.setFocus(typeof t.index=="number"?[t.index]:[])}onListClick(t){t.element&&this.focusCondition(t.element)&&this._list.setFocus([])}};function P1(t){return t.replace(/\r\n|\r|\n/g," ")}_1=E1([A1(4,rI),A1(5,NS)],_1);var N1=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},B1=function(t,i){return function(e,s){i(e,s,t)}};Iw("actionBar.toggledBackground",{dark:wb,light:wb,hcDark:wb,hcLight:wb},tt(0,"Background color for toggled action items in action bar."));const $1={Visible:new Ta("codeActionMenuVisible",!1,tt(0,"Whether the action widget list is visible"))},W1=_l("actionWidgetService");let j1=class extends Qi{get isVisible(){return $1.Visible.getValue(this._contextKeyService)||!1}constructor(t,i,e){super(),this._contextViewService=t,this._contextKeyService=i,this._instantiationService=e,this._list=this._register(new Yi)}show(t,i,e,s,n,r,o){const h=$1.Visible.bindTo(this._contextKeyService),c=this._instantiationService.createInstance(_1,t,i,e,s);this._contextViewService.showContextView({getAnchor:()=>n,render:t=>(h.set(!0),this._renderWidget(t,c,o??[])),onHide:t=>{h.reset(),this._onWidgetClosed(t)}},r,!1)}acceptSelected(t){var i;(i=this._list.value)===null||i===void 0||i.acceptSelected(t)}focusPrevious(){var t,i;(i=(t=this._list)===null||t===void 0?void 0:t.value)===null||i===void 0||i.focusPrevious()}focusNext(){var t,i;(i=(t=this._list)===null||t===void 0?void 0:t.value)===null||i===void 0||i.focusNext()}hide(){var t;(t=this._list.value)===null||t===void 0||t.hide(),this._list.clear()}_renderWidget(t,i,e){var s;const n=document.createElement("div");if(n.classList.add("action-widget"),t.appendChild(n),this._list.value=i,!this._list.value)throw new Error("List has no value");n.appendChild(this._list.value.domNode);const r=new Ji,o=document.createElement("div"),h=t.appendChild(o);h.classList.add("context-view-block"),r.add(sc(h,qc.MOUSE_DOWN,(t=>t.stopPropagation())));const c=document.createElement("div"),l=t.appendChild(c);l.classList.add("context-view-pointerBlock"),r.add(sc(l,qc.POINTER_MOVE,(()=>l.remove()))),r.add(sc(l,qc.MOUSE_DOWN,(()=>l.remove())));let a=0;if(e.length){const t=this._createActionBar(".action-widget-action-bar",e);t&&(n.appendChild(t.getContainer().parentElement),r.add(t),a=t.getContainer().offsetWidth)}const u=(s=this._list.value)===null||s===void 0?void 0:s.layout(a);n.style.width=`${u}px`;const d=r.add(Qc(t));return r.add(d.onDidBlur((()=>this.hide()))),r}_createActionBar(t,i){if(!i.length)return;const e=nl(t),s=new LW(e);return s.push(i,{icon:!1,label:!0}),s}_onWidgetClosed(t){var i;(i=this._list.value)===null||i===void 0||i.hide(t)}};j1=N1([B1(0,rI),B1(1,Ra),B1(2,Il)],j1),Nd(W1,j1,1);const H1=1100;nu(class extends su{constructor(){super({id:"hideCodeActionWidget",title:it(0,"Hide action widget"),precondition:$1.Visible,keybinding:{weight:H1,primary:9,secondary:[1033]}})}run(t){t.get(W1).hide()}}),nu(class extends su{constructor(){super({id:"selectPrevCodeAction",title:it(0,"Select previous action"),precondition:$1.Visible,keybinding:{weight:H1,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}})}run(t){const i=t.get(W1);i instanceof j1&&i.focusPrevious()}}),nu(class extends su{constructor(){super({id:"selectNextCodeAction",title:it(0,"Select next action"),precondition:$1.Visible,keybinding:{weight:H1,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}})}run(t){const i=t.get(W1);i instanceof j1&&i.focusNext()}}),nu(class extends su{constructor(){super({id:M1,title:it(0,"Accept selected action"),precondition:$1.Visible,keybinding:{weight:H1,primary:3,secondary:[2137]}})}run(t){const i=t.get(W1);i instanceof j1&&i.acceptSelected()}}),nu(class extends su{constructor(){super({id:L1,title:it(0,"Preview selected action"),precondition:$1.Visible,keybinding:{weight:H1,primary:2051}})}run(t){const i=t.get(W1);i instanceof j1&&i.acceptSelected(!0)}});const V1=new Ta("supportedCodeAction",""),z1="_typescript.applyFixAllCodeAction";class U1 extends Qi{constructor(t,i,e,s=250){super(),this._editor=t,this._markerService=i,this._signalChange=e,this._delay=s,this._autoTriggerTimer=this._register(new yo),this._register(this._markerService.onMarkerChanged((t=>this._onMarkerChanges(t)))),this._register(this._editor.onDidChangeCursorPosition((()=>this._tryAutoTrigger())))}trigger(t){const i=this._getRangeOfSelectionUnlessWhitespaceEnclosed(t);this._signalChange(i?{trigger:t,selection:i}:void 0)}_onMarkerChanges(t){const i=this._editor.getModel();i&&t.some((t=>kM(t,i.uri)))&&this._tryAutoTrigger()}_tryAutoTrigger(){this._autoTriggerTimer.cancelAndSet((()=>{this.trigger({type:2,triggerAction:Y0.Default})}),this._delay)}_getRangeOfSelectionUnlessWhitespaceEnclosed(t){if(!this._editor.hasModel())return;const i=this._editor.getSelection();if(t.type===1)return i;const e=this._editor.getOption(65).enabled;if(e!==fi.Off){if(e===fi.On)return i;if(e===fi.OnCode){if(!i.isEmpty())return i;const t=this._editor.getModel(),{lineNumber:e,column:s}=i.getPosition(),n=t.getLineContent(e);if(n.length===0)return;if(s===1){if(/\s/.test(n[0]))return}else if(s===t.getLineMaxColumn(e)){if(/\s/.test(n[n.length-1]))return}else if(/\s/.test(n[s-2])&&/\s/.test(n[s-1]))return}return i}}}var K1;(function(t){t.Empty={type:0},t.Triggered=class{constructor(t,i,e){this.trigger=t,this.position=i,this._cancellablePromise=e,this.type=1,this.actions=e.catch((t=>{if(Bi(t))return q1;throw t}))}cancel(){this._cancellablePromise.cancel()}}})(K1||(K1={}));const q1=Object.freeze({allActions:[],validActions:[],dispose:()=>{},documentation:[],hasAutoFix:!1,hasAIFix:!1,allAIFixes:!1});class G1 extends Qi{constructor(t,i,e,s,n,r){super(),this._editor=t,this._registry=i,this._markerService=e,this._progressService=n,this._configurationService=r,this._codeActionOracle=this._register(new Yi),this._state=K1.Empty,this._onDidChangeState=this._register(new le),this.onDidChangeState=this._onDidChangeState.event,this._disposed=!1,this._supportedCodeActions=V1.bindTo(s),this._register(this._editor.onDidChangeModel((()=>this._update()))),this._register(this._editor.onDidChangeModelLanguage((()=>this._update()))),this._register(this._registry.onDidChange((()=>this._update()))),this._register(this._editor.onDidChangeConfiguration((t=>{t.hasChanged(65)&&this._update()}))),this._update()}dispose(){this._disposed||(this._disposed=!0,super.dispose(),this.setState(K1.Empty,!0))}_settingEnabledNearbyQuickfixes(){var t;const i=(t=this._editor)===null||t===void 0?void 0:t.getModel();return!!this._configurationService&&this._configurationService.getValue("editor.codeActionWidget.includeNearbyQuickFixes",{resource:i==null?void 0:i.uri})}_update(){if(this._disposed)return;this._codeActionOracle.value=void 0,this.setState(K1.Empty);const t=this._editor.getModel();if(t&&this._registry.has(t)&&!this._editor.getOption(91)){const i=this._registry.all(t).flatMap((t=>{var i;return(i=t.providedCodeActionKinds)!==null&&i!==void 0?i:[]}));this._supportedCodeActions.set(i.join(" ")),this._codeActionOracle.value=new U1(this._editor,this._markerService,(i=>{var e;if(!i)return void this.setState(K1.Empty);const s=i.selection.getStartPosition(),n=uo((async e=>{var s,n,r,o,h,c,l,a,u,d;if(this._settingEnabledNearbyQuickfixes()&&i.trigger.type===1&&(i.trigger.triggerAction===Y0.QuickFix||!((n=(s=i.trigger.filter)===null||s===void 0?void 0:s.include)===null||n===void 0)&&n.contains(Q0.QuickFix))){const s=await u1(this._registry,t,i.selection,i.trigger,bN.None,e),n=[...s.allActions];if(e.isCancellationRequested)return q1;const f=(r=s.validActions)===null||r===void 0?void 0:r.some((t=>!!t.action.kind&&Q0.QuickFix.contains(new jX(t.action.kind)))),g=this._markerService.read({resource:t.uri});if(f){for(const t of s.validActions)!((h=(o=t.action.command)===null||o===void 0?void 0:o.arguments)===null||h===void 0)&&h.some((t=>typeof t=="string"&&t.includes(z1)))&&(t.action.diagnostics=[...g.filter((t=>t.relatedInformation))]);return{validActions:s.validActions,allActions:n,documentation:s.documentation,hasAutoFix:s.hasAutoFix,hasAIFix:s.hasAIFix,allAIFixes:s.allAIFixes,dispose:()=>{s.dispose()}}}if(!f&&g.length>0){const r=i.selection.getPosition();let o=r,h=Number.MAX_VALUE;const f=[...s.validActions];for(const p of g){const m=p.endColumn,w=p.endLineNumber,v=p.startLineNumber;if(w===r.lineNumber||v===r.lineNumber){o=new ks(w,m);const p={type:i.trigger.type,triggerAction:i.trigger.triggerAction,filter:{include:!((c=i.trigger.filter)===null||c===void 0)&&c.include?(l=i.trigger.filter)===null||l===void 0?void 0:l.include:Q0.QuickFix},autoApply:i.trigger.autoApply,context:{notAvailableMessage:((a=i.trigger.context)===null||a===void 0?void 0:a.notAvailableMessage)||"",position:o}},v=new Ss(o.lineNumber,o.column,o.lineNumber,o.column),b=await u1(this._registry,t,v,p,bN.None,e);if(b.validActions.length!==0){for(const t of b.validActions)!((d=(u=t.action.command)===null||u===void 0?void 0:u.arguments)===null||d===void 0)&&d.some((t=>typeof t=="string"&&t.includes(z1)))&&(t.action.diagnostics=[...g.filter((t=>t.relatedInformation))]);s.allActions.length===0&&n.push(...b.allActions),Math.abs(r.column-m)<h?f.unshift(...b.validActions):f.push(...b.validActions)}h=Math.abs(r.column-m)}}const p=f.filter(((t,i,e)=>e.findIndex((i=>i.action.title===t.action.title))===i));return p.sort(((t,i)=>t.action.isPreferred&&!i.action.isPreferred?-1:!t.action.isPreferred&&i.action.isPreferred||t.action.isAI&&!i.action.isAI?1:!t.action.isAI&&i.action.isAI?-1:0)),{validActions:p,allActions:n,documentation:s.documentation,hasAutoFix:s.hasAutoFix,hasAIFix:s.hasAIFix,allAIFixes:s.allAIFixes,dispose:()=>{s.dispose()}}}}return u1(this._registry,t,i.selection,i.trigger,bN.None,e)}));i.trigger.type===1&&((e=this._progressService)===null||e===void 0||e.showWhile(n,250));const r=new K1.Triggered(i.trigger,s,n);let o=!1;this._state.type===1&&(o=this._state.trigger.type===1&&r.type===1&&r.trigger.type===2&&this._state.position!==r.position),o||this.setState(r)}),void 0),this._codeActionOracle.value.trigger({type:2,triggerAction:Y0.Default})}else this._supportedCodeActions.reset()}trigger(t){var i;(i=this._codeActionOracle.value)===null||i===void 0||i.trigger(t)}setState(t,i){t!==this._state&&(this._state.type===1&&this._state.cancel(),this._state=t,i||this._disposed||this._onDidChangeState.fire(t))}}var Z1,J1=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Q1=function(t,i){return function(e,s){i(e,s,t)}};let Y1=Z1=class extends Qi{static get(t){return t.getContribution(Z1.ID)}constructor(t,i,e,s,n,r,o,h,c,l){super(),this._commandService=o,this._configurationService=h,this._actionWidgetService=c,this._instantiationService=l,this._activeCodeActions=this._register(new Yi),this._showDisabled=!1,this._disposed=!1,this._editor=t,this._model=this._register(new G1(this._editor,n.codeActionProvider,i,e,r,h)),this._register(this._model.onDidChangeState((t=>this.update(t)))),this._lightBulbWidget=new Hn((()=>{const t=this._editor.getContribution(D1.ID);return t&&this._register(t.onClick((t=>this.showCodeActionsFromLightbulb(t.actions,t)))),t})),this._resolver=s.createInstance(v1),this._register(this._editor.onDidLayoutChange((()=>this._actionWidgetService.hide())))}dispose(){this._disposed=!0,super.dispose()}async showCodeActionsFromLightbulb(t,i){if(t.allAIFixes&&t.validActions.length===1){const i=t.validActions[0],e=i.action.command;return e&&e.id==="inlineChat.start"&&e.arguments&&e.arguments.length>=1&&(e.arguments[0]={...e.arguments[0],autoSend:!1}),void await this._applyCodeAction(i,!1,!1,f1.FromAILightbulb)}await this.showCodeActionList(t,i,{includeDisabledActions:!1,fromLightbulb:!0})}showCodeActions(t,i,e){return this.showCodeActionList(i,e,{includeDisabledActions:!1,fromLightbulb:!1})}manualTriggerAtCurrentPosition(t,i,e,s){var n;if(!this._editor.hasModel())return;(n=A0.get(this._editor))===null||n===void 0||n.closeMessage();const r=this._editor.getPosition();this._trigger({type:1,triggerAction:i,filter:e,autoApply:s,context:{notAvailableMessage:t,position:r}})}_trigger(t){return this._model.trigger(t)}async _applyCodeAction(t,i,e,s){try{await this._instantiationService.invokeFunction(g1,t,s,{preview:e,editor:this._editor})}finally{i&&this._trigger({type:2,triggerAction:Y0.QuickFix,filter:{}})}}async update(t){var i,e,s,n,r,o,h;if(t.type!==1)return void((i=this._lightBulbWidget.rawValue)===null||i===void 0||i.hide());let c;try{c=await t.actions}catch(t){return void Ii(t)}if(!this._disposed)if((e=this._lightBulbWidget.value)===null||e===void 0||e.update(c,t.trigger,t.position),t.trigger.type===1){if(!((s=t.trigger.filter)===null||s===void 0)&&s.include){const i=this.tryGetValidActionToApply(t.trigger,c);if(i){try{(n=this._lightBulbWidget.value)===null||n===void 0||n.hide(),await this._applyCodeAction(i,!1,!1,f1.FromCodeActions)}finally{c.dispose()}return}if(t.trigger.context){const i=this.getInvalidActionThatWouldHaveBeenApplied(t.trigger,c);if(i&&i.action.disabled)return(r=A0.get(this._editor))===null||r===void 0||r.showMessage(i.action.disabled,t.trigger.context.position),void c.dispose()}}const i=!!(!((o=t.trigger.filter)===null||o===void 0)&&o.include);if(t.trigger.context&&(!c.allActions.length||!i&&!c.validActions.length))return(h=A0.get(this._editor))===null||h===void 0||h.showMessage(t.trigger.context.notAvailableMessage,t.trigger.context.position),this._activeCodeActions.value=c,void c.dispose();this._activeCodeActions.value=c,this.showCodeActionList(c,this.toCoords(t.position),{includeDisabledActions:i,fromLightbulb:!1})}else this._actionWidgetService.isVisible?c.dispose():this._activeCodeActions.value=c}getInvalidActionThatWouldHaveBeenApplied(t,i){if(i.allActions.length)return t.autoApply==="first"&&i.validActions.length===0||t.autoApply==="ifSingle"&&i.allActions.length===1?i.allActions.find((({action:t})=>t.disabled)):void 0}tryGetValidActionToApply(t,i){if(i.validActions.length)return t.autoApply==="first"&&i.validActions.length>0||t.autoApply==="ifSingle"&&i.validActions.length===1?i.validActions[0]:void 0}async showCodeActionList(t,i,e){const s=this._editor.createDecorationsCollection(),n=this._editor.getDomNode();if(!n)return;const r=e.includeDisabledActions&&(this._showDisabled||t.validActions.length===0)?t.allActions:t.validActions;if(!r.length)return;const o=ks.isIPosition(i)?this.toCoords(i):i,h={onSelect:async(t,i)=>{this._applyCodeAction(t,!0,!!i,f1.FromCodeActions),this._actionWidgetService.hide(),s.clear()},onHide:()=>{var t;(t=this._editor)===null||t===void 0||t.focus(),s.clear()},onHover:async(t,i)=>{var e;if(i.isCancellationRequested)return;let s=!1;const n=t.action.kind;if(n){const t=new jX(n);s=[Q0.RefactorExtract,Q0.RefactorInline,Q0.RefactorRewrite].some((i=>i.contains(t)))}return{canPreview:s||!!(!((e=t.action.edit)===null||e===void 0)&&e.edits.length)}},onFocus:t=>{var i,e;if(t&&t.action){const n=t.action.ranges,r=t.action.diagnostics;if(s.clear(),n&&n.length>0){const t=r&&(r==null?void 0:r.length)>1?r.map((t=>({range:t,options:Z1.DECORATION}))):n.map((t=>({range:t,options:Z1.DECORATION})));s.set(t)}else if(r&&r.length>0){const t=r.map((t=>({range:t,options:Z1.DECORATION})));s.set(t);const n=r[0];n.startLineNumber&&n.startColumn&&ow(tt(0,"Context: {0} at line {1} and column {2}.",(e=(i=this._editor.getModel())===null||i===void 0?void 0:i.getWordAtPosition({lineNumber:n.startLineNumber,column:n.startColumn}))===null||e===void 0?void 0:e.word,n.startLineNumber,n.startColumn))}}else s.clear()}};this._actionWidgetService.show("codeActionWidget",!0,function(t,i,e){if(!i)return t.map((t=>{var i;return{kind:"action",item:t,group:b1,disabled:!!t.action.disabled,label:t.action.disabled||t.action.title,canPreview:!!(!((i=t.action.edit)===null||i===void 0)&&i.edits.length)}}));const s=y1.map((t=>({group:t,actions:[]})));for(const i of t){const t=i.action.kind?new jX(i.action.kind):jX.None;for(const e of s)if(e.group.kind.contains(t)){e.actions.push(i);break}}const n=[];for(const t of s)if(t.actions.length){n.push({kind:"header",group:t.group});for(const i of t.actions){const s=t.group;n.push({kind:"action",item:i,group:i.action.isAI?{title:s.title,kind:s.kind,icon:As.sparkle}:s,label:i.action.title,disabled:!!i.action.disabled,keybinding:e(i.action)})}}return n}(r,this._shouldShowHeaders(),this._resolver.getResolver()),h,o,n,this._getActionBarActions(t,i,e))}toCoords(t){if(!this._editor.hasModel())return{x:0,y:0};this._editor.revealPosition(t,1),this._editor.render();const i=this._editor.getScrolledVisiblePosition(t),e=vc(this._editor.getDomNode());return{x:e.left+i.left,y:e.top+i.top+i.height}}_shouldShowHeaders(){var t;const i=(t=this._editor)===null||t===void 0?void 0:t.getModel();return this._configurationService.getValue("editor.codeActionWidget.showHeaders",{resource:i==null?void 0:i.uri})}_getActionBarActions(t,i,e){if(e.fromLightbulb)return[];const s=t.documentation.map((t=>{var i;return{id:t.id,label:t.title,tooltip:(i=t.tooltip)!==null&&i!==void 0?i:"",class:void 0,enabled:!0,run:()=>{var i;return this._commandService.executeCommand(t.id,...(i=t.arguments)!==null&&i!==void 0?i:[])}}}));return e.includeDisabledActions&&t.validActions.length>0&&t.allActions.length!==t.validActions.length&&s.push(this._showDisabled?{id:"hideMoreActions",label:tt(0,"Hide Disabled"),enabled:!0,tooltip:"",class:void 0,run:()=>(this._showDisabled=!1,this.showCodeActionList(t,i,e))}:{id:"showMoreActions",label:tt(0,"Show Disabled"),enabled:!0,tooltip:"",class:void 0,run:()=>(this._showDisabled=!0,this.showCodeActionList(t,i,e))}),s}};function X1(t){return ua.regex(V1.keys()[0],new RegExp("(\\s|^)"+Gn(t.value)+"\\b"))}Y1.ID="editor.contrib.codeActionController",Y1.DECORATION=xF.register({description:"quickfix-highlight",className:"quickfix-edit-highlight"}),Y1=Z1=J1([Q1(1,XW),Q1(2,Ra),Q1(3,Il),Q1(4,$p),Q1(5,yN),Q1(6,ql),Q1(7,Md),Q1(8,W1),Q1(9,Il)],Y1),RC(((t,i)=>{((t,e)=>{e&&i.addRule(`.monaco-editor ${t} { background-color: ${e}; }`)})(".quickfix-edit-highlight",t.getColor(kv));const e=t.getColor(Cv);e&&i.addRule(`.monaco-editor .quickfix-edit-highlight { border: 1px ${lk(t.type)?"dotted":"solid"} ${e}; box-sizing: border-box; }`)}));const t2={type:"object",defaultSnippets:[{body:{kind:""}}],properties:{kind:{type:"string",description:tt(0,"Kind of the code action to run.")},apply:{type:"string",description:tt(0,"Controls when the returned actions are applied."),default:"ifSingle",enum:["first","ifSingle","never"],enumDescriptions:[tt(0,"Always apply the first returned code action."),tt(0,"Apply the first returned code action if it is the only one."),tt(0,"Do not apply the returned code actions.")]},preferred:{type:"boolean",default:!1,description:tt(0,"Controls if only preferred code actions should be returned.")}}};function i2(t,i,e,s,n=Y0.Default){if(t.hasModel()){const r=Y1.get(t);r==null||r.manualTriggerAtCurrentPosition(i,n,e,s)}}Su(Y1.ID,Y1,3),Su(D1.ID,D1,4),ku(class extends mu{constructor(){super({id:s1,label:tt(0,"Quick Fix..."),alias:"Quick Fix...",precondition:ua.and(Ox.writable,Ox.hasCodeActionsProvider),kbOpts:{kbExpr:Ox.textInputFocus,primary:2137,weight:100}})}run(t,i){return i2(i,tt(0,"No code actions available"),void 0,void 0,Y0.QuickFix)}}),ku(class extends mu{constructor(){super({id:r1,label:tt(0,"Refactor..."),alias:"Refactor...",precondition:ua.and(Ox.writable,Ox.hasCodeActionsProvider),kbOpts:{kbExpr:Ox.textInputFocus,primary:3120,mac:{primary:1328},weight:100},contextMenuOpts:{group:"1_modification",order:2,when:ua.and(Ox.writable,X1(Q0.Refactor))},metadata:{description:"Refactor...",args:[{name:"args",schema:t2}]}})}run(t,i,e){const s=t1.fromUser(e,{kind:Q0.Refactor,apply:"never"});return i2(i,typeof(e==null?void 0:e.kind)=="string"?s.preferred?tt(0,"No preferred refactorings for '{0}' available",e.kind):tt(0,"No refactorings for '{0}' available",e.kind):s.preferred?tt(0,"No preferred refactorings available"):tt(0,"No refactorings available"),{include:Q0.Refactor.contains(s.kind)?s.kind:jX.None,onlyIncludePreferredActions:s.preferred},s.apply,Y0.Refactor)}}),ku(class extends mu{constructor(){super({id:o1,label:tt(0,"Source Action..."),alias:"Source Action...",precondition:ua.and(Ox.writable,Ox.hasCodeActionsProvider),contextMenuOpts:{group:"1_modification",order:2.1,when:ua.and(Ox.writable,X1(Q0.Source))},metadata:{description:"Source Action...",args:[{name:"args",schema:t2}]}})}run(t,i,e){const s=t1.fromUser(e,{kind:Q0.Source,apply:"never"});return i2(i,typeof(e==null?void 0:e.kind)=="string"?s.preferred?tt(0,"No preferred source actions for '{0}' available",e.kind):tt(0,"No source actions for '{0}' available",e.kind):s.preferred?tt(0,"No preferred source actions available"):tt(0,"No source actions available"),{include:Q0.Source.contains(s.kind)?s.kind:jX.None,includeSourceActions:!0,onlyIncludePreferredActions:s.preferred},s.apply,Y0.SourceAction)}}),ku(class extends mu{constructor(){super({id:h1,label:tt(0,"Organize Imports"),alias:"Organize Imports",precondition:ua.and(Ox.writable,X1(Q0.SourceOrganizeImports)),kbOpts:{kbExpr:Ox.textInputFocus,primary:1581,weight:100}})}run(t,i){return i2(i,tt(0,"No organize imports action available"),{include:Q0.SourceOrganizeImports,includeSourceActions:!0},"ifSingle",Y0.OrganizeImports)}}),ku(class extends mu{constructor(){super({id:n1,label:tt(0,"Auto Fix..."),alias:"Auto Fix...",precondition:ua.and(Ox.writable,X1(Q0.QuickFix)),kbOpts:{kbExpr:Ox.textInputFocus,primary:1625,mac:{primary:2649},weight:100}})}run(t,i){return i2(i,tt(0,"No auto fixes available"),{include:Q0.QuickFix,onlyIncludePreferredActions:!0},"ifSingle",Y0.AutoFix)}}),ku(class extends mu{constructor(){super({id:c1,label:tt(0,"Fix All"),alias:"Fix All",precondition:ua.and(Ox.writable,X1(Q0.SourceFixAll))})}run(t,i){return i2(i,tt(0,"No fix all action available"),{include:Q0.SourceFixAll,includeSourceActions:!0},"ifSingle",Y0.FixAll)}}),yu(new class extends pu{constructor(){super({id:e1,precondition:ua.and(Ox.writable,Ox.hasCodeActionsProvider),metadata:{description:"Trigger a code action",args:[{name:"args",schema:t2}]}})}runEditorCommand(t,i,e){const s=t1.fromUser(e,{kind:jX.Empty,apply:"ifSingle"});return i2(i,typeof(e==null?void 0:e.kind)=="string"?s.preferred?tt(0,"No preferred code actions for '{0}' available",e.kind):tt(0,"No code actions for '{0}' available",e.kind):s.preferred?tt(0,"No preferred code actions available"):tt(0,"No code actions available"),{include:s.kind,includeSourceActions:!0,onlyIncludePreferredActions:s.preferred},s.apply)}}),Va.as(Hd).registerConfiguration({...jP,properties:{"editor.codeActionWidget.showHeaders":{type:"boolean",scope:5,description:tt(0,"Enable/disable showing group headers in the Code Action menu."),default:!0}}}),Va.as(Hd).registerConfiguration({...jP,properties:{"editor.codeActionWidget.includeNearbyQuickFixes":{type:"boolean",scope:5,description:tt(0,"Enable/disable showing nearest Quick Fix within a line when not currently on a diagnostic."),default:!0}}});class e2{constructor(){this.lenses=[],this._disposables=new Ji}dispose(){this._disposables.dispose()}get isDisposed(){return this._disposables.isDisposed}add(t,i){this._disposables.add(t);for(const e of t.lenses)this.lenses.push({symbol:e,provider:i})}}async function s2(t,i,e){const s=t.ordered(i),n=new Map,r=new e2,o=s.map((async(t,s)=>{n.set(t,s);try{const s=await Promise.resolve(t.provideCodeLenses(i,e));s&&r.add(s,t)}catch(t){_i(t)}}));return await Promise.all(o),r.lenses=r.lenses.sort(((t,i)=>t.symbol.range.startLineNumber<i.symbol.range.startLineNumber?-1:t.symbol.range.startLineNumber>i.symbol.range.startLineNumber?1:n.get(t.provider)<n.get(i.provider)?-1:n.get(t.provider)>n.get(i.provider)?1:t.symbol.range.startColumn<i.symbol.range.startColumn?-1:t.symbol.range.startColumn>i.symbol.range.startColumn?1:0)),r}Gl.registerCommand("_executeCodeLensProvider",(function(t,...i){let[e,s]=i;j(as.isUri(e)),j(typeof s=="number"||!s);const{codeLensProvider:n}=t.get($p),r=t.get(Nl).getModel(e);if(!r)throw Wi();const o=[],h=new Ji;return s2(n,r,ve.None).then((t=>{h.add(t);const i=[];for(const e of t.lenses)s==null||e.symbol.command?o.push(e.symbol):s-- >0&&e.provider.resolveCodeLens&&i.push(Promise.resolve(e.provider.resolveCodeLens(r,e.symbol,ve.None)).then((t=>o.push(t||e.symbol))));return Promise.all(i)})).then((()=>o)).finally((()=>{setTimeout((()=>h.dispose()),100)}))}));var n2=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},r2=function(t,i){return function(e,s){i(e,s,t)}};const o2=_l("ICodeLensCache");class h2{constructor(t,i){this.lineCount=t,this.data=i}}let c2=class{constructor(t){this._fakeProvider=new class{provideCodeLenses(){throw new Error("not supported")}},this._cache=new Kf(20,.75),hc(Wn,(()=>t.remove("codelens/cache",1)));const i="codelens/cache2",e=t.get(i,1,"{}");this._deserialize(e),ne.once(t.onWillSaveState)((e=>{e.reason===rW.SHUTDOWN&&t.store(i,this._serialize(),1,1)}))}put(t,i){const e=i.lenses.map((t=>{var i;return{range:t.symbol.range,command:t.symbol.command&&{id:"",title:(i=t.symbol.command)===null||i===void 0?void 0:i.title}}})),s=new e2;s.add({lenses:e,dispose:()=>{}},this._fakeProvider);const n=new h2(t.getLineCount(),s);this._cache.set(t.uri.toString(),n)}get(t){const i=this._cache.get(t.uri.toString());return i&&i.lineCount===t.getLineCount()?i.data:void 0}delete(t){this._cache.delete(t.uri.toString())}_serialize(){const t=Object.create(null);for(const[i,e]of this._cache){const s=new Set;for(const t of e.data.lenses)s.add(t.symbol.range.startLineNumber);t[i]={lineCount:e.lineCount,lines:[...s.values()]}}return JSON.stringify(t)}_deserialize(t){try{const i=JSON.parse(t);for(const t in i){const e=i[t],s=[];for(const t of e.lines)s.push({range:new Cs(t,1,t,11)});const n=new e2;n.add({lenses:s,dispose(){}},this._fakeProvider),this._cache.set(t,new h2(e.lineCount,n))}}catch{}}};c2=n2([r2(0,nW)],c2),Nd(o2,c2,1);class l2{constructor(t,i,e){this.afterColumn=1073741824,this.afterLineNumber=t,this.heightInPx=i,this._onHeight=e,this.suppressMouseDown=!0,this.domNode=document.createElement("div")}onComputedHeight(t){this._lastHeight===void 0?this._lastHeight=t:this._lastHeight!==t&&(this._lastHeight=t,this._onHeight())}isVisible(){return this._lastHeight!==0&&this.domNode.hasAttribute("monaco-visible-view-zone")}}class a2{constructor(t,i){this.allowEditorOverflow=!1,this.suppressMouseDown=!0,this._commands=new Map,this._isEmpty=!0,this._editor=t,this._id="codelens.widget-"+a2._idPool++,this.updatePosition(i),this._domNode=document.createElement("span"),this._domNode.className="codelens-decoration"}withCommands(t,i){this._commands.clear();const e=[];let s=!1;for(let i=0;i<t.length;i++){const n=t[i];if(n&&(s=!0,n.command)){const s=bI(n.command.title.trim());if(n.command.id){const t="c"+a2._idPool++;e.push(nl("a",{id:t,title:n.command.tooltip,role:"button"},...s)),this._commands.set(t,n.command)}else e.push(nl("span",{title:n.command.tooltip},...s));i+1<t.length&&e.push(nl("span",void 0," | "))}}s?(tl(this._domNode,...e),this._isEmpty&&i&&this._domNode.classList.add("fadein"),this._isEmpty=!1):tl(this._domNode,nl("span",void 0,"no commands"))}getCommand(t){return t.parentElement===this._domNode?this._commands.get(t.id):void 0}getId(){return this._id}getDomNode(){return this._domNode}updatePosition(t){const i=this._editor.getModel().getLineFirstNonWhitespaceColumn(t);this._widgetPosition={position:{lineNumber:t,column:i},preference:[1]}}getPosition(){return this._widgetPosition||null}}a2._idPool=0;class u2{constructor(){this._removeDecorations=[],this._addDecorations=[],this._addDecorationsCallbacks=[]}addDecoration(t,i){this._addDecorations.push(t),this._addDecorationsCallbacks.push(i)}removeDecoration(t){this._removeDecorations.push(t)}commit(t){const i=t.deltaDecorations(this._removeDecorations,this._addDecorations);for(let t=0,e=i.length;t<e;t++)this._addDecorationsCallbacks[t](i[t])}}const d2=xF.register({collapseOnReplaceEdit:!0,description:"codelens"});class f2{constructor(t,i,e,s,n,r){let o;this._isDisposed=!1,this._editor=i,this._data=t,this._decorationIds=[];const h=[];this._data.forEach(((t,i)=>{t.symbol.command&&h.push(t.symbol),e.addDecoration({range:t.symbol.range,options:d2},(t=>this._decorationIds[i]=t)),o=o?Cs.plusRange(o,t.symbol.range):Cs.lift(t.symbol.range)})),this._viewZone=new l2(o.startLineNumber-1,n,r),this._viewZoneId=s.addZone(this._viewZone),h.length>0&&(this._createContentWidgetIfNecessary(),this._contentWidget.withCommands(h,!1))}_createContentWidgetIfNecessary(){this._contentWidget?this._editor.layoutContentWidget(this._contentWidget):(this._contentWidget=new a2(this._editor,this._viewZone.afterLineNumber+1),this._editor.addContentWidget(this._contentWidget))}dispose(t,i){this._decorationIds.forEach(t.removeDecoration,t),this._decorationIds=[],i==null||i.removeZone(this._viewZoneId),this._contentWidget&&(this._editor.removeContentWidget(this._contentWidget),this._contentWidget=void 0),this._isDisposed=!0}isDisposed(){return this._isDisposed}isValid(){return this._decorationIds.some(((t,i)=>{const e=this._editor.getModel().getDecorationRange(t),s=this._data[i].symbol;return!(!e||Cs.isEmpty(s.range)!==e.isEmpty())}))}updateCodeLensSymbols(t,i){this._decorationIds.forEach(i.removeDecoration,i),this._decorationIds=[],this._data=t,this._data.forEach(((t,e)=>{i.addDecoration({range:t.symbol.range,options:d2},(t=>this._decorationIds[e]=t))}))}updateHeight(t,i){this._viewZone.heightInPx=t,i.layoutZone(this._viewZoneId),this._contentWidget&&this._editor.layoutContentWidget(this._contentWidget)}computeIfNecessary(t){if(!this._viewZone.isVisible())return null;for(let i=0;i<this._decorationIds.length;i++){const e=t.getDecorationRange(this._decorationIds[i]);e&&(this._data[i].symbol.range=e)}return this._data}updateCommands(t){this._createContentWidgetIfNecessary(),this._contentWidget.withCommands(t,!0);for(let i=0;i<this._data.length;i++){const e=t[i];if(e){const{symbol:t}=this._data[i];t.command=e.command||t.command}}}getCommand(t){var i;return(i=this._contentWidget)===null||i===void 0?void 0:i.getCommand(t)}getLineNumber(){const t=this._editor.getModel().getDecorationRange(this._decorationIds[0]);return t?t.startLineNumber:-1}update(t){if(this.isValid()){const i=this._editor.getModel().getDecorationRange(this._decorationIds[0]);i&&(this._viewZone.afterLineNumber=i.startLineNumber-1,t.layoutZone(this._viewZoneId),this._contentWidget&&(this._contentWidget.updatePosition(i.startLineNumber),this._editor.layoutContentWidget(this._contentWidget)))}}}var g2=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},p2=function(t,i){return function(e,s){i(e,s,t)}};let m2=class{constructor(t,i,e,s,n,r){this._editor=t,this._languageFeaturesService=i,this._commandService=s,this._notificationService=n,this._codeLensCache=r,this._disposables=new Ji,this._localToDispose=new Ji,this._lenses=[],this._oldCodeLensModels=new Ji,this._provideCodeLensDebounce=e.for(i.codeLensProvider,"CodeLensProvide",{min:250}),this._resolveCodeLensesDebounce=e.for(i.codeLensProvider,"CodeLensResolve",{min:250,salt:"resolve"}),this._resolveCodeLensesScheduler=new Co((()=>this._resolveCodeLensesInViewport()),this._resolveCodeLensesDebounce.default()),this._disposables.add(this._editor.onDidChangeModel((()=>this._onModelChange()))),this._disposables.add(this._editor.onDidChangeModelLanguage((()=>this._onModelChange()))),this._disposables.add(this._editor.onDidChangeConfiguration((t=>{(t.hasChanged(50)||t.hasChanged(19)||t.hasChanged(18))&&this._updateLensStyle(),t.hasChanged(17)&&this._onModelChange()}))),this._disposables.add(i.codeLensProvider.onDidChange(this._onModelChange,this)),this._onModelChange(),this._updateLensStyle()}dispose(){var t;this._localDispose(),this._disposables.dispose(),this._oldCodeLensModels.dispose(),(t=this._currentCodeLensModel)===null||t===void 0||t.dispose()}_getLayoutInfo(){const t=Math.max(1.3,this._editor.getOption(67)/this._editor.getOption(52));let i=this._editor.getOption(19);return(!i||i<5)&&(i=.9*this._editor.getOption(52)|0),{fontSize:i,codeLensHeight:i*t|0}}_updateLensStyle(){const{codeLensHeight:t,fontSize:i}=this._getLayoutInfo(),e=this._editor.getOption(18),s=this._editor.getOption(50),{style:n}=this._editor.getContainerDomNode();n.setProperty("--vscode-editorCodeLens-lineHeight",`${t}px`),n.setProperty("--vscode-editorCodeLens-fontSize",`${i}px`),n.setProperty("--vscode-editorCodeLens-fontFeatureSettings",s.fontFeatureSettings),e&&(n.setProperty("--vscode-editorCodeLens-fontFamily",e),n.setProperty("--vscode-editorCodeLens-fontFamilyDefault",Li.fontFamily)),this._editor.changeViewZones((i=>{for(const e of this._lenses)e.updateHeight(t,i)}))}_localDispose(){var t,i,e;(t=this._getCodeLensModelPromise)===null||t===void 0||t.cancel(),this._getCodeLensModelPromise=void 0,(i=this._resolveCodeLensesPromise)===null||i===void 0||i.cancel(),this._resolveCodeLensesPromise=void 0,this._localToDispose.clear(),this._oldCodeLensModels.clear(),(e=this._currentCodeLensModel)===null||e===void 0||e.dispose()}_onModelChange(){this._localDispose();const t=this._editor.getModel();if(!t||!this._editor.getOption(17)||t.isTooLargeForTokenization())return;const i=this._codeLensCache.get(t);if(i&&this._renderCodeLensSymbols(i),!this._languageFeaturesService.codeLensProvider.has(t))return void(i&&vo((()=>{const e=this._codeLensCache.get(t);i===e&&(this._codeLensCache.delete(t),this._onModelChange())}),3e4,this._localToDispose));for(const i of this._languageFeaturesService.codeLensProvider.all(t))if(typeof i.onDidChange=="function"){const t=i.onDidChange((()=>e.schedule()));this._localToDispose.add(t)}const e=new Co((()=>{var i;const s=Date.now();(i=this._getCodeLensModelPromise)===null||i===void 0||i.cancel(),this._getCodeLensModelPromise=uo((i=>s2(this._languageFeaturesService.codeLensProvider,t,i))),this._getCodeLensModelPromise.then((i=>{this._currentCodeLensModel&&this._oldCodeLensModels.add(this._currentCodeLensModel),this._currentCodeLensModel=i,this._codeLensCache.put(t,i);const n=this._provideCodeLensDebounce.update(t,Date.now()-s);e.delay=n,this._renderCodeLensSymbols(i),this._resolveCodeLensesInViewportSoon()}),Ii)}),this._provideCodeLensDebounce.get(t));this._localToDispose.add(e),this._localToDispose.add(Zi((()=>this._resolveCodeLensesScheduler.cancel()))),this._localToDispose.add(this._editor.onDidChangeModelContent((()=>{var t;this._editor.changeDecorations((t=>{this._editor.changeViewZones((i=>{const e=[];let s=-1;this._lenses.forEach((t=>{t.isValid()&&s!==t.getLineNumber()?(t.update(i),s=t.getLineNumber()):e.push(t)}));const n=new u2;e.forEach((t=>{t.dispose(n,i),this._lenses.splice(this._lenses.indexOf(t),1)})),n.commit(t)}))})),e.schedule(),this._resolveCodeLensesScheduler.cancel(),(t=this._resolveCodeLensesPromise)===null||t===void 0||t.cancel(),this._resolveCodeLensesPromise=void 0}))),this._localToDispose.add(this._editor.onDidFocusEditorWidget((()=>{e.schedule()}))),this._localToDispose.add(this._editor.onDidBlurEditorText((()=>{e.cancel()}))),this._localToDispose.add(this._editor.onDidScrollChange((t=>{t.scrollTopChanged&&this._lenses.length>0&&this._resolveCodeLensesInViewportSoon()}))),this._localToDispose.add(this._editor.onDidLayoutChange((()=>{this._resolveCodeLensesInViewportSoon()}))),this._localToDispose.add(Zi((()=>{if(this._editor.getModel()){const t=xq.capture(this._editor);this._editor.changeDecorations((t=>{this._editor.changeViewZones((i=>{this._disposeAllLenses(t,i)}))})),t.restore(this._editor)}else this._disposeAllLenses(void 0,void 0)}))),this._localToDispose.add(this._editor.onMouseDown((t=>{if(t.target.type!==9)return;let i=t.target.element;if((i==null?void 0:i.tagName)==="SPAN"&&(i=i.parentElement),(i==null?void 0:i.tagName)==="A")for(const t of this._lenses){const e=t.getCommand(i);if(e){this._commandService.executeCommand(e.id,...e.arguments||[]).catch((t=>this._notificationService.error(t)));break}}}))),e.schedule()}_disposeAllLenses(t,i){const e=new u2;for(const t of this._lenses)t.dispose(e,i);t&&e.commit(t),this._lenses.length=0}_renderCodeLensSymbols(t){if(!this._editor.hasModel())return;const i=this._editor.getModel().getLineCount(),e=[];let s;for(const n of t.lenses){const t=n.symbol.range.startLineNumber;t<1||t>i||(s&&s[s.length-1].symbol.range.startLineNumber===t?s.push(n):(s=[n],e.push(s)))}if(!e.length&&!this._lenses.length)return;const n=xq.capture(this._editor),r=this._getLayoutInfo();this._editor.changeDecorations((t=>{this._editor.changeViewZones((i=>{const s=new u2;let n=0,o=0;for(;o<e.length&&n<this._lenses.length;){const t=e[o][0].symbol.range.startLineNumber,h=this._lenses[n].getLineNumber();h<t?(this._lenses[n].dispose(s,i),this._lenses.splice(n,1)):h===t?(this._lenses[n].updateCodeLensSymbols(e[o],s),o++,n++):(this._lenses.splice(n,0,new f2(e[o],this._editor,s,i,r.codeLensHeight,(()=>this._resolveCodeLensesInViewportSoon()))),n++,o++)}for(;n<this._lenses.length;)this._lenses[n].dispose(s,i),this._lenses.splice(n,1);for(;o<e.length;)this._lenses.push(new f2(e[o],this._editor,s,i,r.codeLensHeight,(()=>this._resolveCodeLensesInViewportSoon()))),o++;s.commit(t)}))})),n.restore(this._editor)}_resolveCodeLensesInViewportSoon(){this._editor.getModel()&&this._resolveCodeLensesScheduler.schedule()}_resolveCodeLensesInViewport(){var t;(t=this._resolveCodeLensesPromise)===null||t===void 0||t.cancel(),this._resolveCodeLensesPromise=void 0;const i=this._editor.getModel();if(!i)return;const e=[],s=[];if(this._lenses.forEach((t=>{const n=t.computeIfNecessary(i);n&&(e.push(n),s.push(t))})),e.length===0)return;const n=Date.now(),r=uo((t=>{const n=e.map(((e,n)=>{const r=new Array(e.length),o=e.map(((e,s)=>e.symbol.command||typeof e.provider.resolveCodeLens!="function"?(r[s]=e.symbol,Promise.resolve(void 0)):Promise.resolve(e.provider.resolveCodeLens(i,e.symbol,t)).then((t=>{r[s]=t}),_i)));return Promise.all(o).then((()=>{t.isCancellationRequested||s[n].isDisposed()||s[n].updateCommands(r)}))}));return Promise.all(n)}));this._resolveCodeLensesPromise=r,this._resolveCodeLensesPromise.then((()=>{const t=this._resolveCodeLensesDebounce.update(i,Date.now()-n);this._resolveCodeLensesScheduler.delay=t,this._currentCodeLensModel&&this._codeLensCache.put(i,this._currentCodeLensModel),this._oldCodeLensModels.clear(),r===this._resolveCodeLensesPromise&&(this._resolveCodeLensesPromise=void 0)}),(t=>{Ii(t),r===this._resolveCodeLensesPromise&&(this._resolveCodeLensesPromise=void 0)}))}async getModel(){var t;return await this._getCodeLensModelPromise,await this._resolveCodeLensesPromise,!((t=this._currentCodeLensModel)===null||t===void 0)&&t.isDisposed?void 0:this._currentCodeLensModel}};m2.ID="css.editor.codeLens",m2=g2([p2(1,$p),p2(2,lO),p2(3,ql),p2(4,gR),p2(5,o2)],m2),Su(m2.ID,m2,1),ku(class extends mu{constructor(){super({id:"codelens.showLensesInCurrentLine",precondition:Ox.hasCodeLensProvider,label:tt(0,"Show CodeLens Commands For Current Line"),alias:"Show CodeLens Commands For Current Line"})}async run(t,i){if(!i.hasModel())return;const e=t.get(vj),s=t.get(ql),n=t.get(gR),r=i.getSelection().positionLineNumber,o=i.getContribution(m2.ID);if(!o)return;const h=await o.getModel();if(!h)return;const c=[];for(const t of h.lenses)t.symbol.command&&t.symbol.range.startLineNumber===r&&c.push({label:t.symbol.command.title,command:t.symbol.command});if(c.length===0)return;const l=await e.pick(c,{canPickMany:!1,placeHolder:tt(0,"Select a command")});if(!l)return;let a=l.command;if(h.isDisposed){const t=await o.getModel(),i=t==null?void 0:t.lenses.find((t=>{var i;return t.symbol.range.startLineNumber===r&&((i=t.symbol.command)===null||i===void 0?void 0:i.title)===a.title}));if(!i||!i.symbol.command)return;a=i.symbol.command}try{await s.executeCommand(a.id,...a.arguments||[])}catch(t){n.error(t)}}});var w2=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},v2=function(t,i){return function(e,s){i(e,s,t)}};class b2{constructor(t,i){this._editorWorkerClient=new Jp(t,!1,"editorWorkerService",i)}async provideDocumentColors(t,i){return this._editorWorkerClient.computeDefaultDocumentColors(t.uri)}provideColorPresentations(t,i,e){const s=i.range,n=i.color,r=n.alpha,o=new kp(new vp(Math.round(255*n.red),Math.round(255*n.green),Math.round(255*n.blue),r)),h=r?kp.Format.CSS.formatRGB(o):kp.Format.CSS.formatRGBA(o),c=r?kp.Format.CSS.formatHSL(o):kp.Format.CSS.formatHSLA(o),l=r?kp.Format.CSS.formatHex(o):kp.Format.CSS.formatHexA(o),a=[];return a.push({label:h,textEdit:{range:s,text:h}}),a.push({label:c,textEdit:{range:s,text:c}}),a.push({label:l,textEdit:{range:s,text:l}}),a}}let y2=class extends Qi{constructor(t,i,e){super(),this._register(e.colorProvider.register("*",new b2(t,i)))}};async function k2(t,i,e,s=!0){return E2(new S2,t,i,e,s)}function C2(t,i,e,s){return Promise.resolve(e.provideColorPresentations(t,i,s))}y2=w2([v2(0,Nl),v2(1,cf),v2(2,$p)],y2),sq(y2);class S2{constructor(){}async compute(t,i,e,s){const n=await t.provideDocumentColors(i,e);if(Array.isArray(n))for(const i of n)s.push({colorInfo:i,provider:t});return Array.isArray(n)}}class x2{constructor(){}async compute(t,i,e,s){const n=await t.provideDocumentColors(i,e);if(Array.isArray(n))for(const t of n)s.push({range:t.range,color:[t.color.red,t.color.green,t.color.blue,t.color.alpha]});return Array.isArray(n)}}class D2{constructor(t){this.colorInfo=t}async compute(t,i,e,s){const n=await t.provideColorPresentations(i,this.colorInfo,ve.None);return Array.isArray(n)&&s.push(...n),Array.isArray(n)}}async function E2(t,i,e,s,n){let r,o=!1;const h=[],c=i.ordered(e);for(let i=c.length-1;i>=0;i--){const n=c[i];if(n instanceof b2)r=n;else try{await t.compute(n,e,s,h)&&(o=!0)}catch(t){_i(t)}}return o?h:r&&n?(await t.compute(r,e,s,h),h):[]}function A2(t,i){const{colorProvider:e}=t.get($p),s=t.get(Nl).getModel(i);if(!s)throw Wi();return{model:s,colorProviderRegistry:e,isDefaultColorDecoratorsEnabled:t.get(Md).getValue("editor.defaultColorDecorators",{resource:i})}}Gl.registerCommand("_executeDocumentColorProvider",(function(t,...i){const[e]=i;if(!(e instanceof as))throw Wi();const{model:s,colorProviderRegistry:n,isDefaultColorDecoratorsEnabled:r}=A2(t,e);return E2(new x2,n,s,ve.None,r)})),Gl.registerCommand("_executeColorPresentationProvider",(function(t,...i){const[e,s]=i,{uri:n,range:r}=s;if(!(n instanceof as&&Array.isArray(e)&&e.length===4&&Cs.isIRange(r)))throw Wi();const{model:o,colorProviderRegistry:h,isDefaultColorDecoratorsEnabled:c}=A2(t,n),[l,a,u,d]=e;return E2(new D2({range:r,color:{red:l,green:a,blue:u,alpha:d}}),h,o,ve.None,c)}));var M2,L2=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},F2=function(t,i){return function(e,s){i(e,s,t)}};const T2=Object.create({});let R2=M2=class extends Qi{constructor(t,i,e,s){super(),this._editor=t,this._configurationService=i,this._languageFeaturesService=e,this._localToDispose=this._register(new Ji),this._decorationsIds=[],this._colorDatas=new Map,this._colorDecoratorIds=this._editor.createDecorationsCollection(),this._ruleFactory=new Gy(this._editor),this._decoratorLimitReporter=new O2,this._colorDecorationClassRefs=this._register(new Ji),this._debounceInformation=s.for(e.colorProvider,"Document Colors",{min:M2.RECOMPUTE_TIME}),this._register(t.onDidChangeModel((()=>{this._isColorDecoratorsEnabled=this.isEnabled(),this.updateColors()}))),this._register(t.onDidChangeModelLanguage((()=>this.updateColors()))),this._register(e.colorProvider.onDidChange((()=>this.updateColors()))),this._register(t.onDidChangeConfiguration((t=>{const i=this._isColorDecoratorsEnabled;this._isColorDecoratorsEnabled=this.isEnabled(),this._isDefaultColorDecoratorsEnabled=this._editor.getOption(147);const e=i!==this._isColorDecoratorsEnabled||t.hasChanged(21),s=t.hasChanged(147);(e||s)&&(this._isColorDecoratorsEnabled?this.updateColors():this.removeAllDecorations())}))),this._timeoutTimer=null,this._computePromise=null,this._isColorDecoratorsEnabled=this.isEnabled(),this._isDefaultColorDecoratorsEnabled=this._editor.getOption(147),this.updateColors()}isEnabled(){const t=this._editor.getModel();if(!t)return!1;const i=t.getLanguageId(),e=this._configurationService.getValue(i);if(e&&typeof e=="object"){const t=e.colorDecorators;if(t&&t.enable!==void 0&&!t.enable)return t.enable}return this._editor.getOption(20)}static get(t){return t.getContribution(this.ID)}dispose(){this.stop(),this.removeAllDecorations(),super.dispose()}updateColors(){if(this.stop(),!this._isColorDecoratorsEnabled)return;const t=this._editor.getModel();t&&this._languageFeaturesService.colorProvider.has(t)&&(this._localToDispose.add(this._editor.onDidChangeModelContent((()=>{this._timeoutTimer||(this._timeoutTimer=new yo,this._timeoutTimer.cancelAndSet((()=>{this._timeoutTimer=null,this.beginCompute()}),this._debounceInformation.get(t)))}))),this.beginCompute())}async beginCompute(){this._computePromise=uo((async t=>{const i=this._editor.getModel();if(!i)return[];const e=new se(!1),s=await k2(this._languageFeaturesService.colorProvider,i,t,this._isDefaultColorDecoratorsEnabled);return this._debounceInformation.update(i,e.elapsed()),s}));try{const t=await this._computePromise;this.updateDecorations(t),this.updateColorDecorators(t),this._computePromise=null}catch(t){Ii(t)}}stop(){this._timeoutTimer&&(this._timeoutTimer.cancel(),this._timeoutTimer=null),this._computePromise&&(this._computePromise.cancel(),this._computePromise=null),this._localToDispose.clear()}updateDecorations(t){const i=t.map((t=>({range:{startLineNumber:t.colorInfo.range.startLineNumber,startColumn:t.colorInfo.range.startColumn,endLineNumber:t.colorInfo.range.endLineNumber,endColumn:t.colorInfo.range.endColumn},options:xF.EMPTY})));this._editor.changeDecorations((e=>{this._decorationsIds=e.deltaDecorations(this._decorationsIds,i),this._colorDatas=new Map,this._decorationsIds.forEach(((i,e)=>this._colorDatas.set(i,t[e])))}))}updateColorDecorators(t){this._colorDecorationClassRefs.clear();const i=[],e=this._editor.getOption(21);for(let s=0;s<t.length&&i.length<e;s++){const{red:e,green:n,blue:r,alpha:o}=t[s].colorInfo.color,h=new vp(Math.round(255*e),Math.round(255*n),Math.round(255*r),o),c=`rgba(${h.r}, ${h.g}, ${h.b}, ${h.a})`,l=this._colorDecorationClassRefs.add(this._ruleFactory.createClassNameRef({backgroundColor:c}));i.push({range:{startLineNumber:t[s].colorInfo.range.startLineNumber,startColumn:t[s].colorInfo.range.startColumn,endLineNumber:t[s].colorInfo.range.endLineNumber,endColumn:t[s].colorInfo.range.endColumn},options:{description:"colorDetector",before:{content:" ",inlineClassName:`${l.className} colorpicker-color-decoration`,inlineClassNameAffectsLetterSpacing:!0,attachedData:T2}}})}const s=e<t.length&&e;this._decoratorLimitReporter.update(t.length,s),this._colorDecoratorIds.set(i)}removeAllDecorations(){this._editor.removeDecorations(this._decorationsIds),this._decorationsIds=[],this._colorDecoratorIds.clear(),this._colorDecorationClassRefs.clear()}getColorData(t){const i=this._editor.getModel();if(!i)return null;const e=i.getDecorationsInRange(Cs.fromPositions(t,t)).filter((t=>this._colorDatas.has(t.id)));return e.length===0?null:this._colorDatas.get(e[0].id)}isColorDecoration(t){return this._colorDecoratorIds.has(t)}};R2.ID="editor.contrib.colorDetector",R2.RECOMPUTE_TIME=1e3,R2=M2=L2([F2(1,Md),F2(2,$p),F2(3,lO)],R2);class O2{constructor(){this._onDidChange=new le,this._computed=0,this._limited=!1}update(t,i){t===this._computed&&i===this._limited||(this._computed=t,this._limited=i,this._onDidChange.fire())}}Su(R2.ID,R2,1);class I2{get color(){return this._color}set color(t){this._color.equals(t)||(this._color=t,this._onDidChangeColor.fire(t))}get presentation(){return this.colorPresentations[this.presentationIndex]}get colorPresentations(){return this._colorPresentations}set colorPresentations(t){this._colorPresentations=t,this.presentationIndex>t.length-1&&(this.presentationIndex=0),this._onDidChangePresentation.fire(this.presentation)}constructor(t,i,e){this.presentationIndex=e,this._onColorFlushed=new le,this.onColorFlushed=this._onColorFlushed.event,this._onDidChangeColor=new le,this.onDidChangeColor=this._onDidChangeColor.event,this._onDidChangePresentation=new le,this.onDidChangePresentation=this._onDidChangePresentation.event,this.originalColor=t,this._color=t,this._colorPresentations=i}selectNextColorPresentation(){this.presentationIndex=(this.presentationIndex+1)%this.colorPresentations.length,this.flushColor(),this._onDidChangePresentation.fire(this.presentation)}guessColorPresentation(t,i){let e=-1;for(let t=0;t<this.colorPresentations.length;t++)if(i.toLowerCase()===this.colorPresentations[t].label){e=t;break}if(e===-1){const t=i.split("(")[0].toLowerCase();for(let i=0;i<this.colorPresentations.length;i++)if(this.colorPresentations[i].label.toLowerCase().startsWith(t)){e=i;break}}e!==-1&&e!==this.presentationIndex&&(this.presentationIndex=e,this._onDidChangePresentation.fire(this.presentation))}flushColor(){this._onColorFlushed.fire(this._color)}}const _2=nl;class P2 extends Qi{constructor(t,i,e,s=!1){super(),this.model=i,this.showingStandaloneColorPicker=s,this._closeButton=null,this._domNode=_2(".colorpicker-header"),Yc(t,this._domNode),this._pickedColorNode=Yc(this._domNode,_2(".picked-color")),Yc(this._pickedColorNode,_2("span.codicon.codicon-color-mode")),this._pickedColorPresentation=Yc(this._pickedColorNode,document.createElement("span")),this._pickedColorPresentation.classList.add("picked-color-presentation");const n=tt(0,"Click to toggle color options (rgb/hsl/hex)");this._pickedColorNode.setAttribute("title",n),this._originalColorNode=Yc(this._domNode,_2(".original-color")),this._originalColorNode.style.backgroundColor=kp.Format.CSS.format(this.model.originalColor)||"",this.backgroundColor=e.getColorTheme().getColor(xv)||kp.white,this._register(e.onDidColorThemeChange((t=>{this.backgroundColor=t.getColor(xv)||kp.white}))),this._register(sc(this._pickedColorNode,qc.CLICK,(()=>this.model.selectNextColorPresentation()))),this._register(sc(this._originalColorNode,qc.CLICK,(()=>{this.model.color=this.model.originalColor,this.model.flushColor()}))),this._register(i.onDidChangeColor(this.onDidChangeColor,this)),this._register(i.onDidChangePresentation(this.onDidChangePresentation,this)),this._pickedColorNode.style.backgroundColor=kp.Format.CSS.format(i.color)||"",this._pickedColorNode.classList.toggle("light",i.color.rgba.a<.5?this.backgroundColor.isLighter():i.color.isLighter()),this.onDidChangeColor(this.model.color),this.showingStandaloneColorPicker&&(this._domNode.classList.add("standalone-colorpicker"),this._closeButton=this._register(new N2(this._domNode)))}get closeButton(){return this._closeButton}get pickedColorNode(){return this._pickedColorNode}get originalColorNode(){return this._originalColorNode}onDidChangeColor(t){this._pickedColorNode.style.backgroundColor=kp.Format.CSS.format(t)||"",this._pickedColorNode.classList.toggle("light",t.rgba.a<.5?this.backgroundColor.isLighter():t.isLighter()),this.onDidChangePresentation()}onDidChangePresentation(){this._pickedColorPresentation.textContent=this.model.presentation?this.model.presentation.label:""}}class N2 extends Qi{constructor(t){super(),this._onClicked=this._register(new le),this.onClicked=this._onClicked.event,this._button=document.createElement("div"),this._button.classList.add("close-button"),Yc(t,this._button);const i=document.createElement("div");i.classList.add("close-button-inner-div"),Yc(this._button,i),Yc(i,_2(".button"+Kl.asCSSSelector(qU("color-picker-close",As.close,tt(0,"Icon to close the color picker"))))).classList.add("close-icon"),this._register(sc(this._button,qc.CLICK,(()=>{this._onClicked.fire()})))}}class B2 extends Qi{constructor(t,i,e,s=!1){super(),this.model=i,this.pixelRatio=e,this._insertButton=null,this._domNode=_2(".colorpicker-body"),Yc(t,this._domNode),this._saturationBox=new $2(this._domNode,this.model,this.pixelRatio),this._register(this._saturationBox),this._register(this._saturationBox.onDidChange(this.onDidSaturationValueChange,this)),this._register(this._saturationBox.onColorFlushed(this.flushColor,this)),this._opacityStrip=new j2(this._domNode,this.model,s),this._register(this._opacityStrip),this._register(this._opacityStrip.onDidChange(this.onDidOpacityChange,this)),this._register(this._opacityStrip.onColorFlushed(this.flushColor,this)),this._hueStrip=new H2(this._domNode,this.model,s),this._register(this._hueStrip),this._register(this._hueStrip.onDidChange(this.onDidHueChange,this)),this._register(this._hueStrip.onColorFlushed(this.flushColor,this)),s&&(this._insertButton=this._register(new V2(this._domNode)),this._domNode.classList.add("standalone-colorpicker"))}flushColor(){this.model.flushColor()}onDidSaturationValueChange({s:t,v:i}){const e=this.model.color.hsva;this.model.color=new kp(new yp(e.h,t,i,e.a))}onDidOpacityChange(t){const i=this.model.color.hsva;this.model.color=new kp(new yp(i.h,i.s,i.v,t))}onDidHueChange(t){const i=this.model.color.hsva,e=360*(1-t);this.model.color=new kp(new yp(e===360?0:e,i.s,i.v,i.a))}get domNode(){return this._domNode}get saturationBox(){return this._saturationBox}get enterButton(){return this._insertButton}layout(){this._saturationBox.layout(),this._opacityStrip.layout(),this._hueStrip.layout()}}class $2 extends Qi{constructor(t,i,e){super(),this.model=i,this.pixelRatio=e,this._onDidChange=new le,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new le,this.onColorFlushed=this._onColorFlushed.event,this._domNode=_2(".saturation-wrap"),Yc(t,this._domNode),this._canvas=document.createElement("canvas"),this._canvas.className="saturation-box",Yc(this._domNode,this._canvas),this.selection=_2(".saturation-selection"),Yc(this._domNode,this.selection),this.layout(),this._register(sc(this._domNode,qc.POINTER_DOWN,(t=>this.onPointerDown(t)))),this._register(this.model.onDidChangeColor(this.onDidChangeColor,this)),this.monitor=null}get domNode(){return this._domNode}onPointerDown(t){if(!(t.target&&t.target instanceof Element))return;this.monitor=this._register(new Lw);const i=vc(this._domNode);t.target!==this.selection&&this.onDidChangePosition(t.offsetX,t.offsetY),this.monitor.startMonitoring(t.target,t.pointerId,t.buttons,(t=>this.onDidChangePosition(t.pageX-i.left,t.pageY-i.top)),(()=>null));const e=sc(t.target.ownerDocument,qc.POINTER_UP,(()=>{this._onColorFlushed.fire(),e.dispose(),this.monitor&&(this.monitor.stopMonitoring(!0),this.monitor=null)}),!0)}onDidChangePosition(t,i){const e=Math.max(0,Math.min(1,t/this.width)),s=Math.max(0,Math.min(1,1-i/this.height));this.paintSelection(e,s),this._onDidChange.fire({s:e,v:s})}layout(){this.width=this._domNode.offsetWidth,this.height=this._domNode.offsetHeight,this._canvas.width=this.width*this.pixelRatio,this._canvas.height=this.height*this.pixelRatio,this.paint();const t=this.model.color.hsva;this.paintSelection(t.s,t.v)}paint(){const t=this.model.color.hsva,i=new kp(new yp(t.h,1,1,1)),e=this._canvas.getContext("2d"),s=e.createLinearGradient(0,0,this._canvas.width,0);s.addColorStop(0,"rgba(255, 255, 255, 1)"),s.addColorStop(.5,"rgba(255, 255, 255, 0.5)"),s.addColorStop(1,"rgba(255, 255, 255, 0)");const n=e.createLinearGradient(0,0,0,this._canvas.height);n.addColorStop(0,"rgba(0, 0, 0, 0)"),n.addColorStop(1,"rgba(0, 0, 0, 1)"),e.rect(0,0,this._canvas.width,this._canvas.height),e.fillStyle=kp.Format.CSS.format(i),e.fill(),e.fillStyle=s,e.fill(),e.fillStyle=n,e.fill()}paintSelection(t,i){this.selection.style.left=t*this.width+"px",this.selection.style.top=this.height-i*this.height+"px"}onDidChangeColor(t){if(this.monitor&&this.monitor.isMonitoring())return;this.paint();const i=t.hsva;this.paintSelection(i.s,i.v)}}class W2 extends Qi{constructor(t,i,e=!1){super(),this.model=i,this._onDidChange=new le,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new le,this.onColorFlushed=this._onColorFlushed.event,e?(this.domNode=Yc(t,_2(".standalone-strip")),this.overlay=Yc(this.domNode,_2(".standalone-overlay"))):(this.domNode=Yc(t,_2(".strip")),this.overlay=Yc(this.domNode,_2(".overlay"))),this.slider=Yc(this.domNode,_2(".slider")),this.slider.style.top="0px",this._register(sc(this.domNode,qc.POINTER_DOWN,(t=>this.onPointerDown(t)))),this._register(i.onDidChangeColor(this.onDidChangeColor,this)),this.layout()}layout(){this.height=this.domNode.offsetHeight-this.slider.offsetHeight;const t=this.getValue(this.model.color);this.updateSliderPosition(t)}onDidChangeColor(t){const i=this.getValue(t);this.updateSliderPosition(i)}onPointerDown(t){if(!(t.target&&t.target instanceof Element))return;const i=this._register(new Lw),e=vc(this.domNode);this.domNode.classList.add("grabbing"),t.target!==this.slider&&this.onDidChangeTop(t.offsetY),i.startMonitoring(t.target,t.pointerId,t.buttons,(t=>this.onDidChangeTop(t.pageY-e.top)),(()=>null));const s=sc(t.target.ownerDocument,qc.POINTER_UP,(()=>{this._onColorFlushed.fire(),s.dispose(),i.stopMonitoring(!0),this.domNode.classList.remove("grabbing")}),!0)}onDidChangeTop(t){const i=Math.max(0,Math.min(1,1-t/this.height));this.updateSliderPosition(i),this._onDidChange.fire(i)}updateSliderPosition(t){this.slider.style.top=(1-t)*this.height+"px"}}class j2 extends W2{constructor(t,i,e=!1){super(t,i,e),this.domNode.classList.add("opacity-strip"),this.onDidChangeColor(this.model.color)}onDidChangeColor(t){super.onDidChangeColor(t);const{r:i,g:e,b:s}=t.rgba,n=new kp(new vp(i,e,s,1)),r=new kp(new vp(i,e,s,0));this.overlay.style.background=`linear-gradient(to bottom, ${n} 0%, ${r} 100%)`}getValue(t){return t.hsva.a}}class H2 extends W2{constructor(t,i,e=!1){super(t,i,e),this.domNode.classList.add("hue-strip")}getValue(t){return 1-t.hsva.h/360}}class V2 extends Qi{constructor(t){super(),this._onClicked=this._register(new le),this.onClicked=this._onClicked.event,this._button=Yc(t,document.createElement("button")),this._button.classList.add("insert-button"),this._button.textContent="Insert",this._register(sc(this._button,qc.CLICK,(()=>{this._onClicked.fire()})))}get button(){return this._button}}class z2 extends jk{constructor(t,i,e,s,n=!1){super(),this.model=i,this.pixelRatio=e,this._register(yl.getInstance(Uh(t)).onDidChange((()=>this.layout())));const r=_2(".colorpicker-widget");t.appendChild(r),this.header=this._register(new P2(r,this.model,s,n)),this.body=this._register(new B2(r,this.model,this.pixelRatio,n))}layout(){this.body.layout()}}var U2=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},K2=function(t,i){return function(e,s){i(e,s,t)}};class q2{constructor(t,i,e,s){this.owner=t,this.range=i,this.model=e,this.provider=s,this.forceShowAtRange=!0}isValidForHoverAnchor(t){return t.type===1&&this.range.startColumn<=t.range.startColumn&&this.range.endColumn>=t.range.endColumn}}let G2=class{constructor(t,i){this._editor=t,this._themeService=i,this.hoverOrdinal=2}computeSync(t,i){return[]}computeAsync(t,i,e){return Lo.fromPromise(this._computeAsync(t,i,e))}async _computeAsync(t,i,e){if(!this._editor.hasModel())return[];const s=R2.get(this._editor);if(!s)return[];for(const t of i){if(!s.isColorDecoration(t))continue;const i=s.getColorData(t.range.getStartPosition());if(i)return[await Q2(this,this._editor.getModel(),i.colorInfo,i.provider)]}return[]}renderHoverParts(t,i){return Y2(this,this._editor,this._themeService,i,t)}};G2=U2([K2(1,AC)],G2);class Z2{constructor(t,i,e,s){this.owner=t,this.range=i,this.model=e,this.provider=s}}let J2=class{constructor(t,i){this._editor=t,this._themeService=i,this._color=null}async createColorHover(t,i,e){if(!this._editor.hasModel()||!R2.get(this._editor))return null;const s=await k2(e,this._editor.getModel(),ve.None);let n=null,r=null;for(const i of s){const e=i.colorInfo;Cs.containsRange(e.range,t.range)&&(n=e,r=i.provider)}const o=n??t,h=r??i,c=!!n;return{colorHover:await Q2(this,this._editor.getModel(),o,h),foundInEditor:c}}async updateEditorModel(t){if(!this._editor.hasModel())return;const i=t.model;let e=new Cs(t.range.startLineNumber,t.range.startColumn,t.range.endLineNumber,t.range.endColumn);this._color&&(await t4(this._editor.getModel(),i,this._color,e,t),e=X2(this._editor,e,i))}renderHoverParts(t,i){return Y2(this,this._editor,this._themeService,i,t)}set color(t){this._color=t}get color(){return this._color}};async function Q2(t,i,e,s){const n=i.getValueInRange(e.range),{red:r,green:o,blue:h,alpha:c}=e.color,l=new vp(Math.round(255*r),Math.round(255*o),Math.round(255*h),c),a=new kp(l),u=await C2(i,e,s,ve.None),d=new I2(a,[],0);return d.colorPresentations=u||[],d.guessColorPresentation(a,n),t instanceof G2?new q2(t,Cs.lift(e.range),d,s):new Z2(t,Cs.lift(e.range),d,s)}function Y2(t,i,e,s,n){if(s.length===0||!i.hasModel())return Qi.None;if(n.setMinimumDimensions){const t=i.getOption(67)+8;n.setMinimumDimensions(new mc(302,t))}const r=new Ji,o=s[0],h=i.getModel(),c=o.model,l=r.add(new z2(n.fragment,c,i.getOption(143),e,t instanceof J2));n.setColorPicker(l);let a=!1,u=new Cs(o.range.startLineNumber,o.range.startColumn,o.range.endLineNumber,o.range.endColumn);if(t instanceof J2){const i=s[0].model.color;t.color=i,t4(h,c,i,u,o),r.add(c.onColorFlushed((i=>{t.color=i})))}else r.add(c.onColorFlushed((async t=>{await t4(h,c,t,u,o),a=!0,u=X2(i,u,c)})));return r.add(c.onDidChangeColor((t=>{t4(h,c,t,u,o)}))),r.add(i.onDidChangeModelContent((t=>{a?a=!1:(n.hide(),i.focus())}))),r}function X2(t,i,e){var s,n;const r=[],o=(s=e.presentation.textEdit)!==null&&s!==void 0?s:{range:i,text:e.presentation.label,forceMoveMarkers:!1};r.push(o),e.presentation.additionalTextEdits&&r.push(...e.presentation.additionalTextEdits);const h=Cs.lift(o.range),c=t.getModel()._setTrackedRange(null,h,3);return t.executeEdits("colorpicker",r),t.pushUndoStop(),(n=t.getModel()._getTrackedRange(c))!==null&&n!==void 0?n:h}async function t4(t,i,e,s,n){const r=await C2(t,{range:s,color:{red:e.rgba.r/255,green:e.rgba.g/255,blue:e.rgba.b/255,alpha:e.rgba.a}},n.provider,ve.None);i.colorPresentations=r||[]}function i4(t,i){return!!t[i]}J2=U2([K2(1,AC)],J2);class e4{constructor(t,i){this.target=t.target,this.isLeftClick=t.event.leftButton,this.isMiddleClick=t.event.middleButton,this.isRightClick=t.event.rightButton,this.hasTriggerModifier=i4(t.event,i.triggerModifier),this.hasSideBySideModifier=i4(t.event,i.triggerSideBySideModifier),this.isNoneOrSingleMouseDown=t.event.detail<=1}}class s4{constructor(t,i){this.keyCodeIsTriggerKey=t.keyCode===i.triggerKey,this.keyCodeIsSideBySideKey=t.keyCode===i.triggerSideBySideKey,this.hasTriggerModifier=i4(t,i.triggerModifier)}}class n4{constructor(t,i,e,s){this.triggerKey=t,this.triggerModifier=i,this.triggerSideBySideKey=e,this.triggerSideBySideModifier=s}equals(t){return this.triggerKey===t.triggerKey&&this.triggerModifier===t.triggerModifier&&this.triggerSideBySideKey===t.triggerSideBySideKey&&this.triggerSideBySideModifier===t.triggerSideBySideModifier}}function r4(t){return t==="altKey"?bt?new n4(57,"metaKey",6,"altKey"):new n4(5,"ctrlKey",6,"altKey"):bt?new n4(6,"altKey",57,"metaKey"):new n4(6,"altKey",5,"ctrlKey")}class o4 extends Qi{constructor(t,i){var e;super(),this._onMouseMoveOrRelevantKeyDown=this._register(new le),this.onMouseMoveOrRelevantKeyDown=this._onMouseMoveOrRelevantKeyDown.event,this._onExecute=this._register(new le),this.onExecute=this._onExecute.event,this._onCancel=this._register(new le),this.onCancel=this._onCancel.event,this._editor=t,this._extractLineNumberFromMouseEvent=(e=i==null?void 0:i.extractLineNumberFromMouseEvent)!==null&&e!==void 0?e:t=>t.target.position?t.target.position.lineNumber:0,this._opts=r4(this._editor.getOption(78)),this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._register(this._editor.onDidChangeConfiguration((t=>{if(t.hasChanged(78)){const t=r4(this._editor.getOption(78));if(this._opts.equals(t))return;this._opts=t,this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._onCancel.fire()}}))),this._register(this._editor.onMouseMove((t=>this._onEditorMouseMove(new e4(t,this._opts))))),this._register(this._editor.onMouseDown((t=>this._onEditorMouseDown(new e4(t,this._opts))))),this._register(this._editor.onMouseUp((t=>this._onEditorMouseUp(new e4(t,this._opts))))),this._register(this._editor.onKeyDown((t=>this._onEditorKeyDown(new s4(t,this._opts))))),this._register(this._editor.onKeyUp((t=>this._onEditorKeyUp(new s4(t,this._opts))))),this._register(this._editor.onMouseDrag((()=>this._resetHandler()))),this._register(this._editor.onDidChangeCursorSelection((t=>this._onDidChangeCursorSelection(t)))),this._register(this._editor.onDidChangeModel((t=>this._resetHandler()))),this._register(this._editor.onDidChangeModelContent((()=>this._resetHandler()))),this._register(this._editor.onDidScrollChange((t=>{(t.scrollTopChanged||t.scrollLeftChanged)&&this._resetHandler()})))}_onDidChangeCursorSelection(t){t.selection&&t.selection.startColumn!==t.selection.endColumn&&this._resetHandler()}_onEditorMouseMove(t){this._lastMouseMoveEvent=t,this._onMouseMoveOrRelevantKeyDown.fire([t,null])}_onEditorMouseDown(t){this._hasTriggerKeyOnMouseDown=t.hasTriggerModifier,this._lineNumberOnMouseDown=this._extractLineNumberFromMouseEvent(t)}_onEditorMouseUp(t){const i=this._extractLineNumberFromMouseEvent(t);this._hasTriggerKeyOnMouseDown&&this._lineNumberOnMouseDown&&this._lineNumberOnMouseDown===i&&this._onExecute.fire(t)}_onEditorKeyDown(t){this._lastMouseMoveEvent&&(t.keyCodeIsTriggerKey||t.keyCodeIsSideBySideKey&&t.hasTriggerModifier)?this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent,t]):t.hasTriggerModifier&&this._onCancel.fire()}_onEditorKeyUp(t){t.keyCodeIsTriggerKey&&this._onCancel.fire()}_resetHandler(){this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._onCancel.fire()}}var h4=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},c4=function(t,i){return function(e,s){i(e,s,t)}};let l4=class extends vR{constructor(t,i,e,s,n,r,o,h,c,l,a,u,d){super(t,{...s.getRawOptions(),overflowWidgetsDomNode:s.getOverflowWidgetsDomNode()},e,n,r,o,h,c,l,a,u,d),this._parentEditor=s,this._overwriteOptions=i,super.updateOptions(this._overwriteOptions),this._register(s.onDidChangeConfiguration((t=>this._onParentConfigurationChanged(t))))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(t){super.updateOptions(this._parentEditor.getRawOptions()),super.updateOptions(this._overwriteOptions)}updateOptions(t){Z(this._overwriteOptions,t,!0),super.updateOptions(this._overwriteOptions)}};l4=h4([c4(4,Il),c4(5,Pl),c4(6,ql),c4(7,Ra),c4(8,AC),c4(9,gR),c4(10,vw),c4(11,cf),c4(12,$p)],l4);const a4=new kp(new vp(0,122,204)),u4={showArrow:!0,showFrame:!0,className:"",frameColor:a4,arrowColor:a4,keepEditorSelection:!1};class d4{constructor(t,i,e,s,n,r,o,h){this.id="",this.domNode=t,this.afterLineNumber=i,this.afterColumn=e,this.heightInLines=s,this.showInHiddenAreas=o,this.ordinal=h,this._onDomNodeTop=n,this._onComputedHeight=r}onDomNodeTop(t){this._onDomNodeTop(t)}onComputedHeight(t){this._onComputedHeight(t)}}class f4{constructor(t,i){this._id=t,this._domNode=i}getId(){return this._id}getDomNode(){return this._domNode}getPosition(){return null}}class g4{constructor(t){this._editor=t,this._ruleName=g4._IdGenerator.nextId(),this._decorations=this._editor.createDecorationsCollection(),this._color=null,this._height=-1}dispose(){this.hide(),Vc(this._ruleName)}set color(t){this._color!==t&&(this._color=t,this._updateStyle())}set height(t){this._height!==t&&(this._height=t,this._updateStyle())}_updateStyle(){Vc(this._ruleName),Hc(`.monaco-editor ${this._ruleName}`,`border-style: solid; border-color: transparent; border-bottom-color: ${this._color}; border-width: ${this._height}px; bottom: -${this._height}px !important; margin-left: -${this._height}px; `)}show(t){t.column===1&&(t={lineNumber:t.lineNumber,column:2}),this._decorations.set([{range:Cs.fromPositions(t),options:{description:"zone-widget-arrow",className:this._ruleName,stickiness:1}}])}hide(){this._decorations.clear()}}g4._IdGenerator=new __(".arrow-decoration-");class p4{constructor(t,i={}){this._arrow=null,this._overlayWidget=null,this._resizeSash=null,this._viewZone=null,this._disposables=new Ji,this.container=null,this._isShowing=!1,this.editor=t,this._positionMarkerId=this.editor.createDecorationsCollection(),this.options=U(i),Z(this.options,u4,!1),this.domNode=document.createElement("div"),this.options.isAccessible||(this.domNode.setAttribute("aria-hidden","true"),this.domNode.setAttribute("role","presentation")),this._disposables.add(this.editor.onDidLayoutChange((t=>{const i=this._getWidth(t);this.domNode.style.width=i+"px",this.domNode.style.left=this._getLeft(t)+"px",this._onWidth(i)})))}dispose(){this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this._viewZone&&this.editor.changeViewZones((t=>{this._viewZone&&t.removeZone(this._viewZone.id),this._viewZone=null})),this._positionMarkerId.clear(),this._disposables.dispose()}create(){this.domNode.classList.add("zone-widget"),this.options.className&&this.domNode.classList.add(this.options.className),this.container=document.createElement("div"),this.container.classList.add("zone-widget-container"),this.domNode.appendChild(this.container),this.options.showArrow&&(this._arrow=new g4(this.editor),this._disposables.add(this._arrow)),this._fillContainer(this.container),this._initSash(),this._applyStyles()}style(t){t.frameColor&&(this.options.frameColor=t.frameColor),t.arrowColor&&(this.options.arrowColor=t.arrowColor),this._applyStyles()}_applyStyles(){if(this.container&&this.options.frameColor){const t=this.options.frameColor.toString();this.container.style.borderTopColor=t,this.container.style.borderBottomColor=t}if(this._arrow&&this.options.arrowColor){const t=this.options.arrowColor.toString();this._arrow.color=t}}_getWidth(t){return t.width-t.minimap.minimapWidth-t.verticalScrollbarWidth}_getLeft(t){return t.minimap.minimapWidth>0&&t.minimap.minimapLeft===0?t.minimap.minimapWidth:0}_onViewZoneTop(t){this.domNode.style.top=t+"px"}_onViewZoneHeight(t){var i;if(this.domNode.style.height=`${t}px`,this.container){const i=t-this._decoratingElementsHeight();this.container.style.height=`${i}px`;const e=this.editor.getLayoutInfo();this._doLayout(i,this._getWidth(e))}(i=this._resizeSash)===null||i===void 0||i.layout()}get position(){const t=this._positionMarkerId.getRange(0);if(t)return t.getStartPosition()}show(t,i){const e=Cs.isIRange(t)?Cs.lift(t):Cs.fromPositions(t);this._isShowing=!0,this._showImpl(e,i),this._isShowing=!1,this._positionMarkerId.set([{range:e,options:xF.EMPTY}])}hide(){var t;this._viewZone&&(this.editor.changeViewZones((t=>{this._viewZone&&t.removeZone(this._viewZone.id)})),this._viewZone=null),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),(t=this._arrow)===null||t===void 0||t.hide(),this._positionMarkerId.clear()}_decoratingElementsHeight(){const t=this.editor.getOption(67);let i=0;return this.options.showArrow&&(i+=2*Math.round(t/3)),this.options.showFrame&&(i+=2*Math.round(t/9)),i}_showImpl(t,i){const e=t.getStartPosition(),s=this.editor.getLayoutInfo(),n=this._getWidth(s);this.domNode.style.width=`${n}px`,this.domNode.style.left=this._getLeft(s)+"px";const r=document.createElement("div");r.style.overflow="hidden";const o=this.editor.getOption(67);if(!this.options.allowUnlimitedHeight){const t=Math.max(12,this.editor.getLayoutInfo().height/o*.8);i=Math.min(i,t)}let h=0,c=0;if(this._arrow&&this.options.showArrow&&(h=Math.round(o/3),this._arrow.height=h,this._arrow.show(e)),this.options.showFrame&&(c=Math.round(o/9)),this.editor.changeViewZones((t=>{this._viewZone&&t.removeZone(this._viewZone.id),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this.domNode.style.top="-1000px",this._viewZone=new d4(r,e.lineNumber,e.column,i,(t=>this._onViewZoneTop(t)),(t=>this._onViewZoneHeight(t)),this.options.showInHiddenAreas,this.options.ordinal),this._viewZone.id=t.addZone(this._viewZone),this._overlayWidget=new f4("vs.editor.contrib.zoneWidget"+this._viewZone.id,this.domNode),this.editor.addOverlayWidget(this._overlayWidget)})),this.container&&this.options.showFrame){const t=this.options.frameWidth?this.options.frameWidth:c;this.container.style.borderTopWidth=t+"px",this.container.style.borderBottomWidth=t+"px"}const l=i*o-this._decoratingElementsHeight();this.container&&(this.container.style.top=h+"px",this.container.style.height=l+"px",this.container.style.overflow="hidden"),this._doLayout(l,n),this.options.keepEditorSelection||this.editor.setSelection(t);const a=this.editor.getModel();if(a){const i=a.validateRange(new Cs(t.startLineNumber,1,t.endLineNumber+1,1));this.revealRange(i,i.startLineNumber===a.getLineCount())}}revealRange(t,i){i?this.editor.revealLineNearTop(t.endLineNumber,0):this.editor.revealRange(t,0)}setCssClass(t,i){this.container&&(i&&this.container.classList.remove(i),this.container.classList.add(t))}_onWidth(t){}_doLayout(t,i){}_relayout(t){this._viewZone&&this._viewZone.heightInLines!==t&&this.editor.changeViewZones((i=>{this._viewZone&&(this._viewZone.heightInLines=t,i.layoutZone(this._viewZone.id))}))}_initSash(){if(this._resizeSash)return;let t;this._resizeSash=this._disposables.add(new jj(this.domNode,this,{orientation:1})),this.options.isResizeable||(this._resizeSash.state=0),this._disposables.add(this._resizeSash.onDidStart((i=>{this._viewZone&&(t={startY:i.startY,heightInLines:this._viewZone.heightInLines})}))),this._disposables.add(this._resizeSash.onDidEnd((()=>{t=void 0}))),this._disposables.add(this._resizeSash.onDidChange((i=>{if(t){const e=(i.currentY-t.startY)/this.editor.getOption(67),s=e<0?Math.ceil(e):Math.floor(e),n=t.heightInLines+s;n>5&&n<35&&this._relayout(n)}})))}getHorizontalSashLeft(){return 0}getHorizontalSashTop(){return(this.domNode.style.height===null?0:parseInt(this.domNode.style.height))-this._decoratingElementsHeight()/2}getHorizontalSashWidth(){const t=this.editor.getLayoutInfo();return t.width-t.minimap.minimapWidth}}var m4=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},w4=function(t,i){return function(e,s){i(e,s,t)}};const v4=_l("IPeekViewService");var b4;Nd(v4,class{constructor(){this._widgets=new Map}addExclusiveWidget(t,i){const e=this._widgets.get(t);e&&(e.listener.dispose(),e.widget.dispose()),this._widgets.set(t,{widget:i,listener:i.onDidClose((()=>{const e=this._widgets.get(t);e&&e.widget===i&&(e.listener.dispose(),this._widgets.delete(t))}))})}},1),function(t){t.inPeekEditor=new Ta("inReferenceSearchEditor",!0,tt(0,"Whether the current code editor is embedded inside peek")),t.notInPeekEditor=t.inPeekEditor.toNegated()}(b4||(b4={}));let y4=class{constructor(t,i){t instanceof l4&&b4.inPeekEditor.bindTo(i)}dispose(){}};y4.ID="editor.contrib.referenceController",y4=m4([w4(1,Ra)],y4),Su(y4.ID,y4,0);const k4={headerBackgroundColor:kp.white,primaryHeadingColor:kp.fromHex("#333333"),secondaryHeadingColor:kp.fromHex("#6c6c6cb3")};let C4=class extends p4{constructor(t,i,e){super(t,i),this.instantiationService=e,this._onDidClose=new le,this.onDidClose=this._onDidClose.event,Z(this.options,k4,!1)}dispose(){this.disposed||(this.disposed=!0,super.dispose(),this._onDidClose.fire(this))}style(t){const i=this.options;t.headerBackgroundColor&&(i.headerBackgroundColor=t.headerBackgroundColor),t.primaryHeadingColor&&(i.primaryHeadingColor=t.primaryHeadingColor),t.secondaryHeadingColor&&(i.secondaryHeadingColor=t.secondaryHeadingColor),super.style(t)}_applyStyles(){super._applyStyles();const t=this.options;this._headElement&&t.headerBackgroundColor&&(this._headElement.style.backgroundColor=t.headerBackgroundColor.toString()),this._primaryHeading&&t.primaryHeadingColor&&(this._primaryHeading.style.color=t.primaryHeadingColor.toString()),this._secondaryHeading&&t.secondaryHeadingColor&&(this._secondaryHeading.style.color=t.secondaryHeadingColor.toString()),this._bodyElement&&t.frameColor&&(this._bodyElement.style.borderColor=t.frameColor.toString())}_fillContainer(t){this.setCssClass("peekview-widget"),this._headElement=nl(".head"),this._bodyElement=nl(".body"),this._fillHead(this._headElement),this._fillBody(this._bodyElement),t.appendChild(this._headElement),t.appendChild(this._bodyElement)}_fillHead(t,i){this._titleElement=nl(".peekview-title"),this.options.supportOnTitleClick&&(this._titleElement.classList.add("clickable"),rc(this._titleElement,"click",(t=>this._onTitleClick(t)))),Yc(this._headElement,this._titleElement),this._fillTitleIcon(this._titleElement),this._primaryHeading=nl("span.filename"),this._secondaryHeading=nl("span.dirname"),this._metaHeading=nl("span.meta"),Yc(this._titleElement,this._primaryHeading,this._secondaryHeading,this._metaHeading);const e=nl(".peekview-actions");Yc(this._headElement,e);const s=this._getActionBarOptions();this._actionbarWidget=new LW(e,s),this._disposables.add(this._actionbarWidget),i||this._actionbarWidget.push(new $l("peekview.close",tt(0,"Close"),Kl.asClassName(As.close),!0,(()=>(this.dispose(),Promise.resolve()))),{label:!1,icon:!0})}_fillTitleIcon(t){}_getActionBarOptions(){return{actionViewItemProvider:MW.bind(void 0,this.instantiationService),orientation:0}}_onTitleClick(t){}setTitle(t,i){this._primaryHeading&&this._secondaryHeading&&(this._primaryHeading.innerText=t,this._primaryHeading.setAttribute("title",t),i?this._secondaryHeading.innerText=i:ic(this._secondaryHeading))}setMetaTitle(t){this._metaHeading&&(t?(this._metaHeading.innerText=t,rl(this._metaHeading)):ol(this._metaHeading))}_doLayout(t,i){if(!this._isShowing&&t<0)return void this.dispose();const e=Math.ceil(1.2*this.editor.getOption(67)),s=Math.round(t-(e+2));this._doLayoutHead(e,i),this._doLayoutBody(s,i)}_doLayoutHead(t,i){this._headElement&&(this._headElement.style.height=`${t}px`,this._headElement.style.lineHeight=this._headElement.style.height)}_doLayoutBody(t,i){this._bodyElement&&(this._bodyElement.style.height=`${t}px`)}};C4=m4([w4(2,Il)],C4);const S4=Iw("peekViewTitle.background",{dark:"#252526",light:"#F3F3F3",hcDark:kp.black,hcLight:kp.white},tt(0,"Background color of the peek view title area.")),x4=Iw("peekViewTitleLabel.foreground",{dark:kp.white,light:kp.black,hcDark:kp.white,hcLight:nv},tt(0,"Color of the peek view title.")),D4=Iw("peekViewTitleDescription.foreground",{dark:"#ccccccb3",light:"#616161",hcDark:"#FFFFFF99",hcLight:"#292929"},tt(0,"Color of the peek view title info.")),E4=Iw("peekView.border",{dark:fv,light:fv,hcDark:qw,hcLight:qw},tt(0,"Color of the peek view borders and arrow.")),A4=Iw("peekViewResult.background",{dark:"#252526",light:"#F3F3F3",hcDark:kp.black,hcLight:kp.white},tt(0,"Background color of the peek view result list."));Iw("peekViewResult.lineForeground",{dark:"#bbbbbb",light:"#646465",hcDark:kp.white,hcLight:nv},tt(0,"Foreground color for line nodes in the peek view result list.")),Iw("peekViewResult.fileForeground",{dark:kp.white,light:"#1E1E1E",hcDark:kp.white,hcLight:nv},tt(0,"Foreground color for file nodes in the peek view result list.")),Iw("peekViewResult.selectionBackground",{dark:"#3399ff33",light:"#3399ff33",hcDark:null,hcLight:null},tt(0,"Background color of the selected entry in the peek view result list.")),Iw("peekViewResult.selectionForeground",{dark:kp.white,light:"#6C6C6C",hcDark:kp.white,hcLight:nv},tt(0,"Foreground color of the selected entry in the peek view result list."));const M4=Iw("peekViewEditor.background",{dark:"#001F33",light:"#F2F8FC",hcDark:kp.black,hcLight:kp.white},tt(0,"Background color of the peek view editor."));Iw("peekViewEditorGutter.background",{dark:M4,light:M4,hcDark:M4,hcLight:M4},tt(0,"Background color of the gutter in the peek view editor.")),Iw("peekViewEditorStickyScroll.background",{dark:M4,light:M4,hcDark:M4,hcLight:M4},tt(0,"Background color of sticky scroll in the peek view editor.")),Iw("peekViewResult.matchHighlightBackground",{dark:"#ea5c004d",light:"#ea5c004d",hcDark:null,hcLight:null},tt(0,"Match highlight color in the peek view result list.")),Iw("peekViewEditor.matchHighlightBackground",{dark:"#ff8f0099",light:"#f5d802de",hcDark:null,hcLight:null},tt(0,"Match highlight color in the peek view editor.")),Iw("peekViewEditor.matchHighlightBorder",{dark:null,light:null,hcDark:Gw,hcLight:Gw},tt(0,"Match highlight border in the peek view editor."));class L4{constructor(t,i,e,s){this.isProviderFirst=t,this.parent=i,this.link=e,this._rangeCallback=s,this.id=P_.nextId()}get uri(){return this.link.uri}get range(){var t,i;return(i=(t=this._range)!==null&&t!==void 0?t:this.link.targetSelectionRange)!==null&&i!==void 0?i:this.link.range}set range(t){this._range=t,this._rangeCallback(this)}get ariaMessage(){var t;const i=(t=this.parent.getPreview(this))===null||t===void 0?void 0:t.preview(this.range);return i?tt(0,"{0} in {1} on line {2} at column {3}",i.value,SM(this.uri),this.range.startLineNumber,this.range.startColumn):tt(0,"in {0} on line {1} at column {2}",SM(this.uri),this.range.startLineNumber,this.range.startColumn)}}class F4{constructor(t){this._modelReference=t}dispose(){this._modelReference.dispose()}preview(t,i=8){const e=this._modelReference.object.textEditorModel;if(!e)return;const{startLineNumber:s,startColumn:n,endLineNumber:r,endColumn:o}=t,h=e.getWordUntilPosition({lineNumber:s,column:n-i}),c=new Cs(s,h.startColumn,s,n),l=new Cs(r,o,r,1073741824),a=e.getValueInRange(c).replace(/^\s+/,""),u=e.getValueInRange(t);return{value:a+u+e.getValueInRange(l).replace(/\s+$/,""),highlight:{start:a.length,end:a.length+u.length}}}}class T4{constructor(t,i){this.parent=t,this.uri=i,this.children=[],this._previews=new zf}dispose(){qi(this._previews.values()),this._previews.clear()}getPreview(t){return this._previews.get(t.uri)}get ariaMessage(){const t=this.children.length;return t===1?tt(0,"1 symbol in {0}, full path {1}",SM(this.uri),this.uri.fsPath):tt(0,"{0} symbols in {1}, full path {2}",t,SM(this.uri),this.uri.fsPath)}async resolve(t){if(this._previews.size!==0)return this;for(const i of this.children)if(!this._previews.has(i.uri))try{const e=await t.createModelReference(i.uri);this._previews.set(i.uri,new F4(e))}catch(t){Ii(t)}return this}}class R4{constructor(t,i){this.groups=[],this.references=[],this._onDidChangeReferenceRange=new le,this.onDidChangeReferenceRange=this._onDidChangeReferenceRange.event,this._links=t,this._title=i;const[e]=t;let s;t.sort(R4._compareReferences);for(const i of t)if(s&&yM.isEqual(s.uri,i.uri,!0)||(s=new T4(this,i.uri),this.groups.push(s)),s.children.length===0||R4._compareReferences(i,s.children[s.children.length-1])!==0){const t=new L4(e===i,s,i,(t=>this._onDidChangeReferenceRange.fire(t)));this.references.push(t),s.children.push(t)}}dispose(){qi(this.groups),this._onDidChangeReferenceRange.dispose(),this.groups.length=0}clone(){return new R4(this._links,this._title)}get title(){return this._title}get isEmpty(){return this.groups.length===0}get ariaMessage(){return this.isEmpty?tt(0,"No results found"):this.references.length===1?tt(0,"Found 1 symbol in {0}",this.references[0].uri.fsPath):this.groups.length===1?tt(0,"Found {0} symbols in {1}",this.references.length,this.groups[0].uri.fsPath):tt(0,"Found {0} symbols in {1} files",this.references.length,this.groups.length)}nextOrPreviousReference(t,i){const{parent:e}=t;let s=e.children.indexOf(t);const n=e.children.length,r=e.parent.groups.length;return r===1||i&&s+1<n||!i&&s>0?(s=i?(s+1)%n:(s+n-1)%n,e.children[s]):(s=e.parent.groups.indexOf(e),i?(s=(s+1)%r,e.parent.groups[s].children[0]):(s=(s+r-1)%r,e.parent.groups[s].children[e.parent.groups[s].children.length-1]))}nearestReference(t,i){const e=this.references.map(((e,s)=>({idx:s,prefixLen:dr(e.uri.toString(),t.toString()),offsetDist:100*Math.abs(e.range.startLineNumber-i.lineNumber)+Math.abs(e.range.startColumn-i.column)}))).sort(((t,i)=>t.prefixLen>i.prefixLen?-1:t.prefixLen<i.prefixLen?1:t.offsetDist<i.offsetDist?-1:t.offsetDist>i.offsetDist?1:0))[0];if(e)return this.references[e.idx]}referenceAt(t,i){for(const e of this.references)if(e.uri.toString()===t.toString()&&Cs.containsPosition(e.range,i))return e}firstReference(){for(const t of this.references)if(t.isProviderFirst)return t;return this.references[0]}static _compareReferences(t,i){return yM.compare(t.uri,i.uri)||Cs.compareRangesUsingStarts(t.range,i.range)}}var O4,I4=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},_4=function(t,i){return function(e,s){i(e,s,t)}};let P4=class{constructor(t){this._resolverService=t}hasChildren(t){return t instanceof R4||t instanceof T4}getChildren(t){if(t instanceof R4)return t.groups;if(t instanceof T4)return t.resolve(this._resolverService).then((t=>t.children));throw new Error("bad tree")}};P4=I4([_4(0,Bl)],P4);class N4{getHeight(){return 23}getTemplateId(t){return t instanceof T4?j4.id:V4.id}}let B4=class{constructor(t){this._keybindingService=t}getKeyboardNavigationLabel(t){var i;if(t instanceof L4){const e=(i=t.parent.getPreview(t))===null||i===void 0?void 0:i.preview(t.range);if(e)return e.value}return SM(t.uri)}};B4=I4([_4(0,NS)],B4);class $4{getId(t){return t instanceof L4?t.id:t.uri}}let W4=class extends Qi{constructor(t,i){super(),this._labelService=i;const e=document.createElement("div");e.classList.add("reference-file"),this.file=this._register(new Rz(e,{supportHighlights:!0})),this.badge=new aU(Yc(e,nl(".count")),{},fW),t.appendChild(e)}set(t,i){const e=DM(t.uri);this.file.setLabel(this._labelService.getUriBasenameLabel(t.uri),this._labelService.getUriLabel(e,{relative:!0}),{title:this._labelService.getUriLabel(t.uri),matches:i});const s=t.children.length;this.badge.setCount(s),s>1?this.badge.setTitleFormat(tt(0,"{0} references",s)):this.badge.setTitleFormat(tt(0,"{0} reference",s))}};W4=I4([_4(1,wN)],W4);let j4=O4=class{constructor(t){this._instantiationService=t,this.templateId=O4.id}renderTemplate(t){return this._instantiationService.createInstance(W4,t)}renderElement(t,i,e){e.set(t.element,s_(t.filterData))}disposeTemplate(t){t.dispose()}};j4.id="FileReferencesRenderer",j4=O4=I4([_4(0,Il)],j4);class H4 extends Qi{constructor(t){super(),this.label=this._register(new Fz(t))}set(t,i){var e;const s=(e=t.parent.getPreview(t))===null||e===void 0?void 0:e.preview(t.range);if(s&&s.value){const{value:t,highlight:e}=s;i&&!p_.isDefault(i)?(this.label.element.classList.toggle("referenceMatch",!1),this.label.set(t,s_(i))):(this.label.element.classList.toggle("referenceMatch",!0),this.label.set(t,[e]))}else this.label.set(`${SM(t.uri)}:${t.range.startLineNumber+1}:${t.range.startColumn+1}`)}}class V4{constructor(){this.templateId=V4.id}renderTemplate(t){return new H4(t)}renderElement(t,i,e){e.set(t.element,t.filterData)}disposeTemplate(t){t.dispose()}}V4.id="OneReferenceRenderer";class z4{getWidgetAriaLabel(){return tt(0,"References")}getAriaLabel(t){return t.ariaMessage}}var U4=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},K4=function(t,i){return function(e,s){i(e,s,t)}};class q4{constructor(t,i){this._editor=t,this._model=i,this._decorations=new Map,this._decorationIgnoreSet=new Set,this._callOnDispose=new Ji,this._callOnModelChange=new Ji,this._callOnDispose.add(this._editor.onDidChangeModel((()=>this._onModelChanged()))),this._onModelChanged()}dispose(){this._callOnModelChange.dispose(),this._callOnDispose.dispose(),this.removeDecorations()}_onModelChanged(){this._callOnModelChange.clear();const t=this._editor.getModel();if(t){for(const i of this._model.references)if(i.uri.toString()===t.uri.toString())return void this._addDecorations(i.parent)}}_addDecorations(t){if(!this._editor.hasModel())return;this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations((()=>this._onDecorationChanged())));const i=[],e=[];for(let s=0,n=t.children.length;s<n;s++){const n=t.children[s];this._decorationIgnoreSet.has(n.id)||n.uri.toString()===this._editor.getModel().uri.toString()&&(i.push({range:n.range,options:q4.DecorationOptions}),e.push(s))}this._editor.changeDecorations((s=>{const n=s.deltaDecorations([],i);for(let i=0;i<n.length;i++)this._decorations.set(n[i],t.children[e[i]])}))}_onDecorationChanged(){const t=[],i=this._editor.getModel();if(i){for(const[e,s]of this._decorations){const n=i.getDecorationRange(e);if(!n)continue;let r=!1;Cs.equalsRange(n,s.range)||((Cs.spansMultipleLines(n)||s.range.endColumn-s.range.startColumn!==n.endColumn-n.startColumn)&&(r=!0),r?(this._decorationIgnoreSet.add(s.id),t.push(e)):s.range=n)}for(let i=0,e=t.length;i<e;i++)this._decorations.delete(t[i]);this._editor.removeDecorations(t)}}removeDecorations(){this._editor.removeDecorations([...this._decorations.keys()]),this._decorations.clear()}}q4.DecorationOptions=xF.register({description:"reference-decoration",stickiness:1,className:"reference-decoration"});class G4{constructor(){this.ratio=.7,this.heightInLines=18}static fromJSON(t){let i,e;try{const s=JSON.parse(t);i=s.ratio,e=s.heightInLines}catch{}return{ratio:i||.7,heightInLines:e||18}}}class Z4 extends xz{}let J4=class extends C4{constructor(t,i,e,s,n,r,o,h,c,l,a,u){super(t,{showFrame:!1,showArrow:!0,isResizeable:!0,isAccessible:!0,supportOnTitleClick:!0},r),this._defaultTreeKeyboardSupport=i,this.layoutData=e,this._textModelResolverService=n,this._instantiationService=r,this._peekViewService=o,this._uriLabel=h,this._undoRedoService=c,this._keybindingService=l,this._languageService=a,this._languageConfigurationService=u,this._disposeOnNewModel=new Ji,this._callOnDispose=new Ji,this._onDidSelectReference=new le,this.onDidSelectReference=this._onDidSelectReference.event,this._dim=new mc(0,0),this._applyTheme(s.getColorTheme()),this._callOnDispose.add(s.onDidColorThemeChange(this._applyTheme.bind(this))),this._peekViewService.addExclusiveWidget(t,this),this.create()}dispose(){this.setModel(void 0),this._callOnDispose.dispose(),this._disposeOnNewModel.dispose(),qi(this._preview),qi(this._previewNotAvailableMessage),qi(this._tree),qi(this._previewModelReference),this._splitView.dispose(),super.dispose()}_applyTheme(t){const i=t.getColor(E4)||kp.transparent;this.style({arrowColor:i,frameColor:i,headerBackgroundColor:t.getColor(S4)||kp.transparent,primaryHeadingColor:t.getColor(x4),secondaryHeadingColor:t.getColor(D4)})}show(t){super.show(t,this.layoutData.heightInLines||18)}focusOnReferenceTree(){this._tree.domFocus()}focusOnPreviewEditor(){this._preview.focus()}isPreviewEditorFocused(){return this._preview.hasTextFocus()}_onTitleClick(t){this._preview&&this._preview.getModel()&&this._onDidSelectReference.fire({element:this._getFocusedReference(),kind:t.ctrlKey||t.metaKey||t.altKey?"side":"open",source:"title"})}_fillBody(t){this.setCssClass("reference-zone-widget"),this._messageContainer=Yc(t,nl("div.messages")),ol(this._messageContainer),this._splitView=new Gj(t,{orientation:1}),this._previewContainer=Yc(t,nl("div.preview.inline")),this._preview=this._instantiationService.createInstance(l4,this._previewContainer,{scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!0},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}},{},this.editor),ol(this._previewContainer),this._previewNotAvailableMessage=new gF(tt(0,"no preview available"),Yd,gF.DEFAULT_CREATION_OPTIONS,null,this._undoRedoService,this._languageService,this._languageConfigurationService),this._treeContainer=Yc(t,nl("div.ref-tree.inline"));const i={keyboardSupport:this._defaultTreeKeyboardSupport,accessibilityProvider:new z4,keyboardNavigationLabelProvider:this._instantiationService.createInstance(B4),identityProvider:new $4,openOnSingleClick:!0,selectionNavigation:!0,overrideStyles:{listBackground:A4}};this._defaultTreeKeyboardSupport&&this._callOnDispose.add(rc(this._treeContainer,"keydown",(t=>{t.equals(9)&&(this._keybindingService.dispatchEvent(t,t.target),t.stopPropagation())}),!0)),this._tree=this._instantiationService.createInstance(Z4,"ReferencesWidget",this._treeContainer,new N4,[this._instantiationService.createInstance(j4),this._instantiationService.createInstance(V4)],this._instantiationService.createInstance(P4),i),this._splitView.addView({onDidChange:ne.None,element:this._previewContainer,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:t=>{this._preview.layout({height:this._dim.height,width:t})}},qj.Distribute),this._splitView.addView({onDidChange:ne.None,element:this._treeContainer,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:t=>{this._treeContainer.style.height=`${this._dim.height}px`,this._treeContainer.style.width=`${t}px`,this._tree.layout(this._dim.height,t)}},qj.Distribute),this._disposables.add(this._splitView.onDidSashChange((()=>{this._dim.width&&(this.layoutData.ratio=this._splitView.getViewSize(0)/this._dim.width)}),void 0));const e=(t,i)=>{t instanceof L4&&(i==="show"&&this._revealReference(t,!1),this._onDidSelectReference.fire({element:t,kind:i,source:"tree"}))};this._tree.onDidOpen((t=>{t.sideBySide?e(t.element,"side"):t.editorOptions.pinned?e(t.element,"goto"):e(t.element,"show")})),ol(this._treeContainer)}_onWidth(t){this._dim&&this._doLayoutBody(this._dim.height,t)}_doLayoutBody(t,i){super._doLayoutBody(t,i),this._dim=new mc(i,t),this.layoutData.heightInLines=this._viewZone?this._viewZone.heightInLines:this.layoutData.heightInLines,this._splitView.layout(i),this._splitView.resizeView(0,i*this.layoutData.ratio)}setSelection(t){return this._revealReference(t,!0).then((()=>{this._model&&(this._tree.setSelection([t]),this._tree.setFocus([t]))}))}setModel(t){return this._disposeOnNewModel.clear(),this._model=t,this._model?this._onNewModel():Promise.resolve()}_onNewModel(){return this._model?this._model.isEmpty?(this.setTitle(""),this._messageContainer.innerText=tt(0,"No results"),rl(this._messageContainer),Promise.resolve(void 0)):(ol(this._messageContainer),this._decorationsManager=new q4(this._preview,this._model),this._disposeOnNewModel.add(this._decorationsManager),this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange((t=>this._tree.rerender(t)))),this._disposeOnNewModel.add(this._preview.onMouseDown((t=>{const{event:i,target:e}=t;if(i.detail!==2)return;const s=this._getFocusedReference();s&&this._onDidSelectReference.fire({element:{uri:s.uri,range:e.range},kind:i.ctrlKey||i.metaKey||i.altKey?"side":"open",source:"editor"})}))),this.container.classList.add("results-loaded"),rl(this._treeContainer),rl(this._previewContainer),this._splitView.layout(this._dim.width),this.focusOnReferenceTree(),this._tree.setInput(this._model.groups.length===1?this._model.groups[0]:this._model)):Promise.resolve(void 0)}_getFocusedReference(){const[t]=this._tree.getFocus();return t instanceof L4?t:t instanceof T4&&t.children.length>0?t.children[0]:void 0}async revealReference(t){await this._revealReference(t,!1),this._onDidSelectReference.fire({element:t,kind:"goto",source:"tree"})}async _revealReference(t,i){if(this._revealedReference===t)return;this._revealedReference=t,t.uri.scheme!==Lh.inMemory?this.setTitle(CM(t.uri),this._uriLabel.getUriLabel(DM(t.uri))):this.setTitle(tt(0,"References"));const e=this._textModelResolverService.createModelReference(t.uri);this._tree.getInput()===t.parent||(i&&this._tree.reveal(t.parent),await this._tree.expand(t.parent)),this._tree.reveal(t);const s=await e;if(!this._model)return void s.dispose();qi(this._previewModelReference);const n=s.object;if(n){const i=this._preview.getModel()===n.textEditorModel?0:1,e=Cs.lift(t.range).collapseToStart();this._previewModelReference=s,this._preview.setModel(n.textEditorModel),this._preview.setSelection(e),this._preview.revealRangeInCenter(e,i)}else this._preview.setModel(this._previewNotAvailableMessage),s.dispose()}};J4=U4([K4(3,AC),K4(4,Bl),K4(5,Il),K4(6,v4),K4(7,wN),K4(8,sF),K4(9,NS),K4(10,Id),K4(11,cf)],J4);var Q4,Y4=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},X4=function(t,i){return function(e,s){i(e,s,t)}};const t5=new Ta("referenceSearchVisible",!1,tt(0,"Whether reference peek is visible, like 'Peek References' or 'Peek Definition'"));let i5=Q4=class{static get(t){return t.getContribution(Q4.ID)}constructor(t,i,e,s,n,r,o,h){this._defaultTreeKeyboardSupport=t,this._editor=i,this._editorService=s,this._notificationService=n,this._instantiationService=r,this._storageService=o,this._configurationService=h,this._disposables=new Ji,this._requestIdPool=0,this._ignoreModelChangeEvent=!1,this._referenceSearchVisible=t5.bindTo(e)}dispose(){var t,i;this._referenceSearchVisible.reset(),this._disposables.dispose(),(t=this._widget)===null||t===void 0||t.dispose(),(i=this._model)===null||i===void 0||i.dispose(),this._widget=void 0,this._model=void 0}toggleWidget(t,i,e){let s;if(this._widget&&(s=this._widget.position),this.closeWidget(),s&&t.containsPosition(s))return;this._peekMode=e,this._referenceSearchVisible.set(!0),this._disposables.add(this._editor.onDidChangeModelLanguage((()=>{this.closeWidget()}))),this._disposables.add(this._editor.onDidChangeModel((()=>{this._ignoreModelChangeEvent||this.closeWidget()})));const n="peekViewLayout",r=G4.fromJSON(this._storageService.get(n,0,"{}"));this._widget=this._instantiationService.createInstance(J4,this._editor,this._defaultTreeKeyboardSupport,r),this._widget.setTitle(tt(0,"Loading...")),this._widget.show(t),this._disposables.add(this._widget.onDidClose((()=>{i.cancel(),this._widget&&(this._storageService.store(n,JSON.stringify(this._widget.layoutData),0,1),this._widget=void 0),this.closeWidget()}))),this._disposables.add(this._widget.onDidSelectReference((t=>{const{element:i,kind:s}=t;if(i)switch(s){case"open":t.source==="editor"&&this._configurationService.getValue("editor.stablePeek")||this.openReference(i,!1,!1);break;case"side":this.openReference(i,!0,!1);break;case"goto":e?this._gotoReference(i,!0):this.openReference(i,!1,!0)}})));const o=++this._requestIdPool;i.then((i=>{var e;if(o===this._requestIdPool&&this._widget)return(e=this._model)===null||e===void 0||e.dispose(),this._model=i,this._widget.setModel(this._model).then((()=>{if(this._widget&&this._model&&this._editor.hasModel()){this._model.isEmpty?this._widget.setMetaTitle(""):this._widget.setMetaTitle(tt(0,"{0} ({1})",this._model.title,this._model.references.length));const i=this._editor.getModel().uri,e=new ks(t.startLineNumber,t.startColumn),s=this._model.nearestReference(i,e);if(s)return this._widget.setSelection(s).then((()=>{this._widget&&this._editor.getOption(87)==="editor"&&this._widget.focusOnPreviewEditor()}))}}));i.dispose()}),(t=>{this._notificationService.error(t)}))}changeFocusBetweenPreviewAndReferences(){this._widget&&(this._widget.isPreviewEditorFocused()?this._widget.focusOnReferenceTree():this._widget.focusOnPreviewEditor())}async goToNextOrPreviousReference(t){if(!this._editor.hasModel()||!this._model||!this._widget)return;const i=this._widget.position;if(!i)return;const e=this._model.nearestReference(this._editor.getModel().uri,i);if(!e)return;const s=this._model.nextOrPreviousReference(e,t),n=this._editor.hasTextFocus(),r=this._widget.isPreviewEditorFocused();await this._widget.setSelection(s),await this._gotoReference(s,!1),n?this._editor.focus():this._widget&&r&&this._widget.focusOnPreviewEditor()}async revealReference(t){this._editor.hasModel()&&this._model&&this._widget&&await this._widget.revealReference(t)}closeWidget(t=!0){var i,e;(i=this._widget)===null||i===void 0||i.dispose(),(e=this._model)===null||e===void 0||e.dispose(),this._referenceSearchVisible.reset(),this._disposables.clear(),this._widget=void 0,this._model=void 0,t&&this._editor.focus(),this._requestIdPool+=1}_gotoReference(t,i){var e;(e=this._widget)===null||e===void 0||e.hide(),this._ignoreModelChangeEvent=!0;const s=Cs.lift(t.range).collapseToStart();return this._editorService.openCodeEditor({resource:t.uri,options:{selection:s,selectionSource:"code.jump",pinned:i}},this._editor).then((t=>{var i;if(this._ignoreModelChangeEvent=!1,t&&this._widget)if(this._editor===t)this._widget.show(s),this._widget.focusOnReferenceTree();else{const e=Q4.get(t),n=this._model.clone();this.closeWidget(),t.focus(),e==null||e.toggleWidget(s,uo((t=>Promise.resolve(n))),(i=this._peekMode)!==null&&i!==void 0&&i)}else this.closeWidget()}),(t=>{this._ignoreModelChangeEvent=!1,Ii(t)}))}openReference(t,i,e){i||this.closeWidget();const{uri:s,range:n}=t;this._editorService.openCodeEditor({resource:s,options:{selection:n,selectionSource:"code.jump",pinned:e}},this._editor,i)}};function e5(t,i){const e=function(t){const i=t.get(Pl).getFocusedCodeEditor();return i instanceof l4?i.getParentEditor():i}(t);if(!e)return;const s=i5.get(e);s&&i(s)}i5.ID="editor.contrib.referencesController",i5=Q4=Y4([X4(2,Ra),X4(3,Pl),X4(4,gR),X4(5,Il),X4(6,nW),X4(7,Md)],i5),Ua.registerCommandAndKeybindingRule({id:"togglePeekWidgetFocus",weight:100,primary:Fe(2089,60),when:ua.or(t5,b4.inPeekEditor),handler(t){e5(t,(t=>{t.changeFocusBetweenPreviewAndReferences()}))}}),Ua.registerCommandAndKeybindingRule({id:"goToNextReference",weight:90,primary:62,secondary:[70],when:ua.or(t5,b4.inPeekEditor),handler(t){e5(t,(t=>{t.goToNextOrPreviousReference(!0)}))}}),Ua.registerCommandAndKeybindingRule({id:"goToPreviousReference",weight:90,primary:1086,secondary:[1094],when:ua.or(t5,b4.inPeekEditor),handler(t){e5(t,(t=>{t.goToNextOrPreviousReference(!1)}))}}),Gl.registerCommandAlias("goToNextReferenceFromEmbeddedEditor","goToNextReference"),Gl.registerCommandAlias("goToPreviousReferenceFromEmbeddedEditor","goToPreviousReference"),Gl.registerCommandAlias("closeReferenceSearchEditor","closeReferenceSearch"),Gl.registerCommand("closeReferenceSearch",(t=>e5(t,(t=>t.closeWidget())))),Ua.registerKeybindingRule({id:"closeReferenceSearch",weight:-1,primary:9,secondary:[1033],when:ua.and(b4.inPeekEditor,ua.not("config.editor.stablePeek"))}),Ua.registerKeybindingRule({id:"closeReferenceSearch",weight:250,primary:9,secondary:[1033],when:ua.and(t5,ua.not("config.editor.stablePeek"),ua.or(Ox.editorTextFocus,DV.negate()))}),Ua.registerCommandAndKeybindingRule({id:"revealReference",weight:200,primary:3,mac:{primary:3,secondary:[2066]},when:ua.and(t5,OV,$V.negate(),jV.negate()),handler(t){var i;const e=(i=t.get(MV).lastFocusedList)===null||i===void 0?void 0:i.getFocus();Array.isArray(e)&&e[0]instanceof L4&&e5(t,(t=>t.revealReference(e[0])))}}),Ua.registerCommandAndKeybindingRule({id:"openReferenceToSide",weight:100,primary:2051,mac:{primary:259},when:ua.and(t5,OV,$V.negate(),jV.negate()),handler(t){var i;const e=(i=t.get(MV).lastFocusedList)===null||i===void 0?void 0:i.getFocus();Array.isArray(e)&&e[0]instanceof L4&&e5(t,(t=>t.openReference(e[0],!0,!0)))}}),Gl.registerCommand("openReference",(t=>{var i;const e=(i=t.get(MV).lastFocusedList)===null||i===void 0?void 0:i.getFocus();Array.isArray(e)&&e[0]instanceof L4&&e5(t,(t=>t.openReference(e[0],!1,!0)))}));var s5=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},n5=function(t,i){return function(e,s){i(e,s,t)}};const r5=new Ta("hasSymbols",!1,tt(0,"Whether there are symbol locations that can be navigated via keyboard-only.")),o5=_l("ISymbolNavigationService");let h5=class{constructor(t,i,e,s){this._editorService=i,this._notificationService=e,this._keybindingService=s,this._currentModel=void 0,this._currentIdx=-1,this._ignoreEditorChange=!1,this._ctxHasSymbols=r5.bindTo(t)}reset(){var t,i;this._ctxHasSymbols.reset(),(t=this._currentState)===null||t===void 0||t.dispose(),(i=this._currentMessage)===null||i===void 0||i.dispose(),this._currentModel=void 0,this._currentIdx=-1}put(t){const i=t.parent.parent;if(i.references.length<=1)return void this.reset();this._currentModel=i,this._currentIdx=i.references.indexOf(t),this._ctxHasSymbols.set(!0),this._showMessage();const e=new c5(this._editorService),s=e.onDidChange((t=>{if(this._ignoreEditorChange)return;const e=this._editorService.getActiveCodeEditor();if(!e)return;const s=e.getModel(),n=e.getPosition();if(!s||!n)return;let r=!1,o=!1;for(const t of i.references)if(kM(t.uri,s.uri))r=!0,o=o||Cs.containsPosition(t.range,n);else if(r)break;r&&o||this.reset()}));this._currentState=Gi(e,s)}revealNext(t){if(!this._currentModel)return Promise.resolve();this._currentIdx+=1,this._currentIdx%=this._currentModel.references.length;const i=this._currentModel.references[this._currentIdx];return this._showMessage(),this._ignoreEditorChange=!0,this._editorService.openCodeEditor({resource:i.uri,options:{selection:Cs.collapseToStart(i.range),selectionRevealType:3}},t).finally((()=>{this._ignoreEditorChange=!1}))}_showMessage(){var t;(t=this._currentMessage)===null||t===void 0||t.dispose();const i=this._keybindingService.lookupKeybinding("editor.gotoNextSymbolFromResult"),e=i?tt(0,"Symbol {0} of {1}, {2} for next",this._currentIdx+1,this._currentModel.references.length,i.getLabel()):tt(0,"Symbol {0} of {1}",this._currentIdx+1,this._currentModel.references.length);this._currentMessage=this._notificationService.status(e)}};h5=s5([n5(0,Ra),n5(1,Pl),n5(2,gR),n5(3,NS)],h5),Nd(o5,h5,1),yu(new class extends pu{constructor(){super({id:"editor.gotoNextSymbolFromResult",precondition:r5,kbOpts:{weight:100,primary:70}})}runEditorCommand(t,i){return t.get(o5).revealNext(i)}}),Ua.registerCommandAndKeybindingRule({id:"editor.gotoNextSymbolFromResult.cancel",weight:100,when:r5,primary:9,handler(t){t.get(o5).reset()}});let c5=class{constructor(t){this._listener=new Map,this._disposables=new Ji,this._onDidChange=new le,this.onDidChange=this._onDidChange.event,this._disposables.add(t.onCodeEditorRemove(this._onDidRemoveEditor,this)),this._disposables.add(t.onCodeEditorAdd(this._onDidAddEditor,this)),t.listCodeEditors().forEach(this._onDidAddEditor,this)}dispose(){this._disposables.dispose(),this._onDidChange.dispose(),qi(this._listener.values())}_onDidAddEditor(t){this._listener.set(t,Gi(t.onDidChangeCursorPosition((i=>this._onDidChange.fire({editor:t}))),t.onDidChangeModelContent((i=>this._onDidChange.fire({editor:t})))))}_onDidRemoveEditor(t){var i;(i=this._listener.get(t))===null||i===void 0||i.dispose(),this._listener.delete(t)}};async function l5(t,i,e,s){const n=e.ordered(t).map((e=>Promise.resolve(s(e,t,i)).then(void 0,(t=>{_i(t)}))));return a((await Promise.all(n)).flat())}function a5(t,i,e,s){return l5(i,e,t,((t,i,e)=>t.provideDefinition(i,e,s)))}function u5(t,i,e,s){return l5(i,e,t,((t,i,e)=>t.provideDeclaration(i,e,s)))}function d5(t,i,e,s){return l5(i,e,t,((t,i,e)=>t.provideImplementation(i,e,s)))}function f5(t,i,e,s){return l5(i,e,t,((t,i,e)=>t.provideTypeDefinition(i,e,s)))}function g5(t,i,e,s,n){return l5(i,e,t,(async(t,i,e)=>{const r=await t.provideReferences(i,e,{includeDeclaration:!0},n);if(!s||!r||r.length!==2)return r;const o=await t.provideReferences(i,e,{includeDeclaration:!1},n);return o&&o.length===1?o:r}))}async function p5(t){const i=await t(),e=new R4(i,""),s=e.references.map((t=>t.link));return e.dispose(),s}var m5,w5,v5,b5,y5,k5,C5,S5;c5=s5([n5(0,Pl)],c5),bu("_executeDefinitionProvider",((t,i,e)=>{const s=a5(t.get($p).definitionProvider,i,e,ve.None);return p5((()=>s))})),bu("_executeTypeDefinitionProvider",((t,i,e)=>{const s=f5(t.get($p).typeDefinitionProvider,i,e,ve.None);return p5((()=>s))})),bu("_executeDeclarationProvider",((t,i,e)=>{const s=u5(t.get($p).declarationProvider,i,e,ve.None);return p5((()=>s))})),bu("_executeReferenceProvider",((t,i,e)=>{const s=g5(t.get($p).referenceProvider,i,e,!1,ve.None);return p5((()=>s))})),bu("_executeImplementationProvider",((t,i,e)=>{const s=d5(t.get($p).implementationProvider,i,e,ve.None);return p5((()=>s))})),tu.appendMenuItem(Qa.EditorContext,{submenu:Qa.EditorContextPeek,title:tt(0,"Peek"),group:"navigation",order:100});class x5{static is(t){return!(!t||typeof t!="object")&&(t instanceof x5||!(!ks.isIPosition(t.position)||!t.model))}constructor(t,i){this.model=t,this.position=i}}class D5 extends vu{static all(){return D5._allSymbolNavigationCommands.values()}static _patchConfig(t){const i={...t,f1:!0};if(i.menu)for(const e of Wt.wrap(i.menu))e.id!==Qa.EditorContext&&e.id!==Qa.EditorContextPeek||(e.when=ua.and(t.precondition,e.when));return i}constructor(t,i){super(D5._patchConfig(i)),this.configuration=t,D5._allSymbolNavigationCommands.set(i.id,this)}runEditorCommand(t,i,e,s){if(!i.hasModel())return Promise.resolve(void 0);const n=t.get(gR),r=t.get(Pl),o=t.get(yN),h=t.get(o5),c=t.get($p),l=t.get(Il),a=i.getModel(),u=i.getPosition(),d=x5.is(e)?e:new x5(a,u),f=new _Q(i,5),g=fo(this._getLocationModel(c,d.model,d.position,f.token),f.token).then((async t=>{var n;if(!t||f.token.isCancellationRequested)return;let o;if(rw(t.ariaMessage),t.referenceAt(a.uri,u)){const t=this._getAlternativeCommand(i);!D5._activeAlternativeCommands.has(t)&&D5._allSymbolNavigationCommands.has(t)&&(o=D5._allSymbolNavigationCommands.get(t))}const c=t.references.length;if(c===0){if(!this.configuration.muteMessage){const t=a.getWordAtPosition(u);(n=A0.get(i))===null||n===void 0||n.showMessage(this._getNoResultFoundMessage(t),u)}}else{if(c!==1||!o)return this._onResult(r,h,i,t,s);D5._activeAlternativeCommands.add(this.desc.id),l.invokeFunction((t=>o.runEditorCommand(t,i,e,s).finally((()=>{D5._activeAlternativeCommands.delete(this.desc.id)}))))}}),(t=>{n.error(t)})).finally((()=>{f.dispose()}));return o.showWhile(g,250),g}async _onResult(t,i,e,s,n){const r=this._getGoToPreference(e);if(e instanceof l4||!(this.configuration.openInPeek||r==="peek"&&s.references.length>1)){const o=s.firstReference(),h=s.references.length>1&&r==="gotoAndPeek",c=await this._openReference(e,t,o,this.configuration.openToSide,!h);h&&c?this._openInPeek(c,s,n):s.dispose(),r==="goto"&&i.put(o)}else this._openInPeek(e,s,n)}async _openReference(t,i,e,s,n){let r;var o;if((o=e)&&as.isUri(o.uri)&&Cs.isIRange(o.range)&&(Cs.isIRange(o.originSelectionRange)||Cs.isIRange(o.targetSelectionRange))&&(r=e.targetSelectionRange),r||(r=e.range),!r)return;const h=await i.openCodeEditor({resource:e.uri,options:{selection:Cs.collapseToStart(r),selectionRevealType:3,selectionSource:"code.jump"}},t,s);if(h){if(n){const t=h.getModel(),i=h.createDecorationsCollection([{range:r,options:{description:"symbol-navigate-action-highlight",className:"symbolHighlight"}}]);setTimeout((()=>{h.getModel()===t&&i.clear()}),350)}return h}}_openInPeek(t,i,e){const s=i5.get(t);s&&t.hasModel()?s.toggleWidget(e??t.getSelection(),uo((t=>Promise.resolve(i))),this.configuration.openInPeek):i.dispose()}}D5._allSymbolNavigationCommands=new Map,D5._activeAlternativeCommands=new Set;class E5 extends D5{async _getLocationModel(t,i,e,s){return new R4(await a5(t.definitionProvider,i,e,s),tt(0,"Definitions"))}_getNoResultFoundMessage(t){return t&&t.word?tt(0,"No definition found for '{0}'",t.word):tt(0,"No definition found")}_getAlternativeCommand(t){return t.getOption(58).alternativeDefinitionCommand}_getGoToPreference(t){return t.getOption(58).multipleDefinitions}}nu(((m5=class extends E5{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:m5.id,title:{...it(0,"Go to Definition"),mnemonicTitle:tt(0,"Go to &&Definition")},precondition:Ox.hasDefinitionProvider,keybinding:[{when:Ox.editorTextFocus,primary:70,weight:100},{when:ua.and(Ox.editorTextFocus,SV),primary:2118,weight:100}],menu:[{id:Qa.EditorContext,group:"navigation",order:1.1},{id:Qa.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:2}]}),Gl.registerCommandAlias("editor.action.goToDeclaration",m5.id)}}).id="editor.action.revealDefinition",m5)),nu(((w5=class extends E5{constructor(){super({openToSide:!0,openInPeek:!1,muteMessage:!1},{id:w5.id,title:it(0,"Open Definition to the Side"),precondition:ua.and(Ox.hasDefinitionProvider,Ox.isInEmbeddedEditor.toNegated()),keybinding:[{when:Ox.editorTextFocus,primary:Fe(2089,70),weight:100},{when:ua.and(Ox.editorTextFocus,SV),primary:Fe(2089,2118),weight:100}]}),Gl.registerCommandAlias("editor.action.openDeclarationToTheSide",w5.id)}}).id="editor.action.revealDefinitionAside",w5)),nu(((v5=class extends E5{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:v5.id,title:it(0,"Peek Definition"),precondition:ua.and(Ox.hasDefinitionProvider,b4.notInPeekEditor,Ox.isInEmbeddedEditor.toNegated()),keybinding:{when:Ox.editorTextFocus,primary:582,linux:{primary:3140},weight:100},menu:{id:Qa.EditorContextPeek,group:"peek",order:2}}),Gl.registerCommandAlias("editor.action.previewDeclaration",v5.id)}}).id="editor.action.peekDefinition",v5));class A5 extends D5{async _getLocationModel(t,i,e,s){return new R4(await u5(t.declarationProvider,i,e,s),tt(0,"Declarations"))}_getNoResultFoundMessage(t){return t&&t.word?tt(0,"No declaration found for '{0}'",t.word):tt(0,"No declaration found")}_getAlternativeCommand(t){return t.getOption(58).alternativeDeclarationCommand}_getGoToPreference(t){return t.getOption(58).multipleDeclarations}}nu(((b5=class extends A5{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:b5.id,title:{...it(0,"Go to Declaration"),mnemonicTitle:tt(0,"Go to &&Declaration")},precondition:ua.and(Ox.hasDeclarationProvider,Ox.isInEmbeddedEditor.toNegated()),menu:[{id:Qa.EditorContext,group:"navigation",order:1.3},{id:Qa.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}_getNoResultFoundMessage(t){return t&&t.word?tt(0,"No declaration found for '{0}'",t.word):tt(0,"No declaration found")}}).id="editor.action.revealDeclaration",b5)),nu(class extends A5{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.peekDeclaration",title:it(0,"Peek Declaration"),precondition:ua.and(Ox.hasDeclarationProvider,b4.notInPeekEditor,Ox.isInEmbeddedEditor.toNegated()),menu:{id:Qa.EditorContextPeek,group:"peek",order:3}})}});class M5 extends D5{async _getLocationModel(t,i,e,s){return new R4(await f5(t.typeDefinitionProvider,i,e,s),tt(0,"Type Definitions"))}_getNoResultFoundMessage(t){return t&&t.word?tt(0,"No type definition found for '{0}'",t.word):tt(0,"No type definition found")}_getAlternativeCommand(t){return t.getOption(58).alternativeTypeDefinitionCommand}_getGoToPreference(t){return t.getOption(58).multipleTypeDefinitions}}nu(((y5=class extends M5{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:y5.ID,title:{...it(0,"Go to Type Definition"),mnemonicTitle:tt(0,"Go to &&Type Definition")},precondition:Ox.hasTypeDefinitionProvider,keybinding:{when:Ox.editorTextFocus,primary:0,weight:100},menu:[{id:Qa.EditorContext,group:"navigation",order:1.4},{id:Qa.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}}).ID="editor.action.goToTypeDefinition",y5)),nu(((k5=class extends M5{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:k5.ID,title:it(0,"Peek Type Definition"),precondition:ua.and(Ox.hasTypeDefinitionProvider,b4.notInPeekEditor,Ox.isInEmbeddedEditor.toNegated()),menu:{id:Qa.EditorContextPeek,group:"peek",order:4}})}}).ID="editor.action.peekTypeDefinition",k5));class L5 extends D5{async _getLocationModel(t,i,e,s){return new R4(await d5(t.implementationProvider,i,e,s),tt(0,"Implementations"))}_getNoResultFoundMessage(t){return t&&t.word?tt(0,"No implementation found for '{0}'",t.word):tt(0,"No implementation found")}_getAlternativeCommand(t){return t.getOption(58).alternativeImplementationCommand}_getGoToPreference(t){return t.getOption(58).multipleImplementations}}nu(((C5=class extends L5{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:C5.ID,title:{...it(0,"Go to Implementations"),mnemonicTitle:tt(0,"Go to &&Implementations")},precondition:Ox.hasImplementationProvider,keybinding:{when:Ox.editorTextFocus,primary:2118,weight:100},menu:[{id:Qa.EditorContext,group:"navigation",order:1.45},{id:Qa.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:4}]})}}).ID="editor.action.goToImplementation",C5)),nu(((S5=class extends L5{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:S5.ID,title:it(0,"Peek Implementations"),precondition:ua.and(Ox.hasImplementationProvider,b4.notInPeekEditor,Ox.isInEmbeddedEditor.toNegated()),keybinding:{when:Ox.editorTextFocus,primary:3142,weight:100},menu:{id:Qa.EditorContextPeek,group:"peek",order:5}})}}).ID="editor.action.peekImplementation",S5));class F5 extends D5{_getNoResultFoundMessage(t){return t?tt(0,"No references found for '{0}'",t.word):tt(0,"No references found")}_getAlternativeCommand(t){return t.getOption(58).alternativeReferenceCommand}_getGoToPreference(t){return t.getOption(58).multipleReferences}}nu(class extends F5{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:"editor.action.goToReferences",title:{...it(0,"Go to References"),mnemonicTitle:tt(0,"Go to &&References")},precondition:ua.and(Ox.hasReferenceProvider,b4.notInPeekEditor,Ox.isInEmbeddedEditor.toNegated()),keybinding:{when:Ox.editorTextFocus,primary:1094,weight:100},menu:[{id:Qa.EditorContext,group:"navigation",order:1.45},{id:Qa.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:5}]})}async _getLocationModel(t,i,e,s){return new R4(await g5(t.referenceProvider,i,e,!0,s),tt(0,"References"))}}),nu(class extends F5{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.referenceSearch.trigger",title:it(0,"Peek References"),precondition:ua.and(Ox.hasReferenceProvider,b4.notInPeekEditor,Ox.isInEmbeddedEditor.toNegated()),menu:{id:Qa.EditorContextPeek,group:"peek",order:6}})}async _getLocationModel(t,i,e,s){return new R4(await g5(t.referenceProvider,i,e,!1,s),tt(0,"References"))}});class T5 extends D5{constructor(t,i,e){super(t,{id:"editor.action.goToLocation",title:it(0,"Go to Any Symbol"),precondition:ua.and(b4.notInPeekEditor,Ox.isInEmbeddedEditor.toNegated())}),this._references=i,this._gotoMultipleBehaviour=e}async _getLocationModel(t,i,e,s){return new R4(this._references,tt(0,"Locations"))}_getNoResultFoundMessage(t){return t&&tt(0,"No results for '{0}'",t.word)||""}_getGoToPreference(t){var i;return(i=this._gotoMultipleBehaviour)!==null&&i!==void 0?i:t.getOption(58).multipleReferences}_getAlternativeCommand(){return""}}Gl.registerCommand({id:"editor.action.goToLocations",metadata:{description:"Go to locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:as},{name:"position",description:"The position at which to start",constraint:ks.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto`"},{name:"noResultsMessage",description:"Human readable message that shows when locations is empty."}]},handler:async(t,i,e,s,n,r,o)=>{j(as.isUri(i)),j(ks.isIPosition(e)),j(Array.isArray(s)),j(n===void 0||typeof n=="string"),j(o===void 0||typeof o=="boolean");const h=t.get(Pl),c=await h.openCodeEditor({resource:i},h.getFocusedCodeEditor());if(NQ(c))return c.setPosition(e),c.revealPositionInCenterIfOutsideViewport(e,0),c.invokeWithinContext((t=>{const i=new class extends T5{_getNoResultFoundMessage(t){return r||super._getNoResultFoundMessage(t)}}({muteMessage:!r,openInPeek:!!o,openToSide:!1},s,n);t.get(Il).invokeFunction(i.run.bind(i),c)}))}}),Gl.registerCommand({id:"editor.action.peekLocations",metadata:{description:"Peek locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:as},{name:"position",description:"The position at which to start",constraint:ks.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto`"}]},handler:async(t,i,e,s,n)=>{t.get(ql).executeCommand("editor.action.goToLocations",i,e,s,n,void 0,!0)}}),Gl.registerCommand({id:"editor.action.findReferences",handler:(t,i,e)=>{j(as.isUri(i)),j(ks.isIPosition(e));const s=t.get($p),n=t.get(Pl);return n.openCodeEditor({resource:i},n.getFocusedCodeEditor()).then((t=>{if(!NQ(t)||!t.hasModel())return;const i=i5.get(t);if(!i)return;const n=uo((i=>g5(s.referenceProvider,t.getModel(),ks.lift(e),!1,i).then((t=>new R4(t,tt(0,"References")))))),r=new Cs(e.lineNumber,e.column,e.lineNumber,e.column);return Promise.resolve(i.toggleWidget(r,n,!1))}))}}),Gl.registerCommandAlias("editor.action.showReferences","editor.action.peekLocations");var R5,O5=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},I5=function(t,i){return function(e,s){i(e,s,t)}};let _5=R5=class{constructor(t,i,e,s){this.textModelResolverService=i,this.languageService=e,this.languageFeaturesService=s,this.toUnhook=new Ji,this.toUnhookForKeyboard=new Ji,this.currentWordAtPosition=null,this.previousPromise=null,this.editor=t,this.linkDecorations=this.editor.createDecorationsCollection();const n=new o4(t);this.toUnhook.add(n),this.toUnhook.add(n.onMouseMoveOrRelevantKeyDown((([t,i])=>{this.startFindDefinitionFromMouse(t,i??void 0)}))),this.toUnhook.add(n.onExecute((t=>{this.isEnabled(t)&&this.gotoDefinition(t.target.position,t.hasSideBySideModifier).catch((t=>{Ii(t)})).finally((()=>{this.removeLinkDecorations()}))}))),this.toUnhook.add(n.onCancel((()=>{this.removeLinkDecorations(),this.currentWordAtPosition=null})))}static get(t){return t.getContribution(R5.ID)}async startFindDefinitionFromCursor(t){await this.startFindDefinition(t),this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition((()=>{this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear()}))),this.toUnhookForKeyboard.add(this.editor.onKeyDown((t=>{t&&(this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear())})))}startFindDefinitionFromMouse(t,i){if(t.target.type===9&&this.linkDecorations.length>0)return;if(!this.editor.hasModel()||!this.isEnabled(t,i))return this.currentWordAtPosition=null,void this.removeLinkDecorations();const e=t.target.position;this.startFindDefinition(e)}async startFindDefinition(t){var i;this.toUnhookForKeyboard.clear();const e=t?(i=this.editor.getModel())===null||i===void 0?void 0:i.getWordAtPosition(t):null;if(!e)return this.currentWordAtPosition=null,void this.removeLinkDecorations();if(this.currentWordAtPosition&&this.currentWordAtPosition.startColumn===e.startColumn&&this.currentWordAtPosition.endColumn===e.endColumn&&this.currentWordAtPosition.word===e.word)return;this.currentWordAtPosition=e;const s=new IQ(this.editor,15);let n;this.previousPromise&&(this.previousPromise.cancel(),this.previousPromise=null),this.previousPromise=uo((i=>this.findDefinition(t,i)));try{n=await this.previousPromise}catch(t){return void Ii(t)}if(!n||!n.length||!s.validate(this.editor))return void this.removeLinkDecorations();const r=n[0].originSelectionRange?Cs.lift(n[0].originSelectionRange):new Cs(t.lineNumber,e.startColumn,t.lineNumber,e.endColumn);if(n.length>1){let t=r;for(const{originSelectionRange:i}of n)i&&(t=Cs.plusRange(t,i));this.addDecoration(t,(new F_).appendText(tt(0,"Click to show {0} definitions.",n.length)))}else{const t=n[0];if(!t.uri)return;this.textModelResolverService.createModelReference(t.uri).then((i=>{if(!i.object||!i.object.textEditorModel)return void i.dispose();const{object:{textEditorModel:e}}=i,{startLineNumber:s}=t.range;if(s<1||s>e.getLineCount())return void i.dispose();const n=this.getPreviewValue(e,s,t),o=this.languageService.guessLanguageIdByFilepathOrFirstLine(e.uri);this.addDecoration(r,n?(new F_).appendCodeblock(o||"",n):void 0),i.dispose()}))}}getPreviewValue(t,i,e){let s=e.range;return s.endLineNumber-s.startLineNumber>=R5.MAX_SOURCE_PREVIEW_LINES&&(s=this.getPreviewRangeBasedOnIndentation(t,i)),this.stripIndentationFromPreviewRange(t,i,s)}stripIndentationFromPreviewRange(t,i,e){let s=t.getLineFirstNonWhitespaceColumn(i);for(let n=i+1;n<e.endLineNumber;n++){const i=t.getLineFirstNonWhitespaceColumn(n);s=Math.min(s,i)}return t.getValueInRange(e).replace(new RegExp(`^\\s{${s-1}}`,"gm"),"").trim()}getPreviewRangeBasedOnIndentation(t,i){const e=t.getLineFirstNonWhitespaceColumn(i),s=Math.min(t.getLineCount(),i+R5.MAX_SOURCE_PREVIEW_LINES);let n=i+1;for(;n<s&&e!==t.getLineFirstNonWhitespaceColumn(n);n++);return new Cs(i,1,n+1,1)}addDecoration(t,i){const e={range:t,options:{description:"goto-definition-link",inlineClassName:"goto-definition-link",hoverMessage:i}};this.linkDecorations.set([e])}removeLinkDecorations(){this.linkDecorations.clear()}isEnabled(t,i){var e;return this.editor.hasModel()&&t.isLeftClick&&t.isNoneOrSingleMouseDown&&t.target.type===6&&!(((e=t.target.detail.injectedText)===null||e===void 0?void 0:e.options)instanceof SF)&&(t.hasTriggerModifier||!!i&&i.keyCodeIsTriggerKey)&&this.languageFeaturesService.definitionProvider.has(this.editor.getModel())}findDefinition(t,i){const e=this.editor.getModel();return e?a5(this.languageFeaturesService.definitionProvider,e,t,i):Promise.resolve(null)}gotoDefinition(t,i){return this.editor.setPosition(t),this.editor.invokeWithinContext((t=>{const e=!i&&this.editor.getOption(88)&&!this.isInPeekEditor(t);return new E5({openToSide:i,openInPeek:e,muteMessage:!0},{title:{value:"",original:""},id:"",precondition:void 0}).run(t)}))}isInPeekEditor(t){const i=t.get(Ra);return b4.inPeekEditor.getValue(i)}dispose(){this.toUnhook.dispose(),this.toUnhookForKeyboard.dispose()}};_5.ID="editor.contrib.gotodefinitionatposition",_5.MAX_SOURCE_PREVIEW_LINES=8,_5=R5=O5([I5(1,Bl),I5(2,Id),I5(3,$p)],_5),Su(_5.ID,_5,2);let P5=class{constructor(t,i,e){this.value=t,this.isComplete=i,this.hasLoadingMessage=e}};class N5 extends Qi{constructor(t,i){super(),this._editor=t,this._computer=i,this._onResult=this._register(new le),this.onResult=this._onResult.event,this._firstWaitScheduler=this._register(new Co((()=>this._triggerAsyncComputation()),0)),this._secondWaitScheduler=this._register(new Co((()=>this._triggerSyncComputation()),0)),this._loadingMessageScheduler=this._register(new Co((()=>this._triggerLoadingMessage()),0)),this._state=0,this._asyncIterable=null,this._asyncIterableDone=!1,this._result=[]}dispose(){this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),super.dispose()}get _hoverTime(){return this._editor.getOption(60).delay}get _firstWaitTime(){return this._hoverTime/2}get _secondWaitTime(){return this._hoverTime-this._firstWaitTime}get _loadingMessageTime(){return 3*this._hoverTime}_setState(t,i=!0){this._state=t,i&&this._fireResult()}_triggerAsyncComputation(){this._setState(2),this._secondWaitScheduler.schedule(this._secondWaitTime),this._computer.computeAsync?(this._asyncIterableDone=!1,this._asyncIterable=function(t){const i=new ye,e=t(i.token);return new Fo(i,(async t=>{const s=i.token.onCancellationRequested((()=>{s.dispose(),i.dispose(),t.reject(new $i)}));try{for await(const s of e){if(i.token.isCancellationRequested)return;t.emitOne(s)}s.dispose(),i.dispose()}catch(e){s.dispose(),i.dispose(),t.reject(e)}}))}((t=>this._computer.computeAsync(t))),(async()=>{try{for await(const t of this._asyncIterable)t&&(this._result.push(t),this._fireResult());this._asyncIterableDone=!0,this._state!==3&&this._state!==4||this._setState(0)}catch(t){Ii(t)}})()):this._asyncIterableDone=!0}_triggerSyncComputation(){this._computer.computeSync&&(this._result=this._result.concat(this._computer.computeSync())),this._setState(this._asyncIterableDone?0:3)}_triggerLoadingMessage(){this._state===3&&this._setState(4)}_fireResult(){if(this._state===1||this._state===2)return;const t=this._state===0,i=this._state===4;this._onResult.fire(new P5(this._result.slice(0),t,i))}start(t){if(t===0)this._state===0&&(this._setState(1),this._firstWaitScheduler.schedule(this._firstWaitTime),this._loadingMessageScheduler.schedule(this._loadingMessageTime));else switch(this._state){case 0:this._triggerAsyncComputation(),this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break;case 2:this._secondWaitScheduler.cancel(),this._triggerSyncComputation()}}cancel(){this._firstWaitScheduler.cancel(),this._secondWaitScheduler.cancel(),this._loadingMessageScheduler.cancel(),this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),this._result=[],this._setState(0,!1)}}class B5{constructor(t,i,e,s){this.priority=t,this.range=i,this.initialMousePosX=e,this.initialMousePosY=s,this.type=1}equals(t){return t.type===1&&this.range.equalsRange(t.range)}canAdoptVisibleHover(t,i){return t.type===1&&i.lineNumber===this.range.startLineNumber}}class $5{constructor(t,i,e,s,n,r){this.priority=t,this.owner=i,this.range=e,this.initialMousePosX=s,this.initialMousePosY=n,this.supportsMarkerHover=r,this.type=2}equals(t){return t.type===2&&this.owner===t.owner}canAdoptVisibleHover(t,i){return t.type===2&&this.owner===t.owner}}const W5=new class{constructor(){this._participants=[]}register(t){this._participants.push(t)}getAll(){return this._participants}};class j5{constructor(){let t;this._onDidWillResize=new le,this.onDidWillResize=this._onDidWillResize.event,this._onDidResize=new le,this.onDidResize=this._onDidResize.event,this._sashListener=new Ji,this._size=new mc(0,0),this._minSize=new mc(0,0),this._maxSize=new mc(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),this.domNode=document.createElement("div"),this._eastSash=new jj(this.domNode,{getVerticalSashLeft:()=>this._size.width},{orientation:0}),this._westSash=new jj(this.domNode,{getVerticalSashLeft:()=>0},{orientation:0}),this._northSash=new jj(this.domNode,{getHorizontalSashTop:()=>0},{orientation:1,orthogonalEdge:Ij.North}),this._southSash=new jj(this.domNode,{getHorizontalSashTop:()=>this._size.height},{orientation:1,orthogonalEdge:Ij.South}),this._northSash.orthogonalStartSash=this._westSash,this._northSash.orthogonalEndSash=this._eastSash,this._southSash.orthogonalStartSash=this._westSash,this._southSash.orthogonalEndSash=this._eastSash;let i=0,e=0;this._sashListener.add(ne.any(this._northSash.onDidStart,this._eastSash.onDidStart,this._southSash.onDidStart,this._westSash.onDidStart)((()=>{t===void 0&&(this._onDidWillResize.fire(),t=this._size,i=0,e=0)}))),this._sashListener.add(ne.any(this._northSash.onDidEnd,this._eastSash.onDidEnd,this._southSash.onDidEnd,this._westSash.onDidEnd)((()=>{t!==void 0&&(t=void 0,i=0,e=0,this._onDidResize.fire({dimension:this._size,done:!0}))}))),this._sashListener.add(this._eastSash.onDidChange((s=>{t&&(e=s.currentX-s.startX,this.layout(t.height+i,t.width+e),this._onDidResize.fire({dimension:this._size,done:!1,east:!0}))}))),this._sashListener.add(this._westSash.onDidChange((s=>{t&&(e=-(s.currentX-s.startX),this.layout(t.height+i,t.width+e),this._onDidResize.fire({dimension:this._size,done:!1,west:!0}))}))),this._sashListener.add(this._northSash.onDidChange((s=>{t&&(i=-(s.currentY-s.startY),this.layout(t.height+i,t.width+e),this._onDidResize.fire({dimension:this._size,done:!1,north:!0}))}))),this._sashListener.add(this._southSash.onDidChange((s=>{t&&(i=s.currentY-s.startY,this.layout(t.height+i,t.width+e),this._onDidResize.fire({dimension:this._size,done:!1,south:!0}))}))),this._sashListener.add(ne.any(this._eastSash.onDidReset,this._westSash.onDidReset)((t=>{this._preferredSize&&(this.layout(this._size.height,this._preferredSize.width),this._onDidResize.fire({dimension:this._size,done:!0}))}))),this._sashListener.add(ne.any(this._northSash.onDidReset,this._southSash.onDidReset)((t=>{this._preferredSize&&(this.layout(this._preferredSize.height,this._size.width),this._onDidResize.fire({dimension:this._size,done:!0}))})))}dispose(){this._northSash.dispose(),this._southSash.dispose(),this._eastSash.dispose(),this._westSash.dispose(),this._sashListener.dispose(),this._onDidResize.dispose(),this._onDidWillResize.dispose(),this.domNode.remove()}enableSashes(t,i,e,s){this._northSash.state=t?3:0,this._eastSash.state=i?3:0,this._southSash.state=e?3:0,this._westSash.state=s?3:0}layout(t=this.size.height,i=this.size.width){const{height:e,width:s}=this._minSize,{height:n,width:r}=this._maxSize;t=Math.max(e,Math.min(n,t)),i=Math.max(s,Math.min(r,i));const o=new mc(i,t);mc.equals(o,this._size)||(this.domNode.style.height=t+"px",this.domNode.style.width=i+"px",this._size=o,this._northSash.layout(),this._eastSash.layout(),this._southSash.layout(),this._westSash.layout())}clearSashHoverState(){this._eastSash.clearSashHoverState(),this._westSash.clearSashHoverState(),this._northSash.clearSashHoverState(),this._southSash.clearSashHoverState()}get size(){return this._size}set maxSize(t){this._maxSize=t}get maxSize(){return this._maxSize}set minSize(t){this._minSize=t}get minSize(){return this._minSize}set preferredSize(t){this._preferredSize=t}get preferredSize(){return this._preferredSize}}class H5 extends Qi{constructor(t,i=new mc(10,10)){super(),this._editor=t,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._resizableNode=this._register(new j5),this._contentPosition=null,this._isResizing=!1,this._resizableNode.domNode.style.position="absolute",this._resizableNode.minSize=mc.lift(i),this._resizableNode.layout(i.height,i.width),this._resizableNode.enableSashes(!0,!0,!0,!0),this._register(this._resizableNode.onDidResize((t=>{this._resize(new mc(t.dimension.width,t.dimension.height)),t.done&&(this._isResizing=!1)}))),this._register(this._resizableNode.onDidWillResize((()=>{this._isResizing=!0})))}get isResizing(){return this._isResizing}getDomNode(){return this._resizableNode.domNode}getPosition(){return this._contentPosition}get position(){var t;return!((t=this._contentPosition)===null||t===void 0)&&t.position?ks.lift(this._contentPosition.position):void 0}_availableVerticalSpaceAbove(t){const i=this._editor.getDomNode(),e=this._editor.getScrolledVisiblePosition(t);if(!(!i||!e))return vc(i).top+e.top-30}_availableVerticalSpaceBelow(t){const i=this._editor.getDomNode(),e=this._editor.getScrolledVisiblePosition(t);if(!i||!e)return;const s=vc(i),n=gc(i.ownerDocument.body),r=s.top+e.top+e.height;return n.height-r-24}_findPositionPreference(t,i){var e,s;const n=Math.min((e=this._availableVerticalSpaceBelow(i))!==null&&e!==void 0?e:1/0,t),r=Math.min((s=this._availableVerticalSpaceAbove(i))!==null&&s!==void 0?s:1/0,t),o=Math.min(Math.max(r,n),t),h=Math.min(t,o);let c;return c=this._editor.getOption(60).above?h<=r?1:2:h<=n?2:1,c===1?this._resizableNode.enableSashes(!0,!0,!1,!1):this._resizableNode.enableSashes(!1,!0,!0,!1),c}_resize(t){this._resizableNode.layout(t.height,t.width)}}var V5,z5,U5=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},K5=function(t,i){return function(e,s){i(e,s,t)}};const q5=nl;let G5=V5=class extends Qi{constructor(t,i,e){super(),this._editor=t,this._instantiationService=i,this._keybindingService=e,this._currentResult=null,this._widget=this._register(this._instantiationService.createInstance(Y5,this._editor)),this._participants=[];for(const t of W5.getAll())this._participants.push(this._instantiationService.createInstance(t,this._editor));this._participants.sort(((t,i)=>t.hoverOrdinal-i.hoverOrdinal)),this._computer=new t3(this._editor,this._participants),this._hoverOperation=this._register(new N5(this._editor,this._computer)),this._register(this._hoverOperation.onResult((t=>{if(!this._computer.anchor)return;const i=t.hasLoadingMessage?this._addLoadingMessage(t.value):t.value;this._withResult(new Z5(this._computer.anchor,i,t.isComplete))}))),this._register(rc(this._widget.getDomNode(),"keydown",(t=>{t.equals(9)&&this.hide()}))),this._register(Us.onDidChange((()=>{this._widget.position&&this._currentResult&&this._setCurrentResult(this._currentResult)})))}_startShowingOrUpdateHover(t,i,e,s,n){return!this._widget.position||!this._currentResult?!!t&&(this._startHoverOperationIfNecessary(t,i,e,s,!1),!0):this._editor.getOption(60).sticky&&n&&this._widget.isMouseGettingCloser(n.event.posx,n.event.posy)?(t&&this._startHoverOperationIfNecessary(t,i,e,s,!0),!0):t?!(!t||!this._currentResult.anchor.equals(t))||(t.canAdoptVisibleHover(this._currentResult.anchor,this._widget.position)?(this._setCurrentResult(this._currentResult.filter(t)),this._startHoverOperationIfNecessary(t,i,e,s,!1),!0):(this._setCurrentResult(null),this._startHoverOperationIfNecessary(t,i,e,s,!1),!0)):(this._setCurrentResult(null),!1)}_startHoverOperationIfNecessary(t,i,e,s,n){this._computer.anchor&&this._computer.anchor.equals(t)||(this._hoverOperation.cancel(),this._computer.anchor=t,this._computer.shouldFocus=s,this._computer.source=e,this._computer.insistOnKeepingHoverVisible=n,this._hoverOperation.start(i))}_setCurrentResult(t){this._currentResult!==t&&(t&&t.messages.length===0&&(t=null),this._currentResult=t,this._currentResult?this._renderMessages(this._currentResult.anchor,this._currentResult.messages):this._widget.hide())}_addLoadingMessage(t){if(this._computer.anchor){for(const i of this._participants)if(i.createLoadingMessage){const e=i.createLoadingMessage(this._computer.anchor);if(e)return t.slice(0).concat([e])}}return t}_withResult(t){this._widget.position&&this._currentResult&&this._currentResult.isComplete&&(!t.isComplete||this._computer.insistOnKeepingHoverVisible&&t.messages.length===0)||this._setCurrentResult(t)}_renderMessages(t,i){const{showAtPosition:e,showAtSecondaryPosition:s,highlightRange:n}=V5.computeHoverRanges(this._editor,t.range,i),r=new Ji,o=r.add(new X5(this._keybindingService)),h=document.createDocumentFragment();let c=null;const l={fragment:h,statusBar:o,setColorPicker:t=>c=t,onContentsChanged:()=>this._widget.onContentsChanged(),setMinimumDimensions:t=>this._widget.setMinimumDimensions(t),hide:()=>this.hide()};for(const t of this._participants){const e=i.filter((i=>i.owner===t));e.length>0&&r.add(t.renderHoverParts(l,e))}const a=i.some((t=>t.isBeforeContent));if(o.hasContent&&h.appendChild(o.hoverElement),h.hasChildNodes()){if(n){const t=this._editor.createDecorationsCollection();t.set([{range:n,options:V5._DECORATION_OPTIONS}]),r.add(Zi((()=>{t.clear()})))}this._widget.showAt(h,new Q5(t.initialMousePosX,t.initialMousePosY,c,e,s,this._editor.getOption(60).above,this._computer.shouldFocus,this._computer.source,a,r))}else r.dispose()}static computeHoverRanges(t,i,e){let s=1;if(t.hasModel()){const e=t._getViewModel(),n=e.coordinatesConverter,r=n.convertModelRangeToViewRange(i),o=new ks(r.startLineNumber,e.getLineMinColumn(r.startLineNumber));s=n.convertViewPositionToModelPosition(o).column}const n=i.startLineNumber;let r=i.startColumn,o=e[0].range,h=null;for(const t of e)o=Cs.plusRange(o,t.range),t.range.startLineNumber===n&&t.range.endLineNumber===n&&(r=Math.max(Math.min(r,t.range.startColumn),s)),t.forceShowAtRange&&(h=t.range);return{showAtPosition:h?h.getStartPosition():new ks(n,i.startColumn),showAtSecondaryPosition:h?h.getStartPosition():new ks(n,r),highlightRange:o}}showsOrWillShow(t){if(this._widget.isResizing)return!0;const i=[];for(const e of this._participants)if(e.suggestHoverAnchor){const s=e.suggestHoverAnchor(t);s&&i.push(s)}const e=t.target;if(e.type===6&&i.push(new B5(0,e.range,t.event.posx,t.event.posy)),e.type===7){const s=this._editor.getOption(50).typicalHalfwidthCharacterWidth/2;!e.detail.isAfterLines&&typeof e.detail.horizontalDistanceToText=="number"&&e.detail.horizontalDistanceToText<s&&i.push(new B5(0,e.range,t.event.posx,t.event.posy))}return i.length===0?this._startShowingOrUpdateHover(null,0,0,!1,t):(i.sort(((t,i)=>i.priority-t.priority)),this._startShowingOrUpdateHover(i[0],0,0,!1,t))}startShowingAtRange(t,i,e,s){this._startShowingOrUpdateHover(new B5(0,t,void 0,void 0),i,e,s,null)}containsNode(t){return!!t&&this._widget.getDomNode().contains(t)}focus(){this._widget.focus()}scrollUp(){this._widget.scrollUp()}scrollDown(){this._widget.scrollDown()}scrollLeft(){this._widget.scrollLeft()}scrollRight(){this._widget.scrollRight()}pageUp(){this._widget.pageUp()}pageDown(){this._widget.pageDown()}goToTop(){this._widget.goToTop()}goToBottom(){this._widget.goToBottom()}hide(){this._computer.anchor=null,this._hoverOperation.cancel(),this._setCurrentResult(null)}get isColorPickerVisible(){return this._widget.isColorPickerVisible}get isVisibleFromKeyboard(){return this._widget.isVisibleFromKeyboard}get isVisible(){return this._widget.isVisible}get isFocused(){return this._widget.isFocused}get isResizing(){return this._widget.isResizing}get widget(){return this._widget}};G5._DECORATION_OPTIONS=xF.register({description:"content-hover-highlight",className:"hoverHighlight"}),G5=V5=U5([K5(1,Il),K5(2,NS)],G5);class Z5{constructor(t,i,e){this.anchor=t,this.messages=i,this.isComplete=e}filter(t){const i=this.messages.filter((i=>i.isValidForHoverAnchor(t)));return i.length===this.messages.length?this:new J5(this,this.anchor,i,this.isComplete)}}class J5 extends Z5{constructor(t,i,e,s){super(i,e,s),this.original=t}filter(t){return this.original.filter(t)}}class Q5{constructor(t,i,e,s,n,r,o,h,c,l){this.initialMousePosX=t,this.initialMousePosY=i,this.colorPicker=e,this.showAtPosition=s,this.showAtSecondaryPosition=n,this.preferAbove=r,this.stoleFocus=o,this.source=h,this.isBeforeContent=c,this.disposables=l,this.closestMouseDistance=void 0}}let Y5=z5=class extends H5{get isColorPickerVisible(){var t;return!!(!((t=this._visibleData)===null||t===void 0)&&t.colorPicker)}get isVisibleFromKeyboard(){var t;return((t=this._visibleData)===null||t===void 0?void 0:t.source)===1}get isVisible(){var t;return(t=this._hoverVisibleKey.get())!==null&&t!==void 0&&t}get isFocused(){var t;return(t=this._hoverFocusedKey.get())!==null&&t!==void 0&&t}constructor(t,i,e,s,n){const r=t.getOption(67)+8,o=new mc(150,r);super(t,o),this._configurationService=e,this._accessibilityService=s,this._keybindingService=n,this._hover=this._register(new cI),this._minimumSize=o,this._hoverVisibleKey=Ox.hoverVisible.bindTo(i),this._hoverFocusedKey=Ox.hoverFocused.bindTo(i),Yc(this._resizableNode.domNode,this._hover.containerDomNode),this._resizableNode.domNode.style.zIndex="50",this._register(this._editor.onDidLayoutChange((()=>{this.isVisible&&this._updateMaxDimensions()}))),this._register(this._editor.onDidChangeConfiguration((t=>{t.hasChanged(50)&&this._updateFont()})));const h=this._register(Qc(this._resizableNode.domNode));this._register(h.onDidFocus((()=>{this._hoverFocusedKey.set(!0)}))),this._register(h.onDidBlur((()=>{this._hoverFocusedKey.set(!1)}))),this._setHoverData(void 0),this._editor.addContentWidget(this)}dispose(){var t;super.dispose(),(t=this._visibleData)===null||t===void 0||t.disposables.dispose(),this._editor.removeContentWidget(this)}getId(){return z5.ID}static _applyDimensions(t,i,e){const s=typeof i=="number"?`${i}px`:i,n=typeof e=="number"?`${e}px`:e;t.style.width=s,t.style.height=n}_setContentsDomNodeDimensions(t,i){const e=this._hover.contentsDomNode;return z5._applyDimensions(e,t,i)}_setContainerDomNodeDimensions(t,i){const e=this._hover.containerDomNode;return z5._applyDimensions(e,t,i)}_setHoverWidgetDimensions(t,i){this._setContentsDomNodeDimensions(t,i),this._setContainerDomNodeDimensions(t,i),this._layoutContentWidget()}static _applyMaxDimensions(t,i,e){const s=typeof i=="number"?`${i}px`:i,n=typeof e=="number"?`${e}px`:e;t.style.maxWidth=s,t.style.maxHeight=n}_setHoverWidgetMaxDimensions(t,i){z5._applyMaxDimensions(this._hover.contentsDomNode,t,i),z5._applyMaxDimensions(this._hover.containerDomNode,t,i),this._hover.containerDomNode.style.setProperty("--vscode-hover-maxWidth",typeof t=="number"?`${t}px`:t),this._layoutContentWidget()}_hasHorizontalScrollbar(){const t=this._hover.scrollbar.getScrollDimensions();return t.scrollWidth>t.width}_adjustContentsBottomPadding(){const t=this._hover.contentsDomNode,i=`${this._hover.scrollbar.options.horizontalScrollbarSize}px`;t.style.paddingBottom!==i&&(t.style.paddingBottom=i)}_setAdjustedHoverWidgetDimensions(t){this._setHoverWidgetMaxDimensions("none","none");const i=t.width,e=t.height;this._setHoverWidgetDimensions(i,e),this._hasHorizontalScrollbar()&&(this._adjustContentsBottomPadding(),this._setContentsDomNodeDimensions(i,e-10))}_updateResizableNodeMaxDimensions(){var t,i;const e=(t=this._findMaximumRenderingWidth())!==null&&t!==void 0?t:1/0,s=(i=this._findMaximumRenderingHeight())!==null&&i!==void 0?i:1/0;this._resizableNode.maxSize=new mc(e,s),this._setHoverWidgetMaxDimensions(e,s)}_resize(t){var i,e;z5._lastDimensions=new mc(t.width,t.height),this._setAdjustedHoverWidgetDimensions(t),this._resizableNode.layout(t.height,t.width),this._updateResizableNodeMaxDimensions(),this._hover.scrollbar.scanDomNode(),this._editor.layoutContentWidget(this),(e=(i=this._visibleData)===null||i===void 0?void 0:i.colorPicker)===null||e===void 0||e.layout()}_findAvailableSpaceVertically(){var t;const i=(t=this._visibleData)===null||t===void 0?void 0:t.showAtPosition;if(i)return this._positionPreference===1?this._availableVerticalSpaceAbove(i):this._availableVerticalSpaceBelow(i)}_findMaximumRenderingHeight(){const t=this._findAvailableSpaceVertically();if(!t)return;let i=6;return Array.from(this._hover.contentsDomNode.children).forEach((t=>{i+=t.clientHeight})),this._hasHorizontalScrollbar()&&(i+=10),Math.min(t,i)}_isHoverTextOverflowing(){this._hover.containerDomNode.style.setProperty("--vscode-hover-whiteSpace","nowrap"),this._hover.containerDomNode.style.setProperty("--vscode-hover-sourceWhiteSpace","nowrap");const t=Array.from(this._hover.contentsDomNode.children).some((t=>t.scrollWidth>t.clientWidth));return this._hover.containerDomNode.style.removeProperty("--vscode-hover-whiteSpace"),this._hover.containerDomNode.style.removeProperty("--vscode-hover-sourceWhiteSpace"),t}_findMaximumRenderingWidth(){if(!this._editor||!this._editor.hasModel())return;const t=this._isHoverTextOverflowing(),i=this._contentWidth===void 0?0:this._contentWidth-2;return t||this._hover.containerDomNode.clientWidth<i?gc(this._hover.containerDomNode.ownerDocument.body).width-14:this._hover.containerDomNode.clientWidth+2}isMouseGettingCloser(t,i){if(!this._visibleData)return!1;if(this._visibleData.initialMousePosX===void 0||this._visibleData.initialMousePosY===void 0)return this._visibleData.initialMousePosX=t,this._visibleData.initialMousePosY=i,!1;const e=vc(this.getDomNode());this._visibleData.closestMouseDistance===void 0&&(this._visibleData.closestMouseDistance=i3(this._visibleData.initialMousePosX,this._visibleData.initialMousePosY,e.left,e.top,e.width,e.height));const s=i3(t,i,e.left,e.top,e.width,e.height);return!(s>this._visibleData.closestMouseDistance+4)&&(this._visibleData.closestMouseDistance=Math.min(this._visibleData.closestMouseDistance,s),!0)}_setHoverData(t){var i;(i=this._visibleData)===null||i===void 0||i.disposables.dispose(),this._visibleData=t,this._hoverVisibleKey.set(!!t),this._hover.containerDomNode.classList.toggle("hidden",!t)}_updateFont(){const{fontSize:t,lineHeight:i}=this._editor.getOption(50),e=this._hover.contentsDomNode;e.style.fontSize=`${t}px`,e.style.lineHeight=""+i/t,Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach((t=>this._editor.applyFontInfo(t)))}_updateContent(t){const i=this._hover.contentsDomNode;i.style.paddingBottom="",i.textContent="",i.appendChild(t)}_layoutContentWidget(){this._editor.layoutContentWidget(this),this._hover.onContentsChanged()}_updateMaxDimensions(){const t=Math.max(this._editor.getLayoutInfo().height/4,250,z5._lastDimensions.height),i=Math.max(.66*this._editor.getLayoutInfo().width,500,z5._lastDimensions.width);this._setHoverWidgetMaxDimensions(i,t)}_render(t,i){this._setHoverData(i),this._updateFont(),this._updateContent(t),this._updateMaxDimensions(),this.onContentsChanged(),this._editor.render()}getPosition(){var t;return this._visibleData?{position:this._visibleData.showAtPosition,secondaryPosition:this._visibleData.showAtSecondaryPosition,positionAffinity:this._visibleData.isBeforeContent?3:void 0,preference:[(t=this._positionPreference)!==null&&t!==void 0?t:1]}:null}showAt(t,i){var e,s,n,r;if(!this._editor||!this._editor.hasModel())return;this._render(t,i);const o=Sc(this._hover.containerDomNode),h=i.showAtPosition;this._positionPreference=(e=this._findPositionPreference(o,h))!==null&&e!==void 0?e:1,this.onContentsChanged(),i.stoleFocus&&this._hover.containerDomNode.focus(),(s=i.colorPicker)===null||s===void 0||s.layout();const c=this._hover.containerDomNode.ownerDocument.activeElement===this._hover.containerDomNode&&aI(this._configurationService.getValue("accessibility.verbosity.hover")===!0&&this._accessibilityService.isScreenReaderOptimized(),(r=(n=this._keybindingService.lookupKeybinding("editor.action.accessibleView"))===null||n===void 0?void 0:n.getAriaLabel())!==null&&r!==void 0?r:"");c&&(this._hover.contentsDomNode.ariaLabel=this._hover.contentsDomNode.textContent+", "+c)}hide(){if(!this._visibleData)return;const t=this._visibleData.stoleFocus||this._hoverFocusedKey.get();this._setHoverData(void 0),this._resizableNode.maxSize=new mc(1/0,1/0),this._resizableNode.clearSashHoverState(),this._hoverFocusedKey.set(!1),this._editor.layoutContentWidget(this),t&&this._editor.focus()}_removeConstraintsRenderNormally(){const t=this._editor.getLayoutInfo();this._resizableNode.layout(t.height,t.width),this._setHoverWidgetDimensions("auto","auto")}_adjustHoverHeightForScrollbar(t){var i;const e=this._hover.containerDomNode,s=this._hover.contentsDomNode,n=(i=this._findMaximumRenderingHeight())!==null&&i!==void 0?i:1/0;this._setContainerDomNodeDimensions(yc(e),Math.min(n,t)),this._setContentsDomNodeDimensions(yc(s),Math.min(n,t-10))}setMinimumDimensions(t){this._minimumSize=new mc(Math.max(this._minimumSize.width,t.width),Math.max(this._minimumSize.height,t.height)),this._updateMinimumWidth()}_updateMinimumWidth(){const t=this._contentWidth===void 0?this._minimumSize.width:Math.min(this._contentWidth,this._minimumSize.width);this._resizableNode.minSize=new mc(t,this._minimumSize.height)}onContentsChanged(){var t;this._removeConstraintsRenderNormally();const i=this._hover.containerDomNode;let e=Sc(i),s=yc(i);if(this._resizableNode.layout(e,s),this._setHoverWidgetDimensions(s,e),e=Sc(i),s=yc(i),this._contentWidth=s,this._updateMinimumWidth(),this._resizableNode.layout(e,s),this._hasHorizontalScrollbar()&&(this._adjustContentsBottomPadding(),this._adjustHoverHeightForScrollbar(e)),(t=this._visibleData)===null||t===void 0?void 0:t.showAtPosition){const t=Sc(this._hover.containerDomNode);this._positionPreference=this._findPositionPreference(t,this._visibleData.showAtPosition)}this._layoutContentWidget()}focus(){this._hover.containerDomNode.focus()}scrollUp(){const t=this._hover.scrollbar.getScrollPosition().scrollTop,i=this._editor.getOption(50);this._hover.scrollbar.setScrollPosition({scrollTop:t-i.lineHeight})}scrollDown(){const t=this._hover.scrollbar.getScrollPosition().scrollTop,i=this._editor.getOption(50);this._hover.scrollbar.setScrollPosition({scrollTop:t+i.lineHeight})}scrollLeft(){const t=this._hover.scrollbar.getScrollPosition().scrollLeft;this._hover.scrollbar.setScrollPosition({scrollLeft:t-30})}scrollRight(){const t=this._hover.scrollbar.getScrollPosition().scrollLeft;this._hover.scrollbar.setScrollPosition({scrollLeft:t+30})}pageUp(){const t=this._hover.scrollbar.getScrollPosition().scrollTop,i=this._hover.scrollbar.getScrollDimensions().height;this._hover.scrollbar.setScrollPosition({scrollTop:t-i})}pageDown(){const t=this._hover.scrollbar.getScrollPosition().scrollTop,i=this._hover.scrollbar.getScrollDimensions().height;this._hover.scrollbar.setScrollPosition({scrollTop:t+i})}goToTop(){this._hover.scrollbar.setScrollPosition({scrollTop:0})}goToBottom(){this._hover.scrollbar.setScrollPosition({scrollTop:this._hover.scrollbar.getScrollDimensions().scrollHeight})}};Y5.ID="editor.contrib.resizableContentHoverWidget",Y5._lastDimensions=new mc(0,0),Y5=z5=U5([K5(1,Ra),K5(2,Md),K5(3,vw),K5(4,NS)],Y5);let X5=class extends Qi{get hasContent(){return this._hasContent}constructor(t){super(),this._keybindingService=t,this._hasContent=!1,this.hoverElement=q5("div.hover-row.status-bar"),this.actionsElement=Yc(this.hoverElement,q5("div.actions"))}addAction(t){const i=this._keybindingService.lookupKeybinding(t.commandId),e=i?i.getLabel():null;return this._hasContent=!0,this._register(lI.render(this.actionsElement,t,e))}append(t){const i=Yc(this.actionsElement,t);return this._hasContent=!0,i}};X5=U5([K5(0,NS)],X5);class t3{get anchor(){return this._anchor}set anchor(t){this._anchor=t}get shouldFocus(){return this._shouldFocus}set shouldFocus(t){this._shouldFocus=t}get source(){return this._source}set source(t){this._source=t}get insistOnKeepingHoverVisible(){return this._insistOnKeepingHoverVisible}set insistOnKeepingHoverVisible(t){this._insistOnKeepingHoverVisible=t}constructor(t,i){this._editor=t,this._participants=i,this._anchor=null,this._shouldFocus=!1,this._source=0,this._insistOnKeepingHoverVisible=!1}static _getLineDecorations(t,i){if(i.type!==1&&!i.supportsMarkerHover)return[];const e=t.getModel(),s=i.range.startLineNumber;if(s>e.getLineCount())return[];const n=e.getLineMaxColumn(s);return t.getLineDecorations(s).filter((t=>{if(t.options.isWholeLine)return!0;const e=t.range.startLineNumber===s?t.range.startColumn:1,r=t.range.endLineNumber===s?t.range.endColumn:n;if(t.options.showIfCollapsed){if(e>i.range.startColumn+1||i.range.endColumn-1>r)return!1}else if(e>i.range.startColumn||i.range.endColumn>r)return!1;return!0}))}computeAsync(t){const i=this._anchor;if(!this._editor.hasModel()||!i)return Lo.EMPTY;const e=t3._getLineDecorations(this._editor,i);return Lo.merge(this._participants.map((s=>s.computeAsync?s.computeAsync(i,e,t):Lo.EMPTY)))}computeSync(){if(!this._editor.hasModel()||!this._anchor)return[];const t=t3._getLineDecorations(this._editor,this._anchor);let i=[];for(const e of this._participants)i=i.concat(e.computeSync(this._anchor,t));return a(i)}}function i3(t,i,e,s,n,r){const o=e+n/2,h=s+r/2,c=Math.max(Math.abs(t-o)-n/2,0),l=Math.max(Math.abs(i-h)-r/2,0);return Math.sqrt(c*c+l*l)}const e3=nl;class s3 extends Qi{constructor(t,i,e){super(),this._renderDisposeables=this._register(new Ji),this._editor=t,this._isVisible=!1,this._messages=[],this._hover=this._register(new cI),this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible),this._markdownRenderer=this._register(new fP({editor:this._editor},i,e)),this._computer=new n3(this._editor),this._hoverOperation=this._register(new N5(this._editor,this._computer)),this._register(this._hoverOperation.onResult((t=>{this._withResult(t.value)}))),this._register(this._editor.onDidChangeModelDecorations((()=>this._onModelDecorationsChanged()))),this._register(this._editor.onDidChangeConfiguration((t=>{t.hasChanged(50)&&this._updateFont()}))),this._editor.addOverlayWidget(this)}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return s3.ID}getDomNode(){return this._hover.containerDomNode}getPosition(){return null}_updateFont(){Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach((t=>this._editor.applyFontInfo(t)))}_onModelDecorationsChanged(){this._isVisible&&(this._hoverOperation.cancel(),this._hoverOperation.start(0))}startShowingAt(t,i){this._computer.lineNumber===t&&this._computer.lane===i||(this._hoverOperation.cancel(),this.hide(),this._computer.lineNumber=t,this._computer.lane=i,this._hoverOperation.start(0))}hide(){this._computer.lineNumber=-1,this._hoverOperation.cancel(),this._isVisible&&(this._isVisible=!1,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible))}_withResult(t){this._messages=t,this._messages.length>0?this._renderMessages(this._computer.lineNumber,this._messages):this.hide()}_renderMessages(t,i){this._renderDisposeables.clear();const e=document.createDocumentFragment();for(const t of i){const i=e3("div.hover-row.markdown-hover"),s=Yc(i,e3("div.hover-contents")),n=this._renderDisposeables.add(this._markdownRenderer.render(t.value));s.appendChild(n.element),e.appendChild(i)}this._updateContents(e),this._showAt(t)}_updateContents(t){this._hover.contentsDomNode.textContent="",this._hover.contentsDomNode.appendChild(t),this._updateFont()}_showAt(t){this._isVisible||(this._isVisible=!0,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible));const i=this._editor.getLayoutInfo(),e=this._editor.getTopForLineNumber(t),s=this._editor.getScrollTop(),n=this._editor.getOption(67),r=e-s-(this._hover.containerDomNode.clientHeight-n)/2,o=i.glyphMarginLeft+i.glyphMarginWidth+(this._computer.lane==="lineNo"?i.lineNumbersWidth:0);this._hover.containerDomNode.style.left=`${o}px`,this._hover.containerDomNode.style.top=`${Math.max(Math.round(r),0)}px`}}s3.ID="editor.contrib.modesGlyphHoverWidget";class n3{get lineNumber(){return this._lineNumber}set lineNumber(t){this._lineNumber=t}get lane(){return this._laneOrLine}set lane(t){this._laneOrLine=t}constructor(t){this._editor=t,this._lineNumber=-1,this._laneOrLine=Xf.Center}computeSync(){var t,i;const e=t=>({value:t}),s=this._editor.getLineDecorations(this._lineNumber),n=[],r=this._laneOrLine==="lineNo";if(!s)return n;for(const o of s){const s=(i=(t=o.options.glyphMargin)===null||t===void 0?void 0:t.position)!==null&&i!==void 0?i:Xf.Center;if(!r&&s!==this._laneOrLine)continue;const h=r?o.options.lineNumberHoverMessage:o.options.glyphMarginHoverMessage;h&&!T_(h)&&n.push(...k(h).map(e))}return n}}class r3{constructor(t,i,e){this.provider=t,this.hover=i,this.ordinal=e}}function o3(t,i,e,s){const n=t.ordered(i).map(((t,n)=>async function(t,i,e,s,n){try{const r=await Promise.resolve(t.provideHover(e,s,n));if(r&&function(t){const i=t.range!==void 0,e=t.contents!==void 0&&t.contents&&t.contents.length>0;return i&&e}(r))return new r3(t,r,i)}catch(t){_i(t)}}(t,n,i,e,s)));return Lo.fromPromises(n).coalesce()}bu("_executeHoverProvider",((t,i,e)=>function(t,i,e,s){return o3(t,i,e,s).map((t=>t.hover)).toPromise()}(t.get($p).hoverProvider,i,e,ve.None)));var h3=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},c3=function(t,i){return function(e,s){i(e,s,t)}};const l3=nl;class a3{constructor(t,i,e,s,n){this.owner=t,this.range=i,this.contents=e,this.isBeforeContent=s,this.ordinal=n}isValidForHoverAnchor(t){return t.type===1&&this.range.startColumn<=t.range.startColumn&&this.range.endColumn>=t.range.endColumn}}let u3=class{constructor(t,i,e,s,n){this._editor=t,this._languageService=i,this._openerService=e,this._configurationService=s,this._languageFeaturesService=n,this.hoverOrdinal=3}createLoadingMessage(t){return new a3(this,t.range,[(new F_).appendText(tt(0,"Loading..."))],!1,2e3)}computeSync(t,i){if(!this._editor.hasModel()||t.type!==1)return[];const e=this._editor.getModel(),s=t.range.startLineNumber,n=e.getLineMaxColumn(s),r=[];let o=1e3;const h=e.getLineLength(s),c=e.getLanguageIdAtPosition(t.range.startLineNumber,t.range.startColumn),l=this._editor.getOption(117),a=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:c});let u=!1;l>=0&&h>l&&t.range.startColumn>=l&&(u=!0,r.push(new a3(this,t.range,[{value:tt(0,"Rendering paused for long line for performance reasons. This can be configured via `editor.stopRenderingLineAfter`.")}],!1,o++))),!u&&typeof a=="number"&&h>=a&&r.push(new a3(this,t.range,[{value:tt(0,"Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.")}],!1,o++));let d=!1;for(const e of i){const i=e.range.startLineNumber===s?e.range.startColumn:1,h=e.range.endLineNumber===s?e.range.endColumn:n,c=e.options.hoverMessage;if(!c||T_(c))continue;e.options.beforeContentClassName&&(d=!0);const l=new Cs(t.range.startLineNumber,i,t.range.startLineNumber,h);r.push(new a3(this,l,k(c),d,o++))}return r}computeAsync(t,i,e){if(!this._editor.hasModel()||t.type!==1)return Lo.EMPTY;const s=this._editor.getModel();if(!this._languageFeaturesService.hoverProvider.has(s))return Lo.EMPTY;const n=new ks(t.range.startLineNumber,t.range.startColumn);return o3(this._languageFeaturesService.hoverProvider,s,n,e).filter((t=>!T_(t.hover.contents))).map((i=>{const e=i.hover.range?Cs.lift(i.hover.range):t.range;return new a3(this,e,i.hover.contents,!1,i.ordinal)}))}renderHoverParts(t,i){return d3(t,i,this._editor,this._languageService,this._openerService)}};function d3(t,i,e,s,n){i.sort(((t,i)=>t.ordinal-i.ordinal));const r=new Ji;for(const o of i)for(const i of o.contents){if(T_(i))continue;const o=l3("div.hover-row.markdown-hover"),h=Yc(o,l3("div.hover-contents")),c=r.add(new fP({editor:e},s,n));r.add(c.onDidRenderAsync((()=>{h.className="hover-contents code-hover-contents",t.onContentsChanged()})));const l=r.add(c.render(i));h.appendChild(l.element),t.fragment.appendChild(o)}return r}u3=h3([c3(1,Id),c3(2,uI),c3(3,Md),c3(4,$p)],u3);var f3=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},g3=function(t,i){return function(e,s){i(e,s,t)}};class p3{constructor(t,i,e){this.marker=t,this.index=i,this.total=e}}let m3=class{constructor(t,i,e){this._markerService=i,this._configService=e,this._onDidChange=new le,this.onDidChange=this._onDidChange.event,this._dispoables=new Ji,this._markers=[],this._nextIdx=-1,as.isUri(t)?this._resourceFilter=i=>i.toString()===t.toString():t&&(this._resourceFilter=t);const s=this._configService.getValue("problems.sortOrder"),n=(t,i)=>{let e=sr(t.resource.toString(),i.resource.toString());return e===0&&(e=s==="position"?Cs.compareRangesUsingStarts(t,i)||QW.compare(t.severity,i.severity):QW.compare(t.severity,i.severity)||Cs.compareRangesUsingStarts(t,i)),e},r=()=>{this._markers=this._markerService.read({resource:as.isUri(t)?t:void 0,severities:QW.Error|QW.Warning|QW.Info}),typeof t=="function"&&(this._markers=this._markers.filter((t=>this._resourceFilter(t.resource)))),this._markers.sort(n)};r(),this._dispoables.add(i.onMarkerChanged((t=>{this._resourceFilter&&!t.some((t=>this._resourceFilter(t)))||(r(),this._nextIdx=-1,this._onDidChange.fire())})))}dispose(){this._dispoables.dispose(),this._onDidChange.dispose()}matches(t){return!this._resourceFilter&&!t||!(!this._resourceFilter||!t)&&this._resourceFilter(t)}get selected(){const t=this._markers[this._nextIdx];return t&&new p3(t,this._nextIdx+1,this._markers.length)}_initIdx(t,i,e){let s=!1,n=this._markers.findIndex((i=>i.resource.toString()===t.uri.toString()));n<0&&(n=r(this._markers,{resource:t.uri},((t,i)=>sr(t.resource.toString(),i.resource.toString()))),n<0&&(n=~n));for(let e=n;e<this._markers.length;e++){let n=Cs.lift(this._markers[e]);if(n.isEmpty()){const i=t.getWordAtPosition(n.getStartPosition());i&&(n=new Cs(n.startLineNumber,i.startColumn,n.startLineNumber,i.endColumn))}if(i&&(n.containsPosition(i)||i.isBeforeOrEqual(n.getStartPosition()))){this._nextIdx=e,s=!0;break}if(this._markers[e].resource.toString()!==t.uri.toString())break}s||(this._nextIdx=e?0:this._markers.length-1),this._nextIdx<0&&(this._nextIdx=this._markers.length-1)}resetIndex(){this._nextIdx=-1}move(t,i,e){if(this._markers.length===0)return!1;const s=this._nextIdx;return this._nextIdx===-1?this._initIdx(i,e,t):t?this._nextIdx=(this._nextIdx+1)%this._markers.length:t||(this._nextIdx=(this._nextIdx-1+this._markers.length)%this._markers.length),s!==this._nextIdx}find(t,i){let e=this._markers.findIndex((i=>i.resource.toString()===t.toString()));if(!(e<0)){for(;e<this._markers.length;e++)if(Cs.containsPosition(this._markers[e],i))return new p3(this._markers[e],e+1,this._markers.length)}}};m3=f3([g3(1,XW),g3(2,Md)],m3);const w3=_l("IMarkerNavigationService");let v3=class{constructor(t,i){this._markerService=t,this._configService=i,this._provider=new Ht}getMarkerList(t){for(const i of this._provider){const e=i.getMarkerList(t);if(e)return e}return new m3(t,this._markerService,this._configService)}};var b3;v3=f3([g3(0,XW),g3(1,Md)],v3),Nd(w3,v3,1),function(t){t.className=function(t){switch(t){case dR.Ignore:return"severity-ignore "+Kl.asClassName(As.info);case dR.Info:return Kl.asClassName(As.info);case dR.Warning:return Kl.asClassName(As.warning);case dR.Error:return Kl.asClassName(As.error);default:return""}}}(b3||(b3={}));var y3,k3=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},C3=function(t,i){return function(e,s){i(e,s,t)}};class S3{constructor(t,i,e,s,n){this._openerService=s,this._labelService=n,this._lines=0,this._longestLineLength=0,this._relatedDiagnostics=new WeakMap,this._disposables=new Ji,this._editor=i;const r=document.createElement("div");r.className="descriptioncontainer",this._messageBlock=document.createElement("div"),this._messageBlock.classList.add("message"),this._messageBlock.setAttribute("aria-live","assertive"),this._messageBlock.setAttribute("role","alert"),r.appendChild(this._messageBlock),this._relatedBlock=document.createElement("div"),r.appendChild(this._relatedBlock),this._disposables.add(rc(this._relatedBlock,"click",(t=>{t.preventDefault();const i=this._relatedDiagnostics.get(t.target);i&&e(i)}))),this._scrollable=new sC(r,{horizontal:1,vertical:1,useShadows:!1,horizontalScrollbarSize:6,verticalScrollbarSize:6}),t.appendChild(this._scrollable.getDomNode()),this._disposables.add(this._scrollable.onScroll((t=>{r.style.left=`-${t.scrollLeft}px`,r.style.top=`-${t.scrollTop}px`}))),this._disposables.add(this._scrollable)}dispose(){qi(this._disposables)}update(t){const{source:i,message:e,relatedInformation:s,code:n}=t;let r=((i==null?void 0:i.length)||0)+2;n&&(r+=typeof n=="string"?n.length:n.value.length);const o=Xn(e);this._lines=o.length,this._longestLineLength=0;for(const t of o)this._longestLineLength=Math.max(t.length+r,this._longestLineLength);ic(this._messageBlock),this._messageBlock.setAttribute("aria-label",this.getAriaLabel(t)),this._editor.applyFontInfo(this._messageBlock);let h=this._messageBlock;for(const t of o)h=document.createElement("div"),h.innerText=t,t===""&&(h.style.height=this._messageBlock.style.lineHeight),this._messageBlock.appendChild(h);if(i||n){const t=document.createElement("span");if(t.classList.add("details"),h.appendChild(t),i){const e=document.createElement("span");e.innerText=i,e.classList.add("source"),t.appendChild(e)}if(n)if(typeof n=="string"){const i=document.createElement("span");i.innerText=`(${n})`,i.classList.add("code"),t.appendChild(i)}else this._codeLink=nl("a.code-link"),this._codeLink.setAttribute("href",`${n.target.toString()}`),this._codeLink.onclick=t=>{this._openerService.open(n.target,{allowCommands:!0}),t.preventDefault(),t.stopPropagation()},Yc(this._codeLink,nl("span")).innerText=n.value,t.appendChild(this._codeLink)}if(ic(this._relatedBlock),this._editor.applyFontInfo(this._relatedBlock),f(s)){const t=this._relatedBlock.appendChild(document.createElement("div"));t.style.paddingTop=`${Math.floor(.66*this._editor.getOption(67))}px`,this._lines+=1;for(const i of s){const e=document.createElement("div"),s=document.createElement("a");s.classList.add("filename"),s.innerText=`${this._labelService.getUriBasenameLabel(i.resource)}(${i.startLineNumber}, ${i.startColumn}): `,s.title=this._labelService.getUriLabel(i.resource),this._relatedDiagnostics.set(s,i);const n=document.createElement("span");n.innerText=i.message,e.appendChild(s),e.appendChild(n),this._lines+=1,t.appendChild(e)}}const c=this._editor.getOption(50),l=Math.ceil(c.typicalFullwidthCharacterWidth*this._longestLineLength*.75),a=c.lineHeight*this._lines;this._scrollable.setScrollDimensions({scrollWidth:l,scrollHeight:a})}layout(t,i){this._scrollable.getDomNode().style.height=`${t}px`,this._scrollable.getDomNode().style.width=`${i}px`,this._scrollable.setScrollDimensions({width:i,height:t})}getHeightInLines(){return Math.min(17,this._lines)}getAriaLabel(t){let i="";switch(t.severity){case QW.Error:i=tt(0,"Error");break;case QW.Warning:i=tt(0,"Warning");break;case QW.Info:i=tt(0,"Info");break;case QW.Hint:i=tt(0,"Hint")}let e=tt(0,"{0} at {1}. ",i,t.startLineNumber+":"+t.startColumn);const s=this._editor.getModel();return s&&t.startLineNumber<=s.getLineCount()&&t.startLineNumber>=1&&(e=`${s.getLineContent(t.startLineNumber)}, ${e}`),e}}let x3=y3=class extends C4{constructor(t,i,e,s,n,r,o){super(t,{showArrow:!0,showFrame:!0,isAccessible:!0,frameWidth:1},n),this._themeService=i,this._openerService=e,this._menuService=s,this._contextKeyService=r,this._labelService=o,this._callOnDispose=new Ji,this._onDidSelectRelatedInformation=new le,this.onDidSelectRelatedInformation=this._onDidSelectRelatedInformation.event,this._severity=QW.Warning,this._backgroundColor=kp.white,this._applyTheme(i.getColorTheme()),this._callOnDispose.add(i.onDidColorThemeChange(this._applyTheme.bind(this))),this.create()}_applyTheme(t){this._backgroundColor=t.getColor(I3);let i=M3,e=L3;this._severity===QW.Warning?(i=F3,e=T3):this._severity===QW.Info&&(i=R3,e=O3);const s=t.getColor(i),n=t.getColor(e);this.style({arrowColor:s,frameColor:s,headerBackgroundColor:n,primaryHeadingColor:t.getColor(x4),secondaryHeadingColor:t.getColor(D4)})}_applyStyles(){this._parentContainer&&(this._parentContainer.style.backgroundColor=this._backgroundColor?this._backgroundColor.toString():""),super._applyStyles()}dispose(){this._callOnDispose.dispose(),super.dispose()}_fillHead(t){super._fillHead(t),this._disposables.add(this._actionbarWidget.actionRunner.onWillRun((t=>this.editor.focus())));const i=[],e=this._menuService.createMenu(y3.TitleMenu,this._contextKeyService);CW(e,void 0,i),this._actionbarWidget.push(i,{label:!1,icon:!0,index:0}),e.dispose()}_fillTitleIcon(t){this._icon=Yc(t,nl(""))}_fillBody(t){this._parentContainer=t,t.classList.add("marker-widget"),this._parentContainer.tabIndex=0,this._parentContainer.setAttribute("role","tooltip"),this._container=document.createElement("div"),t.appendChild(this._container),this._message=new S3(this._container,this.editor,(t=>this._onDidSelectRelatedInformation.fire(t)),this._openerService,this._labelService),this._disposables.add(this._message)}show(){throw new Error("call showAtMarker")}showAtMarker(t,i,e){this._container.classList.remove("stale"),this._message.update(t),this._severity=t.severity,this._applyTheme(this._themeService.getColorTheme());const s=Cs.lift(t),n=this.editor.getPosition(),r=n&&s.containsPosition(n)?n:s.getStartPosition();super.show(r,this.computeRequiredHeight());const o=this.editor.getModel();if(o){const t=tt(0,e>1?"{0} of {1} problems":"{0} of {1} problem",i,e);this.setTitle(SM(o.uri),t)}this._icon.className=`codicon ${b3.className(QW.toSeverity(this._severity))}`,this.editor.revealPositionNearTop(r,0),this.editor.focus()}updateMarker(t){this._container.classList.remove("stale"),this._message.update(t)}showStale(){this._container.classList.add("stale"),this._relayout()}_doLayoutBody(t,i){super._doLayoutBody(t,i),this._heightInPixel=t,this._message.layout(t,i),this._container.style.height=`${t}px`}_onWidth(t){this._message.layout(this._heightInPixel,t)}_relayout(){super._relayout(this.computeRequiredHeight())}computeRequiredHeight(){return 3+this._message.getHeightInLines()}};x3.TitleMenu=new Qa("gotoErrorTitleMenu"),x3=y3=k3([C3(1,AC),C3(2,uI),C3(3,Ya),C3(4,Il),C3(5,Ra),C3(6,wN)],x3);const D3=Bw(cv,lv),E3=Bw(uv,dv),A3=Bw(fv,gv),M3=Iw("editorMarkerNavigationError.background",{dark:D3,light:D3,hcDark:qw,hcLight:qw},tt(0,"Editor marker navigation widget error color.")),L3=Iw("editorMarkerNavigationError.headerBackground",{dark:Nw(M3,.1),light:Nw(M3,.1),hcDark:null,hcLight:null},tt(0,"Editor marker navigation widget error heading background.")),F3=Iw("editorMarkerNavigationWarning.background",{dark:E3,light:E3,hcDark:qw,hcLight:qw},tt(0,"Editor marker navigation widget warning color.")),T3=Iw("editorMarkerNavigationWarning.headerBackground",{dark:Nw(F3,.1),light:Nw(F3,.1),hcDark:"#0C141F",hcLight:Nw(F3,.2)},tt(0,"Editor marker navigation widget warning heading background.")),R3=Iw("editorMarkerNavigationInfo.background",{dark:A3,light:A3,hcDark:qw,hcLight:qw},tt(0,"Editor marker navigation widget info color.")),O3=Iw("editorMarkerNavigationInfo.headerBackground",{dark:Nw(R3,.1),light:Nw(R3,.1),hcDark:null,hcLight:null},tt(0,"Editor marker navigation widget info heading background.")),I3=Iw("editorMarkerNavigation.background",{dark:sv,light:sv,hcDark:sv,hcLight:sv},tt(0,"Editor marker navigation widget background."));var _3,P3=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},N3=function(t,i){return function(e,s){i(e,s,t)}};let B3=_3=class{static get(t){return t.getContribution(_3.ID)}constructor(t,i,e,s,n){this._markerNavigationService=i,this._contextKeyService=e,this._editorService=s,this._instantiationService=n,this._sessionDispoables=new Ji,this._editor=t,this._widgetVisible=H3.bindTo(this._contextKeyService)}dispose(){this._cleanUp(),this._sessionDispoables.dispose()}_cleanUp(){this._widgetVisible.reset(),this._sessionDispoables.clear(),this._widget=void 0,this._model=void 0}_getOrCreateModel(t){if(this._model&&this._model.matches(t))return this._model;let i=!1;return this._model&&(i=!0,this._cleanUp()),this._model=this._markerNavigationService.getMarkerList(t),i&&this._model.move(!0,this._editor.getModel(),this._editor.getPosition()),this._widget=this._instantiationService.createInstance(x3,this._editor),this._widget.onDidClose((()=>this.close()),this,this._sessionDispoables),this._widgetVisible.set(!0),this._sessionDispoables.add(this._model),this._sessionDispoables.add(this._widget),this._sessionDispoables.add(this._editor.onDidChangeCursorPosition((t=>{var i,e,s;!((i=this._model)===null||i===void 0)&&i.selected&&Cs.containsPosition((e=this._model)===null||e===void 0?void 0:e.selected.marker,t.position)||(s=this._model)===null||s===void 0||s.resetIndex()}))),this._sessionDispoables.add(this._model.onDidChange((()=>{if(!this._widget||!this._widget.position||!this._model)return;const t=this._model.find(this._editor.getModel().uri,this._widget.position);t?this._widget.updateMarker(t.marker):this._widget.showStale()}))),this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation((t=>{this._editorService.openCodeEditor({resource:t.resource,options:{pinned:!0,revealIfOpened:!0,selection:Cs.lift(t).collapseToStart()}},this._editor),this.close(!1)}))),this._sessionDispoables.add(this._editor.onDidChangeModel((()=>this._cleanUp()))),this._model}close(t=!0){this._cleanUp(),t&&this._editor.focus()}showAtMarker(t){if(this._editor.hasModel()){const i=this._getOrCreateModel(this._editor.getModel().uri);i.resetIndex(),i.move(!0,this._editor.getModel(),new ks(t.startLineNumber,t.startColumn)),i.selected&&this._widget.showAtMarker(i.selected.marker,i.selected.index,i.selected.total)}}async nagivate(t,i){var e,s;if(this._editor.hasModel()){const n=this._getOrCreateModel(i?void 0:this._editor.getModel().uri);if(n.move(t,this._editor.getModel(),this._editor.getPosition()),!n.selected)return;if(n.selected.marker.resource.toString()!==this._editor.getModel().uri.toString()){this._cleanUp();const r=await this._editorService.openCodeEditor({resource:n.selected.marker.resource,options:{pinned:!1,revealIfOpened:!0,selectionRevealType:2,selection:n.selected.marker}},this._editor);r&&((e=_3.get(r))===null||e===void 0||e.close(),(s=_3.get(r))===null||s===void 0||s.nagivate(t,i))}else this._widget.showAtMarker(n.selected.marker,n.selected.index,n.selected.total)}}};B3.ID="editor.contrib.markerController",B3=_3=P3([N3(1,w3),N3(2,Ra),N3(3,Pl),N3(4,Il)],B3);class $3 extends mu{constructor(t,i,e){super(e),this._next=t,this._multiFile=i}async run(t,i){var e;i.hasModel()&&((e=B3.get(i))===null||e===void 0||e.nagivate(this._next,this._multiFile))}}class W3 extends $3{constructor(){super(!0,!1,{id:W3.ID,label:W3.LABEL,alias:"Go to Next Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:Ox.focus,primary:578,weight:100},menuOpts:{menuId:x3.TitleMenu,title:W3.LABEL,icon:qU("marker-navigation-next",As.arrowDown,tt(0,"Icon for goto next marker.")),group:"navigation",order:1}})}}W3.ID="editor.action.marker.next",W3.LABEL=tt(0,"Go to Next Problem (Error, Warning, Info)");class j3 extends $3{constructor(){super(!1,!1,{id:j3.ID,label:j3.LABEL,alias:"Go to Previous Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:Ox.focus,primary:1602,weight:100},menuOpts:{menuId:x3.TitleMenu,title:j3.LABEL,icon:qU("marker-navigation-previous",As.arrowUp,tt(0,"Icon for goto previous marker.")),group:"navigation",order:2}})}}j3.ID="editor.action.marker.prev",j3.LABEL=tt(0,"Go to Previous Problem (Error, Warning, Info)");Su(B3.ID,B3,4),ku(W3),ku(j3),ku(class extends $3{constructor(){super(!0,!0,{id:"editor.action.marker.nextInFiles",label:tt(0,"Go to Next Problem in Files (Error, Warning, Info)"),alias:"Go to Next Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:Ox.focus,primary:66,weight:100},menuOpts:{menuId:Qa.MenubarGoMenu,title:tt(0,"Next &&Problem"),group:"6_problem_nav",order:1}})}}),ku(class extends $3{constructor(){super(!1,!0,{id:"editor.action.marker.prevInFiles",label:tt(0,"Go to Previous Problem in Files (Error, Warning, Info)"),alias:"Go to Previous Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:Ox.focus,primary:1090,weight:100},menuOpts:{menuId:Qa.MenubarGoMenu,title:tt(0,"Previous &&Problem"),group:"6_problem_nav",order:2}})}});const H3=new Ta("markersNavigationVisible",!1);yu(new(pu.bindToContribution(B3.get))({id:"closeMarkersNavigation",precondition:H3,handler:t=>t.close(),kbOpts:{weight:150,kbExpr:Ox.focus,primary:9,secondary:[1033]}}));var V3=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},z3=function(t,i){return function(e,s){i(e,s,t)}};const U3=nl;class K3{constructor(t,i,e){this.owner=t,this.range=i,this.marker=e}isValidForHoverAnchor(t){return t.type===1&&this.range.startColumn<=t.range.startColumn&&this.range.endColumn>=t.range.endColumn}}const q3={type:1,filter:{include:Q0.QuickFix},triggerAction:Y0.QuickFixHover};let G3=class{constructor(t,i,e,s){this._editor=t,this._markerDecorationsService=i,this._openerService=e,this._languageFeaturesService=s,this.hoverOrdinal=1,this.recentMarkerCodeActionsInfo=void 0}computeSync(t,i){if(!this._editor.hasModel()||t.type!==1&&!t.supportsMarkerHover)return[];const e=this._editor.getModel(),s=t.range.startLineNumber,n=e.getLineMaxColumn(s),r=[];for(const o of i){const i=o.range.startLineNumber===s?o.range.startColumn:1,h=o.range.endLineNumber===s?o.range.endColumn:n,c=this._markerDecorationsService.getMarker(e.uri,o);if(!c)continue;const l=new Cs(t.range.startLineNumber,i,t.range.startLineNumber,h);r.push(new K3(this,l,c))}return r}renderHoverParts(t,i){if(!i.length)return Qi.None;const e=new Ji;i.forEach((i=>t.fragment.appendChild(this.renderMarkerHover(i,e))));const s=i.length===1?i[0]:i.sort(((t,i)=>QW.compare(t.marker.severity,i.marker.severity)))[0];return this.renderMarkerStatusbar(t,s,e),e}renderMarkerHover(t,i){const e=U3("div.hover-row"),s=Yc(e,U3("div.marker.hover-contents")),{source:n,message:r,code:o,relatedInformation:h}=t.marker;this._editor.applyFontInfo(s);const c=Yc(s,U3("span"));if(c.style.whiteSpace="pre-wrap",c.innerText=r,n||o)if(o&&typeof o!="string"){const t=U3("span");n&&(Yc(t,U3("span")).innerText=n);const e=Yc(t,U3("a.code-link"));e.setAttribute("href",o.target.toString()),i.add(sc(e,"click",(t=>{this._openerService.open(o.target,{allowCommands:!0}),t.preventDefault(),t.stopPropagation()}))),Yc(e,U3("span")).innerText=o.value;const r=Yc(s,t);r.style.opacity="0.6",r.style.paddingLeft="6px"}else{const t=Yc(s,U3("span"));t.style.opacity="0.6",t.style.paddingLeft="6px",t.innerText=n&&o?`${n}(${o})`:n||`(${o})`}if(f(h))for(const{message:t,resource:e,startLineNumber:n,startColumn:r}of h){const o=Yc(s,U3("div"));o.style.marginTop="8px";const h=Yc(o,U3("a"));h.innerText=`${SM(e)}(${n}, ${r}): `,h.style.cursor="pointer",i.add(sc(h,"click",(t=>{t.stopPropagation(),t.preventDefault(),this._openerService&&this._openerService.open(e,{fromUserGesture:!0,editorOptions:{selection:{startLineNumber:n,startColumn:r}}}).catch(Ii)})));const c=Yc(o,U3("span"));c.innerText=t,this._editor.applyFontInfo(c)}return e}renderMarkerStatusbar(t,i,e){if(i.marker.severity===QW.Error||i.marker.severity===QW.Warning||i.marker.severity===QW.Info){const e=B3.get(this._editor);e&&t.statusBar.addAction({label:tt(0,"View Problem"),commandId:W3.ID,run:()=>{t.hide(),e.showAtMarker(i.marker),this._editor.focus()}})}if(!this._editor.getOption(91)){const s=t.statusBar.append(U3("div"));this.recentMarkerCodeActionsInfo&&(YW.makeKey(this.recentMarkerCodeActionsInfo.marker)===YW.makeKey(i.marker)?this.recentMarkerCodeActionsInfo.hasCodeActions||(s.textContent=tt(0,"No quick fixes available")):this.recentMarkerCodeActionsInfo=void 0);const n=this.recentMarkerCodeActionsInfo&&!this.recentMarkerCodeActionsInfo.hasCodeActions?Qi.None:vo((()=>s.textContent=tt(0,"Checking for quick fixes...")),200,e);s.textContent||(s.textContent=" ");const r=this.getCodeActions(i.marker);e.add(Zi((()=>r.cancel()))),r.then((r=>{if(n.dispose(),this.recentMarkerCodeActionsInfo={marker:i.marker,hasCodeActions:r.validActions.length>0},!this.recentMarkerCodeActionsInfo.hasCodeActions)return r.dispose(),void(s.textContent=tt(0,"No quick fixes available"));s.style.display="none";let o=!1;e.add(Zi((()=>{o||r.dispose()}))),t.statusBar.addAction({label:tt(0,"Quick Fix..."),commandId:s1,run:i=>{o=!0;const e=Y1.get(this._editor),s=vc(i);t.hide(),e==null||e.showCodeActions(q3,r,{x:s.left,y:s.top,width:s.width,height:s.height})}})}),Ii)}}getCodeActions(t){return uo((i=>u1(this._languageFeaturesService.codeActionProvider,this._editor.getModel(),new Cs(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn),q3,bN.None,i)))}};G3=V3([z3(1,cw),z3(2,uI),z3(3,$p)],G3);const Z3="editor.action.inlineSuggest.commit",J3="editor.action.inlineSuggest.showPrevious",Q3="editor.action.inlineSuggest.showNext";var Y3,X3=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},t6=function(t,i){return function(e,s){i(e,s,t)}};let i6=class extends Qi{constructor(t,i,e){super(),this.editor=t,this.model=i,this.instantiationService=e,this.alwaysShowToolbar=e$(this.editor.onDidChangeConfiguration,(()=>this.editor.getOption(62).showToolbar==="always")),this.sessionPosition=void 0,this.position=zB(this,(t=>{var i,e,s;const n=(i=this.model.read(t))===null||i===void 0?void 0:i.primaryGhostText.read(t);if(!this.alwaysShowToolbar.read(t)||!n||n.parts.length===0)return this.sessionPosition=void 0,null;const r=n.parts[0].column;this.sessionPosition&&this.sessionPosition.lineNumber!==n.lineNumber&&(this.sessionPosition=void 0);const o=new ks(n.lineNumber,Math.min(r,(s=(e=this.sessionPosition)===null||e===void 0?void 0:e.column)!==null&&s!==void 0?s:Number.MAX_SAFE_INTEGER));return this.sessionPosition=o,o})),this._register(YB(((i,e)=>{const s=this.model.read(i);if(!s||!this.alwaysShowToolbar.read(i))return;const n=e.add(this.instantiationService.createInstance(n6,this.editor,!0,this.position,s.selectedInlineCompletionIndex,s.inlineCompletionsCount,s.selectedInlineCompletion.map((t=>{var i;return(i=t==null?void 0:t.inlineCompletion.source.inlineCompletions.commands)!==null&&i!==void 0?i:[]}))));t.addContentWidget(n),e.add(Zi((()=>t.removeContentWidget(n)))),e.add(ZB((t=>{this.position.read(t)&&s.lastTriggerKind.read(t)!==Os.Explicit&&s.triggerExplicitly()})))})))}};i6=X3([t6(2,Il)],i6);const e6=qU("inline-suggestion-hints-next",As.chevronRight,tt(0,"Icon for show next parameter hint.")),s6=qU("inline-suggestion-hints-previous",As.chevronLeft,tt(0,"Icon for show previous parameter hint."));let n6=Y3=class extends Qi{static get dropDownVisible(){return this._dropDownVisible}createCommandAction(t,i,e){const s=new $l(t,i,e,!0,(()=>this._commandService.executeCommand(t))),n=this.keybindingService.lookupKeybinding(t,this._contextKeyService);let r=i;return n&&(r=tt(0,"{0} ({1})",i,n.getLabel())),s.tooltip=r,s}constructor(t,i,e,s,r,o,h,c,l,a,u){super(),this.editor=t,this.withBorder=i,this._position=e,this._currentSuggestionIdx=s,this._suggestionCount=r,this._extraCommands=o,this._commandService=h,this.keybindingService=l,this._contextKeyService=a,this._menuService=u,this.id="InlineSuggestionHintsContentWidget"+Y3.id++,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this.nodes=ml("div.inlineSuggestionsHints",{className:this.withBorder?".withBorder":""},[ml("div@toolBar")]),this.previousAction=this.createCommandAction(J3,tt(0,"Previous"),Kl.asClassName(s6)),this.availableSuggestionCountAction=new $l("inlineSuggestionHints.availableSuggestionCount","",void 0,!1),this.nextAction=this.createCommandAction(Q3,tt(0,"Next"),Kl.asClassName(e6)),this.inlineCompletionsActionsMenus=this._register(this._menuService.createMenu(Qa.InlineCompletionsActions,this._contextKeyService)),this.clearAvailableSuggestionCountLabelDebounced=this._register(new Co((()=>{this.availableSuggestionCountAction.label=""}),100)),this.disableButtonsDebounced=this._register(new Co((()=>{this.previousAction.enabled=this.nextAction.enabled=!1}),100)),this.lastCommands=[],this.toolBar=this._register(c.createInstance(h6,this.nodes.toolBar,Qa.InlineSuggestionToolbar,{menuOptions:{renderShortTitle:!0},toolbarOptions:{primaryGroup:t=>t.startsWith("primary")},actionViewItemProvider:(t,i)=>{if(t instanceof eu)return c.createInstance(o6,t,void 0);if(t===this.availableSuggestionCountAction){const i=new r6(void 0,t,{label:!0,icon:!1});return i.setClass("availableSuggestionCount"),i}},telemetrySource:"InlineSuggestionToolbar"})),this.toolBar.setPrependedPrimaryActions([this.previousAction,this.availableSuggestionCountAction,this.nextAction]),this._register(this.toolBar.onDidChangeDropdownVisibility((t=>{Y3._dropDownVisible=t}))),this._register(ZB((t=>{this._position.read(t),this.editor.layoutContentWidget(this)}))),this._register(ZB((t=>{const i=this._suggestionCount.read(t),e=this._currentSuggestionIdx.read(t);i!==void 0?(this.clearAvailableSuggestionCountLabelDebounced.cancel(),this.availableSuggestionCountAction.label=`${e+1}/${i}`):this.clearAvailableSuggestionCountLabelDebounced.schedule(),i!==void 0&&i>1?(this.disableButtonsDebounced.cancel(),this.previousAction.enabled=this.nextAction.enabled=!0):this.disableButtonsDebounced.schedule()}))),this._register(ZB((t=>{const i=this._extraCommands.read(t);if(n(this.lastCommands,i))return;this.lastCommands=i;const e=i.map((t=>({class:void 0,id:t.id,enabled:!0,tooltip:t.tooltip||"",label:t.title,run:i=>this._commandService.executeCommand(t.id)})));for(const[t,i]of this.inlineCompletionsActionsMenus.getActions())for(const t of i)t instanceof eu&&e.push(t);e.length>0&&e.unshift(new jl),this.toolBar.setAdditionalSecondaryActions(e)})))}getId(){return this.id}getDomNode(){return this.nodes.root}getPosition(){return{position:this._position.get(),preference:[1,2],positionAffinity:3}}};n6._dropDownVisible=!1,n6.id=0,n6=Y3=X3([t6(6,ql),t6(7,Il),t6(8,NS),t6(9,Ra),t6(10,Ya)],n6);class r6 extends G${constructor(){super(...arguments),this._className=void 0}setClass(t){this._className=t}render(t){super.render(t),this._className&&t.classList.add(this._className)}updateTooltip(){}}let o6=class extends xW{updateLabel(){const t=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!t)return super.updateLabel();if(this.label){const i=ml("div.keybinding").root;this._register(new Nz(i,Ft,{disableTitle:!0,...Pz})).set(t),this.label.textContent=this._action.label,this.label.appendChild(i),this.label.classList.add("inlineSuggestionStatusBarItemLabel")}}updateTooltip(){}},h6=class extends SZ{constructor(t,i,e,s,n,r,o,h){super(t,{resetMenu:i,...e},s,n,r,o,h),this.menuId=i,this.options2=e,this.menuService=s,this.contextKeyService=n,this.menu=this._store.add(this.menuService.createMenu(this.menuId,this.contextKeyService,{emitEventsForSubmenuChanges:!0})),this.additionalActions=[],this.prependedPrimaryActions=[],this._store.add(this.menu.onDidChange((()=>this.updateToolbar()))),this.updateToolbar()}updateToolbar(){var t,i,e,s,n,r,o;const h=[],c=[];CW(this.menu,(t=this.options2)===null||t===void 0?void 0:t.menuOptions,{primary:h,secondary:c},(e=(i=this.options2)===null||i===void 0?void 0:i.toolbarOptions)===null||e===void 0?void 0:e.primaryGroup,(n=(s=this.options2)===null||s===void 0?void 0:s.toolbarOptions)===null||n===void 0?void 0:n.shouldInlineSubmenu,(o=(r=this.options2)===null||r===void 0?void 0:r.toolbarOptions)===null||o===void 0?void 0:o.useSeparatorsInPrimaryActions),c.push(...this.additionalActions),h.unshift(...this.prependedPrimaryActions),this.setActions(h,c)}setPrependedPrimaryActions(t){n(this.prependedPrimaryActions,t,((t,i)=>t===i))||(this.prependedPrimaryActions=t,this.updateToolbar())}setAdditionalSecondaryActions(t){n(this.additionalActions,t,((t,i)=>t===i))||(this.additionalActions=t,this.updateToolbar())}};h6=X3([t6(3,Ya),t6(4,Ra),t6(5,oI),t6(6,NS),t6(7,ru)],h6);var c6,l6=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},a6=function(t,i){return function(e,s){i(e,s,t)}};let u6=c6=class extends Qi{constructor(t,i,e,s,n){super(),this._editor=t,this._instantiationService=i,this._openerService=e,this._languageService=s,this._keybindingService=n,this._listenersStore=new Ji,this._hoverState={mouseDown:!1,contentHoverFocused:!1,activatedByDecoratorClick:!1},this._reactToEditorMouseMoveRunner=this._register(new Co((()=>this._reactToEditorMouseMove(this._mouseMoveEvent)),0)),this._hookListeners(),this._register(this._editor.onDidChangeConfiguration((t=>{t.hasChanged(60)&&(this._unhookListeners(),this._hookListeners())})))}static get(t){return t.getContribution(c6.ID)}_hookListeners(){const t=this._editor.getOption(60);this._hoverSettings={enabled:t.enabled,sticky:t.sticky,hidingDelay:t.delay},t.enabled?(this._listenersStore.add(this._editor.onMouseDown((t=>this._onEditorMouseDown(t)))),this._listenersStore.add(this._editor.onMouseUp((()=>this._onEditorMouseUp()))),this._listenersStore.add(this._editor.onMouseMove((t=>this._onEditorMouseMove(t)))),this._listenersStore.add(this._editor.onKeyDown((t=>this._onKeyDown(t))))):(this._listenersStore.add(this._editor.onMouseMove((t=>this._onEditorMouseMove(t)))),this._listenersStore.add(this._editor.onKeyDown((t=>this._onKeyDown(t))))),this._listenersStore.add(this._editor.onMouseLeave((t=>this._onEditorMouseLeave(t)))),this._listenersStore.add(this._editor.onDidChangeModel((()=>{this._cancelScheduler(),this._hideWidgets()}))),this._listenersStore.add(this._editor.onDidChangeModelContent((()=>this._cancelScheduler()))),this._listenersStore.add(this._editor.onDidScrollChange((t=>this._onEditorScrollChanged(t))))}_unhookListeners(){this._listenersStore.clear()}_cancelScheduler(){this._mouseMoveEvent=void 0,this._reactToEditorMouseMoveRunner.cancel()}_onEditorScrollChanged(t){(t.scrollTopChanged||t.scrollLeftChanged)&&this._hideWidgets()}_onEditorMouseDown(t){var i;this._hoverState.mouseDown=!0;const e=t.target;e.type!==9||e.detail!==Y5.ID?e.type===12&&e.detail===s3.ID||(e.type!==12&&(this._hoverState.contentHoverFocused=!1),!((i=this._contentWidget)===null||i===void 0)&&i.widget.isResizing||this._hideWidgets()):this._hoverState.contentHoverFocused=!0}_onEditorMouseUp(){this._hoverState.mouseDown=!1}_onEditorMouseLeave(t){var i,e;this._cancelScheduler();const s=t.event.browserEvent.relatedTarget;!((i=this._contentWidget)===null||i===void 0)&&i.widget.isResizing||!((e=this._contentWidget)===null||e===void 0)&&e.containsNode(s)||this._hideWidgets()}_isMouseOverWidget(t){var i,e,s,n,r;const o=t.target,h=this._hoverSettings.sticky;return!(!h||o.type!==9||o.detail!==Y5.ID)||!(!h||!(!((i=this._contentWidget)===null||i===void 0)&&i.containsNode((e=t.event.browserEvent.view)===null||e===void 0?void 0:e.document.activeElement))||!((n=(s=t.event.browserEvent.view)===null||s===void 0?void 0:s.getSelection())===null||n===void 0)&&n.isCollapsed)||!(h||o.type!==9||o.detail!==Y5.ID||!(!((r=this._contentWidget)===null||r===void 0)&&r.isColorPickerVisible))||!(!h||o.type!==12||o.detail!==s3.ID)}_onEditorMouseMove(t){var i,e,s,n;if(this._mouseMoveEvent=t,((i=this._contentWidget)===null||i===void 0?void 0:i.isFocused)||((e=this._contentWidget)===null||e===void 0?void 0:e.isResizing)||this._hoverState.mouseDown&&this._hoverState.contentHoverFocused)return;const r=this._hoverSettings.sticky;if(r&&(!((s=this._contentWidget)===null||s===void 0)&&s.isVisibleFromKeyboard))return;if(this._isMouseOverWidget(t))return void this._reactToEditorMouseMoveRunner.cancel();const o=this._hoverSettings.hidingDelay;!((n=this._contentWidget)===null||n===void 0)&&n.isVisible&&r&&o>0?this._reactToEditorMouseMoveRunner.isScheduled()||this._reactToEditorMouseMoveRunner.schedule(o):this._reactToEditorMouseMove(t)}_reactToEditorMouseMove(t){var i,e,s,n;if(!t)return;const r=t.target,o=(i=r.element)===null||i===void 0?void 0:i.classList.contains("colorpicker-color-decoration"),h=this._editor.getOption(148),c=this._hoverSettings.enabled,l=this._hoverState.activatedByDecoratorClick;if(o&&(h==="click"&&!l||h==="hover"&&!c||h==="clickAndHover"&&!c&&!l)||!o&&!c&&!l)return void this._hideWidgets();this._getOrCreateContentWidget().showsOrWillShow(t)?(e=this._glyphWidget)===null||e===void 0||e.hide():r.type===2&&r.position&&r.detail.glyphMarginLane?((s=this._contentWidget)===null||s===void 0||s.hide(),this._getOrCreateGlyphWidget().startShowingAt(r.position.lineNumber,r.detail.glyphMarginLane)):r.type===3&&r.position?((n=this._contentWidget)===null||n===void 0||n.hide(),this._getOrCreateGlyphWidget().startShowingAt(r.position.lineNumber,"lineNo")):this._hideWidgets()}_onKeyDown(t){var i;if(!this._editor.hasModel())return;const e=this._keybindingService.softDispatch(t,this._editor.getDomNode()),s=e.kind===1||e.kind===2&&e.commandId==="editor.action.showHover"&&((i=this._contentWidget)===null||i===void 0?void 0:i.isVisible);t.keyCode===5||t.keyCode===6||t.keyCode===57||t.keyCode===4||s||this._hideWidgets()}_hideWidgets(){var t,i,e;this._hoverState.mouseDown&&this._hoverState.contentHoverFocused&&(!((t=this._contentWidget)===null||t===void 0)&&t.isColorPickerVisible)||n6.dropDownVisible||(this._hoverState.activatedByDecoratorClick=!1,this._hoverState.contentHoverFocused=!1,(i=this._glyphWidget)===null||i===void 0||i.hide(),(e=this._contentWidget)===null||e===void 0||e.hide())}_getOrCreateContentWidget(){return this._contentWidget||(this._contentWidget=this._instantiationService.createInstance(G5,this._editor)),this._contentWidget}_getOrCreateGlyphWidget(){return this._glyphWidget||(this._glyphWidget=new s3(this._editor,this._languageService,this._openerService)),this._glyphWidget}showContentHover(t,i,e,s,n=!1){this._hoverState.activatedByDecoratorClick=n,this._getOrCreateContentWidget().startShowingAtRange(t,i,e,s)}focus(){var t;(t=this._contentWidget)===null||t===void 0||t.focus()}scrollUp(){var t;(t=this._contentWidget)===null||t===void 0||t.scrollUp()}scrollDown(){var t;(t=this._contentWidget)===null||t===void 0||t.scrollDown()}scrollLeft(){var t;(t=this._contentWidget)===null||t===void 0||t.scrollLeft()}scrollRight(){var t;(t=this._contentWidget)===null||t===void 0||t.scrollRight()}pageUp(){var t;(t=this._contentWidget)===null||t===void 0||t.pageUp()}pageDown(){var t;(t=this._contentWidget)===null||t===void 0||t.pageDown()}goToTop(){var t;(t=this._contentWidget)===null||t===void 0||t.goToTop()}goToBottom(){var t;(t=this._contentWidget)===null||t===void 0||t.goToBottom()}get isColorPickerVisible(){var t;return(t=this._contentWidget)===null||t===void 0?void 0:t.isColorPickerVisible}get isHoverVisible(){var t;return(t=this._contentWidget)===null||t===void 0?void 0:t.isVisible}dispose(){var t,i;super.dispose(),this._unhookListeners(),this._listenersStore.dispose(),(t=this._glyphWidget)===null||t===void 0||t.dispose(),(i=this._contentWidget)===null||i===void 0||i.dispose()}};var d6;u6.ID="editor.contrib.hover",u6=c6=l6([a6(1,Il),a6(2,uI),a6(3,Id),a6(4,NS)],u6),function(t){t.NoAutoFocus="noAutoFocus",t.FocusIfVisible="focusIfVisible",t.AutoFocusImmediately="autoFocusImmediately"}(d6||(d6={}));Su(u6.ID,u6,2),ku(class extends mu{constructor(){super({id:"editor.action.showHover",label:tt(0,"Show or Focus Hover"),metadata:{description:"Show or Focus Hover",args:[{name:"args",schema:{type:"object",properties:{focus:{description:"Controls if and when the hover should take focus upon being triggered by this action.",enum:[d6.NoAutoFocus,d6.FocusIfVisible,d6.AutoFocusImmediately],enumDescriptions:[tt(0,"The hover will not automatically take focus."),tt(0,"The hover will take focus only if it is already visible."),tt(0,"The hover will automatically take focus when it appears.")],default:d6.FocusIfVisible}}}}]},alias:"Show or Focus Hover",precondition:void 0,kbOpts:{kbExpr:Ox.editorTextFocus,primary:Fe(2089,2087),weight:100}})}run(t,i,e){if(!i.hasModel())return;const s=u6.get(i);if(!s)return;const n=e==null?void 0:e.focus;let r=d6.FocusIfVisible;Object.values(d6).includes(n)?r=n:typeof n=="boolean"&&n&&(r=d6.AutoFocusImmediately);const o=t=>{const e=i.getPosition(),n=new Cs(e.lineNumber,e.column,e.lineNumber,e.column);s.showContentHover(n,1,1,t)},h=i.getOption(2)===2;s.isHoverVisible?r!==d6.NoAutoFocus?s.focus():o(h):o(h||r===d6.AutoFocusImmediately)}}),ku(class extends mu{constructor(){super({id:"editor.action.showDefinitionPreviewHover",label:tt(0,"Show Definition Preview Hover"),alias:"Show Definition Preview Hover",precondition:void 0})}run(t,i){const e=u6.get(i);if(!e)return;const s=i.getPosition();if(!s)return;const n=new Cs(s.lineNumber,s.column,s.lineNumber,s.column),r=_5.get(i);r&&r.startFindDefinitionFromCursor(s).then((()=>{e.showContentHover(n,1,1,!0)}))}}),ku(class extends mu{constructor(){super({id:"editor.action.scrollUpHover",label:tt(0,"Scroll Up Hover"),alias:"Scroll Up Hover",precondition:Ox.hoverFocused,kbOpts:{kbExpr:Ox.hoverFocused,primary:16,weight:100}})}run(t,i){const e=u6.get(i);e&&e.scrollUp()}}),ku(class extends mu{constructor(){super({id:"editor.action.scrollDownHover",label:tt(0,"Scroll Down Hover"),alias:"Scroll Down Hover",precondition:Ox.hoverFocused,kbOpts:{kbExpr:Ox.hoverFocused,primary:18,weight:100}})}run(t,i){const e=u6.get(i);e&&e.scrollDown()}}),ku(class extends mu{constructor(){super({id:"editor.action.scrollLeftHover",label:tt(0,"Scroll Left Hover"),alias:"Scroll Left Hover",precondition:Ox.hoverFocused,kbOpts:{kbExpr:Ox.hoverFocused,primary:15,weight:100}})}run(t,i){const e=u6.get(i);e&&e.scrollLeft()}}),ku(class extends mu{constructor(){super({id:"editor.action.scrollRightHover",label:tt(0,"Scroll Right Hover"),alias:"Scroll Right Hover",precondition:Ox.hoverFocused,kbOpts:{kbExpr:Ox.hoverFocused,primary:17,weight:100}})}run(t,i){const e=u6.get(i);e&&e.scrollRight()}}),ku(class extends mu{constructor(){super({id:"editor.action.pageUpHover",label:tt(0,"Page Up Hover"),alias:"Page Up Hover",precondition:Ox.hoverFocused,kbOpts:{kbExpr:Ox.hoverFocused,primary:11,secondary:[528],weight:100}})}run(t,i){const e=u6.get(i);e&&e.pageUp()}}),ku(class extends mu{constructor(){super({id:"editor.action.pageDownHover",label:tt(0,"Page Down Hover"),alias:"Page Down Hover",precondition:Ox.hoverFocused,kbOpts:{kbExpr:Ox.hoverFocused,primary:12,secondary:[530],weight:100}})}run(t,i){const e=u6.get(i);e&&e.pageDown()}}),ku(class extends mu{constructor(){super({id:"editor.action.goToTopHover",label:tt(0,"Go To Top Hover"),alias:"Go To Bottom Hover",precondition:Ox.hoverFocused,kbOpts:{kbExpr:Ox.hoverFocused,primary:14,secondary:[2064],weight:100}})}run(t,i){const e=u6.get(i);e&&e.goToTop()}}),ku(class extends mu{constructor(){super({id:"editor.action.goToBottomHover",label:tt(0,"Go To Bottom Hover"),alias:"Go To Bottom Hover",precondition:Ox.hoverFocused,kbOpts:{kbExpr:Ox.hoverFocused,primary:13,secondary:[2066],weight:100}})}run(t,i){const e=u6.get(i);e&&e.goToBottom()}}),W5.register(u3),W5.register(G3),RC(((t,i)=>{const e=t.getColor(Dv);e&&(i.addRule(`.monaco-editor .monaco-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${e.transparent(.5)}; }`),i.addRule(`.monaco-editor .monaco-hover hr { border-top: 1px solid ${e.transparent(.5)}; }`),i.addRule(`.monaco-editor .monaco-hover hr { border-bottom: 0px solid ${e.transparent(.5)}; }`))}));class f6 extends Qi{constructor(t){super(),this._editor=t,this._register(t.onMouseDown((t=>this.onMouseDown(t))))}dispose(){super.dispose()}onMouseDown(t){const i=this._editor.getOption(148);if(i!=="click"&&i!=="clickAndHover")return;const e=t.target;if(e.type!==6||!e.detail.injectedText||e.detail.injectedText.options.attachedData!==T2||!e.range)return;const s=this._editor.getContribution(u6.ID);if(s&&!s.isColorPickerVisible){const t=new Cs(e.range.startLineNumber,e.range.startColumn+1,e.range.endLineNumber,e.range.endColumn+1);s.showContentHover(t,1,0,!1,!0)}}}f6.ID="editor.contrib.colorContribution",Su(f6.ID,f6,2),W5.register(G2);var g6,p6,m6=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},w6=function(t,i){return function(e,s){i(e,s,t)}};let v6=g6=class extends Qi{constructor(t,i,e,s,n,r,o){super(),this._editor=t,this._modelService=e,this._keybindingService=s,this._instantiationService=n,this._languageFeatureService=r,this._languageConfigurationService=o,this._standaloneColorPickerWidget=null,this._standaloneColorPickerVisible=Ox.standaloneColorPickerVisible.bindTo(i),this._standaloneColorPickerFocused=Ox.standaloneColorPickerFocused.bindTo(i)}showOrFocus(){var t;this._editor.hasModel()&&(this._standaloneColorPickerVisible.get()?this._standaloneColorPickerFocused.get()||(t=this._standaloneColorPickerWidget)===null||t===void 0||t.focus():this._standaloneColorPickerWidget=new b6(this._editor,this._standaloneColorPickerVisible,this._standaloneColorPickerFocused,this._instantiationService,this._modelService,this._keybindingService,this._languageFeatureService,this._languageConfigurationService))}hide(){var t;this._standaloneColorPickerFocused.set(!1),this._standaloneColorPickerVisible.set(!1),(t=this._standaloneColorPickerWidget)===null||t===void 0||t.hide(),this._editor.focus()}insertColor(){var t;(t=this._standaloneColorPickerWidget)===null||t===void 0||t.updateEditor(),this.hide()}static get(t){return t.getContribution(g6.ID)}};v6.ID="editor.contrib.standaloneColorPickerController",v6=g6=m6([w6(1,Ra),w6(2,Nl),w6(3,NS),w6(4,Il),w6(5,$p),w6(6,cf)],v6),Su(v6.ID,v6,1);let b6=p6=class extends Qi{constructor(t,i,e,s,n,r,o,h){var c;super(),this._editor=t,this._standaloneColorPickerVisible=i,this._standaloneColorPickerFocused=e,this._modelService=n,this._keybindingService=r,this._languageFeaturesService=o,this._languageConfigurationService=h,this.allowEditorOverflow=!0,this._position=void 0,this._body=document.createElement("div"),this._colorHover=null,this._selectionSetInEditor=!1,this._onResult=this._register(new le),this.onResult=this._onResult.event,this._standaloneColorPickerVisible.set(!0),this._standaloneColorPickerParticipant=s.createInstance(J2,this._editor),this._position=(c=this._editor._getViewModel())===null||c===void 0?void 0:c.getPrimaryCursorState().modelState.position;const l=this._editor.getSelection(),a=l?{startLineNumber:l.startLineNumber,startColumn:l.startColumn,endLineNumber:l.endLineNumber,endColumn:l.endColumn}:{startLineNumber:0,endLineNumber:0,endColumn:0,startColumn:0},u=this._register(Qc(this._body));this._register(u.onDidBlur((t=>{this.hide()}))),this._register(u.onDidFocus((t=>{this.focus()}))),this._register(this._editor.onDidChangeCursorPosition((()=>{this._selectionSetInEditor?this._selectionSetInEditor=!1:this.hide()}))),this._register(this._editor.onMouseMove((t=>{var i;const e=(i=t.target.element)===null||i===void 0?void 0:i.classList;e&&e.contains("colorpicker-color-decoration")&&this.hide()}))),this._register(this.onResult((t=>{this._render(t.value,t.foundInEditor)}))),this._start(a),this._body.style.zIndex="50",this._editor.addContentWidget(this)}updateEditor(){this._colorHover&&this._standaloneColorPickerParticipant.updateEditorModel(this._colorHover)}getId(){return p6.ID}getDomNode(){return this._body}getPosition(){if(!this._position)return null;const t=this._editor.getOption(60).above;return{position:this._position,secondaryPosition:this._position,preference:t?[1,2]:[2,1],positionAffinity:2}}hide(){this.dispose(),this._standaloneColorPickerVisible.set(!1),this._standaloneColorPickerFocused.set(!1),this._editor.removeContentWidget(this),this._editor.focus()}focus(){this._standaloneColorPickerFocused.set(!0),this._body.focus()}async _start(t){const i=await this._computeAsync(t);i&&this._onResult.fire(new y6(i.result,i.foundInEditor))}async _computeAsync(t){if(!this._editor.hasModel())return null;const i={range:t,color:{red:0,green:0,blue:0,alpha:1}},e=await this._standaloneColorPickerParticipant.createColorHover(i,new b2(this._modelService,this._languageConfigurationService),this._languageFeaturesService.colorProvider);return e?{result:e.colorHover,foundInEditor:e.foundInEditor}:null}_render(t,i){const e=document.createDocumentFragment();let s;const n={fragment:e,statusBar:this._register(new X5(this._keybindingService)),setColorPicker:t=>s=t,onContentsChanged:()=>{},hide:()=>this.hide()};if(this._colorHover=t,this._register(this._standaloneColorPickerParticipant.renderHoverParts(n,[t])),s===void 0)return;this._body.classList.add("standalone-colorpicker-body"),this._body.style.maxHeight=Math.max(this._editor.getLayoutInfo().height/4,250)+"px",this._body.style.maxWidth=Math.max(.66*this._editor.getLayoutInfo().width,500)+"px",this._body.tabIndex=0,this._body.appendChild(e),s.layout();const r=s.body,o=r.saturationBox.domNode.clientWidth,h=r.domNode.clientWidth-o-22-8,c=s.body.enterButton;c==null||c.onClicked((()=>{this.updateEditor(),this.hide()}));const l=s.header;l.pickedColorNode.style.width=o+8+"px",l.originalColorNode.style.width=h+"px";const a=s.header.closeButton;a==null||a.onClicked((()=>{this.hide()})),i&&(c&&(c.button.textContent="Replace"),this._selectionSetInEditor=!0,this._editor.setSelection(t.range)),this._editor.layoutContentWidget(this)}};b6.ID="editor.contrib.standaloneColorPickerWidget",b6=p6=m6([w6(3,Il),w6(4,Nl),w6(5,NS),w6(6,$p),w6(7,cf)],b6);class y6{constructor(t,i){this.value=t,this.foundInEditor=i}}ku(class extends mu{constructor(){super({id:"editor.action.hideColorPicker",label:tt(0,"Hide the Color Picker"),alias:"Hide the Color Picker",precondition:Ox.standaloneColorPickerVisible.isEqualTo(!0),kbOpts:{primary:9,weight:100}})}run(t,i){var e;(e=v6.get(i))===null||e===void 0||e.hide()}}),ku(class extends mu{constructor(){super({id:"editor.action.insertColorWithStandaloneColorPicker",label:tt(0,"Insert Color with Standalone Color Picker"),alias:"Insert Color with Standalone Color Picker",precondition:Ox.standaloneColorPickerFocused.isEqualTo(!0),kbOpts:{primary:3,weight:100}})}run(t,i){var e;(e=v6.get(i))===null||e===void 0||e.insertColor()}}),nu(class extends vu{constructor(){super({id:"editor.action.showOrFocusStandaloneColorPicker",title:{...it(0,"Show or Focus Standalone Color Picker"),mnemonicTitle:tt(0,"&&Show or Focus Standalone Color Picker")},precondition:void 0,menu:[{id:Qa.CommandPalette}]})}runEditorCommand(t,i){var e;(e=v6.get(i))===null||e===void 0||e.showOrFocus()}});class k6{constructor(t,i,e){this.languageConfigurationService=e,this._selection=t,this._insertSpace=i,this._usedEndToken=null}static _haystackHasNeedleAtOffset(t,i,e){if(e<0)return!1;const s=i.length;if(e+s>t.length)return!1;for(let n=0;n<s;n++){const s=t.charCodeAt(e+n),r=i.charCodeAt(n);if(s!==r&&!(s>=65&&s<=90&&s+32===r||r>=65&&r<=90&&r+32===s))return!1}return!0}_createOperationsForBlockComment(t,i,e,s,n,r){const o=t.startLineNumber,h=t.startColumn,c=t.endLineNumber,l=t.endColumn,a=n.getLineContent(o),u=n.getLineContent(c);let d,f=a.lastIndexOf(i,h-1+i.length),g=u.indexOf(e,l-1-e.length);if(f!==-1&&g!==-1)if(o===c)a.substring(f+i.length,g).indexOf(e)>=0&&(f=-1,g=-1);else{const t=a.substring(f+i.length),s=u.substring(0,g);(t.indexOf(e)>=0||s.indexOf(e)>=0)&&(f=-1,g=-1)}f!==-1&&g!==-1?(s&&f+i.length<a.length&&a.charCodeAt(f+i.length)===32&&(i+=" "),s&&g>0&&u.charCodeAt(g-1)===32&&(e=" "+e,g-=1),d=k6._createRemoveBlockCommentOperations(new Cs(o,f+i.length+1,c,g+1),i,e)):(d=k6._createAddBlockCommentOperations(t,i,e,this._insertSpace),this._usedEndToken=d.length===1?e:null);for(const t of d)r.addTrackedEditOperation(t.range,t.text)}static _createRemoveBlockCommentOperations(t,i,e){const s=[];return Cs.isEmpty(t)?s.push(KP.delete(new Cs(t.startLineNumber,t.startColumn-i.length,t.endLineNumber,t.endColumn+e.length))):(s.push(KP.delete(new Cs(t.startLineNumber,t.startColumn-i.length,t.startLineNumber,t.startColumn))),s.push(KP.delete(new Cs(t.endLineNumber,t.endColumn,t.endLineNumber,t.endColumn+e.length)))),s}static _createAddBlockCommentOperations(t,i,e,s){const n=[];return Cs.isEmpty(t)?n.push(KP.replace(new Cs(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn),i+"  "+e)):(n.push(KP.insert(new ks(t.startLineNumber,t.startColumn),i+(s?" ":""))),n.push(KP.insert(new ks(t.endLineNumber,t.endColumn),(s?" ":"")+e))),n}getEditOperations(t,i){const e=this._selection.startLineNumber,s=this._selection.startColumn;t.tokenization.tokenizeIfCheap(e);const n=t.getLanguageIdAtPosition(e,s),r=this.languageConfigurationService.getLanguageConfiguration(n).comments;r&&r.blockCommentStartToken&&r.blockCommentEndToken&&this._createOperationsForBlockComment(this._selection,r.blockCommentStartToken,r.blockCommentEndToken,this._insertSpace,t,i)}computeCursorState(t,i){const e=i.getInverseEditOperations();if(e.length===2){const t=e[0],i=e[1];return new Ss(t.range.endLineNumber,t.range.endColumn,i.range.startLineNumber,i.range.startColumn)}{const t=e[0].range,i=this._usedEndToken?-this._usedEndToken.length-1:0;return new Ss(t.endLineNumber,t.endColumn+i,t.endLineNumber,t.endColumn+i)}}}class C6{constructor(t,i,e,s,n,r,o){this.languageConfigurationService=t,this._selection=i,this._indentSize=e,this._type=s,this._insertSpace=n,this._selectionId=null,this._deltaColumn=0,this._moveEndPositionDown=!1,this._ignoreEmptyLines=r,this._ignoreFirstLine=o||!1}static _gatherPreflightCommentStrings(t,i,e,s){t.tokenization.tokenizeIfCheap(i);const n=t.getLanguageIdAtPosition(i,1),r=s.getLanguageConfiguration(n).comments,o=r?r.lineCommentToken:null;if(!o)return null;const h=[];for(let t=0,s=e-i+1;t<s;t++)h[t]={ignore:!1,commentStr:o,commentStrOffset:0,commentStrLength:o.length};return h}static _analyzeLines(t,i,e,s,n,r,o,h){let c,l=!0;c=t===0||t!==1;for(let h=0,a=s.length;h<a;h++){const a=s[h],u=n+h;if(u===n&&o){a.ignore=!0;continue}const d=e.getLineContent(u),f=tr(d);if(f!==-1){if(l=!1,a.ignore=!1,a.commentStrOffset=f,c&&!k6._haystackHasNeedleAtOffset(d,a.commentStr,f)&&(t===0?c=!1:t===1||(a.ignore=!0)),c&&i){const t=f+a.commentStrLength;t<d.length&&d.charCodeAt(t)===32&&(a.commentStrLength+=1)}}else a.ignore=r,a.commentStrOffset=d.length}if(t===0&&l){c=!1;for(let t=0,i=s.length;t<i;t++)s[t].ignore=!1}return{supported:!0,shouldRemoveComments:c,lines:s}}static _gatherPreflightData(t,i,e,s,n,r,o,h){const c=C6._gatherPreflightCommentStrings(e,s,n,h);return c===null?{supported:!1}:C6._analyzeLines(t,i,e,c,s,r,o,h)}_executeLineComments(t,i,e,s){let n;e.shouldRemoveComments?n=C6._createRemoveLineCommentsOperations(e.lines,s.startLineNumber):(C6._normalizeInsertionPoint(t,e.lines,s.startLineNumber,this._indentSize),n=this._createAddLineCommentsOperations(e.lines,s.startLineNumber));const r=new ks(s.positionLineNumber,s.positionColumn);for(let e=0,s=n.length;e<s;e++)i.addEditOperation(n[e].range,n[e].text),Cs.isEmpty(n[e].range)&&Cs.getStartPosition(n[e].range).equals(r)&&t.getLineContent(r.lineNumber).length+1===r.column&&(this._deltaColumn=(n[e].text||"").length);this._selectionId=i.trackSelection(s)}_attemptRemoveBlockComment(t,i,e,s){let n=i.startLineNumber,r=i.endLineNumber;const o=s.length+Math.max(t.getLineFirstNonWhitespaceColumn(i.startLineNumber),i.startColumn);let h=t.getLineContent(n).lastIndexOf(e,o-1),c=t.getLineContent(r).indexOf(s,i.endColumn-1-e.length);return h!==-1&&c===-1&&(c=t.getLineContent(n).indexOf(s,h+e.length),r=n),h===-1&&c!==-1&&(h=t.getLineContent(r).lastIndexOf(e,c),n=r),!i.isEmpty()||h!==-1&&c!==-1||(h=t.getLineContent(n).indexOf(e),h!==-1&&(c=t.getLineContent(n).indexOf(s,h+e.length))),h!==-1&&t.getLineContent(n).charCodeAt(h+e.length)===32&&(e+=" "),c!==-1&&t.getLineContent(r).charCodeAt(c-1)===32&&(s=" "+s,c-=1),h!==-1&&c!==-1?k6._createRemoveBlockCommentOperations(new Cs(n,h+e.length+1,r,c+1),e,s):null}_executeBlockComment(t,i,e){t.tokenization.tokenizeIfCheap(e.startLineNumber);const s=t.getLanguageIdAtPosition(e.startLineNumber,1),n=this.languageConfigurationService.getLanguageConfiguration(s).comments;if(!n||!n.blockCommentStartToken||!n.blockCommentEndToken)return;const r=n.blockCommentStartToken,o=n.blockCommentEndToken;let h=this._attemptRemoveBlockComment(t,e,r,o);if(!h){if(e.isEmpty()){const i=t.getLineContent(e.startLineNumber);let s=tr(i);s===-1&&(s=i.length),h=k6._createAddBlockCommentOperations(new Cs(e.startLineNumber,s+1,e.startLineNumber,i.length+1),r,o,this._insertSpace)}else h=k6._createAddBlockCommentOperations(new Cs(e.startLineNumber,t.getLineFirstNonWhitespaceColumn(e.startLineNumber),e.endLineNumber,t.getLineMaxColumn(e.endLineNumber)),r,o,this._insertSpace);h.length===1&&(this._deltaColumn=r.length+1)}this._selectionId=i.trackSelection(e);for(const t of h)i.addEditOperation(t.range,t.text)}getEditOperations(t,i){let e=this._selection;if(this._moveEndPositionDown=!1,e.startLineNumber===e.endLineNumber&&this._ignoreFirstLine)return i.addEditOperation(new Cs(e.startLineNumber,t.getLineMaxColumn(e.startLineNumber),e.startLineNumber+1,1),e.startLineNumber===t.getLineCount()?"":`\n`),void(this._selectionId=i.trackSelection(e));e.startLineNumber<e.endLineNumber&&e.endColumn===1&&(this._moveEndPositionDown=!0,e=e.setEndPosition(e.endLineNumber-1,t.getLineMaxColumn(e.endLineNumber-1)));const s=C6._gatherPreflightData(this._type,this._insertSpace,t,e.startLineNumber,e.endLineNumber,this._ignoreEmptyLines,this._ignoreFirstLine,this.languageConfigurationService);return s.supported?this._executeLineComments(t,i,s,e):this._executeBlockComment(t,i,e)}computeCursorState(t,i){let e=i.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(e=e.setEndPosition(e.endLineNumber+1,1)),new Ss(e.selectionStartLineNumber,e.selectionStartColumn+this._deltaColumn,e.positionLineNumber,e.positionColumn+this._deltaColumn)}static _createRemoveLineCommentsOperations(t,i){const e=[];for(let s=0,n=t.length;s<n;s++){const n=t[s];n.ignore||e.push(KP.delete(new Cs(i+s,n.commentStrOffset+1,i+s,n.commentStrOffset+n.commentStrLength+1)))}return e}_createAddLineCommentsOperations(t,i){const e=[],s=this._insertSpace?" ":"";for(let n=0,r=t.length;n<r;n++){const r=t[n];r.ignore||e.push(KP.insert(new ks(i+n,r.commentStrOffset+1),r.commentStr+s))}return e}static nextVisibleColumn(t,i,e,s){return e?t+(i-t%i):t+s}static _normalizeInsertionPoint(t,i,e,s){let n,r,o=1073741824;for(let n=0,r=i.length;n<r;n++){if(i[n].ignore)continue;const r=t.getLineContent(e+n);let h=0;for(let t=0,e=i[n].commentStrOffset;h<o&&t<e;t++)h=C6.nextVisibleColumn(h,s,r.charCodeAt(t)===9,1);h<o&&(o=h)}o=Math.floor(o/s)*s;for(let h=0,c=i.length;h<c;h++){if(i[h].ignore)continue;const c=t.getLineContent(e+h);let l=0;for(n=0,r=i[h].commentStrOffset;l<o&&n<r;n++)l=C6.nextVisibleColumn(l,s,c.charCodeAt(n)===9,1);i[h].commentStrOffset=l>o?n-1:n}}}class S6 extends mu{constructor(t,i){super(i),this._type=t}run(t,i){const e=t.get(cf);if(!i.hasModel())return;const s=[],n=i.getModel().getOptions(),r=i.getOption(23),o=i.getSelections().map(((t,i)=>({selection:t,index:i,ignoreFirstLine:!1})));o.sort(((t,i)=>Cs.compareRangesUsingStarts(t.selection,i.selection)));let h=o[0];for(let t=1;t<o.length;t++){const i=o[t];h.selection.endLineNumber===i.selection.startLineNumber&&(h.index<i.index?i.ignoreFirstLine=!0:(h.ignoreFirstLine=!0,h=i))}for(const t of o)s.push(new C6(e,t.selection,n.indentSize,this._type,r.insertSpace,r.ignoreEmptyLines,t.ignoreFirstLine));i.pushUndoStop(),i.executeCommands(this.id,s),i.pushUndoStop()}}ku(class extends S6{constructor(){super(0,{id:"editor.action.commentLine",label:tt(0,"Toggle Line Comment"),alias:"Toggle Line Comment",precondition:Ox.writable,kbOpts:{kbExpr:Ox.editorTextFocus,primary:2138,weight:100},menuOpts:{menuId:Qa.MenubarEditMenu,group:"5_insert",title:tt(0,"&&Toggle Line Comment"),order:1}})}}),ku(class extends S6{constructor(){super(1,{id:"editor.action.addCommentLine",label:tt(0,"Add Line Comment"),alias:"Add Line Comment",precondition:Ox.writable,kbOpts:{kbExpr:Ox.editorTextFocus,primary:Fe(2089,2081),weight:100}})}}),ku(class extends S6{constructor(){super(2,{id:"editor.action.removeCommentLine",label:tt(0,"Remove Line Comment"),alias:"Remove Line Comment",precondition:Ox.writable,kbOpts:{kbExpr:Ox.editorTextFocus,primary:Fe(2089,2099),weight:100}})}}),ku(class extends mu{constructor(){super({id:"editor.action.blockComment",label:tt(0,"Toggle Block Comment"),alias:"Toggle Block Comment",precondition:Ox.writable,kbOpts:{kbExpr:Ox.editorTextFocus,primary:1567,linux:{primary:3103},weight:100},menuOpts:{menuId:Qa.MenubarEditMenu,group:"5_insert",title:tt(0,"Toggle &&Block Comment"),order:2}})}run(t,i){const e=t.get(cf);if(!i.hasModel())return;const s=i.getOption(23),n=[],r=i.getSelections();for(const t of r)n.push(new k6(t,s.insertSpace,e));i.pushUndoStop(),i.executeCommands(this.id,n),i.pushUndoStop()}});var x6,D6=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},E6=function(t,i){return function(e,s){i(e,s,t)}};let A6=x6=class{static get(t){return t.getContribution(x6.ID)}constructor(t,i,e,s,n,r,o,h){this._contextMenuService=i,this._contextViewService=e,this._contextKeyService=s,this._keybindingService=n,this._menuService=r,this._configurationService=o,this._workspaceContextService=h,this._toDispose=new Ji,this._contextMenuIsBeingShownCount=0,this._editor=t,this._toDispose.add(this._editor.onContextMenu((t=>this._onContextMenu(t)))),this._toDispose.add(this._editor.onMouseWheel((t=>{if(this._contextMenuIsBeingShownCount>0){const i=this._contextViewService.getContextViewElement(),e=t.srcElement;e.shadowRoot&&Mc(i)===e.shadowRoot||this._contextViewService.hideContextView()}}))),this._toDispose.add(this._editor.onKeyDown((t=>{this._editor.getOption(24)&&t.keyCode===58&&(t.preventDefault(),t.stopPropagation(),this.showContextMenu())})))}_onContextMenu(t){if(!this._editor.hasModel())return;if(!this._editor.getOption(24))return this._editor.focus(),void(t.target.position&&!this._editor.getSelection().containsPosition(t.target.position)&&this._editor.setPosition(t.target.position));if(t.target.type===12||t.target.type===6&&t.target.detail.injectedText)return;if(t.event.preventDefault(),t.event.stopPropagation(),t.target.type===11)return this._showScrollbarContextMenu(t.event);if(t.target.type!==6&&t.target.type!==7&&t.target.type!==1)return;if(this._editor.focus(),t.target.position){let i=!1;for(const e of this._editor.getSelections())if(e.containsPosition(t.target.position)){i=!0;break}i||this._editor.setPosition(t.target.position)}let i=null;t.target.type!==1&&(i=t.event),this.showContextMenu(i)}showContextMenu(t){if(!this._editor.getOption(24)||!this._editor.hasModel())return;const i=this._getMenuActions(this._editor.getModel(),this._editor.isSimpleWidget?Qa.SimpleEditorContext:Qa.EditorContext);i.length>0&&this._doShowContextMenu(i,t)}_getMenuActions(t,i){const e=[],s=this._menuService.createMenu(i,this._contextKeyService),n=s.getActions({arg:t.uri});s.dispose();for(const i of n){const[,s]=i;let n=0;for(const i of s)if(i instanceof iu){const s=this._getMenuActions(t,i.item.submenu);s.length>0&&(e.push(new Hl(i.id,i.label,s)),n++)}else e.push(i),n++;n&&e.push(new jl)}return e.length&&e.pop(),e}_doShowContextMenu(t,i=null){if(!this._editor.hasModel())return;const e=this._editor.getOption(60);this._editor.updateOptions({hover:{enabled:!1}});let s=i;if(!s){this._editor.revealPosition(this._editor.getPosition(),1),this._editor.render();const t=this._editor.getScrolledVisiblePosition(this._editor.getPosition()),i=vc(this._editor.getDomNode()),e=i.left+t.left,n=i.top+t.top+t.height;s={x:e,y:n}}const n=this._editor.getOption(127)&&!xt;this._contextMenuIsBeingShownCount++,this._contextMenuService.showContextMenu({domForShadowRoot:n?this._editor.getDomNode():void 0,getAnchor:()=>s,getActions:()=>t,getActionViewItem:t=>{const i=this._keybindingFor(t);if(i)return new G$(t,t,{label:!0,keybinding:i.getLabel(),isMenu:!0});const e=t;return typeof e.getActionViewItem=="function"?e.getActionViewItem():new G$(t,t,{icon:!0,label:!0,isMenu:!0})},getKeyBinding:t=>this._keybindingFor(t),onHide:t=>{this._contextMenuIsBeingShownCount--,this._editor.updateOptions({hover:e})}})}_showScrollbarContextMenu(t){if(!this._editor.hasModel()||this._workspaceContextService.getWorkspace().id===ON)return;const i=this._editor.getOption(73);let e=0;const s=t=>({id:"menu-action-"+ ++e,label:t.label,tooltip:"",class:void 0,enabled:t.enabled===void 0||t.enabled,checked:t.checked,run:t.run}),n=(t,i,n,r,o)=>{if(!i)return s({label:t,enabled:i,run:()=>{}});const h=t=>()=>{this._configurationService.updateValue(n,t)},c=[];for(const t of o)c.push(s({label:t.label,checked:r===t.value,run:h(t.value)}));return((t,i)=>new Hl("menu-action-"+ ++e,t,i,void 0))(t,c)},r=[];r.push(s({label:tt(0,"Minimap"),checked:i.enabled,run:()=>{this._configurationService.updateValue("editor.minimap.enabled",!i.enabled)}})),r.push(new jl),r.push(s({label:tt(0,"Render Characters"),enabled:i.enabled,checked:i.renderCharacters,run:()=>{this._configurationService.updateValue("editor.minimap.renderCharacters",!i.renderCharacters)}})),r.push(n(tt(0,"Vertical size"),i.enabled,"editor.minimap.size",i.size,[{label:tt(0,"Proportional"),value:"proportional"},{label:tt(0,"Fill"),value:"fill"},{label:tt(0,"Fit"),value:"fit"}])),r.push(n(tt(0,"Slider"),i.enabled,"editor.minimap.showSlider",i.showSlider,[{label:tt(0,"Mouse Over"),value:"mouseover"},{label:tt(0,"Always"),value:"always"}]));const o=this._editor.getOption(127)&&!xt;this._contextMenuIsBeingShownCount++,this._contextMenuService.showContextMenu({domForShadowRoot:o?this._editor.getDomNode():void 0,getAnchor:()=>t,getActions:()=>r,onHide:t=>{this._contextMenuIsBeingShownCount--,this._editor.focus()}})}_keybindingFor(t){return this._keybindingService.lookupKeybinding(t.id)}dispose(){this._contextMenuIsBeingShownCount>0&&this._contextViewService.hideContextView(),this._toDispose.dispose()}};A6.ID="editor.contrib.contextmenu",A6=x6=D6([E6(1,oI),E6(2,rI),E6(3,Ra),E6(4,NS),E6(5,Ya),E6(6,Md),E6(7,AN)],A6);Su(A6.ID,A6,2),ku(class extends mu{constructor(){super({id:"editor.action.showContextMenu",label:tt(0,"Show Editor Context Menu"),alias:"Show Editor Context Menu",precondition:void 0,kbOpts:{kbExpr:Ox.textInputFocus,primary:1092,weight:100}})}run(t,i){var e;(e=A6.get(i))===null||e===void 0||e.showContextMenu()}});class M6{constructor(t){this.selections=t}equals(t){const i=this.selections.length;if(i!==t.selections.length)return!1;for(let e=0;e<i;e++)if(!this.selections[e].equalsSelection(t.selections[e]))return!1;return!0}}class L6{constructor(t,i,e){this.cursorState=t,this.scrollTop=i,this.scrollLeft=e}}class F6 extends Qi{static get(t){return t.getContribution(F6.ID)}constructor(t){super(),this._editor=t,this._isCursorUndoRedo=!1,this._undoStack=[],this._redoStack=[],this._register(t.onDidChangeModel((t=>{this._undoStack=[],this._redoStack=[]}))),this._register(t.onDidChangeModelContent((t=>{this._undoStack=[],this._redoStack=[]}))),this._register(t.onDidChangeCursorSelection((i=>{if(this._isCursorUndoRedo||!i.oldSelections||i.oldModelVersionId!==i.modelVersionId)return;const e=new M6(i.oldSelections);this._undoStack.length>0&&this._undoStack[this._undoStack.length-1].cursorState.equals(e)||(this._undoStack.push(new L6(e,t.getScrollTop(),t.getScrollLeft())),this._redoStack=[],this._undoStack.length>50&&this._undoStack.shift())})))}cursorUndo(){this._editor.hasModel()&&this._undoStack.length!==0&&(this._redoStack.push(new L6(new M6(this._editor.getSelections()),this._editor.getScrollTop(),this._editor.getScrollLeft())),this._applyState(this._undoStack.pop()))}cursorRedo(){this._editor.hasModel()&&this._redoStack.length!==0&&(this._undoStack.push(new L6(new M6(this._editor.getSelections()),this._editor.getScrollTop(),this._editor.getScrollLeft())),this._applyState(this._redoStack.pop()))}_applyState(t){this._isCursorUndoRedo=!0,this._editor.setSelections(t.cursorState.selections),this._editor.setScrollPosition({scrollTop:t.scrollTop,scrollLeft:t.scrollLeft}),this._isCursorUndoRedo=!1}}F6.ID="editor.contrib.cursorUndoRedoController";Su(F6.ID,F6,0),ku(class extends mu{constructor(){super({id:"cursorUndo",label:tt(0,"Cursor Undo"),alias:"Cursor Undo",precondition:void 0,kbOpts:{kbExpr:Ox.textInputFocus,primary:2099,weight:100}})}run(t,i,e){var s;(s=F6.get(i))===null||s===void 0||s.cursorUndo()}}),ku(class extends mu{constructor(){super({id:"cursorRedo",label:tt(0,"Cursor Redo"),alias:"Cursor Redo",precondition:void 0})}run(t,i,e){var s;(s=F6.get(i))===null||s===void 0||s.cursorRedo()}});class T6{constructor(t,i,e){this.selection=t,this.targetPosition=i,this.copy=e,this.targetSelection=null}getEditOperations(t,i){const e=t.getValueInRange(this.selection);this.copy||i.addEditOperation(this.selection,null),i.addEditOperation(new Cs(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column),e),!this.selection.containsPosition(this.targetPosition)||this.copy&&(this.selection.getEndPosition().equals(this.targetPosition)||this.selection.getStartPosition().equals(this.targetPosition))?this.copy?this.targetSelection=new Ss(this.targetPosition.lineNumber,this.targetPosition.column,this.selection.endLineNumber-this.selection.startLineNumber+this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn):this.targetPosition.lineNumber>this.selection.endLineNumber?this.targetSelection=new Ss(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn):this.targetPosition.lineNumber<this.selection.endLineNumber?this.targetSelection=new Ss(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber+this.selection.endLineNumber-this.selection.startLineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn):this.selection.endColumn<=this.targetPosition.column?this.targetSelection=new Ss(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column-this.selection.endColumn+this.selection.startColumn,this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column:this.selection.endColumn):this.targetSelection=new Ss(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column+this.selection.endColumn-this.selection.startColumn):this.targetSelection=this.selection}computeCursorState(t,i){return this.targetSelection}}function R6(t){return bt?t.altKey:t.ctrlKey}class O6 extends Qi{constructor(t){super(),this._editor=t,this._dndDecorationIds=this._editor.createDecorationsCollection(),this._register(this._editor.onMouseDown((t=>this._onEditorMouseDown(t)))),this._register(this._editor.onMouseUp((t=>this._onEditorMouseUp(t)))),this._register(this._editor.onMouseDrag((t=>this._onEditorMouseDrag(t)))),this._register(this._editor.onMouseDrop((t=>this._onEditorMouseDrop(t)))),this._register(this._editor.onMouseDropCanceled((()=>this._onEditorMouseDropCanceled()))),this._register(this._editor.onKeyDown((t=>this.onEditorKeyDown(t)))),this._register(this._editor.onKeyUp((t=>this.onEditorKeyUp(t)))),this._register(this._editor.onDidBlurEditorWidget((()=>this.onEditorBlur()))),this._register(this._editor.onDidBlurEditorText((()=>this.onEditorBlur()))),this._mouseDown=!1,this._modifierPressed=!1,this._dragSelection=null}onEditorBlur(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1}onEditorKeyDown(t){this._editor.getOption(35)&&!this._editor.getOption(22)&&(R6(t)&&(this._modifierPressed=!0),this._mouseDown&&R6(t)&&this._editor.updateOptions({mouseStyle:"copy"}))}onEditorKeyUp(t){this._editor.getOption(35)&&!this._editor.getOption(22)&&(R6(t)&&(this._modifierPressed=!1),this._mouseDown&&t.keyCode===O6.TRIGGER_KEY_VALUE&&this._editor.updateOptions({mouseStyle:"default"}))}_onEditorMouseDown(t){this._mouseDown=!0}_onEditorMouseUp(t){this._mouseDown=!1,this._editor.updateOptions({mouseStyle:"text"})}_onEditorMouseDrag(t){const i=t.target;if(this._dragSelection===null){const t=(this._editor.getSelections()||[]).filter((t=>i.position&&t.containsPosition(i.position)));if(t.length!==1)return;this._dragSelection=t[0]}R6(t.event)?this._editor.updateOptions({mouseStyle:"copy"}):this._editor.updateOptions({mouseStyle:"default"}),i.position&&(this._dragSelection.containsPosition(i.position)?this._removeDecoration():this.showAt(i.position))}_onEditorMouseDropCanceled(){this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}_onEditorMouseDrop(t){if(t.target&&(this._hitContent(t.target)||this._hitMargin(t.target))&&t.target.position){const i=new ks(t.target.position.lineNumber,t.target.position.column);if(this._dragSelection===null){let e=null;if(t.event.shiftKey){const t=this._editor.getSelection();if(t){const{selectionStartLineNumber:s,selectionStartColumn:n}=t;e=[new Ss(s,n,i.lineNumber,i.column)]}}else e=(this._editor.getSelections()||[]).map((t=>t.containsPosition(i)?new Ss(i.lineNumber,i.column,i.lineNumber,i.column):t));this._editor.setSelections(e||[],"mouse",3)}else(!this._dragSelection.containsPosition(i)||(R6(t.event)||this._modifierPressed)&&(this._dragSelection.getEndPosition().equals(i)||this._dragSelection.getStartPosition().equals(i)))&&(this._editor.pushUndoStop(),this._editor.executeCommand(O6.ID,new T6(this._dragSelection,i,R6(t.event)||this._modifierPressed)),this._editor.pushUndoStop())}this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}showAt(t){this._dndDecorationIds.set([{range:new Cs(t.lineNumber,t.column,t.lineNumber,t.column),options:O6._DECORATION_OPTIONS}]),this._editor.revealPosition(t,1)}_removeDecoration(){this._dndDecorationIds.clear()}_hitContent(t){return t.type===6||t.type===7}_hitMargin(t){return t.type===2||t.type===3||t.type===4}dispose(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1,super.dispose()}}var I6;O6.ID="editor.contrib.dragAndDrop",O6.TRIGGER_KEY_VALUE=bt?6:5,O6._DECORATION_OPTIONS=xF.register({description:"dnd-target",className:"dnd-target"}),Su(O6.ID,O6,2),Su(W0.ID,W0,0),sq(n0),yu(new class extends pu{constructor(){super({id:N0,precondition:B0,kbOpts:{weight:100,primary:2137}})}runEditorCommand(t,i){var e;return(e=W0.get(i))===null||e===void 0?void 0:e.changePasteType()}}),yu(new class extends pu{constructor(){super({id:"editor.hidePasteWidget",precondition:B0,kbOpts:{weight:100,primary:9}})}runEditorCommand(t,i){var e;(e=W0.get(i))===null||e===void 0||e.clearWidgets()}}),ku((I6=class extends mu{constructor(){super({id:"editor.action.pasteAs",label:tt(0,"Paste As..."),alias:"Paste As...",precondition:Ox.writable,metadata:{description:"Paste as",args:[{name:"args",schema:I6.argsSchema}]}})}run(t,i,e){var s;let n=typeof(e==null?void 0:e.kind)=="string"?e.kind:void 0;return!n&&e&&(n=typeof e.id=="string"?e.id:void 0),(s=W0.get(i))===null||s===void 0?void 0:s.pasteAs(n?new jX(n):void 0)}},I6.argsSchema={type:"object",properties:{kind:{type:"string",description:tt(0,"The kind of the paste edit to try applying. If not provided or there are multiple edits for this kind, the editor will show a picker.")}}},I6)),ku(class extends mu{constructor(){super({id:"editor.action.pasteAsText",label:tt(0,"Paste as Text"),alias:"Paste as Text",precondition:Ox.writable})}run(t,i){var e;return(e=W0.get(i))===null||e===void 0?void 0:e.pasteAs({providerId:YX.id})}});class _6{constructor(t){this.identifier=t}}const P6=_l("treeViewsDndService");Nd(P6,class{constructor(){this._dragOperations=new Map}removeDragOperationTransfer(t){if(t&&this._dragOperations.has(t)){const i=this._dragOperations.get(t);return this._dragOperations.delete(t),i}}},1);var N6,B6=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},$6=function(t,i){return function(e,s){i(e,s,t)}};const W6="editor.experimental.dropIntoEditor.defaultProvider",j6="editor.changeDropType",H6=new Ta("dropWidgetVisible",!1,tt(0,"Whether the drop widget is showing"));let V6=N6=class extends Qi{static get(t){return t.getContribution(N6.ID)}constructor(t,i,e,s,n){super(),this._configService=e,this._languageFeaturesService=s,this._treeViewsDragAndDropService=n,this.treeItemsTransfer=zX.getInstance(),this._dropProgressManager=this._register(i.createInstance(S0,"dropIntoEditor",t)),this._postDropWidgetManager=this._register(i.createInstance(O0,"dropIntoEditor",t,H6,{id:j6,label:tt(0,"Show drop options...")})),this._register(t.onDropIntoEditor((i=>this.onDropIntoEditor(t,i.position,i.event))))}clearWidgets(){this._postDropWidgetManager.clear()}changeDropType(){this._postDropWidgetManager.tryShowSelector()}async onDropIntoEditor(t,i,e){var s;if(!e.dataTransfer||!t.hasModel())return;(s=this._currentOperation)===null||s===void 0||s.cancel(),t.focus(),t.setPosition(i);const n=uo((async s=>{const r=new _Q(t,1,void 0,s);try{const n=await this.extractDataTransferData(e);if(n.size===0||r.token.isCancellationRequested)return;const o=t.getModel();if(!o)return;const h=this._languageFeaturesService.documentOnDropEditProvider.ordered(o).filter((t=>!t.dropMimeTypes||t.dropMimeTypes.some((t=>n.matches(t))))),c=await this.getDropEdits(h,o,i,n,r);if(r.token.isCancellationRequested)return;if(c.length){const e=this.getInitialActiveEditIndex(o,c),n=t.getOption(36).showDropSelector==="afterDrop";await this._postDropWidgetManager.applyEditAndShowIfNeeded([Cs.fromPositions(i)],{activeEditIndex:e,allEdits:c},n,(async t=>t),s)}}finally{r.dispose(),this._currentOperation===n&&(this._currentOperation=void 0)}}));this._dropProgressManager.showWhile(i,tt(0,"Running drop handlers. Click to cancel"),n),this._currentOperation=n}async getDropEdits(t,i,e,s,n){const r=await fo(Promise.all(t.map((async t=>{try{const r=await t.provideDocumentOnDropEdits(i,e,s,n.token);return r==null?void 0:r.map((i=>({...i,providerId:t.id})))}catch(t){console.error(t)}}))),n.token);return v0(a(r??[]).flat())}getInitialActiveEditIndex(t,i){const e=this._configService.getValue(W6,{resource:t.uri});for(const[t,s]of Object.entries(e)){const e=new jX(s),n=i.findIndex((i=>e.value===i.providerId&&i.handledMimeType&&BX(t,[i.handledMimeType])));if(n>=0)return n}return 0}async extractDataTransferData(t){if(!t.dataTransfer)return new PX;const i=GX(t.dataTransfer);if(this.treeItemsTransfer.hasData(_6.prototype)){const t=this.treeItemsTransfer.getData(_6.prototype);if(Array.isArray(t))for(const e of t){const t=await this._treeViewsDragAndDropService.removeDragOperationTransfer(e.identifier);if(t)for(const[e,s]of t)i.replace(e,s)}}return i}};V6.ID="editor.contrib.dropIntoEditorController",V6=N6=B6([$6(1,Il),$6(2,Md),$6(3,$p),$6(4,P6)],V6),Su(V6.ID,V6,2),sq(s0),yu(new class extends pu{constructor(){super({id:j6,precondition:H6,kbOpts:{weight:100,primary:2137}})}runEditorCommand(t,i,e){var s;(s=V6.get(i))===null||s===void 0||s.changeDropType()}}),yu(new class extends pu{constructor(){super({id:"editor.hideDropWidget",precondition:H6,kbOpts:{weight:100,primary:9}})}runEditorCommand(t,i,e){var s;(s=V6.get(i))===null||s===void 0||s.clearWidgets()}}),Va.as(Hd).registerConfiguration({...jP,properties:{[W6]:{type:"object",scope:5,description:tt(0,"Configures the default drop provider to use for content of a given mime type."),default:{},additionalProperties:{type:"string"}}}});class z6{constructor(t){this._editor=t,this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null,this._startPosition=this._editor.getPosition()}dispose(){this._editor.removeDecorations(this._allDecorations()),this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}reset(){this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}getCount(){return this._decorations.length}getFindScope(){return this._findScopeDecorationIds[0]?this._editor.getModel().getDecorationRange(this._findScopeDecorationIds[0]):null}getFindScopes(){if(this._findScopeDecorationIds.length){const t=this._findScopeDecorationIds.map((t=>this._editor.getModel().getDecorationRange(t))).filter((t=>!!t));if(t.length)return t}return null}getStartPosition(){return this._startPosition}setStartPosition(t){this._startPosition=t,this.setCurrentFindMatch(null)}_getDecorationIndex(t){const i=this._decorations.indexOf(t);return i>=0?i+1:1}getDecorationRangeAt(t){const i=t<this._decorations.length?this._decorations[t]:null;return i?this._editor.getModel().getDecorationRange(i):null}getCurrentMatchesPosition(t){const i=this._editor.getModel().getDecorationsInRange(t);for(const t of i){const i=t.options;if(i===z6._FIND_MATCH_DECORATION||i===z6._CURRENT_FIND_MATCH_DECORATION)return this._getDecorationIndex(t.id)}return 0}setCurrentFindMatch(t){let i=null,e=0;if(t)for(let s=0,n=this._decorations.length;s<n;s++){const n=this._editor.getModel().getDecorationRange(this._decorations[s]);if(t.equalsRange(n)){i=this._decorations[s],e=s+1;break}}return this._highlightedDecorationId===null&&i===null||this._editor.changeDecorations((t=>{if(this._highlightedDecorationId!==null&&(t.changeDecorationOptions(this._highlightedDecorationId,z6._FIND_MATCH_DECORATION),this._highlightedDecorationId=null),i!==null&&(this._highlightedDecorationId=i,t.changeDecorationOptions(this._highlightedDecorationId,z6._CURRENT_FIND_MATCH_DECORATION)),this._rangeHighlightDecorationId!==null&&(t.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),i!==null){let e=this._editor.getModel().getDecorationRange(i);if(e.startLineNumber!==e.endLineNumber&&e.endColumn===1){const t=e.endLineNumber-1,i=this._editor.getModel().getLineMaxColumn(t);e=new Cs(e.startLineNumber,e.startColumn,t,i)}this._rangeHighlightDecorationId=t.addDecoration(e,z6._RANGE_HIGHLIGHT_DECORATION)}})),e}set(t,i){this._editor.changeDecorations((e=>{let s=z6._FIND_MATCH_DECORATION;const n=[];if(t.length>1e3){s=z6._FIND_MATCH_NO_OVERVIEW_DECORATION;const i=this._editor.getModel().getLineCount(),e=this._editor.getLayoutInfo().height/i,r=Math.max(2,Math.ceil(3/e));let o=t[0].range.startLineNumber,h=t[0].range.endLineNumber;for(let i=1,e=t.length;i<e;i++){const e=t[i].range;h+r>=e.startLineNumber?e.endLineNumber>h&&(h=e.endLineNumber):(n.push({range:new Cs(o,1,h,1),options:z6._FIND_MATCH_ONLY_OVERVIEW_DECORATION}),o=e.startLineNumber,h=e.endLineNumber)}n.push({range:new Cs(o,1,h,1),options:z6._FIND_MATCH_ONLY_OVERVIEW_DECORATION})}const r=new Array(t.length);for(let i=0,e=t.length;i<e;i++)r[i]={range:t[i].range,options:s};this._decorations=e.deltaDecorations(this._decorations,r),this._overviewRulerApproximateDecorations=e.deltaDecorations(this._overviewRulerApproximateDecorations,n),this._rangeHighlightDecorationId&&(e.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),this._findScopeDecorationIds.length&&(this._findScopeDecorationIds.forEach((t=>e.removeDecoration(t))),this._findScopeDecorationIds=[]),i!=null&&i.length&&(this._findScopeDecorationIds=i.map((t=>e.addDecoration(t,z6._FIND_SCOPE_DECORATION))))}))}matchBeforePosition(t){if(this._decorations.length===0)return null;for(let i=this._decorations.length-1;i>=0;i--){const e=this._decorations[i],s=this._editor.getModel().getDecorationRange(e);if(s&&!(s.endLineNumber>t.lineNumber)&&(s.endLineNumber<t.lineNumber||!(s.endColumn>t.column)))return s}return this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length-1])}matchAfterPosition(t){if(this._decorations.length===0)return null;for(let i=0,e=this._decorations.length;i<e;i++){const e=this._decorations[i],s=this._editor.getModel().getDecorationRange(e);if(s&&!(s.startLineNumber<t.lineNumber)&&(s.startLineNumber>t.lineNumber||!(s.startColumn<t.column)))return s}return this._editor.getModel().getDecorationRange(this._decorations[0])}_allDecorations(){let t=[];return t=t.concat(this._decorations),t=t.concat(this._overviewRulerApproximateDecorations),this._findScopeDecorationIds.length&&t.push(...this._findScopeDecorationIds),this._rangeHighlightDecorationId&&t.push(this._rangeHighlightDecorationId),t}}z6._CURRENT_FIND_MATCH_DECORATION=xF.register({description:"current-find-match",stickiness:1,zIndex:13,className:"currentFindMatch",showIfCollapsed:!0,overviewRuler:{color:MC(tb),position:Yf.Center},minimap:{color:MC(rb),position:1}}),z6._FIND_MATCH_DECORATION=xF.register({description:"find-match",stickiness:1,zIndex:10,className:"findMatch",showIfCollapsed:!0,overviewRuler:{color:MC(tb),position:Yf.Center},minimap:{color:MC(rb),position:1}}),z6._FIND_MATCH_NO_OVERVIEW_DECORATION=xF.register({description:"find-match-no-overview",stickiness:1,className:"findMatch",showIfCollapsed:!0}),z6._FIND_MATCH_ONLY_OVERVIEW_DECORATION=xF.register({description:"find-match-only-overview",stickiness:1,overviewRuler:{color:MC(tb),position:Yf.Center}}),z6._RANGE_HIGHLIGHT_DECORATION=xF.register({description:"find-range-highlight",stickiness:1,className:"rangeHighlight",isWholeLine:!0}),z6._FIND_SCOPE_DECORATION=xF.register({description:"find-scope",className:"findScope",isWholeLine:!0});class U6{constructor(t,i,e){this._editorSelection=t,this._ranges=i,this._replaceStrings=e,this._trackedEditorSelectionId=null}getEditOperations(t,i){if(this._ranges.length>0){const t=[];for(let i=0;i<this._ranges.length;i++)t.push({range:this._ranges[i],text:this._replaceStrings[i]});t.sort(((t,i)=>Cs.compareRangesUsingStarts(t.range,i.range)));const e=[];let s=t[0];for(let i=1;i<t.length;i++)s.range.endLineNumber===t[i].range.startLineNumber&&s.range.endColumn===t[i].range.startColumn?(s.range=s.range.plusRange(t[i].range),s.text=s.text+t[i].text):(e.push(s),s=t[i]);e.push(s);for(const t of e)i.addEditOperation(t.range,t.text)}this._trackedEditorSelectionId=i.trackSelection(this._editorSelection)}computeCursorState(t,i){return i.getTrackedSelection(this._trackedEditorSelectionId)}}function K6(t,i){if(t&&t[0]!==""){const e=q6(t,i,"-"),s=q6(t,i,"_");return e&&!s?G6(t,i,"-"):!e&&s?G6(t,i,"_"):t[0].toUpperCase()===t[0]?i.toUpperCase():t[0].toLowerCase()===t[0]?i.toLowerCase():function(t,i=!1){return!!t&&(i&&(t=t.replace(/\\./g,"")),t.toLowerCase()!==t)}(t[0][0])&&i.length>0?i[0].toUpperCase()+i.substr(1):t[0][0].toUpperCase()!==t[0][0]&&i.length>0?i[0].toLowerCase()+i.substr(1):i}return i}function q6(t,i,e){return t[0].indexOf(e)!==-1&&i.indexOf(e)!==-1&&t[0].split(e).length===i.split(e).length}function G6(t,i,e){const s=i.split(e),n=t[0].split(e);let r="";return s.forEach(((t,i)=>{r+=K6([n[i]],t)+e})),r.slice(0,-1)}class Z6{constructor(t){this.staticValue=t,this.kind=0}}class J6{constructor(t){this.pieces=t,this.kind=1}}class Q6{static fromStaticValue(t){return new Q6([Y6.staticValue(t)])}get hasReplacementPatterns(){return this._state.kind===1}constructor(t){t&&t.length!==0?t.length===1&&t[0].staticValue!==null?this._state=new Z6(t[0].staticValue):this._state=new J6(t):this._state=new Z6("")}buildReplaceString(t,i){if(this._state.kind===0)return i?K6(t,this._state.staticValue):this._state.staticValue;let e="";for(let i=0,s=this._state.pieces.length;i<s;i++){const s=this._state.pieces[i];if(s.staticValue!==null){e+=s.staticValue;continue}let n=Q6._substitute(s.matchIndex,t);if(s.caseOps!==null&&s.caseOps.length>0){const t=[],i=s.caseOps.length;let e=0;for(let r=0,o=n.length;r<o;r++){if(e>=i){t.push(n.slice(r));break}switch(s.caseOps[e]){case"U":t.push(n[r].toUpperCase());break;case"u":t.push(n[r].toUpperCase()),e++;break;case"L":t.push(n[r].toLowerCase());break;case"l":t.push(n[r].toLowerCase()),e++;break;default:t.push(n[r])}}n=t.join("")}e+=n}return e}static _substitute(t,i){if(i===null)return"";if(t===0)return i[0];let e="";for(;t>0;){if(t<i.length)return(i[t]||"")+e;e=String(t%10)+e,t=Math.floor(t/10)}return"$"+e}}class Y6{static staticValue(t){return new Y6(t,-1,null)}static caseOps(t,i){return new Y6(null,t,i)}constructor(t,i,e){this.staticValue=t,this.matchIndex=i,e&&e.length!==0?this.caseOps=e.slice(0):this.caseOps=null}}class X6{constructor(t){this._source=t,this._lastCharIndex=0,this._result=[],this._resultLen=0,this._currentStaticPiece=""}emitUnchanged(t){this._emitStatic(this._source.substring(this._lastCharIndex,t)),this._lastCharIndex=t}emitStatic(t,i){this._emitStatic(t),this._lastCharIndex=i}_emitStatic(t){t.length!==0&&(this._currentStaticPiece+=t)}emitMatchIndex(t,i,e){this._currentStaticPiece.length!==0&&(this._result[this._resultLen++]=Y6.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),this._result[this._resultLen++]=Y6.caseOps(t,e),this._lastCharIndex=i}finalize(){return this.emitUnchanged(this._source.length),this._currentStaticPiece.length!==0&&(this._result[this._resultLen++]=Y6.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),new Q6(this._result)}}const t9=new Ta("findWidgetVisible",!1);t9.toNegated();const i9=new Ta("findInputFocussed",!1),e9=new Ta("replaceInputFocussed",!1),s9={primary:545,mac:{primary:2593}},n9={primary:565,mac:{primary:2613}},r9={primary:560,mac:{primary:2608}},o9={primary:554,mac:{primary:2602}},h9={primary:558,mac:{primary:2606}},c9="actions.find",l9="actions.findWithSelection",a9="editor.actions.findWithArgs",u9="editor.action.nextMatchFindAction",d9="editor.action.previousMatchFindAction",f9="editor.action.goToMatchFindAction",g9="editor.action.nextSelectionMatchFindAction",p9="editor.action.previousSelectionMatchFindAction",m9="editor.action.startFindReplaceAction",w9="closeFindWidget",v9="toggleFindCaseSensitive",b9="toggleFindWholeWord",y9="toggleFindRegex",k9="toggleFindInSelection",C9="togglePreserveCase",S9="editor.action.replaceOne",x9="editor.action.replaceAll",D9="editor.action.selectAllMatches",E9=19999;class A9{constructor(t,i){this._toDispose=new Ji,this._editor=t,this._state=i,this._isDisposed=!1,this._startSearchingTimer=new yo,this._decorations=new z6(t),this._toDispose.add(this._decorations),this._updateDecorationsScheduler=new Co((()=>this.research(!1)),100),this._toDispose.add(this._updateDecorationsScheduler),this._toDispose.add(this._editor.onDidChangeCursorPosition((t=>{t.reason!==3&&t.reason!==5&&t.reason!==6||this._decorations.setStartPosition(this._editor.getPosition())}))),this._ignoreModelContentChanged=!1,this._toDispose.add(this._editor.onDidChangeModelContent((t=>{this._ignoreModelContentChanged||(t.isFlush&&this._decorations.reset(),this._decorations.setStartPosition(this._editor.getPosition()),this._updateDecorationsScheduler.schedule())}))),this._toDispose.add(this._state.onFindReplaceStateChange((t=>this._onStateChanged(t)))),this.research(!1,this._state.searchScope)}dispose(){this._isDisposed=!0,qi(this._startSearchingTimer),this._toDispose.dispose()}_onStateChanged(t){!this._isDisposed&&this._editor.hasModel()&&(t.searchString||t.isReplaceRevealed||t.isRegex||t.wholeWord||t.matchCase||t.searchScope)&&(this._editor.getModel().isTooLargeForSyncing()?(this._startSearchingTimer.cancel(),this._startSearchingTimer.setIfNotSet((()=>{t.searchScope?this.research(t.moveCursor,this._state.searchScope):this.research(t.moveCursor)}),240)):t.searchScope?this.research(t.moveCursor,this._state.searchScope):this.research(t.moveCursor))}static _getSearchRange(t,i){return i||t.getFullModelRange()}research(t,i){let e=null;i!==void 0?i!==null&&(e=Array.isArray(i)?i:[i]):e=this._decorations.getFindScopes(),e!==null&&(e=e.map((t=>{if(t.startLineNumber!==t.endLineNumber){let i=t.endLineNumber;return t.endColumn===1&&(i-=1),new Cs(t.startLineNumber,1,i,this._editor.getModel().getLineMaxColumn(i))}return t})));const s=this._findMatches(e,!1,E9);this._decorations.set(s,e);const n=this._editor.getSelection();let r=this._decorations.getCurrentMatchesPosition(n);if(r===0&&s.length>0){const t=Sg(s.map((t=>t.range)),(t=>Cs.compareRangesUsingStarts(t,n)>=0));r=t>0?t-1+1:r}this._state.changeMatchInfo(r,this._decorations.getCount(),void 0),t&&this._editor.getOption(41).cursorMoveOnType&&this._moveToNextMatch(this._decorations.getStartPosition())}_hasMatches(){return this._state.matchesCount>0}_cannotFind(){if(!this._hasMatches()){const t=this._decorations.getFindScope();return t&&this._editor.revealRangeInCenterIfOutsideViewport(t,0),!0}return!1}_setCurrentFindMatch(t){const i=this._decorations.setCurrentFindMatch(t);this._state.changeMatchInfo(i,this._decorations.getCount(),t),this._editor.setSelection(t),this._editor.revealRangeInCenterIfOutsideViewport(t,0)}_prevSearchPosition(t){const i=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0);let{lineNumber:e,column:s}=t;const n=this._editor.getModel();return i||s===1?(e===1?e=n.getLineCount():e--,s=n.getLineMaxColumn(e)):s--,new ks(e,s)}_moveToPrevMatch(t,i=!1){if(!this._state.canNavigateBack()){const i=this._decorations.matchAfterPosition(t);return void(i&&this._setCurrentFindMatch(i))}if(this._decorations.getCount()<E9){let i=this._decorations.matchBeforePosition(t);return i&&i.isEmpty()&&i.getStartPosition().equals(t)&&(t=this._prevSearchPosition(t),i=this._decorations.matchBeforePosition(t)),void(i&&this._setCurrentFindMatch(i))}if(this._cannotFind())return;const e=this._decorations.getFindScope(),s=A9._getSearchRange(this._editor.getModel(),e);s.getEndPosition().isBefore(t)&&(t=s.getEndPosition()),t.isBefore(s.getStartPosition())&&(t=s.getEndPosition());const{lineNumber:n,column:r}=t,o=this._editor.getModel();let h=new ks(n,r),c=o.findPreviousMatch(this._state.searchString,h,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(131):null,!1);return c&&c.range.isEmpty()&&c.range.getStartPosition().equals(h)&&(h=this._prevSearchPosition(h),c=o.findPreviousMatch(this._state.searchString,h,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(131):null,!1)),c?i||s.containsRange(c.range)?void this._setCurrentFindMatch(c.range):this._moveToPrevMatch(c.range.getStartPosition(),!0):void 0}moveToPrevMatch(){this._moveToPrevMatch(this._editor.getSelection().getStartPosition())}_nextSearchPosition(t){const i=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0);let{lineNumber:e,column:s}=t;const n=this._editor.getModel();return i||s===n.getLineMaxColumn(e)?(e===n.getLineCount()?e=1:e++,s=1):s++,new ks(e,s)}_moveToNextMatch(t){if(!this._state.canNavigateForward()){const i=this._decorations.matchBeforePosition(t);return void(i&&this._setCurrentFindMatch(i))}if(this._decorations.getCount()<E9){let i=this._decorations.matchAfterPosition(t);return i&&i.isEmpty()&&i.getStartPosition().equals(t)&&(t=this._nextSearchPosition(t),i=this._decorations.matchAfterPosition(t)),void(i&&this._setCurrentFindMatch(i))}const i=this._getNextMatch(t,!1,!0);i&&this._setCurrentFindMatch(i.range)}_getNextMatch(t,i,e,s=!1){if(this._cannotFind())return null;const n=this._decorations.getFindScope(),r=A9._getSearchRange(this._editor.getModel(),n);r.getEndPosition().isBefore(t)&&(t=r.getStartPosition()),t.isBefore(r.getStartPosition())&&(t=r.getStartPosition());const{lineNumber:o,column:h}=t,c=this._editor.getModel();let l=new ks(o,h),a=c.findNextMatch(this._state.searchString,l,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(131):null,i);return e&&a&&a.range.isEmpty()&&a.range.getStartPosition().equals(l)&&(l=this._nextSearchPosition(l),a=c.findNextMatch(this._state.searchString,l,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(131):null,i)),a?s||r.containsRange(a.range)?a:this._getNextMatch(a.range.getEndPosition(),i,e,!0):null}moveToNextMatch(){this._moveToNextMatch(this._editor.getSelection().getEndPosition())}_moveToMatch(t){const i=this._decorations.getDecorationRangeAt(t);i&&this._setCurrentFindMatch(i)}moveToMatch(t){this._moveToMatch(t)}_getReplacePattern(){return this._state.isRegex?function(t){if(!t||t.length===0)return new Q6(null);const i=[],e=new X6(t);for(let s=0,n=t.length;s<n;s++){const r=t.charCodeAt(s);if(r!==92){if(r===36){if(s++,s>=n)break;const r=t.charCodeAt(s);if(r===36){e.emitUnchanged(s-1),e.emitStatic("$",s+1);continue}if(r===48||r===38){e.emitUnchanged(s-1),e.emitMatchIndex(0,s+1,i),i.length=0;continue}if(49<=r&&r<=57){let o=r-48;if(s+1<n){const n=t.charCodeAt(s+1);if(48<=n&&n<=57){s++,o=10*o+(n-48),e.emitUnchanged(s-2),e.emitMatchIndex(o,s+1,i),i.length=0;continue}}e.emitUnchanged(s-1),e.emitMatchIndex(o,s+1,i),i.length=0;continue}}}else{if(s++,s>=n)break;const r=t.charCodeAt(s);switch(r){case 92:e.emitUnchanged(s-1),e.emitStatic("\\",s+1);break;case 110:e.emitUnchanged(s-1),e.emitStatic(`\n`,s+1);break;case 116:e.emitUnchanged(s-1),e.emitStatic("\t",s+1);break;case 117:case 85:case 108:case 76:e.emitUnchanged(s-1),e.emitStatic("",s+1),i.push(String.fromCharCode(r))}}}return e.finalize()}(this._state.replaceString):Q6.fromStaticValue(this._state.replaceString)}replace(){if(!this._hasMatches())return;const t=this._getReplacePattern(),i=this._editor.getSelection(),e=this._getNextMatch(i.getStartPosition(),!0,!1);if(e)if(i.equalsRange(e.range)){const s=t.buildReplaceString(e.matches,this._state.preserveCase),n=new ix(i,s);this._executeEditorCommand("replace",n),this._decorations.setStartPosition(new ks(i.startLineNumber,i.startColumn+s.length)),this.research(!0)}else this._decorations.setStartPosition(this._editor.getPosition()),this._setCurrentFindMatch(e.range)}_findMatches(t,i,e){const s=(t||[null]).map((t=>A9._getSearchRange(this._editor.getModel(),t)));return this._editor.getModel().findMatches(this._state.searchString,s,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(131):null,i,e)}replaceAll(){if(!this._hasMatches())return;const t=this._decorations.getFindScopes();t===null&&this._state.matchesCount>=E9?this._largeReplaceAll():this._regularReplaceAll(t),this.research(!1)}_largeReplaceAll(){const t=new hg(this._state.searchString,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(131):null).parseSearchRequest();if(!t)return;let i=t.regex;if(!i.multiline){let t="mu";i.ignoreCase&&(t+="i"),i.global&&(t+="g"),i=new RegExp(i.source,t)}const e=this._editor.getModel(),s=e.getValue(1),n=e.getFullModelRange(),r=this._getReplacePattern();let o;const h=this._state.preserveCase;o=r.hasReplacementPatterns||h?s.replace(i,(function(){return r.buildReplaceString(arguments,h)})):s.replace(i,r.buildReplaceString(null,h));const c=new rx(n,o,this._editor.getSelection());this._executeEditorCommand("replaceAll",c)}_regularReplaceAll(t){const i=this._getReplacePattern(),e=this._findMatches(t,i.hasReplacementPatterns||this._state.preserveCase,1073741824),s=[];for(let t=0,n=e.length;t<n;t++)s[t]=i.buildReplaceString(e[t].matches,this._state.preserveCase);const n=new U6(this._editor.getSelection(),e.map((t=>t.range)),s);this._executeEditorCommand("replaceAll",n)}selectAllMatches(){if(!this._hasMatches())return;const t=this._decorations.getFindScopes();let i=this._findMatches(t,!1,1073741824).map((t=>new Ss(t.range.startLineNumber,t.range.startColumn,t.range.endLineNumber,t.range.endColumn)));const e=this._editor.getSelection();for(let t=0,s=i.length;t<s;t++)if(i[t].equalsRange(e)){i=[e].concat(i.slice(0,t)).concat(i.slice(t+1));break}this._editor.setSelections(i)}_executeEditorCommand(t,i){try{this._ignoreModelContentChanged=!0,this._editor.pushUndoStop(),this._editor.executeCommand(t,i),this._editor.pushUndoStop()}finally{this._ignoreModelContentChanged=!1}}}class M9 extends jk{constructor(t,i,e){super(),this._hideSoon=this._register(new Co((()=>this._hide()),2e3)),this._isVisible=!1,this._editor=t,this._state=i,this._keybindingService=e,this._domNode=document.createElement("div"),this._domNode.className="findOptionsWidget",this._domNode.style.display="none",this._domNode.style.top="10px",this._domNode.style.zIndex="12",this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true");const s={inputActiveOptionBorder:Tw(mb),inputActiveOptionForeground:Tw(vb),inputActiveOptionBackground:Tw(wb)},n=this._register(oB());this.caseSensitive=this._register(new iH({appendTitle:this._keybindingLabelFor(v9),isChecked:this._state.matchCase,hoverDelegate:n,...s})),this._domNode.appendChild(this.caseSensitive.domNode),this._register(this.caseSensitive.onChange((()=>{this._state.change({matchCase:this.caseSensitive.checked},!1)}))),this.wholeWords=this._register(new eH({appendTitle:this._keybindingLabelFor(b9),isChecked:this._state.wholeWord,hoverDelegate:n,...s})),this._domNode.appendChild(this.wholeWords.domNode),this._register(this.wholeWords.onChange((()=>{this._state.change({wholeWord:this.wholeWords.checked},!1)}))),this.regex=this._register(new sH({appendTitle:this._keybindingLabelFor(y9),isChecked:this._state.isRegex,hoverDelegate:n,...s})),this._domNode.appendChild(this.regex.domNode),this._register(this.regex.onChange((()=>{this._state.change({isRegex:this.regex.checked},!1)}))),this._editor.addOverlayWidget(this),this._register(this._state.onFindReplaceStateChange((t=>{let i=!1;t.isRegex&&(this.regex.checked=this._state.isRegex,i=!0),t.wholeWord&&(this.wholeWords.checked=this._state.wholeWord,i=!0),t.matchCase&&(this.caseSensitive.checked=this._state.matchCase,i=!0),!this._state.isRevealed&&i&&this._revealTemporarily()}))),this._register(sc(this._domNode,qc.MOUSE_LEAVE,(t=>this._onMouseLeave()))),this._register(sc(this._domNode,"mouseover",(t=>this._onMouseOver())))}_keybindingLabelFor(t){const i=this._keybindingService.lookupKeybinding(t);return i?` (${i.getLabel()})`:""}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return M9.ID}getDomNode(){return this._domNode}getPosition(){return{preference:0}}highlightFindOptions(){this._revealTemporarily()}_revealTemporarily(){this._show(),this._hideSoon.schedule()}_onMouseLeave(){this._hideSoon.schedule()}_onMouseOver(){this._hideSoon.cancel()}_show(){this._isVisible||(this._isVisible=!0,this._domNode.style.display="block")}_hide(){this._isVisible&&(this._isVisible=!1,this._domNode.style.display="none")}}function L9(t,i){return t===1||t!==2&&i}M9.ID="editor.contrib.findOptionsWidget";class F9 extends Qi{get searchString(){return this._searchString}get replaceString(){return this._replaceString}get isRevealed(){return this._isRevealed}get isReplaceRevealed(){return this._isReplaceRevealed}get isRegex(){return L9(this._isRegexOverride,this._isRegex)}get wholeWord(){return L9(this._wholeWordOverride,this._wholeWord)}get matchCase(){return L9(this._matchCaseOverride,this._matchCase)}get preserveCase(){return L9(this._preserveCaseOverride,this._preserveCase)}get actualIsRegex(){return this._isRegex}get actualWholeWord(){return this._wholeWord}get actualMatchCase(){return this._matchCase}get actualPreserveCase(){return this._preserveCase}get searchScope(){return this._searchScope}get matchesPosition(){return this._matchesPosition}get matchesCount(){return this._matchesCount}get currentMatch(){return this._currentMatch}constructor(){super(),this._onFindReplaceStateChange=this._register(new le),this.onFindReplaceStateChange=this._onFindReplaceStateChange.event,this._searchString="",this._replaceString="",this._isRevealed=!1,this._isReplaceRevealed=!1,this._isRegex=!1,this._isRegexOverride=0,this._wholeWord=!1,this._wholeWordOverride=0,this._matchCase=!1,this._matchCaseOverride=0,this._preserveCase=!1,this._preserveCaseOverride=0,this._searchScope=null,this._matchesPosition=0,this._matchesCount=0,this._currentMatch=null,this._loop=!0,this._isSearching=!1,this._filters=null}changeMatchInfo(t,i,e){const s={moveCursor:!1,updateHistory:!1,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1};let n=!1;i===0&&(t=0),t>i&&(t=i),this._matchesPosition!==t&&(this._matchesPosition=t,s.matchesPosition=!0,n=!0),this._matchesCount!==i&&(this._matchesCount=i,s.matchesCount=!0,n=!0),e!==void 0&&(Cs.equalsRange(this._currentMatch,e)||(this._currentMatch=e,s.currentMatch=!0,n=!0)),n&&this._onFindReplaceStateChange.fire(s)}change(t,i,e=!0){var s;const n={moveCursor:i,updateHistory:e,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1};let r=!1;const o=this.isRegex,h=this.wholeWord,c=this.matchCase,l=this.preserveCase;t.searchString!==void 0&&this._searchString!==t.searchString&&(this._searchString=t.searchString,n.searchString=!0,r=!0),t.replaceString!==void 0&&this._replaceString!==t.replaceString&&(this._replaceString=t.replaceString,n.replaceString=!0,r=!0),t.isRevealed!==void 0&&this._isRevealed!==t.isRevealed&&(this._isRevealed=t.isRevealed,n.isRevealed=!0,r=!0),t.isReplaceRevealed!==void 0&&this._isReplaceRevealed!==t.isReplaceRevealed&&(this._isReplaceRevealed=t.isReplaceRevealed,n.isReplaceRevealed=!0,r=!0),t.isRegex!==void 0&&(this._isRegex=t.isRegex),t.wholeWord!==void 0&&(this._wholeWord=t.wholeWord),t.matchCase!==void 0&&(this._matchCase=t.matchCase),t.preserveCase!==void 0&&(this._preserveCase=t.preserveCase),t.searchScope!==void 0&&(!((s=t.searchScope)===null||s===void 0)&&s.every((t=>{var i;return(i=this._searchScope)===null||i===void 0?void 0:i.some((i=>!Cs.equalsRange(i,t)))}))||(this._searchScope=t.searchScope,n.searchScope=!0,r=!0)),t.loop!==void 0&&this._loop!==t.loop&&(this._loop=t.loop,n.loop=!0,r=!0),t.isSearching!==void 0&&this._isSearching!==t.isSearching&&(this._isSearching=t.isSearching,n.isSearching=!0,r=!0),t.filters!==void 0&&(this._filters?this._filters.update(t.filters):this._filters=t.filters,n.filters=!0,r=!0),this._isRegexOverride=t.isRegexOverride!==void 0?t.isRegexOverride:0,this._wholeWordOverride=t.wholeWordOverride!==void 0?t.wholeWordOverride:0,this._matchCaseOverride=t.matchCaseOverride!==void 0?t.matchCaseOverride:0,this._preserveCaseOverride=t.preserveCaseOverride!==void 0?t.preserveCaseOverride:0,o!==this.isRegex&&(r=!0,n.isRegex=!0),h!==this.wholeWord&&(r=!0,n.wholeWord=!0),c!==this.matchCase&&(r=!0,n.matchCase=!0),l!==this.preserveCase&&(r=!0,n.preserveCase=!0),r&&this._onFindReplaceStateChange.fire(n)}canNavigateBack(){return this.canNavigateInLoop()||this.matchesPosition!==1}canNavigateForward(){return this.canNavigateInLoop()||this.matchesPosition<this.matchesCount}canNavigateInLoop(){return this._loop||this.matchesCount>=E9}}const T9=tt(0,"input"),R9=tt(0,"Preserve Case");class O9 extends Cj{constructor(t){var i;super({icon:As.preserveCase,title:R9+t.appendTitle,isChecked:t.isChecked,hoverDelegate:(i=t.hoverDelegate)!==null&&i!==void 0?i:rB("element"),inputActiveOptionBorder:t.inputActiveOptionBorder,inputActiveOptionForeground:t.inputActiveOptionForeground,inputActiveOptionBackground:t.inputActiveOptionBackground})}}class I9 extends jk{constructor(t,i,e,s){super(),this._showOptionButtons=e,this.fixFocusOnOptionClickEnabled=!0,this.cachedOptionsWidth=0,this._onDidOptionChange=this._register(new le),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new le),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new le),this._onInput=this._register(new le),this._onKeyUp=this._register(new le),this._onPreserveCaseKeyDown=this._register(new le),this.onPreserveCaseKeyDown=this._onPreserveCaseKeyDown.event,this.contextViewProvider=i,this.placeholder=s.placeholder||"",this.validation=s.validation,this.label=s.label||T9;const n=s.appendPreserveCaseLabel||"",r=s.history||[],o=!!s.flexibleHeight,h=!!s.flexibleWidth,c=s.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new cH(this.domNode,this.contextViewProvider,{ariaLabel:this.label||"",placeholder:this.placeholder||"",validationOptions:{validation:this.validation},history:r,showHistoryHint:s.showHistoryHint,flexibleHeight:o,flexibleWidth:h,flexibleMaxHeight:c,inputBoxStyles:s.inputBoxStyles})),this.preserveCase=this._register(new O9({appendTitle:n,isChecked:!1,...s.toggleStyles})),this._register(this.preserveCase.onChange((t=>{this._onDidOptionChange.fire(t),!t&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()}))),this._register(this.preserveCase.onKeyDown((t=>{this._onPreserveCaseKeyDown.fire(t)}))),this._showOptionButtons?this.cachedOptionsWidth=this.preserveCase.width():this.cachedOptionsWidth=0;const l=[this.preserveCase.domNode];this.onkeydown(this.domNode,(t=>{if(t.equals(15)||t.equals(17)||t.equals(9)){const i=l.indexOf(this.domNode.ownerDocument.activeElement);if(i>=0){let e=-1;t.equals(17)?e=(i+1)%l.length:t.equals(15)&&(e=i===0?l.length-1:i-1),t.equals(9)?(l[i].blur(),this.inputBox.focus()):e>=0&&l[e].focus(),Zc(t,!0)}}}));const a=document.createElement("div");a.className="controls",a.style.display=this._showOptionButtons?"block":"none",a.appendChild(this.preserveCase.domNode),this.domNode.appendChild(a),t==null||t.appendChild(this.domNode),this.onkeydown(this.inputBox.inputElement,(t=>this._onKeyDown.fire(t))),this.onkeyup(this.inputBox.inputElement,(t=>this._onKeyUp.fire(t))),this.oninput(this.inputBox.inputElement,(t=>this._onInput.fire())),this.onmousedown(this.inputBox.inputElement,(t=>this._onMouseDown.fire(t)))}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.preserveCase.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.preserveCase.disable()}setEnabled(t){t?this.enable():this.disable()}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getPreserveCase(){return this.preserveCase.checked}setPreserveCase(t){this.preserveCase.checked=t}focusOnPreserve(){this.preserveCase.focus()}validate(){var t;(t=this.inputBox)===null||t===void 0||t.validate()}set width(t){this.inputBox.paddingRight=this.cachedOptionsWidth,this.domNode.style.width=t+"px"}dispose(){super.dispose()}}var _9=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},P9=function(t,i){return function(e,s){i(e,s,t)}};const N9=new Ta("suggestWidgetVisible",!1,tt(0,"Whether suggestion are visible")),B9="historyNavigationWidgetFocus",$9="historyNavigationForwardsEnabled",W9="historyNavigationBackwardsEnabled";let j9;const H9=[];function V9(t,i){if(H9.includes(i))throw new Error("Cannot register the same widget multiple times");H9.push(i);const e=new Ji,s=new Ta(B9,!1).bindTo(t),n=new Ta($9,!0).bindTo(t),r=new Ta(W9,!0).bindTo(t),o=()=>{s.set(!0),j9=i},h=()=>{s.set(!1),j9===i&&(j9=void 0)};return Fc(i.element)&&o(),e.add(i.onDidFocus((()=>o()))),e.add(i.onDidBlur((()=>h()))),e.add(Zi((()=>{H9.splice(H9.indexOf(i),1),h()}))),{historyNavigationForwardsEnablement:n,historyNavigationBackwardsEnablement:r,dispose(){e.dispose()}}}let z9=class extends aH{constructor(t,i,e,s){super(t,i,e);const n=this._register(s.createScoped(this.inputBox.element));this._register(V9(n,this.inputBox))}};z9=_9([P9(3,Ra)],z9);let U9=class extends I9{constructor(t,i,e,s,n=!1){super(t,i,n,e);const r=this._register(s.createScoped(this.inputBox.element));this._register(V9(r,this.inputBox))}};function K9(t){var i,e;return((i=t.lookupKeybinding("history.showPrevious"))===null||i===void 0?void 0:i.getElectronAccelerator())==="Up"&&((e=t.lookupKeybinding("history.showNext"))===null||e===void 0?void 0:e.getElectronAccelerator())==="Down"}U9=_9([P9(3,Ra)],U9),Ua.registerCommandAndKeybindingRule({id:"history.showPrevious",weight:200,when:ua.and(ua.has(B9),ua.equals(W9,!0),ua.not("isComposing"),N9.isEqualTo(!1)),primary:16,secondary:[528],handler:t=>{j9==null||j9.showPreviousValue()}}),Ua.registerCommandAndKeybindingRule({id:"history.showNext",weight:200,when:ua.and(ua.has(B9),ua.equals($9,!0),ua.not("isComposing"),N9.isEqualTo(!1)),primary:18,secondary:[530],handler:t=>{j9==null||j9.showNextValue()}});const q9=qU("find-selection",As.selection,tt(0,"Icon for 'Find in Selection' in the editor find widget.")),G9=qU("find-collapsed",As.chevronRight,tt(0,"Icon to indicate that the editor find widget is collapsed.")),Z9=qU("find-expanded",As.chevronDown,tt(0,"Icon to indicate that the editor find widget is expanded.")),J9=qU("find-replace",As.replace,tt(0,"Icon for 'Replace' in the editor find widget.")),Q9=qU("find-replace-all",As.replaceAll,tt(0,"Icon for 'Replace All' in the editor find widget.")),Y9=qU("find-previous-match",As.arrowUp,tt(0,"Icon for 'Find Previous' in the editor find widget.")),X9=qU("find-next-match",As.arrowDown,tt(0,"Icon for 'Find Next' in the editor find widget.")),t7=tt(0,"Find / Replace"),i7=tt(0,"Find"),e7=tt(0,"Find"),s7=tt(0,"Previous Match"),n7=tt(0,"Next Match"),r7=tt(0,"Find in Selection"),o7=tt(0,"Close"),h7=tt(0,"Replace"),c7=tt(0,"Replace"),l7=tt(0,"Replace"),a7=tt(0,"Replace All"),u7=tt(0,"Toggle Replace"),d7=tt(0,"Only the first {0} results are highlighted, but all find operations work on the entire text.",E9),f7=tt(0,"{0} of {1}"),g7=tt(0,"No results"),p7=419;let m7=69;const w7="ctrlEnterReplaceAll.windows.donotask",v7=bt?256:2048;class b7{constructor(t){this.afterLineNumber=t,this.heightInPx=33,this.suppressMouseDown=!1,this.domNode=document.createElement("div"),this.domNode.className="dock-find-viewzone"}}function y7(t,i,e){const s=!!i.match(/\n/);e&&s&&e.selectionStart>0&&t.stopPropagation()}function k7(t,i,e){const s=!!i.match(/\n/);e&&s&&e.selectionEnd<e.value.length&&t.stopPropagation()}class C7 extends jk{constructor(t,i,e,s,n,r,o,h,c){super(),this._cachedHeight=null,this._revealTimeouts=[],this._codeEditor=t,this._controller=i,this._state=e,this._contextViewProvider=s,this._keybindingService=n,this._contextKeyService=r,this._storageService=h,this._notificationService=c,this._ctrlEnterReplaceAllWarningPrompted=!!h.getBoolean(w7,0),this._isVisible=!1,this._isReplaceVisible=!1,this._ignoreChangeEvent=!1,this._updateHistoryDelayer=new po(500),this._register(Zi((()=>this._updateHistoryDelayer.cancel()))),this._register(this._state.onFindReplaceStateChange((t=>this._onStateChanged(t)))),this._buildDomNode(),this._updateButtons(),this._tryUpdateWidgetWidth(),this._findInput.inputBox.layout(),this._register(this._codeEditor.onDidChangeConfiguration((t=>{if(t.hasChanged(91)&&(this._codeEditor.getOption(91)&&this._state.change({isReplaceRevealed:!1},!1),this._updateButtons()),t.hasChanged(145)&&this._tryUpdateWidgetWidth(),t.hasChanged(2)&&this.updateAccessibilitySupport(),t.hasChanged(41)){const t=this._codeEditor.getOption(41).loop;this._state.change({loop:t},!1);const i=this._codeEditor.getOption(41).addExtraSpaceOnTop;i&&!this._viewZone&&(this._viewZone=new b7(0),this._showViewZone()),!i&&this._viewZone&&this._removeViewZone()}}))),this.updateAccessibilitySupport(),this._register(this._codeEditor.onDidChangeCursorSelection((()=>{this._isVisible&&this._updateToggleSelectionFindButton()}))),this._register(this._codeEditor.onDidFocusEditorWidget((async()=>{if(this._isVisible){const t=await this._controller.getGlobalBufferTerm();t&&t!==this._state.searchString&&(this._state.change({searchString:t},!1),this._findInput.select())}}))),this._findInputFocused=i9.bindTo(r),this._findFocusTracker=this._register(Qc(this._findInput.inputBox.inputElement)),this._register(this._findFocusTracker.onDidFocus((()=>{this._findInputFocused.set(!0),this._updateSearchScope()}))),this._register(this._findFocusTracker.onDidBlur((()=>{this._findInputFocused.set(!1)}))),this._replaceInputFocused=e9.bindTo(r),this._replaceFocusTracker=this._register(Qc(this._replaceInput.inputBox.inputElement)),this._register(this._replaceFocusTracker.onDidFocus((()=>{this._replaceInputFocused.set(!0),this._updateSearchScope()}))),this._register(this._replaceFocusTracker.onDidBlur((()=>{this._replaceInputFocused.set(!1)}))),this._codeEditor.addOverlayWidget(this),this._codeEditor.getOption(41).addExtraSpaceOnTop&&(this._viewZone=new b7(0)),this._register(this._codeEditor.onDidChangeModel((()=>{this._isVisible&&(this._viewZoneId=void 0)}))),this._register(this._codeEditor.onDidScrollChange((t=>{t.scrollTopChanged?this._layoutViewZone():setTimeout((()=>{this._layoutViewZone()}),0)})))}getId(){return C7.ID}getDomNode(){return this._domNode}getPosition(){return this._isVisible?{preference:0}:null}_onStateChanged(t){if(t.searchString){try{this._ignoreChangeEvent=!0,this._findInput.setValue(this._state.searchString)}finally{this._ignoreChangeEvent=!1}this._updateButtons()}if(t.replaceString&&(this._replaceInput.inputBox.value=this._state.replaceString),t.isRevealed&&(this._state.isRevealed?this._reveal():this._hide(!0)),t.isReplaceRevealed&&(this._state.isReplaceRevealed?this._codeEditor.getOption(91)||this._isReplaceVisible||(this._isReplaceVisible=!0,this._replaceInput.width=yc(this._findInput.domNode),this._updateButtons(),this._replaceInput.inputBox.layout()):this._isReplaceVisible&&(this._isReplaceVisible=!1,this._updateButtons())),(t.isRevealed||t.isReplaceRevealed)&&(this._state.isRevealed||this._state.isReplaceRevealed)&&this._tryUpdateHeight()&&this._showViewZone(),t.isRegex&&this._findInput.setRegex(this._state.isRegex),t.wholeWord&&this._findInput.setWholeWords(this._state.wholeWord),t.matchCase&&this._findInput.setCaseSensitive(this._state.matchCase),t.preserveCase&&this._replaceInput.setPreserveCase(this._state.preserveCase),t.searchScope&&(this._state.searchScope?this._toggleSelectionFind.checked=!0:this._toggleSelectionFind.checked=!1,this._updateToggleSelectionFindButton()),t.searchString||t.matchesCount||t.matchesPosition){const t=this._state.searchString.length>0&&this._state.matchesCount===0;this._domNode.classList.toggle("no-results",t),this._updateMatchesCount(),this._updateButtons()}(t.searchString||t.currentMatch)&&this._layoutViewZone(),t.updateHistory&&this._delayedUpdateHistory(),t.loop&&this._updateButtons()}_delayedUpdateHistory(){this._updateHistoryDelayer.trigger(this._updateHistory.bind(this)).then(void 0,Ii)}_updateHistory(){this._state.searchString&&this._findInput.inputBox.addToHistory(),this._state.replaceString&&this._replaceInput.inputBox.addToHistory()}_updateMatchesCount(){let t;if(this._matchesCount.style.minWidth=m7+"px",this._state.matchesCount>=E9?this._matchesCount.title=d7:this._matchesCount.title="",this._matchesCount.firstChild&&this._matchesCount.removeChild(this._matchesCount.firstChild),this._state.matchesCount>0){let i=String(this._state.matchesCount);this._state.matchesCount>=E9&&(i+="+");let e=String(this._state.matchesPosition);e==="0"&&(e="?"),t=Kn(f7,e,i)}else t=g7;this._matchesCount.appendChild(document.createTextNode(t)),rw(this._getAriaLabel(t,this._state.currentMatch,this._state.searchString)),m7=Math.max(m7,this._matchesCount.clientWidth)}_getAriaLabel(t,i,e){if(t===g7)return e===""?tt(0,"{0} found",t):tt(0,"{0} found for '{1}'",t,e);if(i){const s=tt(0,"{0} found for '{1}', at {2}",t,e,i.startLineNumber+":"+i.startColumn),n=this._codeEditor.getModel();return n&&i.startLineNumber<=n.getLineCount()&&i.startLineNumber>=1?`${n.getLineContent(i.startLineNumber)}, ${s}`:s}return tt(0,"{0} found for '{1}'",t,e)}_updateToggleSelectionFindButton(){const t=this._codeEditor.getSelection(),i=!!t&&(t.startLineNumber!==t.endLineNumber||t.startColumn!==t.endColumn),e=this._toggleSelectionFind.checked;this._isVisible&&(e||i)?this._toggleSelectionFind.enable():this._toggleSelectionFind.disable()}_updateButtons(){this._findInput.setEnabled(this._isVisible),this._replaceInput.setEnabled(this._isVisible&&this._isReplaceVisible),this._updateToggleSelectionFindButton(),this._closeBtn.setEnabled(this._isVisible);const t=this._state.searchString.length>0,i=!!this._state.matchesCount;this._prevBtn.setEnabled(this._isVisible&&t&&i&&this._state.canNavigateBack()),this._nextBtn.setEnabled(this._isVisible&&t&&i&&this._state.canNavigateForward()),this._replaceBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&t),this._replaceAllBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&t),this._domNode.classList.toggle("replaceToggled",this._isReplaceVisible),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);const e=!this._codeEditor.getOption(91);this._toggleReplaceBtn.setEnabled(this._isVisible&&e)}_reveal(){if(this._revealTimeouts.forEach((t=>{clearTimeout(t)})),this._revealTimeouts=[],!this._isVisible){this._isVisible=!0;const t=this._codeEditor.getSelection();switch(this._codeEditor.getOption(41).autoFindInSelection){case"always":this._toggleSelectionFind.checked=!0;break;case"never":this._toggleSelectionFind.checked=!1;break;case"multiline":{const i=!!t&&t.startLineNumber!==t.endLineNumber;this._toggleSelectionFind.checked=i;break}}this._tryUpdateWidgetWidth(),this._updateButtons(),this._revealTimeouts.push(setTimeout((()=>{this._domNode.classList.add("visible"),this._domNode.setAttribute("aria-hidden","false")}),0)),this._revealTimeouts.push(setTimeout((()=>{this._findInput.validate()}),200)),this._codeEditor.layoutOverlayWidget(this);let i=!0;if(this._codeEditor.getOption(41).seedSearchStringFromSelection&&t){const e=this._codeEditor.getDomNode();if(e){const s=vc(e),n=this._codeEditor.getScrolledVisiblePosition(t.getStartPosition()),r=s.left+(n?n.left:0),o=n?n.top:0;if(this._viewZone&&o<this._viewZone.heightInPx){t.endLineNumber>t.startLineNumber&&(i=!1);const e=wc(this._domNode).left;r>e&&(i=!1);const n=this._codeEditor.getScrolledVisiblePosition(t.getEndPosition());s.left+(n?n.left:0)>e&&(i=!1)}}}this._showViewZone(i)}}_hide(t){this._revealTimeouts.forEach((t=>{clearTimeout(t)})),this._revealTimeouts=[],this._isVisible&&(this._isVisible=!1,this._updateButtons(),this._domNode.classList.remove("visible"),this._domNode.setAttribute("aria-hidden","true"),this._findInput.clearMessage(),t&&this._codeEditor.focus(),this._codeEditor.layoutOverlayWidget(this),this._removeViewZone())}_layoutViewZone(t){if(!this._codeEditor.getOption(41).addExtraSpaceOnTop)return void this._removeViewZone();if(!this._isVisible)return;const i=this._viewZone;this._viewZoneId===void 0&&i&&this._codeEditor.changeViewZones((e=>{i.heightInPx=this._getHeight(),this._viewZoneId=e.addZone(i),this._codeEditor.setScrollTop(t||this._codeEditor.getScrollTop()+i.heightInPx)}))}_showViewZone(t=!0){if(!this._isVisible||!this._codeEditor.getOption(41).addExtraSpaceOnTop)return;this._viewZone===void 0&&(this._viewZone=new b7(0));const i=this._viewZone;this._codeEditor.changeViewZones((e=>{if(this._viewZoneId!==void 0){const s=this._getHeight();if(s===i.heightInPx)return;const n=s-i.heightInPx;return i.heightInPx=s,e.layoutZone(this._viewZoneId),void(t&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+n))}{let s=this._getHeight();if(s-=this._codeEditor.getOption(84).top,s<=0)return;i.heightInPx=s,this._viewZoneId=e.addZone(i),t&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+s)}}))}_removeViewZone(){this._codeEditor.changeViewZones((t=>{this._viewZoneId!==void 0&&(t.removeZone(this._viewZoneId),this._viewZoneId=void 0,this._viewZone&&(this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()-this._viewZone.heightInPx),this._viewZone=void 0))}))}_tryUpdateWidgetWidth(){if(!this._isVisible||!this._domNode.isConnected)return;const t=this._codeEditor.getLayoutInfo();if(t.contentWidth<=0)return void this._domNode.classList.add("hiddenEditor");this._domNode.classList.contains("hiddenEditor")&&this._domNode.classList.remove("hiddenEditor");const i=t.width,e=t.minimap.minimapWidth;let s=!1,n=!1,r=!1;if(this._resized&&yc(this._domNode)>p7)return this._domNode.style.maxWidth=i-28-e-15+"px",void(this._replaceInput.width=yc(this._findInput.domNode));if(447+e>=i&&(n=!0),447+e-m7>=i&&(r=!0),447+e-m7>=i+50&&(s=!0),this._domNode.classList.toggle("collapsed-find-widget",s),this._domNode.classList.toggle("narrow-find-widget",r),this._domNode.classList.toggle("reduced-find-widget",n),r||s||(this._domNode.style.maxWidth=i-28-e-15+"px"),this._findInput.layout({collapsedFindWidget:s,narrowFindWidget:r,reducedFindWidget:n}),this._resized){const t=this._findInput.inputBox.element.clientWidth;t>0&&(this._replaceInput.width=t)}else this._isReplaceVisible&&(this._replaceInput.width=yc(this._findInput.domNode))}_getHeight(){let t=0;return t+=4,t+=this._findInput.inputBox.height+2,this._isReplaceVisible&&(t+=4,t+=this._replaceInput.inputBox.height+2),t+=4,t}_tryUpdateHeight(){const t=this._getHeight();return(this._cachedHeight===null||this._cachedHeight!==t)&&(this._cachedHeight=t,this._domNode.style.height=`${t}px`,!0)}focusFindInput(){this._findInput.select(),this._findInput.focus()}focusReplaceInput(){this._replaceInput.select(),this._replaceInput.focus()}highlightFindOptions(){this._findInput.highlightFindOptions()}_updateSearchScope(){if(this._codeEditor.hasModel()&&this._toggleSelectionFind.checked){const t=this._codeEditor.getSelections();t.map((t=>{t.endColumn===1&&t.endLineNumber>t.startLineNumber&&(t=t.setEndPosition(t.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(t.endLineNumber-1)));const i=this._state.currentMatch;return t.startLineNumber===t.endLineNumber||Cs.equalsRange(t,i)?null:t})).filter((t=>!!t)),t.length&&this._state.change({searchScope:t},!0)}}_onFindInputMouseDown(t){t.middleButton&&t.stopPropagation()}_onFindInputKeyDown(t){return t.equals(3|v7)?(this._keybindingService.dispatchEvent(t,t.target)||this._findInput.inputBox.insertAtCursor(`\n`),void t.preventDefault()):t.equals(2)?(this._isReplaceVisible?this._replaceInput.focus():this._findInput.focusOnCaseSensitive(),void t.preventDefault()):t.equals(2066)?(this._codeEditor.focus(),void t.preventDefault()):t.equals(16)?y7(t,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea")):t.equals(18)?k7(t,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea")):void 0}_onReplaceInputKeyDown(t){return t.equals(3|v7)?(this._keybindingService.dispatchEvent(t,t.target)||(vt&&kt&&!this._ctrlEnterReplaceAllWarningPrompted&&(this._notificationService.info(tt(0,"Ctrl+Enter now inserts line break instead of replacing all. You can modify the keybinding for editor.action.replaceAll to override this behavior.")),this._ctrlEnterReplaceAllWarningPrompted=!0,this._storageService.store(w7,!0,0,0)),this._replaceInput.inputBox.insertAtCursor(`\n`)),void t.preventDefault()):t.equals(2)?(this._findInput.focusOnCaseSensitive(),void t.preventDefault()):t.equals(1026)?(this._findInput.focus(),void t.preventDefault()):t.equals(2066)?(this._codeEditor.focus(),void t.preventDefault()):t.equals(16)?y7(t,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea")):t.equals(18)?k7(t,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea")):void 0}getVerticalSashLeft(t){return 0}_keybindingLabelFor(t){const i=this._keybindingService.lookupKeybinding(t);return i?` (${i.getLabel()})`:""}_buildDomNode(){this._findInput=this._register(new z9(null,this._contextViewProvider,{width:221,label:i7,placeholder:e7,appendCaseSensitiveLabel:this._keybindingLabelFor(v9),appendWholeWordsLabel:this._keybindingLabelFor(b9),appendRegexLabel:this._keybindingLabelFor(y9),validation:t=>{if(t.length===0||!this._findInput.getRegex())return null;try{return null}catch(t){return{content:t.message}}},flexibleHeight:!0,flexibleWidth:!0,flexibleMaxHeight:118,showCommonFindToggles:!0,showHistoryHint:()=>K9(this._keybindingService),inputBoxStyles:uW,toggleStyles:aW},this._contextKeyService)),this._findInput.setRegex(!!this._state.isRegex),this._findInput.setCaseSensitive(!!this._state.matchCase),this._findInput.setWholeWords(!!this._state.wholeWord),this._register(this._findInput.onKeyDown((t=>this._onFindInputKeyDown(t)))),this._register(this._findInput.inputBox.onDidChange((()=>{this._ignoreChangeEvent||this._state.change({searchString:this._findInput.getValue()},!0)}))),this._register(this._findInput.onDidOptionChange((()=>{this._state.change({isRegex:this._findInput.getRegex(),wholeWord:this._findInput.getWholeWords(),matchCase:this._findInput.getCaseSensitive()},!0)}))),this._register(this._findInput.onCaseSensitiveKeyDown((t=>{t.equals(1026)&&this._isReplaceVisible&&(this._replaceInput.focus(),t.preventDefault())}))),this._register(this._findInput.onRegexKeyDown((t=>{t.equals(2)&&this._isReplaceVisible&&(this._replaceInput.focusOnPreserve(),t.preventDefault())}))),this._register(this._findInput.inputBox.onDidHeightChange((t=>{this._tryUpdateHeight()&&this._showViewZone()}))),yt&&this._register(this._findInput.onMouseDown((t=>this._onFindInputMouseDown(t)))),this._matchesCount=document.createElement("div"),this._matchesCount.className="matchesCount",this._updateMatchesCount();const t=this._register(oB());this._prevBtn=this._register(new S7({label:s7+this._keybindingLabelFor(d9),icon:Y9,hoverDelegate:t,onTrigger:()=>{H(this._codeEditor.getAction(d9)).run().then(void 0,Ii)}})),this._nextBtn=this._register(new S7({label:n7+this._keybindingLabelFor(u9),icon:X9,hoverDelegate:t,onTrigger:()=>{H(this._codeEditor.getAction(u9)).run().then(void 0,Ii)}}));const i=document.createElement("div");i.className="find-part",i.appendChild(this._findInput.domNode);const e=document.createElement("div");e.className="find-actions",i.appendChild(e),e.appendChild(this._matchesCount),e.appendChild(this._prevBtn.domNode),e.appendChild(this._nextBtn.domNode),this._toggleSelectionFind=this._register(new Cj({icon:q9,title:r7+this._keybindingLabelFor(k9),isChecked:!1,hoverDelegate:t,inputActiveOptionBackground:Tw(wb),inputActiveOptionBorder:Tw(mb),inputActiveOptionForeground:Tw(vb)})),this._register(this._toggleSelectionFind.onChange((()=>{if(this._toggleSelectionFind.checked){if(this._codeEditor.hasModel()){let t=this._codeEditor.getSelections();t=t.map((t=>(t.endColumn===1&&t.endLineNumber>t.startLineNumber&&(t=t.setEndPosition(t.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(t.endLineNumber-1))),t.isEmpty()?null:t))).filter((t=>!!t)),t.length&&this._state.change({searchScope:t},!0)}}else this._state.change({searchScope:null},!0)}))),e.appendChild(this._toggleSelectionFind.domNode),this._closeBtn=this._register(new S7({label:o7+this._keybindingLabelFor(w9),icon:YU,hoverDelegate:t,onTrigger:()=>{this._state.change({isRevealed:!1,searchScope:null},!1)},onKeyDown:t=>{t.equals(2)&&this._isReplaceVisible&&(this._replaceBtn.isEnabled()?this._replaceBtn.focus():this._codeEditor.focus(),t.preventDefault())}})),this._replaceInput=this._register(new U9(null,void 0,{label:h7,placeholder:c7,appendPreserveCaseLabel:this._keybindingLabelFor(C9),history:[],flexibleHeight:!0,flexibleWidth:!0,flexibleMaxHeight:118,showHistoryHint:()=>K9(this._keybindingService),inputBoxStyles:uW,toggleStyles:aW},this._contextKeyService,!0)),this._replaceInput.setPreserveCase(!!this._state.preserveCase),this._register(this._replaceInput.onKeyDown((t=>this._onReplaceInputKeyDown(t)))),this._register(this._replaceInput.inputBox.onDidChange((()=>{this._state.change({replaceString:this._replaceInput.inputBox.value},!1)}))),this._register(this._replaceInput.inputBox.onDidHeightChange((t=>{this._isReplaceVisible&&this._tryUpdateHeight()&&this._showViewZone()}))),this._register(this._replaceInput.onDidOptionChange((()=>{this._state.change({preserveCase:this._replaceInput.getPreserveCase()},!0)}))),this._register(this._replaceInput.onPreserveCaseKeyDown((t=>{t.equals(2)&&(this._prevBtn.isEnabled()?this._prevBtn.focus():this._nextBtn.isEnabled()?this._nextBtn.focus():this._toggleSelectionFind.enabled?this._toggleSelectionFind.focus():this._closeBtn.isEnabled()&&this._closeBtn.focus(),t.preventDefault())})));const s=this._register(oB());this._replaceBtn=this._register(new S7({label:l7+this._keybindingLabelFor(S9),icon:J9,hoverDelegate:s,onTrigger:()=>{this._controller.replace()},onKeyDown:t=>{t.equals(1026)&&(this._closeBtn.focus(),t.preventDefault())}})),this._replaceAllBtn=this._register(new S7({label:a7+this._keybindingLabelFor(x9),icon:Q9,hoverDelegate:s,onTrigger:()=>{this._controller.replaceAll()}}));const n=document.createElement("div");n.className="replace-part",n.appendChild(this._replaceInput.domNode);const r=document.createElement("div");r.className="replace-actions",n.appendChild(r),r.appendChild(this._replaceBtn.domNode),r.appendChild(this._replaceAllBtn.domNode),this._toggleReplaceBtn=this._register(new S7({label:u7,className:"codicon toggle left",onTrigger:()=>{this._state.change({isReplaceRevealed:!this._isReplaceVisible},!1),this._isReplaceVisible&&(this._replaceInput.width=yc(this._findInput.domNode),this._replaceInput.inputBox.layout()),this._showViewZone()}})),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible),this._domNode=document.createElement("div"),this._domNode.className="editor-widget find-widget",this._domNode.setAttribute("aria-hidden","true"),this._domNode.ariaLabel=t7,this._domNode.role="dialog",this._domNode.style.width="419px",this._domNode.appendChild(this._toggleReplaceBtn.domNode),this._domNode.appendChild(i),this._domNode.appendChild(this._closeBtn.domNode),this._domNode.appendChild(n),this._resizeSash=this._register(new jj(this._domNode,this,{orientation:0,size:2})),this._resized=!1;let o=p7;this._register(this._resizeSash.onDidStart((()=>{o=yc(this._domNode)}))),this._register(this._resizeSash.onDidChange((t=>{this._resized=!0;const i=o+t.startX-t.currentX;i<p7||i>(parseFloat(fc(this._domNode).maxWidth)||0)||(this._domNode.style.width=`${i}px`,this._isReplaceVisible&&(this._replaceInput.width=yc(this._findInput.domNode)),this._findInput.inputBox.layout(),this._tryUpdateHeight())}))),this._register(this._resizeSash.onDidReset((()=>{const t=yc(this._domNode);if(t<p7)return;let i=p7;if(!this._resized||t===p7){const t=this._codeEditor.getLayoutInfo();i=t.width-28-t.minimap.minimapWidth-15,this._resized=!0}this._domNode.style.width=`${i}px`,this._isReplaceVisible&&(this._replaceInput.width=yc(this._findInput.domNode)),this._findInput.inputBox.layout()})))}updateAccessibilitySupport(){const t=this._codeEditor.getOption(2);this._findInput.setFocusInputOnOptionClick(t!==2)}}C7.ID="editor.contrib.findWidget";class S7 extends jk{constructor(t){var i;super(),this._opts=t;let e="button";this._opts.className&&(e=e+" "+this._opts.className),this._opts.icon&&(e=e+" "+Kl.asClassName(this._opts.icon)),this._domNode=document.createElement("div"),this._domNode.tabIndex=0,this._domNode.className=e,this._domNode.setAttribute("role","button"),this._domNode.setAttribute("aria-label",this._opts.label),this._register(lB((i=t.hoverDelegate)!==null&&i!==void 0?i:rB("element"),this._domNode,this._opts.label)),this.onclick(this._domNode,(t=>{this._opts.onTrigger(),t.preventDefault()})),this.onkeydown(this._domNode,(t=>{var i,e;if(t.equals(10)||t.equals(3))return this._opts.onTrigger(),void t.preventDefault();(e=(i=this._opts).onKeyDown)===null||e===void 0||e.call(i,t)}))}get domNode(){return this._domNode}isEnabled(){return this._domNode.tabIndex>=0}focus(){this._domNode.focus()}setEnabled(t){this._domNode.classList.toggle("disabled",!t),this._domNode.setAttribute("aria-disabled",String(!t)),this._domNode.tabIndex=t?0:-1}setExpanded(t){this._domNode.setAttribute("aria-expanded",String(!!t)),t?(this._domNode.classList.remove(...Kl.asClassNameArray(G9)),this._domNode.classList.add(...Kl.asClassNameArray(Z9))):(this._domNode.classList.remove(...Kl.asClassNameArray(Z9)),this._domNode.classList.add(...Kl.asClassNameArray(G9)))}}RC(((t,i)=>{const e=t.getColor(Cv);e&&i.addRule(`.monaco-editor .findMatch { border: 1px ${lk(t.type)?"dotted":"solid"} ${e}; box-sizing: border-box; }`);const s=t.getColor(Sv);s&&i.addRule(`.monaco-editor .findScope { border: 1px ${lk(t.type)?"dashed":"solid"} ${s}; }`);const n=t.getColor(qw);n&&i.addRule(`.monaco-editor .find-widget { border: 1px solid ${n}; }`)}));var x7,D7=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},E7=function(t,i){return function(e,s){i(e,s,t)}};function A7(t,i="single",e=!1){if(!t.hasModel())return null;const s=t.getSelection();if(i==="single"&&s.startLineNumber===s.endLineNumber||i==="multiple"){if(s.isEmpty()){const i=t.getConfiguredWordAtPosition(s.getStartPosition());if(i&&e===!1)return i.word}else if(t.getModel().getValueLengthInRange(s)<524288)return t.getModel().getValueInRange(s)}return null}let M7=x7=class extends Qi{get editor(){return this._editor}static get(t){return t.getContribution(x7.ID)}constructor(t,i,e,s,n){super(),this._editor=t,this._findWidgetVisible=t9.bindTo(i),this._contextKeyService=i,this._storageService=e,this._clipboardService=s,this._notificationService=n,this._updateHistoryDelayer=new po(500),this._state=this._register(new F9),this.loadQueryState(),this._register(this._state.onFindReplaceStateChange((t=>this._onStateChanged(t)))),this._model=null,this._register(this._editor.onDidChangeModel((()=>{const t=this._editor.getModel()&&this._state.isRevealed;this.disposeModel(),this._state.change({searchScope:null,matchCase:this._storageService.getBoolean("editor.matchCase",1,!1),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,!1),isRegex:this._storageService.getBoolean("editor.isRegex",1,!1),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,!1)},!1),t&&this._start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!1,updateSearchScope:!1,loop:this._editor.getOption(41).loop})})))}dispose(){this.disposeModel(),super.dispose()}disposeModel(){this._model&&(this._model.dispose(),this._model=null)}_onStateChanged(t){this.saveQueryState(t),t.isRevealed&&(this._state.isRevealed?this._findWidgetVisible.set(!0):(this._findWidgetVisible.reset(),this.disposeModel())),t.searchString&&this.setGlobalBufferTerm(this._state.searchString)}saveQueryState(t){t.isRegex&&this._storageService.store("editor.isRegex",this._state.actualIsRegex,1,1),t.wholeWord&&this._storageService.store("editor.wholeWord",this._state.actualWholeWord,1,1),t.matchCase&&this._storageService.store("editor.matchCase",this._state.actualMatchCase,1,1),t.preserveCase&&this._storageService.store("editor.preserveCase",this._state.actualPreserveCase,1,1)}loadQueryState(){this._state.change({matchCase:this._storageService.getBoolean("editor.matchCase",1,this._state.matchCase),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,this._state.wholeWord),isRegex:this._storageService.getBoolean("editor.isRegex",1,this._state.isRegex),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,this._state.preserveCase)},!1)}isFindInputFocused(){return!!i9.getValue(this._contextKeyService)}getState(){return this._state}closeFindWidget(){this._state.change({isRevealed:!1,searchScope:null},!1),this._editor.focus()}toggleCaseSensitive(){this._state.change({matchCase:!this._state.matchCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleWholeWords(){this._state.change({wholeWord:!this._state.wholeWord},!1),this._state.isRevealed||this.highlightFindOptions()}toggleRegex(){this._state.change({isRegex:!this._state.isRegex},!1),this._state.isRevealed||this.highlightFindOptions()}togglePreserveCase(){this._state.change({preserveCase:!this._state.preserveCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleSearchScope(){if(this._state.searchScope)this._state.change({searchScope:null},!0);else if(this._editor.hasModel()){let t=this._editor.getSelections();t=t.map((t=>(t.endColumn===1&&t.endLineNumber>t.startLineNumber&&(t=t.setEndPosition(t.endLineNumber-1,this._editor.getModel().getLineMaxColumn(t.endLineNumber-1))),t.isEmpty()?null:t))).filter((t=>!!t)),t.length&&this._state.change({searchScope:t},!0)}}setSearchString(t){this._state.isRegex&&(t=Gn(t)),this._state.change({searchString:t},!1)}highlightFindOptions(t=!1){}async _start(t,i){if(this.disposeModel(),!this._editor.hasModel())return;const e={...i,isRevealed:!0};if(t.seedSearchStringFromSelection==="single"){const i=A7(this._editor,t.seedSearchStringFromSelection,t.seedSearchStringFromNonEmptySelection);i&&(this._state.isRegex?e.searchString=Gn(i):e.searchString=i)}else if(t.seedSearchStringFromSelection==="multiple"&&!t.updateSearchScope){const i=A7(this._editor,t.seedSearchStringFromSelection);i&&(e.searchString=i)}if(!e.searchString&&t.seedSearchStringFromGlobalClipboard){const t=await this.getGlobalBufferTerm();if(!this._editor.hasModel())return;t&&(e.searchString=t)}if(t.forceRevealReplace||e.isReplaceRevealed?e.isReplaceRevealed=!0:this._findWidgetVisible.get()||(e.isReplaceRevealed=!1),t.updateSearchScope){const t=this._editor.getSelections();t.some((t=>!t.isEmpty()))&&(e.searchScope=t)}e.loop=t.loop,this._state.change(e,!1),this._model||(this._model=new A9(this._editor,this._state))}start(t,i){return this._start(t,i)}moveToNextMatch(){return!!this._model&&(this._model.moveToNextMatch(),!0)}moveToPrevMatch(){return!!this._model&&(this._model.moveToPrevMatch(),!0)}goToMatch(t){return!!this._model&&(this._model.moveToMatch(t),!0)}replace(){return!!this._model&&(this._model.replace(),!0)}replaceAll(){var t;return!!this._model&&(!((t=this._editor.getModel())===null||t===void 0)&&t.isTooLargeForHeapOperation()?(this._notificationService.warn(tt(0,"The file is too large to perform a replace all operation.")),!1):(this._model.replaceAll(),!0))}selectAllMatches(){return!!this._model&&(this._model.selectAllMatches(),this._editor.focus(),!0)}async getGlobalBufferTerm(){return this._editor.getOption(41).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()?this._clipboardService.readFindText():""}setGlobalBufferTerm(t){this._editor.getOption(41).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()&&this._clipboardService.writeFindText(t)}};M7.ID="editor.contrib.findController",M7=x7=D7([E7(1,Ra),E7(2,nW),E7(3,AK),E7(4,gR)],M7);let L7=class extends M7{constructor(t,i,e,s,n,r,o,h){super(t,e,o,h,r),this._contextViewService=i,this._keybindingService=s,this._themeService=n,this._widget=null,this._findOptionsWidget=null}async _start(t,i){this._widget||this._createFindWidget();const e=this._editor.getSelection();let s=!1;switch(this._editor.getOption(41).autoFindInSelection){case"always":s=!0;break;case"never":s=!1;break;case"multiline":s=!!e&&e.startLineNumber!==e.endLineNumber;break}t.updateSearchScope=t.updateSearchScope||s,await super._start(t,i),this._widget&&(t.shouldFocus===2?this._widget.focusReplaceInput():t.shouldFocus===1&&this._widget.focusFindInput())}highlightFindOptions(t=!1){this._widget||this._createFindWidget(),this._state.isRevealed&&!t?this._widget.highlightFindOptions():this._findOptionsWidget.highlightFindOptions()}_createFindWidget(){this._widget=this._register(new C7(this._editor,this,this._state,this._contextViewService,this._keybindingService,this._contextKeyService,this._themeService,this._storageService,this._notificationService)),this._findOptionsWidget=this._register(new M9(this._editor,this._state,this._keybindingService))}};L7=D7([E7(1,rI),E7(2,Ra),E7(3,NS),E7(4,AC),E7(5,gR),E7(6,nW),E7(7,AK)],L7);Cu(new wu({id:c9,label:tt(0,"Find"),alias:"Find",precondition:ua.or(Ox.focus,ua.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2084,weight:100},menuOpts:{menuId:Qa.MenubarEditMenu,group:"3_find",title:tt(0,"&&Find"),order:1}})).addImplementation(0,((t,i,e)=>{const s=M7.get(i);return!!s&&s.start({forceRevealReplace:!1,seedSearchStringFromSelection:i.getOption(41).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:i.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:i.getOption(41).globalFindClipboard,shouldFocus:1,shouldAnimate:!0,updateSearchScope:!1,loop:i.getOption(41).loop})}));const F7={description:"Open a new In-Editor Find Widget.",args:[{name:"Open a new In-Editor Find Widget args",schema:{properties:{searchString:{type:"string"},replaceString:{type:"string"},isRegex:{type:"boolean"},matchWholeWord:{type:"boolean"},isCaseSensitive:{type:"boolean"},preserveCase:{type:"boolean"},findInSelection:{type:"boolean"}}}}]};class T7 extends mu{async run(t,i){const e=M7.get(i);e&&!this._run(e)&&(await e.start({forceRevealReplace:!1,seedSearchStringFromSelection:e.getState().searchString.length===0&&i.getOption(41).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:i.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:!0,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:i.getOption(41).loop}),this._run(e))}}class R7 extends mu{async run(t,i){const e=M7.get(i);if(!e)return;const s=A7(i,"single",!1);s&&e.setSearchString(s),this._run(e)||(await e.start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:i.getOption(41).loop}),this._run(e))}}Cu(new wu({id:m9,label:tt(0,"Replace"),alias:"Replace",precondition:ua.or(Ox.focus,ua.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2086,mac:{primary:2596},weight:100},menuOpts:{menuId:Qa.MenubarEditMenu,group:"3_find",title:tt(0,"&&Replace"),order:2}})).addImplementation(0,((t,i,e)=>{if(!i.hasModel()||i.getOption(91))return!1;const s=M7.get(i);if(!s)return!1;const n=i.getSelection(),r=s.isFindInputFocused(),o=!n.isEmpty()&&n.startLineNumber===n.endLineNumber&&i.getOption(41).seedSearchStringFromSelection!=="never"&&!r,h=r||o?2:1;return s.start({forceRevealReplace:!0,seedSearchStringFromSelection:o?"single":"none",seedSearchStringFromNonEmptySelection:i.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:i.getOption(41).seedSearchStringFromSelection!=="never",shouldFocus:h,shouldAnimate:!0,updateSearchScope:!1,loop:i.getOption(41).loop})})),Su(M7.ID,L7,0),ku(class extends mu{constructor(){super({id:a9,label:tt(0,"Find With Arguments"),alias:"Find With Arguments",precondition:void 0,kbOpts:{kbExpr:null,primary:0,weight:100},metadata:F7})}async run(t,i,e){const s=M7.get(i);if(s){const t=e?{searchString:e.searchString,replaceString:e.replaceString,isReplaceRevealed:e.replaceString!==void 0,isRegex:e.isRegex,wholeWord:e.matchWholeWord,matchCase:e.isCaseSensitive,preserveCase:e.preserveCase}:{};await s.start({forceRevealReplace:!1,seedSearchStringFromSelection:s.getState().searchString.length===0&&i.getOption(41).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:i.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:!0,shouldFocus:1,shouldAnimate:!0,updateSearchScope:(e==null?void 0:e.findInSelection)||!1,loop:i.getOption(41).loop},t),s.setGlobalBufferTerm(s.getState().searchString)}}}),ku(class extends mu{constructor(){super({id:l9,label:tt(0,"Find With Selection"),alias:"Find With Selection",precondition:void 0,kbOpts:{kbExpr:null,primary:0,mac:{primary:2083},weight:100}})}async run(t,i){const e=M7.get(i);e&&(await e.start({forceRevealReplace:!1,seedSearchStringFromSelection:"multiple",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:i.getOption(41).loop}),e.setGlobalBufferTerm(e.getState().searchString))}}),ku(class extends T7{constructor(){super({id:u9,label:tt(0,"Find Next"),alias:"Find Next",precondition:void 0,kbOpts:[{kbExpr:Ox.focus,primary:61,mac:{primary:2085,secondary:[61]},weight:100},{kbExpr:ua.and(Ox.focus,i9),primary:3,weight:100}]})}_run(t){return!!t.moveToNextMatch()&&(t.editor.pushUndoStop(),!0)}}),ku(class extends T7{constructor(){super({id:d9,label:tt(0,"Find Previous"),alias:"Find Previous",precondition:void 0,kbOpts:[{kbExpr:Ox.focus,primary:1085,mac:{primary:3109,secondary:[1085]},weight:100},{kbExpr:ua.and(Ox.focus,i9),primary:1027,weight:100}]})}_run(t){return t.moveToPrevMatch()}}),ku(class extends mu{constructor(){super({id:f9,label:tt(0,"Go to Match..."),alias:"Go to Match...",precondition:t9}),this._highlightDecorations=[]}run(t,i,e){const s=M7.get(i);if(!s)return;const n=s.getState().matchesCount;if(n<1)return void t.get(gR).notify({severity:fR.Warning,message:tt(0,"No matches. Try searching for something else.")});const r=t.get(vj).createInputBox();r.placeholder=tt(0,"Type a number to go to a specific match (between 1 and {0})",n);const o=t=>{const i=parseInt(t);if(isNaN(i))return;const e=s.getState().matchesCount;return i>0&&i<=e?i-1:i<0&&i>=-e?e+i:void 0},h=t=>{const e=o(t);if(typeof e=="number"){r.validationMessage=void 0,s.goToMatch(e);const t=s.getState().currentMatch;t&&this.addDecorations(i,t)}else r.validationMessage=tt(0,"Please type a number between 1 and {0}",s.getState().matchesCount),this.clearDecorations(i)};r.onDidChangeValue((t=>{h(t)})),r.onDidAccept((()=>{const t=o(r.value);typeof t=="number"?(s.goToMatch(t),r.hide()):r.validationMessage=tt(0,"Please type a number between 1 and {0}",s.getState().matchesCount)})),r.onDidHide((()=>{this.clearDecorations(i),r.dispose()})),r.show()}clearDecorations(t){t.changeDecorations((t=>{this._highlightDecorations=t.deltaDecorations(this._highlightDecorations,[])}))}addDecorations(t,i){t.changeDecorations((t=>{this._highlightDecorations=t.deltaDecorations(this._highlightDecorations,[{range:i,options:{description:"find-match-quick-access-range-highlight",className:"rangeHighlight",isWholeLine:!0}},{range:i,options:{description:"find-match-quick-access-range-highlight-overview",overviewRuler:{color:MC(aS),position:Yf.Full}}}])}))}}),ku(class extends R7{constructor(){super({id:g9,label:tt(0,"Find Next Selection"),alias:"Find Next Selection",precondition:void 0,kbOpts:{kbExpr:Ox.focus,primary:2109,weight:100}})}_run(t){return t.moveToNextMatch()}}),ku(class extends R7{constructor(){super({id:p9,label:tt(0,"Find Previous Selection"),alias:"Find Previous Selection",precondition:void 0,kbOpts:{kbExpr:Ox.focus,primary:3133,weight:100}})}_run(t){return t.moveToPrevMatch()}});const O7=pu.bindToContribution(M7.get);yu(new O7({id:w9,precondition:t9,handler:t=>t.closeFindWidget(),kbOpts:{weight:105,kbExpr:ua.and(Ox.focus,ua.not("isComposing")),primary:9,secondary:[1033]}})),yu(new O7({id:v9,precondition:void 0,handler:t=>t.toggleCaseSensitive(),kbOpts:{weight:105,kbExpr:Ox.focus,primary:s9.primary,mac:s9.mac,win:s9.win,linux:s9.linux}})),yu(new O7({id:b9,precondition:void 0,handler:t=>t.toggleWholeWords(),kbOpts:{weight:105,kbExpr:Ox.focus,primary:n9.primary,mac:n9.mac,win:n9.win,linux:n9.linux}})),yu(new O7({id:y9,precondition:void 0,handler:t=>t.toggleRegex(),kbOpts:{weight:105,kbExpr:Ox.focus,primary:r9.primary,mac:r9.mac,win:r9.win,linux:r9.linux}})),yu(new O7({id:k9,precondition:void 0,handler:t=>t.toggleSearchScope(),kbOpts:{weight:105,kbExpr:Ox.focus,primary:o9.primary,mac:o9.mac,win:o9.win,linux:o9.linux}})),yu(new O7({id:C9,precondition:void 0,handler:t=>t.togglePreserveCase(),kbOpts:{weight:105,kbExpr:Ox.focus,primary:h9.primary,mac:h9.mac,win:h9.win,linux:h9.linux}})),yu(new O7({id:S9,precondition:t9,handler:t=>t.replace(),kbOpts:{weight:105,kbExpr:Ox.focus,primary:3094}})),yu(new O7({id:S9,precondition:t9,handler:t=>t.replace(),kbOpts:{weight:105,kbExpr:ua.and(Ox.focus,e9),primary:3}})),yu(new O7({id:x9,precondition:t9,handler:t=>t.replaceAll(),kbOpts:{weight:105,kbExpr:Ox.focus,primary:2563}})),yu(new O7({id:x9,precondition:t9,handler:t=>t.replaceAll(),kbOpts:{weight:105,kbExpr:ua.and(Ox.focus,e9),primary:void 0,mac:{primary:2051}}})),yu(new O7({id:D9,precondition:t9,handler:t=>t.selectAllMatches(),kbOpts:{weight:105,kbExpr:Ox.focus,primary:515}}));const I7={0:" ",1:"u",2:"r"},_7=16777215,P7=4278190080;class N7{constructor(t){const i=Math.ceil(t/32);this._states=new Uint32Array(i)}get(t){const i=t/32|0,e=t%32;return!!(this._states[i]&1<<e)}set(t,i){const e=t/32|0,s=t%32,n=this._states[e];this._states[e]=i?n|1<<s:n&~(1<<s)}}class B7{constructor(t,i,e){if(t.length!==i.length||t.length>65535)throw new Error("invalid startIndexes or endIndexes size");this._startIndexes=t,this._endIndexes=i,this._collapseStates=new N7(t.length),this._userDefinedStates=new N7(t.length),this._recoveredStates=new N7(t.length),this._types=e,this._parentsComputed=!1}ensureParentIndices(){if(!this._parentsComputed){this._parentsComputed=!0;const t=[],i=(i,e)=>{const s=t[t.length-1];return this.getStartLineNumber(s)<=i&&this.getEndLineNumber(s)>=e};for(let e=0,s=this._startIndexes.length;e<s;e++){const s=this._startIndexes[e],n=this._endIndexes[e];if(s>_7||n>_7)throw new Error("startLineNumber or endLineNumber must not exceed "+_7);for(;t.length>0&&!i(s,n);)t.pop();const r=t.length>0?t[t.length-1]:-1;t.push(e),this._startIndexes[e]=s+((255&r)<<24),this._endIndexes[e]=n+((65280&r)<<16)}}}get length(){return this._startIndexes.length}getStartLineNumber(t){return this._startIndexes[t]&_7}getEndLineNumber(t){return this._endIndexes[t]&_7}getType(t){return this._types?this._types[t]:void 0}hasTypes(){return!!this._types}isCollapsed(t){return this._collapseStates.get(t)}setCollapsed(t,i){this._collapseStates.set(t,i)}isUserDefined(t){return this._userDefinedStates.get(t)}setUserDefined(t,i){return this._userDefinedStates.set(t,i)}isRecovered(t){return this._recoveredStates.get(t)}setRecovered(t,i){return this._recoveredStates.set(t,i)}getSource(t){return this.isUserDefined(t)?1:this.isRecovered(t)?2:0}setSource(t,i){i===1?(this.setUserDefined(t,!0),this.setRecovered(t,!1)):i===2?(this.setUserDefined(t,!1),this.setRecovered(t,!0)):(this.setUserDefined(t,!1),this.setRecovered(t,!1))}setCollapsedAllOfType(t,i){let e=!1;if(this._types)for(let s=0;s<this._types.length;s++)this._types[s]===t&&(this.setCollapsed(s,i),e=!0);return e}toRegion(t){return new $7(this,t)}getParentIndex(t){this.ensureParentIndices();const i=((this._startIndexes[t]&P7)>>>24)+((this._endIndexes[t]&P7)>>>16);return i===65535?-1:i}contains(t,i){return this.getStartLineNumber(t)<=i&&this.getEndLineNumber(t)>=i}findIndex(t){let i=0,e=this._startIndexes.length;if(e===0)return-1;for(;i<e;){const s=Math.floor((i+e)/2);t<this.getStartLineNumber(s)?e=s:i=s+1}return i-1}findRange(t){let i=this.findIndex(t);if(i>=0){if(this.getEndLineNumber(i)>=t)return i;for(i=this.getParentIndex(i);i!==-1;){if(this.contains(i,t))return i;i=this.getParentIndex(i)}}return-1}toString(){const t=[];for(let i=0;i<this.length;i++)t[i]=`[${I7[this.getSource(i)]}${this.isCollapsed(i)?"+":"-"}] ${this.getStartLineNumber(i)}/${this.getEndLineNumber(i)}`;return t.join(", ")}toFoldRange(t){return{startLineNumber:this._startIndexes[t]&_7,endLineNumber:this._endIndexes[t]&_7,type:this._types?this._types[t]:void 0,isCollapsed:this.isCollapsed(t),source:this.getSource(t)}}static fromFoldRanges(t){const i=t.length,e=new Uint32Array(i),s=new Uint32Array(i);let n=[],r=!1;for(let o=0;o<i;o++){const i=t[o];e[o]=i.startLineNumber,s[o]=i.endLineNumber,n.push(i.type),i.type&&(r=!0)}r||(n=void 0);const o=new B7(e,s,n);for(let e=0;e<i;e++)t[e].isCollapsed&&o.setCollapsed(e,!0),o.setSource(e,t[e].source);return o}static sanitizeAndMerge(t,i,e){e=e??Number.MAX_VALUE;const s=(t,i)=>Array.isArray(t)?e=>e<i?t[e]:void 0:e=>e<i?t.toFoldRange(e):void 0,n=s(t,t.length),r=s(i,i.length);let o=0,h=0,c=n(0),l=r(0);const a=[];let u,d=0;const f=[];for(;c||l;){let t;if(l&&(!c||c.startLineNumber>=l.startLineNumber))c&&c.startLineNumber===l.startLineNumber?(l.source===1?t=l:(t=c,t.isCollapsed=l.isCollapsed&&c.endLineNumber===l.endLineNumber,t.source=0),c=n(++o)):(t=l,l.isCollapsed&&l.source===0&&(t.source=2)),l=r(++h);else{let i=h,e=l;for(;;){if(!e||e.startLineNumber>c.endLineNumber){t=c;break}if(e.source===1&&e.endLineNumber>c.endLineNumber)break;e=r(++i)}c=n(++o)}if(t){for(;u&&u.endLineNumber<t.startLineNumber;)u=a.pop();t.endLineNumber>t.startLineNumber&&t.startLineNumber>d&&t.endLineNumber<=e&&(!u||u.endLineNumber>=t.endLineNumber)&&(f.push(t),d=t.startLineNumber,u&&a.push(u),u=t)}}return f}}class $7{constructor(t,i){this.ranges=t,this.index=i}get startLineNumber(){return this.ranges.getStartLineNumber(this.index)}get endLineNumber(){return this.ranges.getEndLineNumber(this.index)}get regionIndex(){return this.index}get parentIndex(){return this.ranges.getParentIndex(this.index)}get isCollapsed(){return this.ranges.isCollapsed(this.index)}containedBy(t){return t.startLineNumber<=this.startLineNumber&&t.endLineNumber>=this.endLineNumber}containsLine(t){return this.startLineNumber<=t&&t<=this.endLineNumber}}class W7{get regions(){return this._regions}get textModel(){return this._textModel}constructor(t,i){this._updateEventEmitter=new le,this.onDidChange=this._updateEventEmitter.event,this._textModel=t,this._decorationProvider=i,this._regions=new B7(new Uint32Array(0),new Uint32Array(0)),this._editorDecorationIds=[]}toggleCollapseState(t){if(!t.length)return;t=t.sort(((t,i)=>t.regionIndex-i.regionIndex));const i={};this._decorationProvider.changeDecorations((e=>{let s=0,n=-1,r=-1;const o=t=>{for(;s<t;){const t=this._regions.getEndLineNumber(s),i=this._regions.isCollapsed(s);if(t<=n){const n=this.regions.getSource(s)!==0;e.changeDecorationOptions(this._editorDecorationIds[s],this._decorationProvider.getDecorationOption(i,t<=r,n))}i&&t>r&&(r=t),s++}};for(const e of t){const t=e.regionIndex,s=this._editorDecorationIds[t];if(s&&!i[s]){i[s]=!0,o(t);const e=!this._regions.isCollapsed(t);this._regions.setCollapsed(t,e),n=Math.max(n,this._regions.getEndLineNumber(t))}}o(this._regions.length)})),this._updateEventEmitter.fire({model:this,collapseStateChanged:t})}removeManualRanges(t){const i=new Array,e=i=>{for(const e of t)if(!(e.startLineNumber>i.endLineNumber||i.startLineNumber>e.endLineNumber))return!0;return!1};for(let t=0;t<this._regions.length;t++){const s=this._regions.toFoldRange(t);s.source!==0&&e(s)||i.push(s)}this.updatePost(B7.fromFoldRanges(i))}update(t,i=[]){const e=this._currentFoldedOrManualRanges(i),s=B7.sanitizeAndMerge(t,e,this._textModel.getLineCount());this.updatePost(B7.fromFoldRanges(s))}updatePost(t){const i=[];let e=-1;for(let s=0,n=t.length;s<n;s++){const n=t.getStartLineNumber(s),r=t.getEndLineNumber(s),o=t.isCollapsed(s),h=t.getSource(s)!==0,c={startLineNumber:n,startColumn:this._textModel.getLineMaxColumn(n),endLineNumber:r,endColumn:this._textModel.getLineMaxColumn(r)+1};i.push({range:c,options:this._decorationProvider.getDecorationOption(o,r<=e,h)}),o&&r>e&&(e=r)}this._decorationProvider.changeDecorations((t=>this._editorDecorationIds=t.deltaDecorations(this._editorDecorationIds,i))),this._regions=t,this._updateEventEmitter.fire({model:this})}_currentFoldedOrManualRanges(t=[]){const i=(i,e)=>{for(const s of t)if(i<s&&s<=e)return!0;return!1},e=[];for(let t=0,s=this._regions.length;t<s;t++){let s=this.regions.isCollapsed(t);const n=this.regions.getSource(t);if(s||n!==0){const r=this._regions.toFoldRange(t),o=this._textModel.getDecorationRange(this._editorDecorationIds[t]);o&&(s&&i(o.startLineNumber,o.endLineNumber)&&(s=!1),e.push({startLineNumber:o.startLineNumber,endLineNumber:o.endLineNumber,type:r.type,isCollapsed:s,source:n}))}}return e}getMemento(){const t=this._currentFoldedOrManualRanges(),i=[],e=this._textModel.getLineCount();for(let s=0,n=t.length;s<n;s++){const n=t[s];if(n.startLineNumber>=n.endLineNumber||n.startLineNumber<1||n.endLineNumber>e)continue;const r=this._getLinesChecksum(n.startLineNumber+1,n.endLineNumber);i.push({startLineNumber:n.startLineNumber,endLineNumber:n.endLineNumber,isCollapsed:n.isCollapsed,source:n.source,checksum:r})}return i.length>0?i:void 0}applyMemento(t){var i,e;if(!Array.isArray(t))return;const s=[],n=this._textModel.getLineCount();for(const r of t){if(r.startLineNumber>=r.endLineNumber||r.startLineNumber<1||r.endLineNumber>n)continue;const t=this._getLinesChecksum(r.startLineNumber+1,r.endLineNumber);r.checksum&&t!==r.checksum||s.push({startLineNumber:r.startLineNumber,endLineNumber:r.endLineNumber,type:void 0,isCollapsed:(i=r.isCollapsed)===null||i===void 0||i,source:(e=r.source)!==null&&e!==void 0?e:0})}const r=B7.sanitizeAndMerge(this._regions,s,n);this.updatePost(B7.fromFoldRanges(r))}_getLinesChecksum(t,i){return Ph(this._textModel.getLineContent(t)+this._textModel.getLineContent(i))%1e6}dispose(){this._decorationProvider.removeDecorations(this._editorDecorationIds)}getAllRegionsAtLine(t,i){const e=[];if(this._regions){let s=this._regions.findRange(t),n=1;for(;s>=0;){const t=this._regions.toRegion(s);i&&!i(t,n)||e.push(t),n++,s=t.parentIndex}}return e}getRegionAtLine(t){if(this._regions){const i=this._regions.findRange(t);if(i>=0)return this._regions.toRegion(i)}return null}getRegionsInside(t,i){const e=[],s=t?t.regionIndex+1:0,n=t?t.endLineNumber:Number.MAX_VALUE;if(i&&i.length===2){const t=[];for(let r=s,o=this._regions.length;r<o;r++){const s=this._regions.toRegion(r);if(!(this._regions.getStartLineNumber(r)<n))break;for(;t.length>0&&!s.containedBy(t[t.length-1]);)t.pop();t.push(s),i(s,t.length)&&e.push(s)}}else for(let t=s,r=this._regions.length;t<r;t++){const s=this._regions.toRegion(t);if(!(this._regions.getStartLineNumber(t)<n))break;i&&!i(s)||e.push(s)}return e}}function j7(t,i,e){const s=[];for(const n of e){const e=t.getRegionAtLine(n);if(e){const n=!e.isCollapsed;if(s.push(e),i>1){const r=t.getRegionsInside(e,((t,e)=>t.isCollapsed!==n&&e<i));s.push(...r)}}}t.toggleCollapseState(s)}function H7(t,i,e=Number.MAX_VALUE,s){const n=[];if(s&&s.length>0)for(const r of s){const s=t.getRegionAtLine(r);if(s&&(s.isCollapsed!==i&&n.push(s),e>1)){const r=t.getRegionsInside(s,((t,s)=>t.isCollapsed!==i&&s<e));n.push(...r)}}else{const s=t.getRegionsInside(null,((t,s)=>t.isCollapsed!==i&&s<e));n.push(...s)}t.toggleCollapseState(n)}function V7(t,i,e,s){const n=[];for(const r of s){const s=t.getAllRegionsAtLine(r,((t,s)=>t.isCollapsed!==i&&s<=e));n.push(...s)}t.toggleCollapseState(n)}function z7(t,i,e){const s=[];for(const i of e){const e=t.getAllRegionsAtLine(i,void 0);e.length>0&&s.push(e[0])}const n=t.getRegionsInside(null,(t=>s.every((i=>!i.containedBy(t)&&!t.containedBy(i)))&&t.isCollapsed!==i));t.toggleCollapseState(n)}function U7(t,i,e){const s=t.textModel,n=t.regions,r=[];for(let t=n.length-1;t>=0;t--)if(e!==n.isCollapsed(t)){const e=n.getStartLineNumber(t);i.test(s.getLineContent(e))&&r.push(n.toRegion(t))}t.toggleCollapseState(r)}function K7(t,i,e){const s=t.regions,n=[];for(let t=s.length-1;t>=0;t--)e!==s.isCollapsed(t)&&i===s.getType(t)&&n.push(s.toRegion(t));t.toggleCollapseState(n)}class q7{get onDidChange(){return this._updateEventEmitter.event}get hiddenRanges(){return this._hiddenRanges}constructor(t){this._updateEventEmitter=new le,this._hasLineChanges=!1,this._foldingModel=t,this._foldingModelListener=t.onDidChange((t=>this.updateHiddenRanges())),this._hiddenRanges=[],t.regions.length&&this.updateHiddenRanges()}notifyChangeModelContent(t){this._hiddenRanges.length&&!this._hasLineChanges&&(this._hasLineChanges=t.changes.some((t=>t.range.endLineNumber!==t.range.startLineNumber||YE(t.text)[0]!==0)))}updateHiddenRanges(){let t=!1;const i=[];let e=0,s=0,n=Number.MAX_VALUE,r=-1;const o=this._foldingModel.regions;for(;e<o.length;e++){if(!o.isCollapsed(e))continue;const h=o.getStartLineNumber(e)+1,c=o.getEndLineNumber(e);n<=h&&c<=r||(!t&&s<this._hiddenRanges.length&&this._hiddenRanges[s].startLineNumber===h&&this._hiddenRanges[s].endLineNumber===c?(i.push(this._hiddenRanges[s]),s++):(t=!0,i.push(new Cs(h,1,c,1))),n=h,r=c)}(this._hasLineChanges||t||s<this._hiddenRanges.length)&&this.applyHiddenRanges(i)}applyHiddenRanges(t){this._hiddenRanges=t,this._hasLineChanges=!1,this._updateEventEmitter.fire(t)}hasRanges(){return this._hiddenRanges.length>0}isHidden(t){return G7(this._hiddenRanges,t)!==null}adjustSelections(t){let i=!1;const e=this._foldingModel.textModel;let s=null;const n=t=>(s&&function(t,i){return t>=i.startLineNumber&&t<=i.endLineNumber}(t,s)||(s=G7(this._hiddenRanges,t)),s?s.startLineNumber-1:null);for(let s=0,r=t.length;s<r;s++){let r=t[s];const o=n(r.startLineNumber);o&&(r=r.setStartPosition(o,e.getLineMaxColumn(o)),i=!0);const h=n(r.endLineNumber);h&&(r=r.setEndPosition(h,e.getLineMaxColumn(h)),i=!0),t[s]=r}return i}dispose(){this.hiddenRanges.length>0&&(this._hiddenRanges=[],this._updateEventEmitter.fire(this._hiddenRanges)),this._foldingModelListener&&(this._foldingModelListener.dispose(),this._foldingModelListener=null)}}function G7(t,i){const e=Sg(t,(t=>i<t.startLineNumber))-1;return e>=0&&t[e].endLineNumber>=i?t[e]:null}class Z7{constructor(t,i,e){this.editorModel=t,this.languageConfigurationService=i,this.foldingRangesLimit=e,this.id="indent"}dispose(){}compute(t){const i=this.languageConfigurationService.getLanguageConfiguration(this.editorModel.getLanguageId()).foldingRules,e=i&&!!i.offSide,s=i&&i.markers;return Promise.resolve(function(t,i,e,s=Q7){const n=t.getOptions().tabSize,r=new J7(s);let o;e&&(o=new RegExp(`(${e.start.source})|(?:${e.end.source})`));const h=[],c=t.getLineCount()+1;h.push({indent:-1,endAbove:c,line:c});for(let e=t.getLineCount();e>0;e--){const s=t.getLineContent(e),c=CD(s,n);let l,a=h[h.length-1];if(c!==-1){if(o&&(l=s.match(o))){if(!l[1]){h.push({indent:-2,endAbove:e,line:e});continue}{let t=h.length-1;for(;t>0&&h[t].indent!==-2;)t--;if(t>0){h.length=t+1,a=h[t],r.insertFirst(e,a.line,c),a.line=e,a.indent=c,a.endAbove=e;continue}}}if(a.indent>c){do{h.pop(),a=h[h.length-1]}while(a.indent>c);const t=a.endAbove-1;t-e>=1&&r.insertFirst(e,t,c)}a.indent===c?a.endAbove=e:h.push({indent:c,endAbove:e,line:e})}else i&&(a.endAbove=e)}return r.toIndentRanges(t)}(this.editorModel,e,s,this.foldingRangesLimit))}}let J7=class{constructor(t){this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0,this._foldingRangesLimit=t}insertFirst(t,i,e){if(t>_7||i>_7)return;const s=this._length;this._startIndexes[s]=t,this._endIndexes[s]=i,this._length++,e<1e3&&(this._indentOccurrences[e]=(this._indentOccurrences[e]||0)+1)}toIndentRanges(t){const i=this._foldingRangesLimit.limit;if(this._length<=i){this._foldingRangesLimit.update(this._length,!1);const t=new Uint32Array(this._length),i=new Uint32Array(this._length);for(let e=this._length-1,s=0;e>=0;e--,s++)t[s]=this._startIndexes[e],i[s]=this._endIndexes[e];return new B7(t,i)}{this._foldingRangesLimit.update(this._length,i);let e=0,s=this._indentOccurrences.length;for(let t=0;t<this._indentOccurrences.length;t++){const n=this._indentOccurrences[t];if(n){if(n+e>i){s=t;break}e+=n}}const n=t.getOptions().tabSize,r=new Uint32Array(i),o=new Uint32Array(i);for(let h=this._length-1,c=0;h>=0;h--){const l=this._startIndexes[h],a=CD(t.getLineContent(l),n);(a<s||a===s&&e++<i)&&(r[c]=l,o[c]=this._endIndexes[h],c++)}return new B7(r,o)}}};const Q7={limit:5e3,update:()=>{}},Y7=Iw("editor.foldBackground",{light:Nw(wv,.3),dark:Nw(wv,.3),hcDark:null,hcLight:null},tt(0,"Background color behind folded ranges. The color must not be opaque so as not to hide underlying decorations."),!0);Iw("editorGutter.foldingControlForeground",{dark:Uw,light:Uw,hcDark:Uw,hcLight:Uw},tt(0,"Color of the folding control in the editor gutter."));const X7=qU("folding-expanded",As.chevronDown,tt(0,"Icon for expanded ranges in the editor glyph margin.")),t8=qU("folding-collapsed",As.chevronRight,tt(0,"Icon for collapsed ranges in the editor glyph margin.")),i8=qU("folding-manual-collapsed",t8,tt(0,"Icon for manually collapsed ranges in the editor glyph margin.")),e8=qU("folding-manual-expanded",X7,tt(0,"Icon for manually expanded ranges in the editor glyph margin.")),s8={color:MC(Y7),position:1},n8=tt(0,"Click to expand the range."),r8=tt(0,"Click to collapse the range.");class o8{constructor(t){this.editor=t,this.showFoldingControls="mouseover",this.showFoldingHighlights=!0}getDecorationOption(t,i,e){return i?o8.HIDDEN_RANGE_DECORATION:this.showFoldingControls==="never"?t?this.showFoldingHighlights?o8.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION:o8.NO_CONTROLS_COLLAPSED_RANGE_DECORATION:o8.NO_CONTROLS_EXPANDED_RANGE_DECORATION:t?e?this.showFoldingHighlights?o8.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:o8.MANUALLY_COLLAPSED_VISUAL_DECORATION:this.showFoldingHighlights?o8.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:o8.COLLAPSED_VISUAL_DECORATION:this.showFoldingControls==="mouseover"?e?o8.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION:o8.EXPANDED_AUTO_HIDE_VISUAL_DECORATION:e?o8.MANUALLY_EXPANDED_VISUAL_DECORATION:o8.EXPANDED_VISUAL_DECORATION}changeDecorations(t){return this.editor.changeDecorations(t)}removeDecorations(t){this.editor.removeDecorations(t)}}o8.COLLAPSED_VISUAL_DECORATION=xF.register({description:"folding-collapsed-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,linesDecorationsTooltip:n8,firstLineDecorationClassName:Kl.asClassName(t8)}),o8.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=xF.register({description:"folding-collapsed-highlighted-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:s8,isWholeLine:!0,linesDecorationsTooltip:n8,firstLineDecorationClassName:Kl.asClassName(t8)}),o8.MANUALLY_COLLAPSED_VISUAL_DECORATION=xF.register({description:"folding-manually-collapsed-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,linesDecorationsTooltip:n8,firstLineDecorationClassName:Kl.asClassName(i8)}),o8.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=xF.register({description:"folding-manually-collapsed-highlighted-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:s8,isWholeLine:!0,linesDecorationsTooltip:n8,firstLineDecorationClassName:Kl.asClassName(i8)}),o8.NO_CONTROLS_COLLAPSED_RANGE_DECORATION=xF.register({description:"folding-no-controls-range-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,linesDecorationsTooltip:n8}),o8.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION=xF.register({description:"folding-no-controls-range-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:s8,isWholeLine:!0,linesDecorationsTooltip:n8}),o8.EXPANDED_VISUAL_DECORATION=xF.register({description:"folding-expanded-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+Kl.asClassName(X7),linesDecorationsTooltip:r8}),o8.EXPANDED_AUTO_HIDE_VISUAL_DECORATION=xF.register({description:"folding-expanded-auto-hide-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:Kl.asClassName(X7),linesDecorationsTooltip:r8}),o8.MANUALLY_EXPANDED_VISUAL_DECORATION=xF.register({description:"folding-manually-expanded-visual-decoration",stickiness:0,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+Kl.asClassName(e8),linesDecorationsTooltip:r8}),o8.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION=xF.register({description:"folding-manually-expanded-auto-hide-visual-decoration",stickiness:0,isWholeLine:!0,firstLineDecorationClassName:Kl.asClassName(e8),linesDecorationsTooltip:r8}),o8.NO_CONTROLS_EXPANDED_RANGE_DECORATION=xF.register({description:"folding-no-controls-range-decoration",stickiness:0,isWholeLine:!0}),o8.HIDDEN_RANGE_DECORATION=xF.register({description:"folding-hidden-range-decoration",stickiness:1});const h8={};class c8{constructor(t,i,e,s,n){this.editorModel=t,this.providers=i,this.handleFoldingRangesChange=e,this.foldingRangesLimit=s,this.fallbackRangeProvider=n,this.id="syntax",this.disposables=new Ji,n&&this.disposables.add(n);for(const t of i)typeof t.onDidChange=="function"&&this.disposables.add(t.onDidChange(e))}compute(t){return function(t,i,e){let s=null;const n=t.map(((t,n)=>Promise.resolve(t.provideFoldingRanges(i,h8,e)).then((t=>{if(!e.isCancellationRequested&&Array.isArray(t)){Array.isArray(s)||(s=[]);const e=i.getLineCount();for(const i of t)i.start>0&&i.end>i.start&&i.end<=e&&s.push({start:i.start,end:i.end,rank:n,kind:i.kind})}}),_i)));return Promise.all(n).then((t=>s))}(this.providers,this.editorModel,t).then((i=>{var e,s;return i?function(t,i){const e=t.sort(((t,i)=>{let e=t.start-i.start;return e===0&&(e=t.rank-i.rank),e})),s=new l8(i);let n;const r=[];for(const t of e)if(n){if(t.start>n.start)if(t.end<=n.end)r.push(n),n=t,s.add(t.start,t.end,t.kind&&t.kind.value,r.length);else{if(t.start>n.end){do{n=r.pop()}while(n&&t.start>n.end);n&&r.push(n),n=t}s.add(t.start,t.end,t.kind&&t.kind.value,r.length)}}else n=t,s.add(t.start,t.end,t.kind&&t.kind.value,r.length);return s.toIndentRanges()}(i,this.foldingRangesLimit):(s=(e=this.fallbackRangeProvider)===null||e===void 0?void 0:e.compute(t))!==null&&s!==void 0?s:null}))}dispose(){this.disposables.dispose()}}class l8{constructor(t){this._startIndexes=[],this._endIndexes=[],this._nestingLevels=[],this._nestingLevelCounts=[],this._types=[],this._length=0,this._foldingRangesLimit=t}add(t,i,e,s){if(t>_7||i>_7)return;const n=this._length;this._startIndexes[n]=t,this._endIndexes[n]=i,this._nestingLevels[n]=s,this._types[n]=e,this._length++,s<30&&(this._nestingLevelCounts[s]=(this._nestingLevelCounts[s]||0)+1)}toIndentRanges(){const t=this._foldingRangesLimit.limit;if(this._length<=t){this._foldingRangesLimit.update(this._length,!1);const t=new Uint32Array(this._length),i=new Uint32Array(this._length);for(let e=0;e<this._length;e++)t[e]=this._startIndexes[e],i[e]=this._endIndexes[e];return new B7(t,i,this._types)}{this._foldingRangesLimit.update(this._length,t);let i=0,e=this._nestingLevelCounts.length;for(let s=0;s<this._nestingLevelCounts.length;s++){const n=this._nestingLevelCounts[s];if(n){if(n+i>t){e=s;break}i+=n}}const s=new Uint32Array(t),n=new Uint32Array(t),r=[];for(let o=0,h=0;o<this._length;o++){const c=this._nestingLevels[o];(c<e||c===e&&i++<t)&&(s[h]=this._startIndexes[o],n[h]=this._endIndexes[o],r[h]=this._types[o],h++)}return new B7(s,n,r)}}}var a8,u8=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},d8=function(t,i){return function(e,s){i(e,s,t)}};const f8=new Ta("foldingEnabled",!1);let g8=a8=class extends Qi{static get(t){return t.getContribution(a8.ID)}static getFoldingRangeProviders(t,i){var e,s;const n=t.foldingRangeProvider.ordered(i);return(s=(e=a8._foldingRangeSelector)===null||e===void 0?void 0:e.call(a8,n,i))!==null&&s!==void 0?s:n}constructor(t,i,e,s,n,r){super(),this.contextKeyService=i,this.languageConfigurationService=e,this.languageFeaturesService=r,this.localToDispose=this._register(new Ji),this.editor=t,this._foldingLimitReporter=new p8(t);const o=this.editor.getOptions();this._isEnabled=o.get(43),this._useFoldingProviders=o.get(44)!=="indentation",this._unfoldOnClickAfterEndOfLine=o.get(48),this._restoringViewState=!1,this._currentModelHasFoldedImports=!1,this._foldingImportsByDefault=o.get(46),this.updateDebounceInfo=n.for(r.foldingRangeProvider,"Folding",{min:200}),this.foldingModel=null,this.hiddenRangeModel=null,this.rangeProvider=null,this.foldingRegionPromise=null,this.foldingModelPromise=null,this.updateScheduler=null,this.cursorChangedScheduler=null,this.mouseDownInfo=null,this.foldingDecorationProvider=new o8(t),this.foldingDecorationProvider.showFoldingControls=o.get(110),this.foldingDecorationProvider.showFoldingHighlights=o.get(45),this.foldingEnabled=f8.bindTo(this.contextKeyService),this.foldingEnabled.set(this._isEnabled),this._register(this.editor.onDidChangeModel((()=>this.onModelChanged()))),this._register(this.editor.onDidChangeConfiguration((t=>{if(t.hasChanged(43)&&(this._isEnabled=this.editor.getOptions().get(43),this.foldingEnabled.set(this._isEnabled),this.onModelChanged()),t.hasChanged(47)&&this.onModelChanged(),t.hasChanged(110)||t.hasChanged(45)){const t=this.editor.getOptions();this.foldingDecorationProvider.showFoldingControls=t.get(110),this.foldingDecorationProvider.showFoldingHighlights=t.get(45),this.triggerFoldingModelChanged()}t.hasChanged(44)&&(this._useFoldingProviders=this.editor.getOptions().get(44)!=="indentation",this.onFoldingStrategyChanged()),t.hasChanged(48)&&(this._unfoldOnClickAfterEndOfLine=this.editor.getOptions().get(48)),t.hasChanged(46)&&(this._foldingImportsByDefault=this.editor.getOptions().get(46))}))),this.onModelChanged()}saveViewState(){const t=this.editor.getModel();if(!t||!this._isEnabled||t.isTooLargeForTokenization())return{};if(this.foldingModel){const i=this.foldingModel.getMemento(),e=this.rangeProvider?this.rangeProvider.id:void 0;return{collapsedRegions:i,lineCount:t.getLineCount(),provider:e,foldedImports:this._currentModelHasFoldedImports}}}restoreViewState(t){const i=this.editor.getModel();if(i&&this._isEnabled&&!i.isTooLargeForTokenization()&&this.hiddenRangeModel&&t&&(this._currentModelHasFoldedImports=!!t.foldedImports,t.collapsedRegions&&t.collapsedRegions.length>0&&this.foldingModel)){this._restoringViewState=!0;try{this.foldingModel.applyMemento(t.collapsedRegions)}finally{this._restoringViewState=!1}}}onModelChanged(){this.localToDispose.clear();const t=this.editor.getModel();this._isEnabled&&t&&!t.isTooLargeForTokenization()&&(this._currentModelHasFoldedImports=!1,this.foldingModel=new W7(t,this.foldingDecorationProvider),this.localToDispose.add(this.foldingModel),this.hiddenRangeModel=new q7(this.foldingModel),this.localToDispose.add(this.hiddenRangeModel),this.localToDispose.add(this.hiddenRangeModel.onDidChange((t=>this.onHiddenRangesChanges(t)))),this.updateScheduler=new po(this.updateDebounceInfo.get(t)),this.cursorChangedScheduler=new Co((()=>this.revealCursor()),200),this.localToDispose.add(this.cursorChangedScheduler),this.localToDispose.add(this.languageFeaturesService.foldingRangeProvider.onDidChange((()=>this.onFoldingStrategyChanged()))),this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration((()=>this.onFoldingStrategyChanged()))),this.localToDispose.add(this.editor.onDidChangeModelContent((t=>this.onDidChangeModelContent(t)))),this.localToDispose.add(this.editor.onDidChangeCursorPosition((()=>this.onCursorPositionChanged()))),this.localToDispose.add(this.editor.onMouseDown((t=>this.onEditorMouseDown(t)))),this.localToDispose.add(this.editor.onMouseUp((t=>this.onEditorMouseUp(t)))),this.localToDispose.add({dispose:()=>{var t,i;this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),(t=this.updateScheduler)===null||t===void 0||t.cancel(),this.updateScheduler=null,this.foldingModel=null,this.foldingModelPromise=null,this.hiddenRangeModel=null,this.cursorChangedScheduler=null,(i=this.rangeProvider)===null||i===void 0||i.dispose(),this.rangeProvider=null}}),this.triggerFoldingModelChanged())}onFoldingStrategyChanged(){var t;(t=this.rangeProvider)===null||t===void 0||t.dispose(),this.rangeProvider=null,this.triggerFoldingModelChanged()}getRangeProvider(t){if(this.rangeProvider)return this.rangeProvider;const i=new Z7(t,this.languageConfigurationService,this._foldingLimitReporter);if(this.rangeProvider=i,this._useFoldingProviders&&this.foldingModel){const e=a8.getFoldingRangeProviders(this.languageFeaturesService,t);e.length>0&&(this.rangeProvider=new c8(t,e,(()=>this.triggerFoldingModelChanged()),this._foldingLimitReporter,i))}return this.rangeProvider}getFoldingModel(){return this.foldingModelPromise}onDidChangeModelContent(t){var i;(i=this.hiddenRangeModel)===null||i===void 0||i.notifyChangeModelContent(t),this.triggerFoldingModelChanged()}triggerFoldingModelChanged(){this.updateScheduler&&(this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.foldingModelPromise=this.updateScheduler.trigger((()=>{const t=this.foldingModel;if(!t)return null;const i=new se,e=this.getRangeProvider(t.textModel),s=this.foldingRegionPromise=uo((t=>e.compute(t)));return s.then((e=>{if(e&&s===this.foldingRegionPromise){let s;if(this._foldingImportsByDefault&&!this._currentModelHasFoldedImports){const t=e.setCollapsedAllOfType(Vs.Imports.value,!0);t&&(s=xq.capture(this.editor),this._currentModelHasFoldedImports=t)}const n=this.editor.getSelections(),r=n?n.map((t=>t.startLineNumber)):[];t.update(e,r),s==null||s.restore(this.editor);const o=this.updateDebounceInfo.update(t.textModel,i.elapsed());this.updateScheduler&&(this.updateScheduler.defaultDelay=o)}return t}))})).then(void 0,(t=>(Ii(t),null))))}onHiddenRangesChanges(t){if(this.hiddenRangeModel&&t.length&&!this._restoringViewState){const t=this.editor.getSelections();t&&this.hiddenRangeModel.adjustSelections(t)&&this.editor.setSelections(t)}this.editor.setHiddenAreas(t,this)}onCursorPositionChanged(){this.hiddenRangeModel&&this.hiddenRangeModel.hasRanges()&&this.cursorChangedScheduler.schedule()}revealCursor(){const t=this.getFoldingModel();t&&t.then((t=>{if(t){const i=this.editor.getSelections();if(i&&i.length>0){const e=[];for(const s of i){const i=s.selectionStartLineNumber;this.hiddenRangeModel&&this.hiddenRangeModel.isHidden(i)&&e.push(...t.getAllRegionsAtLine(i,(t=>t.isCollapsed&&i>t.startLineNumber)))}e.length&&(t.toggleCollapseState(e),this.reveal(i[0].getPosition()))}}})).then(void 0,Ii)}onEditorMouseDown(t){if(this.mouseDownInfo=null,!this.hiddenRangeModel||!t.target||!t.target.range||!t.event.leftButton&&!t.event.middleButton)return;const i=t.target.range;let e=!1;switch(t.target.type){case 4:{const i=t.target.detail,s=t.target.element.offsetLeft;if(i.offsetX-s<4)return;e=!0;break}case 7:if(this._unfoldOnClickAfterEndOfLine&&this.hiddenRangeModel.hasRanges()&&!t.target.detail.isAfterLines)break;return;case 6:if(this.hiddenRangeModel.hasRanges()){const t=this.editor.getModel();if(t&&i.startColumn===t.getLineMaxColumn(i.startLineNumber))break}return;default:return}this.mouseDownInfo={lineNumber:i.startLineNumber,iconClicked:e}}onEditorMouseUp(t){const i=this.foldingModel;if(!i||!this.mouseDownInfo||!t.target)return;const e=this.mouseDownInfo.lineNumber,s=this.mouseDownInfo.iconClicked,n=t.target.range;if(!n||n.startLineNumber!==e)return;if(s){if(t.target.type!==4)return}else{const t=this.editor.getModel();if(!t||n.startColumn!==t.getLineMaxColumn(e))return}const r=i.getRegionAtLine(e);if(r&&r.startLineNumber===e){const n=r.isCollapsed;if(s||n){let s=[];if(t.event.altKey){const t=t=>!t.containedBy(r)&&!r.containedBy(t),e=i.getRegionsInside(null,t);for(const t of e)t.isCollapsed&&s.push(t);s.length===0&&(s=e)}else{const e=t.event.middleButton||t.event.shiftKey;if(e)for(const t of i.getRegionsInside(r))t.isCollapsed===n&&s.push(t);!n&&e&&s.length!==0||s.push(r)}i.toggleCollapseState(s),this.reveal({lineNumber:e,column:1})}}}reveal(t){this.editor.revealPositionInCenterIfOutsideViewport(t,0)}};g8.ID="editor.contrib.folding",g8=a8=u8([d8(1,Ra),d8(2,cf),d8(3,gR),d8(4,lO),d8(5,$p)],g8);class p8{constructor(t){this.editor=t,this._onDidChange=new le,this._computed=0,this._limited=!1}get limit(){return this.editor.getOptions().get(47)}update(t,i){t===this._computed&&i===this._limited||(this._computed=t,this._limited=i,this._onDidChange.fire())}}class m8 extends mu{runEditorCommand(t,i,e){const s=t.get(cf),n=g8.get(i);if(!n)return;const r=n.getFoldingModel();return r?(this.reportTelemetry(t,i),r.then((t=>{if(t){this.invoke(n,t,i,e,s);const r=i.getSelection();r&&n.reveal(r.getStartPosition())}}))):void 0}getSelectedLines(t){const i=t.getSelections();return i?i.map((t=>t.startLineNumber)):[]}getLineNumbers(t,i){return t&&t.selectionLines?t.selectionLines.map((t=>t+1)):this.getSelectedLines(i)}run(t,i){}}function w8(t){if(!B(t)){if(!O(t))return!1;const i=t;if(!B(i.levels)&&!_(i.levels)||!B(i.direction)&&!R(i.direction)||!(B(i.selectionLines)||Array.isArray(i.selectionLines)&&i.selectionLines.every(_)))return!1}return!0}class v8 extends m8{getFoldingLevel(){return parseInt(this.id.substr(v8.ID_PREFIX.length))}invoke(t,i,e){(function(t,i,e,s){const n=t.getRegionsInside(null,((t,n)=>n===i&&t.isCollapsed!==e&&!s.some((i=>t.containsLine(i)))));t.toggleCollapseState(n)})(i,this.getFoldingLevel(),!0,this.getSelectedLines(e))}}v8.ID_PREFIX="editor.foldLevel",v8.ID=t=>v8.ID_PREFIX+t;Su(g8.ID,g8,0),ku(class extends m8{constructor(){super({id:"editor.unfold",label:tt(0,"Unfold"),alias:"Unfold",precondition:f8,kbOpts:{kbExpr:Ox.editorTextFocus,primary:3166,mac:{primary:2654},weight:100},metadata:{description:"Unfold the content in the editor",args:[{name:"Unfold editor argument",description:`Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t* 'levels': Number of levels to unfold. If not set, defaults to 1.\n\t\t\t\t\t\t* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.\n\t\t\t\t\t\t* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t`,constraint:w8,schema:{type:"object",properties:{levels:{type:"number",default:1},direction:{type:"string",enum:["up","down"],default:"down"},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(t,i,e,s){const n=s&&s.levels||1,r=this.getLineNumbers(s,e);s&&s.direction==="up"?V7(i,!1,n,r):H7(i,!1,n,r)}}),ku(class extends m8{constructor(){super({id:"editor.unfoldRecursively",label:tt(0,"Unfold Recursively"),alias:"Unfold Recursively",precondition:f8,kbOpts:{kbExpr:Ox.editorTextFocus,primary:Fe(2089,2142),weight:100}})}invoke(t,i,e,s){H7(i,!1,Number.MAX_VALUE,this.getSelectedLines(e))}}),ku(class extends m8{constructor(){super({id:"editor.fold",label:tt(0,"Fold"),alias:"Fold",precondition:f8,kbOpts:{kbExpr:Ox.editorTextFocus,primary:3164,mac:{primary:2652},weight:100},metadata:{description:"Fold the content in the editor",args:[{name:"Fold editor argument",description:`Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t\t* 'levels': Number of levels to fold.\n\t\t\t\t\t\t\t* 'direction': If 'up', folds given number of levels up otherwise folds down.\n\t\t\t\t\t\t\t* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t\tIf no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.\n\t\t\t\t\t\t`,constraint:w8,schema:{type:"object",properties:{levels:{type:"number"},direction:{type:"string",enum:["up","down"]},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(t,i,e,s){const n=this.getLineNumbers(s,e),r=s&&s.levels,o=s&&s.direction;typeof r!="number"&&typeof o!="string"?function(t,i,e){const s=[];for(const n of e){const e=t.getAllRegionsAtLine(n,(t=>t.isCollapsed!==i));e.length>0&&s.push(e[0])}t.toggleCollapseState(s)}(i,!0,n):o==="up"?V7(i,!0,r||1,n):H7(i,!0,r||1,n)}}),ku(class extends m8{constructor(){super({id:"editor.foldRecursively",label:tt(0,"Fold Recursively"),alias:"Fold Recursively",precondition:f8,kbOpts:{kbExpr:Ox.editorTextFocus,primary:Fe(2089,2140),weight:100}})}invoke(t,i,e){const s=this.getSelectedLines(e);H7(i,!0,Number.MAX_VALUE,s)}}),ku(class extends m8{constructor(){super({id:"editor.foldAll",label:tt(0,"Fold All"),alias:"Fold All",precondition:f8,kbOpts:{kbExpr:Ox.editorTextFocus,primary:Fe(2089,2069),weight:100}})}invoke(t,i,e){H7(i,!0)}}),ku(class extends m8{constructor(){super({id:"editor.unfoldAll",label:tt(0,"Unfold All"),alias:"Unfold All",precondition:f8,kbOpts:{kbExpr:Ox.editorTextFocus,primary:Fe(2089,2088),weight:100}})}invoke(t,i,e){H7(i,!1)}}),ku(class extends m8{constructor(){super({id:"editor.foldAllBlockComments",label:tt(0,"Fold All Block Comments"),alias:"Fold All Block Comments",precondition:f8,kbOpts:{kbExpr:Ox.editorTextFocus,primary:Fe(2089,2138),weight:100}})}invoke(t,i,e,s,n){if(i.regions.hasTypes())K7(i,Vs.Comment.value,!0);else{const t=e.getModel();if(!t)return;const s=n.getLanguageConfiguration(t.getLanguageId()).comments;s&&s.blockCommentStartToken&&U7(i,new RegExp("^\\s*"+Gn(s.blockCommentStartToken)),!0)}}}),ku(class extends m8{constructor(){super({id:"editor.foldAllMarkerRegions",label:tt(0,"Fold All Regions"),alias:"Fold All Regions",precondition:f8,kbOpts:{kbExpr:Ox.editorTextFocus,primary:Fe(2089,2077),weight:100}})}invoke(t,i,e,s,n){if(i.regions.hasTypes())K7(i,Vs.Region.value,!0);else{const t=e.getModel();if(!t)return;const s=n.getLanguageConfiguration(t.getLanguageId()).foldingRules;s&&s.markers&&s.markers.start&&U7(i,new RegExp(s.markers.start),!0)}}}),ku(class extends m8{constructor(){super({id:"editor.unfoldAllMarkerRegions",label:tt(0,"Unfold All Regions"),alias:"Unfold All Regions",precondition:f8,kbOpts:{kbExpr:Ox.editorTextFocus,primary:Fe(2089,2078),weight:100}})}invoke(t,i,e,s,n){if(i.regions.hasTypes())K7(i,Vs.Region.value,!1);else{const t=e.getModel();if(!t)return;const s=n.getLanguageConfiguration(t.getLanguageId()).foldingRules;s&&s.markers&&s.markers.start&&U7(i,new RegExp(s.markers.start),!1)}}}),ku(class extends m8{constructor(){super({id:"editor.foldAllExcept",label:tt(0,"Fold All Except Selected"),alias:"Fold All Except Selected",precondition:f8,kbOpts:{kbExpr:Ox.editorTextFocus,primary:Fe(2089,2136),weight:100}})}invoke(t,i,e){z7(i,!0,this.getSelectedLines(e))}}),ku(class extends m8{constructor(){super({id:"editor.unfoldAllExcept",label:tt(0,"Unfold All Except Selected"),alias:"Unfold All Except Selected",precondition:f8,kbOpts:{kbExpr:Ox.editorTextFocus,primary:Fe(2089,2134),weight:100}})}invoke(t,i,e){z7(i,!1,this.getSelectedLines(e))}}),ku(class extends m8{constructor(){super({id:"editor.toggleFold",label:tt(0,"Toggle Fold"),alias:"Toggle Fold",precondition:f8,kbOpts:{kbExpr:Ox.editorTextFocus,primary:Fe(2089,2090),weight:100}})}invoke(t,i,e){j7(i,1,this.getSelectedLines(e))}}),ku(class extends m8{constructor(){super({id:"editor.gotoParentFold",label:tt(0,"Go to Parent Fold"),alias:"Go to Parent Fold",precondition:f8,kbOpts:{kbExpr:Ox.editorTextFocus,weight:100}})}invoke(t,i,e){const s=this.getSelectedLines(e);if(s.length>0){const t=function(t,i){let e=null;const s=i.getRegionAtLine(t);if(s!==null&&(e=s.startLineNumber,t===e)){const t=s.parentIndex;e=t!==-1?i.regions.getStartLineNumber(t):null}return e}(s[0],i);t!==null&&e.setSelection({startLineNumber:t,startColumn:1,endLineNumber:t,endColumn:1})}}}),ku(class extends m8{constructor(){super({id:"editor.gotoPreviousFold",label:tt(0,"Go to Previous Folding Range"),alias:"Go to Previous Folding Range",precondition:f8,kbOpts:{kbExpr:Ox.editorTextFocus,weight:100}})}invoke(t,i,e){const s=this.getSelectedLines(e);if(s.length>0){const t=function(t,i){let e=i.getRegionAtLine(t);if(e!==null&&e.startLineNumber===t){if(t!==e.startLineNumber)return e.startLineNumber;{const t=e.parentIndex;let s=0;for(t!==-1&&(s=i.regions.getStartLineNumber(e.parentIndex));e!==null;){if(!(e.regionIndex>0)||(e=i.regions.toRegion(e.regionIndex-1),e.startLineNumber<=s))return null;if(e.parentIndex===t)return e.startLineNumber}}}else if(i.regions.length>0)for(e=i.regions.toRegion(i.regions.length-1);e!==null;){if(e.startLineNumber<t)return e.startLineNumber;e=e.regionIndex>0?i.regions.toRegion(e.regionIndex-1):null}return null}(s[0],i);t!==null&&e.setSelection({startLineNumber:t,startColumn:1,endLineNumber:t,endColumn:1})}}}),ku(class extends m8{constructor(){super({id:"editor.gotoNextFold",label:tt(0,"Go to Next Folding Range"),alias:"Go to Next Folding Range",precondition:f8,kbOpts:{kbExpr:Ox.editorTextFocus,weight:100}})}invoke(t,i,e){const s=this.getSelectedLines(e);if(s.length>0){const t=function(t,i){let e=i.getRegionAtLine(t);if(e!==null&&e.startLineNumber===t){const t=e.parentIndex;let s=0;if(t!==-1)s=i.regions.getEndLineNumber(e.parentIndex);else{if(i.regions.length===0)return null;s=i.regions.getEndLineNumber(i.regions.length-1)}for(;e!==null;){if(!(e.regionIndex<i.regions.length)||(e=i.regions.toRegion(e.regionIndex+1),e.startLineNumber>=s))return null;if(e.parentIndex===t)return e.startLineNumber}}else if(i.regions.length>0)for(e=i.regions.toRegion(0);e!==null;){if(e.startLineNumber>t)return e.startLineNumber;e=e.regionIndex<i.regions.length?i.regions.toRegion(e.regionIndex+1):null}return null}(s[0],i);t!==null&&e.setSelection({startLineNumber:t,startColumn:1,endLineNumber:t,endColumn:1})}}}),ku(class extends m8{constructor(){super({id:"editor.createFoldingRangeFromSelection",label:tt(0,"Create Folding Range from Selection"),alias:"Create Folding Range from Selection",precondition:f8,kbOpts:{kbExpr:Ox.editorTextFocus,primary:Fe(2089,2135),weight:100}})}invoke(t,i,e){var s;const n=[],r=e.getSelections();if(r){for(const t of r){let i=t.endLineNumber;t.endColumn===1&&--i,i>t.startLineNumber&&(n.push({startLineNumber:t.startLineNumber,endLineNumber:i,type:void 0,isCollapsed:!0,source:1}),e.setSelection({startLineNumber:t.startLineNumber,startColumn:1,endLineNumber:t.startLineNumber,endColumn:1}))}if(n.length>0){n.sort(((t,i)=>t.startLineNumber-i.startLineNumber));const t=B7.sanitizeAndMerge(i.regions,n,(s=e.getModel())===null||s===void 0?void 0:s.getLineCount());i.updatePost(B7.fromFoldRanges(t))}}}}),ku(class extends m8{constructor(){super({id:"editor.removeManualFoldingRanges",label:tt(0,"Remove Manual Folding Ranges"),alias:"Remove Manual Folding Ranges",precondition:f8,kbOpts:{kbExpr:Ox.editorTextFocus,primary:Fe(2089,2137),weight:100}})}invoke(t,i,e){const s=e.getSelections();if(s){const e=[];for(const t of s){const{startLineNumber:i,endLineNumber:s}=t;e.push(s>=i?{startLineNumber:i,endLineNumber:s}:{endLineNumber:s,startLineNumber:i})}i.removeManualRanges(e),t.triggerFoldingModelChanged()}}});for(let t=1;t<=7;t++)b8=new v8({id:v8.ID(t),label:tt(0,"Fold Level {0}",t),alias:`Fold Level ${t}`,precondition:f8,kbOpts:{kbExpr:Ox.editorTextFocus,primary:Fe(2089,2048|21+t),weight:100}}),Du.INSTANCE.registerEditorAction(b8);var b8;Gl.registerCommand("_executeFoldingRangeProvider",(async function(t,...i){const[e]=i;if(!(e instanceof as))throw Wi();const s=t.get($p),n=t.get(Nl).getModel(e);if(!n)throw Wi();const r=t.get(Md);if(!r.getValue("editor.folding",{resource:e}))return[];const o=t.get(cf),h=r.getValue("editor.foldingStrategy",{resource:e}),c={get limit(){return r.getValue("editor.foldingMaximumRegions",{resource:e})},update:(t,i)=>{}},l=new Z7(n,o,c);let a=l;if(h!=="indentation"){const t=g8.getFoldingRangeProviders(s,n);t.length&&(a=new c8(n,t,(()=>{}),c,l))}const u=await a.compute(ve.None),d=[];try{if(u)for(let t=0;t<u.length;t++){const i=u.getType(t);d.push({start:u.getStartLineNumber(t),end:u.getEndLineNumber(t),kind:i?Vs.fromValue(i):void 0})}return d}finally{a.dispose()}}));ku(class extends mu{constructor(){super({id:"editor.action.fontZoomIn",label:tt(0,"Increase Editor Font Size"),alias:"Increase Editor Font Size",precondition:void 0})}run(t,i){Al.setZoomLevel(Al.getZoomLevel()+1)}}),ku(class extends mu{constructor(){super({id:"editor.action.fontZoomOut",label:tt(0,"Decrease Editor Font Size"),alias:"Decrease Editor Font Size",precondition:void 0})}run(t,i){Al.setZoomLevel(Al.getZoomLevel()-1)}}),ku(class extends mu{constructor(){super({id:"editor.action.fontZoomReset",label:tt(0,"Reset Editor Font Size"),alias:"Reset Editor Font Size",precondition:void 0})}run(t,i){Al.setZoomLevel(0)}});var y8=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},k8=function(t,i){return function(e,s){i(e,s,t)}};let C8=class{constructor(t,i,e,s){this._editor=t,this._languageFeaturesService=i,this._workerService=e,this._accessibilitySignalService=s,this._disposables=new Ji,this._sessionDisposables=new Ji,this._disposables.add(i.onTypeFormattingEditProvider.onDidChange(this._update,this)),this._disposables.add(t.onDidChangeModel((()=>this._update()))),this._disposables.add(t.onDidChangeModelLanguage((()=>this._update()))),this._disposables.add(t.onDidChangeConfiguration((t=>{t.hasChanged(56)&&this._update()}))),this._update()}dispose(){this._disposables.dispose(),this._sessionDisposables.dispose()}_update(){if(this._sessionDisposables.clear(),!this._editor.getOption(56)||!this._editor.hasModel())return;const t=this._editor.getModel(),[i]=this._languageFeaturesService.onTypeFormattingEditProvider.ordered(t);if(!i||!i.autoFormatTriggerCharacters)return;const e=new If;for(const t of i.autoFormatTriggerCharacters)e.add(t.charCodeAt(0));this._sessionDisposables.add(this._editor.onDidType((t=>{const i=t.charCodeAt(t.length-1);e.has(i)&&this._trigger(String.fromCharCode(i))})))}_trigger(t){if(!this._editor.hasModel()||this._editor.getSelections().length>1||!this._editor.getSelection().isEmpty())return;const i=this._editor.getModel(),e=this._editor.getPosition(),s=new ye,n=this._editor.onDidChangeModelContent((t=>{if(t.isFlush)return s.cancel(),void n.dispose();for(let i=0,r=t.changes.length;i<r;i++)if(t.changes[i].range.endLineNumber<=e.lineNumber)return s.cancel(),void n.dispose()}));ZQ(this._workerService,this._languageFeaturesService,i,e,t,i.getFormattingOptions(),s.token).then((t=>{s.token.isCancellationRequested||f(t)&&(this._accessibilitySignalService.playSignal(tq.format,{userGesture:!1}),WQ.execute(this._editor,t,!0))})).finally((()=>{n.dispose()}))}};C8.ID="editor.contrib.autoFormat",C8=y8([k8(1,$p),k8(2,JW),k8(3,QK)],C8);let S8=class{constructor(t,i,e){this.editor=t,this._languageFeaturesService=i,this._instantiationService=e,this._callOnDispose=new Ji,this._callOnModel=new Ji,this._callOnDispose.add(t.onDidChangeConfiguration((()=>this._update()))),this._callOnDispose.add(t.onDidChangeModel((()=>this._update()))),this._callOnDispose.add(t.onDidChangeModelLanguage((()=>this._update()))),this._callOnDispose.add(i.documentRangeFormattingEditProvider.onDidChange(this._update,this))}dispose(){this._callOnDispose.dispose(),this._callOnModel.dispose()}_update(){this._callOnModel.clear(),this.editor.getOption(55)&&this.editor.hasModel()&&this._languageFeaturesService.documentRangeFormattingEditProvider.has(this.editor.getModel())&&this._callOnModel.add(this.editor.onDidPaste((({range:t})=>this._trigger(t))))}_trigger(t){this.editor.hasModel()&&(this.editor.getSelections().length>1||this._instantiationService.invokeFunction(UQ,this.editor,t,2,bN.None,ve.None,!1).catch(Ii))}};S8.ID="editor.contrib.formatOnPaste",S8=y8([k8(1,$p),k8(2,Il)],S8);Su(C8.ID,C8,2),Su(S8.ID,S8,2),ku(class extends mu{constructor(){super({id:"editor.action.formatDocument",label:tt(0,"Format Document"),alias:"Format Document",precondition:ua.and(Ox.notInCompositeEditor,Ox.writable,Ox.hasDocumentFormattingProvider),kbOpts:{kbExpr:Ox.editorTextFocus,primary:1572,linux:{primary:3111},weight:100},contextMenuOpts:{group:"1_modification",order:1.3}})}async run(t,i){if(i.hasModel()){const e=t.get(Il);await t.get(yN).showWhile(e.invokeFunction(qQ,i,1,bN.None,ve.None,!0),250)}}}),ku(class extends mu{constructor(){super({id:"editor.action.formatSelection",label:tt(0,"Format Selection"),alias:"Format Selection",precondition:ua.and(Ox.writable,Ox.hasDocumentSelectionFormattingProvider),kbOpts:{kbExpr:Ox.editorTextFocus,primary:Fe(2089,2084),weight:100},contextMenuOpts:{when:Ox.hasNonEmptySelection,group:"1_modification",order:1.31}})}async run(t,i){if(!i.hasModel())return;const e=t.get(Il),s=i.getModel(),n=i.getSelections().map((t=>t.isEmpty()?new Cs(t.startLineNumber,1,t.startLineNumber,s.getLineMaxColumn(t.startLineNumber)):t));await t.get(yN).showWhile(e.invokeFunction(UQ,i,n,1,bN.None,ve.None,!0),250)}}),Gl.registerCommand("editor.action.format",(async t=>{const i=t.get(Pl).getFocusedCodeEditor();if(!i||!i.hasModel())return;const e=t.get(ql);i.getSelection().isEmpty()?await e.executeCommand("editor.action.formatDocument"):await e.executeCommand("editor.action.formatSelection")}));var x8=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},D8=function(t,i){return function(e,s){i(e,s,t)}};class E8{remove(){var t;(t=this.parent)===null||t===void 0||t.children.delete(this.id)}static findId(t,i){let e;typeof t=="string"?e=`${i.id}/${t}`:(e=`${i.id}/${t.name}`,i.children.get(e)!==void 0&&(e=`${i.id}/${t.name}_${t.range.startLineNumber}_${t.range.startColumn}`));let s=e;for(let t=0;i.children.get(s)!==void 0;t++)s=`${e}_${t}`;return s}static empty(t){return t.children.size===0}}class A8 extends E8{constructor(t,i,e){super(),this.id=t,this.parent=i,this.symbol=e,this.children=new Map}}class M8 extends E8{constructor(t,i,e,s){super(),this.id=t,this.parent=i,this.label=e,this.order=s,this.children=new Map}}class L8 extends E8{static create(t,i,e){const s=new ye(e),r=new L8(i.uri),o=t.ordered(i),h=o.map(((t,e)=>{var n;const o=E8.findId(`provider_${e}`,r),h=new M8(o,r,(n=t.displayName)!==null&&n!==void 0?n:"Unknown Outline Provider",e);return Promise.resolve(t.provideDocumentSymbols(i,s.token)).then((t=>{for(const i of t||[])L8._makeOutlineElement(i,h);return h}),(t=>(_i(t),h))).then((t=>{E8.empty(t)?t.remove():r._groups.set(o,t)}))})),c=t.onDidChange((()=>{n(t.ordered(i),o)||s.cancel()}));return Promise.all(h).then((()=>s.token.isCancellationRequested&&!e.isCancellationRequested?L8.create(t,i,e):r._compact())).finally((()=>{s.dispose(),c.dispose(),s.dispose()}))}static _makeOutlineElement(t,i){const e=E8.findId(t,i),s=new A8(e,i,t);if(t.children)for(const i of t.children)L8._makeOutlineElement(i,s);i.children.set(s.id,s)}constructor(t){super(),this.uri=t,this.id="root",this.parent=void 0,this._groups=new Map,this.children=new Map,this.id="root",this.parent=void 0}_compact(){let t=0;for(const[i,e]of this._groups)e.children.size===0?this._groups.delete(i):t+=1;if(t!==1)this.children=this._groups;else{const t=Wt.first(this._groups.values());for(const[,i]of t.children)i.parent=this,this.children.set(i.id,i)}return this}getTopLevelSymbols(){const t=[];for(const i of this.children.values())i instanceof A8?t.push(i.symbol):t.push(...Wt.map(i.children.values(),(t=>t.symbol)));return t.sort(((t,i)=>Cs.compareRangesUsingStarts(t.range,i.range)))}asListOfDocumentSymbols(){const t=this.getTopLevelSymbols(),i=[];return L8._flattenDocumentSymbols(i,t,""),i.sort(((t,i)=>ks.compare(Cs.getStartPosition(t.range),Cs.getStartPosition(i.range))||ks.compare(Cs.getEndPosition(i.range),Cs.getEndPosition(t.range))))}static _flattenDocumentSymbols(t,i,e){for(const s of i)t.push({kind:s.kind,tags:s.tags,name:s.name,detail:s.detail,containerName:s.containerName||e,range:s.range,selectionRange:s.selectionRange,children:void 0}),s.children&&L8._flattenDocumentSymbols(t,s.children,s.name)}}const F8=_l("IOutlineModelService");let T8=class{constructor(t,i,e){this._languageFeaturesService=t,this._disposables=new Ji,this._cache=new Kf(10,.7),this._debounceInformation=i.for(t.documentSymbolProvider,"DocumentSymbols",{min:350}),this._disposables.add(e.onModelRemoved((t=>{this._cache.delete(t.id)})))}dispose(){this._disposables.dispose()}async getOrCreate(t,i){const e=this._languageFeaturesService.documentSymbolProvider,s=e.ordered(t);let r=this._cache.get(t.id);if(!r||r.versionId!==t.getVersionId()||!n(r.provider,s)){const i=new ye;r={versionId:t.getVersionId(),provider:s,promiseCnt:0,source:i,promise:L8.create(e,t,i.token),model:void 0},this._cache.set(t.id,r);const n=Date.now();r.promise.then((i=>{r.model=i,this._debounceInformation.update(t,Date.now()-n)})).catch((i=>{this._cache.delete(t.id)}))}if(r.model)return r.model;r.promiseCnt+=1;const o=i.onCancellationRequested((()=>{--r.promiseCnt==0&&(r.source.cancel(),this._cache.delete(t.id))}));try{return await r.promise}finally{o.dispose()}}};T8=x8([D8(0,$p),D8(1,lO),D8(2,Nl)],T8),Nd(F8,T8,1),Gl.registerCommand("_executeDocumentSymbolProvider",(async function(t,...i){const[e]=i;j(as.isUri(e));const s=t.get(F8),n=t.get(Bl),r=await n.createModelReference(e);try{return(await s.getOrCreate(r.object.textEditorModel,ve.None)).getTopLevelSymbols()}finally{r.dispose()}}));class R8 extends Qi{constructor(t,i){super(),this.contextKeyService=t,this.model=i,this.inlineCompletionVisible=R8.inlineSuggestionVisible.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentation=R8.inlineSuggestionHasIndentation.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentationLessThanTabSize=R8.inlineSuggestionHasIndentationLessThanTabSize.bindTo(this.contextKeyService),this.suppressSuggestions=R8.suppressSuggestions.bindTo(this.contextKeyService),this._register(ZB((t=>{const i=this.model.read(t),e=i==null?void 0:i.state.read(t),s=!!(e!=null&&e.inlineCompletion)&&(e==null?void 0:e.primaryGhostText)!==void 0&&!(e!=null&&e.primaryGhostText.isEmpty());this.inlineCompletionVisible.set(s),e!=null&&e.primaryGhostText&&(e!=null&&e.inlineCompletion)&&this.suppressSuggestions.set(e.inlineCompletion.inlineCompletion.source.inlineCompletions.suppressSuggestions)}))),this._register(ZB((t=>{const i=this.model.read(t);let e=!1,s=!0;const n=i==null?void 0:i.primaryGhostText.read(t);if(i!=null&&i.selectedSuggestItem&&n&&n.parts.length>0){const{column:t,lines:r}=n.parts[0],o=r[0];if(t<=i.textModel.getLineIndentColumn(n.lineNumber)){let t=tr(o);t===-1&&(t=o.length-1),e=t>0;const n=i.textModel.getOptions().tabSize;s=Ck.visibleColumnFromColumn(o,t+1,n)<n}}this.inlineCompletionSuggestsIndentation.set(e),this.inlineCompletionSuggestsIndentationLessThanTabSize.set(s)})))}}R8.inlineSuggestionVisible=new Ta("inlineSuggestionVisible",!1,tt(0,"Whether an inline suggestion is visible")),R8.inlineSuggestionHasIndentation=new Ta("inlineSuggestionHasIndentation",!1,tt(0,"Whether the inline suggestion starts with whitespace")),R8.inlineSuggestionHasIndentationLessThanTabSize=new Ta("inlineSuggestionHasIndentationLessThanTabSize",!0,tt(0,"Whether the inline suggestion starts with whitespace that is less than what would be inserted by tab")),R8.suppressSuggestions=new Ta("inlineSuggestionSuppressSuggestions",void 0,tt(0,"Whether suggestions should be suppressed for the current suggestion"));class O8{constructor(t,i){this.lineNumber=t,this.parts=i}equals(t){return this.lineNumber===t.lineNumber&&this.parts.length===t.parts.length&&this.parts.every(((i,e)=>i.equals(t.parts[e])))}renderForScreenReader(t){if(this.parts.length===0)return"";const i=this.parts[this.parts.length-1],e=t.substr(0,i.column-1);return new fZ([...this.parts.map((t=>new gZ(Cs.fromPositions(new ks(1,t.column)),t.lines.join(`\n`))))]).applyToString(e).substring(this.parts[0].column-1)}isEmpty(){return this.parts.every((t=>t.lines.length===0))}get lineCount(){return 1+this.parts.reduce(((t,i)=>t+i.lines.length-1),0)}}class I8{constructor(t,i,e){this.column=t,this.text=i,this.preview=e,this.lines=Xn(this.text)}equals(t){return this.column===t.column&&this.lines.length===t.lines.length&&this.lines.every(((i,e)=>i===t.lines[e]))}}class _8{constructor(t,i,e,s=0){this.lineNumber=t,this.columnRange=i,this.text=e,this.additionalReservedLineCount=s,this.parts=[new I8(this.columnRange.endColumnExclusive,this.text,!1)],this.newLines=Xn(this.text)}renderForScreenReader(t){return this.newLines.join(`\n`)}get lineCount(){return this.newLines.length}isEmpty(){return this.parts.every((t=>t.lines.length===0))}equals(t){return this.lineNumber===t.lineNumber&&this.columnRange.equals(t.columnRange)&&this.newLines.length===t.newLines.length&&this.newLines.every(((i,e)=>i===t.newLines[e]))&&this.additionalReservedLineCount===t.additionalReservedLineCount}}function P8(t,i){return n(t,i,N8)}function N8(t,i){return t===i||!(!t||!i)&&(t instanceof O8&&i instanceof O8||t instanceof _8&&i instanceof _8)&&t.equals(i)}const B8=[];class $8{constructor(t,i){if(this.startColumn=t,this.endColumnExclusive=i,t>i)throw new zi(`startColumn ${t} cannot be after endColumnExclusive ${i}`)}toRange(t){return new Cs(t,this.startColumn,t,this.endColumnExclusive)}equals(t){return this.startColumn===t.startColumn&&this.endColumnExclusive===t.endColumnExclusive}}function W8(t,i){const e=new Ji,s=t.createDecorationsCollection();return e.add(JB({debugName:()=>`Apply decorations from ${i.debugName}`},(t=>{const e=i.read(t);s.set(e)}))),e.add({dispose:()=>{s.clear()}}),e}function j8(t,i){return new ks(t.lineNumber-i.lineNumber+1,t.lineNumber-i.lineNumber==0?t.column-i.column+1:t.column)}var H8=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},V8=function(t,i){return function(e,s){i(e,s,t)}};const z8="ghost-text";let U8=class extends Qi{constructor(t,i,e){super(),this.editor=t,this.model=i,this.languageService=e,this.isDisposed=$B(this,!1),this.currentTextModel=e$(this.editor.onDidChangeModel,(()=>this.editor.getModel())),this.uiState=zB(this,(t=>{if(this.isDisposed.read(t))return;const i=this.currentTextModel.read(t);if(i!==this.model.targetTextModel.read(t))return;const e=this.model.ghostText.read(t);if(!e)return;const s=e instanceof _8?e.columnRange:void 0,n=[],r=[];function o(t,i){if(r.length>0){const e=r[r.length-1];i&&e.decorations.push(new rm(e.content.length+1,e.content.length+1+t[0].length,i,0)),e.content+=t[0],t=t.slice(1)}for(const e of t)r.push({content:e,decorations:i?[new rm(1,e.length+1,i,0)]:[]})}const h=i.getLineContent(e.lineNumber);let c,l=0;for(const t of e.parts){let i=t.lines;c===void 0?(n.push({column:t.column,text:i[0],preview:t.preview}),i=i.slice(1)):o([h.substring(l,t.column-1)],void 0),i.length>0&&(o(i,z8),c===void 0&&t.column<=h.length&&(c=t.column)),l=t.column-1}c!==void 0&&o([h.substring(l)],void 0);const a=c!==void 0?new $8(c,h.length+1):void 0;return{replacedRange:s,inlineTexts:n,additionalLines:r,hiddenRange:a,lineNumber:e.lineNumber,additionalReservedLineCount:this.model.minReservedLineCount.read(t),targetTextModel:i}})),this.decorations=zB(this,(t=>{const i=this.uiState.read(t);if(!i)return[];const e=[];i.replacedRange&&e.push({range:i.replacedRange.toRange(i.lineNumber),options:{inlineClassName:"inline-completion-text-to-replace",description:"GhostTextReplacement"}}),i.hiddenRange&&e.push({range:i.hiddenRange.toRange(i.lineNumber),options:{inlineClassName:"ghost-text-hidden",description:"ghost-text-hidden"}});for(const t of i.inlineTexts)e.push({range:Cs.fromPositions(new ks(i.lineNumber,t.column)),options:{description:z8,after:{content:t.text,inlineClassName:t.preview?"ghost-text-decoration-preview":"ghost-text-decoration",cursorStops:tg.Left},showIfCollapsed:!0}});return e})),this.additionalLinesWidget=this._register(new K8(this.editor,this.languageService.languageIdCodec,zB((t=>{const i=this.uiState.read(t);return i?{lineNumber:i.lineNumber,additionalLines:i.additionalLines,minReservedLineCount:i.additionalReservedLineCount,targetTextModel:i.targetTextModel}:void 0})))),this._register(Zi((()=>{this.isDisposed.set(!0,void 0)}))),this._register(W8(this.editor,this.decorations))}ownsViewZone(t){return this.additionalLinesWidget.viewZoneId===t}};U8=H8([V8(2,Id)],U8);class K8 extends Qi{get viewZoneId(){return this._viewZoneId}constructor(t,i,e){super(),this.editor=t,this.languageIdCodec=i,this.lines=e,this._viewZoneId=void 0,this.editorOptionsChanged=n$("editorOptionChanged",ne.filter(this.editor.onDidChangeConfiguration,(t=>t.hasChanged(33)||t.hasChanged(117)||t.hasChanged(99)||t.hasChanged(94)||t.hasChanged(51)||t.hasChanged(50)||t.hasChanged(67)))),this._register(ZB((t=>{const i=this.lines.read(t);this.editorOptionsChanged.read(t),i?this.updateLines(i.lineNumber,i.additionalLines,i.minReservedLineCount):this.clear()})))}dispose(){super.dispose(),this.clear()}clear(){this.editor.changeViewZones((t=>{this._viewZoneId&&(t.removeZone(this._viewZoneId),this._viewZoneId=void 0)}))}updateLines(t,i,e){const s=this.editor.getModel();if(!s)return;const{tabSize:n}=s.getOptions();this.editor.changeViewZones((s=>{this._viewZoneId&&(s.removeZone(this._viewZoneId),this._viewZoneId=void 0);const r=Math.max(i.length,e);if(r>0){const e=document.createElement("div");(function(t,i,e,s,n){const r=s.get(33),o=s.get(117),h="none",c=s.get(94),l=s.get(51),a=s.get(50),u=s.get(67),d=new gd(1e4);d.appendString('<div class="suggest-preview-text">');for(let t=0,s=e.length;t<s;t++){const s=e[t],f=s.content;d.appendString('<div class="view-line'),d.appendString('" style="top:'),d.appendString(String(t*u)),d.appendString('px;width:1000000px;">');const g=Dr(f),p=Sr(f),m=sm.createEmpty(f,n);pm(new um(a.isMonospace&&!r,a.canUseHalfwidthRightwardsArrow,f,!1,g,p,0,m,s.decorations,i,0,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,o,h,c,l!==gi.OFF,null),d),d.appendString("</div>")}d.appendString("</div>"),xl(t,a);const f=d.build(),g=q8?q8.createHTML(f):f;t.innerHTML=g})(e,n,i,this.editor.getOptions(),this.languageIdCodec),this._viewZoneId=s.addZone({afterLineNumber:t,heightInLines:r,domNode:e,afterColumnAffinity:1})}}))}}const q8=ju("editorGhostText",{createHTML:t=>t});class G8{constructor(t){this.lines=t,this.tokenization={getLineTokens:t=>this.lines[t-1]}}getLineCount(){return this.lines.length}getLineLength(t){return this.lines[t-1].getLineContent().length}}async function Z8(t,i,e,s,n=ve.None,r){const o=function(t,i){const e=i.getWordAtPosition(t),s=i.getLineMaxColumn(t.lineNumber);return e?new Cs(t.lineNumber,e.startColumn,t.lineNumber,s):Cs.fromPositions(t,t.with(void 0,s))}(i,e),h=t.all(e),c=new Gf;for(const t of h)t.groupId&&c.add(t.groupId,t);function l(t){if(!t.yieldsToGroupIds)return[];const i=[];for(const e of t.yieldsToGroupIds||[]){const t=c.get(e);for(const e of t)i.push(e)}return i}const a=new Map,u=new Set;function d(t,i){if(i=[...i,t],u.has(t))return i;u.add(t);try{const e=l(t);for(const t of e){const e=d(t,i);if(e)return e}}finally{u.delete(t)}}function f(t){const r=a.get(t);if(r)return r;const o=d(t,[]);o&&_i(new Error(`Inline completions: cyclic yield-to dependency detected. Path: ${o.map((t=>t.toString?t.toString():""+t)).join(" -> ")}`));const h=new Ao;return a.set(t,h.p),(async()=>{if(!o){const i=l(t);for(const t of i){const i=await f(t);if(i&&i.items.length>0)return}}try{return await t.provideInlineCompletions(e,i,s,n)}catch(t){return void _i(t)}})().then((t=>h.complete(t)),(t=>h.error(t))),h.p}const g=await Promise.all(h.map((async t=>({provider:t,completions:await f(t)})))),p=new Map,m=[];for(const t of g){const i=t.completions;if(!i)continue;const s=new Q8(i,t.provider);m.push(s);for(const t of i.items){const i=Y8.from(t,s,o,e,r);p.set(i.hash(),i)}}return new J8(Array.from(p.values()),new Set(p.keys()),m)}class J8{constructor(t,i,e){this.completions=t,this.hashs=i,this.providerResults=e}has(t){return this.hashs.has(t.hash())}dispose(){for(const t of this.providerResults)t.removeRef()}}class Q8{constructor(t,i){this.inlineCompletions=t,this.provider=i,this.refCount=1}addRef(){this.refCount++}removeRef(){this.refCount--,this.refCount===0&&this.provider.freeInlineCompletions(this.inlineCompletions)}}class Y8{static from(t,i,e,s,n){let r,o,h=t.range?Cs.lift(t.range):e;if(typeof t.insertText=="string"){if(r=t.insertText,n&&t.completeBracketPairs){r=X8(r,h.getStartPosition(),s,n);const i=r.length-t.insertText.length;i!==0&&(h=new Cs(h.startLineNumber,h.startColumn,h.endLineNumber,h.endColumn+i))}o=void 0}else if("snippet"in t.insertText){const i=t.insertText.snippet.length;if(n&&t.completeBracketPairs){t.insertText.snippet=X8(t.insertText.snippet,h.getStartPosition(),s,n);const e=t.insertText.snippet.length-i;e!==0&&(h=new Cs(h.startLineNumber,h.startColumn,h.endLineNumber,h.endColumn+e))}const e=(new m0).parse(t.insertText.snippet);e.children.length===1&&e.children[0]instanceof h0?(r=e.children[0].value,o=void 0):(r=e.toString(),o={snippet:t.insertText.snippet,range:h})}else $a();return new Y8(r,t.command,h,r,o,t.additionalTextEdits||B8,t,i)}constructor(t,i,e,s,n,r,o,h){this.filterText=t,this.command=i,this.range=e,this.insertText=s,this.snippetInfo=n,this.additionalTextEdits=r,this.sourceInlineCompletion=o,this.source=h,s=(t=t.replace(/\r\n|\r/g,`\n`)).replace(/\r\n|\r/g,`\n`)}withRange(t){return new Y8(this.filterText,this.command,t,this.insertText,this.snippetInfo,this.additionalTextEdits,this.sourceInlineCompletion,this.source)}hash(){return JSON.stringify({insertText:this.insertText,range:this.range.toString()})}}function X8(t,i,e,s){const n=e.getLineContent(i.lineNumber).substring(0,i.column-1)+t,r=e.tokenization.tokenizeLineWithEdit(i,n.length-(i.column-1),t),o=r==null?void 0:r.sliceAndInflate(i.column-1,n.length,0);return o?function(t,i){const e=new SA,s=new jA(e,(t=>i.getLanguageConfiguration(t))),n=GA(new NA(new G8([t]),s),[],void 0,!0);let r="";const o=t.getLineContent();return function t(i,e){if(i.kind===2)if(t(i.openingBracket,e),e=cA(e,i.openingBracket.length),i.child&&(t(i.child,e),e=cA(e,i.child.length)),i.closingBracket)t(i.closingBracket,e),e=cA(e,i.closingBracket.length);else{const t=s.getSingleLanguageBracketTokens(i.openingBracket.languageId).findClosingTokenText(i.openingBracket.bracketIds);r+=t}else if(i.kind!==3){if(i.kind===0||i.kind===1)r+=o.substring(e,cA(e,i.length));else if(i.kind===4)for(const s of i.children)t(s,e),e=cA(e,s.length)}}(n,sA),r}(o,s):t}function ttt(t,i,e){const s=e?t.range.intersectRanges(e):t.range;if(!s)return t;const n=i.getValueInRange(s,1),r=dr(n,t.text),o=eA.ofText(n.substring(0,r)).addToPosition(t.range.getStartPosition()),h=t.text.substring(r),c=Cs.fromPositions(o,t.range.getEndPosition());return new gZ(c,h)}function itt(t,i){return t.text.startsWith(i.text)&&(e=t.range,(s=i.range).getStartPosition().equals(e.getStartPosition())&&s.getEndPosition().isBeforeOrEqual(e.getEndPosition()));var e,s}function ett(t,i,e,s,n=0){let r=ttt(t,i);if(r.range.endLineNumber!==r.range.startLineNumber)return;const o=i.getLineContent(r.range.startLineNumber),h=ir(o).length;if(r.range.startColumn-1<=h){const t=ir(r.text).length,i=o.substring(r.range.startColumn-1,h),[e,s]=[r.range.getStartPosition(),r.range.getEndPosition()],n=e.column+i.length<=s.column?e.delta(0,i.length):s,c=Cs.fromPositions(n,s),l=r.text.startsWith(i)?r.text.substring(i.length):r.text.substring(t);r=new gZ(c,l)}const c=i.getValueInRange(r.range),l=function(t,i){if((stt==null?void 0:stt.originalValue)===t&&(stt==null?void 0:stt.newValue)===i)return stt==null?void 0:stt.changes;{let e=rtt(t,i,!0);if(e){const s=ntt(e);if(s>0){const n=rtt(t,i,!1);n&&ntt(n)<s&&(e=n)}}return stt={originalValue:t,newValue:i,changes:e},e}}(c,r.text);if(!l)return;const a=r.range.startLineNumber,u=new Array;if(e==="prefix"){const t=l.filter((t=>t.originalLength===0));if(t.length>1||t.length===1&&t[0].originalStart!==c.length)return}const d=r.text.length-n;for(const t of l){const i=r.range.startColumn+t.originalStart+t.originalLength;if(e==="subwordSmart"&&s&&s.lineNumber===r.range.startLineNumber&&i<s.column||t.originalLength>0)return;if(t.modifiedLength===0)continue;const n=t.modifiedStart+t.modifiedLength,o=Math.max(t.modifiedStart,Math.min(n,d)),h=r.text.substring(t.modifiedStart,o),c=r.text.substring(o,Math.max(t.modifiedStart,n));h.length>0&&u.push(new I8(i,h,!1)),c.length>0&&u.push(new I8(i,c,!0))}return new O8(a,u)}let stt;function ntt(t){let i=0;for(const e of t)i+=e.originalLength;return i}function rtt(t,i,e){if(t.length>5e3||i.length>5e3)return;function s(t){let i=0;for(let e=0,s=t.length;e<s;e++){const s=t.charCodeAt(e);s>i&&(i=s)}return i}const n=Math.max(s(t),s(i));function r(t){if(t<0)throw new Error("unexpected");return n+t+1}function o(t){let i=0,s=0;const n=new Int32Array(t.length);for(let o=0,h=t.length;o<h;o++)if(e&&t[o]==="("){const t=100*s+i;n[o]=r(2*t),i++}else if(e&&t[o]===")"){i=Math.max(i-1,0);const t=100*s+i;n[o]=r(2*t+1),i===0&&s++}else n[o]=t.charCodeAt(o);return n}const h=o(t),c=o(i);return new Ef({getElements:()=>h},{getElements:()=>c}).ComputeDiff(!1).changes}var ott=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},htt=function(t,i){return function(e,s){i(e,s,t)}};let ctt=class extends Qi{constructor(t,i,e,s,n){super(),this.textModel=t,this.versionId=i,this._debounceValue=e,this.languageFeaturesService=s,this.languageConfigurationService=n,this._updateOperation=this._register(new Yi),this.inlineCompletions=jB("inlineCompletions",void 0),this.suggestWidgetInlineCompletions=jB("suggestWidgetInlineCompletions",void 0),this._register(this.textModel.onDidChangeContent((()=>{this._updateOperation.clear()})))}fetch(t,i,e){var s,n;const r=new ltt(t,i,this.textModel.getVersionId()),o=i.selectedSuggestionInfo?this.suggestWidgetInlineCompletions:this.inlineCompletions;if(!((s=this._updateOperation.value)===null||s===void 0)&&s.request.satisfies(r))return this._updateOperation.value.promise;if(!((n=o.get())===null||n===void 0)&&n.request.satisfies(r))return Promise.resolve(!0);const h=!!this._updateOperation.value;this._updateOperation.clear();const c=new ye,l=(async()=>{var s,n;if((h||i.triggerKind===Os.Automatic)&&await(s=this._debounceValue.get(this.textModel),n=c.token,new Promise((t=>{let i;const e=setTimeout((()=>{i&&i.dispose(),t()}),s);n&&(i=n.onCancellationRequested((()=>{clearTimeout(e),i&&i.dispose(),t()})))}))),c.token.isCancellationRequested||this.textModel.getVersionId()!==r.versionId)return!1;const l=new Date,a=await Z8(this.languageFeaturesService.inlineCompletionsProvider,t,this.textModel,i,c.token,this.languageConfigurationService);if(c.token.isCancellationRequested||this.textModel.getVersionId()!==r.versionId)return!1;const u=new Date;this._debounceValue.update(this.textModel,u.getTime()-l.getTime());const d=new utt(a,r,this.textModel,this.versionId);if(e){const i=e.toInlineCompletion(void 0);e.canBeReused(this.textModel,t)&&!a.has(i)&&d.prepend(e.inlineCompletion,i.range,!0)}return this._updateOperation.clear(),_B((t=>{o.set(d,t)})),!0})(),a=new att(r,c,l);return this._updateOperation.value=a,l}clear(t){this._updateOperation.clear(),this.inlineCompletions.set(void 0,t),this.suggestWidgetInlineCompletions.set(void 0,t)}clearSuggestWidgetInlineCompletions(t){var i;!((i=this._updateOperation.value)===null||i===void 0)&&i.request.context.selectedSuggestionInfo&&this._updateOperation.clear(),this.suggestWidgetInlineCompletions.set(void 0,t)}cancelUpdate(){this._updateOperation.clear()}};ctt=ott([htt(3,$p),htt(4,cf)],ctt);class ltt{constructor(t,i,e){this.position=t,this.context=i,this.versionId=e}satisfies(t){return this.position.equals(t.position)&&function(t,i,e){return!t||!i?t===i:e(t,i)}(this.context.selectedSuggestionInfo,t.context.selectedSuggestionInfo,((t,i)=>t.equals(i)))&&(t.context.triggerKind===Os.Automatic||this.context.triggerKind===Os.Explicit)&&this.versionId===t.versionId}}class att{constructor(t,i,e){this.request=t,this.cancellationTokenSource=i,this.promise=e}dispose(){this.cancellationTokenSource.cancel()}}class utt{get inlineCompletions(){return this._inlineCompletions}constructor(t,i,e,s){this.inlineCompletionProviderResult=t,this.request=i,this.textModel=e,this.versionId=s,this._refCount=1,this._prependedInlineCompletionItems=[],this._rangeVersionIdValue=0,this._rangeVersionId=zB(this,(t=>{this.versionId.read(t);let i=!1;for(const t of this._inlineCompletions)i=i||t._updateRange(this.textModel);return i&&this._rangeVersionIdValue++,this._rangeVersionIdValue}));const n=e.deltaDecorations([],t.completions.map((t=>({range:t.range,options:{description:"inline-completion-tracking-range"}}))));this._inlineCompletions=t.completions.map(((t,i)=>new dtt(t,n[i],this._rangeVersionId)))}clone(){return this._refCount++,this}dispose(){if(this._refCount--,this._refCount===0){setTimeout((()=>{this.textModel.isDisposed()||this.textModel.deltaDecorations(this._inlineCompletions.map((t=>t.decorationId)),[])}),0),this.inlineCompletionProviderResult.dispose();for(const t of this._prependedInlineCompletionItems)t.source.removeRef()}}prepend(t,i,e){e&&t.source.addRef();const s=this.textModel.deltaDecorations([],[{range:i,options:{description:"inline-completion-tracking-range"}}])[0];this._inlineCompletions.unshift(new dtt(t,s,this._rangeVersionId,i)),this._prependedInlineCompletionItems.push(t)}}class dtt{get forwardStable(){var t;return(t=this.inlineCompletion.source.inlineCompletions.enableForwardStability)!==null&&t!==void 0&&t}constructor(t,i,e,s){this.inlineCompletion=t,this.decorationId=i,this.rangeVersion=e,this.semanticId=JSON.stringify([this.inlineCompletion.filterText,this.inlineCompletion.insertText,this.inlineCompletion.range.getStartPosition().toString()]),this._isValid=!0,this._updatedRange=s??t.range}toInlineCompletion(t){return this.inlineCompletion.withRange(this._getUpdatedRange(t))}toSingleTextEdit(t){return new gZ(this._getUpdatedRange(t),this.inlineCompletion.insertText)}isVisible(t,i,e){const s=ttt(this._toFilterTextReplacement(e),t);if(!this._isValid||!this.inlineCompletion.range.getStartPosition().equals(this._getUpdatedRange(e).getStartPosition())||i.lineNumber!==s.range.startLineNumber)return!1;const n=t.getValueInRange(s.range,1),r=s.text,o=Math.max(0,i.column-s.range.startColumn);let h=r.substring(0,o),c=r.substring(o),l=n.substring(0,o),a=n.substring(o);const u=t.getLineIndentColumn(s.range.startLineNumber);return s.range.startColumn<=u&&(l=l.trimStart(),l.length===0&&(a=a.trimStart()),h=h.trimStart(),h.length===0&&(c=c.trimStart())),h.startsWith(l)&&!!OI(a,c)}canBeReused(t,i){return this._isValid&&this._getUpdatedRange(void 0).containsPosition(i)&&this.isVisible(t,i,void 0)&&!this._isSmallerThanOriginal(void 0)}_toFilterTextReplacement(t){return new gZ(this._getUpdatedRange(t),this.inlineCompletion.filterText)}_isSmallerThanOriginal(t){return ftt(this._getUpdatedRange(t)).isBefore(ftt(this.inlineCompletion.range))}_getUpdatedRange(t){return this.rangeVersion.read(t),this._updatedRange}_updateRange(t){const i=t.getDecorationRange(this.decorationId);return i?!this._updatedRange.equalsRange(i)&&(this._updatedRange=i,!0):(this._isValid=!1,!0)}}function ftt(t){return t.startLineNumber===t.endLineNumber?new ks(1,1+t.endColumn-t.startColumn):new ks(1+t.endLineNumber-t.startLineNumber,t.endColumn)}const gtt={Visible:N9,HasFocusedSuggestion:new Ta("suggestWidgetHasFocusedSuggestion",!1,tt(0,"Whether any suggestion is focused")),DetailsVisible:new Ta("suggestWidgetDetailsVisible",!1,tt(0,"Whether suggestion details are visible")),MultipleSuggestions:new Ta("suggestWidgetMultipleSuggestions",!1,tt(0,"Whether there are multiple suggestions to pick from")),MakesTextEdit:new Ta("suggestionMakesTextEdit",!0,tt(0,"Whether inserting the current suggestion yields in a change or has everything already been typed")),AcceptSuggestionsOnEnter:new Ta("acceptSuggestionOnEnter",!0,tt(0,"Whether suggestions are inserted when pressing Enter")),HasInsertAndReplaceRange:new Ta("suggestionHasInsertAndReplaceRange",!1,tt(0,"Whether the current suggestion has insert and replace behaviour")),InsertMode:new Ta("suggestionInsertMode",void 0,{type:"string",description:tt(0,"Whether the default behaviour is to insert or replace")}),CanResolve:new Ta("suggestionCanResolve",!1,tt(0,"Whether the current suggestion supports to resolve further details"))},ptt=new Qa("suggestWidgetStatusBar");class mtt{constructor(t,i,e,s){var n;this.position=t,this.completion=i,this.container=e,this.provider=s,this.isInvalid=!1,this.score=p_.Default,this.distance=0,this.textLabel=typeof i.label=="string"?i.label:(n=i.label)===null||n===void 0?void 0:n.label,this.labelLow=this.textLabel.toLowerCase(),this.isInvalid=!this.textLabel,this.sortTextLow=i.sortText&&i.sortText.toLowerCase(),this.filterTextLow=i.filterText&&i.filterText.toLowerCase(),this.extensionId=i.extensionId,Cs.isIRange(i.range)?(this.editStart=new ks(i.range.startLineNumber,i.range.startColumn),this.editInsertEnd=new ks(i.range.endLineNumber,i.range.endColumn),this.editReplaceEnd=new ks(i.range.endLineNumber,i.range.endColumn),this.isInvalid=this.isInvalid||Cs.spansMultipleLines(i.range)||i.range.startLineNumber!==t.lineNumber):(this.editStart=new ks(i.range.insert.startLineNumber,i.range.insert.startColumn),this.editInsertEnd=new ks(i.range.insert.endLineNumber,i.range.insert.endColumn),this.editReplaceEnd=new ks(i.range.replace.endLineNumber,i.range.replace.endColumn),this.isInvalid=this.isInvalid||Cs.spansMultipleLines(i.range.insert)||Cs.spansMultipleLines(i.range.replace)||i.range.insert.startLineNumber!==t.lineNumber||i.range.replace.startLineNumber!==t.lineNumber||i.range.insert.startColumn!==i.range.replace.startColumn),typeof s.resolveCompletionItem!="function"&&(this._resolveCache=Promise.resolve(),this._resolveDuration=0)}get isResolved(){return this._resolveDuration!==void 0}get resolveDuration(){return this._resolveDuration!==void 0?this._resolveDuration:-1}async resolve(t){if(!this._resolveCache){const i=t.onCancellationRequested((()=>{this._resolveCache=void 0,this._resolveDuration=void 0})),e=new se(!0);this._resolveCache=Promise.resolve(this.provider.resolveCompletionItem(this.completion,t)).then((t=>{Object.assign(this.completion,t),this._resolveDuration=e.elapsed()}),(t=>{Bi(t)&&(this._resolveCache=void 0,this._resolveDuration=void 0)})).finally((()=>{i.dispose()}))}return this._resolveCache}}class wtt{constructor(t=2,i=new Set,e=new Set,s=new Map,n=!0){this.snippetSortOrder=t,this.kindFilter=i,this.providerFilter=e,this.providerItemsToReuse=s,this.showDeprecated=n}}wtt.default=new wtt;class vtt{constructor(t,i,e,s){this.items=t,this.needsClipboard=i,this.durations=e,this.disposable=s}}async function btt(t,i,e,s=wtt.default,n={triggerKind:0},r=ve.None){const o=new se;e=e.clone();const h=i.getWordAtPosition(e),c=h?new Cs(e.lineNumber,h.startColumn,e.lineNumber,h.endColumn):Cs.fromPositions(e),l={replace:c,insert:c.setEndPosition(e.lineNumber,e.column)},a=[],u=new Ji,d=[];let f=!1;const g=(t,i,n)=>{var r,o,h;let c=!1;if(!i)return c;for(const n of i.suggestions)if(!s.kindFilter.has(n.kind)){if(!s.showDeprecated&&(!((r=n==null?void 0:n.tags)===null||r===void 0)&&r.includes(1)))continue;n.range||(n.range=l),n.sortText||(n.sortText=typeof n.label=="string"?n.label:n.label.label),!f&&n.insertTextRules&&4&n.insertTextRules&&(f=m0.guessNeedsClipboard(n.insertText)),a.push(new mtt(e,n,i,t)),c=!0}return Ki(i)&&u.add(i),d.push({providerName:(o=t._debugDisplayName)!==null&&o!==void 0?o:"unknown_provider",elapsedProvider:(h=i.duration)!==null&&h!==void 0?h:-1,elapsedOverall:n.elapsed()}),c},p=(async()=>{})();for(const o of t.orderedGroups(i)){let t=!1;if(await Promise.all(o.map((async o=>{if(s.providerItemsToReuse.has(o)){const i=s.providerItemsToReuse.get(o);return i.forEach((t=>a.push(t))),void(t=t||i.length>0)}if(!(s.providerFilter.size>0)||s.providerFilter.has(o))try{const s=new se,h=await o.provideCompletionItems(i,e,n,r);t=g(o,h,s)||t}catch(t){_i(t)}}))),t||r.isCancellationRequested)break}return await p,r.isCancellationRequested?(u.dispose(),Promise.reject(new $i)):new vtt(a.sort((m=s.snippetSortOrder,ktt.get(m))),f,{entries:d,elapsed:o.elapsed()},u);var m}function ytt(t,i){if(t.sortTextLow&&i.sortTextLow){if(t.sortTextLow<i.sortTextLow)return-1;if(t.sortTextLow>i.sortTextLow)return 1}return t.textLabel<i.textLabel?-1:t.textLabel>i.textLabel?1:t.completion.kind-i.completion.kind}const ktt=new Map;ktt.set(0,(function(t,i){if(t.completion.kind!==i.completion.kind){if(t.completion.kind===27)return-1;if(i.completion.kind===27)return 1}return ytt(t,i)})),ktt.set(2,(function(t,i){if(t.completion.kind!==i.completion.kind){if(t.completion.kind===27)return 1;if(i.completion.kind===27)return-1}return ytt(t,i)})),ktt.set(1,ytt),Gl.registerCommand("_executeCompletionItemProvider",(async(t,...i)=>{const[e,s,n,r]=i;j(as.isUri(e)),j(ks.isIPosition(s)),j(typeof n=="string"||!n),j(typeof r=="number"||!r);const{completionProvider:o}=t.get($p),h=await t.get(Bl).createModelReference(e);try{const t={incomplete:!1,suggestions:[]},i=[],e=h.object.textEditorModel.validatePosition(s),c=await btt(o,h.object.textEditorModel,e,void 0,{triggerCharacter:n??void 0,triggerKind:n?1:0});for(const e of c.items)i.length<(r??0)&&i.push(e.resolve(ve.None)),t.incomplete=t.incomplete||e.container.incomplete,t.suggestions.push(e.completion);try{return await Promise.all(i),t}finally{setTimeout((()=>c.disposable.dispose()),100)}}finally{h.dispose()}}));class Ctt{static isAllOff(t){return t.other==="off"&&t.comments==="off"&&t.strings==="off"}static isAllOn(t){return t.other==="on"&&t.comments==="on"&&t.strings==="on"}static valueFor(t,i){switch(i){case 1:return t.comments;case 2:return t.strings;default:return t.other}}}function Stt(t,i=vt){return function(t,i=vt){return!!i&&vM(t.charCodeAt(0))&&t.charCodeAt(1)===58}(t,i)?t.charAt(0).toUpperCase()+t.slice(1):t}var xtt=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Dtt=function(t,i){return function(e,s){i(e,s,t)}};class Ett{constructor(t){this._delegates=t}resolve(t){for(const i of this._delegates){const e=i.resolve(t);if(e!==void 0)return e}}}class Att{constructor(t,i,e,s){this._model=t,this._selection=i,this._selectionIdx=e,this._overtypingCapturer=s}resolve(t){const{name:i}=t;if(i==="SELECTION"||i==="TM_SELECTED_TEXT"){let i=this._model.getValueInRange(this._selection)||void 0,e=this._selection.startLineNumber!==this._selection.endLineNumber;if(!i&&this._overtypingCapturer){const t=this._overtypingCapturer.getLastOvertypedInfo(this._selectionIdx);t&&(i=t.value,e=t.multiline)}if(i&&e&&t.snippet){const e=ir(this._model.getLineContent(this._selection.startLineNumber),0,this._selection.startColumn-1);let s=e;t.snippet.walk((i=>i!==t&&(i instanceof h0&&(s=ir(Xn(i.value).pop())),!0)));const n=dr(s,e);i=i.replace(/(\r\n|\r|\n)(.*)/g,((t,i,e)=>`${i}${s.substr(n)}${e}`))}return i}if(i==="TM_CURRENT_LINE")return this._model.getLineContent(this._selection.positionLineNumber);if(i==="TM_CURRENT_WORD"){const t=this._model.getWordAtPosition({lineNumber:this._selection.positionLineNumber,column:this._selection.positionColumn});return t&&t.word||void 0}return i==="TM_LINE_INDEX"?String(this._selection.positionLineNumber-1):i==="TM_LINE_NUMBER"?String(this._selection.positionLineNumber):i==="CURSOR_INDEX"?String(this._selectionIdx):i==="CURSOR_NUMBER"?String(this._selectionIdx+1):void 0}}class Mtt{constructor(t,i){this._labelService=t,this._model=i}resolve(t){const{name:i}=t;if(i==="TM_FILENAME")return is(this._model.uri.fsPath);if(i==="TM_FILENAME_BASE"){const t=is(this._model.uri.fsPath),i=t.lastIndexOf(".");return i<=0?t:t.slice(0,i)}return i==="TM_DIRECTORY"?ts(this._model.uri.fsPath)==="."?"":this._labelService.getUriLabel(DM(this._model.uri)):i==="TM_FILEPATH"?this._labelService.getUriLabel(this._model.uri):i==="RELATIVE_FILEPATH"?this._labelService.getUriLabel(this._model.uri,{relative:!0,noPrefix:!0}):void 0}}class Ltt{constructor(t,i,e,s){this._readClipboardText=t,this._selectionIdx=i,this._selectionCount=e,this._spread=s}resolve(t){if(t.name!=="CLIPBOARD")return;const i=this._readClipboardText();if(i){if(this._spread){const t=i.split(/\r\n|\n|\r/).filter((t=>!zn(t)));if(t.length===this._selectionCount)return t[this._selectionIdx]}return i}}}let Ftt=class{constructor(t,i,e){this._model=t,this._selection=i,this._languageConfigurationService=e}resolve(t){const{name:i}=t,e=this._model.getLanguageIdAtPosition(this._selection.selectionStartLineNumber,this._selection.selectionStartColumn),s=this._languageConfigurationService.getLanguageConfiguration(e).comments;if(s)return i==="LINE_COMMENT"?s.lineCommentToken||void 0:i==="BLOCK_COMMENT_START"?s.blockCommentStartToken||void 0:i==="BLOCK_COMMENT_END"&&s.blockCommentEndToken||void 0}};Ftt=xtt([Dtt(2,cf)],Ftt);class Ttt{constructor(){this._date=new Date}resolve(t){const{name:i}=t;if(i==="CURRENT_YEAR")return String(this._date.getFullYear());if(i==="CURRENT_YEAR_SHORT")return String(this._date.getFullYear()).slice(-2);if(i==="CURRENT_MONTH")return String(this._date.getMonth().valueOf()+1).padStart(2,"0");if(i==="CURRENT_DATE")return String(this._date.getDate().valueOf()).padStart(2,"0");if(i==="CURRENT_HOUR")return String(this._date.getHours().valueOf()).padStart(2,"0");if(i==="CURRENT_MINUTE")return String(this._date.getMinutes().valueOf()).padStart(2,"0");if(i==="CURRENT_SECOND")return String(this._date.getSeconds().valueOf()).padStart(2,"0");if(i==="CURRENT_DAY_NAME")return Ttt.dayNames[this._date.getDay()];if(i==="CURRENT_DAY_NAME_SHORT")return Ttt.dayNamesShort[this._date.getDay()];if(i==="CURRENT_MONTH_NAME")return Ttt.monthNames[this._date.getMonth()];if(i==="CURRENT_MONTH_NAME_SHORT")return Ttt.monthNamesShort[this._date.getMonth()];if(i==="CURRENT_SECONDS_UNIX")return String(Math.floor(this._date.getTime()/1e3));if(i==="CURRENT_TIMEZONE_OFFSET"){const t=this._date.getTimezoneOffset(),i=t>0?"-":"+",e=Math.trunc(Math.abs(t/60)),s=e<10?"0"+e:e,n=Math.abs(t)-60*e;return i+s+":"+(n<10?"0"+n:n)}}}Ttt.dayNames=[tt(0,"Sunday"),tt(0,"Monday"),tt(0,"Tuesday"),tt(0,"Wednesday"),tt(0,"Thursday"),tt(0,"Friday"),tt(0,"Saturday")],Ttt.dayNamesShort=[tt(0,"Sun"),tt(0,"Mon"),tt(0,"Tue"),tt(0,"Wed"),tt(0,"Thu"),tt(0,"Fri"),tt(0,"Sat")],Ttt.monthNames=[tt(0,"January"),tt(0,"February"),tt(0,"March"),tt(0,"April"),tt(0,"May"),tt(0,"June"),tt(0,"July"),tt(0,"August"),tt(0,"September"),tt(0,"October"),tt(0,"November"),tt(0,"December")],Ttt.monthNamesShort=[tt(0,"Jan"),tt(0,"Feb"),tt(0,"Mar"),tt(0,"Apr"),tt(0,"May"),tt(0,"Jun"),tt(0,"Jul"),tt(0,"Aug"),tt(0,"Sep"),tt(0,"Oct"),tt(0,"Nov"),tt(0,"Dec")];class Rtt{constructor(t){this._workspaceService=t}resolve(t){if(!this._workspaceService)return;const i=function(t,i){if(typeof t=="string"||t===void 0)return typeof t=="string"?{id:is(t)}:FN;const e=t;return e.configuration?{id:e.id,configPath:e.configuration}:e.folders.length===1?{id:e.id,uri:e.folders[0].uri}:{id:e.id}}(this._workspaceService.getWorkspace());return LN(i)?void 0:t.name==="WORKSPACE_NAME"?this._resolveWorkspaceName(i):t.name==="WORKSPACE_FOLDER"?this._resoveWorkspacePath(i):void 0}_resolveWorkspaceName(t){if(MN(t))return is(t.uri.path);let i=is(t.configPath.path);return i.endsWith(RN)&&(i=i.substr(0,i.length-14-1)),i}_resoveWorkspacePath(t){if(MN(t))return Stt(t.uri.fsPath);const i=is(t.configPath.path);let e=t.configPath.fsPath;return e.endsWith(i)&&(e=e.substr(0,e.length-i.length-1)),e?Stt(e):"/"}}class Ott{resolve(t){const{name:i}=t;return i==="RANDOM"?Math.random().toString().slice(-6):i==="RANDOM_HEX"?Math.random().toString(16).slice(-6):i==="UUID"?IX():void 0}}var Itt,_tt=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Ptt=function(t,i){return function(e,s){i(e,s,t)}};class Ntt{constructor(t,i,e){this._editor=t,this._snippet=i,this._snippetLineLeadingWhitespace=e,this._offset=-1,this._nestingLevel=1,this._placeholderGroups=h(i.placeholders,l0.compareByIndex),this._placeholderGroupsIdx=-1}initialize(t){this._offset=t.newPosition}dispose(){this._placeholderDecorations&&this._editor.removeDecorations([...this._placeholderDecorations.values()]),this._placeholderGroups.length=0}_initDecorations(){if(this._offset===-1)throw new Error("Snippet not initialized!");if(this._placeholderDecorations)return;this._placeholderDecorations=new Map;const t=this._editor.getModel();this._editor.changeDecorations((i=>{for(const e of this._snippet.placeholders){const s=this._snippet.offset(e),n=this._snippet.fullLen(e),r=Cs.fromPositions(t.getPositionAt(this._offset+s),t.getPositionAt(this._offset+s+n)),o=e.isFinalTabstop?Ntt._decor.inactiveFinal:Ntt._decor.inactive,h=i.addDecoration(r,o);this._placeholderDecorations.set(e,h)}}))}move(t){if(!this._editor.hasModel())return[];if(this._initDecorations(),this._placeholderGroupsIdx>=0){const t=[];for(const i of this._placeholderGroups[this._placeholderGroupsIdx])if(i.transform){const e=this._placeholderDecorations.get(i),s=this._editor.getModel().getDecorationRange(e),n=this._editor.getModel().getValueInRange(s),r=i.transform.resolve(n).split(/\r\n|\r|\n/);for(let t=1;t<r.length;t++)r[t]=this._editor.getModel().normalizeIndentation(this._snippetLineLeadingWhitespace+r[t]);t.push(KP.replace(s,r.join(this._editor.getModel().getEOL())))}t.length>0&&this._editor.executeEdits("snippet.placeholderTransform",t)}let i=!1;t===!0&&this._placeholderGroupsIdx<this._placeholderGroups.length-1?(this._placeholderGroupsIdx+=1,i=!0):t===!1&&this._placeholderGroupsIdx>0&&(this._placeholderGroupsIdx-=1,i=!0);const e=this._editor.getModel().changeDecorations((t=>{const e=new Set,s=[];for(const n of this._placeholderGroups[this._placeholderGroupsIdx]){const r=this._placeholderDecorations.get(n),o=this._editor.getModel().getDecorationRange(r);s.push(new Ss(o.startLineNumber,o.startColumn,o.endLineNumber,o.endColumn)),i=i&&this._hasPlaceholderBeenCollapsed(n),t.changeDecorationOptions(r,n.isFinalTabstop?Ntt._decor.activeFinal:Ntt._decor.active),e.add(n);for(const i of this._snippet.enclosingPlaceholders(n)){const s=this._placeholderDecorations.get(i);t.changeDecorationOptions(s,i.isFinalTabstop?Ntt._decor.activeFinal:Ntt._decor.active),e.add(i)}}for(const[i,s]of this._placeholderDecorations)e.has(i)||t.changeDecorationOptions(s,i.isFinalTabstop?Ntt._decor.inactiveFinal:Ntt._decor.inactive);return s}));return i?this.move(t):e??[]}_hasPlaceholderBeenCollapsed(t){let i=t;for(;i;){if(i instanceof l0){const t=this._placeholderDecorations.get(i);if(this._editor.getModel().getDecorationRange(t).isEmpty()&&i.toString().length>0)return!0}i=i.parent}return!1}get isAtFirstPlaceholder(){return this._placeholderGroupsIdx<=0||this._placeholderGroups.length===0}get isAtLastPlaceholder(){return this._placeholderGroupsIdx===this._placeholderGroups.length-1}get hasPlaceholder(){return this._snippet.placeholders.length>0}get isTrivialSnippet(){if(this._snippet.placeholders.length===0)return!0;if(this._snippet.placeholders.length===1){const[t]=this._snippet.placeholders;if(t.isFinalTabstop&&this._snippet.rightMostDescendant===t)return!0}return!1}computePossibleSelections(){const t=new Map;for(const i of this._placeholderGroups){let e;for(const s of i){if(s.isFinalTabstop)break;e||(e=[],t.set(s.index,e));const i=this._placeholderDecorations.get(s),n=this._editor.getModel().getDecorationRange(i);if(!n){t.delete(s.index);break}e.push(n)}}return t}get activeChoice(){if(!this._placeholderDecorations)return;const t=this._placeholderGroups[this._placeholderGroupsIdx][0];if(!(t!=null&&t.choice))return;const i=this._placeholderDecorations.get(t);if(!i)return;const e=this._editor.getModel().getDecorationRange(i);return e?{range:e,choice:t.choice}:void 0}get hasChoice(){let t=!1;return this._snippet.walk((i=>(t=i instanceof a0,!t))),t}merge(t){const i=this._editor.getModel();this._nestingLevel*=10,this._editor.changeDecorations((e=>{for(const s of this._placeholderGroups[this._placeholderGroupsIdx]){const n=t.shift();console.assert(n._offset!==-1),console.assert(!n._placeholderDecorations);const r=n._snippet.placeholderInfo.last.index;for(const t of n._snippet.placeholderInfo.all)t.isFinalTabstop?t.index=s.index+(r+1)/this._nestingLevel:t.index=s.index+t.index/this._nestingLevel;this._snippet.replace(s,n._snippet.children);const o=this._placeholderDecorations.get(s);e.removeDecoration(o),this._placeholderDecorations.delete(s);for(const t of n._snippet.placeholders){const s=n._snippet.offset(t),r=n._snippet.fullLen(t),o=Cs.fromPositions(i.getPositionAt(n._offset+s),i.getPositionAt(n._offset+s+r)),h=e.addDecoration(o,Ntt._decor.inactive);this._placeholderDecorations.set(t,h)}}this._placeholderGroups=h(this._snippet.placeholders,l0.compareByIndex)}))}}Ntt._decor={active:xF.register({description:"snippet-placeholder-1",stickiness:0,className:"snippet-placeholder"}),inactive:xF.register({description:"snippet-placeholder-2",stickiness:1,className:"snippet-placeholder"}),activeFinal:xF.register({description:"snippet-placeholder-3",stickiness:1,className:"finish-snippet-placeholder"}),inactiveFinal:xF.register({description:"snippet-placeholder-4",stickiness:1,className:"finish-snippet-placeholder"})};const Btt={overwriteBefore:0,overwriteAfter:0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0};let $tt=Itt=class{static adjustWhitespace(t,i,e,s,n){const r=ir(t.getLineContent(i.lineNumber),0,i.column-1);let o;return s.walk((i=>{if(!(i instanceof h0)||i.parent instanceof a0||n&&!n.has(i))return!0;const h=i.value.split(/\r\n|\r|\n/);if(e){const e=s.offset(i);if(e===0)h[0]=t.normalizeIndentation(h[0]);else{o=o??s.toString();const i=o.charCodeAt(e-1);i!==10&&i!==13||(h[0]=t.normalizeIndentation(r+h[0]))}for(let i=1;i<h.length;i++)h[i]=t.normalizeIndentation(r+h[i])}const c=h.join(t.getEOL());return c!==i.value&&(i.parent.replace(i,[new h0(c)]),o=void 0),!0})),r}static adjustSelection(t,i,e,s){if(e!==0||s!==0){const{positionLineNumber:n,positionColumn:r}=i,o=r-e,h=r+s,c=t.validateRange({startLineNumber:n,startColumn:o,endLineNumber:n,endColumn:h});i=Ss.createWithDirection(c.startLineNumber,c.startColumn,c.endLineNumber,c.endColumn,i.getDirection())}return i}static createEditsAndSnippetsFromSelections(t,i,e,s,n,r,o,h,c){const l=[],a=[];if(!t.hasModel())return{edits:l,snippets:a};const u=t.getModel(),d=t.invokeWithinContext((t=>t.get(AN))),f=t.invokeWithinContext((t=>new Mtt(t.get(wN),u))),g=()=>o,p=u.getValueInRange(Itt.adjustSelection(u,t.getSelection(),e,0)),m=u.getValueInRange(Itt.adjustSelection(u,t.getSelection(),0,s)),w=u.getLineFirstNonWhitespaceColumn(t.getSelection().positionLineNumber),v=t.getSelections().map(((t,i)=>({selection:t,idx:i}))).sort(((t,i)=>Cs.compareRangesUsingStarts(t.selection,i.selection)));for(const{selection:o,idx:b}of v){let y=Itt.adjustSelection(u,o,e,0),k=Itt.adjustSelection(u,o,0,s);p!==u.getValueInRange(y)&&(y=o),m!==u.getValueInRange(k)&&(k=o);const C=o.setStartPosition(y.startLineNumber,y.startColumn).setEndPosition(k.endLineNumber,k.endColumn),S=(new m0).parse(i,!0,n),x=C.getStartPosition(),D=Itt.adjustWhitespace(u,x,r||b>0&&w!==u.getLineFirstNonWhitespaceColumn(o.positionLineNumber),S);S.resolveVariables(new Ett([f,new Ltt(g,b,v.length,t.getOption(79)==="spread"),new Att(u,o,b,h),new Ftt(u,o,c),new Ttt,new Rtt(d),new Ott])),l[b]=KP.replace(C,S.toString()),l[b].identifier={major:b,minor:0},l[b]._isTracked=!0,a[b]=new Ntt(t,S,D)}return{edits:l,snippets:a}}static createEditsAndSnippetsFromEdits(t,i,e,s,n,r,o){if(!t.hasModel()||i.length===0)return{edits:[],snippets:[]};const h=[],c=t.getModel(),l=new m0,a=new p0,u=new Ett([t.invokeWithinContext((t=>new Mtt(t.get(wN),c))),new Ltt((()=>n),0,t.getSelections().length,t.getOption(79)==="spread"),new Att(c,t.getSelection(),0,r),new Ftt(c,t.getSelection(),o),new Ttt,new Rtt(t.invokeWithinContext((t=>t.get(AN)))),new Ott]);i=i.sort(((t,i)=>Cs.compareRangesUsingStarts(t.range,i.range)));let d=0;for(let t=0;t<i.length;t++){const{range:e,template:s}=i[t];if(t>0){const s=i[t-1].range,n=Cs.fromPositions(s.getEndPosition(),e.getStartPosition()),r=new h0(c.getValueInRange(n));a.appendChild(r),d+=r.value.length}const n=l.parseFragment(s,a);Itt.adjustWhitespace(c,e.getStartPosition(),!0,a,new Set(n)),a.resolveVariables(u);const r=a.toString(),o=r.slice(d);d=r.length;const f=KP.replace(e,o);f.identifier={major:t,minor:0},f._isTracked=!0,h.push(f)}return l.ensureFinalTabstop(a,e,!0),{edits:h,snippets:[new Ntt(t,a,"")]}}constructor(t,i,e=Btt,s){this._editor=t,this._template=i,this._options=e,this._languageConfigurationService=s,this._templateMerges=[],this._snippets=[]}dispose(){qi(this._snippets)}_logInfo(){return`template="${this._template}", merged_templates="${this._templateMerges.join(" -> ")}"`}insert(){if(!this._editor.hasModel())return;const{edits:t,snippets:i}=typeof this._template=="string"?Itt.createEditsAndSnippetsFromSelections(this._editor,this._template,this._options.overwriteBefore,this._options.overwriteAfter,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer,this._languageConfigurationService):Itt.createEditsAndSnippetsFromEdits(this._editor,this._template,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer,this._languageConfigurationService);this._snippets=i,this._editor.executeEdits("snippet",t,(t=>{const e=t.filter((t=>!!t.identifier));for(let t=0;t<i.length;t++)i[t].initialize(e[t].textChange);return this._snippets[0].hasPlaceholder?this._move(!0):e.map((t=>Ss.fromPositions(t.range.getEndPosition())))})),this._editor.revealRange(this._editor.getSelections()[0])}merge(t,i=Btt){if(!this._editor.hasModel())return;this._templateMerges.push([this._snippets[0]._nestingLevel,this._snippets[0]._placeholderGroupsIdx,t]);const{edits:e,snippets:s}=Itt.createEditsAndSnippetsFromSelections(this._editor,t,i.overwriteBefore,i.overwriteAfter,!0,i.adjustWhitespace,i.clipboardText,i.overtypingCapturer,this._languageConfigurationService);this._editor.executeEdits("snippet",e,(t=>{const i=t.filter((t=>!!t.identifier));for(let t=0;t<s.length;t++)s[t].initialize(i[t].textChange);const e=s[0].isTrivialSnippet;if(!e){for(const t of this._snippets)t.merge(s);console.assert(s.length===0)}return this._snippets[0].hasPlaceholder&&!e?this._move(void 0):i.map((t=>Ss.fromPositions(t.range.getEndPosition())))}))}next(){const t=this._move(!0);this._editor.setSelections(t),this._editor.revealPositionInCenterIfOutsideViewport(t[0].getPosition())}prev(){const t=this._move(!1);this._editor.setSelections(t),this._editor.revealPositionInCenterIfOutsideViewport(t[0].getPosition())}_move(t){const i=[];for(const e of this._snippets){const s=e.move(t);i.push(...s)}return i}get isAtFirstPlaceholder(){return this._snippets[0].isAtFirstPlaceholder}get isAtLastPlaceholder(){return this._snippets[0].isAtLastPlaceholder}get hasPlaceholder(){return this._snippets[0].hasPlaceholder}get hasChoice(){return this._snippets[0].hasChoice}get activeChoice(){return this._snippets[0].activeChoice}isSelectionWithinPlaceholders(){if(!this.hasPlaceholder)return!1;const t=this._editor.getSelections();if(t.length<this._snippets.length)return!1;const i=new Map;for(const e of this._snippets){const s=e.computePossibleSelections();if(i.size===0)for(const[e,n]of s){n.sort(Cs.compareRangesUsingStarts);for(const s of t)if(n[0].containsRange(s)){i.set(e,[]);break}}if(i.size===0)return!1;i.forEach(((t,i)=>{t.push(...s.get(i))}))}t.sort(Cs.compareRangesUsingStarts);for(const[e,s]of i)if(s.length===t.length){s.sort(Cs.compareRangesUsingStarts);for(let n=0;n<s.length;n++)s[n].containsRange(t[n])||i.delete(e)}else i.delete(e);return i.size>0}};$tt=Itt=_tt([Ptt(3,cf)],$tt);var Wtt,jtt=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Htt=function(t,i){return function(e,s){i(e,s,t)}};const Vtt={overwriteBefore:0,overwriteAfter:0,undoStopBefore:!0,undoStopAfter:!0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0};let ztt=Wtt=class{static get(t){return t.getContribution(Wtt.ID)}constructor(t,i,e,s,n){this._editor=t,this._logService=i,this._languageFeaturesService=e,this._languageConfigurationService=n,this._snippetListener=new Ji,this._modelVersionId=-1,this._inSnippet=Wtt.InSnippetMode.bindTo(s),this._hasNextTabstop=Wtt.HasNextTabstop.bindTo(s),this._hasPrevTabstop=Wtt.HasPrevTabstop.bindTo(s)}dispose(){var t;this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),(t=this._session)===null||t===void 0||t.dispose(),this._snippetListener.dispose()}insert(t,i){try{this._doInsert(t,i===void 0?Vtt:{...Vtt,...i})}catch(i){this.cancel(),this._logService.error(i),this._logService.error("snippet_error"),this._logService.error("insert_template=",t),this._logService.error("existing_template=",this._session?this._session._logInfo():"<no_session>")}}_doInsert(t,i){var e;if(this._editor.hasModel()){if(this._snippetListener.clear(),i.undoStopBefore&&this._editor.getModel().pushStackElement(),this._session&&typeof t!="string"&&this.cancel(),this._session?(j(typeof t=="string"),this._session.merge(t,i)):(this._modelVersionId=this._editor.getModel().getAlternativeVersionId(),this._session=new $tt(this._editor,t,i,this._languageConfigurationService),this._session.insert()),i.undoStopAfter&&this._editor.getModel().pushStackElement(),(e=this._session)===null||e===void 0?void 0:e.hasChoice){const t={_debugDisplayName:"snippetChoiceCompletions",provideCompletionItems:(t,i)=>{if(!this._session||t!==this._editor.getModel()||!ks.equals(this._editor.getPosition(),i))return;const{activeChoice:e}=this._session;if(!e||e.choice.options.length===0)return;const s=t.getValueInRange(e.range),n=!!e.choice.options.find((t=>t.value===s)),r=[];for(let t=0;t<e.choice.options.length;t++){const i=e.choice.options[t];r.push({kind:13,label:i.value,insertText:i.value,sortText:"a".repeat(t+1),range:e.range,filterText:n?`${s}_${i.value}`:void 0,command:{id:"jumpToNextSnippetPlaceholder",title:tt(0,"Go to next placeholder...")}})}return{suggestions:r}}},i=this._editor.getModel();let e,s=!1;const n=()=>{e==null||e.dispose(),s=!1},r=()=>{s||(e=this._languageFeaturesService.completionProvider.register({language:i.getLanguageId(),pattern:i.uri.fsPath,scheme:i.uri.scheme,exclusive:!0},t),this._snippetListener.add(e),s=!0)};this._choiceCompletions={provider:t,enable:r,disable:n}}this._updateState(),this._snippetListener.add(this._editor.onDidChangeModelContent((t=>t.isFlush&&this.cancel()))),this._snippetListener.add(this._editor.onDidChangeModel((()=>this.cancel()))),this._snippetListener.add(this._editor.onDidChangeCursorSelection((()=>this._updateState())))}}_updateState(){if(this._session&&this._editor.hasModel()){if(this._modelVersionId===this._editor.getModel().getAlternativeVersionId())return this.cancel();if(!this._session.hasPlaceholder)return this.cancel();if(this._session.isAtLastPlaceholder||!this._session.isSelectionWithinPlaceholders())return this._editor.getModel().pushStackElement(),this.cancel();this._inSnippet.set(!0),this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder),this._hasNextTabstop.set(!this._session.isAtLastPlaceholder),this._handleChoice()}}_handleChoice(){var t;if(!this._session||!this._editor.hasModel())return void(this._currentChoice=void 0);const{activeChoice:i}=this._session;if(!i||!this._choiceCompletions)return(t=this._choiceCompletions)===null||t===void 0||t.disable(),void(this._currentChoice=void 0);this._currentChoice!==i.choice&&(this._currentChoice=i.choice,this._choiceCompletions.enable(),queueMicrotask((()=>{(function(t,i){var e;(e=t.getContribution("editor.contrib.suggestController"))===null||e===void 0||e.triggerSuggest((new Set).add(i),void 0,!0)})(this._editor,this._choiceCompletions.provider)})))}finish(){for(;this._inSnippet.get();)this.next()}cancel(t=!1){var i;this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),this._snippetListener.clear(),this._currentChoice=void 0,(i=this._session)===null||i===void 0||i.dispose(),this._session=void 0,this._modelVersionId=-1,t&&this._editor.setSelections([this._editor.getSelection()])}prev(){var t;(t=this._session)===null||t===void 0||t.prev(),this._updateState()}next(){var t;(t=this._session)===null||t===void 0||t.next(),this._updateState()}isInSnippet(){return!!this._inSnippet.get()}};ztt.ID="snippetController2",ztt.InSnippetMode=new Ta("inSnippetMode",!1,tt(0,"Whether the editor in current in snippet mode")),ztt.HasNextTabstop=new Ta("hasNextTabstop",!1,tt(0,"Whether there is a next tab stop when in snippet mode")),ztt.HasPrevTabstop=new Ta("hasPrevTabstop",!1,tt(0,"Whether there is a previous tab stop when in snippet mode")),ztt=Wtt=jtt([Htt(1,ou),Htt(2,$p),Htt(3,Ra),Htt(4,cf)],ztt),Su(ztt.ID,ztt,4);const Utt=pu.bindToContribution(ztt.get);yu(new Utt({id:"jumpToNextSnippetPlaceholder",precondition:ua.and(ztt.InSnippetMode,ztt.HasNextTabstop),handler:t=>t.next(),kbOpts:{weight:130,kbExpr:Ox.editorTextFocus,primary:2}})),yu(new Utt({id:"jumpToPrevSnippetPlaceholder",precondition:ua.and(ztt.InSnippetMode,ztt.HasPrevTabstop),handler:t=>t.prev(),kbOpts:{weight:130,kbExpr:Ox.editorTextFocus,primary:1026}})),yu(new Utt({id:"leaveSnippet",precondition:ztt.InSnippetMode,handler:t=>t.cancel(!0),kbOpts:{weight:130,kbExpr:Ox.editorTextFocus,primary:9,secondary:[1033]}})),yu(new Utt({id:"acceptSnippet",precondition:ztt.InSnippetMode,handler:t=>t.finish()}));var Ktt,qtt=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Gtt=function(t,i){return function(e,s){i(e,s,t)}};(function(t){t[t.Undo=0]="Undo",t[t.Redo=1]="Redo",t[t.AcceptWord=2]="AcceptWord",t[t.Other=3]="Other"})(Ktt||(Ktt={}));let Ztt=class extends Qi{get isAcceptingPartially(){return this._isAcceptingPartially}constructor(t,i,e,s,n,r,o,h,c,l,a,u){let d;super(),this.textModel=t,this.selectedSuggestItem=i,this.textModelVersionId=e,this._positions=s,this._debounceValue=n,this._suggestPreviewEnabled=r,this._suggestPreviewMode=o,this._inlineSuggestMode=h,this._enabled=c,this._instantiationService=l,this._commandService=a,this._languageConfigurationService=u,this._source=this._register(this._instantiationService.createInstance(ctt,this.textModel,this.textModelVersionId,this._debounceValue)),this._isActive=$B(this,!1),this._forceUpdateSignal=o$("forceUpdate"),this._selectedInlineCompletionId=$B(this,void 0),this._primaryPosition=zB(this,(t=>{var i;return(i=this._positions.read(t)[0])!==null&&i!==void 0?i:new ks(1,1)})),this._isAcceptingPartially=!1,this._preserveCurrentCompletionReasons=new Set([Ktt.Redo,Ktt.Undo,Ktt.AcceptWord]),this._fetchInlineCompletions=function(t,i){var e;return new GB(new xB(t.owner,t.debugName,void 0),i,t.createEmptyChangeSummary,t.handleChange,void 0,(e=t.equalityComparer)!==null&&e!==void 0?e:VB)}({owner:this,createEmptyChangeSummary:()=>({preserveCurrentCompletion:!1,inlineCompletionTriggerKind:Os.Automatic}),handleChange:(t,i)=>(t.didChange(this.textModelVersionId)&&this._preserveCurrentCompletionReasons.has(t.change)?i.preserveCurrentCompletion=!0:t.didChange(this._forceUpdateSignal)&&(i.inlineCompletionTriggerKind=t.change),!0)},((t,i)=>{if(this._forceUpdateSignal.read(t),!(this._enabled.read(t)&&this.selectedSuggestItem.read(t)||this._isActive.read(t)))return void this._source.cancelUpdate();this.textModelVersionId.read(t);const e=this.selectedInlineCompletion.get(),s=i.preserveCurrentCompletion||e!=null&&e.forwardStable?e:void 0,n=this._source.suggestWidgetInlineCompletions.get(),r=this.selectedSuggestItem.read(t);if(n&&!r){const t=this._source.inlineCompletions.get();_B((i=>{(!t||n.request.versionId>t.request.versionId)&&this._source.inlineCompletions.set(n.clone(),i),this._source.clearSuggestWidgetInlineCompletions(i)}))}const o=this._primaryPosition.read(t),h={triggerKind:i.inlineCompletionTriggerKind,selectedSuggestionInfo:r==null?void 0:r.toSelectedSuggestionInfo()};return this._source.fetch(o,h,s)})),this._filteredInlineCompletionItems=zB(this,(t=>{const i=this._source.inlineCompletions.read(t);if(!i)return[];const e=this._primaryPosition.read(t);return i.inlineCompletions.filter((i=>i.isVisible(this.textModel,e,t)))})),this.selectedInlineCompletionIndex=zB(this,(t=>{const i=this._selectedInlineCompletionId.read(t),e=this._filteredInlineCompletionItems.read(t),s=this._selectedInlineCompletionId===void 0?-1:e.findIndex((t=>t.semanticId===i));return s===-1?(this._selectedInlineCompletionId.set(void 0,void 0),0):s})),this.selectedInlineCompletion=zB(this,(t=>this._filteredInlineCompletionItems.read(t)[this.selectedInlineCompletionIndex.read(t)])),this.lastTriggerKind=this._source.inlineCompletions.map(this,(t=>t==null?void 0:t.request.context.triggerKind)),this.inlineCompletionsCount=zB(this,(t=>this.lastTriggerKind.read(t)===Os.Explicit?this._filteredInlineCompletionItems.read(t).length:void 0)),this.state=UB({owner:this,equalityComparer:(t,i)=>t&&i?P8(t.ghostTexts,i.ghostTexts)&&t.inlineCompletion===i.inlineCompletion&&t.suggestItem===i.suggestItem:t===i},(t=>{var i,e;const s=this.textModel,n=this.selectedSuggestItem.read(t);if(n){const r=ttt(n.toSingleTextEdit(),s),o=this._computeAugmentation(r,t);if(!this._suggestPreviewEnabled.read(t)&&!o)return;const h=(i=o==null?void 0:o.edit)!==null&&i!==void 0?i:r,c=o?o.edit.text.length-r.text.length:0,l=this._suggestPreviewMode.read(t),a=this._positions.read(t),u=[h,...Jtt(this.textModel,a,h)],d=u.map(((t,i)=>ett(t,s,l,a[i],c))).filter($);return{edits:u,primaryGhostText:(e=d[0])!==null&&e!==void 0?e:new O8(h.range.endLineNumber,[]),ghostTexts:d,inlineCompletion:o==null?void 0:o.completion,suggestItem:n}}{if(!this._isActive.read(t))return;const i=this.selectedInlineCompletion.read(t);if(!i)return;const e=i.toSingleTextEdit(t),n=this._inlineSuggestMode.read(t),r=this._positions.read(t),o=[e,...Jtt(this.textModel,r,e)],h=o.map(((t,i)=>ett(t,s,n,r[i],0))).filter($);return h[0]?{edits:o,primaryGhostText:h[0],ghostTexts:h,inlineCompletion:i,suggestItem:void 0}:void 0}})),this.ghostTexts=UB({owner:this,equalityComparer:P8},(t=>{const i=this.state.read(t);if(i)return i.ghostTexts})),this.primaryGhostText=UB({owner:this,equalityComparer:N8},(t=>{const i=this.state.read(t);if(i)return i==null?void 0:i.primaryGhostText})),this._register(c$(this._fetchInlineCompletions)),this._register(ZB((t=>{var i,e;const s=this.state.read(t),n=s==null?void 0:s.inlineCompletion;if((n==null?void 0:n.semanticId)!==(d==null?void 0:d.semanticId)&&(d=n,n)){const t=n.inlineCompletion,s=t.source;(e=(i=s.provider).handleItemDidShow)===null||e===void 0||e.call(i,s.inlineCompletions,t.sourceInlineCompletion,t.insertText)}})))}async trigger(t){this._isActive.set(!0,t),await this._fetchInlineCompletions.get()}async triggerExplicitly(t){NB(t,(t=>{this._isActive.set(!0,t),this._forceUpdateSignal.trigger(t,Os.Explicit)})),await this._fetchInlineCompletions.get()}stop(t){NB(t,(t=>{this._isActive.set(!1,t),this._source.clear(t)}))}_computeAugmentation(t,i){const e=this.textModel,s=this._source.suggestWidgetInlineCompletions.read(i);return function(t,i){for(const e of t){const t=i(e);if(t!==void 0)return t}}(s?s.inlineCompletions:[this.selectedInlineCompletion.read(i)].filter($),(s=>{let n=s.toSingleTextEdit(i);return n=ttt(n,e,Cs.fromPositions(n.range.getStartPosition(),t.range.getEndPosition())),itt(n,t)?{completion:s,edit:n}:void 0}))}async _deltaSelectedInlineCompletionIndex(t){await this.triggerExplicitly();const i=this._filteredInlineCompletionItems.get()||[];if(i.length>0){const e=(this.selectedInlineCompletionIndex.get()+t+i.length)%i.length;this._selectedInlineCompletionId.set(i[e].semanticId,void 0)}else this._selectedInlineCompletionId.set(void 0,void 0)}async next(){await this._deltaSelectedInlineCompletionIndex(1)}async previous(){await this._deltaSelectedInlineCompletionIndex(-1)}async accept(t){var i;if(t.getModel()!==this.textModel)throw new zi;const e=this.state.get();if(!e||e.primaryGhostText.isEmpty()||!e.inlineCompletion)return;const s=e.inlineCompletion.toInlineCompletion(void 0);if(t.pushUndoStop(),s.snippetInfo)t.executeEdits("inlineSuggestion.accept",[KP.replaceMove(s.range,""),...s.additionalTextEdits]),t.setPosition(s.snippetInfo.range.getStartPosition(),"inlineCompletionAccept"),(i=ztt.get(t))===null||i===void 0||i.insert(s.snippetInfo.snippet,{undoStopBefore:!1});else{const i=e.edits,n=Qtt(i).map((t=>Ss.fromPositions(t)));t.executeEdits("inlineSuggestion.accept",[...i.map((t=>KP.replaceMove(t.range,t.text))),...s.additionalTextEdits]),t.setSelections(n,"inlineCompletionAccept")}s.command&&s.source.addRef(),_B((t=>{this._source.clear(t),this._isActive.set(!1,t)})),s.command&&(await this._commandService.executeCommand(s.command.id,...s.command.arguments||[]).then(void 0,_i),s.source.removeRef())}async acceptNextWord(t){await this._acceptNext(t,((t,i)=>{const e=this.textModel.getLanguageIdAtPosition(t.lineNumber,t.column),s=this._languageConfigurationService.getLanguageConfiguration(e),n=new RegExp(s.wordDefinition.source,s.wordDefinition.flags.replace("g","")),r=i.match(n);let o=0;o=r&&r.index!==void 0?r.index===0?r[0].length:r.index:i.length;const h=/\s+/g.exec(i);return h&&h.index!==void 0&&h.index+h[0].length<o&&(o=h.index+h[0].length),o}),0)}async acceptNextLine(t){await this._acceptNext(t,((t,i)=>{const e=i.match(/\n/);return e&&e.index!==void 0?e.index+1:i.length}),1)}async _acceptNext(t,i,e){if(t.getModel()!==this.textModel)throw new zi;const s=this.state.get();if(!s||s.primaryGhostText.isEmpty()||!s.inlineCompletion)return;const n=s.primaryGhostText,r=s.inlineCompletion.toInlineCompletion(void 0);if(r.snippetInfo||r.filterText!==r.insertText)return void await this.accept(t);const o=n.parts[0],h=new ks(n.lineNumber,o.column),c=o.text,l=i(h,c);if(l===c.length&&n.parts.length===1)return void this.accept(t);const a=c.substring(0,l),u=this._positions.get(),d=u[0];r.source.addRef();try{this._isAcceptingPartially=!0;try{t.pushUndoStop();const i=Cs.fromPositions(d,h),e=t.getModel().getValueInRange(i)+a,s=new gZ(i,e),n=[s,...Jtt(this.textModel,u,s)],r=Qtt(n).map((t=>Ss.fromPositions(t)));t.executeEdits("inlineSuggestion.accept",n.map((t=>KP.replaceMove(t.range,t.text)))),t.setSelections(r,"inlineCompletionPartialAccept")}finally{this._isAcceptingPartially=!1}if(r.source.provider.handlePartialAccept){const i=Cs.fromPositions(r.range.getStartPosition(),eA.ofText(a).addToPosition(h)),s=t.getModel().getValueInRange(i,1);r.source.provider.handlePartialAccept(r.source.inlineCompletions,r.sourceInlineCompletion,s.length,{kind:e})}}finally{r.source.removeRef()}}handleSuggestAccepted(t){var i,e;const s=ttt(t.toSingleTextEdit(),this.textModel),n=this._computeAugmentation(s,void 0);if(!n)return;const r=n.completion.inlineCompletion;(e=(i=r.source.provider).handlePartialAccept)===null||e===void 0||e.call(i,r.source.inlineCompletions,r.sourceInlineCompletion,s.text.length,{kind:2})}};function Jtt(t,i,e){if(i.length===1)return[];const s=i[0],n=i.slice(1),r=e.range.getStartPosition(),o=e.range.getEndPosition(),h=t.getValueInRange(Cs.fromPositions(s,o)),c=j8(s,r);if(c.lineNumber<1)return Ii(new zi(`positionWithinTextEdit line number should be bigger than 0.\n\t\t\tInvalid subtraction between ${s.toString()} and ${r.toString()}`)),[];const l=function(t,i){let e="";const s=function(t){var i;const e=[],s=t.split(/(\r\n|\r|\n)/);for(let t=0;t<Math.ceil(s.length/2);t++)e.push(s[2*t]+((i=s[2*t+1])!==null&&i!==void 0?i:""));return e}(t);for(let t=i.lineNumber-1;t<s.length;t++)e+=s[t].substring(t===i.lineNumber-1?i.column-1:0);return e}(e.text,c);return n.map((i=>{const e=(s=j8(i,r),n=o,new ks(s.lineNumber+n.lineNumber-1,n.lineNumber===1?s.column+n.column-1:n.column));var s,n;const c=t.getValueInRange(Cs.fromPositions(i,e)),a=dr(h,c),u=Cs.fromPositions(i,i.delta(0,a));return new gZ(u,l)}))}function Qtt(t){const i=T.createSortPermutation(t,((t,i)=>Cs.compareRangesUsingStarts(t.range,i.range))),e=new fZ(i.apply(t)).getNewRanges();return i.inverse().apply(e).map((t=>t.getEndPosition()))}Ztt=qtt([Gtt(9,Il),Gtt(10,ql),Gtt(11,cf)],Ztt);var Ytt,Xtt=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},tit=function(t,i){return function(e,s){i(e,s,t)}};class iit{constructor(t){this.name=t}select(t,i,e){if(e.length===0)return 0;const s=e[0].score[0];for(let t=0;t<e.length;t++){const{score:i,completion:n}=e[t];if(i[0]!==s)break;if(n.preselect)return t}return 0}}class eit extends iit{constructor(){super("first")}memorize(t,i,e){}toJSON(){}fromJSON(){}}let sit=Ytt=class{constructor(t,i){this._storageService=t,this._configService=i,this._disposables=new Ji,this._persistSoon=new Co((()=>this._saveState()),500),this._disposables.add(t.onWillSaveState((t=>{t.reason===rW.SHUTDOWN&&this._saveState()})))}dispose(){this._disposables.dispose(),this._persistSoon.dispose()}memorize(t,i,e){this._withStrategy(t,i).memorize(t,i,e),this._persistSoon.schedule()}select(t,i,e){return this._withStrategy(t,i).select(t,i,e)}_withStrategy(t,i){var e;const s=this._configService.getValue("editor.suggestSelection",{overrideIdentifier:t.getLanguageIdAtPosition(i.lineNumber,i.column),resource:t.uri});if(((e=this._strategy)===null||e===void 0?void 0:e.name)!==s){this._saveState();const t=Ytt._strategyCtors.get(s)||eit;this._strategy=new t;try{const t=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,i=this._storageService.get(`${Ytt._storagePrefix}/${s}`,t);i&&this._strategy.fromJSON(JSON.parse(i))}catch{}}return this._strategy}_saveState(){if(this._strategy){const t=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,i=JSON.stringify(this._strategy);this._storageService.store(`${Ytt._storagePrefix}/${this._strategy.name}`,i,t,1)}}};sit._strategyCtors=new Map([["recentlyUsedByPrefix",class extends iit{constructor(){super("recentlyUsedByPrefix"),this._trie=EN.forStrings(),this._seq=0}memorize(t,i,e){const{word:s}=t.getWordUntilPosition(i),n=`${t.getLanguageId()}/${s}`;this._trie.set(n,{type:e.completion.kind,insertText:e.completion.insertText,touch:this._seq++})}select(t,i,e){const{word:s}=t.getWordUntilPosition(i);if(!s)return super.select(t,i,e);const n=`${t.getLanguageId()}/${s}`;let r=this._trie.get(n);if(r||(r=this._trie.findSubstr(n)),r)for(let t=0;t<e.length;t++){const{kind:i,insertText:s}=e[t].completion;if(i===r.type&&s===r.insertText)return t}return super.select(t,i,e)}toJSON(){const t=[];return this._trie.forEach(((i,e)=>t.push([e,i]))),t.sort(((t,i)=>-(t[1].touch-i[1].touch))).forEach(((t,i)=>t[1].touch=i)),t.slice(0,200)}fromJSON(t){if(this._trie.clear(),t.length>0){this._seq=t[0][1].touch+1;for(const[i,e]of t)e.type=typeof e.type=="number"?e.type:Rs.fromString(e.type),this._trie.set(i,e)}}}],["recentlyUsed",class extends iit{constructor(){super("recentlyUsed"),this._cache=new Kf(300,.66),this._seq=0}memorize(t,i,e){const s=`${t.getLanguageId()}/${e.textLabel}`;this._cache.set(s,{touch:this._seq++,type:e.completion.kind,insertText:e.completion.insertText})}select(t,i,e){if(e.length===0)return 0;const s=t.getLineContent(i.lineNumber).substr(i.column-10,i.column-1);if(/\s$/.test(s))return super.select(t,i,e);const n=e[0].score[0];let r=-1,o=-1,h=-1;for(let i=0;i<e.length&&e[i].score[0]===n;i++){const s=`${t.getLanguageId()}/${e[i].textLabel}`,n=this._cache.peek(s);if(n&&n.touch>h&&n.type===e[i].completion.kind&&n.insertText===e[i].completion.insertText&&(h=n.touch,o=i),e[i].completion.preselect&&r===-1)return i}return o!==-1?o:r!==-1?r:0}toJSON(){return this._cache.toJSON()}fromJSON(t){this._cache.clear();for(const[i,e]of t)e.touch=0,e.type=typeof e.type=="number"?e.type:Rs.fromString(e.type),this._cache.set(i,e);this._seq=this._cache.size}}],["first",eit]]),sit._storagePrefix="suggest/memories",sit=Ytt=Xtt([tit(0,nW),tit(1,Md)],sit);const nit=_l("ISuggestMemories");Nd(nit,sit,1);var rit,oit=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},hit=function(t,i){return function(e,s){i(e,s,t)}};let cit=rit=class{constructor(t,i){this._editor=t,this._enabled=!1,this._ckAtEnd=rit.AtEnd.bindTo(i),this._configListener=this._editor.onDidChangeConfiguration((t=>t.hasChanged(123)&&this._update())),this._update()}dispose(){var t;this._configListener.dispose(),(t=this._selectionListener)===null||t===void 0||t.dispose(),this._ckAtEnd.reset()}_update(){const t=this._editor.getOption(123)==="on";if(this._enabled!==t)if(this._enabled=t,this._enabled){const t=()=>{if(!this._editor.hasModel())return void this._ckAtEnd.set(!1);const t=this._editor.getModel(),i=this._editor.getSelection(),e=t.getWordAtPosition(i.getStartPosition());e?this._ckAtEnd.set(e.endColumn===i.getStartPosition().column):this._ckAtEnd.set(!1)};this._selectionListener=this._editor.onDidChangeCursorSelection(t),t()}else this._selectionListener&&(this._ckAtEnd.reset(),this._selectionListener.dispose(),this._selectionListener=void 0)}};cit.AtEnd=new Ta("atEndOfWord",!1),cit=rit=oit([hit(1,Ra)],cit);var lit,ait=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},uit=function(t,i){return function(e,s){i(e,s,t)}};let dit=lit=class{constructor(t,i){this._editor=t,this._index=0,this._ckOtherSuggestions=lit.OtherSuggestions.bindTo(i)}dispose(){this.reset()}reset(){var t;this._ckOtherSuggestions.reset(),(t=this._listener)===null||t===void 0||t.dispose(),this._model=void 0,this._acceptNext=void 0,this._ignore=!1}set({model:t,index:i},e){if(t.items.length===0)return void this.reset();lit._moveIndex(!0,t,i)!==i?(this._acceptNext=e,this._model=t,this._index=i,this._listener=this._editor.onDidChangeCursorPosition((()=>{this._ignore||this.reset()})),this._ckOtherSuggestions.set(!0)):this.reset()}static _moveIndex(t,i,e){let s=e;for(let n=i.items.length;n>0&&(s=(s+i.items.length+(t?1:-1))%i.items.length,s!==e)&&i.items[s].completion.additionalTextEdits;n--);return s}next(){this._move(!0)}prev(){this._move(!1)}_move(t){if(this._model)try{this._ignore=!0,this._index=lit._moveIndex(t,this._model,this._index),this._acceptNext({index:this._index,item:this._model.items[this._index],model:this._model})}finally{this._ignore=!1}}};dit.OtherSuggestions=new Ta("hasOtherSuggestions",!1),dit=lit=ait([uit(1,Ra)],dit);class fit{constructor(t,i,e,s){this._disposables=new Ji,this._disposables.add(e.onDidSuggest((t=>{t.completionModel.items.length===0&&this.reset()}))),this._disposables.add(e.onDidCancel((t=>{this.reset()}))),this._disposables.add(i.onDidShow((()=>this._onItem(i.getFocusedItem())))),this._disposables.add(i.onDidFocus(this._onItem,this)),this._disposables.add(i.onDidHide(this.reset,this)),this._disposables.add(t.onWillType((n=>{if(this._active&&!i.isFrozen()&&e.state!==0){const i=n.charCodeAt(n.length-1);this._active.acceptCharacters.has(i)&&t.getOption(0)&&s(this._active.item)}})))}_onItem(t){if(!t||!f(t.item.completion.commitCharacters))return void this.reset();if(this._active&&this._active.item.item===t.item)return;const i=new If;for(const e of t.item.completion.commitCharacters)e.length>0&&i.add(e.charCodeAt(0));this._active={acceptCharacters:i,item:t}}reset(){this._active=void 0}dispose(){this._disposables.dispose()}}class git{async provideSelectionRanges(t,i){const e=[];for(const s of i){const i=[];e.push(i);const n=new Map;await new Promise((i=>git._bracketsRightYield(i,0,t,s,n))),await new Promise((e=>git._bracketsLeftYield(e,0,t,s,n,i)))}return e}static _bracketsRightYield(t,i,e,s,n){const r=new Map,o=Date.now();for(;;){if(i>=git._maxRounds){t();break}if(!s){t();break}const h=e.bracketPairs.findNextBracket(s);if(!h){t();break}if(Date.now()-o>git._maxDuration){setTimeout((()=>git._bracketsRightYield(t,i+1,e,s,n)));break}if(h.bracketInfo.isOpeningBracket){const t=h.bracketInfo.bracketText,i=r.has(t)?r.get(t):0;r.set(t,i+1)}else{const t=h.bracketInfo.getOpeningBrackets()[0].bracketText;let i=r.has(t)?r.get(t):0;if(i-=1,r.set(t,Math.max(0,i)),i<0){let i=n.get(t);i||(i=new Ht,n.set(t,i)),i.push(h.range)}}s=h.range.getEndPosition()}}static _bracketsLeftYield(t,i,e,s,n,r){const o=new Map,h=Date.now();for(;;){if(i>=git._maxRounds&&n.size===0){t();break}if(!s){t();break}const c=e.bracketPairs.findPrevBracket(s);if(!c){t();break}if(Date.now()-h>git._maxDuration){setTimeout((()=>git._bracketsLeftYield(t,i+1,e,s,n,r)));break}if(c.bracketInfo.isOpeningBracket){const t=c.bracketInfo.bracketText;let i=o.has(t)?o.get(t):0;if(i-=1,o.set(t,Math.max(0,i)),i<0){const i=n.get(t);if(i){const s=i.shift();i.size===0&&n.delete(t);const o=Cs.fromPositions(c.range.getEndPosition(),s.getStartPosition()),h=Cs.fromPositions(c.range.getStartPosition(),s.getEndPosition());r.push({range:o}),r.push({range:h}),git._addBracketLeading(e,h,r)}}}else{const t=c.bracketInfo.getOpeningBrackets()[0].bracketText,i=o.has(t)?o.get(t):0;o.set(t,i+1)}s=c.range.getStartPosition()}}static _addBracketLeading(t,i,e){if(i.startLineNumber===i.endLineNumber)return;const s=i.startLineNumber,n=t.getLineFirstNonWhitespaceColumn(s);n!==0&&n!==i.startColumn&&(e.push({range:Cs.fromPositions(new ks(s,n),i.getEndPosition())}),e.push({range:Cs.fromPositions(new ks(s,1),i.getEndPosition())}));const r=s-1;if(r>0){const s=t.getLineFirstNonWhitespaceColumn(r);s===i.startColumn&&s!==t.getLineLastNonWhitespaceColumn(r)&&(e.push({range:Cs.fromPositions(new ks(r,s),i.getEndPosition())}),e.push({range:Cs.fromPositions(new ks(r,1),i.getEndPosition())}))}}}git._maxDuration=30,git._maxRounds=2;class pit{static async create(t,i){if(!i.getOption(118).localityBonus||!i.hasModel())return pit.None;const e=i.getModel(),s=i.getPosition();if(!t.canComputeWordRanges(e.uri))return pit.None;const[n]=await(new git).provideSelectionRanges(e,[s]);if(n.length===0)return pit.None;const o=await t.computeWordRanges(e.uri,n[0].range);if(!o)return pit.None;const h=e.getWordUntilPosition(s);return delete o[h.word],new class extends pit{distance(t,e){if(!s.equals(i.getPosition()))return 0;if(e.kind===17)return 2<<20;const h=typeof e.label=="string"?e.label:e.label.label,c=o[h];if(d(c))return 2<<20;const l=r(c,Cs.fromPositions(t),Cs.compareRangesUsingStarts),a=l>=0?c[l]:c[Math.max(0,~l-1)];let u=n.length;for(const t of n){if(!Cs.containsRange(t.range,a))break;u-=1}return u}}}}pit.None=new class extends pit{distance(){return 0}};let mit=class{constructor(t,i){this.leadingLineContent=t,this.characterCountDelta=i}};class wit{constructor(t,i,e,s,n,r,o=m_.default,h=void 0){this.clipboardText=h,this._snippetCompareFn=wit._compareCompletionItems,this._items=t,this._column=i,this._wordDistance=s,this._options=n,this._refilterKind=1,this._lineContext=e,this._fuzzyScoreOptions=o,r==="top"?this._snippetCompareFn=wit._compareCompletionItemsSnippetsUp:r==="bottom"&&(this._snippetCompareFn=wit._compareCompletionItemsSnippetsDown)}get lineContext(){return this._lineContext}set lineContext(t){this._lineContext.leadingLineContent===t.leadingLineContent&&this._lineContext.characterCountDelta===t.characterCountDelta||(this._refilterKind=this._lineContext.characterCountDelta<t.characterCountDelta&&this._filteredItems?2:1,this._lineContext=t)}get items(){return this._ensureCachedState(),this._filteredItems}getItemsByProvider(){return this._ensureCachedState(),this._itemsByProvider}getIncompleteProvider(){this._ensureCachedState();const t=new Set;for(const[i,e]of this.getItemsByProvider())e.length>0&&e[0].container.incomplete&&t.add(i);return t}get stats(){return this._ensureCachedState(),this._stats}_ensureCachedState(){this._refilterKind!==0&&this._createCachedState()}_createCachedState(){this._itemsByProvider=new Map;const t=[],{leadingLineContent:i,characterCountDelta:e}=this._lineContext;let s="",n="";const r=this._refilterKind===1?this._items:this._filteredItems,h=[],c=!this._options.filterGraceful||r.length>2e3?w_:b_;for(let o=0;o<r.length;o++){const l=r[o];if(l.isInvalid)continue;const a=this._itemsByProvider.get(l.provider);a?a.push(l):this._itemsByProvider.set(l.provider,[l]);const u=l.position.column-l.editStart.column,d=u+e-(l.position.column-this._column);if(s.length!==d&&(s=d===0?"":i.slice(-d),n=s.toLowerCase()),l.word=s,d===0)l.score=p_.Default;else{let t=0;for(;t<u;){const i=s.charCodeAt(t);if(i!==32&&i!==9)break;t+=1}if(t>=d)l.score=p_.Default;else if(typeof l.completion.filterText=="string"){const i=c(s,n,t,l.completion.filterText,l.filterTextLow,0,this._fuzzyScoreOptions);if(!i)continue;rr(l.completion.filterText,l.textLabel)===0?l.score=i:(l.score=e_(s,n,t,l.textLabel,l.labelLow,0),l.score[0]=i[0])}else{const i=c(s,n,t,l.textLabel,l.labelLow,0,this._fuzzyScoreOptions);if(!i)continue;l.score=i}}l.idx=o,l.distance=this._wordDistance.distance(l.position,l.completion),h.push(l),t.push(l.textLabel.length)}this._filteredItems=h.sort(this._snippetCompareFn),this._refilterKind=0,this._stats={pLabelLen:t.length?o(t.length-.85,t,((t,i)=>t-i)):0}}static _compareCompletionItems(t,i){return t.score[0]>i.score[0]?-1:t.score[0]<i.score[0]?1:t.distance<i.distance?-1:t.distance>i.distance?1:t.idx<i.idx?-1:t.idx>i.idx?1:0}static _compareCompletionItemsSnippetsDown(t,i){if(t.completion.kind!==i.completion.kind){if(t.completion.kind===27)return 1;if(i.completion.kind===27)return-1}return wit._compareCompletionItems(t,i)}static _compareCompletionItemsSnippetsUp(t,i){if(t.completion.kind!==i.completion.kind){if(t.completion.kind===27)return-1;if(i.completion.kind===27)return 1}return wit._compareCompletionItems(t,i)}}var vit,bit=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},yit=function(t,i){return function(e,s){i(e,s,t)}};class kit{static shouldAutoTrigger(t){if(!t.hasModel())return!1;const i=t.getModel(),e=t.getPosition();i.tokenization.tokenizeIfCheap(e.lineNumber);const s=i.getWordAtPosition(e);return!!s&&(s.endColumn===e.column||s.startColumn+1===e.column)&&!!isNaN(Number(s.word))}constructor(t,i,e){this.leadingLineContent=t.getLineContent(i.lineNumber).substr(0,i.column-1),this.leadingWord=t.getWordUntilPosition(i),this.lineNumber=i.lineNumber,this.column=i.column,this.triggerOptions=e}}let Cit=vit=class{constructor(t,i,e,s,n,r,o,h,c){this._editor=t,this._editorWorkerService=i,this._clipboardService=e,this._telemetryService=s,this._logService=n,this._contextKeyService=r,this._configurationService=o,this._languageFeaturesService=h,this._envService=c,this._toDispose=new Ji,this._triggerCharacterListener=new Ji,this._triggerQuickSuggest=new yo,this._triggerState=void 0,this._completionDisposables=new Ji,this._onDidCancel=new le,this._onDidTrigger=new le,this._onDidSuggest=new le,this.onDidCancel=this._onDidCancel.event,this.onDidTrigger=this._onDidTrigger.event,this.onDidSuggest=this._onDidSuggest.event,this._telemetryGate=0,this._currentSelection=this._editor.getSelection()||new Ss(1,1,1,1),this._toDispose.add(this._editor.onDidChangeModel((()=>{this._updateTriggerCharacters(),this.cancel()}))),this._toDispose.add(this._editor.onDidChangeModelLanguage((()=>{this._updateTriggerCharacters(),this.cancel()}))),this._toDispose.add(this._editor.onDidChangeConfiguration((()=>{this._updateTriggerCharacters()}))),this._toDispose.add(this._languageFeaturesService.completionProvider.onDidChange((()=>{this._updateTriggerCharacters(),this._updateActiveSuggestSession()})));let l=!1;this._toDispose.add(this._editor.onDidCompositionStart((()=>{l=!0}))),this._toDispose.add(this._editor.onDidCompositionEnd((()=>{l=!1,this._onCompositionEnd()}))),this._toDispose.add(this._editor.onDidChangeCursorSelection((t=>{l||this._onCursorChange(t)}))),this._toDispose.add(this._editor.onDidChangeModelContent((()=>{l||this._triggerState===void 0||this._refilterCompletionItems()}))),this._updateTriggerCharacters()}dispose(){qi(this._triggerCharacterListener),qi([this._onDidCancel,this._onDidSuggest,this._onDidTrigger,this._triggerQuickSuggest]),this._toDispose.dispose(),this._completionDisposables.dispose(),this.cancel()}_updateTriggerCharacters(){if(this._triggerCharacterListener.clear(),this._editor.getOption(91)||!this._editor.hasModel()||!this._editor.getOption(121))return;const t=new Map;for(const i of this._languageFeaturesService.completionProvider.all(this._editor.getModel()))for(const e of i.triggerCharacters||[]){let s=t.get(e);s||(s=new Set,s.add(void 0),t.set(e,s)),s.add(i)}const i=i=>{var e;if(!function(t,i,e){if(!i.getContextKeyValue("inlineSuggestionVisible"))return!0;const s=i.getContextKeyValue(R8.suppressSuggestions.key);return s!==void 0?!s:!t.getOption(62).suppressSuggestions}(this._editor,this._contextKeyService)||kit.shouldAutoTrigger(this._editor))return;if(!i){const t=this._editor.getPosition();i=this._editor.getModel().getLineContent(t.lineNumber).substr(0,t.column-1)}let s="";pr(i.charCodeAt(i.length-1))?gr(i.charCodeAt(i.length-2))&&(s=i.substr(i.length-2)):s=i.charAt(i.length-1);const n=t.get(s);if(n){const t=new Map;if(this._completionModel)for(const[i,e]of this._completionModel.getItemsByProvider())n.has(i)||t.set(i,e);this.trigger({auto:!0,triggerKind:1,triggerCharacter:s,retrigger:!!this._completionModel,clipboardText:(e=this._completionModel)===null||e===void 0?void 0:e.clipboardText,completionOptions:{providerFilter:n,providerItemsToReuse:t}})}};this._triggerCharacterListener.add(this._editor.onDidType(i)),this._triggerCharacterListener.add(this._editor.onDidCompositionEnd((()=>i())))}get state(){return this._triggerState?this._triggerState.auto?2:1:0}cancel(t=!1){var i;this._triggerState!==void 0&&(this._triggerQuickSuggest.cancel(),(i=this._requestToken)===null||i===void 0||i.cancel(),this._requestToken=void 0,this._triggerState=void 0,this._completionModel=void 0,this._context=void 0,this._onDidCancel.fire({retrigger:t}))}clear(){this._completionDisposables.clear()}_updateActiveSuggestSession(){this._triggerState!==void 0&&(this._editor.hasModel()&&this._languageFeaturesService.completionProvider.has(this._editor.getModel())?this.trigger({auto:this._triggerState.auto,retrigger:!0}):this.cancel())}_onCursorChange(t){if(!this._editor.hasModel())return;const i=this._currentSelection;this._currentSelection=this._editor.getSelection(),!t.selection.isEmpty()||t.reason!==0&&t.reason!==3||t.source!=="keyboard"&&t.source!=="deleteLeft"?this.cancel():this._triggerState===void 0&&t.reason===0?(i.containsRange(this._currentSelection)||i.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition()))&&this._doTriggerQuickSuggest():this._triggerState!==void 0&&t.reason===3&&this._refilterCompletionItems()}_onCompositionEnd(){this._triggerState===void 0?this._doTriggerQuickSuggest():this._refilterCompletionItems()}_doTriggerQuickSuggest(){var t;Ctt.isAllOff(this._editor.getOption(89))||this._editor.getOption(118).snippetsPreventQuickSuggestions&&(!((t=ztt.get(this._editor))===null||t===void 0)&&t.isInSnippet())||(this.cancel(),this._triggerQuickSuggest.cancelAndSet((()=>{if(this._triggerState!==void 0||!kit.shouldAutoTrigger(this._editor)||!this._editor.hasModel()||!this._editor.hasWidgetFocus())return;const t=this._editor.getModel(),i=this._editor.getPosition(),e=this._editor.getOption(89);if(!Ctt.isAllOff(e)){if(!Ctt.isAllOn(e)){t.tokenization.tokenizeIfCheap(i.lineNumber);const s=t.tokenization.getLineTokens(i.lineNumber),n=s.getStandardTokenType(s.findTokenIndexAtOffset(Math.max(i.column-1-1,0)));if(Ctt.valueFor(e,n)!=="on")return}(function(t,i,e){if(!i.getContextKeyValue(R8.inlineSuggestionVisible.key))return!0;const s=i.getContextKeyValue(R8.suppressSuggestions.key);return s!==void 0?!s:!t.getOption(62).suppressSuggestions})(this._editor,this._contextKeyService)&&this._languageFeaturesService.completionProvider.has(t)&&this.trigger({auto:!0})}}),this._editor.getOption(90)))}_refilterCompletionItems(){j(this._editor.hasModel()),j(this._triggerState!==void 0);const t=this._editor.getModel(),i=this._editor.getPosition(),e=new kit(t,i,{...this._triggerState,refilter:!0});this._onNewContext(e)}trigger(t){var i,e,s,n,r,o;if(!this._editor.hasModel())return;const h=this._editor.getModel(),c=new kit(h,this._editor.getPosition(),t);this.cancel(t.retrigger),this._triggerState=t,this._onDidTrigger.fire({auto:t.auto,shy:(i=t.shy)!==null&&i!==void 0&&i,position:this._editor.getPosition()}),this._context=c;let l={triggerKind:(e=t.triggerKind)!==null&&e!==void 0?e:0};t.triggerCharacter&&(l={triggerKind:1,triggerCharacter:t.triggerCharacter}),this._requestToken=new ye;let a=1;switch(this._editor.getOption(112)){case"top":a=0;break;case"bottom":a=2}const{itemKind:u,showDeprecated:d}=vit.createSuggestFilter(this._editor),f=new wtt(a,(n=(s=t.completionOptions)===null||s===void 0?void 0:s.kindFilter)!==null&&n!==void 0?n:u,(r=t.completionOptions)===null||r===void 0?void 0:r.providerFilter,(o=t.completionOptions)===null||o===void 0?void 0:o.providerItemsToReuse,d),g=pit.create(this._editorWorkerService,this._editor),p=btt(this._languageFeaturesService.completionProvider,h,this._editor.getPosition(),f,l,this._requestToken.token);Promise.all([p,g]).then((async([i,e])=>{var s;if((s=this._requestToken)===null||s===void 0||s.dispose(),!this._editor.hasModel())return;let n=t==null?void 0:t.clipboardText;if(!n&&i.needsClipboard&&(n=await this._clipboardService.readText()),this._triggerState===void 0)return;const r=this._editor.getModel(),o=new kit(r,this._editor.getPosition(),t),h={...m_.default,firstMatchCanBeWeak:!this._editor.getOption(118).matchOnWordStartOnly};if(this._completionModel=new wit(i.items,this._context.column,{leadingLineContent:o.leadingLineContent,characterCountDelta:o.column-this._context.column},e,this._editor.getOption(118),this._editor.getOption(112),h,n),this._completionDisposables.add(i.disposable),this._onNewContext(o),this._reportDurationsTelemetry(i.durations),!this._envService.isBuilt||this._envService.isExtensionDevelopment)for(const t of i.items)t.isInvalid&&this._logService.warn(`[suggest] did IGNORE invalid completion item from ${t.provider._debugDisplayName}`,t.completion)})).catch(Ii)}_reportDurationsTelemetry(t){this._telemetryGate++%230==0&&setTimeout((()=>{this._telemetryService.publicLog2("suggest.durations.json",{data:JSON.stringify(t)}),this._logService.debug("suggest.durations.json",t)}))}static createSuggestFilter(t){const i=new Set;t.getOption(112)==="none"&&i.add(27);const e=t.getOption(118);return e.showMethods||i.add(0),e.showFunctions||i.add(1),e.showConstructors||i.add(2),e.showFields||i.add(3),e.showVariables||i.add(4),e.showClasses||i.add(5),e.showStructs||i.add(6),e.showInterfaces||i.add(7),e.showModules||i.add(8),e.showProperties||i.add(9),e.showEvents||i.add(10),e.showOperators||i.add(11),e.showUnits||i.add(12),e.showValues||i.add(13),e.showConstants||i.add(14),e.showEnums||i.add(15),e.showEnumMembers||i.add(16),e.showKeywords||i.add(17),e.showWords||i.add(18),e.showColors||i.add(19),e.showFiles||i.add(20),e.showReferences||i.add(21),e.showColors||i.add(22),e.showFolders||i.add(23),e.showTypeParameters||i.add(24),e.showSnippets||i.add(27),e.showUsers||i.add(25),e.showIssues||i.add(26),{itemKind:i,showDeprecated:e.showDeprecated}}_onNewContext(t){if(this._context)if(t.lineNumber===this._context.lineNumber)if(ir(t.leadingLineContent)===ir(this._context.leadingLineContent)){if(t.column<this._context.column)t.leadingWord.word?this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0}):this.cancel();else if(this._completionModel)if(t.leadingWord.word.length!==0&&t.leadingWord.startColumn>this._context.leadingWord.startColumn){if(kit.shouldAutoTrigger(this._editor)&&this._context){const t=this._completionModel.getItemsByProvider();this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0,clipboardText:this._completionModel.clipboardText,completionOptions:{providerItemsToReuse:t}})}}else if(t.column>this._context.column&&this._completionModel.getIncompleteProvider().size>0&&t.leadingWord.word.length!==0){const t=new Map,i=new Set;for(const[e,s]of this._completionModel.getItemsByProvider())s.length>0&&s[0].container.incomplete?i.add(e):t.set(e,s);this.trigger({auto:this._context.triggerOptions.auto,triggerKind:2,retrigger:!0,clipboardText:this._completionModel.clipboardText,completionOptions:{providerFilter:i,providerItemsToReuse:t}})}else{const i=this._completionModel.lineContext;let e=!1;if(this._completionModel.lineContext={leadingLineContent:t.leadingLineContent,characterCountDelta:t.column-this._context.column},this._completionModel.items.length===0){const s=kit.shouldAutoTrigger(this._editor);if(!this._context)return void this.cancel();if(s&&this._context.leadingWord.endColumn<t.leadingWord.startColumn)return void this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0});if(this._context.triggerOptions.auto)return void this.cancel();if(this._completionModel.lineContext=i,e=this._completionModel.items.length>0,e&&t.leadingWord.word.length===0)return void this.cancel()}this._onDidSuggest.fire({completionModel:this._completionModel,triggerOptions:t.triggerOptions,isFrozen:e})}}else this.cancel();else this.cancel()}};Cit=vit=bit([yit(1,JW),yit(2,AK),yit(3,ru),yit(4,ou),yit(5,Ra),yit(6,Md),yit(7,$p),yit(8,oO)],Cit);class Sit{constructor(t,i){this._disposables=new Ji,this._lastOvertyped=[],this._locked=!1,this._disposables.add(t.onWillType((()=>{if(this._locked||!t.hasModel())return;const i=t.getSelections(),e=i.length;let s=!1;for(let t=0;t<e;t++)if(!i[t].isEmpty()){s=!0;break}if(!s)return void(this._lastOvertyped.length!==0&&(this._lastOvertyped.length=0));this._lastOvertyped=[];const n=t.getModel();for(let t=0;t<e;t++){const e=i[t];if(n.getValueLengthInRange(e)>Sit._maxSelectionLength)return;this._lastOvertyped[t]={value:n.getValueInRange(e),multiline:e.startLineNumber!==e.endLineNumber}}}))),this._disposables.add(i.onDidTrigger((t=>{this._locked=!0}))),this._disposables.add(i.onDidCancel((t=>{this._locked=!1})))}getLastOvertypedInfo(t){if(t>=0&&t<this._lastOvertyped.length)return this._lastOvertyped[t]}dispose(){this._disposables.dispose()}}Sit._maxSelectionLength=51200;var xit=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Dit=function(t,i){return function(e,s){i(e,s,t)}};let Eit=class t extends xW{updateLabel(){const i=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!i)return super.updateLabel();this.label&&(this.label.textContent=tt(0,"{0} ({1})",this._action.label,t.symbolPrintEnter(i)))}static symbolPrintEnter(t){var i;return(i=t.getLabel())===null||i===void 0?void 0:i.replace(/\benter\b/gi,"⏎")}},Ait=class{constructor(t,i,e,s,n){this._menuId=i,this._menuService=s,this._contextKeyService=n,this._menuDisposables=new Ji,this.element=Yc(t,nl(".suggest-status-bar"));const r=t=>t instanceof eu?e.createInstance(Eit,t,void 0):void 0;this._leftActions=new LW(this.element,{actionViewItemProvider:r}),this._rightActions=new LW(this.element,{actionViewItemProvider:r}),this._leftActions.domNode.classList.add("left"),this._rightActions.domNode.classList.add("right")}dispose(){this._menuDisposables.dispose(),this._leftActions.dispose(),this._rightActions.dispose(),this.element.remove()}show(){const t=this._menuService.createMenu(this._menuId,this._contextKeyService),i=()=>{const i=[],e=[];for(const[s,n]of t.getActions())s==="left"?i.push(...n):e.push(...n);this._leftActions.clear(),this._leftActions.push(i),this._rightActions.clear(),this._rightActions.push(e)};this._menuDisposables.add(t.onDidChange((()=>i()))),this._menuDisposables.add(t)}hide(){this._menuDisposables.clear()}};Ait=xit([Dit(2,Il),Dit(3,Ya),Dit(4,Ra)],Ait);var Mit=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Lit=function(t,i){return function(e,s){i(e,s,t)}};function Fit(t){return!!t&&!!(t.completion.documentation||t.completion.detail&&t.completion.detail!==t.completion.label)}let Tit=class{constructor(t,i){this._editor=t,this._onDidClose=new le,this.onDidClose=this._onDidClose.event,this._onDidChangeContents=new le,this.onDidChangeContents=this._onDidChangeContents.event,this._disposables=new Ji,this._renderDisposeable=new Ji,this._borderWidth=1,this._size=new mc(330,0),this.domNode=nl(".suggest-details"),this.domNode.classList.add("no-docs"),this._markdownRenderer=i.createInstance(fP,{editor:t}),this._body=nl(".body"),this._scrollbar=new rC(this._body,{alwaysConsumeMouseWheel:!0}),Yc(this.domNode,this._scrollbar.getDomNode()),this._disposables.add(this._scrollbar),this._header=Yc(this._body,nl(".header")),this._close=Yc(this._header,nl("span"+Kl.asCSSSelector(As.close))),this._close.title=tt(0,"Close"),this._type=Yc(this._header,nl("p.type")),this._docs=Yc(this._body,nl("p.docs")),this._configureFont(),this._disposables.add(this._editor.onDidChangeConfiguration((t=>{t.hasChanged(50)&&this._configureFont()})))}dispose(){this._disposables.dispose(),this._renderDisposeable.dispose()}_configureFont(){const t=this._editor.getOptions(),i=t.get(50),e=i.getMassagedFontFamily(),s=t.get(119)||i.fontSize,n=t.get(120)||i.lineHeight,r=i.fontWeight,o=`${s}px`,h=`${n}px`;this.domNode.style.fontSize=o,this.domNode.style.lineHeight=""+n/s,this.domNode.style.fontWeight=r,this.domNode.style.fontFeatureSettings=i.fontFeatureSettings,this._type.style.fontFamily=e,this._close.style.height=h,this._close.style.width=h}getLayoutInfo(){const t=this._editor.getOption(120)||this._editor.getOption(50).lineHeight,i=this._borderWidth;return{lineHeight:t,borderWidth:i,borderHeight:2*i,verticalPadding:22,horizontalPadding:14}}renderLoading(){this._type.textContent=tt(0,"Loading..."),this._docs.textContent="",this.domNode.classList.remove("no-docs","no-type"),this.layout(this.size.width,2*this.getLayoutInfo().lineHeight),this._onDidChangeContents.fire(this)}renderItem(t,i){var e,s;this._renderDisposeable.clear();let{detail:n,documentation:r}=t.completion;if(i){let i="";i+=`score: ${t.score[0]}\n`,i+=`prefix: ${(e=t.word)!==null&&e!==void 0?e:"(no prefix)"}\n`,i+=`word: ${t.completion.filterText?t.completion.filterText+" (filterText)":t.textLabel}\n`,i+=`distance: ${t.distance} (localityBonus-setting)\n`,i+=`index: ${t.idx}, based on ${t.completion.sortText&&`sortText: "${t.completion.sortText}"`||"label"}\n`,i+=`commit_chars: ${(s=t.completion.commitCharacters)===null||s===void 0?void 0:s.join("")}\n`,r=(new F_).appendCodeblock("empty",i),n=`Provider: ${t.provider._debugDisplayName}`}if(i||Fit(t)){if(this.domNode.classList.remove("no-docs","no-type"),n){const t=n.length>1e5?`${n.substr(0,1e5)}…`:n;this._type.textContent=t,this._type.title=t,rl(this._type),this._type.classList.toggle("auto-wrap",!/\r?\n^\s+/gim.test(t))}else ic(this._type),this._type.title="",ol(this._type),this.domNode.classList.add("no-type");if(ic(this._docs),typeof r=="string")this._docs.classList.remove("markdown-docs"),this._docs.textContent=r;else if(r){this._docs.classList.add("markdown-docs"),ic(this._docs);const t=this._markdownRenderer.render(r);this._docs.appendChild(t.element),this._renderDisposeable.add(t),this._renderDisposeable.add(this._markdownRenderer.onDidRenderAsync((()=>{this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)})))}this.domNode.style.userSelect="text",this.domNode.tabIndex=-1,this._close.onmousedown=t=>{t.preventDefault(),t.stopPropagation()},this._close.onclick=t=>{t.preventDefault(),t.stopPropagation(),this._onDidClose.fire()},this._body.scrollTop=0,this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}else this.clearContents()}clearContents(){this.domNode.classList.add("no-docs"),this._type.textContent="",this._docs.textContent=""}get isEmpty(){return this.domNode.classList.contains("no-docs")}get size(){return this._size}layout(t,i){const e=new mc(t,i);mc.equals(e,this._size)||(this._size=e,function(t,i,e){typeof i=="number"&&(t.style.width=`${i}px`),typeof e=="number"&&(t.style.height=`${e}px`)}(this.domNode,t,i)),this._scrollbar.scanDomNode()}scrollDown(t=8){this._body.scrollTop+=t}scrollUp(t=8){this._body.scrollTop-=t}scrollTop(){this._body.scrollTop=0}scrollBottom(){this._body.scrollTop=this._body.scrollHeight}pageDown(){this.scrollDown(80)}pageUp(){this.scrollUp(80)}set borderWidth(t){this._borderWidth=t}get borderWidth(){return this._borderWidth}};Tit=Mit([Lit(1,Il)],Tit);class Rit{constructor(t,i){let e,s;this.widget=t,this._editor=i,this.allowEditorOverflow=!0,this._disposables=new Ji,this._added=!1,this._preferAlignAtTop=!0,this._resizable=new j5,this._resizable.domNode.classList.add("suggest-details-container"),this._resizable.domNode.appendChild(t.domNode),this._resizable.enableSashes(!1,!0,!0,!1);let n=0,r=0;this._disposables.add(this._resizable.onDidWillResize((()=>{e=this._topLeft,s=this._resizable.size}))),this._disposables.add(this._resizable.onDidResize((t=>{if(e&&s){this.widget.layout(t.dimension.width,t.dimension.height);let i=!1;t.west&&(r=s.width-t.dimension.width,i=!0),t.north&&(n=s.height-t.dimension.height,i=!0),i&&this._applyTopLeft({top:e.top+n,left:e.left+r})}t.done&&(e=void 0,s=void 0,n=0,r=0,this._userSize=t.dimension)}))),this._disposables.add(this.widget.onDidChangeContents((()=>{var t;this._anchorBox&&this._placeAtAnchor(this._anchorBox,(t=this._userSize)!==null&&t!==void 0?t:this.widget.size,this._preferAlignAtTop)})))}dispose(){this._resizable.dispose(),this._disposables.dispose(),this.hide()}getId(){return"suggest.details"}getDomNode(){return this._resizable.domNode}getPosition(){return this._topLeft?{preference:this._topLeft}:null}show(){this._added||(this._editor.addOverlayWidget(this),this._added=!0)}hide(t=!1){this._resizable.clearSashHoverState(),this._added&&(this._editor.removeOverlayWidget(this),this._added=!1,this._anchorBox=void 0,this._topLeft=void 0),t&&(this._userSize=void 0,this.widget.clearContents())}placeAtAnchor(t,i){var e;const s=t.getBoundingClientRect();this._anchorBox=s,this._preferAlignAtTop=i,this._placeAtAnchor(this._anchorBox,(e=this._userSize)!==null&&e!==void 0?e:this.widget.size,i)}_placeAtAnchor(t,i,e){var s;const n=gc(this.getDomNode().ownerDocument.body),r=this.widget.getLayoutInfo(),o=new mc(220,2*r.lineHeight),h=t.top,c=function(){const e=n.width-(t.left+t.width+r.borderWidth+r.horizontalPadding),s=-r.borderWidth+t.left+t.width,c=new mc(e,n.height-t.top-r.borderHeight-r.verticalPadding),l=c.with(void 0,t.top+t.height-r.borderHeight-r.verticalPadding);return{top:h,left:s,fit:e-i.width,maxSizeTop:c,maxSizeBottom:l,minSize:o.with(Math.min(e,o.width))}}(),l=function(){const e=t.left-r.borderWidth-r.horizontalPadding,s=Math.max(r.horizontalPadding,t.left-i.width-r.borderWidth),c=new mc(e,n.height-t.top-r.borderHeight-r.verticalPadding),l=c.with(void 0,t.top+t.height-r.borderHeight-r.verticalPadding);return{top:h,left:s,fit:e-i.width,maxSizeTop:c,maxSizeBottom:l,minSize:o.with(Math.min(e,o.width))}}(),a=function(){const e=t.left,s=-r.borderWidth+t.top+t.height,h=new mc(t.width-r.borderHeight,n.height-t.top-t.height-r.verticalPadding);return{top:s,left:e,fit:h.height-i.height,maxSizeBottom:h,maxSizeTop:h,minSize:o.with(h.width)}}(),u=[c,l,a],d=(s=u.find((t=>t.fit>=0)))!==null&&s!==void 0?s:u.sort(((t,i)=>i.fit-t.fit))[0],f=t.top+t.height-r.borderHeight;let g,p=i.height;const m=Math.max(d.maxSizeTop.height,d.maxSizeBottom.height);let w;p>m&&(p=m),e?p<=d.maxSizeTop.height?(g=!0,w=d.maxSizeTop):(g=!1,w=d.maxSizeBottom):p<=d.maxSizeBottom.height?(g=!1,w=d.maxSizeBottom):(g=!0,w=d.maxSizeTop);let{top:v,left:b}=d;!g&&p>t.height&&(v=f-p);const y=this._editor.getDomNode();if(y){const t=y.getBoundingClientRect();v-=t.top,b-=t.left}this._applyTopLeft({left:b,top:v}),this._resizable.enableSashes(!g,d===c,g,d!==c),this._resizable.minSize=d.minSize,this._resizable.maxSize=w,this._resizable.layout(p,Math.min(w.width,i.width)),this.widget.layout(this._resizable.size.width,this._resizable.size.height)}_applyTopLeft(t){this._topLeft=t,this._editor.layoutOverlayWidget(this)}}var Oit;(function(t){t[t.FILE=0]="FILE",t[t.FOLDER=1]="FOLDER",t[t.ROOT_FOLDER=2]="ROOT_FOLDER"})(Oit||(Oit={}));const Iit=/(?:\/|^)(?:([^\/]+)\/)?([^\/]+)$/;function _it(t,i,e,s,n){const r=s===Oit.ROOT_FOLDER?["rootfolder-icon"]:s===Oit.FOLDER?["folder-icon"]:["file-icon"];if(e){let n;if(e.scheme===Lh.data)n=RM.parseMetaData(e).get(RM.META_DATA_LABEL);else{const t=e.path.match(Iit);t?(n=Pit(t[2].toLowerCase()),t[1]&&r.push(`${Pit(t[1].toLowerCase())}-name-dir-icon`)):n=Pit(e.authority.toLowerCase())}if(s===Oit.ROOT_FOLDER)r.push(`${n}-root-name-folder-icon`);else if(s===Oit.FOLDER)r.push(`${n}-name-folder-icon`);else{if(n){if(r.push(`${n}-name-file-icon`),r.push("name-file-icon"),n.length<=255){const t=n.split(".");for(let i=1;i<t.length;i++)r.push(`${t.slice(i).join(".")}-ext-file-icon`)}r.push("ext-file-icon")}const s=function(t,i,e){if(!e)return null;let s=null;if(e.scheme===Lh.data){const t=RM.parseMetaData(e).get(RM.META_DATA_MIME);t&&(s=i.getLanguageIdByMimeType(t))}else{const i=t.getModel(e);i&&(s=i.getLanguageId())}return s&&s!==Yd?s:i.guessLanguageIdByFilepathOrFirstLine(e)}(t,i,e);s&&r.push(`${Pit(s)}-lang-file-icon`)}}return r}function Pit(t){return t.replace(/[\11\12\14\15\40]/g,"/")}var Nit,Bit=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},$it=function(t,i){return function(e,s){i(e,s,t)}};function Wit(t){return`suggest-aria-id:${t}`}const jit=qU("suggest-more-info",As.chevronRight,tt(0,"Icon for more information in the suggest widget.")),Hit=new(Nit=class{extract(t,i){if(t.textLabel.match(Nit._regexStrict))return i[0]=t.textLabel,!0;if(t.completion.detail&&t.completion.detail.match(Nit._regexStrict))return i[0]=t.completion.detail,!0;if(t.completion.documentation){const e=typeof t.completion.documentation=="string"?t.completion.documentation:t.completion.documentation.value,s=Nit._regexRelaxed.exec(e);if(s&&(s.index===0||s.index+s[0].length===e.length))return i[0]=s[0],!0}return!1}},Nit._regexRelaxed=/(#([\da-fA-F]{3}){1,2}|(rgb|hsl)a\(\s*(\d{1,3}%?\s*,\s*){3}(1|0?\.\d+)\)|(rgb|hsl)\(\s*\d{1,3}%?(\s*,\s*\d{1,3}%?){2}\s*\))/,Nit._regexStrict=new RegExp(`^${Nit._regexRelaxed.source}$`,"i"),Nit);let Vit=class{constructor(t,i,e,s){this._editor=t,this._modelService=i,this._languageService=e,this._themeService=s,this._onDidToggleDetails=new le,this.onDidToggleDetails=this._onDidToggleDetails.event,this.templateId="suggestion"}dispose(){this._onDidToggleDetails.dispose()}renderTemplate(t){const i=new Ji,e=t;e.classList.add("show-file-icons");const s=Yc(t,nl(".icon")),n=Yc(s,nl("span.colorspan")),r=Yc(t,nl(".contents")),o=Yc(r,nl(".main")),h=Yc(o,nl(".icon-label.codicon")),c=Yc(o,nl("span.left")),l=Yc(o,nl("span.right")),a=new Rz(c,{supportHighlights:!0,supportIcons:!0});i.add(a);const u=Yc(c,nl("span.signature-label")),d=Yc(c,nl("span.qualifier-label")),f=Yc(l,nl("span.details-label")),g=Yc(l,nl("span.readMore"+Kl.asCSSSelector(jit)));return g.title=tt(0,"Read More"),{root:e,left:c,right:l,icon:s,colorspan:n,iconLabel:a,iconContainer:h,parametersLabel:u,qualifierLabel:d,detailsLabel:f,readMore:g,disposables:i,configureFont:()=>{const t=this._editor.getOptions(),i=t.get(50),n=i.getMassagedFontFamily(),r=i.fontFeatureSettings,h=t.get(119)||i.fontSize,c=t.get(120)||i.lineHeight,l=i.fontWeight,a=`${h}px`,u=`${c}px`,d=`${i.letterSpacing}px`;e.style.fontSize=a,e.style.fontWeight=l,e.style.letterSpacing=d,o.style.fontFamily=n,o.style.fontFeatureSettings=r,o.style.lineHeight=u,s.style.height=u,s.style.width=u,g.style.height=u,g.style.width=u}}}renderElement(t,i,e){e.configureFont();const{completion:s}=t;e.root.id=Wit(i),e.colorspan.style.backgroundColor="";const n={labelEscapeNewLines:!0,matches:s_(t.score)},r=[];if(s.kind===19&&Hit.extract(t,r))e.icon.className="icon customcolor",e.iconContainer.className="icon hide",e.colorspan.style.backgroundColor=r[0];else if(s.kind===20&&this._themeService.getFileIconTheme().hasFileIcons){e.icon.className="icon hide",e.iconContainer.className="icon hide";const i=_it(this._modelService,this._languageService,as.from({scheme:"fake",path:t.textLabel}),Oit.FILE),r=_it(this._modelService,this._languageService,as.from({scheme:"fake",path:s.detail}),Oit.FILE);n.extraClasses=i.length>r.length?i:r}else s.kind===23&&this._themeService.getFileIconTheme().hasFolderIcons?(e.icon.className="icon hide",e.iconContainer.className="icon hide",n.extraClasses=[_it(this._modelService,this._languageService,as.from({scheme:"fake",path:t.textLabel}),Oit.FOLDER),_it(this._modelService,this._languageService,as.from({scheme:"fake",path:s.detail}),Oit.FOLDER)].flat()):(e.icon.className="icon hide",e.iconContainer.className="",e.iconContainer.classList.add("suggest-icon",...Kl.asClassNameArray(Rs.toIcon(s.kind))));s.tags&&s.tags.indexOf(1)>=0&&(n.extraClasses=(n.extraClasses||[]).concat(["deprecated"]),n.matches=[]),e.iconLabel.setLabel(t.textLabel,void 0,n),typeof s.label=="string"?(e.parametersLabel.textContent="",e.detailsLabel.textContent=zit(s.detail||""),e.root.classList.add("string-label")):(e.parametersLabel.textContent=zit(s.label.detail||""),e.detailsLabel.textContent=zit(s.label.description||""),e.root.classList.remove("string-label")),this._editor.getOption(118).showInlineDetails?rl(e.detailsLabel):ol(e.detailsLabel),Fit(t)?(e.right.classList.add("can-expand-details"),rl(e.readMore),e.readMore.onmousedown=t=>{t.stopPropagation(),t.preventDefault()},e.readMore.onclick=t=>{t.stopPropagation(),t.preventDefault(),this._onDidToggleDetails.fire()}):(e.right.classList.remove("can-expand-details"),ol(e.readMore),e.readMore.onmousedown=null,e.readMore.onclick=null)}disposeTemplate(t){t.disposables.dispose()}};function zit(t){return t.replace(/\r\n|\r|\n/g,"")}Vit=Bit([$it(1,Nl),$it(2,Id),$it(3,AC)],Vit);var Uit,Kit=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},qit=function(t,i){return function(e,s){i(e,s,t)}};Iw("editorSuggestWidget.background",{dark:rv,light:rv,hcDark:rv,hcLight:rv},tt(0,"Background color of the suggest widget.")),Iw("editorSuggestWidget.border",{dark:hv,light:hv,hcDark:hv,hcLight:hv},tt(0,"Border color of the suggest widget."));const Git=Iw("editorSuggestWidget.foreground",{dark:nv,light:nv,hcDark:nv,hcLight:nv},tt(0,"Foreground color of the suggest widget."));Iw("editorSuggestWidget.selectedForeground",{dark:_y,light:_y,hcDark:_y,hcLight:_y},tt(0,"Foreground color of the selected entry in the suggest widget.")),Iw("editorSuggestWidget.selectedIconForeground",{dark:Py,light:Py,hcDark:Py,hcLight:Py},tt(0,"Icon foreground color of the selected entry in the suggest widget."));const Zit=Iw("editorSuggestWidget.selectedBackground",{dark:Ny,light:Ny,hcDark:Ny,hcLight:Ny},tt(0,"Background color of the selected entry in the suggest widget."));Iw("editorSuggestWidget.highlightForeground",{dark:ly,light:ly,hcDark:ly,hcLight:ly},tt(0,"Color of the match highlights in the suggest widget.")),Iw("editorSuggestWidget.focusHighlightForeground",{dark:ay,light:ay,hcDark:ay,hcLight:ay},tt(0,"Color of the match highlights in the suggest widget when an item is focused.")),Iw("editorSuggestWidgetStatus.foreground",{dark:Nw(Git,.5),light:Nw(Git,.5),hcDark:Nw(Git,.5),hcLight:Nw(Git,.5)},tt(0,"Foreground color of the suggest widget status."));class Jit{constructor(t,i){this._service=t,this._key=`suggestWidget.size/${i.getEditorType()}/${i instanceof l4}`}restore(){var t;const i=(t=this._service.get(this._key,0))!==null&&t!==void 0?t:"";try{const t=JSON.parse(i);if(mc.is(t))return mc.lift(t)}catch{}}store(t){this._service.store(this._key,JSON.stringify(t),0,1)}reset(){this._service.remove(this._key,0)}}let Qit=Uit=class{constructor(t,i,e,s,n){this.editor=t,this._storageService=i,this._state=0,this._isAuto=!1,this._pendingLayout=new Yi,this._pendingShowDetails=new Yi,this._ignoreFocusEvents=!1,this._forceRenderingAbove=!1,this._explainMode=!1,this._showTimeout=new yo,this._disposables=new Ji,this._onDidSelect=new ue,this._onDidFocus=new ue,this._onDidHide=new le,this._onDidShow=new le,this.onDidSelect=this._onDidSelect.event,this.onDidFocus=this._onDidFocus.event,this.onDidHide=this._onDidHide.event,this.onDidShow=this._onDidShow.event,this._onDetailsKeydown=new le,this.onDetailsKeyDown=this._onDetailsKeydown.event,this.element=new j5,this.element.domNode.classList.add("editor-widget","suggest-widget"),this._contentWidget=new Yit(this,t),this._persistedSize=new Jit(i,t);class r{constructor(t,i,e=!1,s=!1){this.persistedSize=t,this.currentSize=i,this.persistHeight=e,this.persistWidth=s}}let o;this._disposables.add(this.element.onDidWillResize((()=>{this._contentWidget.lockPreference(),o=new r(this._persistedSize.restore(),this.element.size)}))),this._disposables.add(this.element.onDidResize((t=>{var i,e,s,n;if(this._resize(t.dimension.width,t.dimension.height),o&&(o.persistHeight=o.persistHeight||!!t.north||!!t.south,o.persistWidth=o.persistWidth||!!t.east||!!t.west),t.done){if(o){const{itemHeight:t,defaultSize:r}=this.getLayoutInfo(),h=Math.round(t/2);let{width:c,height:l}=this.element.size;(!o.persistHeight||Math.abs(o.currentSize.height-l)<=h)&&(l=(e=(i=o.persistedSize)===null||i===void 0?void 0:i.height)!==null&&e!==void 0?e:r.height),(!o.persistWidth||Math.abs(o.currentSize.width-c)<=h)&&(c=(n=(s=o.persistedSize)===null||s===void 0?void 0:s.width)!==null&&n!==void 0?n:r.width),this._persistedSize.store(new mc(c,l))}this._contentWidget.unlockPreference(),o=void 0}}))),this._messageElement=Yc(this.element.domNode,nl(".message")),this._listElement=Yc(this.element.domNode,nl(".tree"));const h=this._disposables.add(n.createInstance(Tit,this.editor));h.onDidClose(this.toggleDetails,this,this._disposables),this._details=new Rit(h,this.editor);const c=()=>this.element.domNode.classList.toggle("no-icons",!this.editor.getOption(118).showIcons);c();const l=n.createInstance(Vit,this.editor);this._disposables.add(l),this._disposables.add(l.onDidToggleDetails((()=>this.toggleDetails()))),this._list=new W$("SuggestWidget",this._listElement,{getHeight:t=>this.getLayoutInfo().itemHeight,getTemplateId:t=>"suggestion"},[l],{alwaysConsumeMouseWheel:!0,useShadows:!1,mouseSupport:!1,multipleSelectionSupport:!1,accessibilityProvider:{getRole:()=>"option",getWidgetAriaLabel:()=>tt(0,"Suggest"),getWidgetRole:()=>"listbox",getAriaLabel:t=>{let i=t.textLabel;if(typeof t.completion.label!="string"){const{detail:e,description:s}=t.completion.label;e&&s?i=tt(0,"{0} {1}, {2}",i,e,s):e?i=tt(0,"{0} {1}",i,e):s&&(i=tt(0,"{0}, {1}",i,s))}if(!t.isResolved||!this._isDetailsVisible())return i;const{documentation:e,detail:s}=t.completion;return tt(0,"{0}, docs: {1}",i,Kn("{0}{1}",s||"",e?typeof e=="string"?e:e.value:""))}}}),this._list.style(pW({listInactiveFocusBackground:Zit,listInactiveFocusOutline:Gw})),this._status=n.createInstance(Ait,this.element.domNode,ptt);const a=()=>this.element.domNode.classList.toggle("with-status-bar",this.editor.getOption(118).showStatusBar);a(),this._disposables.add(s.onDidColorThemeChange((t=>this._onThemeChange(t)))),this._onThemeChange(s.getColorTheme()),this._disposables.add(this._list.onMouseDown((t=>this._onListMouseDownOrTap(t)))),this._disposables.add(this._list.onTap((t=>this._onListMouseDownOrTap(t)))),this._disposables.add(this._list.onDidChangeSelection((t=>this._onListSelection(t)))),this._disposables.add(this._list.onDidChangeFocus((t=>this._onListFocus(t)))),this._disposables.add(this.editor.onDidChangeCursorSelection((()=>this._onCursorSelectionChanged()))),this._disposables.add(this.editor.onDidChangeConfiguration((t=>{t.hasChanged(118)&&(a(),c()),this._completionModel&&(t.hasChanged(50)||t.hasChanged(119)||t.hasChanged(120))&&this._list.splice(0,this._list.length,this._completionModel.items)}))),this._ctxSuggestWidgetVisible=gtt.Visible.bindTo(e),this._ctxSuggestWidgetDetailsVisible=gtt.DetailsVisible.bindTo(e),this._ctxSuggestWidgetMultipleSuggestions=gtt.MultipleSuggestions.bindTo(e),this._ctxSuggestWidgetHasFocusedSuggestion=gtt.HasFocusedSuggestion.bindTo(e),this._disposables.add(rc(this._details.widget.domNode,"keydown",(t=>{this._onDetailsKeydown.fire(t)}))),this._disposables.add(this.editor.onMouseDown((t=>this._onEditorMouseDown(t))))}dispose(){var t;this._details.widget.dispose(),this._details.dispose(),this._list.dispose(),this._status.dispose(),this._disposables.dispose(),(t=this._loadingTimeout)===null||t===void 0||t.dispose(),this._pendingLayout.dispose(),this._pendingShowDetails.dispose(),this._showTimeout.dispose(),this._contentWidget.dispose(),this.element.dispose()}_onEditorMouseDown(t){this._details.widget.domNode.contains(t.target.element)?this._details.widget.domNode.focus():this.element.domNode.contains(t.target.element)&&this.editor.focus()}_onCursorSelectionChanged(){this._state!==0&&this._contentWidget.layout()}_onListMouseDownOrTap(t){t.element!==void 0&&t.index!==void 0&&(t.browserEvent.preventDefault(),t.browserEvent.stopPropagation(),this._select(t.element,t.index))}_onListSelection(t){t.elements.length&&this._select(t.elements[0],t.indexes[0])}_select(t,i){const e=this._completionModel;e&&(this._onDidSelect.fire({item:t,index:i,model:e}),this.editor.focus())}_onThemeChange(t){this._details.widget.borderWidth=lk(t.type)?2:1}_onListFocus(t){var i;if(this._ignoreFocusEvents)return;if(!t.elements.length)return this._currentSuggestionDetails&&(this._currentSuggestionDetails.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=void 0),this.editor.setAriaOptions({activeDescendant:void 0}),void this._ctxSuggestWidgetHasFocusedSuggestion.set(!1);if(!this._completionModel)return;this._ctxSuggestWidgetHasFocusedSuggestion.set(!0);const e=t.elements[0],s=t.indexes[0];e!==this._focusedItem&&((i=this._currentSuggestionDetails)===null||i===void 0||i.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=e,this._list.reveal(s),this._currentSuggestionDetails=uo((async t=>{const i=vo((()=>{this._isDetailsVisible()&&this.showDetails(!0)}),250),s=t.onCancellationRequested((()=>i.dispose()));try{return await e.resolve(t)}finally{i.dispose(),s.dispose()}})),this._currentSuggestionDetails.then((()=>{s>=this._list.length||e!==this._list.element(s)||(this._ignoreFocusEvents=!0,this._list.splice(s,1,[e]),this._list.setFocus([s]),this._ignoreFocusEvents=!1,this._isDetailsVisible()?this.showDetails(!1):this.element.domNode.classList.remove("docs-side"),this.editor.setAriaOptions({activeDescendant:Wit(s)}))})).catch(Ii)),this._onDidFocus.fire({item:e,index:s,model:this._completionModel})}_setState(t){if(this._state!==t)switch(this._state=t,this.element.domNode.classList.toggle("frozen",t===4),this.element.domNode.classList.remove("message"),t){case 0:ol(this._messageElement,this._listElement,this._status.element),this._details.hide(!0),this._status.hide(),this._contentWidget.hide(),this._ctxSuggestWidgetVisible.reset(),this._ctxSuggestWidgetMultipleSuggestions.reset(),this._ctxSuggestWidgetHasFocusedSuggestion.reset(),this._showTimeout.cancel(),this.element.domNode.classList.remove("visible"),this._list.splice(0,this._list.length),this._focusedItem=void 0,this._cappedHeight=void 0,this._explainMode=!1;break;case 1:this.element.domNode.classList.add("message"),this._messageElement.textContent=Uit.LOADING_MESSAGE,ol(this._listElement,this._status.element),rl(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0,ow(Uit.LOADING_MESSAGE);break;case 2:this.element.domNode.classList.add("message"),this._messageElement.textContent=Uit.NO_SUGGESTIONS_MESSAGE,ol(this._listElement,this._status.element),rl(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0,ow(Uit.NO_SUGGESTIONS_MESSAGE);break;case 3:case 4:ol(this._messageElement),rl(this._listElement,this._status.element),this._show();break;case 5:ol(this._messageElement),rl(this._listElement,this._status.element),this._details.show(),this._show()}}_show(){this._status.show(),this._contentWidget.show(),this._layout(this._persistedSize.restore()),this._ctxSuggestWidgetVisible.set(!0),this._showTimeout.cancelAndSet((()=>{this.element.domNode.classList.add("visible"),this._onDidShow.fire(this)}),100)}showTriggered(t,i){this._state===0&&(this._contentWidget.setPosition(this.editor.getPosition()),this._isAuto=!!t,this._isAuto||(this._loadingTimeout=vo((()=>this._setState(1)),i)))}showSuggestions(t,i,e,s,n){var r,o;if(this._contentWidget.setPosition(this.editor.getPosition()),(r=this._loadingTimeout)===null||r===void 0||r.dispose(),(o=this._currentSuggestionDetails)===null||o===void 0||o.cancel(),this._currentSuggestionDetails=void 0,this._completionModel!==t&&(this._completionModel=t),e&&this._state!==2&&this._state!==0)return void this._setState(4);const h=this._completionModel.items.length,c=h===0;if(this._ctxSuggestWidgetMultipleSuggestions.set(h>1),c)return this._setState(s?0:2),void(this._completionModel=void 0);this._focusedItem=void 0,this._onDidFocus.pause(),this._onDidSelect.pause();try{this._list.splice(0,this._list.length,this._completionModel.items),this._setState(e?4:3),this._list.reveal(i,0),this._list.setFocus(n?[]:[i])}finally{this._onDidFocus.resume(),this._onDidSelect.resume()}this._pendingLayout.value=lc(Uh(this.element.domNode),(()=>{this._pendingLayout.clear(),this._layout(this.element.size),this._details.widget.domNode.classList.remove("focused")}))}focusSelected(){this._list.length>0&&this._list.setFocus([0])}selectNextPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageDown(),!0;case 1:return!this._isAuto;default:return this._list.focusNextPage(),!0}}selectNext(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusNext(1,!0),!0}}selectLast(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollBottom(),!0;case 1:return!this._isAuto;default:return this._list.focusLast(),!0}}selectPreviousPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageUp(),!0;case 1:return!this._isAuto;default:return this._list.focusPreviousPage(),!0}}selectPrevious(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusPrevious(1,!0),!1}}selectFirst(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollTop(),!0;case 1:return!this._isAuto;default:return this._list.focusFirst(),!0}}getFocusedItem(){if(this._state!==0&&this._state!==2&&this._state!==1&&this._completionModel&&this._list.getFocus().length>0)return{item:this._list.getFocusedElements()[0],index:this._list.getFocus()[0],model:this._completionModel}}toggleDetailsFocus(){this._state===5?(this._setState(3),this._details.widget.domNode.classList.remove("focused")):this._state===3&&this._isDetailsVisible()&&(this._setState(5),this._details.widget.domNode.classList.add("focused"))}toggleDetails(){this._isDetailsVisible()?(this._pendingShowDetails.clear(),this._ctxSuggestWidgetDetailsVisible.set(!1),this._setDetailsVisible(!1),this._details.hide(),this.element.domNode.classList.remove("shows-details")):!Fit(this._list.getFocusedElements()[0])&&!this._explainMode||this._state!==3&&this._state!==5&&this._state!==4||(this._ctxSuggestWidgetDetailsVisible.set(!0),this._setDetailsVisible(!0),this.showDetails(!1))}showDetails(t){this._pendingShowDetails.value=lc(Uh(this.element.domNode),(()=>{this._pendingShowDetails.clear(),this._details.show(),t?this._details.widget.renderLoading():this._details.widget.renderItem(this._list.getFocusedElements()[0],this._explainMode),this._details.widget.isEmpty?this._details.hide():(this._positionDetails(),this.element.domNode.classList.add("shows-details")),this.editor.focus()}))}toggleExplainMode(){this._list.getFocusedElements()[0]&&(this._explainMode=!this._explainMode,this._isDetailsVisible()?this.showDetails(!1):this.toggleDetails())}resetPersistedSize(){this._persistedSize.reset()}hideWidget(){var t;this._pendingLayout.clear(),this._pendingShowDetails.clear(),(t=this._loadingTimeout)===null||t===void 0||t.dispose(),this._setState(0),this._onDidHide.fire(this),this.element.clearSashHoverState();const i=this._persistedSize.restore(),e=Math.ceil(4.3*this.getLayoutInfo().itemHeight);i&&i.height<e&&this._persistedSize.store(i.with(void 0,e))}isFrozen(){return this._state===4}_afterRender(t){t!==null?this._state!==2&&this._state!==1&&(this._isDetailsVisible()&&!this._details.widget.isEmpty&&this._details.show(),this._positionDetails()):this._isDetailsVisible()&&this._details.hide()}_layout(t){var i,e,s;if(!this.editor.hasModel()||!this.editor.getDomNode())return;const n=gc(this.element.domNode.ownerDocument.body),r=this.getLayoutInfo();t||(t=r.defaultSize);let o=t.height,h=t.width;if(this._status.element.style.height=`${r.itemHeight}px`,this._state===2||this._state===1)o=r.itemHeight+r.borderHeight,h=r.defaultSize.width/2,this.element.enableSashes(!1,!1,!1,!1),this.element.minSize=this.element.maxSize=new mc(h,o),this._contentWidget.setPreference(2);else{const c=n.width-r.borderHeight-2*r.horizontalPadding;h>c&&(h=c);const l=this._completionModel?this._completionModel.stats.pLabelLen*r.typicalHalfwidthCharacterWidth:h,a=r.statusBarHeight+this._list.contentHeight+r.borderHeight,u=r.itemHeight+r.statusBarHeight,d=vc(this.editor.getDomNode()),f=this.editor.getScrolledVisiblePosition(this.editor.getPosition()),g=d.top+f.top+f.height,p=Math.min(n.height-g-r.verticalPadding,a),m=d.top+f.top-r.verticalPadding,w=Math.min(m,a);let v=Math.min(Math.max(w,p)+r.borderHeight,a);o===((i=this._cappedHeight)===null||i===void 0?void 0:i.capped)&&(o=this._cappedHeight.wanted),o<u&&(o=u),o>v&&(o=v),o>p||this._forceRenderingAbove&&m>150?(this._contentWidget.setPreference(1),this.element.enableSashes(!0,!0,!1,!1),v=w):(this._contentWidget.setPreference(2),this.element.enableSashes(!1,!0,!0,!1),v=p),this.element.preferredSize=new mc(l,r.defaultSize.height),this.element.maxSize=new mc(c,v),this.element.minSize=new mc(220,u),this._cappedHeight=o===a?{wanted:(s=(e=this._cappedHeight)===null||e===void 0?void 0:e.wanted)!==null&&s!==void 0?s:t.height,capped:o}:void 0}this._resize(h,o)}_resize(t,i){const{width:e,height:s}=this.element.maxSize;t=Math.min(e,t),i=Math.min(s,i);const{statusBarHeight:n}=this.getLayoutInfo();this._list.layout(i-n,t),this._listElement.style.height=i-n+"px",this.element.layout(i,t),this._contentWidget.layout(),this._positionDetails()}_positionDetails(){var t;this._isDetailsVisible()&&this._details.placeAtAnchor(this.element.domNode,((t=this._contentWidget.getPosition())===null||t===void 0?void 0:t.preference[0])===2)}getLayoutInfo(){const t=this.editor.getOption(50),i=sO(this.editor.getOption(120)||t.lineHeight,8,1e3),e=this.editor.getOption(118).showStatusBar&&this._state!==2&&this._state!==1?i:0,s=this._details.widget.borderWidth,n=2*s;return{itemHeight:i,statusBarHeight:e,borderWidth:s,borderHeight:n,typicalHalfwidthCharacterWidth:t.typicalHalfwidthCharacterWidth,verticalPadding:22,horizontalPadding:14,defaultSize:new mc(430,e+12*i+n)}}_isDetailsVisible(){return this._storageService.getBoolean("expandSuggestionDocs",0,!1)}_setDetailsVisible(t){this._storageService.store("expandSuggestionDocs",t,0,0)}forceRenderingAbove(){this._forceRenderingAbove||(this._forceRenderingAbove=!0,this._layout(this._persistedSize.restore()))}stopForceRenderingAbove(){this._forceRenderingAbove=!1}};Qit.LOADING_MESSAGE=tt(0,"Loading..."),Qit.NO_SUGGESTIONS_MESSAGE=tt(0,"No suggestions."),Qit=Uit=Kit([qit(1,nW),qit(2,Ra),qit(3,AC),qit(4,Il)],Qit);class Yit{constructor(t,i){this._widget=t,this._editor=i,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._preferenceLocked=!1,this._added=!1,this._hidden=!1}dispose(){this._added&&(this._added=!1,this._editor.removeContentWidget(this))}getId(){return"editor.widget.suggestWidget"}getDomNode(){return this._widget.element.domNode}show(){this._hidden=!1,this._added||(this._added=!0,this._editor.addContentWidget(this))}hide(){this._hidden||(this._hidden=!0,this.layout())}layout(){this._editor.layoutContentWidget(this)}getPosition(){return!this._hidden&&this._position&&this._preference?{position:this._position,preference:[this._preference]}:null}beforeRender(){const{height:t,width:i}=this._widget.element.size,{borderWidth:e,horizontalPadding:s}=this._widget.getLayoutInfo();return new mc(i+2*e+s,t+2*e)}afterRender(t){this._widget._afterRender(t)}setPreference(t){this._preferenceLocked||(this._preference=t)}lockPreference(){this._preferenceLocked=!0}unlockPreference(){this._preferenceLocked=!1}setPosition(t){this._position=t}}var Xit,tet=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},iet=function(t,i){return function(e,s){i(e,s,t)}};class eet{constructor(t,i){if(this._model=t,this._position=i,this._decorationOptions=xF.register({description:"suggest-line-suffix",stickiness:1}),t.getLineMaxColumn(i.lineNumber)!==i.column){const e=t.getOffsetAt(i),s=t.getPositionAt(e+1);t.changeDecorations((t=>{this._marker&&t.removeDecoration(this._marker),this._marker=t.addDecoration(Cs.fromPositions(i,s),this._decorationOptions)}))}}dispose(){this._marker&&!this._model.isDisposed()&&this._model.changeDecorations((t=>{t.removeDecoration(this._marker),this._marker=void 0}))}delta(t){if(this._model.isDisposed()||this._position.lineNumber!==t.lineNumber)return 0;if(this._marker){const i=this._model.getDecorationRange(this._marker);return this._model.getOffsetAt(i.getStartPosition())-this._model.getOffsetAt(t)}return this._model.getLineMaxColumn(t.lineNumber)-t.column}}let set=Xit=class{static get(t){return t.getContribution(Xit.ID)}constructor(t,i,e,s,n,r,o){this._memoryService=i,this._commandService=e,this._contextKeyService=s,this._instantiationService=n,this._logService=r,this._telemetryService=o,this._lineSuffix=new Yi,this._toDispose=new Ji,this._selectors=new net((t=>t.priority)),this._onWillInsertSuggestItem=new le,this.onWillInsertSuggestItem=this._onWillInsertSuggestItem.event,this.editor=t,this.model=n.createInstance(Cit,this.editor),this._selectors.register({priority:0,select:(t,i,e)=>this._memoryService.select(t,i,e)});const h=gtt.InsertMode.bindTo(s);h.set(t.getOption(118).insertMode),this._toDispose.add(this.model.onDidTrigger((()=>h.set(t.getOption(118).insertMode)))),this.widget=this._toDispose.add(new cc(Uh(t.getDomNode()),(()=>{const t=this._instantiationService.createInstance(Qit,this.editor);this._toDispose.add(t),this._toDispose.add(t.onDidSelect((t=>this._insertSuggestion(t,0)),this));const i=new fit(this.editor,t,this.model,(t=>this._insertSuggestion(t,2)));this._toDispose.add(i);const e=gtt.MakesTextEdit.bindTo(this._contextKeyService),s=gtt.HasInsertAndReplaceRange.bindTo(this._contextKeyService),n=gtt.CanResolve.bindTo(this._contextKeyService);return this._toDispose.add(Zi((()=>{e.reset(),s.reset(),n.reset()}))),this._toDispose.add(t.onDidFocus((({item:t})=>{const i=this.editor.getPosition(),r=t.editStart.column,o=i.column;let h=!0;this.editor.getOption(1)!=="smart"||this.model.state!==2||t.completion.additionalTextEdits||4&t.completion.insertTextRules||o-r!==t.completion.insertText.length||(h=this.editor.getModel().getValueInRange({startLineNumber:i.lineNumber,startColumn:r,endLineNumber:i.lineNumber,endColumn:o})!==t.completion.insertText),e.set(h),s.set(!ks.equals(t.editInsertEnd,t.editReplaceEnd)),n.set(!!t.provider.resolveCompletionItem||!!t.completion.documentation||t.completion.detail!==t.completion.label)}))),this._toDispose.add(t.onDetailsKeyDown((t=>{t.toKeyCodeChord().equals(new Qr(!0,!1,!1,!1,33))||bt&&t.toKeyCodeChord().equals(new Qr(!1,!1,!1,!0,33))?t.stopPropagation():t.toKeyCodeChord().isModifierKey()||this.editor.focus()}))),t}))),this._overtypingCapturer=this._toDispose.add(new cc(Uh(t.getDomNode()),(()=>this._toDispose.add(new Sit(this.editor,this.model))))),this._alternatives=this._toDispose.add(new cc(Uh(t.getDomNode()),(()=>this._toDispose.add(new dit(this.editor,this._contextKeyService))))),this._toDispose.add(n.createInstance(cit,t)),this._toDispose.add(this.model.onDidTrigger((t=>{this.widget.value.showTriggered(t.auto,t.shy?250:50),this._lineSuffix.value=new eet(this.editor.getModel(),t.position)}))),this._toDispose.add(this.model.onDidSuggest((t=>{if(t.triggerOptions.shy)return;let i=-1;for(const e of this._selectors.itemsOrderedByPriorityDesc)if(i=e.select(this.editor.getModel(),this.editor.getPosition(),t.completionModel.items),i!==-1)break;if(i===-1&&(i=0),this.model.state===0)return;let e=!1;if(t.triggerOptions.auto){const i=this.editor.getOption(118);i.selectionMode==="never"||i.selectionMode==="always"?e=i.selectionMode==="never":i.selectionMode==="whenTriggerCharacter"?e=t.triggerOptions.triggerKind!==1:i.selectionMode==="whenQuickSuggestion"&&(e=t.triggerOptions.triggerKind===1&&!t.triggerOptions.refilter)}this.widget.value.showSuggestions(t.completionModel,i,t.isFrozen,t.triggerOptions.auto,e)}))),this._toDispose.add(this.model.onDidCancel((t=>{t.retrigger||this.widget.value.hideWidget()}))),this._toDispose.add(this.editor.onDidBlurEditorWidget((()=>{this.model.cancel(),this.model.clear()})));const c=gtt.AcceptSuggestionsOnEnter.bindTo(s),l=()=>{const t=this.editor.getOption(1);c.set(t==="on"||t==="smart")};this._toDispose.add(this.editor.onDidChangeConfiguration((()=>l()))),l()}dispose(){this._alternatives.dispose(),this._toDispose.dispose(),this.widget.dispose(),this.model.dispose(),this._lineSuffix.dispose(),this._onWillInsertSuggestItem.dispose()}_insertSuggestion(t,i){if(!t||!t.item)return this._alternatives.value.reset(),this.model.cancel(),void this.model.clear();if(!this.editor.hasModel())return;const e=ztt.get(this.editor);if(!e)return;this._onWillInsertSuggestItem.fire({item:t.item});const s=this.editor.getModel(),n=s.getAlternativeVersionId(),{item:r}=t,o=[],h=new ye;1&i||this.editor.pushUndoStop();const c=this.getOverwriteInfo(r,!!(8&i));this._memoryService.memorize(s,this.editor.getPosition(),r);const l=r.isResolved;let a=-1,u=-1;if(Array.isArray(r.completion.additionalTextEdits)){this.model.cancel();const t=xq.capture(this.editor);this.editor.executeEdits("suggestController.additionalTextEdits.sync",r.completion.additionalTextEdits.map((t=>{let i=Cs.lift(t.range);if(i.startLineNumber===r.position.lineNumber&&i.startColumn>r.position.column){const t=this.editor.getPosition().column-r.position.column,e=t,s=Cs.spansMultipleLines(i)?0:t;i=new Cs(i.startLineNumber,i.startColumn+e,i.endLineNumber,i.endColumn+s)}return KP.replaceMove(i,t.text)}))),t.restoreRelativeVerticalPositionOfCursor(this.editor)}else if(!l){const t=new se;let e;const n=s.onDidChangeContent((t=>{if(t.isFlush)return h.cancel(),void n.dispose();for(const i of t.changes){const t=Cs.getEndPosition(i.range);e&&!ks.isBefore(t,e)||(e=t)}})),c=i;i|=2;let l=!1;const a=this.editor.onWillType((()=>{a.dispose(),l=!0,2&c||this.editor.pushUndoStop()}));o.push(r.resolve(h.token).then((()=>{if(!r.completion.additionalTextEdits||h.token.isCancellationRequested)return;if(e&&r.completion.additionalTextEdits.some((t=>ks.isBefore(e,Cs.getStartPosition(t.range)))))return!1;l&&this.editor.pushUndoStop();const t=xq.capture(this.editor);return this.editor.executeEdits("suggestController.additionalTextEdits.async",r.completion.additionalTextEdits.map((t=>KP.replaceMove(Cs.lift(t.range),t.text)))),t.restoreRelativeVerticalPositionOfCursor(this.editor),!l&&2&c||this.editor.pushUndoStop(),!0})).then((i=>{this._logService.trace("[suggest] async resolving of edits DONE (ms, applied?)",t.elapsed(),i),u=i===!0?1:i===!1?0:-2})).finally((()=>{n.dispose(),a.dispose()})))}let{insertText:d}=r.completion;if(4&r.completion.insertTextRules||(d=m0.escape(d)),this.model.cancel(),e.insert(d,{overwriteBefore:c.overwriteBefore,overwriteAfter:c.overwriteAfter,undoStopBefore:!1,undoStopAfter:!1,adjustWhitespace:!(1&r.completion.insertTextRules),clipboardText:t.model.clipboardText,overtypingCapturer:this._overtypingCapturer.value}),2&i||this.editor.pushUndoStop(),r.completion.command)if(r.completion.command.id===ret.id)this.model.trigger({auto:!0,retrigger:!0});else{const t=new se;o.push(this._commandService.executeCommand(r.completion.command.id,...r.completion.command.arguments?[...r.completion.command.arguments]:[]).catch((t=>{r.completion.extensionId?_i(t):Ii(t)})).finally((()=>{a=t.elapsed()})))}4&i&&this._alternatives.value.set(t,(t=>{for(h.cancel();s.canUndo();){n!==s.getAlternativeVersionId()&&s.undo(),this._insertSuggestion(t,3|(8&i?8:0));break}})),this._alertCompletionItem(r),Promise.all(o).finally((()=>{this._reportSuggestionAcceptedTelemetry(r,s,l,a,u),this.model.clear(),h.dispose()}))}_reportSuggestionAcceptedTelemetry(t,i,e,s,n){var r,o,h;Math.floor(100*Math.random())!==0&&this._telemetryService.publicLog2("suggest.acceptedSuggestion",{extensionId:(o=(r=t.extensionId)===null||r===void 0?void 0:r.value)!==null&&o!==void 0?o:"unknown",providerId:(h=t.provider._debugDisplayName)!==null&&h!==void 0?h:"unknown",kind:t.completion.kind,basenameHash:Ph(SM(i.uri)).toString(16),languageId:i.getLanguageId(),fileExtension:xM(i.uri),resolveInfo:t.provider.resolveCompletionItem?e?1:0:-1,resolveDuration:t.resolveDuration,commandDuration:s,additionalEditsAsync:n})}getOverwriteInfo(t,i){j(this.editor.hasModel());let e=this.editor.getOption(118).insertMode==="replace";i&&(e=!e);const s=t.position.column-t.editStart.column,n=(e?t.editReplaceEnd.column:t.editInsertEnd.column)-t.position.column;return{overwriteBefore:s+(this.editor.getPosition().column-t.position.column),overwriteAfter:n+(this._lineSuffix.value?this._lineSuffix.value.delta(this.editor.getPosition()):0)}}_alertCompletionItem(t){f(t.completion.additionalTextEdits)&&rw(tt(0,"Accepting '{0}' made {1} additional edits",t.textLabel,t.completion.additionalTextEdits.length))}triggerSuggest(t,i,e){this.editor.hasModel()&&(this.model.trigger({auto:i!=null&&i,completionOptions:{providerFilter:t,kindFilter:e?new Set:void 0}}),this.editor.revealPosition(this.editor.getPosition(),0),this.editor.focus())}triggerSuggestAndAcceptBest(t){if(!this.editor.hasModel())return;const i=this.editor.getPosition(),e=()=>{i.equals(this.editor.getPosition())&&this._commandService.executeCommand(t.fallback)},s=t=>{if(4&t.completion.insertTextRules||t.completion.additionalTextEdits)return!0;const i=this.editor.getPosition(),e=t.editStart.column,s=i.column;return s-e!==t.completion.insertText.length?!0:this.editor.getModel().getValueInRange({startLineNumber:i.lineNumber,startColumn:e,endLineNumber:i.lineNumber,endColumn:s})!==t.completion.insertText};ne.once(this.model.onDidTrigger)((t=>{const i=[];ne.any(this.model.onDidTrigger,this.model.onDidCancel)((()=>{qi(i),e()}),void 0,i),this.model.onDidSuggest((({completionModel:t})=>{if(qi(i),t.items.length===0)return void e();const n=this._memoryService.select(this.editor.getModel(),this.editor.getPosition(),t.items),r=t.items[n];s(r)?(this.editor.pushUndoStop(),this._insertSuggestion({index:n,item:r,model:t},7)):e()}),void 0,i)})),this.model.trigger({auto:!1,shy:!0}),this.editor.revealPosition(i,0),this.editor.focus()}acceptSelectedSuggestion(t,i){const e=this.widget.value.getFocusedItem();let s=0;t&&(s|=4),i&&(s|=8),this._insertSuggestion(e,s)}acceptNextSuggestion(){this._alternatives.value.next()}acceptPrevSuggestion(){this._alternatives.value.prev()}cancelSuggestWidget(){this.model.cancel(),this.model.clear(),this.widget.value.hideWidget()}focusSuggestion(){this.widget.value.focusSelected()}selectNextSuggestion(){this.widget.value.selectNext()}selectNextPageSuggestion(){this.widget.value.selectNextPage()}selectLastSuggestion(){this.widget.value.selectLast()}selectPrevSuggestion(){this.widget.value.selectPrevious()}selectPrevPageSuggestion(){this.widget.value.selectPreviousPage()}selectFirstSuggestion(){this.widget.value.selectFirst()}toggleSuggestionDetails(){this.widget.value.toggleDetails()}toggleExplainMode(){this.widget.value.toggleExplainMode()}toggleSuggestionFocus(){this.widget.value.toggleDetailsFocus()}resetWidgetSize(){this.widget.value.resetPersistedSize()}forceRenderingAbove(){this.widget.value.forceRenderingAbove()}stopForceRenderingAbove(){this.widget.isInitialized&&this.widget.value.stopForceRenderingAbove()}registerSelector(t){return this._selectors.register(t)}};set.ID="editor.contrib.suggestController",set=Xit=tet([iet(1,nit),iet(2,ql),iet(3,Ra),iet(4,Il),iet(5,ou),iet(6,ru)],set);class net{constructor(t){this.prioritySelector=t,this._items=new Array}register(t){if(this._items.indexOf(t)!==-1)throw new Error("Value is already registered");return this._items.push(t),this._items.sort(((t,i)=>this.prioritySelector(i)-this.prioritySelector(t))),{dispose:()=>{const i=this._items.indexOf(t);i>=0&&this._items.splice(i,1)}}}get itemsOrderedByPriorityDesc(){return this._items}}class ret extends mu{constructor(){super({id:ret.id,label:tt(0,"Trigger Suggest"),alias:"Trigger Suggest",precondition:ua.and(Ox.writable,Ox.hasCompletionItemProvider,gtt.Visible.toNegated()),kbOpts:{kbExpr:Ox.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[521,2087]},weight:100}})}run(t,i,e){const s=set.get(i);if(!s)return;let n;e&&typeof e=="object"&&e.auto===!0&&(n=!0),s.triggerSuggest(void 0,n,void 0)}}ret.id="editor.action.triggerSuggest",Su(set.ID,set,2),ku(ret);const oet=190,het=pu.bindToContribution(set.get);yu(new het({id:"acceptSelectedSuggestion",precondition:ua.and(gtt.Visible,gtt.HasFocusedSuggestion),handler(t){t.acceptSelectedSuggestion(!0,!1)},kbOpts:[{primary:2,kbExpr:ua.and(gtt.Visible,Ox.textInputFocus),weight:oet},{primary:3,kbExpr:ua.and(gtt.Visible,Ox.textInputFocus,gtt.AcceptSuggestionsOnEnter,gtt.MakesTextEdit),weight:oet}],menuOpts:[{menuId:ptt,title:tt(0,"Insert"),group:"left",order:1,when:gtt.HasInsertAndReplaceRange.toNegated()},{menuId:ptt,title:tt(0,"Insert"),group:"left",order:1,when:ua.and(gtt.HasInsertAndReplaceRange,gtt.InsertMode.isEqualTo("insert"))},{menuId:ptt,title:tt(0,"Replace"),group:"left",order:1,when:ua.and(gtt.HasInsertAndReplaceRange,gtt.InsertMode.isEqualTo("replace"))}]})),yu(new het({id:"acceptAlternativeSelectedSuggestion",precondition:ua.and(gtt.Visible,Ox.textInputFocus,gtt.HasFocusedSuggestion),kbOpts:{weight:oet,kbExpr:Ox.textInputFocus,primary:1027,secondary:[1026]},handler(t){t.acceptSelectedSuggestion(!1,!0)},menuOpts:[{menuId:ptt,group:"left",order:2,when:ua.and(gtt.HasInsertAndReplaceRange,gtt.InsertMode.isEqualTo("insert")),title:tt(0,"Replace")},{menuId:ptt,group:"left",order:2,when:ua.and(gtt.HasInsertAndReplaceRange,gtt.InsertMode.isEqualTo("replace")),title:tt(0,"Insert")}]})),Gl.registerCommandAlias("acceptSelectedSuggestionOnEnter","acceptSelectedSuggestion"),yu(new het({id:"hideSuggestWidget",precondition:gtt.Visible,handler:t=>t.cancelSuggestWidget(),kbOpts:{weight:oet,kbExpr:Ox.textInputFocus,primary:9,secondary:[1033]}})),yu(new het({id:"selectNextSuggestion",precondition:ua.and(gtt.Visible,ua.or(gtt.MultipleSuggestions,gtt.HasFocusedSuggestion.negate())),handler:t=>t.selectNextSuggestion(),kbOpts:{weight:oet,kbExpr:Ox.textInputFocus,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}})),yu(new het({id:"selectNextPageSuggestion",precondition:ua.and(gtt.Visible,ua.or(gtt.MultipleSuggestions,gtt.HasFocusedSuggestion.negate())),handler:t=>t.selectNextPageSuggestion(),kbOpts:{weight:oet,kbExpr:Ox.textInputFocus,primary:12,secondary:[2060]}})),yu(new het({id:"selectLastSuggestion",precondition:ua.and(gtt.Visible,ua.or(gtt.MultipleSuggestions,gtt.HasFocusedSuggestion.negate())),handler:t=>t.selectLastSuggestion()})),yu(new het({id:"selectPrevSuggestion",precondition:ua.and(gtt.Visible,ua.or(gtt.MultipleSuggestions,gtt.HasFocusedSuggestion.negate())),handler:t=>t.selectPrevSuggestion(),kbOpts:{weight:oet,kbExpr:Ox.textInputFocus,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}})),yu(new het({id:"selectPrevPageSuggestion",precondition:ua.and(gtt.Visible,ua.or(gtt.MultipleSuggestions,gtt.HasFocusedSuggestion.negate())),handler:t=>t.selectPrevPageSuggestion(),kbOpts:{weight:oet,kbExpr:Ox.textInputFocus,primary:11,secondary:[2059]}})),yu(new het({id:"selectFirstSuggestion",precondition:ua.and(gtt.Visible,ua.or(gtt.MultipleSuggestions,gtt.HasFocusedSuggestion.negate())),handler:t=>t.selectFirstSuggestion()})),yu(new het({id:"focusSuggestion",precondition:ua.and(gtt.Visible,gtt.HasFocusedSuggestion.negate()),handler:t=>t.focusSuggestion(),kbOpts:{weight:oet,kbExpr:Ox.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}}})),yu(new het({id:"focusAndAcceptSuggestion",precondition:ua.and(gtt.Visible,gtt.HasFocusedSuggestion.negate()),handler:t=>{t.focusSuggestion(),t.acceptSelectedSuggestion(!0,!1)}})),yu(new het({id:"toggleSuggestionDetails",precondition:ua.and(gtt.Visible,gtt.HasFocusedSuggestion),handler:t=>t.toggleSuggestionDetails(),kbOpts:{weight:oet,kbExpr:Ox.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}},menuOpts:[{menuId:ptt,group:"right",order:1,when:ua.and(gtt.DetailsVisible,gtt.CanResolve),title:tt(0,"show less")},{menuId:ptt,group:"right",order:1,when:ua.and(gtt.DetailsVisible.toNegated(),gtt.CanResolve),title:tt(0,"show more")}]})),yu(new het({id:"toggleExplainMode",precondition:gtt.Visible,handler:t=>t.toggleExplainMode(),kbOpts:{weight:100,primary:2138}})),yu(new het({id:"toggleSuggestionFocus",precondition:gtt.Visible,handler:t=>t.toggleSuggestionFocus(),kbOpts:{weight:oet,kbExpr:Ox.textInputFocus,primary:2570,mac:{primary:778}}})),yu(new het({id:"insertBestCompletion",precondition:ua.and(Ox.textInputFocus,ua.equals("config.editor.tabCompletion","on"),cit.AtEnd,gtt.Visible.toNegated(),dit.OtherSuggestions.toNegated(),ztt.InSnippetMode.toNegated()),handler:(t,i)=>{t.triggerSuggestAndAcceptBest(O(i)?{fallback:"tab",...i}:{fallback:"tab"})},kbOpts:{weight:oet,primary:2}})),yu(new het({id:"insertNextSuggestion",precondition:ua.and(Ox.textInputFocus,ua.equals("config.editor.tabCompletion","on"),dit.OtherSuggestions,gtt.Visible.toNegated(),ztt.InSnippetMode.toNegated()),handler:t=>t.acceptNextSuggestion(),kbOpts:{weight:oet,kbExpr:Ox.textInputFocus,primary:2}})),yu(new het({id:"insertPrevSuggestion",precondition:ua.and(Ox.textInputFocus,ua.equals("config.editor.tabCompletion","on"),dit.OtherSuggestions,gtt.Visible.toNegated(),ztt.InSnippetMode.toNegated()),handler:t=>t.acceptPrevSuggestion(),kbOpts:{weight:oet,kbExpr:Ox.textInputFocus,primary:1026}})),ku(class extends mu{constructor(){super({id:"editor.action.resetSuggestSize",label:tt(0,"Reset Suggest Widget Size"),alias:"Reset Suggest Widget Size",precondition:void 0})}run(t,i){var e;(e=set.get(i))===null||e===void 0||e.resetWidgetSize()}});class cet extends Qi{get selectedItem(){return this._selectedItem}constructor(t,i,e,s){super(),this.editor=t,this.suggestControllerPreselector=i,this.checkModelVersion=e,this.onWillAccept=s,this.isSuggestWidgetVisible=!1,this.isShiftKeyPressed=!1,this._isActive=!1,this._currentSuggestItemInfo=void 0,this._selectedItem=$B(this,void 0),this._register(t.onKeyDown((t=>{t.shiftKey&&!this.isShiftKeyPressed&&(this.isShiftKeyPressed=!0,this.update(this._isActive))}))),this._register(t.onKeyUp((t=>{t.shiftKey&&this.isShiftKeyPressed&&(this.isShiftKeyPressed=!1,this.update(this._isActive))})));const n=set.get(this.editor);if(n){this._register(n.registerSelector({priority:100,select:(t,i,e)=>{_B((t=>this.checkModelVersion(t)));const s=this.editor.getModel();if(!s)return-1;const r=this.suggestControllerPreselector(),o=r?ttt(r,s):void 0;if(!o)return-1;const h=ks.lift(i),c=Dg(e.map(((t,i)=>{const e=ttt(aet.fromSuggestion(n,s,h,t,this.isShiftKeyPressed).toSingleTextEdit(),s);return{index:i,valid:itt(o,e),prefixLength:e.text.length,suggestItem:t}})).filter((t=>t&&t.valid&&t.prefixLength>0)),D((t=>t.prefixLength),E));return c?c.index:-1}}));let t=!1;const i=()=>{t||(t=!0,this._register(n.widget.value.onDidShow((()=>{this.isSuggestWidgetVisible=!0,this.update(!0)}))),this._register(n.widget.value.onDidHide((()=>{this.isSuggestWidgetVisible=!1,this.update(!1)}))),this._register(n.widget.value.onDidFocus((()=>{this.isSuggestWidgetVisible=!0,this.update(!0)}))))};this._register(ne.once(n.model.onDidTrigger)((t=>{i()}))),this._register(n.onWillInsertSuggestItem((t=>{const i=this.editor.getPosition(),e=this.editor.getModel();if(!i||!e)return;const s=aet.fromSuggestion(n,e,i,t.item,this.isShiftKeyPressed);this.onWillAccept(s)})))}this.update(this._isActive)}update(t){const i=this.getSuggestItemInfo();this._isActive===t&&function(t,i){return t===i?!0:!t||!i?!1:t.equals(i)}(this._currentSuggestItemInfo,i)||(this._isActive=t,this._currentSuggestItemInfo=i,_B((t=>{this.checkModelVersion(t),this._selectedItem.set(this._isActive?this._currentSuggestItemInfo:void 0,t)})))}getSuggestItemInfo(){const t=set.get(this.editor);if(!t||!this.isSuggestWidgetVisible)return;const i=t.widget.value.getFocusedItem(),e=this.editor.getPosition(),s=this.editor.getModel();return i&&e&&s?aet.fromSuggestion(t,s,e,i.item,this.isShiftKeyPressed):void 0}stopForceRenderingAbove(){const t=set.get(this.editor);t==null||t.stopForceRenderingAbove()}forceRenderingAbove(){const t=set.get(this.editor);t==null||t.forceRenderingAbove()}}class aet{static fromSuggestion(t,i,e,s,n){let{insertText:r}=s.completion,o=!1;if(4&s.completion.insertTextRules){const t=(new m0).parse(r);t.children.length<100&&$tt.adjustWhitespace(i,e,!0,t),r=t.toString(),o=!0}const h=t.getOverwriteInfo(s,n);return new aet(Cs.fromPositions(e.delta(0,-h.overwriteBefore),e.delta(0,Math.max(h.overwriteAfter,0))),r,s.completion.kind,o)}constructor(t,i,e,s){this.range=t,this.insertText=i,this.completionItemKind=e,this.isSnippetText=s}equals(t){return this.range.equalsRange(t.range)&&this.insertText===t.insertText&&this.completionItemKind===t.completionItemKind&&this.isSnippetText===t.isSnippetText}toSelectedSuggestionInfo(){return new Ns(this.range,this.insertText,this.completionItemKind,this.isSnippetText)}toSingleTextEdit(){return new gZ(this.range,this.insertText)}}var uet,det=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},fet=function(t,i){return function(e,s){i(e,s,t)}};let get=uet=class extends Qi{static get(t){return t.getContribution(uet.ID)}constructor(t,i,e,s,n,r,o,h,c){super(),this.editor=t,this._instantiationService=i,this._contextKeyService=e,this._configurationService=s,this._commandService=n,this._debounceService=r,this._languageFeaturesService=o,this._accessibilitySignalService=h,this._keybindingService=c,this.model=this._register(jB("inlineCompletionModel",void 0)),this._textModelVersionId=$B(this,-1),this._positions=$B(this,[new ks(1,1)]),this._suggestWidgetAdaptor=this._register(new cet(this.editor,(()=>{var t,i;return(i=(t=this.model.get())===null||t===void 0?void 0:t.selectedInlineCompletion.get())===null||i===void 0?void 0:i.toSingleTextEdit(void 0)}),(t=>this.updateObservables(t,Ktt.Other)),(t=>{_B((i=>{var e;this.updateObservables(i,Ktt.Other),(e=this.model.get())===null||e===void 0||e.handleSuggestAccepted(t)}))}))),this._enabled=e$(this.editor.onDidChangeConfiguration,(()=>this.editor.getOption(62).enabled)),this._fontFamily=e$(this.editor.onDidChangeConfiguration,(()=>this.editor.getOption(62).fontFamily)),this._ghostTexts=zB(this,(t=>{var i;const e=this.model.read(t);return(i=e==null?void 0:e.ghostTexts.read(t))!==null&&i!==void 0?i:[]})),this._stablizedGhostTexts=function(t,i){const e=$B("result",[]),s=[];return i.add(ZB((i=>{const n=t.read(i);_B((t=>{if(n.length!==s.length){s.length=n.length;for(let t=0;t<s.length;t++)s[t]||(s[t]=$B("item",n[t]));e.set([...s],t)}s.forEach(((i,e)=>i.set(n[e],t)))}))}))),e}(this._ghostTexts,this._store),this._ghostTextWidgets=function(t,i,e,s){let n=new a$(e,s);return UB({debugReferenceFn:e,owner:t,onLastObserverRemoved:()=>{n.dispose(),n=new a$(e)}},(t=>(n.setItems(i.read(t)),n.getItems())))}(this,this._stablizedGhostTexts,((t,i)=>i.add(this._instantiationService.createInstance(U8,this.editor,{ghostText:t,minReservedLineCount:t$(0),targetTextModel:this.model.map((t=>t==null?void 0:t.textModel))})))).recomputeInitiallyAndOnChange(this._store),this._debounceValue=this._debounceService.for(this._languageFeaturesService.inlineCompletionsProvider,"InlineCompletionsDebounce",{min:50,max:50}),this._playAccessibilitySignal=o$(this),this._isReadonly=e$(this.editor.onDidChangeConfiguration,(()=>this.editor.getOption(91))),this._textModel=e$(this.editor.onDidChangeModel,(()=>this.editor.getModel())),this._textModelIfWritable=zB((t=>this._isReadonly.read(t)?void 0:this._textModel.read(t))),this._register(new R8(this._contextKeyService,this.model)),this._register(ZB((e=>{const s=this._textModelIfWritable.read(e);_B((e=>{if(this.model.set(void 0,e),this.updateObservables(e,Ktt.Other),s){const n=i.createInstance(Ztt,s,this._suggestWidgetAdaptor.selectedItem,this._textModelVersionId,this._positions,this._debounceValue,e$(t.onDidChangeConfiguration,(()=>t.getOption(118).preview)),e$(t.onDidChangeConfiguration,(()=>t.getOption(118).previewMode)),e$(t.onDidChangeConfiguration,(()=>t.getOption(62).mode)),this._enabled);this.model.set(n,e)}}))})));const l=this._register(Ic());this._register(ZB((t=>{const i=this._fontFamily.read(t);l.setStyle(i===""||i==="default"?"":`\n.monaco-editor .ghost-text-decoration,\n.monaco-editor .ghost-text-decoration-preview,\n.monaco-editor .ghost-text {\n\tfont-family: ${i};\n}`)})));const a=t=>{var i;return t.isUndoing?Ktt.Undo:t.isRedoing?Ktt.Redo:!((i=this.model.get())===null||i===void 0)&&i.isAcceptingPartially?Ktt.AcceptWord:Ktt.Other};let u;this._register(t.onDidChangeModelContent((t=>_B((i=>this.updateObservables(i,a(t))))))),this._register(t.onDidChangeCursorPosition((t=>_B((i=>{var e;this.updateObservables(i,Ktt.Other),t.reason!==3&&t.source!=="api"||(e=this.model.get())===null||e===void 0||e.stop(i)}))))),this._register(t.onDidType((()=>_B((t=>{var i;this.updateObservables(t,Ktt.Other),this._enabled.get()&&((i=this.model.get())===null||i===void 0||i.trigger(t))}))))),this._register(this._commandService.onDidExecuteCommand((i=>{new Set([Hx.Tab.id,Hx.DeleteLeft.id,Hx.DeleteRight.id,Z3,"acceptSelectedSuggestion"]).has(i.commandId)&&t.hasTextFocus()&&this._enabled.get()&&_B((t=>{var i;(i=this.model.get())===null||i===void 0||i.trigger(t)}))}))),this._register(this.editor.onDidBlurEditorWidget((()=>{this._contextKeyService.getContextKeyValue("accessibleViewIsShown")||this._configurationService.getValue("editor.inlineSuggest.keepOnBlur")||t.getOption(62).keepOnBlur||n6.dropDownVisible||_B((t=>{var i;(i=this.model.get())===null||i===void 0||i.stop(t)}))}))),this._register(ZB((t=>{var i;const e=(i=this.model.read(t))===null||i===void 0?void 0:i.state.read(t);e!=null&&e.suggestItem?e.primaryGhostText.lineCount>=2&&this._suggestWidgetAdaptor.forceRenderingAbove():this._suggestWidgetAdaptor.stopForceRenderingAbove()}))),this._register(Zi((()=>{this._suggestWidgetAdaptor.stopForceRenderingAbove()}))),this._register(QB({handleChange:(t,i)=>(t.didChange(this._playAccessibilitySignal)&&(u=void 0),!0)},(async t=>{this._playAccessibilitySignal.read(t);const i=this.model.read(t),e=i==null?void 0:i.state.read(t);if(i&&e&&e.inlineCompletion){if(e.inlineCompletion.semanticId!==u){u=e.inlineCompletion.semanticId;const t=i.textModel.getLineContent(e.primaryGhostText.lineNumber);this._accessibilitySignalService.playSignal(tq.inlineSuggestion).then((()=>{this.editor.getOption(8)&&this.provideScreenReaderUpdate(e.primaryGhostText.renderForScreenReader(t))}))}}else u=void 0}))),this._register(new i6(this.editor,this.model,this._instantiationService)),this._register(this._configurationService.onDidChangeConfiguration((t=>{t.affectsConfiguration("accessibility.verbosity.inlineCompletions")&&this.editor.updateOptions({inlineCompletionsAccessibilityVerbose:this._configurationService.getValue("accessibility.verbosity.inlineCompletions")})}))),this.editor.updateOptions({inlineCompletionsAccessibilityVerbose:this._configurationService.getValue("accessibility.verbosity.inlineCompletions")})}playAccessibilitySignal(t){this._playAccessibilitySignal.trigger(t)}provideScreenReaderUpdate(t){const i=this._contextKeyService.getContextKeyValue("accessibleViewIsShown"),e=this._keybindingService.lookupKeybinding("editor.action.accessibleView");let s;!i&&e&&this.editor.getOption(149)&&(s=tt(0,"Inspect this in the accessible view ({0})",e.getAriaLabel())),rw(s?t+", "+s:t)}updateObservables(t,i){var e,s,n;const r=this.editor.getModel();this._textModelVersionId.set((e=r==null?void 0:r.getVersionId())!==null&&e!==void 0?e:-1,t,i),this._positions.set((n=(s=this.editor.getSelections())===null||s===void 0?void 0:s.map((t=>t.getPosition())))!==null&&n!==void 0?n:[new ks(1,1)],t)}shouldShowHoverAt(t){var i;const e=(i=this.model.get())===null||i===void 0?void 0:i.primaryGhostText.get();return!!e&&e.parts.some((i=>t.containsPosition(new ks(e.lineNumber,i.column))))}shouldShowHoverAtViewZone(t){var i,e;return(e=(i=this._ghostTextWidgets.get()[0])===null||i===void 0?void 0:i.ownsViewZone(t))!==null&&e!==void 0&&e}};get.ID="editor.contrib.inlineCompletionsController",get=uet=det([fet(1,Il),fet(2,Ra),fet(3,Md),fet(4,ql),fet(5,lO),fet(6,$p),fet(7,QK),fet(8,NS)],get);class pet extends mu{constructor(){super({id:pet.ID,label:tt(0,"Show Next Inline Suggestion"),alias:"Show Next Inline Suggestion",precondition:ua.and(Ox.writable,R8.inlineSuggestionVisible),kbOpts:{weight:100,primary:606}})}async run(t,i){var e;const s=get.get(i);(e=s==null?void 0:s.model.get())===null||e===void 0||e.next()}}pet.ID=Q3;class met extends mu{constructor(){super({id:met.ID,label:tt(0,"Show Previous Inline Suggestion"),alias:"Show Previous Inline Suggestion",precondition:ua.and(Ox.writable,R8.inlineSuggestionVisible),kbOpts:{weight:100,primary:604}})}async run(t,i){var e;const s=get.get(i);(e=s==null?void 0:s.model.get())===null||e===void 0||e.previous()}}met.ID=J3;class wet extends mu{constructor(){super({id:wet.ID,label:tt(0,"Hide Inline Suggestion"),alias:"Hide Inline Suggestion",precondition:R8.inlineSuggestionVisible,kbOpts:{weight:100,primary:9}})}async run(t,i){const e=get.get(i);_B((t=>{var i;(i=e==null?void 0:e.model.get())===null||i===void 0||i.stop(t)}))}}wet.ID="editor.action.inlineSuggest.hide";class vet extends su{constructor(){super({id:vet.ID,title:tt(0,"Always Show Toolbar"),f1:!1,precondition:void 0,menu:[{id:Qa.InlineSuggestionToolbar,group:"secondary",order:10}],toggled:ua.equals("config.editor.inlineSuggest.showToolbar","always")})}async run(t,i){const e=t.get(Md),s=e.getValue("editor.inlineSuggest.showToolbar")==="always"?"onHover":"always";e.updateValue("editor.inlineSuggest.showToolbar",s)}}vet.ID="editor.action.inlineSuggest.toggleAlwaysShowToolbar";var bet=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},yet=function(t,i){return function(e,s){i(e,s,t)}};class ket{constructor(t,i,e){this.owner=t,this.range=i,this.controller=e}isValidForHoverAnchor(t){return t.type===1&&this.range.startColumn<=t.range.startColumn&&this.range.endColumn>=t.range.endColumn}}let Cet=class{constructor(t,i,e,s,n,r){this._editor=t,this._languageService=i,this._openerService=e,this.accessibilityService=s,this._instantiationService=n,this._telemetryService=r,this.hoverOrdinal=4}suggestHoverAnchor(t){const i=get.get(this._editor);if(!i)return null;const e=t.target;if(e.type===8){const s=e.detail;if(i.shouldShowHoverAtViewZone(s.viewZoneId))return new $5(1e3,this,Cs.fromPositions(this._editor.getModel().validatePosition(s.positionBefore||s.position)),t.event.posx,t.event.posy,!1)}return e.type===7&&i.shouldShowHoverAt(e.range)?new $5(1e3,this,e.range,t.event.posx,t.event.posy,!1):e.type===6&&e.detail.mightBeForeignElement&&i.shouldShowHoverAt(e.range)?new $5(1e3,this,e.range,t.event.posx,t.event.posy,!1):null}computeSync(t,i){if(this._editor.getOption(62).showToolbar!=="onHover")return[];const e=get.get(this._editor);return e&&e.shouldShowHoverAt(t.range)?[new ket(this,t.range,e)]:[]}renderHoverParts(t,i){const e=new Ji,s=i[0];this._telemetryService.publicLog2("inlineCompletionHover.shown"),this.accessibilityService.isScreenReaderOptimized()&&!this._editor.getOption(8)&&this.renderScreenReaderText(t,s,e);const n=s.controller.model.get(),r=this._instantiationService.createInstance(n6,this._editor,!1,t$(null),n.selectedInlineCompletionIndex,n.inlineCompletionsCount,n.selectedInlineCompletion.map((t=>{var i;return(i=t==null?void 0:t.inlineCompletion.source.inlineCompletions.commands)!==null&&i!==void 0?i:[]})));return t.fragment.appendChild(r.getDomNode()),n.triggerExplicitly(),e.add(r),e}renderScreenReaderText(t,i,e){const s=nl,n=s("div.hover-row.markdown-hover"),r=Yc(n,s("div.hover-contents",{"aria-live":"assertive"})),o=e.add(new fP({editor:this._editor},this._languageService,this._openerService));e.add(ZB((s=>{var n;const h=(n=i.controller.model.read(s))===null||n===void 0?void 0:n.primaryGhostText.read(s);if(h){const i=this._editor.getModel().getLineContent(h.lineNumber);(i=>{e.add(o.onDidRenderAsync((()=>{r.className="hover-contents code-hover-contents",t.onContentsChanged()})));const s=tt(0,"Suggestion:"),n=e.add(o.render((new F_).appendText(s).appendCodeblock("text",i)));r.replaceChildren(n.element)})(h.renderForScreenReader(i))}else tl(r)}))),t.fragment.appendChild(n)}};function xet(t,i){let e=0;for(let s=0;s<t.length;s++)t.charAt(s)==="\t"?e+=i:e++;return e}function Det(t,i,e){t=t<0?0:t;let s="";if(!e){const e=Math.floor(t/i);t%=i;for(let t=0;t<e;t++)s+="\t"}for(let i=0;i<t;i++)s+=" ";return s}function Eet(t,i,e,s,n){if(t.getLineCount()===1&&t.getLineMaxColumn(1)===1)return[];const r=i.getLanguageConfiguration(t.getLanguageId()).indentationRules;if(!r)return[];for(s=Math.min(s,t.getLineCount());e<=s&&r.unIndentedLinePattern;){const i=t.getLineContent(e);if(!r.unIndentedLinePattern.test(i))break;e++}if(e>s-1)return[];const{tabSize:o,indentSize:h,insertSpaces:c}=t.getOptions(),l=(t,i)=>(i=i||1,yx.shiftIndent(t,t.length+i,o,h,c)),a=(t,i)=>(i=i||1,yx.unshiftIndent(t,t.length+i,o,h,c)),u=[];let d;const f=t.getLineContent(e);let g=f;d=ir(f);let p=d;r.increaseIndentPattern&&r.increaseIndentPattern.test(g)?(p=l(p),d=l(d)):r.indentNextLinePattern&&r.indentNextLinePattern.test(g)&&(p=l(p));for(let i=++e;i<=s;i++){const e=t.getLineContent(i),s=ir(e),n=p+e.substring(s.length);r.decreaseIndentPattern&&r.decreaseIndentPattern.test(n)&&(p=a(p),d=a(d)),s!==p&&u.push(KP.replaceMove(new Ss(i,1,i,s.length+1),VS(p,h,c))),r.unIndentedLinePattern&&r.unIndentedLinePattern.test(e)||(r.increaseIndentPattern&&r.increaseIndentPattern.test(n)?(d=l(d),p=d):p=r.indentNextLinePattern&&r.indentNextLinePattern.test(n)?l(p):d)}return u}Cet=bet([yet(1,Id),yet(2,uI),yet(3,vw),yet(4,Il),yet(5,ru)],Cet),Su(get.ID,get,3),ku(class extends mu{constructor(){super({id:"editor.action.inlineSuggest.trigger",label:tt(0,"Trigger Inline Suggestion"),alias:"Trigger Inline Suggestion",precondition:Ox.writable})}async run(t,i){const e=get.get(i);await async function(t,i){const e=new BB(t,i);try{await t(e)}finally{e.finish()}}((async t=>{var i;await((i=e==null?void 0:e.model.get())===null||i===void 0?void 0:i.triggerExplicitly(t)),e==null||e.playAccessibilitySignal(t)}))}}),ku(pet),ku(met),ku(class extends mu{constructor(){super({id:"editor.action.inlineSuggest.acceptNextWord",label:tt(0,"Accept Next Word Of Inline Suggestion"),alias:"Accept Next Word Of Inline Suggestion",precondition:ua.and(Ox.writable,R8.inlineSuggestionVisible),kbOpts:{weight:101,primary:2065,kbExpr:ua.and(Ox.writable,R8.inlineSuggestionVisible)},menuOpts:[{menuId:Qa.InlineSuggestionToolbar,title:tt(0,"Accept Word"),group:"primary",order:2}]})}async run(t,i){var e;const s=get.get(i);await((e=s==null?void 0:s.model.get())===null||e===void 0?void 0:e.acceptNextWord(s.editor))}}),ku(class extends mu{constructor(){super({id:"editor.action.inlineSuggest.acceptNextLine",label:tt(0,"Accept Next Line Of Inline Suggestion"),alias:"Accept Next Line Of Inline Suggestion",precondition:ua.and(Ox.writable,R8.inlineSuggestionVisible),kbOpts:{weight:101},menuOpts:[{menuId:Qa.InlineSuggestionToolbar,title:tt(0,"Accept Line"),group:"secondary",order:2}]})}async run(t,i){var e;const s=get.get(i);await((e=s==null?void 0:s.model.get())===null||e===void 0?void 0:e.acceptNextLine(s.editor))}}),ku(class extends mu{constructor(){super({id:Z3,label:tt(0,"Accept Inline Suggestion"),alias:"Accept Inline Suggestion",precondition:R8.inlineSuggestionVisible,menuOpts:[{menuId:Qa.InlineSuggestionToolbar,title:tt(0,"Accept"),group:"primary",order:1}],kbOpts:{primary:2,weight:200,kbExpr:ua.and(R8.inlineSuggestionVisible,Ox.tabMovesFocus.toNegated(),R8.inlineSuggestionHasIndentationLessThanTabSize,gtt.Visible.toNegated(),Ox.hoverFocused.toNegated())}})}async run(t,i){var e;const s=get.get(i);s&&((e=s.model.get())===null||e===void 0||e.accept(s.editor),s.editor.focus())}}),ku(wet),nu(vet),W5.register(Cet);var Aet=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Met=function(t,i){return function(e,s){i(e,s,t)}};class Let extends mu{constructor(){super({id:Let.ID,label:tt(0,"Convert Indentation to Spaces"),alias:"Convert Indentation to Spaces",precondition:Ox.writable})}run(t,i){const e=i.getModel();if(!e)return;const s=e.getOptions(),n=i.getSelection();if(!n)return;const r=new $et(n,s.tabSize);i.pushUndoStop(),i.executeCommands(this.id,[r]),i.pushUndoStop(),e.updateOptions({insertSpaces:!0})}}Let.ID="editor.action.indentationToSpaces";class Fet extends mu{constructor(){super({id:Fet.ID,label:tt(0,"Convert Indentation to Tabs"),alias:"Convert Indentation to Tabs",precondition:Ox.writable})}run(t,i){const e=i.getModel();if(!e)return;const s=e.getOptions(),n=i.getSelection();if(!n)return;const r=new Wet(n,s.tabSize);i.pushUndoStop(),i.executeCommands(this.id,[r]),i.pushUndoStop(),e.updateOptions({insertSpaces:!1})}}Fet.ID="editor.action.indentationToTabs";class Tet extends mu{constructor(t,i,e){super(e),this.insertSpaces=t,this.displaySizeOnly=i}run(t,i){const e=t.get(vj),s=t.get(Nl),n=i.getModel();if(!n)return;const r=s.getCreationOptions(n.getLanguageId(),n.uri,n.isForSimpleWidget),o=n.getOptions(),h=[1,2,3,4,5,6,7,8].map((t=>({id:t.toString(),label:t.toString(),description:t===r.tabSize&&t===o.tabSize?tt(0,"Configured Tab Size"):t===r.tabSize?tt(0,"Default Tab Size"):t===o.tabSize?tt(0,"Current Tab Size"):void 0}))),c=Math.min(n.getOptions().tabSize-1,7);setTimeout((()=>{e.pick(h,{placeHolder:tt(0,"Select Tab Size for Current File"),activeItem:h[c]}).then((t=>{if(t&&n&&!n.isDisposed()){const i=parseInt(t.label,10);this.displaySizeOnly?n.updateOptions({tabSize:i}):n.updateOptions({tabSize:i,indentSize:i,insertSpaces:this.insertSpaces})}}))}),50)}}class Ret extends Tet{constructor(){super(!1,!1,{id:Ret.ID,label:tt(0,"Indent Using Tabs"),alias:"Indent Using Tabs",precondition:void 0})}}Ret.ID="editor.action.indentUsingTabs";class Oet extends Tet{constructor(){super(!0,!1,{id:Oet.ID,label:tt(0,"Indent Using Spaces"),alias:"Indent Using Spaces",precondition:void 0})}}Oet.ID="editor.action.indentUsingSpaces";class Iet extends Tet{constructor(){super(!0,!0,{id:Iet.ID,label:tt(0,"Change Tab Display Size"),alias:"Change Tab Display Size",precondition:void 0})}}Iet.ID="editor.action.changeTabDisplaySize";class _et extends mu{constructor(){super({id:_et.ID,label:tt(0,"Detect Indentation from Content"),alias:"Detect Indentation from Content",precondition:void 0})}run(t,i){const e=t.get(Nl),s=i.getModel();if(!s)return;const n=e.getCreationOptions(s.getLanguageId(),s.uri,s.isForSimpleWidget);s.detectIndentation(n.insertSpaces,n.tabSize)}}_et.ID="editor.action.detectIndentation";class Pet{constructor(t,i){this._initialSelection=i,this._edits=[],this._selectionId=null;for(const i of t)i.range&&typeof i.text=="string"&&this._edits.push(i)}getEditOperations(t,i){for(const t of this._edits)i.addEditOperation(Cs.lift(t.range),t.text);let e=!1;Array.isArray(this._edits)&&this._edits.length===1&&this._initialSelection.isEmpty()&&(this._edits[0].range.startColumn===this._initialSelection.endColumn&&this._edits[0].range.startLineNumber===this._initialSelection.endLineNumber?(e=!0,this._selectionId=i.trackSelection(this._initialSelection,!0)):this._edits[0].range.endColumn===this._initialSelection.startColumn&&this._edits[0].range.endLineNumber===this._initialSelection.startLineNumber&&(e=!0,this._selectionId=i.trackSelection(this._initialSelection,!1))),e||(this._selectionId=i.trackSelection(this._initialSelection))}computeCursorState(t,i){return i.getTrackedSelection(this._selectionId)}}let Net=class{constructor(t,i){this.editor=t,this._languageConfigurationService=i,this.callOnDispose=new Ji,this.callOnModel=new Ji,this.callOnDispose.add(t.onDidChangeConfiguration((()=>this.update()))),this.callOnDispose.add(t.onDidChangeModel((()=>this.update()))),this.callOnDispose.add(t.onDidChangeModelLanguage((()=>this.update())))}update(){this.callOnModel.clear(),this.editor.getOption(12)<4||this.editor.getOption(55)||this.editor.hasModel()&&this.callOnModel.add(this.editor.onDidPaste((({range:t})=>{this.trigger(t)})))}trigger(t){const i=this.editor.getSelections();if(i===null||i.length>1)return;const e=this.editor.getModel();if(!e||!e.tokenization.isCheapToTokenize(t.getStartPosition().lineNumber))return;const s=this.editor.getOption(12),{tabSize:n,indentSize:r,insertSpaces:o}=e.getOptions(),h=[],c={shiftIndent:t=>yx.shiftIndent(t,t.length+1,n,r,o),unshiftIndent:t=>yx.unshiftIndent(t,t.length+1,n,r,o)};let l=t.startLineNumber;for(;l<=t.endLineNumber&&this.shouldIgnoreLine(e,l);)l++;if(l>t.endLineNumber)return;let a=e.getLineContent(l);if(!/\S/.test(a.substring(0,t.startColumn-1))){const t=xx(s,e,e.getLanguageId(),l,c,this._languageConfigurationService);if(t!==null){const i=ir(a),s=xet(t,n);if(s!==xet(i,n)){const t=Det(s,n,o);h.push({range:new Cs(l,1,l,i.length+1),text:t}),a=t+a.substr(i.length)}else{const t=Dx(e,l,this._languageConfigurationService);if(t===0||t===8)return}}}const u=l;for(;l<t.endLineNumber&&!/\S/.test(e.getLineContent(l+1));)l++;if(l!==t.endLineNumber){const i=xx(s,{tokenization:{getLineTokens:t=>e.tokenization.getLineTokens(t),getLanguageId:()=>e.getLanguageId(),getLanguageIdAtPosition:(t,i)=>e.getLanguageIdAtPosition(t,i)},getLineContent:t=>t===u?a:e.getLineContent(t)},e.getLanguageId(),l+1,c,this._languageConfigurationService);if(i!==null){const s=xet(i,n),r=xet(ir(e.getLineContent(l+1)),n);if(s!==r){const i=s-r;for(let s=l+1;s<=t.endLineNumber;s++){const t=ir(e.getLineContent(s)),r=Det(xet(t,n)+i,n,o);r!==t&&h.push({range:new Cs(s,1,s,t.length+1),text:r})}}}}if(h.length>0){this.editor.pushUndoStop();const t=new Pet(h,this.editor.getSelection());this.editor.executeCommand("autoIndentOnPaste",t),this.editor.pushUndoStop()}}shouldIgnoreLine(t,i){t.tokenization.forceTokenization(i);const e=t.getLineFirstNonWhitespaceColumn(i);if(e===0)return!0;const s=t.tokenization.getLineTokens(i);if(s.getCount()>0){const t=s.findTokenIndexAtOffset(e);if(t>=0&&s.getStandardTokenType(t)===1)return!0}return!1}dispose(){this.callOnDispose.dispose(),this.callOnModel.dispose()}};function Bet(t,i,e,s){if(t.getLineCount()===1&&t.getLineMaxColumn(1)===1)return;let n="";for(let t=0;t<e;t++)n+=" ";const r=new RegExp(n,"gi");for(let e=1,o=t.getLineCount();e<=o;e++){let o=t.getLineFirstNonWhitespaceColumn(e);if(o===0&&(o=t.getLineMaxColumn(e)),o===1)continue;const h=new Cs(e,1,e,o),c=t.getValueInRange(h),l=s?c.replace(/\t/gi,n):c.replace(r,"\t");i.addEditOperation(h,l)}}Net.ID="editor.contrib.autoIndentOnPaste",Net=Aet([Met(1,cf)],Net);class $et{constructor(t,i){this.selection=t,this.tabSize=i,this.selectionId=null}getEditOperations(t,i){this.selectionId=i.trackSelection(this.selection),Bet(t,i,this.tabSize,!0)}computeCursorState(t,i){return i.getTrackedSelection(this.selectionId)}}class Wet{constructor(t,i){this.selection=t,this.tabSize=i,this.selectionId=null}getEditOperations(t,i){this.selectionId=i.trackSelection(this.selection),Bet(t,i,this.tabSize,!1)}computeCursorState(t,i){return i.getTrackedSelection(this.selectionId)}}Su(Net.ID,Net,2),ku(Let),ku(Fet),ku(Ret),ku(Oet),ku(Iet),ku(_et),ku(class extends mu{constructor(){super({id:"editor.action.reindentlines",label:tt(0,"Reindent Lines"),alias:"Reindent Lines",precondition:Ox.writable})}run(t,i){const e=t.get(cf),s=i.getModel();if(!s)return;const n=Eet(s,e,1,s.getLineCount());n.length>0&&(i.pushUndoStop(),i.executeEdits(this.id,n),i.pushUndoStop())}}),ku(class extends mu{constructor(){super({id:"editor.action.reindentselectedlines",label:tt(0,"Reindent Selected Lines"),alias:"Reindent Selected Lines",precondition:Ox.writable})}run(t,i){const e=t.get(cf),s=i.getModel();if(!s)return;const n=i.getSelections();if(n===null)return;const r=[];for(const t of n){let i=t.startLineNumber,n=t.endLineNumber;if(i!==n&&t.endColumn===1&&n--,i===1){if(i===n)continue}else i--;const o=Eet(s,e,i,n);r.push(...o)}r.length>0&&(i.pushUndoStop(),i.executeEdits(this.id,r),i.pushUndoStop())}});class jet{constructor(t,i){this.range=t,this.direction=i}}class Het{constructor(t,i,e){this.hint=t,this.anchor=i,this.provider=e,this._isResolved=!1}with(t){const i=new Het(this.hint,t.anchor,this.provider);return i._isResolved=this._isResolved,i._currentResolve=this._currentResolve,i}async resolve(t){if(typeof this.provider.resolveInlayHint=="function"){if(this._currentResolve)return await this._currentResolve,t.isCancellationRequested?void 0:this.resolve(t);this._isResolved||(this._currentResolve=this._doResolve(t).finally((()=>this._currentResolve=void 0))),await this._currentResolve}}async _doResolve(t){var i,e,s;try{const n=await Promise.resolve(this.provider.resolveInlayHint(this.hint,t));this.hint.tooltip=(i=n==null?void 0:n.tooltip)!==null&&i!==void 0?i:this.hint.tooltip,this.hint.label=(e=n==null?void 0:n.label)!==null&&e!==void 0?e:this.hint.label,this.hint.textEdits=(s=n==null?void 0:n.textEdits)!==null&&s!==void 0?s:this.hint.textEdits,this._isResolved=!0}catch(t){_i(t),this._isResolved=!1}}}class Vet{static async create(t,i,e,s){const n=[],r=t.ordered(i).reverse().map((t=>e.map((async e=>{try{const r=await t.provideInlayHints(i,e,s);(r!=null&&r.hints.length||t.onDidChangeInlayHints)&&n.push([r??Vet._emptyInlayHintList,t])}catch(t){_i(t)}}))));if(await Promise.all(r.flat()),s.isCancellationRequested||i.isDisposed())throw new $i;return new Vet(e,n,i)}constructor(t,i,e){this._disposables=new Ji,this.ranges=t,this.provider=new Set;const s=[];for(const[t,n]of i){this._disposables.add(t),this.provider.add(n);for(const i of t.hints){const t=e.validatePosition(i.position);let r="before";const o=Vet._getRangeAtPosition(e,t);let h;o.getStartPosition().isBefore(t)?(h=Cs.fromPositions(o.getStartPosition(),t),r="after"):(h=Cs.fromPositions(t,o.getEndPosition()),r="before"),s.push(new Het(i,new jet(h,r),n))}}this.items=s.sort(((t,i)=>ks.compare(t.hint.position,i.hint.position)))}dispose(){this._disposables.dispose()}static _getRangeAtPosition(t,i){const e=i.lineNumber,s=t.getWordAtPosition(i);if(s)return new Cs(e,s.startColumn,e,s.endColumn);t.tokenization.tokenizeIfCheap(e);const n=t.tokenization.getLineTokens(e),r=i.column-1,o=n.findTokenIndexAtOffset(r);let h=n.getStartOffset(o),c=n.getEndOffset(o);return c-h==1&&(h===r&&o>1?(h=n.getStartOffset(o-1),c=n.getEndOffset(o-1)):c===r&&o<n.getCount()-1&&(h=n.getStartOffset(o+1),c=n.getEndOffset(o+1))),new Cs(e,h+1,e,c+1)}}async function zet(t,i,e,s){var n;const r=t.get(Bl),o=t.get(oI),h=t.get(ql),c=t.get(Il),l=t.get(gR);if(await s.item.resolve(ve.None),!s.part.location)return;const a=s.part.location,u=[],d=new Set(tu.getMenuItems(Qa.EditorContext).map((t=>Ja(t)?t.command.id:IX())));for(const t of D5.all())d.has(t.desc.id)&&u.push(new $l(t.desc.id,eu.label(t.desc,{renderShortTitle:!0}),void 0,!0,(async()=>{const e=await r.createModelReference(a.uri);try{const n=new x5(e.object.textEditorModel,Cs.getStartPosition(a.range)),r=s.item.anchor.range;await c.invokeFunction(t.runEditorCommand.bind(t),i,n,r)}finally{e.dispose()}})));if(s.part.command){const{command:t}=s.part;u.push(new jl),u.push(new $l(t.id,t.title,void 0,!0,(async()=>{var i;try{await h.executeCommand(t.id,...(i=t.arguments)!==null&&i!==void 0?i:[])}catch(t){l.notify({severity:fR.Error,source:s.item.provider.displayName,message:t})}})))}const f=i.getOption(127);o.showContextMenu({domForShadowRoot:f&&(n=i.getDomNode())!==null&&n!==void 0?n:void 0,getAnchor:()=>{const t=vc(e);return{x:t.left,y:t.top+t.height+8}},getActions:()=>u,onHide:()=>{i.focus()},autoSelectFirstItem:!0})}async function Uet(t,i,e,s){const n=t.get(Bl),r=await n.createModelReference(s.uri);await e.invokeWithinContext((async t=>{const n=i.hasSideBySideModifier,o=t.get(Ra),h=b4.inPeekEditor.getValue(o),c=!n&&e.getOption(88)&&!h;return new E5({openToSide:n,openInPeek:c,muteMessage:!0},{title:{value:"",original:""},id:"",precondition:void 0}).run(t,new x5(r.object.textEditorModel,Cs.getStartPosition(s.range)),Cs.lift(s.range))})),r.dispose()}Vet._emptyInlayHintList=Object.freeze({dispose(){},hints:[]});var Ket,qet=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Get=function(t,i){return function(e,s){i(e,s,t)}};class Zet{constructor(){this._entries=new Kf(50)}get(t){const i=Zet._key(t);return this._entries.get(i)}set(t,i){const e=Zet._key(t);this._entries.set(e,i)}static _key(t){return`${t.uri.toString()}/${t.getVersionId()}`}}const Jet=_l("IInlayHintsCache");Nd(Jet,Zet,1);class Qet{constructor(t,i){this.item=t,this.index=i}get part(){const t=this.item.hint.label;return typeof t=="string"?{label:t}:t[this.index]}}class Yet{constructor(t,i){this.part=t,this.hasTriggerModifier=i}}let Xet=Ket=class{static get(t){var i;return(i=t.getContribution(Ket.ID))!==null&&i!==void 0?i:void 0}constructor(t,i,e,s,n,r,o){this._editor=t,this._languageFeaturesService=i,this._inlayHintsCache=s,this._commandService=n,this._notificationService=r,this._instaService=o,this._disposables=new Ji,this._sessionDisposables=new Ji,this._decorationsMetadata=new Map,this._ruleFactory=new Gy(this._editor),this._activeRenderMode=0,this._debounceInfo=e.for(i.inlayHintsProvider,"InlayHint",{min:25}),this._disposables.add(i.inlayHintsProvider.onDidChange((()=>this._update()))),this._disposables.add(t.onDidChangeModel((()=>this._update()))),this._disposables.add(t.onDidChangeModelLanguage((()=>this._update()))),this._disposables.add(t.onDidChangeConfiguration((t=>{t.hasChanged(141)&&this._update()}))),this._update()}dispose(){this._sessionDisposables.dispose(),this._removeAllDecorations(),this._disposables.dispose()}_update(){this._sessionDisposables.clear(),this._removeAllDecorations();const t=this._editor.getOption(141);if(t.enabled==="off")return;const i=this._editor.getModel();if(!i||!this._languageFeaturesService.inlayHintsProvider.has(i))return;if(t.enabled==="on")this._activeRenderMode=0;else{let i,e;t.enabled==="onUnlessPressed"?(i=0,e=1):(i=1,e=0),this._activeRenderMode=i,this._sessionDisposables.add(fl.getInstance().event((t=>{if(!this._editor.hasModel())return;const s=t.altKey&&t.ctrlKey&&!t.shiftKey&&!t.metaKey?e:i;if(s!==this._activeRenderMode){this._activeRenderMode=s;const t=this._editor.getModel(),i=this._copyInlayHintsWithCurrentAnchor(t);this._updateHintsDecorators([t.getFullModelRange()],i),r.schedule(0)}})))}const e=this._inlayHintsCache.get(i);let s;e&&this._updateHintsDecorators([i.getFullModelRange()],e),this._sessionDisposables.add(Zi((()=>{i.isDisposed()||this._cacheHintsForFastRestore(i)})));const n=new Set,r=new Co((async()=>{const t=Date.now();s==null||s.dispose(!0),s=new ye;const e=i.onWillDispose((()=>s==null?void 0:s.cancel()));try{const e=s.token,o=await Vet.create(this._languageFeaturesService.inlayHintsProvider,i,this._getHintsRanges(),e);if(r.delay=this._debounceInfo.update(i,Date.now()-t),e.isCancellationRequested)return void o.dispose();for(const t of o.provider)typeof t.onDidChangeInlayHints!="function"||n.has(t)||(n.add(t),this._sessionDisposables.add(t.onDidChangeInlayHints((()=>{r.isScheduled()||r.schedule()}))));this._sessionDisposables.add(o),this._updateHintsDecorators(o.ranges,o.items),this._cacheHintsForFastRestore(i)}catch(t){Ii(t)}finally{s.dispose(),e.dispose()}}),this._debounceInfo.get(i));this._sessionDisposables.add(r),this._sessionDisposables.add(Zi((()=>s==null?void 0:s.dispose(!0)))),r.schedule(0),this._sessionDisposables.add(this._editor.onDidScrollChange((t=>{!t.scrollTopChanged&&r.isScheduled()||r.schedule()}))),this._sessionDisposables.add(this._editor.onDidChangeModelContent((t=>{s==null||s.cancel();const i=Math.max(r.delay,1250);r.schedule(i)}))),this._sessionDisposables.add(this._installDblClickGesture((()=>r.schedule(0)))),this._sessionDisposables.add(this._installLinkGesture()),this._sessionDisposables.add(this._installContextMenu())}_installLinkGesture(){const t=new Ji,i=t.add(new o4(this._editor)),e=new Ji;return t.add(e),t.add(i.onMouseMoveOrRelevantKeyDown((t=>{const[i]=t,s=this._getInlayHintLabelPart(i),n=this._editor.getModel();if(!s||!n)return void e.clear();const r=new ye;e.add(Zi((()=>r.dispose(!0)))),s.item.resolve(r.token),this._activeInlayHintPart=s.part.command||s.part.location?new Yet(s,i.hasTriggerModifier):void 0;const o=n.validatePosition(s.item.hint.position).lineNumber,h=new Cs(o,1,o,n.getLineMaxColumn(o)),c=this._getInlineHintsForRange(h);this._updateHintsDecorators([h],c),e.add(Zi((()=>{this._activeInlayHintPart=void 0,this._updateHintsDecorators([h],c)})))}))),t.add(i.onCancel((()=>e.clear()))),t.add(i.onExecute((async t=>{const i=this._getInlayHintLabelPart(t);if(i){const e=i.part;e.location?this._instaService.invokeFunction(Uet,t,this._editor,e.location):js.is(e.command)&&await this._invokeCommand(e.command,i.item)}}))),t}_getInlineHintsForRange(t){const i=new Set;for(const e of this._decorationsMetadata.values())t.containsRange(e.item.anchor.range)&&i.add(e.item);return Array.from(i)}_installDblClickGesture(t){return this._editor.onMouseUp((async i=>{if(i.event.detail!==2)return;const e=this._getInlayHintLabelPart(i);if(e&&(i.event.preventDefault(),await e.item.resolve(ve.None),f(e.item.hint.textEdits))){const i=e.item.hint.textEdits.map((t=>KP.replace(Cs.lift(t.range),t.text)));this._editor.executeEdits("inlayHint.default",i),t()}}))}_installContextMenu(){return this._editor.onContextMenu((async t=>{if(!(t.event.target instanceof HTMLElement))return;const i=this._getInlayHintLabelPart(t);i&&await this._instaService.invokeFunction(zet,this._editor,t.event.target,i)}))}_getInlayHintLabelPart(t){var i;if(t.target.type!==6)return;const e=(i=t.target.detail.injectedText)===null||i===void 0?void 0:i.options;return e instanceof SF&&(e==null?void 0:e.attachedData)instanceof Qet?e.attachedData:void 0}async _invokeCommand(t,i){var e;try{await this._commandService.executeCommand(t.id,...(e=t.arguments)!==null&&e!==void 0?e:[])}catch(t){this._notificationService.notify({severity:fR.Error,source:i.provider.displayName,message:t})}}_cacheHintsForFastRestore(t){const i=this._copyInlayHintsWithCurrentAnchor(t);this._inlayHintsCache.set(t,i)}_copyInlayHintsWithCurrentAnchor(t){const i=new Map;for(const[e,s]of this._decorationsMetadata){if(i.has(s.item))continue;const n=t.getDecorationRange(e);if(n){const t=new jet(n,s.item.anchor.direction),e=s.item.with({anchor:t});i.set(s.item,e)}}return Array.from(i.values())}_getHintsRanges(){const t=this._editor.getModel(),i=this._editor.getVisibleRangesPlusViewportAboveBelow(),e=[];for(const s of i.sort(Cs.compareRangesUsingStarts)){const i=t.validateRange(new Cs(s.startLineNumber-30,s.startColumn,s.endLineNumber+30,s.endColumn));e.length!==0&&Cs.areIntersectingOrTouching(e[e.length-1],i)?e[e.length-1]=Cs.plusRange(e[e.length-1],i):e.push(i)}return e}_updateHintsDecorators(t,i){var e,s;const n=[],r=(t,i,e,s,r)=>{const o={content:e,inlineClassNameAffectsLetterSpacing:!0,inlineClassName:i.className,cursorStops:s,attachedData:r};n.push({item:t,classNameRef:i,decoration:{range:t.anchor.range,options:{description:"InlayHint",showIfCollapsed:t.anchor.range.isEmpty(),collapseOnReplaceEdit:!t.anchor.range.isEmpty(),stickiness:0,[t.anchor.direction]:this._activeRenderMode===0?o:void 0}}})},o=(t,i)=>{const e=this._ruleFactory.createClassNameRef({width:(h/3|0)+"px",display:"inline-block"});r(t,e," ",i?tg.Right:tg.None)},{fontSize:h,fontFamily:c,padding:l,isUniform:a}=this._getLayoutInfo(),u="--code-editorInlayHintsFontFamily";this._editor.getContainerDomNode().style.setProperty(u,c);let d={line:0,totalLen:0};for(const t of i){if(d.line!==t.anchor.range.startLineNumber&&(d={line:t.anchor.range.startLineNumber,totalLen:0}),d.totalLen>Ket._MAX_LABEL_LEN)continue;t.hint.paddingLeft&&o(t,!1);const i=typeof t.hint.label=="string"?[{label:t.hint.label}]:t.hint.label;for(let s=0;s<i.length;s++){const n=i[s],o=s===0,c=s===i.length-1,g={fontSize:`${h}px`,fontFamily:`var(${u}), ${Li.fontFamily}`,verticalAlign:a?"baseline":"middle",unicodeBidi:"isolate"};f(t.hint.textEdits)&&(g.cursor="default"),this._fillInColors(g,t.hint),(n.command||n.location)&&((e=this._activeInlayHintPart)===null||e===void 0?void 0:e.part.item)===t&&this._activeInlayHintPart.part.index===s&&(g.textDecoration="underline",this._activeInlayHintPart.hasTriggerModifier&&(g.color=MC(mv),g.cursor="pointer")),l&&(o&&c?(g.padding=`1px ${0|Math.max(1,h/4)}px`,g.borderRadius=(h/4|0)+"px"):o?(g.padding=`1px 0 1px ${0|Math.max(1,h/4)}px`,g.borderRadius=`${h/4|0}px 0 0 ${h/4|0}px`):c?(g.padding=`1px ${0|Math.max(1,h/4)}px 1px 0`,g.borderRadius=`0 ${h/4|0}px ${h/4|0}px 0`):g.padding="1px 0 1px 0");let p=n.label;d.totalLen+=p.length;let m=!1;const w=d.totalLen-Ket._MAX_LABEL_LEN;if(w>0&&(p=p.slice(0,-w)+"…",m=!0),r(t,this._ruleFactory.createClassNameRef(g),tst(p),c&&!t.hint.paddingRight?tg.Right:tg.None,new Qet(t,s)),m)break}if(t.hint.paddingRight&&o(t,!0),n.length>Ket._MAX_DECORATORS)break}const g=[];for(const[i,e]of this._decorationsMetadata){const n=(s=this._editor.getModel())===null||s===void 0?void 0:s.getDecorationRange(i);n&&t.some((t=>t.containsRange(n)))&&(g.push(i),e.classNameRef.dispose(),this._decorationsMetadata.delete(i))}const p=xq.capture(this._editor);this._editor.changeDecorations((t=>{const i=t.deltaDecorations(g,n.map((t=>t.decoration)));for(let t=0;t<i.length;t++){const e=n[t];this._decorationsMetadata.set(i[t],e)}})),p.restore(this._editor)}_fillInColors(t,i){i.kind===Hs.Parameter?(t.backgroundColor=MC(Tv),t.color=MC(Fv)):i.kind===Hs.Type?(t.backgroundColor=MC(Lv),t.color=MC(Mv)):(t.backgroundColor=MC(Av),t.color=MC(Ev))}_getLayoutInfo(){const t=this._editor.getOption(141),i=t.padding,e=this._editor.getOption(52),s=this._editor.getOption(49);let n=t.fontSize;(!n||n<5||n>e)&&(n=e);const r=t.fontFamily||s;return{fontSize:n,fontFamily:r,padding:i,isUniform:!i&&r===s&&n===e}}_removeAllDecorations(){this._editor.removeDecorations(Array.from(this._decorationsMetadata.keys()));for(const t of this._decorationsMetadata.values())t.classNameRef.dispose();this._decorationsMetadata.clear()}};function tst(t){return t.replace(/[ \t]/g," ")}Xet.ID="editor.contrib.InlayHints",Xet._MAX_DECORATORS=1500,Xet._MAX_LABEL_LEN=43,Xet=Ket=qet([Get(1,$p),Get(2,lO),Get(3,Jet),Get(4,ql),Get(5,gR),Get(6,Il)],Xet),Gl.registerCommand("_executeInlayHintProvider",(async(t,...i)=>{const[e,s]=i;j(as.isUri(e)),j(Cs.isIRange(s));const{inlayHintsProvider:n}=t.get($p),r=await t.get(Bl).createModelReference(e);try{const t=await Vet.create(n,r.object.textEditorModel,[Cs.lift(s)],ve.None),i=t.items.map((t=>t.hint));return setTimeout((()=>t.dispose()),0),i}finally{r.dispose()}}));var ist=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},est=function(t,i){return function(e,s){i(e,s,t)}};class sst extends $5{constructor(t,i,e,s){super(10,i,t.item.anchor.range,e,s,!0),this.part=t}}let nst=class extends u3{constructor(t,i,e,s,n,r){super(t,i,e,s,r),this._resolverService=n,this.hoverOrdinal=6}suggestHoverAnchor(t){var i;if(!Xet.get(this._editor)||t.target.type!==6)return null;const e=(i=t.target.detail.injectedText)===null||i===void 0?void 0:i.options;return e instanceof SF&&e.attachedData instanceof Qet?new sst(e.attachedData,this,t.event.posx,t.event.posy):null}computeSync(){return[]}computeAsync(t,i,e){return t instanceof sst?new Lo((async i=>{const{part:s}=t;if(await s.item.resolve(e),e.isCancellationRequested)return;let n,r;if(typeof s.item.hint.tooltip=="string"?n=(new F_).appendText(s.item.hint.tooltip):s.item.hint.tooltip&&(n=s.item.hint.tooltip),n&&i.emitOne(new a3(this,t.range,[n],!1,0)),f(s.item.hint.textEdits)&&i.emitOne(new a3(this,t.range,[(new F_).appendText(tt(0,"Double-click to insert"))],!1,10001)),typeof s.part.tooltip=="string"?r=(new F_).appendText(s.part.tooltip):s.part.tooltip&&(r=s.part.tooltip),r&&i.emitOne(new a3(this,t.range,[r],!1,1)),s.part.location||s.part.command){let e;const n=tt(0,this._editor.getOption(78)==="altKey"?bt?"cmd + click":"ctrl + click":bt?"option + click":"alt + click");s.part.location&&s.part.command?e=(new F_).appendText(tt(0,"Go to Definition ({0}), right click for more",n)):s.part.location?e=(new F_).appendText(tt(0,"Go to Definition ({0})",n)):s.part.command&&(e=new F_(`[${tt(0,"Execute Command")}](${o=s.part.command,as.from({scheme:Lh.command,path:o.id,query:o.arguments&&encodeURIComponent(JSON.stringify(o.arguments))}).toString()} "${s.part.command.title}") (${n})`,{isTrusted:!0})),e&&i.emitOne(new a3(this,t.range,[e],!1,1e4))}var o;const h=await this._resolveInlayHintLabelPartHover(s,e);for await(const t of h)i.emitOne(t)})):Lo.EMPTY}async _resolveInlayHintLabelPartHover(t,i){if(!t.part.location)return Lo.EMPTY;const{uri:e,range:s}=t.part.location,n=await this._resolverService.createModelReference(e);try{const e=n.object.textEditorModel;return this._languageFeaturesService.hoverProvider.has(e)?o3(this._languageFeaturesService.hoverProvider,e,new ks(s.startLineNumber,s.startColumn),i).filter((t=>!T_(t.hover.contents))).map((i=>new a3(this,t.item.anchor.range,i.hover.contents,!1,2+i.ordinal))):Lo.EMPTY}finally{n.dispose()}}};nst=ist([est(1,Id),est(2,uI),est(3,Md),est(4,Bl),est(5,$p)],nst),Su(Xet.ID,Xet,1),W5.register(nst);class rst{constructor(t,i,e){this._editRange=t,this._originalSelection=i,this._text=e}getEditOperations(t,i){i.addTrackedEditOperation(this._editRange,this._text)}computeCursorState(t,i){const e=i.getInverseEditOperations()[0].range;return this._originalSelection.isEmpty()?new Ss(e.endLineNumber,Math.min(this._originalSelection.positionColumn,e.endColumn),e.endLineNumber,Math.min(this._originalSelection.positionColumn,e.endColumn)):new Ss(e.endLineNumber,e.endColumn-this._text.length,e.endLineNumber,e.endColumn)}}var ost,hst=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},cst=function(t,i){return function(e,s){i(e,s,t)}};let lst=ost=class{static get(t){return t.getContribution(ost.ID)}constructor(t,i){this.editor=t,this.editorWorkerService=i,this.decorations=this.editor.createDecorationsCollection()}dispose(){}run(t,i){var e;(e=this.currentRequest)===null||e===void 0||e.cancel();const s=this.editor.getSelection(),n=this.editor.getModel();if(!n||!s)return;let r=s;if(r.startLineNumber!==r.endLineNumber)return;const o=new IQ(this.editor,5),h=n.uri;return this.editorWorkerService.canNavigateValueSet(h)?(this.currentRequest=uo((t=>this.editorWorkerService.navigateValueSet(h,r,i))),this.currentRequest.then((i=>{var e;if(!i||!i.range||!i.value||!o.validate(this.editor))return;const s=Cs.lift(i.range);let n=i.range;const h=i.value.length-(r.endColumn-r.startColumn);n={startLineNumber:n.startLineNumber,startColumn:n.startColumn,endLineNumber:n.endLineNumber,endColumn:n.startColumn+i.value.length},h>1&&(r=new Ss(r.startLineNumber,r.startColumn,r.endLineNumber,r.endColumn+h-1));const c=new rst(s,r,i.value);this.editor.pushUndoStop(),this.editor.executeCommand(t,c),this.editor.pushUndoStop(),this.decorations.set([{range:n,options:ost.DECORATION}]),(e=this.decorationRemover)===null||e===void 0||e.cancel(),this.decorationRemover=wo(350),this.decorationRemover.then((()=>this.decorations.clear())).catch(Ii)})).catch(Ii)):Promise.resolve(void 0)}};lst.ID="editor.contrib.inPlaceReplaceController",lst.DECORATION=xF.register({description:"in-place-replace",className:"valueSetReplacement"}),lst=ost=hst([cst(1,JW)],lst);Su(lst.ID,lst,4),ku(class extends mu{constructor(){super({id:"editor.action.inPlaceReplace.up",label:tt(0,"Replace with Previous Value"),alias:"Replace with Previous Value",precondition:Ox.writable,kbOpts:{kbExpr:Ox.editorTextFocus,primary:3159,weight:100}})}run(t,i){const e=lst.get(i);return e?e.run(this.id,!1):Promise.resolve(void 0)}}),ku(class extends mu{constructor(){super({id:"editor.action.inPlaceReplace.down",label:tt(0,"Replace with Next Value"),alias:"Replace with Next Value",precondition:Ox.writable,kbOpts:{kbExpr:Ox.editorTextFocus,primary:3161,weight:100}})}run(t,i){const e=lst.get(i);return e?e.run(this.id,!0):Promise.resolve(void 0)}});ku(class extends mu{constructor(){super({id:"expandLineSelection",label:tt(0,"Expand Line Selection"),alias:"Expand Line Selection",precondition:void 0,kbOpts:{weight:0,kbExpr:Ox.textInputFocus,primary:2090}})}run(t,i,e){if(e=e||{},!i.hasModel())return;const s=i._getViewModel();s.model.pushStackElement(),s.setCursorStates(e.source,3,dx.expandLineSelection(s,s.getCursorStates())),s.revealAllCursors(e.source,!0)}});class ast{constructor(t,i,e){this._selection=t,this._cursors=i,this._selectionId=null,this._trimInRegexesAndStrings=e}getEditOperations(t,i){const e=function(t,i,e){i.sort(((t,i)=>t.lineNumber===i.lineNumber?t.column-i.column:t.lineNumber-i.lineNumber));for(let t=i.length-2;t>=0;t--)i[t].lineNumber===i[t+1].lineNumber&&i.splice(t,1);const s=[];let n=0,r=0;const o=i.length;for(let h=1,c=t.getLineCount();h<=c;h++){const c=t.getLineContent(h),l=c.length+1;let a=0;if(r<o&&i[r].lineNumber===h&&(a=i[r].column,r++,a===l)||c.length===0)continue;const u=er(c);let d=0;if(u===-1)d=1;else{if(u===c.length-1)continue;d=u+2}if(!e){if(!t.tokenization.hasAccurateTokensForLine(h))continue;const i=t.tokenization.getLineTokens(h),e=i.getStandardTokenType(i.findTokenIndexAtOffset(d));if(e===2||e===3)continue}d=Math.max(a,d),s[n++]=KP.delete(new Cs(h,d,h,l))}return s}(t,this._cursors,this._trimInRegexesAndStrings);for(let t=0,s=e.length;t<s;t++){const s=e[t];i.addEditOperation(s.range,s.text)}this._selectionId=i.trackSelection(this._selection)}computeCursorState(t,i){return i.getTrackedSelection(this._selectionId)}}class ust{constructor(t,i,e){this._selection=t,this._isCopyingDown=i,this._noop=e||!1,this._selectionDirection=0,this._selectionId=null,this._startLineNumberDelta=0,this._endLineNumberDelta=0}getEditOperations(t,i){let e=this._selection;this._startLineNumberDelta=0,this._endLineNumberDelta=0,e.startLineNumber<e.endLineNumber&&e.endColumn===1&&(this._endLineNumberDelta=1,e=e.setEndPosition(e.endLineNumber-1,t.getLineMaxColumn(e.endLineNumber-1)));const s=[];for(let i=e.startLineNumber;i<=e.endLineNumber;i++)s.push(t.getLineContent(i));const n=s.join(`\n`);n===""&&this._isCopyingDown&&(this._startLineNumberDelta++,this._endLineNumberDelta++),this._noop?i.addEditOperation(new Cs(e.endLineNumber,t.getLineMaxColumn(e.endLineNumber),e.endLineNumber+1,1),e.endLineNumber===t.getLineCount()?"":`\n`):this._isCopyingDown?i.addEditOperation(new Cs(e.startLineNumber,1,e.startLineNumber,1),n+`\n`):i.addEditOperation(new Cs(e.endLineNumber,t.getLineMaxColumn(e.endLineNumber),e.endLineNumber,t.getLineMaxColumn(e.endLineNumber)),`\n`+n),this._selectionId=i.trackSelection(e),this._selectionDirection=this._selection.getDirection()}computeCursorState(t,i){let e=i.getTrackedSelection(this._selectionId);if(this._startLineNumberDelta!==0||this._endLineNumberDelta!==0){let t=e.startLineNumber,i=e.startColumn,s=e.endLineNumber,n=e.endColumn;this._startLineNumberDelta!==0&&(t+=this._startLineNumberDelta,i=1),this._endLineNumberDelta!==0&&(s+=this._endLineNumberDelta,n=1),e=Ss.createWithDirection(t,i,s,n,this._selectionDirection)}return e}}var dst=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},fst=function(t,i){return function(e,s){i(e,s,t)}};let gst=class{constructor(t,i,e,s){this._languageConfigurationService=s,this._selection=t,this._isMovingDown=i,this._autoIndent=e,this._selectionId=null,this._moveEndLineSelectionShrink=!1}getEditOperations(t,i){const e=t.getLineCount();if(this._isMovingDown&&this._selection.endLineNumber===e)return void(this._selectionId=i.trackSelection(this._selection));if(!this._isMovingDown&&this._selection.startLineNumber===1)return void(this._selectionId=i.trackSelection(this._selection));this._moveEndPositionDown=!1;let s=this._selection;s.startLineNumber<s.endLineNumber&&s.endColumn===1&&(this._moveEndPositionDown=!0,s=s.setEndPosition(s.endLineNumber-1,t.getLineMaxColumn(s.endLineNumber-1)));const{tabSize:n,indentSize:r,insertSpaces:o}=t.getOptions(),h=this.buildIndentConverter(n,r,o),c={tokenization:{getLineTokens:i=>t.tokenization.getLineTokens(i),getLanguageId:()=>t.getLanguageId(),getLanguageIdAtPosition:(i,e)=>t.getLanguageIdAtPosition(i,e)},getLineContent:null};if(s.startLineNumber===s.endLineNumber&&t.getLineMaxColumn(s.startLineNumber)===1){const e=s.startLineNumber,n=this._isMovingDown?e+1:e-1;t.getLineMaxColumn(n)===1?i.addEditOperation(new Cs(1,1,1,1),null):(i.addEditOperation(new Cs(e,1,e,1),t.getLineContent(n)),i.addEditOperation(new Cs(n,1,n,t.getLineMaxColumn(n)),null)),s=new Ss(n,1,n,1)}else{let e,r;if(this._isMovingDown){e=s.endLineNumber+1,r=t.getLineContent(e),i.addEditOperation(new Cs(e-1,t.getLineMaxColumn(e-1),e,t.getLineMaxColumn(e)),null);let l=r;if(this.shouldAutoIndent(t,s)){const a=this.matchEnterRule(t,h,n,e,s.startLineNumber-1);if(a!==null)l=Det(a+xet(ir(t.getLineContent(e)),n),n,o)+this.trimStart(r);else{c.getLineContent=i=>i===s.startLineNumber?t.getLineContent(e):t.getLineContent(i);const i=xx(this._autoIndent,c,t.getLanguageIdAtPosition(e,1),s.startLineNumber,h,this._languageConfigurationService);if(i!==null){const s=ir(t.getLineContent(e)),h=xet(i,n);h!==xet(s,n)&&(l=Det(h,n,o)+this.trimStart(r))}}i.addEditOperation(new Cs(s.startLineNumber,1,s.startLineNumber,1),l+`\n`);const u=this.matchEnterRuleMovingDown(t,h,n,s.startLineNumber,e,l);if(u!==null)u!==0&&this.getIndentEditsOfMovingBlock(t,i,s,n,o,u);else{c.getLineContent=i=>i===s.startLineNumber?l:i>=s.startLineNumber+1&&i<=s.endLineNumber+1?t.getLineContent(i-1):t.getLineContent(i);const r=xx(this._autoIndent,c,t.getLanguageIdAtPosition(e,1),s.startLineNumber+1,h,this._languageConfigurationService);if(r!==null){const e=ir(t.getLineContent(s.startLineNumber)),h=xet(r,n),c=xet(e,n);if(h!==c){const e=h-c;this.getIndentEditsOfMovingBlock(t,i,s,n,o,e)}}}}else i.addEditOperation(new Cs(s.startLineNumber,1,s.startLineNumber,1),l+`\n`)}else if(e=s.startLineNumber-1,r=t.getLineContent(e),i.addEditOperation(new Cs(e,1,e+1,1),null),i.addEditOperation(new Cs(s.endLineNumber,t.getLineMaxColumn(s.endLineNumber),s.endLineNumber,t.getLineMaxColumn(s.endLineNumber)),`\n`+r),this.shouldAutoIndent(t,s)){c.getLineContent=i=>i===e?t.getLineContent(s.startLineNumber):t.getLineContent(i);const r=this.matchEnterRule(t,h,n,s.startLineNumber,s.startLineNumber-2);if(r!==null)r!==0&&this.getIndentEditsOfMovingBlock(t,i,s,n,o,r);else{const r=xx(this._autoIndent,c,t.getLanguageIdAtPosition(s.startLineNumber,1),e,h,this._languageConfigurationService);if(r!==null){const e=ir(t.getLineContent(s.startLineNumber)),h=xet(r,n),c=xet(e,n);if(h!==c){const e=h-c;this.getIndentEditsOfMovingBlock(t,i,s,n,o,e)}}}}}this._selectionId=i.trackSelection(s)}buildIndentConverter(t,i,e){return{shiftIndent:s=>yx.shiftIndent(s,s.length+1,t,i,e),unshiftIndent:s=>yx.unshiftIndent(s,s.length+1,t,i,e)}}parseEnterResult(t,i,e,s,n){if(n){let r=n.indentation;n.indentAction===Uu.None||n.indentAction===Uu.Indent?r=n.indentation+n.appendText:n.indentAction===Uu.IndentOutdent?r=n.indentation:n.indentAction===Uu.Outdent&&(r=i.unshiftIndent(n.indentation)+n.appendText);const o=t.getLineContent(s);if(this.trimStart(o).indexOf(this.trimStart(r))>=0){const n=ir(t.getLineContent(s));let o=ir(r);const h=Dx(t,s,this._languageConfigurationService);return h!==null&&2&h&&(o=i.unshiftIndent(o)),xet(o,e)-xet(n,e)}}return null}matchEnterRuleMovingDown(t,i,e,s,n,r){if(er(r)>=0){const r=t.getLineMaxColumn(n),o=gx(this._autoIndent,t,new Cs(n,r,n,r),this._languageConfigurationService);return this.parseEnterResult(t,i,e,s,o)}{let n=s-1;for(;n>=1&&!(er(t.getLineContent(n))>=0);)n--;if(n<1||s>t.getLineCount())return null;const r=t.getLineMaxColumn(n),o=gx(this._autoIndent,t,new Cs(n,r,n,r),this._languageConfigurationService);return this.parseEnterResult(t,i,e,s,o)}}matchEnterRule(t,i,e,s,n,r){let o=n;for(;o>=1;){let i;if(i=o===n&&r!==void 0?r:t.getLineContent(o),er(i)>=0)break;o--}if(o<1||s>t.getLineCount())return null;const h=t.getLineMaxColumn(o),c=gx(this._autoIndent,t,new Cs(o,h,o,h),this._languageConfigurationService);return this.parseEnterResult(t,i,e,s,c)}trimStart(t){return t.replace(/^\s+/,"")}shouldAutoIndent(t,i){if(this._autoIndent<4||!t.tokenization.isCheapToTokenize(i.startLineNumber))return!1;const e=t.getLanguageIdAtPosition(i.startLineNumber,1);return e===t.getLanguageIdAtPosition(i.endLineNumber,1)&&this._languageConfigurationService.getLanguageConfiguration(e).indentRulesSupport!==null}getIndentEditsOfMovingBlock(t,i,e,s,n,r){for(let o=e.startLineNumber;o<=e.endLineNumber;o++){const h=ir(t.getLineContent(o)),c=Det(xet(h,s)+r,s,n);c!==h&&(i.addEditOperation(new Cs(o,1,o,h.length+1),c),o===e.endLineNumber&&e.endColumn<=h.length+1&&c===""&&(this._moveEndLineSelectionShrink=!0))}}computeCursorState(t,i){let e=i.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(e=e.setEndPosition(e.endLineNumber+1,1)),this._moveEndLineSelectionShrink&&e.startLineNumber<e.endLineNumber&&(e=e.setEndPosition(e.endLineNumber,2)),e}};gst=dst([fst(3,cf)],gst);class pst{static getCollator(){return pst._COLLATOR||(pst._COLLATOR=new Intl.Collator),pst._COLLATOR}constructor(t,i){this.selection=t,this.descending=i,this.selectionId=null}getEditOperations(t,i){const e=function(t,i,e){const s=mst(t,i,e);return s?KP.replace(new Cs(s.startLineNumber,1,s.endLineNumber,t.getLineMaxColumn(s.endLineNumber)),s.after.join(`\n`)):null}(t,this.selection,this.descending);e&&i.addEditOperation(e.range,e.text),this.selectionId=i.trackSelection(this.selection)}computeCursorState(t,i){return i.getTrackedSelection(this.selectionId)}static canRun(t,i,e){if(t===null)return!1;const s=mst(t,i,e);if(!s)return!1;for(let t=0,i=s.before.length;t<i;t++)if(s.before[t]!==s.after[t])return!0;return!1}}function mst(t,i,e){const s=i.startLineNumber;let n=i.endLineNumber;if(i.endColumn===1&&n--,s>=n)return null;const r=[];for(let i=s;i<=n;i++)r.push(t.getLineContent(i));let o=r.slice(0);return o.sort(pst.getCollator().compare),e===!0&&(o=o.reverse()),{startLineNumber:s,endLineNumber:n,before:r,after:o}}pst._COLLATOR=null;class wst extends mu{constructor(t,i){super(i),this.down=t}run(t,i){if(!i.hasModel())return;const e=i.getSelections().map(((t,i)=>({selection:t,index:i,ignore:!1})));e.sort(((t,i)=>Cs.compareRangesUsingStarts(t.selection,i.selection)));let s=e[0];for(let t=1;t<e.length;t++){const i=e[t];s.selection.endLineNumber===i.selection.startLineNumber&&(s.index<i.index?i.ignore=!0:(s.ignore=!0,s=i))}const n=[];for(const t of e)n.push(new ust(t.selection,this.down,t.ignore));i.pushUndoStop(),i.executeCommands(this.id,n),i.pushUndoStop()}}class vst extends mu{constructor(t,i){super(i),this.down=t}run(t,i){const e=t.get(cf),s=[],n=i.getSelections()||[],r=i.getOption(12);for(const t of n)s.push(new gst(t,this.down,r,e));i.pushUndoStop(),i.executeCommands(this.id,s),i.pushUndoStop()}}class bst extends mu{constructor(t,i){super(i),this.descending=t}run(t,i){if(!i.hasModel())return;const e=i.getModel();let s=i.getSelections();s.length===1&&s[0].isEmpty()&&(s=[new Ss(1,1,e.getLineCount(),e.getLineMaxColumn(e.getLineCount()))]);for(const t of s)if(!pst.canRun(i.getModel(),t,this.descending))return;const n=[];for(let t=0,i=s.length;t<i;t++)n[t]=new pst(s[t],this.descending);i.pushUndoStop(),i.executeCommands(this.id,n),i.pushUndoStop()}}class yst extends mu{constructor(){super({id:yst.ID,label:tt(0,"Trim Trailing Whitespace"),alias:"Trim Trailing Whitespace",precondition:Ox.writable,kbOpts:{kbExpr:Ox.editorTextFocus,primary:Fe(2089,2102),weight:100}})}run(t,i,e){let s=[];e.reason==="auto-save"&&(s=(i.getSelections()||[]).map((t=>new ks(t.positionLineNumber,t.positionColumn))));const n=i.getSelection();if(n===null)return;const r=t.get(Md),o=i.getModel(),h=r.getValue("files.trimTrailingWhitespaceInRegexAndStrings",{overrideIdentifier:o==null?void 0:o.getLanguageId(),resource:o==null?void 0:o.uri}),c=new ast(n,s,h);i.pushUndoStop(),i.executeCommands(this.id,[c]),i.pushUndoStop()}}yst.ID="editor.action.trimTrailingWhitespace";class kst extends mu{run(t,i){if(!i.hasModel())return;const e=i.getSelection(),s=this._getRangesToDelete(i),n=[];for(let t=0,i=s.length-1;t<i;t++){const i=s[t],e=s[t+1];Cs.intersectRanges(i,e)===null?n.push(i):s[t+1]=Cs.plusRange(i,e)}n.push(s[s.length-1]);const r=this._getEndCursorState(e,n),o=n.map((t=>KP.replace(t,"")));i.pushUndoStop(),i.executeEdits(this.id,o,r),i.pushUndoStop()}}class Cst extends mu{run(t,i){const e=i.getSelections();if(e===null)return;const s=i.getModel();if(s===null)return;const n=i.getOption(131),r=[];for(const t of e)if(t.isEmpty()){const e=t.getStartPosition(),o=i.getConfiguredWordAtPosition(e);if(!o)continue;const h=new Cs(e.lineNumber,o.startColumn,e.lineNumber,o.endColumn),c=s.getValueInRange(h);r.push(KP.replace(h,this._modifyText(c,n)))}else{const i=s.getValueInRange(t);r.push(KP.replace(t,this._modifyText(i,n)))}i.pushUndoStop(),i.executeEdits(this.id,r),i.pushUndoStop()}}class Sst{constructor(t,i){this._pattern=t,this._flags=i,this._actual=null,this._evaluated=!1}get(){if(!this._evaluated){this._evaluated=!0;try{this._actual=new RegExp(this._pattern,this._flags)}catch{}}return this._actual}isSupported(){return this.get()!==null}}class xst extends Cst{constructor(){super({id:"editor.action.transformToTitlecase",label:tt(0,"Transform to Title Case"),alias:"Transform to Title Case",precondition:Ox.writable})}_modifyText(t,i){const e=xst.titleBoundary.get();return e?t.toLocaleLowerCase().replace(e,(t=>t.toLocaleUpperCase())):t}}xst.titleBoundary=new Sst("(^|[^\\p{L}\\p{N}']|((^|\\P{L})'))\\p{L}","gmu");class Dst extends Cst{constructor(){super({id:"editor.action.transformToSnakecase",label:tt(0,"Transform to Snake Case"),alias:"Transform to Snake Case",precondition:Ox.writable})}_modifyText(t,i){const e=Dst.caseBoundary.get(),s=Dst.singleLetters.get();return e&&s?t.replace(e,"$1_$2").replace(s,"$1_$2$3").toLocaleLowerCase():t}}Dst.caseBoundary=new Sst("(\\p{Ll})(\\p{Lu})","gmu"),Dst.singleLetters=new Sst("(\\p{Lu}|\\p{N})(\\p{Lu})(\\p{Ll})","gmu");class Est extends Cst{constructor(){super({id:"editor.action.transformToCamelcase",label:tt(0,"Transform to Camel Case"),alias:"Transform to Camel Case",precondition:Ox.writable})}_modifyText(t,i){const e=Est.wordBoundary.get();if(!e)return t;const s=t.split(e);return s.shift()+s.map((t=>t.substring(0,1).toLocaleUpperCase()+t.substring(1))).join("")}}Est.wordBoundary=new Sst("[_\\s-]","gm");class Ast extends Cst{constructor(){super({id:"editor.action.transformToPascalcase",label:tt(0,"Transform to Pascal Case"),alias:"Transform to Pascal Case",precondition:Ox.writable})}_modifyText(t,i){const e=Ast.wordBoundary.get(),s=Ast.wordBoundaryToMaintain.get();return!e||!s?t:t.split(s).map((t=>t.split(e))).flat().map((t=>t.substring(0,1).toLocaleUpperCase()+t.substring(1))).join("")}}Ast.wordBoundary=new Sst("[_\\s-]","gm"),Ast.wordBoundaryToMaintain=new Sst("(?<=\\.)","gm");class Mst extends Cst{static isSupported(){return[this.caseBoundary,this.singleLetters,this.underscoreBoundary].every((t=>t.isSupported()))}constructor(){super({id:"editor.action.transformToKebabcase",label:tt(0,"Transform to Kebab Case"),alias:"Transform to Kebab Case",precondition:Ox.writable})}_modifyText(t,i){const e=Mst.caseBoundary.get(),s=Mst.singleLetters.get(),n=Mst.underscoreBoundary.get();return e&&s&&n?t.replace(n,"$1-$3").replace(e,"$1-$2").replace(s,"$1-$2").toLocaleLowerCase():t}}Mst.caseBoundary=new Sst("(\\p{Ll})(\\p{Lu})","gmu"),Mst.singleLetters=new Sst("(\\p{Lu}|\\p{N})(\\p{Lu}\\p{Ll})","gmu"),Mst.underscoreBoundary=new Sst("(\\S)(_)(\\S)","gm"),ku(class extends wst{constructor(){super(!1,{id:"editor.action.copyLinesUpAction",label:tt(0,"Copy Line Up"),alias:"Copy Line Up",precondition:Ox.writable,kbOpts:{kbExpr:Ox.editorTextFocus,primary:1552,linux:{primary:3600},weight:100},menuOpts:{menuId:Qa.MenubarSelectionMenu,group:"2_line",title:tt(0,"&&Copy Line Up"),order:1}})}}),ku(class extends wst{constructor(){super(!0,{id:"editor.action.copyLinesDownAction",label:tt(0,"Copy Line Down"),alias:"Copy Line Down",precondition:Ox.writable,kbOpts:{kbExpr:Ox.editorTextFocus,primary:1554,linux:{primary:3602},weight:100},menuOpts:{menuId:Qa.MenubarSelectionMenu,group:"2_line",title:tt(0,"Co&&py Line Down"),order:2}})}}),ku(class extends mu{constructor(){super({id:"editor.action.duplicateSelection",label:tt(0,"Duplicate Selection"),alias:"Duplicate Selection",precondition:Ox.writable,menuOpts:{menuId:Qa.MenubarSelectionMenu,group:"2_line",title:tt(0,"&&Duplicate Selection"),order:5}})}run(t,i,e){if(!i.hasModel())return;const s=[],n=i.getSelections(),r=i.getModel();for(const t of n)if(t.isEmpty())s.push(new ust(t,!0));else{const i=new Ss(t.endLineNumber,t.endColumn,t.endLineNumber,t.endColumn);s.push(new ex(i,r.getValueInRange(t)))}i.pushUndoStop(),i.executeCommands(this.id,s),i.pushUndoStop()}}),ku(class extends vst{constructor(){super(!1,{id:"editor.action.moveLinesUpAction",label:tt(0,"Move Line Up"),alias:"Move Line Up",precondition:Ox.writable,kbOpts:{kbExpr:Ox.editorTextFocus,primary:528,linux:{primary:528},weight:100},menuOpts:{menuId:Qa.MenubarSelectionMenu,group:"2_line",title:tt(0,"Mo&&ve Line Up"),order:3}})}}),ku(class extends vst{constructor(){super(!0,{id:"editor.action.moveLinesDownAction",label:tt(0,"Move Line Down"),alias:"Move Line Down",precondition:Ox.writable,kbOpts:{kbExpr:Ox.editorTextFocus,primary:530,linux:{primary:530},weight:100},menuOpts:{menuId:Qa.MenubarSelectionMenu,group:"2_line",title:tt(0,"Move &&Line Down"),order:4}})}}),ku(class extends bst{constructor(){super(!1,{id:"editor.action.sortLinesAscending",label:tt(0,"Sort Lines Ascending"),alias:"Sort Lines Ascending",precondition:Ox.writable})}}),ku(class extends bst{constructor(){super(!0,{id:"editor.action.sortLinesDescending",label:tt(0,"Sort Lines Descending"),alias:"Sort Lines Descending",precondition:Ox.writable})}}),ku(class extends mu{constructor(){super({id:"editor.action.removeDuplicateLines",label:tt(0,"Delete Duplicate Lines"),alias:"Delete Duplicate Lines",precondition:Ox.writable})}run(t,i){if(!i.hasModel())return;const e=i.getModel();if(e.getLineCount()===1&&e.getLineMaxColumn(1)===1)return;const s=[],n=[];let r=0,o=!0,h=i.getSelections();h.length===1&&h[0].isEmpty()&&(h=[new Ss(1,1,e.getLineCount(),e.getLineMaxColumn(e.getLineCount()))],o=!1);for(const t of h){const i=new Set,o=[];for(let s=t.startLineNumber;s<=t.endLineNumber;s++){const t=e.getLineContent(s);i.has(t)||(o.push(t),i.add(t))}const h=new Ss(t.startLineNumber,1,t.endLineNumber,e.getLineMaxColumn(t.endLineNumber)),c=t.startLineNumber-r,l=new Ss(c,1,c+o.length-1,o[o.length-1].length);s.push(KP.replace(h,o.join(`\n`))),n.push(l),r+=t.endLineNumber-t.startLineNumber+1-o.length}i.pushUndoStop(),i.executeEdits(this.id,s,o?n:void 0),i.pushUndoStop()}}),ku(yst),ku(class extends mu{constructor(){super({id:"editor.action.deleteLines",label:tt(0,"Delete Line"),alias:"Delete Line",precondition:Ox.writable,kbOpts:{kbExpr:Ox.textInputFocus,primary:3113,weight:100}})}run(t,i){if(!i.hasModel())return;const e=this._getLinesToRemove(i),s=i.getModel();if(s.getLineCount()===1&&s.getLineMaxColumn(1)===1)return;let n=0;const r=[],o=[];for(let t=0,i=e.length;t<i;t++){const i=e[t];let h=i.startLineNumber,c=i.endLineNumber,l=1,a=s.getLineMaxColumn(c);c<s.getLineCount()?(c+=1,a=1):h>1&&(h-=1,l=s.getLineMaxColumn(h)),r.push(KP.replace(new Ss(h,l,c,a),"")),o.push(new Ss(h-n,i.positionColumn,h-n,i.positionColumn)),n+=i.endLineNumber-i.startLineNumber+1}i.pushUndoStop(),i.executeEdits(this.id,r,o),i.pushUndoStop()}_getLinesToRemove(t){const i=t.getSelections().map((t=>{let i=t.endLineNumber;return t.startLineNumber<t.endLineNumber&&t.endColumn===1&&(i-=1),{startLineNumber:t.startLineNumber,selectionStartColumn:t.selectionStartColumn,endLineNumber:i,positionColumn:t.positionColumn}}));i.sort(((t,i)=>t.startLineNumber===i.startLineNumber?t.endLineNumber-i.endLineNumber:t.startLineNumber-i.startLineNumber));const e=[];let s=i[0];for(let t=1;t<i.length;t++)s.endLineNumber+1>=i[t].startLineNumber?s.endLineNumber=i[t].endLineNumber:(e.push(s),s=i[t]);return e.push(s),e}}),ku(class extends mu{constructor(){super({id:"editor.action.indentLines",label:tt(0,"Indent Line"),alias:"Indent Line",precondition:Ox.writable,kbOpts:{kbExpr:Ox.editorTextFocus,primary:2142,weight:100}})}run(t,i){const e=i._getViewModel();e&&(i.pushUndoStop(),i.executeCommands(this.id,Ex.indent(e.cursorConfig,i.getModel(),i.getSelections())),i.pushUndoStop())}}),ku(class extends mu{constructor(){super({id:"editor.action.outdentLines",label:tt(0,"Outdent Line"),alias:"Outdent Line",precondition:Ox.writable,kbOpts:{kbExpr:Ox.editorTextFocus,primary:2140,weight:100}})}run(t,i){Hx.Outdent.runEditorCommand(t,i,null)}}),ku(class extends mu{constructor(){super({id:"editor.action.insertLineBefore",label:tt(0,"Insert Line Above"),alias:"Insert Line Above",precondition:Ox.writable,kbOpts:{kbExpr:Ox.editorTextFocus,primary:3075,weight:100}})}run(t,i){const e=i._getViewModel();e&&(i.pushUndoStop(),i.executeCommands(this.id,Ex.lineInsertBefore(e.cursorConfig,i.getModel(),i.getSelections())))}}),ku(class extends mu{constructor(){super({id:"editor.action.insertLineAfter",label:tt(0,"Insert Line Below"),alias:"Insert Line Below",precondition:Ox.writable,kbOpts:{kbExpr:Ox.editorTextFocus,primary:2051,weight:100}})}run(t,i){const e=i._getViewModel();e&&(i.pushUndoStop(),i.executeCommands(this.id,Ex.lineInsertAfter(e.cursorConfig,i.getModel(),i.getSelections())))}}),ku(class extends kst{constructor(){super({id:"deleteAllLeft",label:tt(0,"Delete All Left"),alias:"Delete All Left",precondition:Ox.writable,kbOpts:{kbExpr:Ox.textInputFocus,primary:0,mac:{primary:2049},weight:100}})}_getEndCursorState(t,i){let e=null;const s=[];let n=0;return i.forEach((i=>{let r;if(i.endColumn===1&&n>0){const t=i.startLineNumber-n;r=new Ss(t,i.startColumn,t,i.startColumn)}else r=new Ss(i.startLineNumber,i.startColumn,i.startLineNumber,i.startColumn);n+=i.endLineNumber-i.startLineNumber,i.intersectRanges(t)?e=r:s.push(r)})),e&&s.unshift(e),s}_getRangesToDelete(t){const i=t.getSelections();if(i===null)return[];let e=i;const s=t.getModel();return s===null?[]:(e.sort(Cs.compareRangesUsingStarts),e=e.map((t=>{if(t.isEmpty()){if(t.startColumn===1){const i=Math.max(1,t.startLineNumber-1),e=t.startLineNumber===1?1:s.getLineLength(i)+1;return new Cs(i,e,t.startLineNumber,1)}return new Cs(t.startLineNumber,1,t.startLineNumber,t.startColumn)}return new Cs(t.startLineNumber,1,t.endLineNumber,t.endColumn)})),e)}}),ku(class extends kst{constructor(){super({id:"deleteAllRight",label:tt(0,"Delete All Right"),alias:"Delete All Right",precondition:Ox.writable,kbOpts:{kbExpr:Ox.textInputFocus,primary:0,mac:{primary:297,secondary:[2068]},weight:100}})}_getEndCursorState(t,i){let e=null;const s=[];for(let n=0,r=i.length,o=0;n<r;n++){const r=i[n],h=new Ss(r.startLineNumber-o,r.startColumn,r.startLineNumber-o,r.startColumn);r.intersectRanges(t)?e=h:s.push(h)}return e&&s.unshift(e),s}_getRangesToDelete(t){const i=t.getModel();if(i===null)return[];const e=t.getSelections();if(e===null)return[];const s=e.map((t=>{if(t.isEmpty()){const e=i.getLineMaxColumn(t.startLineNumber);return t.startColumn===e?new Cs(t.startLineNumber,t.startColumn,t.startLineNumber+1,1):new Cs(t.startLineNumber,t.startColumn,t.startLineNumber,e)}return t}));return s.sort(Cs.compareRangesUsingStarts),s}}),ku(class extends mu{constructor(){super({id:"editor.action.joinLines",label:tt(0,"Join Lines"),alias:"Join Lines",precondition:Ox.writable,kbOpts:{kbExpr:Ox.editorTextFocus,primary:0,mac:{primary:296},weight:100}})}run(t,i){const e=i.getSelections();if(e===null)return;let s=i.getSelection();if(s===null)return;e.sort(Cs.compareRangesUsingStarts);const n=[],r=e.reduce(((t,i)=>t.isEmpty()?t.endLineNumber===i.startLineNumber?(s.equalsSelection(t)&&(s=i),i):i.startLineNumber>t.endLineNumber+1?(n.push(t),i):new Ss(t.startLineNumber,t.startColumn,i.endLineNumber,i.endColumn):i.startLineNumber>t.endLineNumber?(n.push(t),i):new Ss(t.startLineNumber,t.startColumn,i.endLineNumber,i.endColumn)));n.push(r);const o=i.getModel();if(o===null)return;const h=[],c=[];let l=s,a=0;for(let t=0,i=n.length;t<i;t++){const i=n[t],e=i.startLineNumber,r=1;let u,d,f=0;const g=o.getLineLength(i.endLineNumber)-i.endColumn;if(i.isEmpty()||i.startLineNumber===i.endLineNumber){const t=i.getStartPosition();t.lineNumber<o.getLineCount()?(u=e+1,d=o.getLineMaxColumn(u)):(u=t.lineNumber,d=o.getLineMaxColumn(t.lineNumber))}else u=i.endLineNumber,d=o.getLineMaxColumn(u);let p=o.getLineContent(e);for(let t=e+1;t<=u;t++){const i=o.getLineContent(t),e=o.getLineFirstNonWhitespaceColumn(t);if(e>=1){let t=!0;p===""&&(t=!1),!t||p.charAt(p.length-1)!==" "&&p.charAt(p.length-1)!=="\t"||(t=!1,p=p.replace(/[\s\uFEFF\xA0]+$/g," "));const s=i.substr(e-1);p+=(t?" ":"")+s,f=t?s.length+1:s.length}else f=0}const m=new Cs(e,r,u,d);if(!m.isEmpty()){let t;i.isEmpty()?(h.push(KP.replace(m,p)),t=new Ss(m.startLineNumber-a,p.length-f+1,e-a,p.length-f+1)):i.startLineNumber===i.endLineNumber?(h.push(KP.replace(m,p)),t=new Ss(i.startLineNumber-a,i.startColumn,i.endLineNumber-a,i.endColumn)):(h.push(KP.replace(m,p)),t=new Ss(i.startLineNumber-a,i.startColumn,i.startLineNumber-a,p.length-g)),Cs.intersectRanges(m,s)!==null?l=t:c.push(t)}a+=m.endLineNumber-m.startLineNumber}c.unshift(l),i.pushUndoStop(),i.executeEdits(this.id,h,c),i.pushUndoStop()}}),ku(class extends mu{constructor(){super({id:"editor.action.transpose",label:tt(0,"Transpose Characters around the Cursor"),alias:"Transpose Characters around the Cursor",precondition:Ox.writable})}run(t,i){const e=i.getSelections();if(e===null)return;const s=i.getModel();if(s===null)return;const n=[];for(let t=0,i=e.length;t<i;t++){const i=e[t];if(!i.isEmpty())continue;const r=i.getStartPosition(),o=s.getLineMaxColumn(r.lineNumber);if(r.column>=o){if(r.lineNumber===s.getLineCount())continue;const t=new Cs(r.lineNumber,Math.max(1,r.column-1),r.lineNumber+1,1),i=s.getValueInRange(t).split("").reverse().join("");n.push(new ix(new Ss(r.lineNumber,Math.max(1,r.column-1),r.lineNumber+1,1),i))}else{const t=new Cs(r.lineNumber,Math.max(1,r.column-1),r.lineNumber,r.column+1),i=s.getValueInRange(t).split("").reverse().join("");n.push(new rx(t,i,new Ss(r.lineNumber,r.column+1,r.lineNumber,r.column+1)))}}i.pushUndoStop(),i.executeCommands(this.id,n),i.pushUndoStop()}}),ku(class extends Cst{constructor(){super({id:"editor.action.transformToUppercase",label:tt(0,"Transform to Uppercase"),alias:"Transform to Uppercase",precondition:Ox.writable})}_modifyText(t,i){return t.toLocaleUpperCase()}}),ku(class extends Cst{constructor(){super({id:"editor.action.transformToLowercase",label:tt(0,"Transform to Lowercase"),alias:"Transform to Lowercase",precondition:Ox.writable})}_modifyText(t,i){return t.toLocaleLowerCase()}}),Dst.caseBoundary.isSupported()&&Dst.singleLetters.isSupported()&&ku(Dst),Est.wordBoundary.isSupported()&&ku(Est),Ast.wordBoundary.isSupported()&&ku(Ast),xst.titleBoundary.isSupported()&&ku(xst),Mst.isSupported()&&ku(Mst);var Lst,Fst=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Tst=function(t,i){return function(e,s){i(e,s,t)}};const Rst=new Ta("LinkedEditingInputVisible",!1);let Ost=Lst=class extends Qi{static get(t){return t.getContribution(Lst.ID)}constructor(t,i,e,s,n){super(),this.languageConfigurationService=s,this._syncRangesToken=0,this._localToDispose=this._register(new Ji),this._editor=t,this._providers=e.linkedEditingRangeProvider,this._enabled=!1,this._visibleContextKey=Rst.bindTo(i),this._debounceInformation=n.for(this._providers,"Linked Editing",{max:200}),this._currentDecorations=this._editor.createDecorationsCollection(),this._languageWordPattern=null,this._currentWordPattern=null,this._ignoreChangeEvent=!1,this._localToDispose=this._register(new Ji),this._rangeUpdateTriggerPromise=null,this._rangeSyncTriggerPromise=null,this._currentRequestCts=null,this._currentRequestPosition=null,this._currentRequestModelVersion=null,this._register(this._editor.onDidChangeModel((()=>this.reinitialize(!0)))),this._register(this._editor.onDidChangeConfiguration((t=>{(t.hasChanged(70)||t.hasChanged(93))&&this.reinitialize(!1)}))),this._register(this._providers.onDidChange((()=>this.reinitialize(!1)))),this._register(this._editor.onDidChangeModelLanguage((()=>this.reinitialize(!0)))),this.reinitialize(!0)}reinitialize(t){const i=this._editor.getModel(),e=i!==null&&(this._editor.getOption(70)||this._editor.getOption(93))&&this._providers.has(i);if(e===this._enabled&&!t||(this._enabled=e,this.clearRanges(),this._localToDispose.clear(),!e||i===null))return;this._localToDispose.add(ne.runAndSubscribe(i.onDidChangeLanguageConfiguration,(()=>{this._languageWordPattern=this.languageConfigurationService.getLanguageConfiguration(i.getLanguageId()).getWordDefinition()})));const s=new po(this._debounceInformation.get(i)),n=()=>{var t;this._rangeUpdateTriggerPromise=s.trigger((()=>this.updateRanges()),(t=this._debounceDuration)!==null&&t!==void 0?t:this._debounceInformation.get(i))},r=new po(0),o=t=>{this._rangeSyncTriggerPromise=r.trigger((()=>this._syncRanges(t)))};this._localToDispose.add(this._editor.onDidChangeCursorPosition((()=>{n()}))),this._localToDispose.add(this._editor.onDidChangeModelContent((t=>{if(!this._ignoreChangeEvent&&this._currentDecorations.length>0){const i=this._currentDecorations.getRange(0);if(i&&t.changes.every((t=>i.intersectRanges(t.range))))return void o(this._syncRangesToken)}n()}))),this._localToDispose.add({dispose:()=>{s.dispose(),r.dispose()}}),this.updateRanges()}_syncRanges(t){if(!this._editor.hasModel()||t!==this._syncRangesToken||this._currentDecorations.length===0)return;const i=this._editor.getModel(),e=this._currentDecorations.getRange(0);if(!e||e.startLineNumber!==e.endLineNumber)return this.clearRanges();const s=i.getValueInRange(e);if(this._currentWordPattern){const t=s.match(this._currentWordPattern);if((t?t[0].length:0)!==s.length)return this.clearRanges()}const n=[];for(let t=1,e=this._currentDecorations.length;t<e;t++){const e=this._currentDecorations.getRange(t);if(e)if(e.startLineNumber!==e.endLineNumber)n.push({range:e,text:s});else{let t=i.getValueInRange(e),r=s,o=e.startColumn,h=e.endColumn;const c=dr(t,r);o+=c,t=t.substr(c),r=r.substr(c);const l=fr(t,r);h-=l,t=t.substr(0,t.length-l),r=r.substr(0,r.length-l),o===h&&r.length===0||n.push({range:new Cs(e.startLineNumber,o,e.endLineNumber,h),text:r})}}if(n.length!==0)try{this._editor.popUndoStop(),this._ignoreChangeEvent=!0;const t=this._editor._getViewModel().getPrevEditOperationType();this._editor.executeEdits("linkedEditing",n),this._editor._getViewModel().setPrevEditOperationType(t)}finally{this._ignoreChangeEvent=!1}}dispose(){this.clearRanges(),super.dispose()}clearRanges(){this._visibleContextKey.set(!1),this._currentDecorations.clear(),this._currentRequestCts&&(this._currentRequestCts.cancel(),this._currentRequestCts=null,this._currentRequestPosition=null)}async updateRanges(t=!1){if(!this._editor.hasModel())return void this.clearRanges();const i=this._editor.getPosition();if(!this._enabled&&!t||this._editor.getSelections().length>1)return void this.clearRanges();const e=this._editor.getModel(),s=e.getVersionId();if(this._currentRequestPosition&&this._currentRequestModelVersion===s){if(i.equals(this._currentRequestPosition))return;if(this._currentDecorations.length>0){const t=this._currentDecorations.getRange(0);if(t&&t.containsPosition(i))return}}this.clearRanges(),this._currentRequestPosition=i,this._currentRequestModelVersion=s;const n=this._currentRequestCts=new ye;try{const t=new se(!1),r=await Ist(this._providers,e,i,n.token);if(this._debounceInformation.update(e,t.elapsed()),n!==this._currentRequestCts||(this._currentRequestCts=null,s!==e.getVersionId()))return;let o=[];r!=null&&r.ranges&&(o=r.ranges),this._currentWordPattern=(r==null?void 0:r.wordPattern)||this._languageWordPattern;let h=!1;for(let t=0,e=o.length;t<e;t++)if(Cs.containsPosition(o[t],i)){if(h=!0,t!==0){const i=o[t];o.splice(t,1),o.unshift(i)}break}if(!h)return void this.clearRanges();const c=o.map((t=>({range:t,options:Lst.DECORATION})));this._visibleContextKey.set(!0),this._currentDecorations.set(c),this._syncRangesToken++}catch(t){Bi(t)||Ii(t),this._currentRequestCts!==n&&this._currentRequestCts||this.clearRanges()}}};Ost.ID="editor.contrib.linkedEditing",Ost.DECORATION=xF.register({description:"linked-editing",stickiness:0,className:"linked-editing-decoration"}),Ost=Lst=Fst([Tst(1,Ra),Tst(2,$p),Tst(3,cf),Tst(4,lO)],Ost);function Ist(t,i,e,s){return bo(t.ordered(i).map((t=>async()=>{try{return await t.provideLinkedEditingRanges(i,e,s)}catch(t){return void _i(t)}})),(t=>!!t&&f(t==null?void 0:t.ranges)))}yu(new(pu.bindToContribution(Ost.get))({id:"cancelLinkedEditingInput",precondition:Rst,handler:t=>t.clearRanges(),kbOpts:{kbExpr:Ox.editorTextFocus,weight:199,primary:9,secondary:[1033]}})),Iw("editor.linkedEditingBackground",{dark:kp.fromHex("#f00").transparent(.3),light:kp.fromHex("#f00").transparent(.3),hcDark:kp.fromHex("#f00").transparent(.3),hcLight:kp.white},tt(0,"Background color when the editor auto renames on type.")),bu("_executeLinkedEditingProvider",((t,i,e)=>{const{linkedEditingRangeProvider:s}=t.get($p);return Ist(s,i,e,ve.None)})),Su(Ost.ID,Ost,1),ku(class extends mu{constructor(){super({id:"editor.action.linkedEditing",label:tt(0,"Start Linked Editing"),alias:"Start Linked Editing",precondition:ua.and(Ox.writable,Ox.hasRenameProvider),kbOpts:{kbExpr:Ox.editorTextFocus,primary:3132,weight:100}})}runCommand(t,i){const e=t.get(Pl),[s,n]=Array.isArray(i)&&i||[void 0,void 0];return as.isUri(s)&&ks.isIPosition(n)?e.openCodeEditor({resource:s},e.getActiveCodeEditor()).then((t=>{t&&(t.setPosition(n),t.invokeWithinContext((i=>(this.reportTelemetry(i,t),this.run(i,t)))))}),Ii):super.runCommand(t,i)}run(t,i){const e=Ost.get(i);return e?Promise.resolve(e.updateRanges(!0)):Promise.resolve()}});let _st=class{constructor(t,i){this._link=t,this._provider=i}toJSON(){return{range:this.range,url:this.url,tooltip:this.tooltip}}get range(){return this._link.range}get url(){return this._link.url}get tooltip(){return this._link.tooltip}async resolve(t){return this._link.url?this._link.url:typeof this._provider.resolveLink=="function"?Promise.resolve(this._provider.resolveLink(this._link,t)).then((i=>(this._link=i||this._link,this._link.url?this.resolve(t):Promise.reject(new Error("missing"))))):Promise.reject(new Error("missing"))}};class Pst{constructor(t){this._disposables=new Ji;let i=[];for(const[e,s]of t){const t=e.links.map((t=>new _st(t,s)));i=Pst._union(i,t),Ki(e)&&this._disposables.add(e)}this.links=i}dispose(){this._disposables.dispose(),this.links.length=0}static _union(t,i){const e=[];let s,n,r,o;for(s=0,r=0,n=t.length,o=i.length;s<n&&r<o;){const n=t[s],o=i[r];if(Cs.areIntersectingOrTouching(n.range,o.range)){s++;continue}Cs.compareRangesUsingStarts(n.range,o.range)<0?(e.push(n),s++):(e.push(o),r++)}for(;s<n;s++)e.push(t[s]);for(;r<o;r++)e.push(i[r]);return e}}function Nst(t,i,e){const s=[],n=t.ordered(i).reverse().map(((t,n)=>Promise.resolve(t.provideLinks(i,e)).then((i=>{i&&(s[n]=[i,t])}),_i)));return Promise.all(n).then((()=>{const t=new Pst(a(s));return e.isCancellationRequested?(t.dispose(),new Pst([])):t}))}Gl.registerCommand("_executeLinkProvider",(async(t,...i)=>{let[e,s]=i;j(e instanceof as),typeof s!="number"&&(s=0);const{linkProvider:n}=t.get($p),r=t.get(Nl).getModel(e);if(!r)return[];const o=await Nst(n,r,ve.None);if(!o)return[];for(let t=0;t<Math.min(s,o.links.length);t++)await o.links[t].resolve(ve.None);const h=o.links.slice(0);return o.dispose(),h}));var Bst,$st=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Wst=function(t,i){return function(e,s){i(e,s,t)}};let jst=Bst=class extends Qi{static get(t){return t.getContribution(Bst.ID)}constructor(t,i,e,s,n){super(),this.editor=t,this.openerService=i,this.notificationService=e,this.languageFeaturesService=s,this.providers=this.languageFeaturesService.linkProvider,this.debounceInformation=n.for(this.providers,"Links",{min:1e3,max:4e3}),this.computeLinks=this._register(new Co((()=>this.computeLinksNow()),1e3)),this.computePromise=null,this.activeLinksList=null,this.currentOccurrences={},this.activeLinkDecorationId=null;const r=this._register(new o4(t));this._register(r.onMouseMoveOrRelevantKeyDown((([t,i])=>{this._onEditorMouseMove(t,i)}))),this._register(r.onExecute((t=>{this.onEditorMouseUp(t)}))),this._register(r.onCancel((t=>{this.cleanUpActiveLinkDecoration()}))),this._register(t.onDidChangeConfiguration((t=>{t.hasChanged(71)&&(this.updateDecorations([]),this.stop(),this.computeLinks.schedule(0))}))),this._register(t.onDidChangeModelContent((t=>{this.editor.hasModel()&&this.computeLinks.schedule(this.debounceInformation.get(this.editor.getModel()))}))),this._register(t.onDidChangeModel((t=>{this.currentOccurrences={},this.activeLinkDecorationId=null,this.stop(),this.computeLinks.schedule(0)}))),this._register(t.onDidChangeModelLanguage((t=>{this.stop(),this.computeLinks.schedule(0)}))),this._register(this.providers.onDidChange((t=>{this.stop(),this.computeLinks.schedule(0)}))),this.computeLinks.schedule(0)}async computeLinksNow(){if(!this.editor.hasModel()||!this.editor.getOption(71))return;const t=this.editor.getModel();if(!t.isTooLargeForSyncing()&&this.providers.has(t)){this.activeLinksList&&(this.activeLinksList.dispose(),this.activeLinksList=null),this.computePromise=uo((i=>Nst(this.providers,t,i)));try{const i=new se(!1);if(this.activeLinksList=await this.computePromise,this.debounceInformation.update(t,i.elapsed()),t.isDisposed())return;this.updateDecorations(this.activeLinksList.links)}catch(t){Ii(t)}finally{this.computePromise=null}}}updateDecorations(t){const i=this.editor.getOption(78)==="altKey",e=[],s=Object.keys(this.currentOccurrences);for(const t of s){const i=this.currentOccurrences[t];e.push(i.decorationId)}const n=[];if(t)for(const e of t)n.push(zst.decoration(e,i));this.editor.changeDecorations((i=>{const s=i.deltaDecorations(e,n);this.currentOccurrences={},this.activeLinkDecorationId=null;for(let i=0,e=s.length;i<e;i++){const e=new zst(t[i],s[i]);this.currentOccurrences[e.decorationId]=e}}))}_onEditorMouseMove(t,i){const e=this.editor.getOption(78)==="altKey";if(this.isEnabled(t,i)){this.cleanUpActiveLinkDecoration();const i=this.getLinkOccurrence(t.target.position);i&&this.editor.changeDecorations((t=>{i.activate(t,e),this.activeLinkDecorationId=i.decorationId}))}else this.cleanUpActiveLinkDecoration()}cleanUpActiveLinkDecoration(){const t=this.editor.getOption(78)==="altKey";if(this.activeLinkDecorationId){const i=this.currentOccurrences[this.activeLinkDecorationId];i&&this.editor.changeDecorations((e=>{i.deactivate(e,t)})),this.activeLinkDecorationId=null}}onEditorMouseUp(t){if(!this.isEnabled(t))return;const i=this.getLinkOccurrence(t.target.position);i&&this.openLinkOccurrence(i,t.hasSideBySideModifier,!0)}openLinkOccurrence(t,i,e=!1){if(!this.openerService)return;const{link:s}=t;s.resolve(ve.None).then((t=>{if(typeof t=="string"&&this.editor.hasModel()){const i=this.editor.getModel().uri;if(i.scheme===Lh.file&&t.startsWith(`${Lh.file}:`)){const e=as.parse(t);if(e.scheme===Lh.file){const s=bM(e);let n=null;s.startsWith("/./")||s.startsWith("\\.\\")?n=`.${s.substr(1)}`:(s.startsWith("//./")||s.startsWith("\\\\.\\"))&&(n=`.${s.substr(2)}`),n&&(t=EM(i,n))}}}return this.openerService.open(t,{openToSide:i,fromUserGesture:e,allowContributedOpeners:!0,allowCommands:!0,fromWorkspace:!0})}),(t=>{const i=t instanceof Error?t.message:t;i==="invalid"?this.notificationService.warn(tt(0,"Failed to open this link because it is not well-formed: {0}",s.url.toString())):i==="missing"?this.notificationService.warn(tt(0,"Failed to open this link because its target is missing.")):Ii(t)}))}getLinkOccurrence(t){if(!this.editor.hasModel()||!t)return null;const i=this.editor.getModel().getDecorationsInRange({startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:t.lineNumber,endColumn:t.column},0,!0);for(const t of i){const i=this.currentOccurrences[t.id];if(i)return i}return null}isEnabled(t,i){return!!(t.target.type===6&&(t.hasTriggerModifier||i&&i.keyCodeIsTriggerKey))}stop(){var t;this.computeLinks.cancel(),this.activeLinksList&&((t=this.activeLinksList)===null||t===void 0||t.dispose(),this.activeLinksList=null),this.computePromise&&(this.computePromise.cancel(),this.computePromise=null)}dispose(){super.dispose(),this.stop()}};jst.ID="editor.linkDetector",jst=Bst=$st([Wst(1,uI),Wst(2,gR),Wst(3,$p),Wst(4,lO)],jst);const Hst=xF.register({description:"detected-link",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link"}),Vst=xF.register({description:"detected-link-active",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link-active"});class zst{static decoration(t,i){return{range:t.range,options:zst._getOptions(t,i,!1)}}static _getOptions(t,i,e){const s={...e?Vst:Hst};return s.hoverMessage=function(t,i){const e=t.url&&/^command:/i.test(t.url.toString()),s=t.tooltip?t.tooltip:tt(0,e?"Execute command":"Follow link"),n=tt(0,i?bt?"cmd + click":"ctrl + click":bt?"option + click":"alt + click");if(t.url){let i="";if(/^command:/i.test(t.url.toString())){const e=t.url.toString().match(/^command:([^?#]+)/);e&&(i=tt(0,"Execute command {0}",e[1]))}return new F_("",!0).appendLink(t.url.toString(!0).replace(/ /g,"%20"),s,i).appendMarkdown(` (${n})`)}return(new F_).appendText(`${s} (${n})`)}(t,i),s}constructor(t,i){this.link=t,this.decorationId=i}activate(t,i){t.changeDecorationOptions(this.decorationId,zst._getOptions(this.link,i,!0))}deactivate(t,i){t.changeDecorationOptions(this.decorationId,zst._getOptions(this.link,i,!1))}}Su(jst.ID,jst,1),ku(class extends mu{constructor(){super({id:"editor.action.openLink",label:tt(0,"Open Link"),alias:"Open Link",precondition:void 0})}run(t,i){const e=jst.get(i);if(!e||!i.hasModel())return;const s=i.getSelections();for(const t of s){const i=e.getLinkOccurrence(t.getEndPosition());i&&e.openLinkOccurrence(i,!1)}}});class Ust extends Qi{constructor(t){super(),this._editor=t,this._register(this._editor.onMouseDown((t=>{const i=this._editor.getOption(117);i>=0&&t.target.type===6&&t.target.position.column>=i&&this._editor.updateOptions({stopRenderingLineAfter:-1})})))}}Ust.ID="editor.contrib.longLinesHelper",Su(Ust.ID,Ust,2);const Kst=Iw("editor.wordHighlightBackground",{dark:"#575757B8",light:"#57575740",hcDark:null,hcLight:null},tt(0,"Background color of a symbol during read-access, like reading a variable. The color must not be opaque so as not to hide underlying decorations."),!0);Iw("editor.wordHighlightStrongBackground",{dark:"#004972B8",light:"#0e639c40",hcDark:null,hcLight:null},tt(0,"Background color of a symbol during write-access, like writing to a variable. The color must not be opaque so as not to hide underlying decorations."),!0),Iw("editor.wordHighlightTextBackground",{light:Kst,dark:Kst,hcDark:Kst,hcLight:Kst},tt(0,"Background color of a textual occurrence for a symbol. The color must not be opaque so as not to hide underlying decorations."),!0);const qst=Iw("editor.wordHighlightBorder",{light:null,dark:null,hcDark:Gw,hcLight:Gw},tt(0,"Border color of a symbol during read-access, like reading a variable."));Iw("editor.wordHighlightStrongBorder",{light:null,dark:null,hcDark:Gw,hcLight:Gw},tt(0,"Border color of a symbol during write-access, like writing to a variable.")),Iw("editor.wordHighlightTextBorder",{light:qst,dark:qst,hcDark:qst,hcLight:qst},tt(0,"Border color of a textual occurrence for a symbol."));const Gst=Iw("editorOverviewRuler.wordHighlightForeground",{dark:"#A0A0A0CC",light:"#A0A0A0CC",hcDark:"#A0A0A0CC",hcLight:"#A0A0A0CC"},tt(0,"Overview ruler marker color for symbol highlights. The color must not be opaque so as not to hide underlying decorations."),!0),Zst=Iw("editorOverviewRuler.wordHighlightStrongForeground",{dark:"#C0A0C0CC",light:"#C0A0C0CC",hcDark:"#C0A0C0CC",hcLight:"#C0A0C0CC"},tt(0,"Overview ruler marker color for write-access symbol highlights. The color must not be opaque so as not to hide underlying decorations."),!0),Jst=Iw("editorOverviewRuler.wordHighlightTextForeground",{dark:ib,light:ib,hcDark:ib,hcLight:ib},tt(0,"Overview ruler marker color of a textual occurrence for a symbol. The color must not be opaque so as not to hide underlying decorations."),!0),Qst=xF.register({description:"word-highlight-strong",stickiness:1,className:"wordHighlightStrong",overviewRuler:{color:MC(Zst),position:Yf.Center},minimap:{color:MC(ob),position:1}}),Yst=xF.register({description:"word-highlight-text",stickiness:1,className:"wordHighlightText",overviewRuler:{color:MC(Jst),position:Yf.Center},minimap:{color:MC(ob),position:1}}),Xst=xF.register({description:"selection-highlight-overview",stickiness:1,className:"selectionHighlight",overviewRuler:{color:MC(ib),position:Yf.Center},minimap:{color:MC(ob),position:1}}),tnt=xF.register({description:"selection-highlight",stickiness:1,className:"selectionHighlight"}),int=xF.register({description:"word-highlight",stickiness:1,className:"wordHighlight",overviewRuler:{color:MC(Gst),position:Yf.Center},minimap:{color:MC(ob),position:1}});function ent(t){return t?tnt:Xst}RC(((t,i)=>{const e=t.getColor(yv);e&&i.addRule(`.monaco-editor .selectionHighlight { background-color: ${e.transparent(.5)}; }`)}));var snt,nnt=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},rnt=function(t,i){return function(e,s){i(e,s,t)}};function ont(t,i){const e=i.filter((i=>!t.find((t=>t.equals(i)))));if(e.length>=1){const t=e.map((t=>`line ${t.viewState.position.lineNumber} column ${t.viewState.position.column}`)).join(", ");ow(e.length===1?tt(0,"Cursor added: {0}",t):tt(0,"Cursors added: {0}",t))}}class hnt{constructor(t,i,e){this.selections=t,this.revealRange=i,this.revealScrollType=e}}class cnt{static create(t,i){if(!t.hasModel())return null;const e=i.getState();if(!t.hasTextFocus()&&e.isRevealed&&e.searchString.length>0)return new cnt(t,i,!1,e.searchString,e.wholeWord,e.matchCase,null);let s,n,r=!1;const o=t.getSelections();o.length===1&&o[0].isEmpty()?(r=!0,s=!0,n=!0):(s=e.wholeWord,n=e.matchCase);const h=t.getSelection();let c,l=null;if(h.isEmpty()){const i=t.getConfiguredWordAtPosition(h.getStartPosition());if(!i)return null;c=i.word,l=new Ss(h.startLineNumber,i.startColumn,h.startLineNumber,i.endColumn)}else c=t.getModel().getValueInRange(h).replace(/\r\n/g,`\n`);return new cnt(t,i,r,c,s,n,l)}constructor(t,i,e,s,n,r,o){this._editor=t,this.findController=i,this.isDisconnectedFromFindController=e,this.searchText=s,this.wholeWord=n,this.matchCase=r,this.currentMatch=o}addSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const t=this._getNextMatch();if(!t)return null;const i=this._editor.getSelections();return new hnt(i.concat(t),t,0)}moveSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const t=this._getNextMatch();if(!t)return null;const i=this._editor.getSelections();return new hnt(i.slice(0,i.length-1).concat(t),t,0)}_getNextMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const t=this.currentMatch;return this.currentMatch=null,t}this.findController.highlightFindOptions();const t=this._editor.getSelections(),i=t[t.length-1],e=this._editor.getModel().findNextMatch(this.searchText,i.getEndPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(131):null,!1);return e?new Ss(e.range.startLineNumber,e.range.startColumn,e.range.endLineNumber,e.range.endColumn):null}addSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const t=this._getPreviousMatch();if(!t)return null;const i=this._editor.getSelections();return new hnt(i.concat(t),t,0)}moveSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const t=this._getPreviousMatch();if(!t)return null;const i=this._editor.getSelections();return new hnt(i.slice(0,i.length-1).concat(t),t,0)}_getPreviousMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const t=this.currentMatch;return this.currentMatch=null,t}this.findController.highlightFindOptions();const t=this._editor.getSelections(),i=t[t.length-1],e=this._editor.getModel().findPreviousMatch(this.searchText,i.getStartPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(131):null,!1);return e?new Ss(e.range.startLineNumber,e.range.startColumn,e.range.endLineNumber,e.range.endColumn):null}selectAll(t){if(!this._editor.hasModel())return[];this.findController.highlightFindOptions();const i=this._editor.getModel();return t?i.findMatches(this.searchText,t,!1,this.matchCase,this.wholeWord?this._editor.getOption(131):null,!1,1073741824):i.findMatches(this.searchText,!0,!1,this.matchCase,this.wholeWord?this._editor.getOption(131):null,!1,1073741824)}}class lnt extends Qi{static get(t){return t.getContribution(lnt.ID)}constructor(t){super(),this._sessionDispose=this._register(new Ji),this._editor=t,this._ignoreSelectionChange=!1,this._session=null}dispose(){this._endSession(),super.dispose()}_beginSessionIfNeeded(t){if(!this._session){const i=cnt.create(this._editor,t);if(!i)return;this._session=i;const e={searchString:this._session.searchText};this._session.isDisconnectedFromFindController&&(e.wholeWordOverride=1,e.matchCaseOverride=1,e.isRegexOverride=2),t.getState().change(e,!1),this._sessionDispose.add(this._editor.onDidChangeCursorSelection((t=>{this._ignoreSelectionChange||this._endSession()}))),this._sessionDispose.add(this._editor.onDidBlurEditorText((()=>{this._endSession()}))),this._sessionDispose.add(t.getState().onFindReplaceStateChange((t=>{(t.matchCase||t.wholeWord)&&this._endSession()})))}}_endSession(){if(this._sessionDispose.clear(),this._session&&this._session.isDisconnectedFromFindController){const t={wholeWordOverride:0,matchCaseOverride:0,isRegexOverride:0};this._session.findController.getState().change(t,!1)}this._session=null}_setSelections(t){this._ignoreSelectionChange=!0,this._editor.setSelections(t),this._ignoreSelectionChange=!1}_expandEmptyToWord(t,i){if(!i.isEmpty())return i;const e=this._editor.getConfiguredWordAtPosition(i.getStartPosition());return e?new Ss(i.startLineNumber,e.startColumn,i.startLineNumber,e.endColumn):i}_applySessionResult(t){t&&(this._setSelections(t.selections),t.revealRange&&this._editor.revealRangeInCenterIfOutsideViewport(t.revealRange,t.revealScrollType))}getSession(t){return this._session}addSelectionToNextFindMatch(t){if(this._editor.hasModel()){if(!this._session){const i=this._editor.getSelections();if(i.length>1){const e=t.getState().matchCase;if(!fnt(this._editor.getModel(),i,e)){const t=this._editor.getModel(),e=[];for(let s=0,n=i.length;s<n;s++)e[s]=this._expandEmptyToWord(t,i[s]);return void this._editor.setSelections(e)}}}this._beginSessionIfNeeded(t),this._session&&this._applySessionResult(this._session.addSelectionToNextFindMatch())}}addSelectionToPreviousFindMatch(t){this._beginSessionIfNeeded(t),this._session&&this._applySessionResult(this._session.addSelectionToPreviousFindMatch())}moveSelectionToNextFindMatch(t){this._beginSessionIfNeeded(t),this._session&&this._applySessionResult(this._session.moveSelectionToNextFindMatch())}moveSelectionToPreviousFindMatch(t){this._beginSessionIfNeeded(t),this._session&&this._applySessionResult(this._session.moveSelectionToPreviousFindMatch())}selectAll(t){if(!this._editor.hasModel())return;let i=null;const e=t.getState();if(e.isRevealed&&e.searchString.length>0&&e.isRegex){const t=this._editor.getModel();i=e.searchScope?t.findMatches(e.searchString,e.searchScope,e.isRegex,e.matchCase,e.wholeWord?this._editor.getOption(131):null,!1,1073741824):t.findMatches(e.searchString,!0,e.isRegex,e.matchCase,e.wholeWord?this._editor.getOption(131):null,!1,1073741824)}else{if(this._beginSessionIfNeeded(t),!this._session)return;i=this._session.selectAll(e.searchScope)}if(i.length>0){const t=this._editor.getSelection();for(let e=0,s=i.length;e<s;e++){const s=i[e];if(s.range.intersectRanges(t)){i[e]=i[0],i[0]=s;break}}this._setSelections(i.map((t=>new Ss(t.range.startLineNumber,t.range.startColumn,t.range.endLineNumber,t.range.endColumn))))}}}lnt.ID="editor.contrib.multiCursorController";class ant extends mu{run(t,i){const e=lnt.get(i);if(!e)return;const s=i._getViewModel();if(s){const n=s.getCursorStates(),r=M7.get(i);if(r)this._run(e,r);else{const s=t.get(Il).createInstance(M7,i);this._run(e,s),s.dispose()}ont(n,s.getCursorStates())}}}class unt{constructor(t,i,e,s,n){this._model=t,this._searchText=i,this._matchCase=e,this._wordSeparators=s,this._modelVersionId=this._model.getVersionId(),this._cachedFindMatches=null,n&&this._model===n._model&&this._searchText===n._searchText&&this._matchCase===n._matchCase&&this._wordSeparators===n._wordSeparators&&this._modelVersionId===n._modelVersionId&&(this._cachedFindMatches=n._cachedFindMatches)}findMatches(){return this._cachedFindMatches===null&&(this._cachedFindMatches=this._model.findMatches(this._searchText,!0,!1,this._matchCase,this._wordSeparators,!1).map((t=>t.range)),this._cachedFindMatches.sort(Cs.compareRangesUsingStarts)),this._cachedFindMatches}}let dnt=snt=class extends Qi{constructor(t,i){super(),this._languageFeaturesService=i,this.editor=t,this._isEnabled=t.getOption(108),this._decorations=t.createDecorationsCollection(),this.updateSoon=this._register(new Co((()=>this._update()),300)),this.state=null,this._register(t.onDidChangeConfiguration((i=>{this._isEnabled=t.getOption(108)}))),this._register(t.onDidChangeCursorSelection((t=>{this._isEnabled&&(t.selection.isEmpty()?t.reason===3?(this.state&&this._setState(null),this.updateSoon.schedule()):this._setState(null):this._update())}))),this._register(t.onDidChangeModel((t=>{this._setState(null)}))),this._register(t.onDidChangeModelContent((t=>{this._isEnabled&&this.updateSoon.schedule()})));const e=M7.get(t);e&&this._register(e.getState().onFindReplaceStateChange((t=>{this._update()}))),this.updateSoon.schedule()}_update(){this._setState(snt._createState(this.state,this._isEnabled,this.editor))}static _createState(t,i,e){if(!i||!e.hasModel())return null;const s=e.getSelection();if(s.startLineNumber!==s.endLineNumber)return null;const n=lnt.get(e);if(!n)return null;const r=M7.get(e);if(!r)return null;let o=n.getSession(r);if(!o){const t=e.getSelections();if(t.length>1){const i=r.getState().matchCase;if(!fnt(e.getModel(),t,i))return null}o=cnt.create(e,r)}if(!o||o.currentMatch||/^[ \t]+$/.test(o.searchText)||o.searchText.length>200)return null;const h=r.getState(),c=h.matchCase;if(h.isRevealed){let t=h.searchString;c||(t=t.toLowerCase());let i=o.searchText;if(c||(i=i.toLowerCase()),t===i&&o.matchCase===h.matchCase&&o.wholeWord===h.wholeWord&&!h.isRegex)return null}return new unt(e.getModel(),o.searchText,o.matchCase,o.wholeWord?e.getOption(131):null,t)}_setState(t){if(this.state=t,!this.state)return void this._decorations.clear();if(!this.editor.hasModel())return;const i=this.editor.getModel();if(i.isTooLargeForTokenization())return;const e=this.state.findMatches(),s=this.editor.getSelections();s.sort(Cs.compareRangesUsingStarts);const n=[];for(let t=0,i=0,r=e.length,o=s.length;t<r;){const r=e[t];if(i>=o)n.push(r),t++;else{const e=Cs.compareRangesUsingStarts(r,s[i]);e<0?(!s[i].isEmpty()&&Cs.areIntersecting(r,s[i])||n.push(r),t++):(e>0||t++,i++)}}const r=this.editor.getOption(81)!=="off",o=this._languageFeaturesService.documentHighlightProvider.has(i)&&r,h=n.map((t=>({range:t,options:ent(o)})));this._decorations.set(h)}dispose(){this._setState(null),super.dispose()}};function fnt(t,i,e){const s=gnt(t,i[0],!e);for(let n=1,r=i.length;n<r;n++){const r=i[n];if(r.isEmpty()||s!==gnt(t,r,!e))return!1}return!0}function gnt(t,i,e){const s=t.getValueInRange(i);return e?s.toLowerCase():s}dnt.ID="editor.contrib.selectionHighlighter",dnt=snt=nnt([rnt(1,$p)],dnt);Su(lnt.ID,lnt,4),Su(dnt.ID,dnt,1),ku(class extends mu{constructor(){super({id:"editor.action.insertCursorAbove",label:tt(0,"Add Cursor Above"),alias:"Add Cursor Above",precondition:void 0,kbOpts:{kbExpr:Ox.editorTextFocus,primary:2576,linux:{primary:1552,secondary:[3088]},weight:100},menuOpts:{menuId:Qa.MenubarSelectionMenu,group:"3_multi",title:tt(0,"&&Add Cursor Above"),order:2}})}run(t,i,e){if(!i.hasModel())return;let s=!0;e&&e.logicalLine===!1&&(s=!1);const n=i._getViewModel();if(n.cursorConfig.readOnly)return;n.model.pushStackElement();const r=n.getCursorStates();n.setCursorStates(e.source,3,dx.addCursorUp(n,r,s)),n.revealTopMostCursor(e.source),ont(r,n.getCursorStates())}}),ku(class extends mu{constructor(){super({id:"editor.action.insertCursorBelow",label:tt(0,"Add Cursor Below"),alias:"Add Cursor Below",precondition:void 0,kbOpts:{kbExpr:Ox.editorTextFocus,primary:2578,linux:{primary:1554,secondary:[3090]},weight:100},menuOpts:{menuId:Qa.MenubarSelectionMenu,group:"3_multi",title:tt(0,"A&&dd Cursor Below"),order:3}})}run(t,i,e){if(!i.hasModel())return;let s=!0;e&&e.logicalLine===!1&&(s=!1);const n=i._getViewModel();if(n.cursorConfig.readOnly)return;n.model.pushStackElement();const r=n.getCursorStates();n.setCursorStates(e.source,3,dx.addCursorDown(n,r,s)),n.revealBottomMostCursor(e.source),ont(r,n.getCursorStates())}}),ku(class extends mu{constructor(){super({id:"editor.action.insertCursorAtEndOfEachLineSelected",label:tt(0,"Add Cursors to Line Ends"),alias:"Add Cursors to Line Ends",precondition:void 0,kbOpts:{kbExpr:Ox.editorTextFocus,primary:1575,weight:100},menuOpts:{menuId:Qa.MenubarSelectionMenu,group:"3_multi",title:tt(0,"Add C&&ursors to Line Ends"),order:4}})}getCursorsForSelection(t,i,e){if(!t.isEmpty()){for(let s=t.startLineNumber;s<t.endLineNumber;s++){const t=i.getLineMaxColumn(s);e.push(new Ss(s,t,s,t))}t.endColumn>1&&e.push(new Ss(t.endLineNumber,t.endColumn,t.endLineNumber,t.endColumn))}}run(t,i){if(!i.hasModel())return;const e=i.getModel(),s=i.getSelections(),n=i._getViewModel(),r=n.getCursorStates(),o=[];s.forEach((t=>this.getCursorsForSelection(t,e,o))),o.length>0&&i.setSelections(o),ont(r,n.getCursorStates())}}),ku(class extends ant{constructor(){super({id:"editor.action.addSelectionToNextFindMatch",label:tt(0,"Add Selection To Next Find Match"),alias:"Add Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:Ox.focus,primary:2082,weight:100},menuOpts:{menuId:Qa.MenubarSelectionMenu,group:"3_multi",title:tt(0,"Add &&Next Occurrence"),order:5}})}_run(t,i){t.addSelectionToNextFindMatch(i)}}),ku(class extends ant{constructor(){super({id:"editor.action.addSelectionToPreviousFindMatch",label:tt(0,"Add Selection To Previous Find Match"),alias:"Add Selection To Previous Find Match",precondition:void 0,menuOpts:{menuId:Qa.MenubarSelectionMenu,group:"3_multi",title:tt(0,"Add P&&revious Occurrence"),order:6}})}_run(t,i){t.addSelectionToPreviousFindMatch(i)}}),ku(class extends ant{constructor(){super({id:"editor.action.moveSelectionToNextFindMatch",label:tt(0,"Move Last Selection To Next Find Match"),alias:"Move Last Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:Ox.focus,primary:Fe(2089,2082),weight:100}})}_run(t,i){t.moveSelectionToNextFindMatch(i)}}),ku(class extends ant{constructor(){super({id:"editor.action.moveSelectionToPreviousFindMatch",label:tt(0,"Move Last Selection To Previous Find Match"),alias:"Move Last Selection To Previous Find Match",precondition:void 0})}_run(t,i){t.moveSelectionToPreviousFindMatch(i)}}),ku(class extends ant{constructor(){super({id:"editor.action.selectHighlights",label:tt(0,"Select All Occurrences of Find Match"),alias:"Select All Occurrences of Find Match",precondition:void 0,kbOpts:{kbExpr:Ox.focus,primary:3114,weight:100},menuOpts:{menuId:Qa.MenubarSelectionMenu,group:"3_multi",title:tt(0,"Select All &&Occurrences"),order:7}})}_run(t,i){t.selectAll(i)}}),ku(class extends ant{constructor(){super({id:"editor.action.changeAll",label:tt(0,"Change All Occurrences"),alias:"Change All Occurrences",precondition:ua.and(Ox.writable,Ox.editorTextFocus),kbOpts:{kbExpr:Ox.editorTextFocus,primary:2108,weight:100},contextMenuOpts:{group:"1_modification",order:1.2}})}_run(t,i){t.selectAll(i)}}),ku(class extends mu{constructor(){super({id:"editor.action.addCursorsToBottom",label:tt(0,"Add Cursors To Bottom"),alias:"Add Cursors To Bottom",precondition:void 0})}run(t,i){if(!i.hasModel())return;const e=i.getSelections(),s=i.getModel().getLineCount(),n=[];for(let t=e[0].startLineNumber;t<=s;t++)n.push(new Ss(t,e[0].startColumn,t,e[0].endColumn));const r=i._getViewModel(),o=r.getCursorStates();n.length>0&&i.setSelections(n),ont(o,r.getCursorStates())}}),ku(class extends mu{constructor(){super({id:"editor.action.addCursorsToTop",label:tt(0,"Add Cursors To Top"),alias:"Add Cursors To Top",precondition:void 0})}run(t,i){if(!i.hasModel())return;const e=i.getSelections(),s=[];for(let t=e[0].startLineNumber;t>=1;t--)s.push(new Ss(t,e[0].startColumn,t,e[0].endColumn));const n=i._getViewModel(),r=n.getCursorStates();s.length>0&&i.setSelections(s),ont(r,n.getCursorStates())}}),ku(class extends mu{constructor(){super({id:"editor.action.focusNextCursor",label:tt(0,"Focus Next Cursor"),metadata:{description:tt(0,"Focuses the next cursor"),args:[]},alias:"Focus Next Cursor",precondition:void 0})}run(t,i,e){if(!i.hasModel())return;const s=i._getViewModel();if(s.cursorConfig.readOnly)return;s.model.pushStackElement();const n=Array.from(s.getCursorStates()),r=n.shift();r&&(n.push(r),s.setCursorStates(e.source,3,n),s.revealPrimaryCursor(e.source,!0),ont(n,s.getCursorStates()))}}),ku(class extends mu{constructor(){super({id:"editor.action.focusPreviousCursor",label:tt(0,"Focus Previous Cursor"),metadata:{description:tt(0,"Focuses the previous cursor"),args:[]},alias:"Focus Previous Cursor",precondition:void 0})}run(t,i,e){if(!i.hasModel())return;const s=i._getViewModel();if(s.cursorConfig.readOnly)return;s.model.pushStackElement();const n=Array.from(s.getCursorStates()),r=n.pop();r&&(n.unshift(r),s.setCursorStates(e.source,3,n),s.revealPrimaryCursor(e.source,!0),ont(n,s.getCursorStates()))}});var pnt=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},mnt=function(t,i){return function(e,s){i(e,s,t)}};const wnt="inline-edit";let vnt=class extends Qi{constructor(t,i,e){super(),this.editor=t,this.model=i,this.languageService=e,this.isDisposed=$B(this,!1),this.currentTextModel=e$(this.editor.onDidChangeModel,(()=>this.editor.getModel())),this.uiState=zB(this,(t=>{var i;if(this.isDisposed.read(t))return;const e=this.currentTextModel.read(t);if(e!==this.model.targetTextModel.read(t))return;const s=this.model.ghostText.read(t);if(!s)return;let n=(i=this.model.range)===null||i===void 0?void 0:i.read(t);n&&n.startLineNumber===n.endLineNumber&&n.startColumn===n.endColumn&&(n=void 0);const r=(!n||n.startLineNumber===n.endLineNumber)&&s.parts.length===1&&s.parts[0].lines.length===1,o=s.parts.length===1&&s.parts[0].lines.every((t=>t.length===0)),h=[],c=[];function l(t,i){if(c.length>0){const e=c[c.length-1];i&&e.decorations.push(new rm(e.content.length+1,e.content.length+1+t[0].length,i,0)),e.content+=t[0],t=t.slice(1)}for(const e of t)c.push({content:e,decorations:i?[new rm(1,e.length+1,i,0)]:[]})}const a=e.getLineContent(s.lineNumber);let u,d=0;if(!o){for(const t of s.parts){let i=t.lines;n&&!r&&(l(i,wnt),i=[]),u===void 0?(h.push({column:t.column,text:i[0],preview:t.preview}),i=i.slice(1)):l([a.substring(d,t.column-1)],void 0),i.length>0&&(l(i,wnt),u===void 0&&t.column<=a.length&&(u=t.column)),d=t.column-1}u!==void 0&&l([a.substring(d)],void 0)}const f=u!==void 0?new $8(u,a.length+1):void 0,g=r||!n?s.lineNumber:n.endLineNumber-1;return{inlineTexts:h,additionalLines:c,hiddenRange:f,lineNumber:g,additionalReservedLineCount:this.model.minReservedLineCount.read(t),targetTextModel:e,range:n,isSingleLine:r,isPureRemove:o,backgroundColoring:this.model.backgroundColoring.read(t)}})),this.decorations=zB(this,(t=>{const i=this.uiState.read(t);if(!i)return[];const e=[];if(i.hiddenRange&&e.push({range:i.hiddenRange.toRange(i.lineNumber),options:{inlineClassName:"inline-edit-hidden",description:"inline-edit-hidden"}}),i.range){const t=[];if(i.isSingleLine)t.push(i.range);else if(i.isPureRemove){const e=i.range.endLineNumber-i.range.startLineNumber;for(let s=0;s<e;s++){const e=i.range.startLineNumber+s,n=i.targetTextModel.getLineFirstNonWhitespaceColumn(e),r=i.targetTextModel.getLineLastNonWhitespaceColumn(e),o=new Cs(e,n,e,r);t.push(o)}}else{const e=i.range.endLineNumber-i.range.startLineNumber;for(let s=0;s<e;s++){const e=i.range.startLineNumber+s,n=i.targetTextModel.getLineFirstNonWhitespaceColumn(e),r=i.targetTextModel.getLineLastNonWhitespaceColumn(e),o=new Cs(e,n,e,r);t.push(o)}}const s=i.backgroundColoring?"inline-edit-remove backgroundColoring":"inline-edit-remove";for(const i of t)e.push({range:i,options:{inlineClassName:s,description:"inline-edit-remove"}})}for(const t of i.inlineTexts)e.push({range:Cs.fromPositions(new ks(i.lineNumber,t.column)),options:{description:wnt,after:{content:t.text,inlineClassName:t.preview?"inline-edit-decoration-preview":"inline-edit-decoration",cursorStops:tg.Left},showIfCollapsed:!0}});return e})),this.additionalLinesWidget=this._register(new K8(this.editor,this.languageService.languageIdCodec,zB((t=>{const i=this.uiState.read(t);return i&&!i.isPureRemove?{lineNumber:i.lineNumber,additionalLines:i.additionalLines,minReservedLineCount:i.additionalReservedLineCount,targetTextModel:i.targetTextModel}:void 0})))),this._register(Zi((()=>{this.isDisposed.set(!0,void 0)}))),this._register(W8(this.editor,this.decorations))}ownsViewZone(t){return this.additionalLinesWidget.viewZoneId===t}};vnt=pnt([mnt(2,Id)],vnt);var bnt,ynt=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},knt=function(t,i){return function(e,s){i(e,s,t)}};let Cnt=class extends Qi{constructor(t,i,e){super(),this.editor=t,this.model=i,this.instantiationService=e,this.alwaysShowToolbar=e$(this.editor.onDidChangeConfiguration,(()=>this.editor.getOption(63).showToolbar==="always")),this.sessionPosition=void 0,this.position=zB(this,(t=>{var i,e,s;const n=(i=this.model.read(t))===null||i===void 0?void 0:i.widget.model.ghostText.read(t);if(!this.alwaysShowToolbar.read(t)||!n||n.parts.length===0)return this.sessionPosition=void 0,null;const r=n.parts[0].column;this.sessionPosition&&this.sessionPosition.lineNumber!==n.lineNumber&&(this.sessionPosition=void 0);const o=new ks(n.lineNumber,Math.min(r,(s=(e=this.sessionPosition)===null||e===void 0?void 0:e.column)!==null&&s!==void 0?s:Number.MAX_SAFE_INTEGER));return this.sessionPosition=o,o})),this._register(YB(((i,e)=>{if(!this.model.read(i)||!this.alwaysShowToolbar.read(i))return;const s=e.add(this.instantiationService.createInstance(Snt,this.editor,!0,this.position));t.addContentWidget(s),e.add(Zi((()=>t.removeContentWidget(s))))})))}};Cnt=ynt([knt(2,Il)],Cnt);let Snt=bnt=class extends Qi{constructor(t,i,e,s,n,r){super(),this.editor=t,this.withBorder=i,this._position=e,this._contextKeyService=n,this._menuService=r,this.id="InlineEditHintsContentWidget"+bnt.id++,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this.nodes=ml("div.inlineEditHints",{className:this.withBorder?".withBorder":""},[ml("div@toolBar")]),this.inlineCompletionsActionsMenus=this._register(this._menuService.createMenu(Qa.InlineEditActions,this._contextKeyService)),this.toolBar=this._register(s.createInstance(Dnt,this.nodes.toolBar,this.editor,Qa.InlineEditToolbar,{menuOptions:{renderShortTitle:!0},toolbarOptions:{primaryGroup:t=>t.startsWith("primary")},actionViewItemProvider:(t,i)=>{if(t instanceof eu)return s.createInstance(xnt,t,void 0)},telemetrySource:"InlineEditToolbar"})),this._register(this.toolBar.onDidChangeDropdownVisibility((t=>{bnt._dropDownVisible=t}))),this._register(ZB((t=>{this._position.read(t),this.editor.layoutContentWidget(this)}))),this._register(ZB((t=>{const i=[];for(const[t,e]of this.inlineCompletionsActionsMenus.getActions())for(const t of e)t instanceof eu&&i.push(t);i.length>0&&i.unshift(new jl),this.toolBar.setAdditionalSecondaryActions(i)})))}getId(){return this.id}getDomNode(){return this.nodes.root}getPosition(){return{position:this._position.get(),preference:[1,2],positionAffinity:3}}};Snt._dropDownVisible=!1,Snt.id=0,Snt=bnt=ynt([knt(3,Il),knt(4,Ra),knt(5,Ya)],Snt);class xnt extends xW{updateLabel(){const t=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!t)return super.updateLabel();if(this.label){const i=ml("div.keybinding").root;this._register(new Nz(i,Ft,{disableTitle:!0,...Pz})).set(t),this.label.textContent=this._action.label,this.label.appendChild(i),this.label.classList.add("inlineEditStatusBarItemLabel")}}updateTooltip(){}}let Dnt=class extends SZ{constructor(t,i,e,s,n,r,o,h,c){super(t,{resetMenu:e,...s},n,r,o,h,c),this.editor=i,this.menuId=e,this.options2=s,this.menuService=n,this.contextKeyService=r,this.menu=this._store.add(this.menuService.createMenu(this.menuId,this.contextKeyService,{emitEventsForSubmenuChanges:!0})),this.additionalActions=[],this.prependedPrimaryActions=[],this._store.add(this.menu.onDidChange((()=>this.updateToolbar()))),this._store.add(this.editor.onDidChangeCursorPosition((()=>this.updateToolbar()))),this.updateToolbar()}updateToolbar(){var t,i,e,s,n,r,o;const h=[],c=[];CW(this.menu,(t=this.options2)===null||t===void 0?void 0:t.menuOptions,{primary:h,secondary:c},(e=(i=this.options2)===null||i===void 0?void 0:i.toolbarOptions)===null||e===void 0?void 0:e.primaryGroup,(n=(s=this.options2)===null||s===void 0?void 0:s.toolbarOptions)===null||n===void 0?void 0:n.shouldInlineSubmenu,(o=(r=this.options2)===null||r===void 0?void 0:r.toolbarOptions)===null||o===void 0?void 0:o.useSeparatorsInPrimaryActions),c.push(...this.additionalActions),h.unshift(...this.prependedPrimaryActions),this.setActions(h,c)}setAdditionalSecondaryActions(t){n(this.additionalActions,t,((t,i)=>t===i))||(this.additionalActions=t,this.updateToolbar())}};Dnt=ynt([knt(4,Ya),knt(5,Ra),knt(6,oI),knt(7,NS),knt(8,ru)],Dnt);var Ent,Ant=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Mnt=function(t,i){return function(e,s){i(e,s,t)}};class Lnt{constructor(t,i){this.widget=t,this.edit=i}dispose(){this.widget.dispose()}}let Fnt=Ent=class extends Qi{static get(t){return t.getContribution(Ent.ID)}constructor(t,i,e,s,n,r){super(),this.editor=t,this.instantiationService=i,this.contextKeyService=e,this.languageFeaturesService=s,this._commandService=n,this._configurationService=r,this._isVisibleContext=Ent.inlineEditVisibleContext.bindTo(this.contextKeyService),this._isCursorAtInlineEditContext=Ent.cursorAtInlineEditContext.bindTo(this.contextKeyService),this._currentEdit=this._register(jB(this,void 0)),this._isAccepting=$B(this,!1),this._enabled=e$(this.editor.onDidChangeConfiguration,(()=>this.editor.getOption(63).enabled)),this._fontFamily=e$(this.editor.onDidChangeConfiguration,(()=>this.editor.getOption(63).fontFamily)),this._backgroundColoring=e$(this.editor.onDidChangeConfiguration,(()=>this.editor.getOption(63).backgroundColoring));const o=n$("InlineEditController.modelContentChangedSignal",t.onDidChangeModelContent);this._register(ZB((i=>{this._enabled.read(i)&&(o.read(i),this._isAccepting.read(i)||this.getInlineEdit(t,!0))})));const h=e$(t.onDidChangeCursorPosition,(()=>t.getPosition()));this._register(ZB((t=>{if(!this._enabled.read(t))return;const i=h.read(t);i&&this.checkCursorPosition(i)}))),this._register(ZB((i=>{const e=this._currentEdit.read(i);if(this._isCursorAtInlineEditContext.set(!1),!e)return void this._isVisibleContext.set(!1);this._isVisibleContext.set(!0);const s=t.getPosition();s&&this.checkCursorPosition(s)})));const c=n$("InlineEditController.editorBlurSignal",t.onDidBlurEditorWidget);this._register(ZB((async i=>{var e;this._enabled.read(i)&&(c.read(i),this._configurationService.getValue("editor.experimentalInlineEdit.keepOnBlur")||t.getOption(63).keepOnBlur||((e=this._currentRequestCts)===null||e===void 0||e.dispose(!0),this._currentRequestCts=void 0,await this.clear(!1)))})));const l=n$("InlineEditController.editorFocusSignal",t.onDidFocusEditorText);this._register(ZB((i=>{this._enabled.read(i)&&(l.read(i),this.getInlineEdit(t,!0))})));const a=this._register(Ic());this._register(ZB((t=>{const i=this._fontFamily.read(t);a.setStyle(i===""||i==="default"?"":`\n.monaco-editor .inline-edit-decoration,\n.monaco-editor .inline-edit-decoration-preview,\n.monaco-editor .inline-edit {\n\tfont-family: ${i};\n}`)}))),this._register(new Cnt(this.editor,this._currentEdit,this.instantiationService))}checkCursorPosition(t){var i;if(!this._currentEdit)return void this._isCursorAtInlineEditContext.set(!1);const e=(i=this._currentEdit.get())===null||i===void 0?void 0:i.edit;e?this._isCursorAtInlineEditContext.set(Cs.containsPosition(e.range,t)):this._isCursorAtInlineEditContext.set(!1)}validateInlineEdit(t,i){var e,s;if(i.text.includes(`\n`)&&i.range.startLineNumber!==i.range.endLineNumber&&i.range.startColumn!==i.range.endColumn){if(i.range.startColumn!==1)return!1;const n=i.range.endLineNumber;if(i.range.endColumn!==((s=(e=t.getModel())===null||e===void 0?void 0:e.getLineLength(n))!==null&&s!==void 0?s:0)+1)return!1}return!0}async fetchInlineEdit(t,i){this._currentRequestCts&&this._currentRequestCts.dispose(!0);const e=t.getModel();if(!e)return;const s=e.getVersionId(),n=this.languageFeaturesService.inlineEditProvider.all(e);if(n.length===0)return;const r=n[0];this._currentRequestCts=new ye;const o=this._currentRequestCts.token,h=i?Ks.Automatic:Ks.Invoke;var c,l;if(i&&await(c=50,l=o,new Promise((t=>{let i;const e=setTimeout((()=>{i&&i.dispose(),t()}),c);l&&(i=l.onCancellationRequested((()=>{clearTimeout(e),i&&i.dispose(),t()})))}))),o.isCancellationRequested||e.isDisposed()||e.getVersionId()!==s)return;const a=await r.provideInlineEdit(e,{triggerKind:h},o);return a&&!o.isCancellationRequested&&!e.isDisposed()&&e.getVersionId()===s&&this.validateInlineEdit(t,a)?a:void 0}async getInlineEdit(t,i){var e;this._isCursorAtInlineEditContext.set(!1),await this.clear();const s=await this.fetchInlineEdit(t,i);if(!s)return;const n=s.range.endLineNumber,r=s.range.endColumn,o=new O8(n,[new I8(r,s.text,!1)]),h=this.instantiationService.createInstance(vnt,this.editor,{ghostText:t$(o),minReservedLineCount:t$(0),targetTextModel:t$((e=this.editor.getModel())!==null&&e!==void 0?e:void 0),range:t$(s.range),backgroundColoring:this._backgroundColoring});this._currentEdit.set(new Lnt(h,s),void 0)}async trigger(){await this.getInlineEdit(this.editor,!1)}async jumpBack(){this._jumpBackPosition&&(this.editor.setPosition(this._jumpBackPosition),this.editor.revealPositionInCenterIfOutsideViewport(this._jumpBackPosition))}async accept(){var t;this._isAccepting.set(!0,void 0);const i=(t=this._currentEdit.get())===null||t===void 0?void 0:t.edit;if(!i)return;let e=i.text;i.text.startsWith(`\n`)&&(e=i.text.substring(1)),this.editor.pushUndoStop(),this.editor.executeEdits("acceptCurrent",[KP.replace(Cs.lift(i.range),e)]),i.accepted&&await this._commandService.executeCommand(i.accepted.id,...i.accepted.arguments||[]).then(void 0,_i),this.freeEdit(i),_B((t=>{this._currentEdit.set(void 0,t),this._isAccepting.set(!1,t)}))}jumpToCurrent(){var t,i;this._jumpBackPosition=(t=this.editor.getSelection())===null||t===void 0?void 0:t.getStartPosition();const e=(i=this._currentEdit.get())===null||i===void 0?void 0:i.edit;if(!e)return;const s=ks.lift({lineNumber:e.range.startLineNumber,column:e.range.startColumn});this.editor.setPosition(s),this.editor.revealPositionInCenterIfOutsideViewport(s)}async clear(t=!0){var i;const e=(i=this._currentEdit.get())===null||i===void 0?void 0:i.edit;e&&(e!=null&&e.rejected)&&t&&await this._commandService.executeCommand(e.rejected.id,...e.rejected.arguments||[]).then(void 0,_i),e&&this.freeEdit(e),this._currentEdit.set(void 0,void 0)}freeEdit(t){const i=this.editor.getModel();if(!i)return;const e=this.languageFeaturesService.inlineEditProvider.all(i);e.length!==0&&e[0].freeInlineEdit(t)}shouldShowHoverAt(t){const i=this._currentEdit.get();if(!i)return!1;const e=i.edit,s=i.widget.model;if(Cs.containsPosition(e.range,t.getStartPosition())||Cs.containsPosition(e.range,t.getEndPosition()))return!0;const n=s.ghostText.get();return!!n&&n.parts.some((i=>t.containsPosition(new ks(n.lineNumber,i.column))))}shouldShowHoverAtViewZone(t){var i,e;return(e=(i=this._currentEdit.get())===null||i===void 0?void 0:i.widget.ownsViewZone(t))!==null&&e!==void 0&&e}};Fnt.ID="editor.contrib.inlineEditController",Fnt.inlineEditVisibleKey="inlineEditVisible",Fnt.inlineEditVisibleContext=new Ta(Ent.inlineEditVisibleKey,!1),Fnt.cursorAtInlineEditKey="cursorAtInlineEdit",Fnt.cursorAtInlineEditContext=new Ta(Ent.cursorAtInlineEditKey,!1),Fnt=Ent=Ant([Mnt(1,Il),Mnt(2,Ra),Mnt(3,$p),Mnt(4,ql),Mnt(5,Md)],Fnt);var Tnt=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Rnt=function(t,i){return function(e,s){i(e,s,t)}};class Ont{constructor(t,i,e){this.owner=t,this.range=i,this.controller=e}isValidForHoverAnchor(t){return t.type===1&&this.range.startColumn<=t.range.startColumn&&this.range.endColumn>=t.range.endColumn}}let Int=class{constructor(t,i,e){this._editor=t,this._instantiationService=i,this._telemetryService=e,this.hoverOrdinal=5}suggestHoverAnchor(t){const i=Fnt.get(this._editor);if(!i)return null;const e=t.target;if(e.type===8){const s=e.detail;if(i.shouldShowHoverAtViewZone(s.viewZoneId)){const i=e.range;return new $5(1e3,this,i,t.event.posx,t.event.posy,!1)}}return e.type===7&&i.shouldShowHoverAt(e.range)?new $5(1e3,this,e.range,t.event.posx,t.event.posy,!1):e.type===6&&e.detail.mightBeForeignElement&&i.shouldShowHoverAt(e.range)?new $5(1e3,this,e.range,t.event.posx,t.event.posy,!1):null}computeSync(t,i){if(this._editor.getOption(63).showToolbar!=="onHover")return[];const e=Fnt.get(this._editor);return e&&e.shouldShowHoverAt(t.range)?[new Ont(this,t.range,e)]:[]}renderHoverParts(t,i){const e=new Ji;this._telemetryService.publicLog2("inlineEditHover.shown");const s=this._instantiationService.createInstance(Snt,this._editor,!1,t$(null));return t.fragment.appendChild(s.getDomNode()),e.add(s),e}};Int=Tnt([Rnt(1,Il),Rnt(2,ru)],Int),ku(class extends mu{constructor(){super({id:"editor.action.inlineEdit.accept",label:"Accept Inline Edit",alias:"Accept Inline Edit",precondition:ua.and(Ox.writable,Fnt.inlineEditVisibleContext),kbOpts:[{weight:101,primary:2,kbExpr:ua.and(Ox.writable,Fnt.inlineEditVisibleContext,Fnt.cursorAtInlineEditContext)}],menuOpts:[{menuId:Qa.InlineEditToolbar,title:"Accept",group:"primary",order:1}]})}async run(t,i){const e=Fnt.get(i);await(e==null?void 0:e.accept())}}),ku(class extends mu{constructor(){const t=ua.and(Ox.writable,Fnt.inlineEditVisibleContext);super({id:"editor.action.inlineEdit.reject",label:"Reject Inline Edit",alias:"Reject Inline Edit",precondition:t,kbOpts:{weight:100,primary:9,kbExpr:t},menuOpts:[{menuId:Qa.InlineEditToolbar,title:"Reject",group:"secondary",order:2}]})}async run(t,i){const e=Fnt.get(i);await(e==null?void 0:e.clear())}}),ku(class extends mu{constructor(){const t=ua.and(Ox.writable,Fnt.inlineEditVisibleContext,ua.not(Fnt.cursorAtInlineEditKey));super({id:"editor.action.inlineEdit.jumpTo",label:"Jump to Inline Edit",alias:"Jump to Inline Edit",precondition:t,kbOpts:{weight:101,primary:2646,kbExpr:t},menuOpts:[{menuId:Qa.InlineEditToolbar,title:"Jump To Edit",group:"primary",order:3,when:t}]})}async run(t,i){const e=Fnt.get(i);e==null||e.jumpToCurrent()}}),ku(class extends mu{constructor(){const t=ua.and(Ox.writable,Fnt.cursorAtInlineEditContext);super({id:"editor.action.inlineEdit.jumpBack",label:"Jump Back from Inline Edit",alias:"Jump Back from Inline Edit",precondition:t,kbOpts:{weight:110,primary:2646,kbExpr:t},menuOpts:[{menuId:Qa.InlineEditToolbar,title:"Jump Back",group:"primary",order:3,when:t}]})}async run(t,i){const e=Fnt.get(i);e==null||e.jumpBack()}}),ku(class extends mu{constructor(){const t=ua.and(Ox.writable,ua.not(Fnt.inlineEditVisibleKey));super({id:"editor.action.inlineEdit.trigger",label:"Trigger Inline Edit",alias:"Trigger Inline Edit",precondition:t,kbOpts:{weight:101,primary:2646,kbExpr:t}})}async run(t,i){const e=Fnt.get(i);e==null||e.trigger()}}),Su(Fnt.ID,Fnt,3),W5.register(Int);const _nt={Visible:new Ta("parameterHintsVisible",!1),MultipleSignatures:new Ta("parameterHintsMultipleSignatures",!1)};async function Pnt(t,i,e,s,n){const r=t.ordered(i);for(const t of r)try{const r=await t.provideSignatureHelp(i,e,n,s);if(r)return r}catch(t){_i(t)}}var Nnt;Gl.registerCommand("_executeSignatureHelpProvider",(async(t,...i)=>{const[e,s,n]=i;j(as.isUri(e)),j(ks.isIPosition(s)),j(typeof n=="string"||!n);const r=t.get($p),o=await t.get(Bl).createModelReference(e);try{const t=await Pnt(r.signatureHelpProvider,o.object.textEditorModel,ks.lift(s),{triggerKind:_s.Invoke,isRetrigger:!1,triggerCharacter:n},ve.None);return t?(setTimeout((()=>t.dispose()),0),t.value):void 0}finally{o.dispose()}})),function(t){t.Default={type:0},t.Pending=class{constructor(t,i){this.request=t,this.previouslyActiveHints=i,this.type=2}},t.Active=class{constructor(t){this.hints=t,this.type=1}}}(Nnt||(Nnt={}));class Bnt extends Qi{constructor(t,i,e=Bnt.DEFAULT_DELAY){super(),this._onChangedHints=this._register(new le),this.onChangedHints=this._onChangedHints.event,this.triggerOnType=!1,this._state=Nnt.Default,this._pendingTriggers=[],this._lastSignatureHelpResult=this._register(new Yi),this.triggerChars=new If,this.retriggerChars=new If,this.triggerId=0,this.editor=t,this.providers=i,this.throttledDelayer=new po(e),this._register(this.editor.onDidBlurEditorWidget((()=>this.cancel()))),this._register(this.editor.onDidChangeConfiguration((()=>this.onEditorConfigurationChange()))),this._register(this.editor.onDidChangeModel((t=>this.onModelChanged()))),this._register(this.editor.onDidChangeModelLanguage((t=>this.onModelChanged()))),this._register(this.editor.onDidChangeCursorSelection((t=>this.onCursorChange(t)))),this._register(this.editor.onDidChangeModelContent((t=>this.onModelContentChange()))),this._register(this.providers.onDidChange(this.onModelChanged,this)),this._register(this.editor.onDidType((t=>this.onDidType(t)))),this.onEditorConfigurationChange(),this.onModelChanged()}get state(){return this._state}set state(t){this._state.type===2&&this._state.request.cancel(),this._state=t}cancel(t=!1){this.state=Nnt.Default,this.throttledDelayer.cancel(),t||this._onChangedHints.fire(void 0)}trigger(t,i){const e=this.editor.getModel();if(!e||!this.providers.has(e))return;const s=++this.triggerId;this._pendingTriggers.push(t),this.throttledDelayer.trigger((()=>this.doTrigger(s)),i).catch(Ii)}next(){if(this.state.type!==1)return;const t=this.state.hints.signatures.length,i=this.state.hints.activeSignature,e=i%t==t-1,s=this.editor.getOption(86).cycle;!(t<2||e)||s?this.updateActiveSignature(e&&s?0:i+1):this.cancel()}previous(){if(this.state.type!==1)return;const t=this.state.hints.signatures.length,i=this.state.hints.activeSignature,e=i===0,s=this.editor.getOption(86).cycle;!(t<2||e)||s?this.updateActiveSignature(e&&s?t-1:i-1):this.cancel()}updateActiveSignature(t){this.state.type===1&&(this.state=new Nnt.Active({...this.state.hints,activeSignature:t}),this._onChangedHints.fire(this.state.hints))}async doTrigger(t){const i=this.state.type===1||this.state.type===2,e=this.getLastActiveHints();if(this.cancel(!0),this._pendingTriggers.length===0)return!1;const s=this._pendingTriggers.reduce($nt);this._pendingTriggers=[];const n={triggerKind:s.triggerKind,triggerCharacter:s.triggerCharacter,isRetrigger:i,activeSignatureHelp:e};if(!this.editor.hasModel())return!1;const r=this.editor.getModel(),o=this.editor.getPosition();this.state=new Nnt.Pending(uo((t=>Pnt(this.providers,r,o,n,t))),e);try{const i=await this.state.request;return t!==this.triggerId?(i==null||i.dispose(),!1):i&&i.value.signatures&&i.value.signatures.length!==0?(this.state=new Nnt.Active(i.value),this._lastSignatureHelpResult.value=i,this._onChangedHints.fire(this.state.hints),!0):(i==null||i.dispose(),this._lastSignatureHelpResult.clear(),this.cancel(),!1)}catch(i){return t===this.triggerId&&(this.state=Nnt.Default),Ii(i),!1}}getLastActiveHints(){switch(this.state.type){case 1:return this.state.hints;case 2:return this.state.previouslyActiveHints;default:return}}get isTriggered(){return this.state.type===1||this.state.type===2||this.throttledDelayer.isTriggered()}onModelChanged(){this.cancel(),this.triggerChars.clear(),this.retriggerChars.clear();const t=this.editor.getModel();if(t)for(const i of this.providers.ordered(t)){for(const t of i.signatureHelpTriggerCharacters||[])if(t.length){const i=t.charCodeAt(0);this.triggerChars.add(i),this.retriggerChars.add(i)}for(const t of i.signatureHelpRetriggerCharacters||[])t.length&&this.retriggerChars.add(t.charCodeAt(0))}}onDidType(t){if(!this.triggerOnType)return;const i=t.length-1,e=t.charCodeAt(i);(this.triggerChars.has(e)||this.isTriggered&&this.retriggerChars.has(e))&&this.trigger({triggerKind:_s.TriggerCharacter,triggerCharacter:t.charAt(i)})}onCursorChange(t){t.source==="mouse"?this.cancel():this.isTriggered&&this.trigger({triggerKind:_s.ContentChange})}onModelContentChange(){this.isTriggered&&this.trigger({triggerKind:_s.ContentChange})}onEditorConfigurationChange(){this.triggerOnType=this.editor.getOption(86).enabled,this.triggerOnType||this.cancel()}dispose(){this.cancel(!0),super.dispose()}}function $nt(t,i){switch(i.triggerKind){case _s.Invoke:return i;case _s.ContentChange:return t;case _s.TriggerCharacter:default:return i}}Bnt.DEFAULT_DELAY=120;var Wnt,jnt=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Hnt=function(t,i){return function(e,s){i(e,s,t)}};const Vnt=nl,znt=qU("parameter-hints-next",As.chevronDown,tt(0,"Icon for show next parameter hint.")),Unt=qU("parameter-hints-previous",As.chevronUp,tt(0,"Icon for show previous parameter hint."));let Knt=Wnt=class extends Qi{constructor(t,i,e,s,n){super(),this.editor=t,this.model=i,this.renderDisposeables=this._register(new Ji),this.visible=!1,this.announcedLabel=null,this.allowEditorOverflow=!0,this.markdownRenderer=this._register(new fP({editor:t},n,s)),this.keyVisible=_nt.Visible.bindTo(e),this.keyMultipleSignatures=_nt.MultipleSignatures.bindTo(e)}createParameterHintDOMNodes(){const t=Vnt(".editor-widget.parameter-hints-widget"),i=Yc(t,Vnt(".phwrapper"));i.tabIndex=-1;const e=Yc(i,Vnt(".controls")),s=Yc(e,Vnt(".button"+Kl.asCSSSelector(Unt))),n=Yc(e,Vnt(".overloads")),r=Yc(e,Vnt(".button"+Kl.asCSSSelector(znt)));this._register(sc(s,"click",(t=>{Zc(t),this.previous()}))),this._register(sc(r,"click",(t=>{Zc(t),this.next()})));const o=Vnt(".body"),h=new rC(o,{alwaysConsumeMouseWheel:!0});this._register(h),i.appendChild(h.getDomNode());const c=Yc(o,Vnt(".signature")),l=Yc(o,Vnt(".docs"));t.style.userSelect="text",this.domNodes={element:t,signature:c,overloads:n,docs:l,scrollbar:h},this.editor.addContentWidget(this),this.hide(),this._register(this.editor.onDidChangeCursorSelection((t=>{this.visible&&this.editor.layoutContentWidget(this)})));const a=()=>{if(!this.domNodes)return;const t=this.editor.getOption(50);this.domNodes.element.style.fontSize=`${t.fontSize}px`,this.domNodes.element.style.lineHeight=""+t.lineHeight/t.fontSize};a(),this._register(ne.chain(this.editor.onDidChangeConfiguration.bind(this.editor),(t=>t.filter((t=>t.hasChanged(50)))))(a)),this._register(this.editor.onDidLayoutChange((t=>this.updateMaxHeight()))),this.updateMaxHeight()}show(){this.visible||(this.domNodes||this.createParameterHintDOMNodes(),this.keyVisible.set(!0),this.visible=!0,setTimeout((()=>{var t;(t=this.domNodes)===null||t===void 0||t.element.classList.add("visible")}),100),this.editor.layoutContentWidget(this))}hide(){var t;this.renderDisposeables.clear(),this.visible&&(this.keyVisible.reset(),this.visible=!1,this.announcedLabel=null,(t=this.domNodes)===null||t===void 0||t.element.classList.remove("visible"),this.editor.layoutContentWidget(this))}getPosition(){return this.visible?{position:this.editor.getPosition(),preference:[1,2]}:null}render(t){var i;if(this.renderDisposeables.clear(),!this.domNodes)return;const e=t.signatures.length>1;this.domNodes.element.classList.toggle("multiple",e),this.keyMultipleSignatures.set(e),this.domNodes.signature.innerText="",this.domNodes.docs.innerText="";const s=t.signatures[t.activeSignature];if(!s)return;const n=Yc(this.domNodes.signature,Vnt(".code")),r=this.editor.getOption(50);n.style.fontSize=`${r.fontSize}px`,n.style.fontFamily=r.fontFamily;const o=s.parameters.length>0,h=(i=s.activeParameter)!==null&&i!==void 0?i:t.activeParameter;o?this.renderParameters(n,s,h):Yc(n,Vnt("span")).textContent=s.label;const c=s.parameters[h];if(c!=null&&c.documentation){const t=Vnt("span.documentation");if(typeof c.documentation=="string")t.textContent=c.documentation;else{const i=this.renderMarkdownDocs(c.documentation);t.appendChild(i.element)}Yc(this.domNodes.docs,Vnt("p",{},t))}if(s.documentation!==void 0)if(typeof s.documentation=="string")Yc(this.domNodes.docs,Vnt("p",{},s.documentation));else{const t=this.renderMarkdownDocs(s.documentation);Yc(this.domNodes.docs,t.element)}const l=this.hasDocs(s,c);if(this.domNodes.signature.classList.toggle("has-docs",l),this.domNodes.docs.classList.toggle("empty",!l),this.domNodes.overloads.textContent=String(t.activeSignature+1).padStart(t.signatures.length.toString().length,"0")+"/"+t.signatures.length,c){let t="";const i=s.parameters[h];t=Array.isArray(i.label)?s.label.substring(i.label[0],i.label[1]):i.label,i.documentation&&(t+=typeof i.documentation=="string"?`, ${i.documentation}`:`, ${i.documentation.value}`),s.documentation&&(t+=typeof s.documentation=="string"?`, ${s.documentation}`:`, ${s.documentation.value}`),this.announcedLabel!==t&&(rw(tt(0,"{0}, hint",t)),this.announcedLabel=t)}this.editor.layoutContentWidget(this),this.domNodes.scrollbar.scanDomNode()}renderMarkdownDocs(t){const i=this.renderDisposeables.add(this.markdownRenderer.render(t,{asyncRenderCallback:()=>{var t;(t=this.domNodes)===null||t===void 0||t.scrollbar.scanDomNode()}}));return i.element.classList.add("markdown-docs"),i}hasDocs(t,i){return!!(i&&typeof i.documentation=="string"&&H(i.documentation).length>0)||!!(i&&typeof i.documentation=="object"&&H(i.documentation).value.length>0)||!!(t.documentation&&typeof t.documentation=="string"&&H(t.documentation).length>0)||!!(t.documentation&&typeof t.documentation=="object"&&H(t.documentation.value).length>0)}renderParameters(t,i,e){const[s,n]=this.getParameterLabelOffsets(i,e),r=document.createElement("span");r.textContent=i.label.substring(0,s);const o=document.createElement("span");o.textContent=i.label.substring(s,n),o.className="parameter active";const h=document.createElement("span");h.textContent=i.label.substring(n),Yc(t,r,o,h)}getParameterLabelOffsets(t,i){const e=t.parameters[i];if(e){if(Array.isArray(e.label))return e.label;if(e.label.length){const i=new RegExp(`(\\W|^)${Gn(e.label)}(?=\\W|$)`,"g");i.test(t.label);const s=i.lastIndex-e.label.length;return s>=0?[s,i.lastIndex]:[0,0]}return[0,0]}return[0,0]}next(){this.editor.focus(),this.model.next()}previous(){this.editor.focus(),this.model.previous()}getDomNode(){return this.domNodes||this.createParameterHintDOMNodes(),this.domNodes.element}getId(){return Wnt.ID}updateMaxHeight(){if(!this.domNodes)return;const t=`${Math.max(this.editor.getLayoutInfo().height/4,250)}px`;this.domNodes.element.style.maxHeight=t;const i=this.domNodes.element.getElementsByClassName("phwrapper");i.length&&(i[0].style.maxHeight=t)}};Knt.ID="editor.widget.parameterHintsWidget",Knt=Wnt=jnt([Hnt(2,Ra),Hnt(3,uI),Hnt(4,Id)],Knt),Iw("editorHoverWidget.highlightForeground",{dark:ly,light:ly,hcDark:ly,hcLight:ly},tt(0,"Foreground color of the active item in the parameter hint."));var qnt,Gnt=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Znt=function(t,i){return function(e,s){i(e,s,t)}};let Jnt=qnt=class extends Qi{static get(t){return t.getContribution(qnt.ID)}constructor(t,i,e){super(),this.editor=t,this.model=this._register(new Bnt(t,e.signatureHelpProvider)),this._register(this.model.onChangedHints((t=>{var i;t?(this.widget.value.show(),this.widget.value.render(t)):(i=this.widget.rawValue)===null||i===void 0||i.hide()}))),this.widget=new Hn((()=>this._register(i.createInstance(Knt,this.editor,this.model))))}cancel(){this.model.cancel()}previous(){var t;(t=this.widget.rawValue)===null||t===void 0||t.previous()}next(){var t;(t=this.widget.rawValue)===null||t===void 0||t.next()}trigger(t){this.model.trigger(t,0)}};Jnt.ID="editor.controller.parameterHints",Jnt=qnt=Gnt([Znt(1,Il),Znt(2,$p)],Jnt);Su(Jnt.ID,Jnt,2),ku(class extends mu{constructor(){super({id:"editor.action.triggerParameterHints",label:tt(0,"Trigger Parameter Hints"),alias:"Trigger Parameter Hints",precondition:Ox.hasSignatureHelpProvider,kbOpts:{kbExpr:Ox.editorTextFocus,primary:3082,weight:100}})}run(t,i){const e=Jnt.get(i);e==null||e.trigger({triggerKind:_s.Invoke})}});const Qnt=pu.bindToContribution(Jnt.get);yu(new Qnt({id:"closeParameterHints",precondition:_nt.Visible,handler:t=>t.cancel(),kbOpts:{weight:175,kbExpr:Ox.focus,primary:9,secondary:[1033]}})),yu(new Qnt({id:"showPrevParameterHint",precondition:ua.and(_nt.Visible,_nt.MultipleSignatures),handler:t=>t.previous(),kbOpts:{weight:175,kbExpr:Ox.focus,primary:16,secondary:[528],mac:{primary:16,secondary:[528,302]}}})),yu(new Qnt({id:"showNextParameterHint",precondition:ua.and(_nt.Visible,_nt.MultipleSignatures),handler:t=>t.next(),kbOpts:{weight:175,kbExpr:Ox.focus,primary:18,secondary:[530],mac:{primary:18,secondary:[530,300]}}}));var Ynt=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Xnt=function(t,i){return function(e,s){i(e,s,t)}};const trt=new Ta("renameInputVisible",!1,tt(0,"Whether the rename input widget is visible"));new Ta("renameInputFocused",!1,tt(0,"Whether the rename input widget is focused"));let irt=class{constructor(t,i,e,s,n,r){this._editor=t,this._acceptKeybindings=i,this._themeService=e,this._keybindingService=s,this._logService=r,this.allowEditorOverflow=!0,this._disposables=new Ji,this._visibleContextKey=trt.bindTo(n),this._isEditingRenameCandidate=!1,this._beforeFirstInputFieldEditSW=new se,this._input=new srt,this._disposables.add(this._input),this._editor.addContentWidget(this),this._disposables.add(this._editor.onDidChangeConfiguration((t=>{t.hasChanged(50)&&this._updateFont()}))),this._disposables.add(e.onDidColorThemeChange(this._updateStyles,this))}dispose(){this._disposables.dispose(),this._editor.removeContentWidget(this)}getId(){return"__renameInputWidget"}getDomNode(){return this._domNode||(this._domNode=document.createElement("div"),this._domNode.className="monaco-editor rename-box",this._domNode.appendChild(this._input.domNode),this._renameCandidateListView=this._disposables.add(new ert(this._domNode,{fontInfo:this._editor.getOption(50),onFocusChange:t=>{this._input.domNode.value=t,this._isEditingRenameCandidate=!1},onSelectionChange:()=>{this._isEditingRenameCandidate=!1,this.acceptInput(!1)}})),this._disposables.add(this._input.onDidChange((()=>{var t,i,e,s;((t=this._renameCandidateListView)===null||t===void 0?void 0:t.focusedCandidate)!==void 0&&(this._isEditingRenameCandidate=!0),(i=this._timeBeforeFirstInputFieldEdit)!==null&&i!==void 0||(this._timeBeforeFirstInputFieldEdit=this._beforeFirstInputFieldEditSW.elapsed()),((e=this._renameCandidateProvidersCts)===null||e===void 0?void 0:e.token.isCancellationRequested)===!1&&this._renameCandidateProvidersCts.cancel(),(s=this._renameCandidateListView)===null||s===void 0||s.clearFocus()}))),this._label=document.createElement("div"),this._label.className="rename-label",this._domNode.appendChild(this._label),this._updateFont(),this._updateStyles(this._themeService.getColorTheme())),this._domNode}_updateStyles(t){var i,e,s,n;if(!this._domNode)return;const r=t.getColor($v),o=t.getColor(Wv);this._domNode.style.backgroundColor=String((i=t.getColor(rv))!==null&&i!==void 0?i:""),this._domNode.style.boxShadow=r?` 0 0 8px 2px ${r}`:"",this._domNode.style.border=o?`1px solid ${o}`:"",this._domNode.style.color=String((e=t.getColor(gb))!==null&&e!==void 0?e:""),this._input.domNode.style.backgroundColor=String((s=t.getColor(fb))!==null&&s!==void 0?s:"");const h=t.getColor(pb);this._input.domNode.style.borderWidth=h?"1px":"0px",this._input.domNode.style.borderStyle=h?"solid":"none",this._input.domNode.style.borderColor=(n=h==null?void 0:h.toString())!==null&&n!==void 0?n:"none"}_updateFont(){if(this._domNode===void 0)return;j(this._label!==void 0,"RenameWidget#_updateFont: _label must not be undefined given _domNode is defined"),this._editor.applyFontInfo(this._input.domNode);const t=this._editor.getOption(50);this._label.style.fontSize=`${this._computeLabelFontSize(t.fontSize)}px`}_computeLabelFontSize(t){return.8*t}getPosition(){if(!this._visible||!this._editor.hasModel()||!this._editor.getDomNode())return null;const t=gc(this.getDomNode().ownerDocument.body),i=vc(this._editor.getDomNode()),e=this._getTopForPosition();this._nPxAvailableAbove=e+i.top,this._nPxAvailableBelow=t.height-this._nPxAvailableAbove;const s=this._editor.getOption(67),{totalHeight:n}=nrt.getLayoutInfo({lineHeight:s}),r=this._nPxAvailableBelow>6*n?[2,1]:[1,2];return{position:this._position,preference:r}}beforeRender(){var t,i;const[e,s]=this._acceptKeybindings;return this._label.innerText=tt(0,"{0} to Rename, {1} to Preview",(t=this._keybindingService.lookupKeybinding(e))===null||t===void 0?void 0:t.getLabel(),(i=this._keybindingService.lookupKeybinding(s))===null||i===void 0?void 0:i.getLabel()),this._domNode.style.minWidth="200px",null}afterRender(t){if(this._trace("invoking afterRender, position: ",t?"not null":"null"),t===null)return void this.cancelInput(!0,"afterRender (because position is null)");if(!this._editor.hasModel()||!this._editor.getDomNode())return;j(this._renameCandidateListView),j(this._nPxAvailableAbove!==void 0),j(this._nPxAvailableBelow!==void 0);const i=Sc(this._input.domNode),e=Sc(this._label);let s;s=t===2?this._nPxAvailableBelow:this._nPxAvailableAbove,this._renameCandidateListView.layout({height:s-e-i,width:yc(this._input.domNode)})}acceptInput(t){var i;this._trace("invoking acceptInput"),(i=this._currentAcceptInput)===null||i===void 0||i.call(this,t)}cancelInput(t,i){var e;this._trace(`invoking cancelInput, caller: ${i}, _currentCancelInput: ${this._currentAcceptInput?"not undefined":"undefined"}`),(e=this._currentCancelInput)===null||e===void 0||e.call(this,t)}focusNextRenameSuggestion(){var t;!((t=this._renameCandidateListView)===null||t===void 0)&&t.focusNext()||(this._input.domNode.value=this._currentName)}focusPreviousRenameSuggestion(){var t;!((t=this._renameCandidateListView)===null||t===void 0)&&t.focusPrevious()||(this._input.domNode.value=this._currentName)}getInput(t,i,e,s,n){const{start:r,end:o}=this._getSelection(t,i);this._renameCandidateProvidersCts=new ye;const h=s(this._renameCandidateProvidersCts.token);this._updateRenameCandidates(h,i,n.token),this._isEditingRenameCandidate=!1,this._domNode.classList.toggle("preview",e),this._position=new ks(t.startLineNumber,t.startColumn),this._currentName=i,this._input.domNode.value=i,this._input.domNode.setAttribute("selectionStart",r.toString()),this._input.domNode.setAttribute("selectionEnd",o.toString()),this._input.domNode.size=Math.max(1.1*(t.endColumn-t.startColumn),20),this._beforeFirstInputFieldEditSW.reset();const c=new Ji;c.add(Zi((()=>n.dispose(!0)))),c.add(Zi((()=>{this._renameCandidateProvidersCts!==void 0&&(this._renameCandidateProvidersCts.dispose(!0),this._renameCandidateProvidersCts=void 0)})));const l=new Ao;return l.p.finally((()=>{c.dispose(),this._hide()})),this._currentCancelInput=t=>{var i;return this._trace("invoking _currentCancelInput"),this._currentAcceptInput=void 0,this._currentCancelInput=void 0,(i=this._renameCandidateListView)===null||i===void 0||i.clearCandidates(),l.complete(t),!0},this._currentAcceptInput=t=>{this._trace("invoking _currentAcceptInput"),j(this._renameCandidateListView!==void 0);const s=this._renameCandidateListView.nCandidates;let n,r;const o=this._renameCandidateListView.focusedCandidate;o!==void 0?(this._trace("using new name from renameSuggestion"),n=o,r={k:"renameSuggestion"}):(this._trace("using new name from inputField"),n=this._input.domNode.value,r=this._isEditingRenameCandidate?{k:"userEditedRenameSuggestion"}:{k:"inputField"}),n!==i&&n.trim().length!==0?(this._currentAcceptInput=void 0,this._currentCancelInput=void 0,this._renameCandidateListView.clearCandidates(),l.complete({newName:n,wantsPreview:e&&t,stats:{source:r,nRenameSuggestions:s,timeBeforeFirstInputFieldEdit:this._timeBeforeFirstInputFieldEdit}})):this.cancelInput(!0,"_currentAcceptInput (because newName === value || newName.trim().length === 0)")},c.add(n.token.onCancellationRequested((()=>this.cancelInput(!0,"cts.token.onCancellationRequested")))),c.add(this._editor.onDidBlurEditorWidget((()=>{var t;return this.cancelInput(!(!((t=this._domNode)===null||t===void 0)&&t.ownerDocument.hasFocus()),"editor.onDidBlurEditorWidget")}))),this._show(),l.p}_getSelection(t,i){j(this._editor.hasModel());const e=this._editor.getSelection();let s=0,n=i.length;return Cs.isEmpty(e)||Cs.spansMultipleLines(e)||!Cs.containsRange(t,e)||(s=Math.max(0,e.startColumn-t.startColumn),n=Math.min(t.endColumn,e.endColumn)-t.startColumn),{start:s,end:n}}_show(){this._trace("invoking _show"),this._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber,0),this._visible=!0,this._visibleContextKey.set(!0),this._editor.layoutContentWidget(this),setTimeout((()=>{this._input.domNode.focus(),this._input.domNode.setSelectionRange(parseInt(this._input.domNode.getAttribute("selectionStart")),parseInt(this._input.domNode.getAttribute("selectionEnd")))}),100)}async _updateRenameCandidates(t,i,e){const s=(...t)=>this._trace("_updateRenameCandidates",...t);s("start");const n=await fo(Promise.allSettled(t),e);if(n===void 0)return void s("returning early - received updateRenameCandidates results - undefined");const r=n.flatMap((t=>t.status==="fulfilled"&&$(t.value)?t.value:[]));s(`received updateRenameCandidates results - total (unfiltered) ${r.length} candidates.`);const o=g(r,(t=>t.newSymbolName));s(`distinct candidates - ${o.length} candidates.`);const h=o.filter((({newSymbolName:t})=>t.trim().length>0&&t!==this._input.domNode.value&&t!==i));s(`valid distinct candidates - ${r.length} candidates.`),h.length<1?s("returning early - no valid distinct candidates"):(s("setting candidates"),this._renameCandidateListView.setCandidates(h),s("asking editor to re-layout"),this._editor.layoutContentWidget(this))}_hide(){this._trace("invoked _hide"),this._visible=!1,this._visibleContextKey.reset(),this._editor.layoutContentWidget(this)}_getTopForPosition(){const t=this._editor.getVisibleRanges();let i;return t.length>0?i=t[0].startLineNumber:(this._logService.warn("RenameWidget#_getTopForPosition: this should not happen - visibleRanges is empty"),i=Math.max(1,this._position.lineNumber-5)),this._editor.getTopForLineNumber(this._position.lineNumber)-this._editor.getTopForLineNumber(i)}_trace(...t){this._logService.trace("RenameWidget",...t)}};irt=Ynt([Xnt(2,AC),Xnt(3,NS),Xnt(4,Ra),Xnt(5,ou)],irt);class ert{constructor(t,i){this._disposables=new Ji,this._availableHeight=0,this._minimumWidth=0,this._lineHeight=i.fontInfo.lineHeight,this._typicalHalfwidthCharacterWidth=i.fontInfo.typicalHalfwidthCharacterWidth,this._listContainer=document.createElement("div"),t.appendChild(this._listContainer),this._listWidget=ert._createListWidget(this._listContainer,this._candidateViewHeight,i.fontInfo),this._listWidget.onDidChangeFocus((t=>{t.elements.length===1&&i.onFocusChange(t.elements[0].newSymbolName)}),this._disposables),this._listWidget.onDidChangeSelection((t=>{t.elements.length===1&&i.onSelectionChange()}),this._disposables),this._disposables.add(this._listWidget.onDidBlur((t=>{this._listWidget.setFocus([])}))),this._listWidget.style(pW({listInactiveFocusForeground:_y,listInactiveFocusBackground:Ny}))}dispose(){this._listWidget.dispose(),this._disposables.dispose()}layout({height:t,width:i}){this._availableHeight=t,this._minimumWidth=i}setCandidates(t){this._listWidget.splice(0,0,t);const i=this._pickListHeight(t.length),e=this._pickListWidth(t);this._listWidget.layout(i,e),this._listContainer.style.height=`${i}px`,this._listContainer.style.width=`${e}px`,ow(tt(0,"Received {0} rename suggestions",t.length))}clearCandidates(){this._listContainer.style.height="0px",this._listContainer.style.width="0px",this._listWidget.splice(0,this._listWidget.length,[])}get nCandidates(){return this._listWidget.length}get focusedCandidate(){if(this._listWidget.length===0)return;const t=this._listWidget.getSelectedElements()[0];if(t!==void 0)return t.newSymbolName;const i=this._listWidget.getFocusedElements()[0];return i!==void 0?i.newSymbolName:void 0}focusNext(){if(this._listWidget.length===0)return!1;const t=this._listWidget.getFocus();return t.length===0?(this._listWidget.focusFirst(),!0):t[0]===this._listWidget.length-1?(this._listWidget.setFocus([]),!1):(this._listWidget.focusNext(),!0)}focusPrevious(){if(this._listWidget.length===0)return!1;const t=this._listWidget.getFocus();return t.length===0?(this._listWidget.focusLast(),!0):t[0]===0?(this._listWidget.setFocus([]),!1):(this._listWidget.focusPrevious(),!0)}clearFocus(){this._listWidget.setFocus([])}get _candidateViewHeight(){const{totalHeight:t}=nrt.getLayoutInfo({lineHeight:this._lineHeight});return t}_pickListHeight(t){const i=this._candidateViewHeight*t;return Math.min(i,this._availableHeight,7*this._candidateViewHeight)}_pickListWidth(t){const i=Math.ceil(Math.max(...t.map((t=>t.newSymbolName.length)))*this._typicalHalfwidthCharacterWidth);return Math.max(this._minimumWidth,25+i+10)}static _createListWidget(t,i,e){const s=new class{getTemplateId(t){return"candidate"}getHeight(t){return i}},n=new class{constructor(){this.templateId="candidate"}renderTemplate(t){return new nrt(t,e)}renderElement(t,i,e){e.populate(t)}disposeTemplate(t){t.dispose()}};return new W$("NewSymbolNameCandidates",t,s,[n],{keyboardSupport:!1,mouseSupport:!0,multipleSelectionSupport:!1})}}class srt{constructor(){this._onDidChange=new le,this.onDidChange=this._onDidChange.event,this._disposables=new Ji}get domNode(){return this._domNode||(this._domNode=document.createElement("input"),this._domNode.className="rename-input",this._domNode.type="text",this._domNode.setAttribute("aria-label",tt(0,"Rename input. Type new name and press Enter to commit.")),this._disposables.add(sc(this._domNode,"input",(()=>this._onDidChange.fire())))),this._domNode}dispose(){this._onDidChange.dispose(),this._disposables.dispose()}}class nrt{constructor(t,i){this._domNode=document.createElement("div"),this._domNode.style.display="flex",this._domNode.style.columnGap="5px",this._domNode.style.alignItems="center",this._domNode.style.height=`${i.lineHeight}px`,this._domNode.style.padding=`${nrt._PADDING}px`;const e=document.createElement("div");e.style.display="flex",e.style.alignItems="center",e.style.width=e.style.height=.8*i.lineHeight+"px",this._domNode.appendChild(e),this._icon=yI(As.sparkle),this._icon.style.display="none",e.appendChild(this._icon),this._label=document.createElement("div"),xl(this._label,i),this._domNode.appendChild(this._label),t.appendChild(this._domNode)}populate(t){this._updateIcon(t),this._updateLabel(t)}_updateIcon(t){var i;const e=!!(!((i=t.tags)===null||i===void 0)&&i.includes(Ws.AIGenerated));this._icon.style.display=e?"inherit":"none"}_updateLabel(t){this._label.innerText=t.newSymbolName}static getLayoutInfo({lineHeight:t}){return{totalHeight:t+2*nrt._PADDING}}dispose(){}}nrt._PADDING=2;var rrt,ort=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},hrt=function(t,i){return function(e,s){i(e,s,t)}};class crt{constructor(t,i,e){this.model=t,this.position=i,this._providerRenameIdx=0,this._providers=e.ordered(t)}hasProvider(){return this._providers.length>0}async resolveRenameLocation(t){const i=[];for(this._providerRenameIdx=0;this._providerRenameIdx<this._providers.length;this._providerRenameIdx++){const e=this._providers[this._providerRenameIdx];if(!e.resolveRenameLocation)break;const s=await e.resolveRenameLocation(this.model,this.position,t);if(s){if(!s.rejectReason)return s;i.push(s.rejectReason)}}this._providerRenameIdx=0;const e=this.model.getWordAtPosition(this.position);return e?{range:new Cs(this.position.lineNumber,e.startColumn,this.position.lineNumber,e.endColumn),text:e.word,rejectReason:i.length>0?i.join(`\n`):void 0}:{range:Cs.fromPositions(this.position),text:"",rejectReason:i.length>0?i.join(`\n`):void 0}}async provideRenameEdits(t,i){return this._provideRenameEdits(t,this._providerRenameIdx,[],i)}async _provideRenameEdits(t,i,e,s){const n=this._providers[i];if(!n)return{edits:[],rejectReason:e.join(`\n`)};const r=await n.provideRenameEdits(this.model,this.position,t,s);return r?r.rejectReason?this._provideRenameEdits(t,i+1,e.concat(r.rejectReason),s):r:this._provideRenameEdits(t,i+1,e.concat(tt(0,"No result.")),s)}}let lrt=rrt=class{static get(t){return t.getContribution(rrt.ID)}constructor(t,i,e,s,n,r,o,h,c){this.editor=t,this._instaService=i,this._notificationService=e,this._bulkEditService=s,this._progressService=n,this._logService=r,this._configService=o,this._languageFeaturesService=h,this._telemetryService=c,this._disposableStore=new Ji,this._cts=new ye,this._renameWidget=this._disposableStore.add(this._instaService.createInstance(irt,this.editor,["acceptRenameInput","acceptRenameInputWithPreview"]))}dispose(){this._disposableStore.dispose(),this._cts.dispose(!0)}async run(){var t,i;const e=this._logService.trace.bind(this._logService,"[rename]");if(this._cts.dispose(!0),this._cts=new ye,!this.editor.hasModel())return void e("editor has no model");const s=this.editor.getPosition(),n=new crt(this.editor.getModel(),s,this._languageFeaturesService.renameProvider);if(!n.hasProvider())return void e("skeleton has no provider");const r=new _Q(this.editor,5,void 0,this._cts.token);let o;try{e("resolving rename location");const t=n.resolveRenameLocation(r.token);this._progressService.showWhile(t,250),o=await t,e("resolved rename location")}catch(i){return void(i instanceof $i?e("resolve rename location cancelled",JSON.stringify(i,null,"\t")):(e("resolve rename location failed",i instanceof Error?i:JSON.stringify(i,null,"\t")),(typeof i=="string"||R_(i))&&((t=A0.get(this.editor))===null||t===void 0||t.showMessage(i||tt(0,"An unknown error occurred while resolving rename location"),s))))}finally{r.dispose()}if(!o)return void e("returning early - no loc");if(o.rejectReason)return e(`returning early - rejected with reason: ${o.rejectReason}`,o.rejectReason),void((i=A0.get(this.editor))===null||i===void 0||i.showMessage(o.rejectReason,s));if(r.token.isCancellationRequested)return void e("returning early - cts1 cancelled");const h=new _Q(this.editor,5,o.range,this._cts.token),c=this.editor.getModel(),l=this._languageFeaturesService.newSymbolNamesProvider.all(c);e("creating rename input field and awaiting its result");const a=this._bulkEditService.hasPreviewHandler()&&this._configService.getValue(this.editor.getModel().uri,"editor.rename.enablePreview"),u=await this._renameWidget.getInput(o.range,o.text,a,(t=>l.map((i=>i.provideNewSymbolNames(c,o.range,t)))),h);if(e("received response from rename input field"),l.length>0&&this._reportTelemetry(l.length,c.getLanguageId(),u),typeof u=="boolean")return e(`returning early - rename input field response - ${u}`),u&&this.editor.focus(),void h.dispose();this.editor.focus(),e("requesting rename edits");const d=fo(n.provideRenameEdits(u.newName,h.token),h.token).then((async t=>{if(t)if(this.editor.hasModel()){if(t.rejectReason)return e(`returning early - rejected with reason: ${t.rejectReason}`),void this._notificationService.info(t.rejectReason);this.editor.setSelection(Cs.fromPositions(this.editor.getSelection().getPosition())),e("applying edits"),this._bulkEditService.apply(t,{editor:this.editor,showPreview:u.wantsPreview,label:tt(0,"Renaming '{0}' to '{1}'",o==null?void 0:o.text,u.newName),code:"undoredo.rename",quotableLabel:tt(0,"Renaming {0} to {1}",o==null?void 0:o.text,u.newName),respectAutoSaveConfig:!0}).then((t=>{e("edits applied"),t.ariaSummary&&rw(tt(0,"Successfully renamed '{0}' to '{1}'. Summary: {2}",o.text,u.newName,t.ariaSummary))})).catch((t=>{e(`error when applying edits ${JSON.stringify(t,null,"\t")}`),this._notificationService.error(tt(0,"Rename failed to apply edits")),this._logService.error(t)}))}else e("returning early - no model after rename edits are provided");else e("returning early - no rename edits result")}),(t=>{e("error when providing rename edits",JSON.stringify(t,null,"\t")),this._notificationService.error(tt(0,"Rename failed to compute edits")),this._logService.error(t)})).finally((()=>{h.dispose()}));return e("returning rename operation"),this._progressService.showWhile(d,250),d}acceptRenameInput(t){this._renameWidget.acceptInput(t)}cancelRenameInput(){this._renameWidget.cancelInput(!0,"cancelRenameInput command")}focusNextRenameSuggestion(){this._renameWidget.focusNextRenameSuggestion()}focusPreviousRenameSuggestion(){this._renameWidget.focusPreviousRenameSuggestion()}_reportTelemetry(t,i,e){const s=typeof e=="boolean"?{kind:"cancelled",languageId:i,nRenameSuggestionProviders:t}:{kind:"accepted",languageId:i,nRenameSuggestionProviders:t,source:e.stats.source.k,nRenameSuggestions:e.stats.nRenameSuggestions,timeBeforeFirstInputFieldEdit:e.stats.timeBeforeFirstInputFieldEdit,wantsPreview:e.wantsPreview};this._telemetryService.publicLog2("renameInvokedEvent",s)}};lrt.ID="editor.contrib.renameController",lrt=rrt=ort([hrt(1,Il),hrt(2,gR),hrt(3,PP),hrt(4,yN),hrt(5,ou),hrt(6,Np),hrt(7,$p),hrt(8,ru)],lrt);Su(lrt.ID,lrt,4),ku(class extends mu{constructor(){super({id:"editor.action.rename",label:tt(0,"Rename Symbol"),alias:"Rename Symbol",precondition:ua.and(Ox.writable,Ox.hasRenameProvider),kbOpts:{kbExpr:Ox.editorTextFocus,primary:60,weight:100},contextMenuOpts:{group:"1_modification",order:1.1}})}runCommand(t,i){const e=t.get(Pl),[s,n]=Array.isArray(i)&&i||[void 0,void 0];return as.isUri(s)&&ks.isIPosition(n)?e.openCodeEditor({resource:s},e.getActiveCodeEditor()).then((t=>{t&&(t.setPosition(n),t.invokeWithinContext((i=>(this.reportTelemetry(i,t),this.run(i,t)))))}),Ii):super.runCommand(t,i)}run(t,i){const e=t.get(ou),s=lrt.get(i);return s?(e.trace("[RenameAction] got controller, running..."),s.run()):(e.trace("[RenameAction] returning early - controller missing"),Promise.resolve())}});const art=pu.bindToContribution(lrt.get);yu(new art({id:"acceptRenameInput",precondition:trt,handler:t=>t.acceptRenameInput(!1),kbOpts:{weight:199,kbExpr:ua.and(Ox.focus,ua.not("isComposing")),primary:3}})),yu(new art({id:"acceptRenameInputWithPreview",precondition:ua.and(trt,ua.has("config.editor.rename.enablePreview")),handler:t=>t.acceptRenameInput(!0),kbOpts:{weight:199,kbExpr:ua.and(Ox.focus,ua.not("isComposing")),primary:2051}})),yu(new art({id:"cancelRenameInput",precondition:trt,handler:t=>t.cancelRenameInput(),kbOpts:{weight:199,kbExpr:Ox.focus,primary:9,secondary:[1033]}})),nu(class extends su{constructor(){super({id:"focusNextRenameSuggestion",title:{...it(0,"Focus Next Rename Suggestion")},precondition:trt,keybinding:[{primary:2,secondary:[18],weight:199}]})}run(t){const i=t.get(Pl).getFocusedCodeEditor();if(!i)return;const e=lrt.get(i);e&&e.focusNextRenameSuggestion()}}),nu(class extends su{constructor(){super({id:"focusPreviousRenameSuggestion",title:{...it(0,"Focus Previous Rename Suggestion")},precondition:trt,keybinding:[{primary:1026,secondary:[16],weight:199}]})}run(t){const i=t.get(Pl).getFocusedCodeEditor();if(!i)return;const e=lrt.get(i);e&&e.focusPreviousRenameSuggestion()}}),bu("_executeDocumentRenameProvider",(function(t,i,e,...s){const[n]=s;j(typeof n=="string");const{renameProvider:r}=t.get($p);return async function(t,i,e,s){const n=new crt(i,e,t),r=await n.resolveRenameLocation(ve.None);return r!=null&&r.rejectReason?{edits:[],rejectReason:r.rejectReason}:n.provideRenameEdits(s,ve.None)}(r,i,e,n)})),bu("_executePrepareRename",(async function(t,i,e){const{renameProvider:s}=t.get($p),n=new crt(i,e,s),r=await n.resolveRenameLocation(ve.None);if(r!=null&&r.rejectReason)throw new Error(r.rejectReason);return r})),Va.as(Hd).registerConfiguration({id:"editor",properties:{"editor.rename.enablePreview":{scope:5,description:tt(0,"Enable/disable the ability to preview changes before renaming"),default:!0,type:"boolean"}}});var urt=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},drt=function(t,i){return function(e,s){i(e,s,t)}};let frt=class extends Qi{constructor(t,i,e){super(),this.editor=t,this.languageConfigurationService=i,this.editorWorkerService=e,this.decorations=this.editor.createDecorationsCollection(),this.options=this.createOptions(t.getOption(73)),this.computePromise=null,this.currentOccurrences={},this._register(t.onDidChangeModel((i=>{this.currentOccurrences={},this.options=this.createOptions(t.getOption(73)),this.stop(),this.computeSectionHeaders.schedule(0)}))),this._register(t.onDidChangeModelLanguage((i=>{this.currentOccurrences={},this.options=this.createOptions(t.getOption(73)),this.stop(),this.computeSectionHeaders.schedule(0)}))),this._register(i.onDidChange((i=>{var e;const s=(e=this.editor.getModel())===null||e===void 0?void 0:e.getLanguageId();s&&i.affects(s)&&(this.currentOccurrences={},this.options=this.createOptions(t.getOption(73)),this.stop(),this.computeSectionHeaders.schedule(0))}))),this._register(t.onDidChangeConfiguration((i=>{this.options&&!i.hasChanged(73)||(this.options=this.createOptions(t.getOption(73)),this.updateDecorations([]),this.stop(),this.computeSectionHeaders.schedule(0))}))),this._register(this.editor.onDidChangeModelContent((t=>{this.computeSectionHeaders.schedule()}))),this.computeSectionHeaders=this._register(new Co((()=>{this.findSectionHeaders()}),250)),this.computeSectionHeaders.schedule(0)}createOptions(t){if(!t||!this.editor.hasModel())return;const i=this.editor.getModel().getLanguageId();if(!i)return;const e=this.languageConfigurationService.getLanguageConfiguration(i).comments,s=this.languageConfigurationService.getLanguageConfiguration(i).foldingRules;return e||s!=null&&s.markers?{foldingRules:s,findMarkSectionHeaders:t.showMarkSectionHeaders,findRegionSectionHeaders:t.showRegionSectionHeaders}:void 0}findSectionHeaders(){var t,i;if(!this.editor.hasModel()||!(!((t=this.options)===null||t===void 0)&&t.findMarkSectionHeaders)&&!(!((i=this.options)===null||i===void 0)&&i.findRegionSectionHeaders))return;const e=this.editor.getModel();if(e.isDisposed()||e.isTooLargeForSyncing())return;const s=e.getVersionId();this.editorWorkerService.findSectionHeaders(e.uri,this.options).then((t=>{e.isDisposed()||e.getVersionId()!==s||this.updateDecorations(t)}))}updateDecorations(t){const i=this.editor.getModel();i&&(t=t.filter((t=>{if(!t.shouldBeInComments)return!0;const e=i.validateRange(t.range),s=i.tokenization.getLineTokens(e.startLineNumber),n=s.findTokenIndexAtOffset(e.startColumn-1),r=s.getStandardTokenType(n);return s.getLanguageId(n)===i.getLanguageId()&&r===1})));const e=Object.values(this.currentOccurrences).map((t=>t.decorationId)),s=t.map((t=>function(t){return{range:t.range,options:xF.createDynamic({description:"section-header",stickiness:3,collapseOnReplaceEdit:!0,minimap:{color:void 0,position:1,sectionHeaderStyle:t.hasSeparatorLine?2:1,sectionHeaderText:t.text}})}}(t)));this.editor.changeDecorations((i=>{const n=i.deltaDecorations(e,s);this.currentOccurrences={};for(let i=0,e=n.length;i<e;i++){const e={sectionHeader:t[i],decorationId:n[i]};this.currentOccurrences[e.decorationId]=e}}))}stop(){this.computeSectionHeaders.cancel(),this.computePromise&&(this.computePromise.cancel(),this.computePromise=null)}dispose(){super.dispose(),this.stop(),this.decorations.clear()}};function grt(t){const i=new Uint32Array(function(t){let i=0;if(i+=2,t.type==="full")i+=1+t.data.length;else{i+=1,i+=3*t.deltas.length;for(const e of t.deltas)e.data&&(i+=e.data.length)}return i}(t));let e=0;if(i[e++]=t.id,t.type==="full")i[e++]=1,i[e++]=t.data.length,i.set(t.data,e),e+=t.data.length;else{i[e++]=2,i[e++]=t.deltas.length;for(const s of t.deltas)i[e++]=s.start,i[e++]=s.deleteCount,s.data?(i[e++]=s.data.length,i.set(s.data,e),e+=s.data.length):i[e++]=0}return function(t){const i=new Uint8Array(t.buffer,t.byteOffset,4*t.length);return Ot()||function(t){for(let i=0,e=t.length;i<e;i+=4){const e=t[i+0],s=t[i+1],n=t[i+2],r=t[i+3];t[i+0]=r,t[i+1]=n,t[i+2]=s,t[i+3]=e}}(i),nd.wrap(i)}(i)}function prt(t){return t&&!!t.data}function mrt(t){return t&&Array.isArray(t.edits)}frt.ID="editor.sectionHeaderDetector",frt=urt([drt(1,cf),drt(2,JW)],frt),Su(frt.ID,frt,1);class wrt{constructor(t,i,e){this.provider=t,this.tokens=i,this.error=e}}function vrt(t,i){return t.has(i)}async function brt(t,i,e,s,n){const r=function(t,i){const e=t.orderedGroups(i);return e.length>0?e[0]:[]}(t,i),o=await Promise.all(r.map((async t=>{let r,o=null;try{r=await t.provideDocumentSemanticTokens(i,t===e?s:null,n)}catch(t){o=t,r=null}return r&&(prt(r)||mrt(r))||(r=null),new wrt(t,r,o)})));for(const t of o){if(t.error)throw t.error;if(t.tokens)return t}return o.length>0?o[0]:null}class yrt{constructor(t,i){this.provider=t,this.tokens=i}}function krt(t,i){const e=t.orderedGroups(i);return e.length>0?e[0]:[]}async function Crt(t,i,e,s){const n=krt(t,i),r=await Promise.all(n.map((async t=>{let n;try{n=await t.provideDocumentRangeSemanticTokens(i,e,s)}catch(t){_i(t),n=null}return n&&prt(n)||(n=null),new yrt(t,n)})));for(const t of r)if(t.tokens)return t;return r.length>0?r[0]:null}Gl.registerCommand("_provideDocumentSemanticTokensLegend",(async(t,...i)=>{const[e]=i;j(e instanceof as);const s=t.get(Nl).getModel(e);if(!s)return;const{documentSemanticTokensProvider:n}=t.get($p),r=function(t,i){const e=t.orderedGroups(i);return e.length>0?e[0]:null}(n,s);return r?r[0].getLegend():t.get(ql).executeCommand("_provideDocumentRangeSemanticTokensLegend",e)})),Gl.registerCommand("_provideDocumentSemanticTokens",(async(t,...i)=>{const[e]=i;j(e instanceof as);const s=t.get(Nl).getModel(e);if(!s)return;const{documentSemanticTokensProvider:n}=t.get($p);if(!vrt(n,s))return t.get(ql).executeCommand("_provideDocumentRangeSemanticTokens",e,s.getFullModelRange());const r=await brt(n,s,null,null,ve.None);if(!r)return;const{provider:o,tokens:h}=r;if(!h||!prt(h))return;const c=grt({id:0,type:"full",data:h.data});return h.resultId&&o.releaseDocumentSemanticTokens(h.resultId),c})),Gl.registerCommand("_provideDocumentRangeSemanticTokensLegend",(async(t,...i)=>{const[e,s]=i;j(e instanceof as);const n=t.get(Nl).getModel(e);if(!n)return;const{documentRangeSemanticTokensProvider:r}=t.get($p),o=krt(r,n);if(o.length===0)return;if(o.length===1)return o[0].getLegend();if(!s||!Cs.isIRange(s))return console.warn("provideDocumentRangeSemanticTokensLegend might be out-of-sync with provideDocumentRangeSemanticTokens unless a range argument is passed in"),o[0].getLegend();const h=await Crt(r,n,Cs.lift(s),ve.None);return h?h.provider.getLegend():void 0})),Gl.registerCommand("_provideDocumentRangeSemanticTokens",(async(t,...i)=>{const[e,s]=i;j(e instanceof as),j(Cs.isIRange(s));const n=t.get(Nl).getModel(e);if(!n)return;const{documentRangeSemanticTokensProvider:r}=t.get($p),o=await Crt(r,n,Cs.lift(s),ve.None);return o&&o.tokens?grt({id:0,type:"full",data:o.tokens.data}):void 0}));const Srt="editor.semanticHighlighting";function xrt(t,i,e){var s;const n=(s=e.getValue(Srt,{overrideIdentifier:t.getLanguageId(),resource:t.uri}))===null||s===void 0?void 0:s.enabled;return typeof n=="boolean"?n:i.getColorTheme().semanticHighlighting}var Drt,Ert=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Art=function(t,i){return function(e,s){i(e,s,t)}};let Mrt=class extends Qi{constructor(t,i,e,s,n,r){super(),this._watchers=Object.create(null);const o=i=>{this._watchers[i.uri.toString()]=new Lrt(i,t,e,n,r)},h=(t,i)=>{i.dispose(),delete this._watchers[t.uri.toString()]},c=()=>{for(const t of i.getModels()){const i=this._watchers[t.uri.toString()];xrt(t,e,s)?i||o(t):i&&h(t,i)}};i.getModels().forEach((t=>{xrt(t,e,s)&&o(t)})),this._register(i.onModelAdded((t=>{xrt(t,e,s)&&o(t)}))),this._register(i.onModelRemoved((t=>{const i=this._watchers[t.uri.toString()];i&&h(t,i)}))),this._register(s.onDidChangeConfiguration((t=>{t.affectsConfiguration(Srt)&&c()}))),this._register(e.onDidColorThemeChange(c))}dispose(){for(const t of Object.values(this._watchers))t.dispose();super.dispose()}};Mrt=Ert([Art(0,SO),Art(1,Nl),Art(2,AC),Art(3,Md),Art(4,lO),Art(5,$p)],Mrt);let Lrt=Drt=class extends Qi{constructor(t,i,e,s,n){super(),this._semanticTokensStylingService=i,this._isDisposed=!1,this._model=t,this._provider=n.documentSemanticTokensProvider,this._debounceInformation=s.for(this._provider,"DocumentSemanticTokens",{min:Drt.REQUEST_MIN_DELAY,max:Drt.REQUEST_MAX_DELAY}),this._fetchDocumentSemanticTokens=this._register(new Co((()=>this._fetchDocumentSemanticTokensNow()),Drt.REQUEST_MIN_DELAY)),this._currentDocumentResponse=null,this._currentDocumentRequestCancellationTokenSource=null,this._documentProvidersChangeListeners=[],this._providersChangedDuringRequest=!1,this._register(this._model.onDidChangeContent((()=>{this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))}))),this._register(this._model.onDidChangeAttached((()=>{this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))}))),this._register(this._model.onDidChangeLanguage((()=>{this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._currentDocumentRequestCancellationTokenSource&&(this._currentDocumentRequestCancellationTokenSource.cancel(),this._currentDocumentRequestCancellationTokenSource=null),this._setDocumentSemanticTokens(null,null,null,[]),this._fetchDocumentSemanticTokens.schedule(0)})));const r=()=>{qi(this._documentProvidersChangeListeners),this._documentProvidersChangeListeners=[];for(const i of this._provider.all(t))typeof i.onDidChange=="function"&&this._documentProvidersChangeListeners.push(i.onDidChange((()=>{this._currentDocumentRequestCancellationTokenSource?this._providersChangedDuringRequest=!0:this._fetchDocumentSemanticTokens.schedule(0)})))};r(),this._register(this._provider.onDidChange((()=>{r(),this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))}))),this._register(e.onDidColorThemeChange((t=>{this._setDocumentSemanticTokens(null,null,null,[]),this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))}))),this._fetchDocumentSemanticTokens.schedule(0)}dispose(){this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._currentDocumentRequestCancellationTokenSource&&(this._currentDocumentRequestCancellationTokenSource.cancel(),this._currentDocumentRequestCancellationTokenSource=null),qi(this._documentProvidersChangeListeners),this._documentProvidersChangeListeners=[],this._setDocumentSemanticTokens(null,null,null,[]),this._isDisposed=!0,super.dispose()}_fetchDocumentSemanticTokensNow(){if(this._currentDocumentRequestCancellationTokenSource)return;if(!vrt(this._provider,this._model))return void(this._currentDocumentResponse&&this._model.tokenization.setSemanticTokens(null,!1));if(!this._model.isAttachedToEditor())return;const t=new ye,i=this._currentDocumentResponse?this._currentDocumentResponse.provider:null,e=this._currentDocumentResponse&&this._currentDocumentResponse.resultId||null,s=brt(this._provider,this._model,i,e,t.token);this._currentDocumentRequestCancellationTokenSource=t,this._providersChangedDuringRequest=!1;const n=[],r=this._model.onDidChangeContent((t=>{n.push(t)})),o=new se(!1);s.then((t=>{if(this._debounceInformation.update(this._model,o.elapsed()),this._currentDocumentRequestCancellationTokenSource=null,r.dispose(),t){const{provider:i,tokens:e}=t,s=this._semanticTokensStylingService.getStyling(i);this._setDocumentSemanticTokens(i,e||null,s,n)}else this._setDocumentSemanticTokens(null,null,null,n)}),(t=>{t&&(Bi(t)||typeof t.message=="string"&&t.message.indexOf("busy")!==-1)||Ii(t),this._currentDocumentRequestCancellationTokenSource=null,r.dispose(),(n.length>0||this._providersChangedDuringRequest)&&(this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model)))}))}static _copy(t,i,e,s,n){n=Math.min(n,e.length-s,t.length-i);for(let r=0;r<n;r++)e[s+r]=t[i+r]}_setDocumentSemanticTokens(t,i,e,s){const n=this._currentDocumentResponse,r=()=>{(s.length>0||this._providersChangedDuringRequest)&&!this._fetchDocumentSemanticTokens.isScheduled()&&this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))};if(this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._isDisposed)t&&i&&t.releaseDocumentSemanticTokens(i.resultId);else if(t&&e){if(!i)return this._model.tokenization.setSemanticTokens(null,!0),void r();if(mrt(i)){if(!n)return void this._model.tokenization.setSemanticTokens(null,!0);if(i.edits.length===0)i={resultId:i.resultId,data:n.data};else{let t=0;for(const e of i.edits)t+=(e.data?e.data.length:0)-e.deleteCount;const s=n.data,r=new Uint32Array(s.length+t);let o=s.length,h=r.length;for(let t=i.edits.length-1;t>=0;t--){const c=i.edits[t];if(c.start>s.length)return e.warnInvalidEditStart(n.resultId,i.resultId,t,c.start,s.length),void this._model.tokenization.setSemanticTokens(null,!0);const l=o-(c.start+c.deleteCount);l>0&&(Drt._copy(s,o-l,r,h-l,l),h-=l),c.data&&(Drt._copy(c.data,0,r,h-c.data.length,c.data.length),h-=c.data.length),o=c.start}o>0&&Drt._copy(s,0,r,0,o),i={resultId:i.resultId,data:r}}}if(prt(i)){this._currentDocumentResponse=new Frt(t,i.resultId,i.data);const n=yO(i,e,this._model.getLanguageId());if(s.length>0)for(const t of s)for(const i of n)for(const e of t.changes)i.applyEdit(e.range,e.text);this._model.tokenization.setSemanticTokens(n,!0)}else this._model.tokenization.setSemanticTokens(null,!0);r()}else this._model.tokenization.setSemanticTokens(null,!1)}};Lrt.REQUEST_MIN_DELAY=300,Lrt.REQUEST_MAX_DELAY=2e3,Lrt=Drt=Ert([Art(1,SO),Art(2,AC),Art(3,lO),Art(4,$p)],Lrt);class Frt{constructor(t,i,e){this.provider=t,this.resultId=i,this.data=e}dispose(){this.provider.releaseDocumentSemanticTokens(this.resultId)}}sq(Mrt);var Trt=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Rrt=function(t,i){return function(e,s){i(e,s,t)}};let Ort=class extends Qi{constructor(t,i,e,s,n,r){super(),this._semanticTokensStylingService=i,this._themeService=e,this._configurationService=s,this._editor=t,this._provider=r.documentRangeSemanticTokensProvider,this._debounceInformation=n.for(this._provider,"DocumentRangeSemanticTokens",{min:100,max:500}),this._tokenizeViewport=this._register(new Co((()=>this._tokenizeViewportNow()),100)),this._outstandingRequests=[];const o=()=>{this._editor.hasModel()&&this._tokenizeViewport.schedule(this._debounceInformation.get(this._editor.getModel()))};this._register(this._editor.onDidScrollChange((()=>{o()}))),this._register(this._editor.onDidChangeModel((()=>{this._cancelAll(),o()}))),this._register(this._editor.onDidChangeModelContent((t=>{this._cancelAll(),o()}))),this._register(this._provider.onDidChange((()=>{this._cancelAll(),o()}))),this._register(this._configurationService.onDidChangeConfiguration((t=>{t.affectsConfiguration(Srt)&&(this._cancelAll(),o())}))),this._register(this._themeService.onDidColorThemeChange((()=>{this._cancelAll(),o()}))),o()}_cancelAll(){for(const t of this._outstandingRequests)t.cancel();this._outstandingRequests=[]}_removeOutstandingRequest(t){for(let i=0,e=this._outstandingRequests.length;i<e;i++)if(this._outstandingRequests[i]===t)return void this._outstandingRequests.splice(i,1)}_tokenizeViewportNow(){if(!this._editor.hasModel())return;const t=this._editor.getModel();if(t.tokenization.hasCompleteSemanticTokens())return;if(!xrt(t,this._themeService,this._configurationService)||!function(t,i){return t.has(i)}(this._provider,t))return void(t.tokenization.hasSomeSemanticTokens()&&t.tokenization.setSemanticTokens(null,!1));const i=this._editor.getVisibleRangesPlusViewportAboveBelow();this._outstandingRequests=this._outstandingRequests.concat(i.map((i=>this._requestRange(t,i))))}_requestRange(t,i){const e=t.getVersionId(),s=uo((e=>Promise.resolve(Crt(this._provider,t,i,e)))),n=new se(!1);return s.then((s=>{if(this._debounceInformation.update(t,n.elapsed()),!s||!s.tokens||t.isDisposed()||t.getVersionId()!==e)return;const{provider:r,tokens:o}=s,h=this._semanticTokensStylingService.getStyling(r);t.tokenization.setPartialSemanticTokens(i,yO(o,h,t.getLanguageId()))})).then((()=>this._removeOutstandingRequest(s)),(()=>this._removeOutstandingRequest(s))),s}};Ort.ID="editor.contrib.viewportSemanticTokens",Ort=Trt([Rrt(1,SO),Rrt(2,AC),Rrt(3,Md),Rrt(4,lO),Rrt(5,$p)],Ort),Su(Ort.ID,Ort,1);class Irt{constructor(t=!0){this.selectSubwords=t}provideSelectionRanges(t,i){const e=[];for(const s of i){const i=[];e.push(i),this.selectSubwords&&this._addInWordRanges(i,t,s),this._addWordRanges(i,t,s),this._addWhitespaceLine(i,t,s),i.push({range:t.getFullModelRange()})}return e}_addInWordRanges(t,i,e){const s=i.getWordAtPosition(e);if(!s)return;const{word:n,startColumn:r}=s,o=e.column-r;let h=o,c=o,l=0;for(;h>=0;h--){const t=n.charCodeAt(h);if(h!==o&&(t===95||t===45)||cr(t)&&lr(l))break;l=t}for(h+=1;c<n.length;c++){const t=n.charCodeAt(c);if(lr(t)&&cr(l)||t===95||t===45)break;l=t}h<c&&t.push({range:new Cs(e.lineNumber,r+h,e.lineNumber,r+c)})}_addWordRanges(t,i,e){const s=i.getWordAtPosition(e);s&&t.push({range:new Cs(e.lineNumber,s.startColumn,e.lineNumber,s.endColumn)})}_addWhitespaceLine(t,i,e){i.getLineLength(e.lineNumber)>0&&i.getLineFirstNonWhitespaceColumn(e.lineNumber)===0&&i.getLineLastNonWhitespaceColumn(e.lineNumber)===0&&t.push({range:new Cs(e.lineNumber,1,e.lineNumber,i.getLineMaxColumn(e.lineNumber))})}}var _rt,Prt=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Nrt=function(t,i){return function(e,s){i(e,s,t)}};class Brt{constructor(t,i){this.index=t,this.ranges=i}mov(t){const i=this.index+(t?1:-1);if(i<0||i>=this.ranges.length)return this;const e=new Brt(i,this.ranges);return e.ranges[i].equalsRange(this.ranges[this.index])?e.mov(t):e}}let $rt=_rt=class{static get(t){return t.getContribution(_rt.ID)}constructor(t,i){this._editor=t,this._languageFeaturesService=i,this._ignoreSelection=!1}dispose(){var t;(t=this._selectionListener)===null||t===void 0||t.dispose()}async run(t){if(!this._editor.hasModel())return;const i=this._editor.getSelections(),e=this._editor.getModel();if(this._state||await jrt(this._languageFeaturesService.selectionRangeProvider,e,i.map((t=>t.getPosition())),this._editor.getOption(113),ve.None).then((t=>{var e;if(f(t)&&t.length===i.length&&this._editor.hasModel()&&n(this._editor.getSelections(),i,((t,i)=>t.equalsSelection(i)))){for(let e=0;e<t.length;e++)t[e]=t[e].filter((t=>t.containsPosition(i[e].getStartPosition())&&t.containsPosition(i[e].getEndPosition()))),t[e].unshift(i[e]);this._state=t.map((t=>new Brt(0,t))),(e=this._selectionListener)===null||e===void 0||e.dispose(),this._selectionListener=this._editor.onDidChangeCursorPosition((()=>{var t;this._ignoreSelection||((t=this._selectionListener)===null||t===void 0||t.dispose(),this._state=void 0)}))}})),!this._state)return;this._state=this._state.map((i=>i.mov(t)));const s=this._state.map((t=>Ss.fromPositions(t.ranges[t.index].getStartPosition(),t.ranges[t.index].getEndPosition())));this._ignoreSelection=!0;try{this._editor.setSelections(s)}finally{this._ignoreSelection=!1}}};$rt.ID="editor.contrib.smartSelectController",$rt=_rt=Prt([Nrt(1,$p)],$rt);class Wrt extends mu{constructor(t,i){super(i),this._forward=t}async run(t,i){const e=$rt.get(i);e&&await e.run(this._forward)}}Gl.registerCommandAlias("editor.action.smartSelect.grow","editor.action.smartSelect.expand");async function jrt(t,i,e,s,n){const r=t.all(i).concat(new Irt(s.selectSubwords));r.length===1&&r.unshift(new git);const o=[],h=[];for(const t of r)o.push(Promise.resolve(t.provideSelectionRanges(i,e,n)).then((t=>{if(f(t)&&t.length===e.length)for(let i=0;i<e.length;i++){h[i]||(h[i]=[]);for(const s of t[i])Cs.isIRange(s.range)&&Cs.containsPosition(s.range,e[i])&&h[i].push(Cs.lift(s.range))}}),_i));return await Promise.all(o),h.map((t=>{if(t.length===0)return[];t.sort(((t,i)=>ks.isBefore(t.getStartPosition(),i.getStartPosition())?1:ks.isBefore(i.getStartPosition(),t.getStartPosition())||ks.isBefore(t.getEndPosition(),i.getEndPosition())?-1:ks.isBefore(i.getEndPosition(),t.getEndPosition())?1:0));const e=[];let n;for(const i of t)(!n||Cs.containsRange(i,n)&&!Cs.equalsRange(i,n))&&(e.push(i),n=i);if(!s.selectLeadingAndTrailingWhitespace)return e;const r=[e[0]];for(let t=1;t<e.length;t++){const s=e[t-1],n=e[t];if(n.startLineNumber!==s.startLineNumber||n.endLineNumber!==s.endLineNumber){const t=new Cs(s.startLineNumber,i.getLineFirstNonWhitespaceColumn(s.startLineNumber),s.endLineNumber,i.getLineLastNonWhitespaceColumn(s.endLineNumber));t.containsRange(s)&&!t.equalsRange(s)&&n.containsRange(t)&&!n.equalsRange(t)&&r.push(t);const e=new Cs(s.startLineNumber,1,s.endLineNumber,i.getLineMaxColumn(s.endLineNumber));e.containsRange(s)&&!e.equalsRange(t)&&n.containsRange(e)&&!n.equalsRange(e)&&r.push(e)}r.push(n)}return r}))}Su($rt.ID,$rt,4),ku(class extends Wrt{constructor(){super(!0,{id:"editor.action.smartSelect.expand",label:tt(0,"Expand Selection"),alias:"Expand Selection",precondition:void 0,kbOpts:{kbExpr:Ox.editorTextFocus,primary:1553,mac:{primary:3345,secondary:[1297]},weight:100},menuOpts:{menuId:Qa.MenubarSelectionMenu,group:"1_basic",title:tt(0,"&&Expand Selection"),order:2}})}}),ku(class extends Wrt{constructor(){super(!1,{id:"editor.action.smartSelect.shrink",label:tt(0,"Shrink Selection"),alias:"Shrink Selection",precondition:void 0,kbOpts:{kbExpr:Ox.editorTextFocus,primary:1551,mac:{primary:3343,secondary:[1295]},weight:100},menuOpts:{menuId:Qa.MenubarSelectionMenu,group:"1_basic",title:tt(0,"&&Shrink Selection"),order:3}})}}),Gl.registerCommand("_executeSelectionRangeProvider",(async function(t,...i){const[e,s]=i;j(as.isUri(e));const n=t.get($p).selectionRangeProvider,r=await t.get(Bl).createModelReference(e);try{return jrt(n,r.object.textEditorModel,s,{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},ve.None)}finally{r.dispose()}}));const Hrt=Object.freeze({View:it(0,"View"),Help:it(0,"Help"),Test:it(0,"Test"),File:it(0,"File"),Preferences:it(0,"Preferences"),Developer:it(0,"Developer")});class Vrt{constructor(t,i,e,s=null){this.startLineNumbers=t,this.endLineNumbers=i,this.lastLineRelativePosition=e,this.showEndForLine=s}equals(t){return!!t&&this.lastLineRelativePosition===t.lastLineRelativePosition&&this.showEndForLine===t.showEndForLine&&n(this.startLineNumbers,t.startLineNumbers)&&n(this.endLineNumbers,t.endLineNumbers)}}const zrt=ju("stickyScrollViewLayer",{createHTML:t=>t}),Urt="data-sticky-line-index",Krt="data-sticky-is-line",qrt="data-sticky-is-folding-icon";class Grt extends Qi{constructor(t){super(),this._editor=t,this._foldingIconStore=new Ji,this._rootDomNode=document.createElement("div"),this._lineNumbersDomNode=document.createElement("div"),this._linesDomNodeScrollable=document.createElement("div"),this._linesDomNode=document.createElement("div"),this._lineHeight=this._editor.getOption(67),this._renderedStickyLines=[],this._lineNumbers=[],this._lastLineRelativePosition=0,this._minContentWidthInPx=0,this._isOnGlyphMargin=!1,this._lineNumbersDomNode.className="sticky-widget-line-numbers",this._lineNumbersDomNode.setAttribute("role","none"),this._linesDomNode.className="sticky-widget-lines",this._linesDomNode.setAttribute("role","list"),this._linesDomNodeScrollable.className="sticky-widget-lines-scrollable",this._linesDomNodeScrollable.appendChild(this._linesDomNode),this._rootDomNode.className="sticky-widget",this._rootDomNode.classList.toggle("peek",t instanceof l4),this._rootDomNode.appendChild(this._lineNumbersDomNode),this._rootDomNode.appendChild(this._linesDomNodeScrollable);const i=()=>{this._linesDomNode.style.left=this._editor.getOption(115).scrollWithEditor?`-${this._editor.getScrollLeft()}px`:"0px"};this._register(this._editor.onDidChangeConfiguration((t=>{t.hasChanged(115)&&i(),t.hasChanged(67)&&(this._lineHeight=this._editor.getOption(67))}))),this._register(this._editor.onDidScrollChange((t=>{t.scrollLeftChanged&&i(),t.scrollWidthChanged&&this._updateWidgetWidth()}))),this._register(this._editor.onDidChangeModel((()=>{i(),this._updateWidgetWidth()}))),this._register(this._foldingIconStore),i(),this._register(this._editor.onDidLayoutChange((t=>{this._updateWidgetWidth()}))),this._updateWidgetWidth()}get lineNumbers(){return this._lineNumbers}get lineNumberCount(){return this._lineNumbers.length}getRenderedStickyLine(t){return this._renderedStickyLines.find((i=>i.lineNumber===t))}getCurrentLines(){return this._lineNumbers}setState(t,i,e){if(e===void 0&&(!this._previousState&&!t||this._previousState&&this._previousState.equals(t)))return;const s=this._isWidgetHeightZero(t),n=s?void 0:t,r=s?0:this._findLineToRebuildWidgetFrom(t,e);this._renderRootNode(n,i,r),this._previousState=t}_isWidgetHeightZero(t){if(!t)return!0;const i=t.startLineNumbers.length*this._lineHeight+t.lastLineRelativePosition;if(i>0){this._lastLineRelativePosition=t.lastLineRelativePosition;const i=[...t.startLineNumbers];t.showEndForLine!==null&&(i[t.showEndForLine]=t.endLineNumbers[t.showEndForLine]),this._lineNumbers=i}else this._lastLineRelativePosition=0,this._lineNumbers=[];return i===0}_findLineToRebuildWidgetFrom(t,i){if(!t||!this._previousState)return 0;if(i!==void 0)return i;const e=this._previousState,s=t.startLineNumbers.findIndex((t=>!e.startLineNumbers.includes(t)));return s===-1?0:s}_updateWidgetWidth(){const t=this._editor.getLayoutInfo(),i=t.contentLeft;this._lineNumbersDomNode.style.width=`${i}px`,this._linesDomNodeScrollable.style.setProperty("--vscode-editorStickyScroll-scrollableWidth",this._editor.getScrollWidth()-t.verticalScrollbarWidth+"px"),this._rootDomNode.style.width=t.width-t.verticalScrollbarWidth+"px"}_clearStickyLinesFromLine(t){this._foldingIconStore.clear();for(let i=t;i<this._renderedStickyLines.length;i++){const t=this._renderedStickyLines[i];t.lineNumberDomNode.remove(),t.lineDomNode.remove()}this._renderedStickyLines=this._renderedStickyLines.slice(0,t),this._rootDomNode.style.display="none"}_useFoldingOpacityTransition(t){this._lineNumbersDomNode.style.setProperty("--vscode-editorStickyScroll-foldingOpacityTransition",`opacity ${t?.5:0}s`)}_setFoldingIconsVisibility(t){for(const i of this._renderedStickyLines){const e=i.foldingIcon;e&&e.setVisible(!!t||e.isCollapsed)}}async _renderRootNode(t,i,e){if(this._clearStickyLinesFromLine(e),!t)return;for(const t of this._renderedStickyLines)this._updateTopAndZIndexOfStickyLine(t);const s=this._editor.getLayoutInfo(),n=this._lineNumbers.slice(e);for(const[t,r]of n.entries()){const n=this._renderChildNode(t+e,r,i,s);n&&(this._linesDomNode.appendChild(n.lineDomNode),this._lineNumbersDomNode.appendChild(n.lineNumberDomNode),this._renderedStickyLines.push(n))}i&&(this._setFoldingHoverListeners(),this._useFoldingOpacityTransition(!this._isOnGlyphMargin));const r=this._lineNumbers.length*this._lineHeight+this._lastLineRelativePosition;this._rootDomNode.style.display="block",this._lineNumbersDomNode.style.height=`${r}px`,this._linesDomNodeScrollable.style.height=`${r}px`,this._rootDomNode.style.height=`${r}px`,this._rootDomNode.style.marginLeft="0px",this._minContentWidthInPx=Math.max(...this._renderedStickyLines.map((t=>t.scrollWidth)))+s.verticalScrollbarWidth,this._editor.layoutOverlayWidget(this)}_setFoldingHoverListeners(){this._editor.getOption(110)==="mouseover"&&(this._foldingIconStore.add(sc(this._lineNumbersDomNode,qc.MOUSE_ENTER,(()=>{this._isOnGlyphMargin=!0,this._setFoldingIconsVisibility(!0)}))),this._foldingIconStore.add(sc(this._lineNumbersDomNode,qc.MOUSE_LEAVE,(()=>{this._isOnGlyphMargin=!1,this._useFoldingOpacityTransition(!0),this._setFoldingIconsVisibility(!1)}))))}_renderChildNode(t,i,e,s){const n=this._editor._getViewModel();if(!n)return;const r=n.coordinatesConverter.convertModelPositionToViewPosition(new ks(i,1)).lineNumber,o=n.getViewLineRenderingData(r),h=this._editor.getOption(68);let c;try{c=rm.filter(o.inlineDecorations,r,o.minColumn,o.maxColumn)}catch{c=[]}const l=new um(!0,!0,o.content,o.continuesWithWrappedLine,o.isBasicASCII,o.containsRTL,0,o.tokens,c,o.tabSize,o.startVisibleColumn,1,1,1,500,"none",!0,!0,null),a=new gd(2e3),u=pm(l,a);let d;d=zrt?zrt.createHTML(a.build()):a.build();const f=document.createElement("span");f.setAttribute(Urt,String(t)),f.setAttribute(Krt,""),f.setAttribute("role","listitem"),f.tabIndex=0,f.className="sticky-line-content",f.classList.add(`stickyLine${i}`),f.style.lineHeight=`${this._lineHeight}px`,f.innerHTML=d;const g=document.createElement("span");g.setAttribute(Urt,String(t)),g.setAttribute("data-sticky-is-line-number",""),g.className="sticky-line-number",g.style.lineHeight=`${this._lineHeight}px`;const p=s.contentLeft;g.style.width=`${p}px`;const m=document.createElement("span");h.renderType===1||h.renderType===3&&i%10==0?m.innerText=i.toString():h.renderType===2&&(m.innerText=Math.abs(i-this._editor.getPosition().lineNumber).toString()),m.className="sticky-line-number-inner",m.style.lineHeight=`${this._lineHeight}px`,m.style.width=`${s.lineNumbersWidth}px`,m.style.paddingLeft=`${s.lineNumbersLeft}px`,g.appendChild(m);const w=this._renderFoldingIconForLine(e,i);w&&g.appendChild(w.domNode),this._editor.applyFontInfo(f),this._editor.applyFontInfo(m),g.style.lineHeight=`${this._lineHeight}px`,f.style.lineHeight=`${this._lineHeight}px`,g.style.height=`${this._lineHeight}px`,f.style.height=`${this._lineHeight}px`;const v=new Zrt(t,i,f,g,w,u.characterMapping,f.scrollWidth);return this._updateTopAndZIndexOfStickyLine(v)}_updateTopAndZIndexOfStickyLine(t){var i;const e=t.index,s=t.lineDomNode,n=t.lineNumberDomNode,r=e===this._lineNumbers.length-1;s.style.zIndex=r?"0":"1",n.style.zIndex=r?"0":"1";const o=`${e*this._lineHeight+this._lastLineRelativePosition+(!((i=t.foldingIcon)===null||i===void 0)&&i.isCollapsed?1:0)}px`,h=e*this._lineHeight+"px";return s.style.top=r?o:h,n.style.top=r?o:h,t}_renderFoldingIconForLine(t,i){const e=this._editor.getOption(110);if(!t||e==="never")return;const s=t.regions,n=s.findRange(i),r=s.getStartLineNumber(n);if(i!==r)return;const o=s.isCollapsed(n),h=new Jrt(o,r,s.getEndLineNumber(n),this._lineHeight);return h.setVisible(!!this._isOnGlyphMargin||o||e==="always"),h.domNode.setAttribute(qrt,""),h}getId(){return"editor.contrib.stickyScrollWidget"}getDomNode(){return this._rootDomNode}getPosition(){return{preference:null}}getMinContentWidthInPx(){return this._minContentWidthInPx}focusLineWithIndex(t){0<=t&&t<this._renderedStickyLines.length&&this._renderedStickyLines[t].lineDomNode.focus()}getEditorPositionFromNode(t){if(!t||t.children.length>0)return null;const i=this._getRenderedStickyLineFromChildDomNode(t);if(!i)return null;const e=kk(i.characterMapping,t,0);return new ks(i.lineNumber,e)}getLineNumberFromChildDomNode(t){var i,e;return(e=(i=this._getRenderedStickyLineFromChildDomNode(t))===null||i===void 0?void 0:i.lineNumber)!==null&&e!==void 0?e:null}_getRenderedStickyLineFromChildDomNode(t){const i=this.getLineIndexFromChildDomNode(t);return i===null||i<0||i>=this._renderedStickyLines.length?null:this._renderedStickyLines[i]}getLineIndexFromChildDomNode(t){const i=this._getAttributeValue(t,Urt);return i?parseInt(i,10):null}isInStickyLine(t){return this._getAttributeValue(t,Krt)!==void 0}isInFoldingIconDomNode(t){return this._getAttributeValue(t,qrt)!==void 0}_getAttributeValue(t,i){for(;t&&t!==this._rootDomNode;){const e=t.getAttribute(i);if(e!==null)return e;t=t.parentElement}}}class Zrt{constructor(t,i,e,s,n,r,o){this.index=t,this.lineNumber=i,this.lineDomNode=e,this.lineNumberDomNode=s,this.foldingIcon=n,this.characterMapping=r,this.scrollWidth=o}}class Jrt{constructor(t,i,e,s){this.isCollapsed=t,this.foldingStartLine=i,this.foldingEndLine=e,this.dimension=s,this.domNode=document.createElement("div"),this.domNode.style.width=`${s}px`,this.domNode.style.height=`${s}px`,this.domNode.className=Kl.asClassName(t?t8:X7)}setVisible(t){this.domNode.style.cursor=t?"pointer":"default",this.domNode.style.opacity=t?"1":"0"}}class Qrt{constructor(t,i){this.startLineNumber=t,this.endLineNumber=i}}class Yrt{constructor(t,i,e){this.range=t,this.children=i,this.parent=e}}class Xrt{constructor(t,i,e,s){this.uri=t,this.version=i,this.element=e,this.outlineProviderId=s}}var tot,iot,eot=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},sot=function(t,i){return function(e,s){i(e,s,t)}};(function(t){t.OUTLINE_MODEL="outlineModel",t.FOLDING_PROVIDER_MODEL="foldingProviderModel",t.INDENTATION_MODEL="indentationModel"})(tot||(tot={})),function(t){t[t.VALID=0]="VALID",t[t.INVALID=1]="INVALID",t[t.CANCELED=2]="CANCELED"}(iot||(iot={}));let not=class extends Qi{constructor(t,i,e,s){switch(super(),this._editor=t,this._languageConfigurationService=e,this._languageFeaturesService=s,this._modelProviders=[],this._modelPromise=null,this._updateScheduler=this._register(new po(300)),this._updateOperation=this._register(new Ji),this._editor.getOption(115).defaultModel){case tot.OUTLINE_MODEL:this._modelProviders.push(new oot(this._editor,s));case tot.FOLDING_PROVIDER_MODEL:this._modelProviders.push(new lot(this._editor,i,s));case tot.INDENTATION_MODEL:this._modelProviders.push(new cot(this._editor,e))}}dispose(){this._modelProviders.forEach((t=>t.dispose())),this._updateOperation.clear(),this._cancelModelPromise(),super.dispose()}_cancelModelPromise(){this._modelPromise&&(this._modelPromise.cancel(),this._modelPromise=null)}async update(t){return this._updateOperation.clear(),this._updateOperation.add({dispose:()=>{this._cancelModelPromise(),this._updateScheduler.cancel()}}),this._cancelModelPromise(),await this._updateScheduler.trigger((async()=>{for(const i of this._modelProviders){const{statusPromise:e,modelPromise:s}=i.computeStickyModel(t);this._modelPromise=s;const n=await e;if(this._modelPromise!==s)return null;switch(n){case iot.CANCELED:return this._updateOperation.clear(),null;case iot.VALID:return i.stickyModel}}return null})).catch((t=>(Ii(t),null)))}};not=eot([sot(2,Il),sot(3,$p)],not);class rot extends Qi{constructor(t){super(),this._editor=t,this._stickyModel=null}get stickyModel(){return this._stickyModel}_invalid(){return this._stickyModel=null,iot.INVALID}computeStickyModel(t){if(t.isCancellationRequested||!this.isProviderValid())return{statusPromise:this._invalid(),modelPromise:null};const i=uo((t=>this.createModelFromProvider(t)));return{statusPromise:i.then((i=>this.isModelValid(i)?t.isCancellationRequested?iot.CANCELED:(this._stickyModel=this.createStickyModel(t,i),iot.VALID):this._invalid())).then(void 0,(t=>(Ii(t),iot.CANCELED))),modelPromise:i}}isModelValid(t){return!0}isProviderValid(){return!0}}let oot=class extends rot{constructor(t,i){super(t),this._languageFeaturesService=i}createModelFromProvider(t){return L8.create(this._languageFeaturesService.documentSymbolProvider,this._editor.getModel(),t)}createStickyModel(t,i){var e;const{stickyOutlineElement:s,providerID:n}=this._stickyModelFromOutlineModel(i,(e=this._stickyModel)===null||e===void 0?void 0:e.outlineProviderId),r=this._editor.getModel();return new Xrt(r.uri,r.getVersionId(),s,n)}isModelValid(t){return t&&t.children.size>0}_stickyModelFromOutlineModel(t,i){let e;if(Wt.first(t.children.values())instanceof M8){const s=Wt.find(t.children.values(),(t=>t.id===i));if(s)e=s.children;else{let s,n="",r=-1;for(const[i,e]of t.children.entries()){const t=this._findSumOfRangesOfGroup(e);t>r&&(s=e,r=t,n=e.id)}i=n,e=s.children}}else e=t.children;const s=[],n=Array.from(e.values()).sort(((t,i)=>{const e=new Qrt(t.symbol.range.startLineNumber,t.symbol.range.endLineNumber),s=new Qrt(i.symbol.range.startLineNumber,i.symbol.range.endLineNumber);return this._comparator(e,s)}));for(const t of n)s.push(this._stickyModelFromOutlineElement(t,t.symbol.selectionRange.startLineNumber));return{stickyOutlineElement:new Yrt(void 0,s,void 0),providerID:i}}_stickyModelFromOutlineElement(t,i){const e=[];for(const s of t.children.values())if(s.symbol.selectionRange.startLineNumber!==s.symbol.range.endLineNumber)if(s.symbol.selectionRange.startLineNumber!==i)e.push(this._stickyModelFromOutlineElement(s,s.symbol.selectionRange.startLineNumber));else for(const t of s.children.values())e.push(this._stickyModelFromOutlineElement(t,s.symbol.selectionRange.startLineNumber));e.sort(((t,i)=>this._comparator(t.range,i.range)));const s=new Qrt(t.symbol.selectionRange.startLineNumber,t.symbol.range.endLineNumber);return new Yrt(s,e,void 0)}_comparator(t,i){return t.startLineNumber!==i.startLineNumber?t.startLineNumber-i.startLineNumber:i.endLineNumber-t.endLineNumber}_findSumOfRangesOfGroup(t){let i=0;for(const e of t.children.values())i+=this._findSumOfRangesOfGroup(e);return t instanceof A8?i+t.symbol.range.endLineNumber-t.symbol.selectionRange.startLineNumber:i}};oot=eot([sot(1,$p)],oot);class hot extends rot{constructor(t){super(t),this._foldingLimitReporter=new p8(t)}createStickyModel(t,i){const e=this._fromFoldingRegions(i),s=this._editor.getModel();return new Xrt(s.uri,s.getVersionId(),e,void 0)}isModelValid(t){return t!==null}_fromFoldingRegions(t){const i=t.length,e=[],s=new Yrt(void 0,[],void 0);for(let n=0;n<i;n++){const i=t.getParentIndex(n);let r;r=i!==-1?e[i]:s;const o=new Yrt(new Qrt(t.getStartLineNumber(n),t.getEndLineNumber(n)+1),[],r);r.children.push(o),e.push(o)}return s}}let cot=class extends hot{constructor(t,i){super(t),this._languageConfigurationService=i,this.provider=this._register(new Z7(t.getModel(),this._languageConfigurationService,this._foldingLimitReporter))}async createModelFromProvider(t){return this.provider.compute(t)}};cot=eot([sot(1,cf)],cot);let lot=class extends hot{constructor(t,i,e){super(t),this._languageFeaturesService=e;const s=g8.getFoldingRangeProviders(this._languageFeaturesService,t.getModel());s.length>0&&(this.provider=this._register(new c8(t.getModel(),s,i,this._foldingLimitReporter,void 0)))}isProviderValid(){return this.provider!==void 0}async createModelFromProvider(t){var i,e;return(e=(i=this.provider)===null||i===void 0?void 0:i.compute(t))!==null&&e!==void 0?e:null}};lot=eot([sot(2,$p)],lot);var aot=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},uot=function(t,i){return function(e,s){i(e,s,t)}};class dot{constructor(t,i,e){this.startLineNumber=t,this.endLineNumber=i,this.nestingDepth=e}}let fot=class extends Qi{constructor(t,i,e){super(),this._languageFeaturesService=i,this._languageConfigurationService=e,this._onDidChangeStickyScroll=this._register(new le),this.onDidChangeStickyScroll=this._onDidChangeStickyScroll.event,this._model=null,this._cts=null,this._stickyModelProvider=null,this._editor=t,this._sessionStore=this._register(new Ji),this._updateSoon=this._register(new Co((()=>this.update()),50)),this._register(this._editor.onDidChangeConfiguration((t=>{t.hasChanged(115)&&this.readConfiguration()}))),this.readConfiguration()}readConfiguration(){this._sessionStore.clear(),this._editor.getOption(115).enabled&&(this._sessionStore.add(this._editor.onDidChangeModel((()=>{this._model=null,this.updateStickyModelProvider(),this._onDidChangeStickyScroll.fire(),this.update()}))),this._sessionStore.add(this._editor.onDidChangeHiddenAreas((()=>this.update()))),this._sessionStore.add(this._editor.onDidChangeModelContent((()=>this._updateSoon.schedule()))),this._sessionStore.add(this._languageFeaturesService.documentSymbolProvider.onDidChange((()=>this.update()))),this._sessionStore.add(Zi((()=>{var t;(t=this._stickyModelProvider)===null||t===void 0||t.dispose(),this._stickyModelProvider=null}))),this.updateStickyModelProvider(),this.update())}getVersionId(){var t;return(t=this._model)===null||t===void 0?void 0:t.version}updateStickyModelProvider(){var t;(t=this._stickyModelProvider)===null||t===void 0||t.dispose(),this._stickyModelProvider=null;const i=this._editor;i.hasModel()&&(this._stickyModelProvider=new not(i,(()=>this._updateSoon.schedule()),this._languageConfigurationService,this._languageFeaturesService))}async update(){var t;(t=this._cts)===null||t===void 0||t.dispose(!0),this._cts=new ye,await this.updateStickyModel(this._cts.token),this._onDidChangeStickyScroll.fire()}async updateStickyModel(t){if(!this._editor.hasModel()||!this._stickyModelProvider||this._editor.getModel().isTooLargeForTokenization())return void(this._model=null);const i=await this._stickyModelProvider.update(t);t.isCancellationRequested||(this._model=i)}updateIndex(t){return t===-1?t=0:t<0&&(t=-t-2),t}getCandidateStickyLinesIntersectingFromStickyModel(t,i,e,s,n){if(i.children.length===0)return;let o=n;const h=[];for(let t=0;t<i.children.length;t++){const e=i.children[t];e.range&&h.push(e.range.startLineNumber)}const c=this.updateIndex(r(h,t.startLineNumber,((t,i)=>t-i))),l=this.updateIndex(r(h,t.startLineNumber+s,((t,i)=>t-i)));for(let r=c;r<=l;r++){const h=i.children[r];if(!h)return;if(h.range){const i=h.range.startLineNumber,n=h.range.endLineNumber;t.startLineNumber<=n+1&&i-1<=t.endLineNumber&&i!==o&&(o=i,e.push(new dot(i,n-1,s+1)),this.getCandidateStickyLinesIntersectingFromStickyModel(t,h,e,s+1,i))}else this.getCandidateStickyLinesIntersectingFromStickyModel(t,h,e,s,n)}}getCandidateStickyLinesIntersecting(t){var i,e;if(!(!((i=this._model)===null||i===void 0)&&i.element))return[];let s=[];this.getCandidateStickyLinesIntersectingFromStickyModel(t,this._model.element,s,0,-1);const n=(e=this._editor._getViewModel())===null||e===void 0?void 0:e.getHiddenAreas();if(n)for(const t of n)s=s.filter((i=>!(i.startLineNumber>=t.startLineNumber&&i.endLineNumber<=t.endLineNumber+1)));return s}};fot=aot([uot(1,$p),uot(2,cf)],fot);var got,pot=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},mot=function(t,i){return function(e,s){i(e,s,t)}};let wot=got=class extends Qi{constructor(t,i,e,s,n,r,o){super(),this._editor=t,this._contextMenuService=i,this._languageFeaturesService=e,this._instaService=s,this._contextKeyService=o,this._sessionStore=new Ji,this._foldingModel=null,this._maxStickyLines=Number.MAX_SAFE_INTEGER,this._candidateDefinitionsLength=-1,this._focusedStickyElementIndex=-1,this._enabled=!1,this._focused=!1,this._positionRevealed=!1,this._onMouseDown=!1,this._endLineNumbers=[],this._showEndForLine=null,this._stickyScrollWidget=new Grt(this._editor),this._stickyLineCandidateProvider=new fot(this._editor,e,n),this._register(this._stickyScrollWidget),this._register(this._stickyLineCandidateProvider),this._widgetState=new Vrt([],[],0),this._onDidResize(),this._readConfiguration();const h=this._stickyScrollWidget.getDomNode();this._register(this._editor.onDidChangeConfiguration((t=>{(t.hasChanged(115)||t.hasChanged(73)||t.hasChanged(67)||t.hasChanged(110))&&this._readConfiguration()}))),this._register(sc(h,qc.CONTEXT_MENU,(async t=>{this._onContextMenu(Uh(h),t)}))),this._stickyScrollFocusedContextKey=Ox.stickyScrollFocused.bindTo(this._contextKeyService),this._stickyScrollVisibleContextKey=Ox.stickyScrollVisible.bindTo(this._contextKeyService);const c=this._register(Qc(h));this._register(c.onDidBlur((t=>{this._positionRevealed===!1&&h.clientHeight===0?(this._focusedStickyElementIndex=-1,this.focus()):this._disposeFocusStickyScrollStore()}))),this._register(c.onDidFocus((t=>{this.focus()}))),this._registerMouseListeners(),this._register(sc(h,qc.MOUSE_DOWN,(t=>{this._onMouseDown=!0})))}static get(t){return t.getContribution(got.ID)}_disposeFocusStickyScrollStore(){var t;this._stickyScrollFocusedContextKey.set(!1),(t=this._focusDisposableStore)===null||t===void 0||t.dispose(),this._focused=!1,this._positionRevealed=!1,this._onMouseDown=!1}focus(){if(this._onMouseDown)return this._onMouseDown=!1,void this._editor.focus();this._stickyScrollFocusedContextKey.get()!==!0&&(this._focused=!0,this._focusDisposableStore=new Ji,this._stickyScrollFocusedContextKey.set(!0),this._focusedStickyElementIndex=this._stickyScrollWidget.lineNumbers.length-1,this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex))}focusNext(){this._focusedStickyElementIndex<this._stickyScrollWidget.lineNumberCount-1&&this._focusNav(!0)}focusPrevious(){this._focusedStickyElementIndex>0&&this._focusNav(!1)}selectEditor(){this._editor.focus()}_focusNav(t){this._focusedStickyElementIndex=t?this._focusedStickyElementIndex+1:this._focusedStickyElementIndex-1,this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex)}goToFocused(){const t=this._stickyScrollWidget.lineNumbers;this._disposeFocusStickyScrollStore(),this._revealPosition({lineNumber:t[this._focusedStickyElementIndex],column:1})}_revealPosition(t){this._reveaInEditor(t,(()=>this._editor.revealPosition(t)))}_revealLineInCenterIfOutsideViewport(t){this._reveaInEditor(t,(()=>this._editor.revealLineInCenterIfOutsideViewport(t.lineNumber,0)))}_reveaInEditor(t,i){this._focused&&this._disposeFocusStickyScrollStore(),this._positionRevealed=!0,i(),this._editor.setSelection(Cs.fromPositions(t)),this._editor.focus()}_registerMouseListeners(){const t=this._register(new Ji),i=this._register(new o4(this._editor,{extractLineNumberFromMouseEvent:t=>{const i=this._stickyScrollWidget.getEditorPositionFromNode(t.target.element);return i?i.lineNumber:0}})),e=t=>{if(!this._editor.hasModel()||t.target.type!==12||t.target.detail!==this._stickyScrollWidget.getId())return null;const i=t.target.element;if(!i||i.innerText!==i.innerHTML)return null;const e=this._stickyScrollWidget.getEditorPositionFromNode(i);return e?{range:new Cs(e.lineNumber,e.column,e.lineNumber,e.column+i.innerText.length),textElement:i}:null},s=this._stickyScrollWidget.getDomNode();this._register(rc(s,qc.CLICK,(t=>{if(t.ctrlKey||t.altKey||t.metaKey||!t.leftButton)return;if(t.shiftKey){const i=this._stickyScrollWidget.getLineIndexFromChildDomNode(t.target);if(i===null)return;const e=new ks(this._endLineNumbers[i],1);return void this._revealLineInCenterIfOutsideViewport(e)}if(this._stickyScrollWidget.isInFoldingIconDomNode(t.target)){const i=this._stickyScrollWidget.getLineNumberFromChildDomNode(t.target);return void this._toggleFoldingRegionForLine(i)}if(!this._stickyScrollWidget.isInStickyLine(t.target))return;let i=this._stickyScrollWidget.getEditorPositionFromNode(t.target);if(!i){const e=this._stickyScrollWidget.getLineNumberFromChildDomNode(t.target);if(e===null)return;i=new ks(e,1)}this._revealPosition(i)}))),this._register(rc(s,qc.MOUSE_MOVE,(t=>{if(t.shiftKey){const i=this._stickyScrollWidget.getLineIndexFromChildDomNode(t.target);return i===null||this._showEndForLine!==null&&this._showEndForLine===i?void 0:(this._showEndForLine=i,void this._renderStickyScroll())}this._showEndForLine!==null&&(this._showEndForLine=null,this._renderStickyScroll())}))),this._register(sc(s,qc.MOUSE_LEAVE,(t=>{this._showEndForLine!==null&&(this._showEndForLine=null,this._renderStickyScroll())}))),this._register(i.onMouseMoveOrRelevantKeyDown((([i,s])=>{const n=e(i);if(!n||!i.hasTriggerModifier||!this._editor.hasModel())return void t.clear();const{range:r,textElement:o}=n;if(r.equalsRange(this._stickyRangeProjectedOnEditor)){if(o.style.textDecoration==="underline")return}else this._stickyRangeProjectedOnEditor=r,t.clear();const h=new ye;let c;t.add(Zi((()=>h.dispose(!0)))),a5(this._languageFeaturesService.definitionProvider,this._editor.getModel(),new ks(r.startLineNumber,r.startColumn+1),h.token).then((i=>{if(!h.token.isCancellationRequested)if(i.length!==0){this._candidateDefinitionsLength=i.length;const e=o;c!==e?(t.clear(),c=e,c.style.textDecoration="underline",t.add(Zi((()=>{c.style.textDecoration="none"})))):c||(c=e,c.style.textDecoration="underline",t.add(Zi((()=>{c.style.textDecoration="none"}))))}else t.clear()}))}))),this._register(i.onCancel((()=>{t.clear()}))),this._register(i.onExecute((async t=>{if(t.target.type!==12||t.target.detail!==this._stickyScrollWidget.getId())return;const i=this._stickyScrollWidget.getEditorPositionFromNode(t.target.element);i&&this._editor.hasModel()&&this._stickyRangeProjectedOnEditor&&(this._candidateDefinitionsLength>1&&(this._focused&&this._disposeFocusStickyScrollStore(),this._revealPosition({lineNumber:i.lineNumber,column:1})),this._instaService.invokeFunction(Uet,t,this._editor,{uri:this._editor.getModel().uri,range:this._stickyRangeProjectedOnEditor}))})))}_onContextMenu(t,i){const e=new ho(t,i);this._contextMenuService.showContextMenu({menuId:Qa.StickyScrollContext,getAnchor:()=>e})}_toggleFoldingRegionForLine(t){if(!this._foldingModel||t===null)return;const i=this._stickyScrollWidget.getRenderedStickyLine(t),e=i==null?void 0:i.foldingIcon;if(!e)return;j7(this._foldingModel,Number.MAX_VALUE,[t]),e.isCollapsed=!e.isCollapsed;const s=(e.isCollapsed?this._editor.getTopForLineNumber(e.foldingEndLine):this._editor.getTopForLineNumber(e.foldingStartLine))-this._editor.getOption(67)*i.index+1;this._editor.setScrollTop(s),this._renderStickyScroll(t)}_readConfiguration(){const t=this._editor.getOption(115);if(t.enabled===!1)return this._editor.removeOverlayWidget(this._stickyScrollWidget),this._sessionStore.clear(),void(this._enabled=!1);t.enabled&&!this._enabled&&(this._editor.addOverlayWidget(this._stickyScrollWidget),this._sessionStore.add(this._editor.onDidScrollChange((t=>{t.scrollTopChanged&&(this._showEndForLine=null,this._renderStickyScroll())}))),this._sessionStore.add(this._editor.onDidLayoutChange((()=>this._onDidResize()))),this._sessionStore.add(this._editor.onDidChangeModelTokens((t=>this._onTokensChange(t)))),this._sessionStore.add(this._stickyLineCandidateProvider.onDidChangeStickyScroll((()=>{this._showEndForLine=null,this._renderStickyScroll()}))),this._enabled=!0),this._editor.getOption(68).renderType===2&&this._sessionStore.add(this._editor.onDidChangeCursorPosition((()=>{this._showEndForLine=null,this._renderStickyScroll(0)})))}_needsUpdate(t){const i=this._stickyScrollWidget.getCurrentLines();for(const e of i)for(const i of t.ranges)if(e>=i.fromLineNumber&&e<=i.toLineNumber)return!0;return!1}_onTokensChange(t){this._needsUpdate(t)&&this._renderStickyScroll(0)}_onDidResize(){const t=this._editor.getLayoutInfo().height/this._editor.getOption(67);this._maxStickyLines=Math.round(.25*t)}async _renderStickyScroll(t){var i,e;const s=this._editor.getModel();if(!s||s.isTooLargeForTokenization())return this._foldingModel=null,void this._stickyScrollWidget.setState(void 0,null);const n=this._stickyLineCandidateProvider.getVersionId();if(n===void 0||n===s.getVersionId())if(this._foldingModel=(e=await((i=g8.get(this._editor))===null||i===void 0?void 0:i.getFoldingModel()))!==null&&e!==void 0?e:null,this._widgetState=this.findScrollWidgetState(),this._stickyScrollVisibleContextKey.set(this._widgetState.startLineNumbers.length!==0),this._focused)if(this._focusedStickyElementIndex===-1)this._stickyScrollWidget.setState(this._widgetState,this._foldingModel,t),this._focusedStickyElementIndex=this._stickyScrollWidget.lineNumberCount-1,this._focusedStickyElementIndex!==-1&&this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);else{const i=this._stickyScrollWidget.lineNumbers[this._focusedStickyElementIndex];this._stickyScrollWidget.setState(this._widgetState,this._foldingModel,t),this._stickyScrollWidget.lineNumberCount===0?this._focusedStickyElementIndex=-1:(this._stickyScrollWidget.lineNumbers.includes(i)||(this._focusedStickyElementIndex=this._stickyScrollWidget.lineNumberCount-1),this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex))}else this._stickyScrollWidget.setState(this._widgetState,this._foldingModel,t)}findScrollWidgetState(){const t=this._editor.getOption(67),i=Math.min(this._maxStickyLines,this._editor.getOption(115).maxLineCount),e=this._editor.getScrollTop();let s=0;const n=[],r=[],o=this._editor.getVisibleRanges();if(o.length!==0){const h=new Qrt(o[0].startLineNumber,o[o.length-1].endLineNumber),c=this._stickyLineCandidateProvider.getCandidateStickyLinesIntersecting(h);for(const o of c){const h=o.startLineNumber,c=o.endLineNumber,l=o.nestingDepth;if(c-h>0){const o=(l-1)*t,a=l*t,u=this._editor.getBottomForLineNumber(h)-e,d=this._editor.getTopForLineNumber(c)-e,f=this._editor.getBottomForLineNumber(c)-e;if(o>d&&o<=f){n.push(h),r.push(c+1),s=f-a;break}if(a>u&&a<=f&&(n.push(h),r.push(c+1)),n.length===i)break}}}return this._endLineNumbers=r,new Vrt(n,r,s,this._showEndForLine)}dispose(){super.dispose(),this._sessionStore.dispose()}};wot.ID="store.contrib.stickyScrollController",wot=got=pot([mot(1,oI),mot(2,$p),mot(3,Il),mot(4,cf),mot(5,lO),mot(6,Ra)],wot);const vot=100;Su(wot.ID,wot,1),nu(class extends su{constructor(){super({id:"editor.action.toggleStickyScroll",title:{...it(0,"Toggle Editor Sticky Scroll"),mnemonicTitle:tt(0,"&&Toggle Editor Sticky Scroll")},category:Hrt.View,toggled:{condition:ua.equals("config.editor.stickyScroll.enabled",!0),title:tt(0,"Sticky Scroll"),mnemonicTitle:tt(0,"&&Sticky Scroll")},menu:[{id:Qa.CommandPalette},{id:Qa.MenubarAppearanceMenu,group:"4_editor",order:3},{id:Qa.StickyScrollContext}]})}async run(t){const i=t.get(Md),e=!i.getValue("editor.stickyScroll.enabled");return i.updateValue("editor.stickyScroll.enabled",e)}}),nu(class extends vu{constructor(){super({id:"editor.action.focusStickyScroll",title:{...it(0,"Focus Sticky Scroll"),mnemonicTitle:tt(0,"&&Focus Sticky Scroll")},precondition:ua.and(ua.has("config.editor.stickyScroll.enabled"),Ox.stickyScrollVisible),menu:[{id:Qa.CommandPalette}]})}runEditorCommand(t,i){var e;(e=wot.get(i))===null||e===void 0||e.focus()}}),nu(class extends vu{constructor(){super({id:"editor.action.selectPreviousStickyScrollLine",title:it(0,"Select previous sticky scroll line"),precondition:Ox.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:vot,primary:16}})}runEditorCommand(t,i){var e;(e=wot.get(i))===null||e===void 0||e.focusPrevious()}}),nu(class extends vu{constructor(){super({id:"editor.action.selectNextStickyScrollLine",title:it(0,"Select next sticky scroll line"),precondition:Ox.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:vot,primary:18}})}runEditorCommand(t,i){var e;(e=wot.get(i))===null||e===void 0||e.focusNext()}}),nu(class extends vu{constructor(){super({id:"editor.action.goToFocusedStickyScrollLine",title:it(0,"Go to focused sticky scroll line"),precondition:Ox.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:vot,primary:3}})}runEditorCommand(t,i){var e;(e=wot.get(i))===null||e===void 0||e.goToFocused()}}),nu(class extends vu{constructor(){super({id:"editor.action.selectEditor",title:it(0,"Select Editor"),precondition:Ox.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:vot,primary:9}})}runEditorCommand(t,i){var e;(e=wot.get(i))===null||e===void 0||e.selectEditor()}});var bot=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},yot=function(t,i){return function(e,s){i(e,s,t)}};class kot{constructor(t,i,e,s,n,r){this.range=t,this.insertText=i,this.filterText=e,this.additionalTextEdits=s,this.command=n,this.completion=r}}let Cot=class extends Xi{constructor(t,i,e,s,n,r){super(n.disposable),this.model=t,this.line=i,this.word=e,this.completionModel=s,this._suggestMemoryService=r}canBeReused(t,i,e){return this.model===t&&this.line===i&&this.word.word.length>0&&this.word.startColumn===e.startColumn&&this.word.endColumn<e.endColumn&&this.completionModel.getIncompleteProvider().size===0}get items(){var t;const i=[],{items:e}=this.completionModel,s=this._suggestMemoryService.select(this.model,{lineNumber:this.line,column:this.word.endColumn+this.completionModel.lineContext.characterCountDelta},e),n=Wt.slice(e,s),r=Wt.slice(e,0,s);let o=5;for(const e of Wt.concat(n,r)){if(e.score===p_.Default)continue;const s=new Cs(e.editStart.lineNumber,e.editStart.column,e.editInsertEnd.lineNumber,e.editInsertEnd.column+this.completionModel.lineContext.characterCountDelta),n=e.completion.insertTextRules&&4&e.completion.insertTextRules?{snippet:e.completion.insertText}:e.completion.insertText;i.push(new kot(s,n,(t=e.filterTextLow)!==null&&t!==void 0?t:e.labelLow,e.completion.additionalTextEdits,e.completion.command,e)),o-- >=0&&e.resolve(ve.None)}return i}};Cot=bot([yot(5,nit)],Cot);let Sot=class extends Qi{constructor(t,i,e,s){super(),this._languageFeatureService=t,this._clipboardService=i,this._suggestMemoryService=e,this._editorService=s,this._store.add(t.inlineCompletionsProvider.register("*",this))}async provideInlineCompletions(t,i,e,s){var n;if(e.selectedSuggestionInfo)return;let r;for(const i of this._editorService.listCodeEditors())if(i.getModel()===t){r=i;break}if(!r)return;const o=r.getOption(89);if(Ctt.isAllOff(o))return;t.tokenization.tokenizeIfCheap(i.lineNumber);const h=t.tokenization.getLineTokens(i.lineNumber),c=h.getStandardTokenType(h.findTokenIndexAtOffset(Math.max(i.column-1-1,0)));if(Ctt.valueFor(o,c)!=="inline")return;let l,a,u=t.getWordAtPosition(i);if(u!=null&&u.word||(l=this._getTriggerCharacterInfo(t,i)),!(u!=null&&u.word)&&!l||(u||(u=t.getWordUntilPosition(i)),u.endColumn!==i.column))return;const d=t.getValueInRange(new Cs(i.lineNumber,1,i.lineNumber,i.column));if(!l&&(!((n=this._lastResult)===null||n===void 0)&&n.canBeReused(t,i.lineNumber,u))){const t=new mit(d,i.column-this._lastResult.word.endColumn);this._lastResult.completionModel.lineContext=t,this._lastResult.acquire(),a=this._lastResult}else{const e=await btt(this._languageFeatureService.completionProvider,t,i,new wtt(void 0,Cit.createSuggestFilter(r).itemKind,l==null?void 0:l.providers),l&&{triggerKind:1,triggerCharacter:l.ch},s);let n;e.needsClipboard&&(n=await this._clipboardService.readText());const o=new wit(e.items,i.column,new mit(d,0),pit.None,r.getOption(118),r.getOption(112),{boostFullMatch:!1,firstMatchCanBeWeak:!1},n);a=new Cot(t,i.lineNumber,u,o,e,this._suggestMemoryService)}return this._lastResult=a,a}handleItemDidShow(t,i){i.completion.resolve(ve.None)}freeInlineCompletions(t){t.release()}_getTriggerCharacterInfo(t,i){var e;const s=t.getValueInRange(Cs.fromPositions({lineNumber:i.lineNumber,column:i.column-1},i)),n=new Set;for(const i of this._languageFeatureService.completionProvider.all(t))!((e=i.triggerCharacters)===null||e===void 0)&&e.includes(s)&&n.add(i);if(n.size!==0)return{providers:n,ch:s}}};Sot=bot([yot(0,$p),yot(1,AK),yot(2,nit),yot(3,Pl)],Sot),sq(Sot);ku(class extends mu{constructor(){super({id:"editor.action.forceRetokenize",label:tt(0,"Developer: Force Retokenize"),alias:"Developer: Force Retokenize",precondition:void 0})}run(t,i){if(!i.hasModel())return;const e=i.getModel();e.tokenization.resetTokenization();const s=new se;e.tokenization.forceTokenization(e.getLineCount()),s.stop(),console.log(`tokenization took ${s.elapsed()}`)}});class xot extends su{constructor(){super({id:xot.ID,title:it(0,"Toggle Tab Key Moves Focus"),precondition:void 0,keybinding:{primary:2091,mac:{primary:1323},weight:100},f1:!0})}run(){const t=!ww.getTabFocusMode();ww.setTabFocusMode(t),rw(tt(0,t?"Pressing Tab will now move focus to the next focusable element":"Pressing Tab will now insert the tab character"))}}xot.ID="editor.action.toggleTabFocusMode",nu(xot);var Dot=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Eot=function(t,i){return function(e,s){i(e,s,t)}};let Aot=class extends Qi{get enabled(){return this._enabled}set enabled(t){t?(this.el.setAttribute("aria-disabled","false"),this.el.tabIndex=0,this.el.style.pointerEvents="auto",this.el.style.opacity="1",this.el.style.cursor="pointer",this._enabled=!1):(this.el.setAttribute("aria-disabled","true"),this.el.tabIndex=-1,this.el.style.pointerEvents="none",this.el.style.opacity="0.4",this.el.style.cursor="default",this._enabled=!0),this._enabled=t}constructor(t,i,e={},s){var n,r;super(),this._link=i,this._enabled=!0,this.el=Yc(t,nl("a.monaco-link",{tabIndex:(n=i.tabIndex)!==null&&n!==void 0?n:0,href:i.href},i.label)),this.hoverDelegate=(r=e.hoverDelegate)!==null&&r!==void 0?r:rB("mouse"),this.setTooltip(i.title),this.el.setAttribute("role","button");const o=this._register(new uC(this.el,"click")),h=this._register(new uC(this.el,"keypress")),c=ne.chain(h.event,(t=>t.map((t=>new so(t))).filter((t=>t.keyCode===3)))),l=this._register(new uC(this.el,Bk.Tap)).event;this._register(Wk.addTarget(this.el));const a=ne.any(o.event,c,l);this._register(a((t=>{this.enabled&&(Zc(t,!0),e!=null&&e.opener?e.opener(this._link.href):s.open(this._link.href,{allowCommands:!0}))}))),this.enabled=!0}setTooltip(t){this.hoverDelegate.showNativeHover?this.el.title=t??"":!this.hover&&t?this.hover=this._register(lB(this.hoverDelegate,this.el,t)):this.hover&&this.hover.update(t)}};Aot=Dot([Eot(3,uI)],Aot);var Mot=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Lot=function(t,i){return function(e,s){i(e,s,t)}};let Fot=class extends Qi{constructor(t,i){super(),this._editor=t,this.instantiationService=i,this.banner=this._register(this.instantiationService.createInstance(Tot))}hide(){this._editor.setBanner(null,0),this.banner.clear()}show(t){this.banner.show({...t,onClose:()=>{var i;this.hide(),(i=t.onClose)===null||i===void 0||i.call(t)}}),this._editor.setBanner(this.banner.element,26)}};Fot=Mot([Lot(1,Il)],Fot);let Tot=class extends Qi{constructor(t){super(),this.instantiationService=t,this.markdownRenderer=this.instantiationService.createInstance(fP,{}),this.element=nl("div.editor-banner"),this.element.tabIndex=0}getAriaLabel(t){return t.ariaLabel?t.ariaLabel:typeof t.message=="string"?t.message:void 0}getBannerMessage(t){if(typeof t=="string"){const i=nl("span");return i.innerText=t,i}return this.markdownRenderer.render(t).element}clear(){ic(this.element)}show(t){ic(this.element);const i=this.getAriaLabel(t);i&&this.element.setAttribute("aria-label",i);const e=Yc(this.element,nl("div.icon-container"));e.setAttribute("aria-hidden","true"),t.icon&&e.appendChild(nl(`div${Kl.asCSSSelector(t.icon)}`));const s=Yc(this.element,nl("div.message-container"));if(s.setAttribute("aria-hidden","true"),s.appendChild(this.getBannerMessage(t.message)),this.messageActionsContainer=Yc(this.element,nl("div.message-actions-container")),t.actions)for(const i of t.actions)this._register(this.instantiationService.createInstance(Aot,this.messageActionsContainer,{...i,tabIndex:-1},{}));const n=Yc(this.element,nl("div.action-container"));this.actionBar=this._register(new LW(n)),this.actionBar.push(this._register(new $l("banner.close","Close Banner",Kl.asClassName(YU),!0,(()=>{typeof t.onClose=="function"&&t.onClose()}))),{icon:!0,label:!1}),this.actionBar.setFocusable(!1)}};Tot=Mot([Lot(0,Il)],Tot);var Rot=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Oot=function(t,i){return function(e,s){i(e,s,t)}};const Iot=qU("extensions-warning-message",As.warning,tt(0,"Icon shown with a warning message in the extensions editor."));let _ot=class extends Qi{constructor(t,i,e,s){super(),this._editor=t,this._editorWorkerService=i,this._workspaceTrustService=e,this._highlighter=null,this._bannerClosed=!1,this._updateState=t=>{if(t&&t.hasMore){if(this._bannerClosed)return;const i=Math.max(t.ambiguousCharacterCount,t.nonBasicAsciiCharacterCount,t.invisibleCharacterCount);let e;if(t.nonBasicAsciiCharacterCount>=i)e={message:tt(0,"This document contains many non-basic ASCII unicode characters"),command:new Got};else if(t.ambiguousCharacterCount>=i)e={message:tt(0,"This document contains many ambiguous unicode characters"),command:new Kot};else{if(!(t.invisibleCharacterCount>=i))throw new Error("Unreachable");e={message:tt(0,"This document contains many invisible unicode characters"),command:new qot}}this._bannerController.show({id:"unicodeHighlightBanner",message:e.message,icon:Iot,actions:[{label:e.command.shortLabel,href:`command:${e.command.id}`}],onClose:()=>{this._bannerClosed=!0}})}else this._bannerController.hide()},this._bannerController=this._register(s.createInstance(Fot,t)),this._register(this._editor.onDidChangeModel((()=>{this._bannerClosed=!1,this._updateHighlighter()}))),this._options=t.getOption(125),this._register(e.onDidChangeTrust((t=>{this._updateHighlighter()}))),this._register(t.onDidChangeConfiguration((i=>{i.hasChanged(125)&&(this._options=t.getOption(125),this._updateHighlighter())}))),this._updateHighlighter()}dispose(){this._highlighter&&(this._highlighter.dispose(),this._highlighter=null),super.dispose()}_updateHighlighter(){if(this._updateState(null),this._highlighter&&(this._highlighter.dispose(),this._highlighter=null),!this._editor.hasModel())return;const t=function(t,i){return{nonBasicASCII:i.nonBasicASCII===yi?!t:i.nonBasicASCII,ambiguousCharacters:i.ambiguousCharacters,invisibleCharacters:i.invisibleCharacters,includeComments:i.includeComments===yi?!t:i.includeComments,includeStrings:i.includeStrings===yi?!t:i.includeStrings,allowedCharacters:i.allowedCharacters,allowedLocales:i.allowedLocales}}(this._workspaceTrustService.isWorkspaceTrusted(),this._options);if([t.nonBasicASCII,t.ambiguousCharacters,t.invisibleCharacters].every((t=>t===!1)))return;const i={nonBasicASCII:t.nonBasicASCII,ambiguousCharacters:t.ambiguousCharacters,invisibleCharacters:t.invisibleCharacters,includeComments:t.includeComments,includeStrings:t.includeStrings,allowedCodePoints:Object.keys(t.allowedCharacters).map((t=>t.codePointAt(0))),allowedLocales:Object.keys(t.allowedLocales).map((t=>t==="_os"?(new Intl.NumberFormat).resolvedOptions().locale:t==="_vscode"?At:t))};this._editorWorkerService.canComputeUnicodeHighlights(this._editor.getModel().uri)?this._highlighter=new Pot(this._editor,i,this._updateState,this._editorWorkerService):this._highlighter=new Not(this._editor,i,this._updateState)}getDecorationInfo(t){return this._highlighter?this._highlighter.getDecorationInfo(t):null}};_ot.ID="editor.contrib.unicodeHighlighter",_ot=Rot([Oot(1,JW),Oot(2,HN),Oot(3,Il)],_ot);let Pot=class extends Qi{constructor(t,i,e,s){super(),this._editor=t,this._options=i,this._updateState=e,this._editorWorkerService=s,this._model=this._editor.getModel(),this._decorations=this._editor.createDecorationsCollection(),this._updateSoon=this._register(new Co((()=>this._update()),250)),this._register(this._editor.onDidChangeModelContent((()=>{this._updateSoon.schedule()}))),this._updateSoon.schedule()}dispose(){this._decorations.clear(),super.dispose()}_update(){if(this._model.isDisposed())return;if(!this._model.mightContainNonBasicASCII())return void this._decorations.clear();const t=this._model.getVersionId();this._editorWorkerService.computedUnicodeHighlights(this._model.uri,this._options).then((i=>{if(this._model.isDisposed()||this._model.getVersionId()!==t)return;this._updateState(i);const e=[];if(!i.hasMore)for(const t of i.ranges)e.push({range:t,options:Vot.instance.getDecorationFromOptions(this._options)});this._decorations.set(e)}))}getDecorationInfo(t){if(!this._decorations.has(t))return null;const i=this._editor.getModel();return $T(i,t)?{reason:Hot(i.getValueInRange(t.range),this._options),inComment:WT(i,t),inString:jT(i,t)}:null}};Pot=Rot([Oot(3,JW)],Pot);class Not extends Qi{constructor(t,i,e){super(),this._editor=t,this._options=i,this._updateState=e,this._model=this._editor.getModel(),this._decorations=this._editor.createDecorationsCollection(),this._updateSoon=this._register(new Co((()=>this._update()),250)),this._register(this._editor.onDidLayoutChange((()=>{this._updateSoon.schedule()}))),this._register(this._editor.onDidScrollChange((()=>{this._updateSoon.schedule()}))),this._register(this._editor.onDidChangeHiddenAreas((()=>{this._updateSoon.schedule()}))),this._register(this._editor.onDidChangeModelContent((()=>{this._updateSoon.schedule()}))),this._updateSoon.schedule()}dispose(){this._decorations.clear(),super.dispose()}_update(){if(this._model.isDisposed())return;if(!this._model.mightContainNonBasicASCII())return void this._decorations.clear();const t=this._editor.getVisibleRanges(),i=[],e={ranges:[],ambiguousCharacterCount:0,invisibleCharacterCount:0,nonBasicAsciiCharacterCount:0,hasMore:!1};for(const i of t){const t=fg.computeUnicodeHighlights(this._model,this._options,i);for(const i of t.ranges)e.ranges.push(i);e.ambiguousCharacterCount+=e.ambiguousCharacterCount,e.invisibleCharacterCount+=e.invisibleCharacterCount,e.nonBasicAsciiCharacterCount+=e.nonBasicAsciiCharacterCount,e.hasMore=e.hasMore||t.hasMore}if(!e.hasMore)for(const t of e.ranges)i.push({range:t,options:Vot.instance.getDecorationFromOptions(this._options)});this._updateState(e),this._decorations.set(i)}getDecorationInfo(t){if(!this._decorations.has(t))return null;const i=this._editor.getModel(),e=i.getValueInRange(t.range);return $T(i,t)?{reason:Hot(e,this._options),inComment:WT(i,t),inString:jT(i,t)}:null}}const Bot=tt(0,"Configure Unicode Highlight Options");let $ot=class{constructor(t,i,e){this._editor=t,this._languageService=i,this._openerService=e,this.hoverOrdinal=5}computeSync(t,i){if(!this._editor.hasModel()||t.type!==1)return[];const e=this._editor.getModel(),s=this._editor.getContribution(_ot.ID);if(!s)return[];const n=[],r=new Set;let o=300;for(const t of i){const i=s.getDecorationInfo(t);if(!i)continue;const h=e.getValueInRange(t.range).codePointAt(0),c=jot(h);let l;switch(i.reason.kind){case 0:l=Dr(i.reason.confusableWith)?tt(0,"The character {0} could be confused with the ASCII character {1}, which is more common in source code.",c,jot(i.reason.confusableWith.codePointAt(0))):tt(0,"The character {0} could be confused with the character {1}, which is more common in source code.",c,jot(i.reason.confusableWith.codePointAt(0)));break;case 1:l=tt(0,"The character {0} is invisible.",c);break;case 2:l=tt(0,"The character {0} is not a basic ASCII character.",c)}if(r.has(l))continue;r.add(l);const a={codePoint:h,reason:i.reason,inComment:i.inComment,inString:i.inString},u=tt(0,"Adjust settings"),d=`command:${Zot.ID}?${encodeURIComponent(JSON.stringify(a))}`,f=new F_("",!0).appendMarkdown(l).appendText(" ").appendLink(d,u,Bot);n.push(new a3(this,t.range,[f],!1,o++))}return n}renderHoverParts(t,i){return d3(t,i,this._editor,this._languageService,this._openerService)}};function Wot(t){return`U+${t.toString(16).padStart(4,"0")}`}function jot(t){let i=`\`${Wot(t)}\``;return Br.isInvisibleCharacter(t)||(i+=` "${function(t){return t===96?"`` ` ``":"`"+String.fromCodePoint(t)+"`"}(t)}"`),i}function Hot(t,i){return fg.computeUnicodeHighlightReason(t,i)}$ot=Rot([Oot(1,Id),Oot(2,uI)],$ot);class Vot{constructor(){this.map=new Map}getDecorationFromOptions(t){return this.getDecoration(!t.includeComments,!t.includeStrings)}getDecoration(t,i){const e=`${t}${i}`;let s=this.map.get(e);return s||(s=xF.createDynamic({description:"unicode-highlight",stickiness:1,className:"unicode-highlight",showIfCollapsed:!0,overviewRuler:null,minimap:null,hideInCommentTokens:t,hideInStringTokens:i}),this.map.set(e,s)),s}}Vot.instance=new Vot;class zot extends mu{constructor(){super({id:Kot.ID,label:tt(0,"Disable highlighting of characters in comments"),alias:"Disable highlighting of characters in comments",precondition:void 0}),this.shortLabel=tt(0,"Disable Highlight In Comments")}async run(t,i,e){const s=t==null?void 0:t.get(Md);s&&this.runAction(s)}async runAction(t){await t.updateValue(Di,!1,2)}}class Uot extends mu{constructor(){super({id:Kot.ID,label:tt(0,"Disable highlighting of characters in strings"),alias:"Disable highlighting of characters in strings",precondition:void 0}),this.shortLabel=tt(0,"Disable Highlight In Strings")}async run(t,i,e){const s=t==null?void 0:t.get(Md);s&&this.runAction(s)}async runAction(t){await t.updateValue(Ei,!1,2)}}class Kot extends mu{constructor(){super({id:Kot.ID,label:tt(0,"Disable highlighting of ambiguous characters"),alias:"Disable highlighting of ambiguous characters",precondition:void 0}),this.shortLabel=tt(0,"Disable Ambiguous Highlight")}async run(t,i,e){const s=t==null?void 0:t.get(Md);s&&this.runAction(s)}async runAction(t){await t.updateValue(xi,!1,2)}}Kot.ID="editor.action.unicodeHighlight.disableHighlightingOfAmbiguousCharacters";class qot extends mu{constructor(){super({id:qot.ID,label:tt(0,"Disable highlighting of invisible characters"),alias:"Disable highlighting of invisible characters",precondition:void 0}),this.shortLabel=tt(0,"Disable Invisible Highlight")}async run(t,i,e){const s=t==null?void 0:t.get(Md);s&&this.runAction(s)}async runAction(t){await t.updateValue(Ci,!1,2)}}qot.ID="editor.action.unicodeHighlight.disableHighlightingOfInvisibleCharacters";class Got extends mu{constructor(){super({id:Got.ID,label:tt(0,"Disable highlighting of non basic ASCII characters"),alias:"Disable highlighting of non basic ASCII characters",precondition:void 0}),this.shortLabel=tt(0,"Disable Non ASCII Highlight")}async run(t,i,e){const s=t==null?void 0:t.get(Md);s&&this.runAction(s)}async runAction(t){await t.updateValue(Si,!1,2)}}Got.ID="editor.action.unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters";class Zot extends mu{constructor(){super({id:Zot.ID,label:tt(0,"Show Exclude Options"),alias:"Show Exclude Options",precondition:void 0})}async run(t,i,e){const{codePoint:s,reason:n,inString:r,inComment:o}=e,h=String.fromCodePoint(s),c=t.get(vj),l=t.get(Md),a=[];if(n.kind===0)for(const t of n.notAmbiguousInLocales)a.push({label:tt(0,'Allow unicode characters that are more common in the language "{0}".',t),run:async()=>{Jot(l,[t])}});if(a.push({label:function(t){return Br.isInvisibleCharacter(t)?tt(0,"Exclude {0} (invisible character) from being highlighted",Wot(t)):tt(0,"Exclude {0} from being highlighted",`${Wot(t)} "${h}"`)}(s),run:()=>async function(t,i){const e=t.getValue(ki);let s;s=typeof e=="object"&&e?e:{};for(const t of i)s[String.fromCodePoint(t)]=!0;await t.updateValue(ki,s,2)}(l,[s])}),o){const t=new zot;a.push({label:t.label,run:async()=>t.runAction(l)})}else if(r){const t=new Uot;a.push({label:t.label,run:async()=>t.runAction(l)})}if(n.kind===0){const t=new Kot;a.push({label:t.label,run:async()=>t.runAction(l)})}else if(n.kind===1){const t=new qot;a.push({label:t.label,run:async()=>t.runAction(l)})}else if(n.kind===2){const t=new Got;a.push({label:t.label,run:async()=>t.runAction(l)})}else(function(t){throw new Error(`Unexpected value: ${t}`)})(n);const u=await c.pick(a,{title:Bot});u&&await u.run()}}async function Jot(t,i){var e;const s=(e=t.inspect(Ai).user)===null||e===void 0?void 0:e.value;let n;n=typeof s=="object"&&s?Object.assign({},s):{};for(const t of i)n[t]=!0;await t.updateValue(Ai,n,2)}Zot.ID="editor.action.unicodeHighlight.showExcludeOptions",ku(Kot),ku(qot),ku(Got),ku(Zot),Su(_ot.ID,_ot,1),W5.register($ot);var Qot=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Yot=function(t,i){return function(e,s){i(e,s,t)}};const Xot="ignoreUnusualLineTerminators";let tht=class extends Qi{constructor(t,i,e){super(),this._editor=t,this._dialogService=i,this._codeEditorService=e,this._isPresentingDialog=!1,this._config=this._editor.getOption(126),this._register(this._editor.onDidChangeConfiguration((t=>{t.hasChanged(126)&&(this._config=this._editor.getOption(126),this._checkForUnusualLineTerminators())}))),this._register(this._editor.onDidChangeModel((()=>{this._checkForUnusualLineTerminators()}))),this._register(this._editor.onDidChangeModelContent((t=>{t.isUndoing||this._checkForUnusualLineTerminators()}))),this._checkForUnusualLineTerminators()}async _checkForUnusualLineTerminators(){if(this._config==="off"||!this._editor.hasModel())return;const t=this._editor.getModel();if(!t.mightContainUnusualLineTerminators()||function(t,i){return t.getModelProperty(i.uri,Xot)}(this._codeEditorService,t)===!0||this._editor.getOption(91))return;if(this._config==="auto")return void t.removeUnusualLineTerminators(this._editor.getSelections());if(this._isPresentingDialog)return;let i;try{this._isPresentingDialog=!0,i=await this._dialogService.confirm({title:tt(0,"Unusual Line Terminators"),message:tt(0,"Detected unusual line terminators"),detail:tt(0,"The file '{0}' contains one or more unusual line terminator characters, like Line Separator (LS) or Paragraph Separator (PS).\n\nIt is recommended to remove them from the file. This can be configured via `editor.unusualLineTerminators`.",SM(t.uri)),primaryButton:tt(0,"&&Remove Unusual Line Terminators"),cancelButton:tt(0,"Ignore")})}finally{this._isPresentingDialog=!1}i.confirmed?t.removeUnusualLineTerminators(this._editor.getSelections()):function(t,i,e){t.setModelProperty(i.uri,Xot,e)}(this._codeEditorService,t,!0)}};tht.ID="editor.contrib.unusualLineTerminatorsDetector",tht=Qot([Yot(1,VR),Yot(2,Pl)],tht),Su(tht.ID,tht,1);var iht,eht,sht=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},nht=function(t,i){return function(e,s){i(e,s,t)}};const rht=new Ta("hasWordHighlights",!1);function oht(t,i,e,s){return bo(t.ordered(i).map((t=>()=>Promise.resolve(t.provideDocumentHighlights(i,e,s)).then(void 0,_i))),f).then((t=>{if(t){const e=new zf;return e.set(i.uri,t),e}return new zf}))}class hht{constructor(t,i,e){this._model=t,this._selection=i,this._wordSeparators=e,this._wordRange=this._getCurrentWordRange(t,i),this._result=null}get result(){return this._result||(this._result=uo((t=>this._compute(this._model,this._selection,this._wordSeparators,t)))),this._result}_getCurrentWordRange(t,i){const e=t.getWordAtPosition(i.getPosition());return e?new Cs(i.startLineNumber,e.startColumn,i.startLineNumber,e.endColumn):null}isValid(t,i,e){const s=i.startLineNumber,n=i.startColumn,r=i.endColumn,o=this._getCurrentWordRange(t,i);let h=!!(this._wordRange&&this._wordRange.equalsRange(o));for(let t=0,i=e.length;!h&&t<i;t++){const i=e.getRange(t);i&&i.startLineNumber===s&&i.startColumn<=n&&i.endColumn>=r&&(h=!0)}return h}cancel(){this.result.cancel()}}class cht extends hht{constructor(t,i,e,s){super(t,i,e),this._providers=s}_compute(t,i,e,s){return oht(this._providers,t,i.getPosition(),s).then((t=>t||new zf))}}class lht extends hht{constructor(t,i,e,s,n){super(t,i,e),this._providers=s,this._otherModels=n}_compute(t,i,e,s){return function(t,i,e,s,n,r){return bo(t.ordered(i).map((t=>()=>{const s=r.filter((t=>og(t))).filter((i=>JO(t.selector,i.uri,i.getLanguageId(),!0,void 0,void 0)>0));return Promise.resolve(t.provideMultiDocumentHighlights(i,e,s,n)).then(void 0,_i)})),(t=>t instanceof zf&&t.size>0))}(this._providers,t,i.getPosition(),0,s,this._otherModels).then((t=>t||new zf))}}class aht extends hht{constructor(t,i,e,s,n){super(t,i,s),this._otherModels=n,this._selectionIsEmpty=i.isEmpty(),this._word=e}_compute(t,i,e,s){return wo(250,s).then((()=>{const s=new zf;let n;if(n=this._word?this._word:t.getWordAtPosition(i.getPosition()),!n)return new zf;const r=[t,...this._otherModels];for(const t of r){if(t.isDisposed())continue;const i=t.findMatches(n.word,!0,!1,!0,e,!1).map((t=>({range:t.range,kind:Ps.Text})));i&&s.set(t.uri,i)}return s}))}isValid(t,i,e){const s=i.isEmpty();return this._selectionIsEmpty===s&&super.isValid(t,i,e)}}bu("_executeDocumentHighlights",(async(t,i,e)=>{const s=t.get($p),n=await oht(s.documentHighlightProvider,i,e,ve.None);return n==null?void 0:n.get(i.uri)}));let uht=iht=class{constructor(t,i,e,s,n){this.toUnhook=new Ji,this.workerRequestTokenId=0,this.workerRequestCompleted=!1,this.workerRequestValue=new zf,this.lastCursorPositionChangeTime=0,this.renderDecorationsTimer=-1,this.editor=t,this.providers=i,this.multiDocumentProviders=e,this.codeEditorService=n,this._hasWordHighlights=rht.bindTo(s),this._ignorePositionChangeEvent=!1,this.occurrencesHighlight=this.editor.getOption(81),this.model=this.editor.getModel(),this.toUnhook.add(t.onDidChangeCursorPosition((t=>{this._ignorePositionChangeEvent||this.occurrencesHighlight!=="off"&&this._onPositionChanged(t)}))),this.toUnhook.add(t.onDidFocusEditorText((t=>{this.occurrencesHighlight!=="off"&&(this.workerRequest||this._run())}))),this.toUnhook.add(t.onDidChangeModelContent((t=>{this._stopAll()}))),this.toUnhook.add(t.onDidChangeModel((t=>{!t.newModelUrl&&t.oldModelUrl?this._stopSingular():iht.query&&this._run()}))),this.toUnhook.add(t.onDidChangeConfiguration((t=>{const i=this.editor.getOption(81);this.occurrencesHighlight!==i&&(this.occurrencesHighlight=i,this._stopAll())}))),this.decorations=this.editor.createDecorationsCollection(),this.workerRequestTokenId=0,this.workerRequest=null,this.workerRequestCompleted=!1,this.lastCursorPositionChangeTime=0,this.renderDecorationsTimer=-1,iht.query&&this._run()}hasDecorations(){return this.decorations.length>0}restore(){this.occurrencesHighlight!=="off"&&this._run()}_getSortedHighlights(){return this.decorations.getRanges().sort(Cs.compareRangesUsingStarts)}moveNext(){const t=this._getSortedHighlights(),i=t.findIndex((t=>t.containsPosition(this.editor.getPosition()))),e=(i+1)%t.length,s=t[e];try{this._ignorePositionChangeEvent=!0,this.editor.setPosition(s.getStartPosition()),this.editor.revealRangeInCenterIfOutsideViewport(s);const i=this._getWord();i&&rw(`${this.editor.getModel().getLineContent(s.startLineNumber)}, ${e+1} of ${t.length} for '${i.word}'`)}finally{this._ignorePositionChangeEvent=!1}}moveBack(){const t=this._getSortedHighlights(),i=t.findIndex((t=>t.containsPosition(this.editor.getPosition()))),e=(i-1+t.length)%t.length,s=t[e];try{this._ignorePositionChangeEvent=!0,this.editor.setPosition(s.getStartPosition()),this.editor.revealRangeInCenterIfOutsideViewport(s);const i=this._getWord();i&&rw(`${this.editor.getModel().getLineContent(s.startLineNumber)}, ${e+1} of ${t.length} for '${i.word}'`)}finally{this._ignorePositionChangeEvent=!1}}_removeSingleDecorations(){if(!this.editor.hasModel())return;const t=iht.storedDecorations.get(this.editor.getModel().uri);t&&(this.editor.removeDecorations(t),iht.storedDecorations.delete(this.editor.getModel().uri),this.decorations.length>0&&(this.decorations.clear(),this._hasWordHighlights.set(!1)))}_removeAllDecorations(){const t=this.codeEditorService.listCodeEditors(),i=[];for(const e of t){if(!e.hasModel())continue;const t=iht.storedDecorations.get(e.getModel().uri);if(!t)continue;e.removeDecorations(t),i.push(e.getModel().uri);const s=dht.get(e);s!=null&&s.wordHighlighter&&s.wordHighlighter.decorations.length>0&&(s.wordHighlighter.decorations.clear(),s.wordHighlighter.workerRequest=null,s.wordHighlighter._hasWordHighlights.set(!1))}for(const t of i)iht.storedDecorations.delete(t)}_stopSingular(){var t,i,e,s;this._removeSingleDecorations(),this.editor.hasTextFocus()&&(((t=this.editor.getModel())===null||t===void 0?void 0:t.uri.scheme)!==Lh.vscodeNotebookCell&&((e=(i=iht.query)===null||i===void 0?void 0:i.modelInfo)===null||e===void 0?void 0:e.model.uri.scheme)!==Lh.vscodeNotebookCell?(iht.query=null,this._run()):!((s=iht.query)===null||s===void 0)&&s.modelInfo&&(iht.query.modelInfo=null)),this.renderDecorationsTimer!==-1&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1),this.workerRequest!==null&&(this.workerRequest.cancel(),this.workerRequest=null),this.workerRequestCompleted||(this.workerRequestTokenId++,this.workerRequestCompleted=!0)}_stopAll(){this._removeAllDecorations(),this.renderDecorationsTimer!==-1&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1),this.workerRequest!==null&&(this.workerRequest.cancel(),this.workerRequest=null),this.workerRequestCompleted||(this.workerRequestTokenId++,this.workerRequestCompleted=!0)}_onPositionChanged(t){var i;this.occurrencesHighlight!=="off"&&(t.reason===3||((i=this.editor.getModel())===null||i===void 0?void 0:i.uri.scheme)===Lh.vscodeNotebookCell)?this._run():this._stopAll()}_getWord(){const t=this.editor.getSelection(),i=t.startLineNumber,e=t.startColumn;return this.model.isDisposed()?null:this.model.getWordAtPosition({lineNumber:i,column:e})}getOtherModelsToHighlight(t){if(!t)return[];if(t.uri.scheme===Lh.vscodeNotebookCell){const i=[],e=this.codeEditorService.listCodeEditors();for(const s of e){const e=s.getModel();e&&e!==t&&e.uri.scheme===Lh.vscodeNotebookCell&&i.push(e)}return i}const i=[],e=this.codeEditorService.listCodeEditors();for(const s of e){if(!BQ(s))continue;const e=s.getModel();e&&t===e.modified&&i.push(e.modified)}if(i.length)return i;if(this.occurrencesHighlight==="singleFile")return[];for(const s of e){const e=s.getModel();e&&e!==t&&i.push(e)}return i}_run(){var t;let i;if(this.editor.hasTextFocus()){const t=this.editor.getSelection();if(!t||t.startLineNumber!==t.endLineNumber)return iht.query=null,void this._stopAll();const e=t.startColumn,s=t.endColumn,n=this._getWord();if(!n||n.startColumn>e||n.endColumn<s)return iht.query=null,void this._stopAll();i=this.workerRequest&&this.workerRequest.isValid(this.model,t,this.decorations),iht.query={modelInfo:{model:this.model,selection:t},word:n}}else if(!iht.query)return;if(this.lastCursorPositionChangeTime=(new Date).getTime(),i)this.workerRequestCompleted&&this.renderDecorationsTimer!==-1&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1,this._beginRenderDecorations());else{this._stopAll();const i=++this.workerRequestTokenId;this.workerRequestCompleted=!1;const e=this.getOtherModelsToHighlight(this.editor.getModel());if(!iht.query.modelInfo||iht.query.modelInfo.model.isDisposed())return;this.workerRequest=this.computeWithModel(iht.query.modelInfo.model,iht.query.modelInfo.selection,iht.query.word,e),(t=this.workerRequest)===null||t===void 0||t.result.then((t=>{i===this.workerRequestTokenId&&(this.workerRequestCompleted=!0,this.workerRequestValue=t||[],this._beginRenderDecorations())}),Ii)}}computeWithModel(t,i,e,s){return s.length?function(t,i,e,s,n,r){return t.has(i)?new lht(i,e,n,t,r):new aht(i,e,s,n,r)}(this.multiDocumentProviders,t,i,e,this.editor.getOption(131),s):function(t,i,e,s,n){return t.has(i)?new cht(i,e,n,t):new aht(i,e,s,n,[])}(this.providers,t,i,e,this.editor.getOption(131))}_beginRenderDecorations(){const t=(new Date).getTime(),i=this.lastCursorPositionChangeTime+250;t>=i?(this.renderDecorationsTimer=-1,this.renderDecorations()):this.renderDecorationsTimer=setTimeout((()=>{this.renderDecorations()}),i-t)}renderDecorations(){var t,i,e;this.renderDecorationsTimer=-1;const s=this.codeEditorService.listCodeEditors();for(const r of s){const s=dht.get(r);if(!s)continue;const o=[],h=(t=r.getModel())===null||t===void 0?void 0:t.uri;if(h&&this.workerRequestValue.has(h)){const t=iht.storedDecorations.get(h),c=this.workerRequestValue.get(h);if(c)for(const t of c)t.range&&o.push({range:t.range,options:(n=t.kind,n===Ps.Write?Qst:n===Ps.Text?Yst:int)});let l=[];r.changeDecorations((i=>{l=i.deltaDecorations(t??[],o)})),iht.storedDecorations=iht.storedDecorations.set(h,l),o.length>0&&((i=s.wordHighlighter)===null||i===void 0||i.decorations.set(o),(e=s.wordHighlighter)===null||e===void 0||e._hasWordHighlights.set(!0))}}var n}dispose(){this._stopSingular(),this.toUnhook.dispose()}};uht.storedDecorations=new zf,uht.query=null,uht=iht=sht([nht(4,Pl)],uht);let dht=eht=class extends Qi{static get(t){return t.getContribution(eht.ID)}constructor(t,i,e,s){super(),this._wordHighlighter=null;const n=()=>{t.hasModel()&&!t.getModel().isTooLargeForTokenization()&&(this._wordHighlighter=new uht(t,e.documentHighlightProvider,e.multiDocumentHighlightProvider,i,s))};this._register(t.onDidChangeModel((t=>{this._wordHighlighter&&(this._wordHighlighter.dispose(),this._wordHighlighter=null),n()}))),n()}get wordHighlighter(){return this._wordHighlighter}saveViewState(){return!(!this._wordHighlighter||!this._wordHighlighter.hasDecorations())}moveNext(){var t;(t=this._wordHighlighter)===null||t===void 0||t.moveNext()}moveBack(){var t;(t=this._wordHighlighter)===null||t===void 0||t.moveBack()}restoreViewState(t){this._wordHighlighter&&t&&this._wordHighlighter.restore()}dispose(){this._wordHighlighter&&(this._wordHighlighter.dispose(),this._wordHighlighter=null),super.dispose()}};dht.ID="editor.contrib.wordHighlighter",dht=eht=sht([nht(1,Ra),nht(2,$p),nht(3,Pl)],dht);class fht extends mu{constructor(t,i){super(i),this._isNext=t}run(t,i){const e=dht.get(i);e&&(this._isNext?e.moveNext():e.moveBack())}}Su(dht.ID,dht,0),ku(class extends fht{constructor(){super(!0,{id:"editor.action.wordHighlight.next",label:tt(0,"Go to Next Symbol Highlight"),alias:"Go to Next Symbol Highlight",precondition:rht,kbOpts:{kbExpr:Ox.editorTextFocus,primary:65,weight:100}})}}),ku(class extends fht{constructor(){super(!1,{id:"editor.action.wordHighlight.prev",label:tt(0,"Go to Previous Symbol Highlight"),alias:"Go to Previous Symbol Highlight",precondition:rht,kbOpts:{kbExpr:Ox.editorTextFocus,primary:1089,weight:100}})}}),ku(class extends mu{constructor(){super({id:"editor.action.wordHighlight.trigger",label:tt(0,"Trigger Symbol Highlight"),alias:"Trigger Symbol Highlight",precondition:rht.toNegated(),kbOpts:{kbExpr:Ox.editorTextFocus,primary:0,weight:100}})}run(t,i,e){const s=dht.get(i);s&&s.restoreViewState(!0)}});class ght extends pu{constructor(t){super(t),this._inSelectionMode=t.inSelectionMode,this._wordNavigationType=t.wordNavigationType}runEditorCommand(t,i,e){if(!i.hasModel())return;const s=Qf(i.getOption(131),i.getOption(130)),n=i.getModel(),r=i.getSelections().map((t=>{const i=new ks(t.positionLineNumber,t.positionColumn),e=this._move(s,n,i,this._wordNavigationType);return this._moveTo(t,e,this._inSelectionMode)}));if(n.pushStackElement(),i._getViewModel().setCursorStates("moveWordCommand",3,r.map((t=>GS.fromModelSelection(t)))),r.length===1){const t=new ks(r[0].positionLineNumber,r[0].positionColumn);i.revealPosition(t,0)}}_moveTo(t,i,e){return e?new Ss(t.selectionStartLineNumber,t.selectionStartColumn,i.lineNumber,i.column):new Ss(i.lineNumber,i.column,i.lineNumber,i.column)}}class pht extends ght{_move(t,i,e,s){return lx.moveWordLeft(t,i,e,s)}}class mht extends ght{_move(t,i,e,s){return lx.moveWordRight(t,i,e,s)}}class wht extends pu{constructor(t){super(t),this._whitespaceHeuristics=t.whitespaceHeuristics,this._wordNavigationType=t.wordNavigationType}runEditorCommand(t,i,e){const s=t.get(cf);if(!i.hasModel())return;const n=Qf(i.getOption(131),i.getOption(130)),r=i.getModel(),o=i.getSelections(),h=i.getOption(6),c=i.getOption(11),l=s.getLanguageConfiguration(r.getLanguageId()).getAutoClosingPairs(),a=i._getViewModel(),u=o.map((t=>{const e=this._delete({wordSeparators:n,model:r,selection:t,whitespaceHeuristics:this._whitespaceHeuristics,autoClosingDelete:i.getOption(9),autoClosingBrackets:h,autoClosingQuotes:c,autoClosingPairs:l,autoClosedCharacters:a.getCursorAutoClosedCharacters()},this._wordNavigationType);return new ix(e,"")}));i.pushUndoStop(),i.executeCommands(this.id,u),i.pushUndoStop()}}class vht extends wht{_delete(t,i){return lx.deleteWordLeft(t,i)||new Cs(1,1,1,1)}}class bht extends wht{_delete(t,i){const e=lx.deleteWordRight(t,i);if(e)return e;const s=t.model.getLineCount(),n=t.model.getLineMaxColumn(s);return new Cs(s,n,s,n)}}yu(new class extends pht{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordStartLeft",precondition:void 0})}}),yu(new class extends pht{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordEndLeft",precondition:void 0})}}),yu(new class extends pht{constructor(){var t;super({inSelectionMode:!1,wordNavigationType:1,id:"cursorWordLeft",precondition:void 0,kbOpts:{kbExpr:ua.and(Ox.textInputFocus,(t=ua.and(bw,CV))===null||t===void 0?void 0:t.negate()),primary:2063,mac:{primary:527},weight:100}})}}),yu(new class extends pht{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordStartLeftSelect",precondition:void 0})}}),yu(new class extends pht{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordEndLeftSelect",precondition:void 0})}}),yu(new class extends pht{constructor(){var t;super({inSelectionMode:!0,wordNavigationType:1,id:"cursorWordLeftSelect",precondition:void 0,kbOpts:{kbExpr:ua.and(Ox.textInputFocus,(t=ua.and(bw,CV))===null||t===void 0?void 0:t.negate()),primary:3087,mac:{primary:1551},weight:100}})}}),yu(new class extends mht{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordStartRight",precondition:void 0})}}),yu(new class extends mht{constructor(){var t;super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordEndRight",precondition:void 0,kbOpts:{kbExpr:ua.and(Ox.textInputFocus,(t=ua.and(bw,CV))===null||t===void 0?void 0:t.negate()),primary:2065,mac:{primary:529},weight:100}})}}),yu(new class extends mht{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordRight",precondition:void 0})}}),yu(new class extends mht{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordStartRightSelect",precondition:void 0})}}),yu(new class extends mht{constructor(){var t;super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordEndRightSelect",precondition:void 0,kbOpts:{kbExpr:ua.and(Ox.textInputFocus,(t=ua.and(bw,CV))===null||t===void 0?void 0:t.negate()),primary:3089,mac:{primary:1553},weight:100}})}}),yu(new class extends mht{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordRightSelect",precondition:void 0})}}),yu(new class extends pht{constructor(){super({inSelectionMode:!1,wordNavigationType:3,id:"cursorWordAccessibilityLeft",precondition:void 0})}_move(t,i,e,s){return super._move(Qf(Ri.wordSeparators.defaultValue,t.intlSegmenterLocales),i,e,s)}}),yu(new class extends pht{constructor(){super({inSelectionMode:!0,wordNavigationType:3,id:"cursorWordAccessibilityLeftSelect",precondition:void 0})}_move(t,i,e,s){return super._move(Qf(Ri.wordSeparators.defaultValue,t.intlSegmenterLocales),i,e,s)}}),yu(new class extends mht{constructor(){super({inSelectionMode:!1,wordNavigationType:3,id:"cursorWordAccessibilityRight",precondition:void 0})}_move(t,i,e,s){return super._move(Qf(Ri.wordSeparators.defaultValue,t.intlSegmenterLocales),i,e,s)}}),yu(new class extends mht{constructor(){super({inSelectionMode:!0,wordNavigationType:3,id:"cursorWordAccessibilityRightSelect",precondition:void 0})}_move(t,i,e,s){return super._move(Qf(Ri.wordSeparators.defaultValue,t.intlSegmenterLocales),i,e,s)}}),yu(new class extends vht{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:"deleteWordStartLeft",precondition:Ox.writable})}}),yu(new class extends vht{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:2,id:"deleteWordEndLeft",precondition:Ox.writable})}}),yu(new class extends vht{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:0,id:"deleteWordLeft",precondition:Ox.writable,kbOpts:{kbExpr:Ox.textInputFocus,primary:2049,mac:{primary:513},weight:100}})}}),yu(new class extends bht{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:"deleteWordStartRight",precondition:Ox.writable})}}),yu(new class extends bht{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:2,id:"deleteWordEndRight",precondition:Ox.writable})}}),yu(new class extends bht{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:2,id:"deleteWordRight",precondition:Ox.writable,kbOpts:{kbExpr:Ox.textInputFocus,primary:2068,mac:{primary:532},weight:100}})}}),ku(class extends mu{constructor(){super({id:"deleteInsideWord",precondition:Ox.writable,label:tt(0,"Delete Word"),alias:"Delete Word"})}run(t,i,e){if(!i.hasModel())return;const s=Qf(i.getOption(131),i.getOption(130)),n=i.getModel(),r=i.getSelections().map((t=>{const i=lx.deleteInsideWord(s,n,t);return new ix(i,"")}));i.pushUndoStop(),i.executeCommands(this.id,r),i.pushUndoStop()}});class yht extends ght{_move(t,i,e,s){return ax.moveWordPartLeft(t,i,e)}}Gl.registerCommandAlias("cursorWordPartStartLeft","cursorWordPartLeft");Gl.registerCommandAlias("cursorWordPartStartLeftSelect","cursorWordPartLeftSelect");class kht extends ght{_move(t,i,e,s){return ax.moveWordPartRight(t,i,e)}}yu(new class extends wht{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:0,id:"deleteWordPartLeft",precondition:Ox.writable,kbOpts:{kbExpr:Ox.textInputFocus,primary:0,mac:{primary:769},weight:100}})}_delete(t,i){return ax.deleteWordPartLeft(t)||new Cs(1,1,1,1)}}),yu(new class extends wht{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:2,id:"deleteWordPartRight",precondition:Ox.writable,kbOpts:{kbExpr:Ox.textInputFocus,primary:0,mac:{primary:788},weight:100}})}_delete(t,i){const e=ax.deleteWordPartRight(t);if(e)return e;const s=t.model.getLineCount(),n=t.model.getLineMaxColumn(s);return new Cs(s,n,s,n)}}),yu(new class extends yht{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordPartLeft",precondition:void 0,kbOpts:{kbExpr:Ox.textInputFocus,primary:0,mac:{primary:783},weight:100}})}}),yu(new class extends yht{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordPartLeftSelect",precondition:void 0,kbOpts:{kbExpr:Ox.textInputFocus,primary:0,mac:{primary:1807},weight:100}})}}),yu(new class extends kht{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordPartRight",precondition:void 0,kbOpts:{kbExpr:Ox.textInputFocus,primary:0,mac:{primary:785},weight:100}})}}),yu(new class extends kht{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordPartRightSelect",precondition:void 0,kbOpts:{kbExpr:Ox.textInputFocus,primary:0,mac:{primary:1809},weight:100}})}});class Cht extends Qi{constructor(t){super(),this.editor=t,this._register(this.editor.onDidAttemptReadOnlyEdit((()=>this._onDidAttemptReadOnlyEdit())))}_onDidAttemptReadOnlyEdit(){const t=A0.get(this.editor);if(t&&this.editor.hasModel()){let i=this.editor.getOptions().get(92);i||(i=this.editor.isSimpleWidget?new F_(tt(0,"Cannot edit in read-only input")):new F_(tt(0,"Cannot edit in read-only editor"))),t.showMessage(i,this.editor.getPosition())}}}Cht.ID="editor.contrib.readOnlyMessageController",Su(Cht.ID,Cht,2);var Sht=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},xht=function(t,i){return function(e,s){i(e,s,t)}};let Dht=class extends Qi{constructor(t,i,e){super(),this._textModel=t,this._languageFeaturesService=i,this._outlineModelService=e,this._currentModel=$B(this,void 0);const s=n$("documentSymbolProvider.onDidChange",this._languageFeaturesService.documentSymbolProvider.onDidChange),n=n$("_textModel.onDidChangeContent",ne.debounce((t=>this._textModel.onDidChangeContent(t)),(()=>{}),100));this._register(YB((async(t,i)=>{s.read(t),n.read(t);const e=i.add(new Bq),r=await this._outlineModelService.getOrCreate(this._textModel,e.token);i.isDisposed||this._currentModel.set(r,void 0)})))}getBreadcrumbItems(t,i){const e=this._currentModel.read(i);if(!e)return[];const s=e.asListOfDocumentSymbols().filter((i=>t.contains(i.range.startLineNumber)&&!t.contains(i.range.endLineNumber)));return s.sort(M(D((t=>t.range.endLineNumber-t.range.startLineNumber),E))),s.map((t=>({name:t.name,kind:t.kind,startLineNumber:t.range.startLineNumber})))}};Dht=Sht([xht(1,$p),xht(2,F8)],Dht),KG.setBreadcrumbsSourceFactory(((t,i)=>i.createInstance(Dht,t)));class Eht extends Qi{constructor(t){super(),this.editor=t,this.widget=null,xt&&(this._register(t.onDidChangeConfiguration((()=>this.update()))),this.update())}update(){const t=!this.editor.getOption(91);!this.widget&&t?this.widget=new Aht(this.editor):this.widget&&!t&&(this.widget.dispose(),this.widget=null)}dispose(){super.dispose(),this.widget&&(this.widget.dispose(),this.widget=null)}}Eht.ID="editor.contrib.iPadShowKeyboard";class Aht extends Qi{constructor(t){super(),this.editor=t,this._domNode=document.createElement("textarea"),this._domNode.className="iPadShowKeyboard",this._register(sc(this._domNode,"touchstart",(t=>{this.editor.focus()}))),this._register(sc(this._domNode,"focus",(t=>{this.editor.focus()}))),this.editor.addOverlayWidget(this)}dispose(){this.editor.removeOverlayWidget(this),super.dispose()}getId(){return Aht.ID}getDomNode(){return this._domNode}getPosition(){return{preference:1}}}Aht.ID="editor.contrib.ShowKeyboardWidget",Su(Eht.ID,Eht,3);var Mht,Lht=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Fht=function(t,i){return function(e,s){i(e,s,t)}};let Tht=Mht=class extends Qi{static get(t){return t.getContribution(Mht.ID)}constructor(t,i,e){super(),this._editor=t,this._languageService=e,this._widget=null,this._register(this._editor.onDidChangeModel((t=>this.stop()))),this._register(this._editor.onDidChangeModelLanguage((t=>this.stop()))),this._register(Us.onDidChange((t=>this.stop()))),this._register(this._editor.onKeyUp((t=>t.keyCode===9&&this.stop())))}dispose(){this.stop(),super.dispose()}launch(){this._widget||this._editor.hasModel()&&(this._widget=new Rht(this._editor,this._languageService))}stop(){this._widget&&(this._widget.dispose(),this._widget=null)}};Tht.ID="editor.contrib.inspectTokens",Tht=Mht=Lht([Fht(1,aK),Fht(2,Id)],Tht);class Rht extends Qi{constructor(t,i){super(),this.allowEditorOverflow=!0,this._editor=t,this._languageService=i,this._model=this._editor.getModel(),this._domNode=document.createElement("div"),this._domNode.className="tokens-inspect-widget",this._tokenizationSupport=function(t,i){const e=Us.get(i);if(e)return e;const s=t.encodeLanguageId(i);return{getInitialState:()=>Xp,tokenize:(t,e,s)=>tm(i,s),tokenizeEncoded:(t,i,e)=>im(s,e)}}(this._languageService.languageIdCodec,this._model.getLanguageId()),this._compute(this._editor.getPosition()),this._register(this._editor.onDidChangeCursorPosition((t=>this._compute(this._editor.getPosition())))),this._editor.addContentWidget(this)}dispose(){this._editor.removeContentWidget(this),super.dispose()}getId(){return Rht._ID}_compute(t){const i=this._getTokensAtLine(t.lineNumber);let e=0;for(let s=i.tokens1.length-1;s>=0;s--){const n=i.tokens1[s];if(t.column-1>=n.offset){e=s;break}}let s=0;for(let e=i.tokens2.length>>>1;e>=0;e--)if(t.column-1>=i.tokens2[e<<1]){s=e;break}const n=this._model.getLineContent(t.lineNumber);let r="";if(e<i.tokens1.length){const t=i.tokens1[e].offset,s=e+1<i.tokens1.length?i.tokens1[e+1].offset:n.length;r=n.substring(t,s)}tl(this._domNode,nl("h2.tm-token",void 0,function(t){let i="";for(let e=0,s=t.length;e<s;e++){const s=t.charCodeAt(e);switch(s){case 9:i+="→";break;case 32:i+="·";break;default:i+=String.fromCharCode(s)}}return i}(r),nl("span.tm-token-length",void 0,`${r.length} ${r.length===1?"char":"chars"}`))),Yc(this._domNode,nl("hr.tokens-inspect-separator",{style:"clear:both"}));const o=1+(s<<1)<i.tokens2.length?this._decodeMetadata(i.tokens2[1+(s<<1)]):null;Yc(this._domNode,nl("table.tm-metadata-table",void 0,nl("tbody",void 0,nl("tr",void 0,nl("td.tm-metadata-key",void 0,"language"),nl("td.tm-metadata-value",void 0,`${o?o.languageId:"-?-"}`)),nl("tr",void 0,nl("td.tm-metadata-key",void 0,"token type"),nl("td.tm-metadata-value",void 0,`${o?this._tokenTypeToString(o.tokenType):"-?-"}`)),nl("tr",void 0,nl("td.tm-metadata-key",void 0,"font style"),nl("td.tm-metadata-value",void 0,`${o?this._fontStyleToString(o.fontStyle):"-?-"}`)),nl("tr",void 0,nl("td.tm-metadata-key",void 0,"foreground"),nl("td.tm-metadata-value",void 0,`${o?kp.Format.CSS.formatHex(o.foreground):"-?-"}`)),nl("tr",void 0,nl("td.tm-metadata-key",void 0,"background"),nl("td.tm-metadata-value",void 0,`${o?kp.Format.CSS.formatHex(o.background):"-?-"}`))))),Yc(this._domNode,nl("hr.tokens-inspect-separator")),e<i.tokens1.length&&Yc(this._domNode,nl("span.tm-token-type",void 0,i.tokens1[e].type)),this._editor.layoutContentWidget(this)}_decodeMetadata(t){const i=Us.getColorMap(),e=em.getLanguageId(t),s=em.getTokenType(t),n=em.getFontStyle(t),r=em.getForeground(t),o=em.getBackground(t);return{languageId:this._languageService.languageIdCodec.decodeLanguageId(e),tokenType:s,fontStyle:n,foreground:i[r],background:i[o]}}_tokenTypeToString(t){switch(t){case 0:return"Other";case 1:return"Comment";case 2:return"String";case 3:return"RegEx";default:return"??"}}_fontStyleToString(t){let i="";return 1&t&&(i+="italic "),2&t&&(i+="bold "),4&t&&(i+="underline "),8&t&&(i+="strikethrough "),i.length===0&&(i="---"),i}_getTokensAtLine(t){const i=this._getStateBeforeLine(t),e=this._tokenizationSupport.tokenize(this._model.getLineContent(t),!0,i),s=this._tokenizationSupport.tokenizeEncoded(this._model.getLineContent(t),!0,i);return{startState:i,tokens1:e.tokens,tokens2:s.tokens,endState:e.endState}}_getStateBeforeLine(t){let i=this._tokenizationSupport.getInitialState();for(let e=1;e<t;e++)i=this._tokenizationSupport.tokenize(this._model.getLineContent(e),!0,i).endState;return i}getDomNode(){return this._domNode}getPosition(){return{position:this._editor.getPosition(),preference:[2,1]}}}Rht._ID="editor.contrib.inspectTokensWidget",Su(Tht.ID,Tht,4),ku(class extends mu{constructor(){super({id:"editor.action.inspectTokens",label:IN.inspectTokensAction,alias:"Developer: Inspect Tokens",precondition:void 0})}run(t,i){const e=Tht.get(i);e==null||e.launch()}});var Oht,Iht=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},_ht=function(t,i){return function(e,s){i(e,s,t)}};let Pht=Oht=class{constructor(t,i){this.quickInputService=t,this.keybindingService=i,this.registry=Va.as(gj)}provide(t){const i=new Ji;return i.add(t.onDidAccept((()=>{const[i]=t.selectedItems;i&&this.quickInputService.quickAccess.show(i.prefix,{preserveValue:!0})}))),i.add(t.onDidChangeValue((t=>{const i=this.registry.getQuickAccessProvider(t.substr(Oht.PREFIX.length));i&&i.prefix&&i.prefix!==Oht.PREFIX&&this.quickInputService.quickAccess.show(i.prefix,{preserveValue:!0})}))),t.items=this.getQuickAccessProviders().filter((t=>t.prefix!==Oht.PREFIX)),i}getQuickAccessProviders(){return this.registry.getQuickAccessProviders().sort(((t,i)=>t.prefix.localeCompare(i.prefix))).flatMap((t=>this.createPicks(t)))}createPicks(t){return t.helpEntries.map((i=>{const e=i.prefix||t.prefix,s=e||"…";return{prefix:e,label:s,keybinding:i.commandId?this.keybindingService.lookupKeybinding(i.commandId):void 0,ariaLabel:tt(0,"{0}, {1}",s,i.description),description:i.description}}))}};Pht.PREFIX="?",Pht=Oht=Iht([_ht(0,vj),_ht(1,NS)],Pht),Va.as(gj).registerQuickAccessProvider({ctor:Pht,prefix:"",helpEntries:[{description:PN.helpQuickAccessActionLabel}]});class Nht{constructor(t){this.options=t,this.rangeHighlightDecorationId=void 0}provide(t,i){var e;const s=new Ji;t.canAcceptInBackground=!!(!((e=this.options)===null||e===void 0)&&e.canAcceptInBackground),t.matchOnLabel=t.matchOnDescription=t.matchOnDetail=t.sortByLabel=!1;const n=s.add(new Yi);return n.value=this.doProvide(t,i),s.add(this.onDidActiveTextEditorControlChange((()=>{n.value=void 0,n.value=this.doProvide(t,i)}))),s}doProvide(t,i){var e;const s=new Ji,n=this.activeTextEditorControl;if(n&&this.canProvideWithTextEditor(n)){const r={editor:n},o=$Q(n);if(o){let t=(e=n.saveViewState())!==null&&e!==void 0?e:void 0;s.add(o.onDidChangeCursorPosition((()=>{var i;t=(i=n.saveViewState())!==null&&i!==void 0?i:void 0}))),r.restoreViewState=()=>{t&&n===this.activeTextEditorControl&&n.restoreViewState(t)},s.add(Ui(i.onCancellationRequested)((()=>{var t;return(t=r.restoreViewState)===null||t===void 0?void 0:t.call(r)})))}s.add(Zi((()=>this.clearDecorations(n)))),s.add(this.provideWithTextEditor(r,t,i))}else s.add(this.provideWithoutTextEditor(t,i));return s}canProvideWithTextEditor(t){return!0}gotoLocation({editor:t},i){t.setSelection(i.range,"code.jump"),t.revealRangeInCenter(i.range,0),i.preserveFocus||t.focus();const e=t.getModel();e&&"getLineContent"in e&&ow(`${e.getLineContent(i.range.startLineNumber)}`)}getModel(t){var i;return BQ(t)?(i=t.getModel())===null||i===void 0?void 0:i.modified:t.getModel()}addDecorations(t,i){t.changeDecorations((t=>{const e=[];this.rangeHighlightDecorationId&&(e.push(this.rangeHighlightDecorationId.overviewRulerDecorationId),e.push(this.rangeHighlightDecorationId.rangeHighlightId),this.rangeHighlightDecorationId=void 0);const s=[{range:i,options:{description:"quick-access-range-highlight",className:"rangeHighlight",isWholeLine:!0}},{range:i,options:{description:"quick-access-range-highlight-overview",overviewRuler:{color:MC(aS),position:Yf.Full}}}],[n,r]=t.deltaDecorations(e,s);this.rangeHighlightDecorationId={rangeHighlightId:n,overviewRulerDecorationId:r}}))}clearDecorations(t){const i=this.rangeHighlightDecorationId;i&&(t.changeDecorations((t=>{t.deltaDecorations([i.overviewRulerDecorationId,i.rangeHighlightId],[])})),this.rangeHighlightDecorationId=void 0)}}class Bht extends Nht{constructor(){super({canAcceptInBackground:!0})}provideWithoutTextEditor(t){const i=tt(0,"Open a text editor first to go to a line.");return t.items=[{label:i}],t.ariaLabel=i,Qi.None}provideWithTextEditor(t,i,e){const s=t.editor,n=new Ji;n.add(i.onDidAccept((e=>{const[n]=i.selectedItems;if(n){if(!this.isValidLineNumber(s,n.lineNumber))return;this.gotoLocation(t,{range:this.toRange(n.lineNumber,n.column),keyMods:i.keyMods,preserveFocus:e.inBackground}),e.inBackground||i.hide()}})));const r=()=>{const t=this.parsePosition(s,i.value.trim().substr(Bht.PREFIX.length)),e=this.getPickLabel(s,t.lineNumber,t.column);if(i.items=[{lineNumber:t.lineNumber,column:t.column,label:e}],i.ariaLabel=e,!this.isValidLineNumber(s,t.lineNumber))return void this.clearDecorations(s);const n=this.toRange(t.lineNumber,t.column);s.revealRangeInCenter(n,0),this.addDecorations(s,n)};r(),n.add(i.onDidChangeValue((()=>r())));const o=$Q(s);return o&&o.getOptions().get(68).renderType===2&&(o.updateOptions({lineNumbers:"on"}),n.add(Zi((()=>o.updateOptions({lineNumbers:"relative"}))))),n}toRange(t=1,i=1){return{startLineNumber:t,startColumn:i,endLineNumber:t,endColumn:i}}parsePosition(t,i){const e=i.split(/,|:|#/).map((t=>parseInt(t,10))).filter((t=>!isNaN(t))),s=this.lineCount(t)+1;return{lineNumber:e[0]>0?e[0]:s+e[0],column:e[1]}}getPickLabel(t,i,e){if(this.isValidLineNumber(t,i))return this.isValidColumn(t,i,e)?tt(0,"Go to line {0} and character {1}.",i,e):tt(0,"Go to line {0}.",i);const s=t.getPosition()||{lineNumber:1,column:1},n=this.lineCount(t);return n>1?tt(0,"Current Line: {0}, Character: {1}. Type a line number between 1 and {2} to navigate to.",s.lineNumber,s.column,n):tt(0,"Current Line: {0}, Character: {1}. Type a line number to navigate to.",s.lineNumber,s.column)}isValidLineNumber(t,i){return!(!i||typeof i!="number")&&i>0&&i<=this.lineCount(t)}isValidColumn(t,i,e){if(!e||typeof e!="number")return!1;const s=this.getModel(t);if(!s)return!1;const n={lineNumber:i,column:e};return s.validatePosition(n).equals(n)}lineCount(t){var i,e;return(e=(i=this.getModel(t))===null||i===void 0?void 0:i.getLineCount())!==null&&e!==void 0?e:0}}Bht.PREFIX=":";var $ht=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Wht=function(t,i){return function(e,s){i(e,s,t)}};let jht=class extends Bht{constructor(t){super(),this.editorService=t,this.onDidActiveTextEditorControlChange=ne.None}get activeTextEditorControl(){var t;return(t=this.editorService.getFocusedCodeEditor())!==null&&t!==void 0?t:void 0}};jht=$ht([Wht(0,Pl)],jht);let Hht=class t extends mu{constructor(){super({id:t.ID,label:_N.gotoLineActionLabel,alias:"Go to Line/Column...",precondition:void 0,kbOpts:{kbExpr:Ox.focus,primary:2085,mac:{primary:293},weight:100}})}run(t){t.get(vj).quickAccess.show(jht.PREFIX)}};Hht.ID="editor.action.gotoLine",ku(Hht),Va.as(gj).registerQuickAccessProvider({ctor:jht,prefix:jht.PREFIX,helpEntries:[{description:_N.gotoLineActionLabel,commandId:Hht.ID}]});const Vht=[void 0,[]];function zht(t,i,e=0,s=0){const n=i;return n.values&&n.values.length>1?function(t,i,e,s){let n=0;const r=[];for(const o of i){const[i,h]=Uht(t,o,e,s);if(typeof i!="number")return Vht;n+=i,r.push(...h)}return[n,Kht(r)]}(t,n.values,e,s):Uht(t,i,e,s)}function Uht(t,i,e,s){const n=w_(i.original,i.originalLowercase,e,t,t.toLowerCase(),s,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return n?[n[0],s_(n)]:Vht}function Kht(t){const i=t.sort(((t,i)=>t.start-i.start)),e=[];let s;for(const t of i)s&&qht(s,t)?(s.start=Math.min(s.start,t.start),s.end=Math.max(s.end,t.end)):(s=t,e.push(t));return e}function qht(t,i){return!(t.end<i.start)&&!(i.end<t.start)}function Ght(t){return t.startsWith('"')&&t.endsWith('"')}const Zht=" ";function Jht(t){typeof t!="string"&&(t="");const i=t.toLowerCase(),{pathNormalized:e,normalized:s,normalizedLowercase:n}=Qht(t),r=e.indexOf(ss)>=0,o=Ght(t);let h;const c=t.split(Zht);if(c.length>1)for(const t of c){const i=Ght(t),{pathNormalized:e,normalized:s,normalizedLowercase:n}=Qht(t);s&&(h||(h=[]),h.push({original:t,originalLowercase:t.toLowerCase(),pathNormalized:e,normalized:s,normalizedLowercase:n,expectContiguousMatch:i}))}return{original:t,originalLowercase:i,pathNormalized:e,normalized:s,normalizedLowercase:n,values:h,containsPathSeparator:r,expectContiguousMatch:o}}function Qht(t){let i;i=vt?t.replace(/\//g,ss):t.replace(/\\/g,ss);const e=(s=i,s.replace(/\*/g,"")).replace(/\s|"/g,"");var s;return{pathNormalized:i,normalized:e,normalizedLowercase:e.toLowerCase()}}function Yht(t){return Array.isArray(t)?Jht(t.map((t=>t.original)).join(Zht)):Jht(t.original)}var Xht,tct=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},ict=function(t,i){return function(e,s){i(e,s,t)}};let ect=Xht=class extends Nht{constructor(t,i,e=Object.create(null)){super(e),this._languageFeaturesService=t,this._outlineModelService=i,this.options=e,this.options.canAcceptInBackground=!0}provideWithoutTextEditor(t){return this.provideLabelPick(t,tt(0,"To go to a symbol, first open a text editor with symbol information.")),Qi.None}provideWithTextEditor(t,i,e){const s=t.editor,n=this.getModel(s);return n?this._languageFeaturesService.documentSymbolProvider.has(n)?this.doProvideWithEditorSymbols(t,n,i,e):this.doProvideWithoutEditorSymbols(t,n,i,e):Qi.None}doProvideWithoutEditorSymbols(t,i,e,s){const n=new Ji;return this.provideLabelPick(e,tt(0,"The active text editor does not provide symbol information.")),(async()=>await this.waitForLanguageSymbolRegistry(i,n)&&!s.isCancellationRequested&&n.add(this.doProvideWithEditorSymbols(t,i,e,s)))(),n}provideLabelPick(t,i){t.items=[{label:i,index:0,kind:14}],t.ariaLabel=i}async waitForLanguageSymbolRegistry(t,i){if(this._languageFeaturesService.documentSymbolProvider.has(t))return!0;const e=new Ao,s=i.add(this._languageFeaturesService.documentSymbolProvider.onDidChange((()=>{this._languageFeaturesService.documentSymbolProvider.has(t)&&(s.dispose(),e.complete(!0))})));return i.add(Zi((()=>e.complete(!1)))),e.p}doProvideWithEditorSymbols(t,i,e,s){var n;const r=t.editor,o=new Ji;o.add(e.onDidAccept((i=>{const[s]=e.selectedItems;s&&s.range&&(this.gotoLocation(t,{range:s.range.selection,keyMods:e.keyMods,preserveFocus:i.inBackground}),i.inBackground||e.hide())}))),o.add(e.onDidTriggerItemButton((({item:i})=>{i&&i.range&&(this.gotoLocation(t,{range:i.range.selection,keyMods:e.keyMods,forceSideBySide:!0}),e.hide())})));const h=this.getDocumentSymbols(i,s);let c;const l=async t=>{c==null||c.dispose(!0),e.busy=!1,c=new ye(s),e.busy=!0;try{const i=Jht(e.value.substr(Xht.PREFIX.length).trim()),n=await this.doGetSymbolPicks(h,i,void 0,c.token);if(s.isCancellationRequested)return;if(n.length>0){if(e.items=n,t&&i.original.length===0){const i=yg(n,(i=>!!(i.type!=="separator"&&i.range&&Cs.containsPosition(i.range.decoration,t))));i&&(e.activeItems=[i])}}else i.original.length>0?this.provideLabelPick(e,tt(0,"No matching editor symbols")):this.provideLabelPick(e,tt(0,"No editor symbols"))}finally{s.isCancellationRequested||(e.busy=!1)}};return o.add(e.onDidChangeValue((()=>l(void 0)))),l((n=r.getSelection())===null||n===void 0?void 0:n.getPosition()),o.add(e.onDidChangeActive((()=>{const[t]=e.activeItems;t&&t.range&&(r.revealRangeInCenter(t.range.selection,0),this.addDecorations(r,t.range.decoration))}))),o}async doGetSymbolPicks(t,i,e,s){var n,r;const o=await t;if(s.isCancellationRequested)return[];const h=i.original.indexOf(Xht.SCOPE_PREFIX)===0,c=h?1:0;let l,a,u;i.values&&i.values.length>1?(l=Yht(i.values[0]),a=Yht(i.values.slice(1))):l=i;const d=(r=(n=this.options)===null||n===void 0?void 0:n.openSideBySideDirection)===null||r===void 0?void 0:r.call(n);d&&(u=[{iconClass:d==="right"?Kl.asClassName(As.splitHorizontal):Kl.asClassName(As.splitVertical),tooltip:tt(0,d==="right"?"Open to the Side":"Open to the Bottom")}]);const f=[];for(let t=0;t<o.length;t++){const s=o[t],n=Zn(s.name),r=`$(${$s.toIcon(s.kind).id}) ${n}`,h=r.length-n.length;let d,m,w,v,b=s.containerName;if(e!=null&&e.extraContainerLabel&&(b=b?`${e.extraContainerLabel} • ${b}`:e.extraContainerLabel),i.original.length>c){let t=!1;if(l!==i&&([d,m]=zht(r,{...i,values:void 0},c,h),typeof d=="number"&&(t=!0)),typeof d!="number"&&([d,m]=zht(r,l,c,h),typeof d!="number"))continue;if(!t&&a){if(b&&a.original.length>0&&([w,v]=zht(b,a)),typeof w!="number")continue;typeof d=="number"&&(d+=w)}}const y=s.tags&&s.tags.indexOf(1)>=0;f.push({index:t,kind:s.kind,score:d,label:r,ariaLabel:(g=s.name,p=s.kind,tt(0,"{0} ({1})",g,Bs[p])),description:b,highlights:y?void 0:{label:m,description:v},range:{selection:Cs.collapseToStart(s.selectionRange),decoration:s.range},strikethrough:y,buttons:u})}var g,p;const m=f.sort(((t,i)=>h?this.compareByKindAndScore(t,i):this.compareByScore(t,i)));let w=[];if(h){let t=function(){e&&typeof i=="number"&&s>0&&(e.label=Kn(nct[i]||sct,s))},i,e,s=0;for(const n of m)i!==n.kind?(t(),i=n.kind,s=1,e={type:"separator"},w.push(e)):s++,w.push(n);t()}else m.length>0&&(w=[{label:tt(0,"symbols ({0})",f.length),type:"separator"},...m]);return w}compareByScore(t,i){if(typeof t.score!="number"&&typeof i.score=="number")return 1;if(typeof t.score=="number"&&typeof i.score!="number")return-1;if(typeof t.score=="number"&&typeof i.score=="number"){if(t.score>i.score)return-1;if(t.score<i.score)return 1}return t.index<i.index?-1:t.index>i.index?1:0}compareByKindAndScore(t,i){const e=nct[t.kind]||sct,s=nct[i.kind]||sct,n=e.localeCompare(s);return n===0?this.compareByScore(t,i):n}async getDocumentSymbols(t,i){const e=await this._outlineModelService.getOrCreate(t,i);return i.isCancellationRequested?[]:e.asListOfDocumentSymbols()}};ect.PREFIX="@",ect.SCOPE_PREFIX=":",ect.PREFIX_BY_CATEGORY=`${Xht.PREFIX}${Xht.SCOPE_PREFIX}`,ect=Xht=tct([ict(0,$p),ict(1,F8)],ect);const sct=tt(0,"properties ({0})"),nct={5:tt(0,"methods ({0})"),11:tt(0,"functions ({0})"),8:tt(0,"constructors ({0})"),12:tt(0,"variables ({0})"),4:tt(0,"classes ({0})"),22:tt(0,"structs ({0})"),23:tt(0,"events ({0})"),24:tt(0,"operators ({0})"),10:tt(0,"interfaces ({0})"),2:tt(0,"namespaces ({0})"),3:tt(0,"packages ({0})"),25:tt(0,"type parameters ({0})"),1:tt(0,"modules ({0})"),6:tt(0,"properties ({0})"),9:tt(0,"enumerations ({0})"),21:tt(0,"enumeration members ({0})"),14:tt(0,"strings ({0})"),0:tt(0,"files ({0})"),17:tt(0,"arrays ({0})"),15:tt(0,"numbers ({0})"),16:tt(0,"booleans ({0})"),18:tt(0,"objects ({0})"),19:tt(0,"keys ({0})"),7:tt(0,"fields ({0})"),13:tt(0,"constants ({0})")};var rct=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},oct=function(t,i){return function(e,s){i(e,s,t)}};let hct=class extends ect{constructor(t,i,e){super(i,e),this.editorService=t,this.onDidActiveTextEditorControlChange=ne.None}get activeTextEditorControl(){var t;return(t=this.editorService.getFocusedCodeEditor())!==null&&t!==void 0?t:void 0}};hct=rct([oct(0,Pl),oct(1,$p),oct(2,F8)],hct);class cct extends mu{constructor(){super({id:cct.ID,label:BN.quickOutlineActionLabel,alias:"Go to Symbol...",precondition:Ox.hasDocumentSymbolProvider,kbOpts:{kbExpr:Ox.focus,primary:3117,weight:100},contextMenuOpts:{group:"navigation",order:3}})}run(t){t.get(vj).quickAccess.show(ect.PREFIX,{itemActivation:wj.NONE})}}function lct(t,i){return i&&(t.stack||t.stacktrace)?tt(0,"{0}: {1}",uct(t),act(t.stack)||act(t.stacktrace)):uct(t)}function act(t){return Array.isArray(t)?t.join(`\n`):t}function uct(t){return t.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${t.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof t.code=="string"&&typeof t.errno=="number"&&typeof t.syscall=="string"?tt(0,"A system error occurred ({0})",t.message):t.message||tt(0,"An unknown error occurred. Please consult the log for more details.")}function dct(t=null,i=!1){if(!t)return tt(0,"An unknown error occurred. Please consult the log for more details.");if(Array.isArray(t)){const e=a(t),s=dct(e[0],i);return e.length>1?tt(0,"{0} ({1} errors in total)",s,e.length):s}if(R(t))return t;if(t.detail){const e=t.detail;if(e.error)return lct(e.error,i);if(e.exception)return lct(e.exception,i)}return t.stack?lct(t,i):t.message?t.message:tt(0,"An unknown error occurred. Please consult the log for more details.")}cct.ID="editor.action.quickOutline",ku(cct),Va.as(gj).registerQuickAccessProvider({ctor:hct,prefix:ect.PREFIX,helpEntries:[{description:BN.quickOutlineActionLabel,prefix:ect.PREFIX,commandId:cct.ID},{description:BN.quickOutlineByCategoryActionLabel,prefix:ect.PREFIX_BY_CATEGORY}]});class fct{constructor(){this.chunkCount=0,this.chunkOccurrences=new Map,this.documents=new Map}calculateScores(t,i){const e=this.computeEmbedding(t),s=new Map,n=[];for(const[t,r]of this.documents){if(i.isCancellationRequested)return[];for(const i of r.chunks){const r=this.computeSimilarityScore(i,e,s);r>0&&n.push({key:t,score:r})}}return n}static termFrequencies(t){return function(t){var i;const e=new Map;for(const s of t)e.set(s,((i=e.get(s))!==null&&i!==void 0?i:0)+1);return e}(fct.splitTerms(t))}static*splitTerms(t){const i=t=>t.toLowerCase();for(const[e]of t.matchAll(new RegExp("\\b\\p{Letter}[\\p{Letter}\\d]{2,}\\b","gu"))){yield i(e);const t=e.replace(/([a-z])([A-Z])/g,"$1 $2").split(/\s+/g);if(t.length>1)for(const e of t)e.length>2&&new RegExp("\\p{Letter}{3,}","gu").test(e)&&(yield i(e))}}updateDocuments(t){var i;for(const{key:i}of t)this.deleteDocument(i);for(const e of t){const t=[];for(const s of e.textChunks){const e=fct.termFrequencies(s);for(const t of e.keys())this.chunkOccurrences.set(t,((i=this.chunkOccurrences.get(t))!==null&&i!==void 0?i:0)+1);t.push({text:s,tf:e})}this.chunkCount+=t.length,this.documents.set(e.key,{chunks:t})}return this}deleteDocument(t){const i=this.documents.get(t);if(i){this.documents.delete(t),this.chunkCount-=i.chunks.length;for(const t of i.chunks)for(const i of t.tf.keys()){const t=this.chunkOccurrences.get(i);if(typeof t=="number"){const e=t-1;e<=0?this.chunkOccurrences.delete(i):this.chunkOccurrences.set(i,e)}}}}computeSimilarityScore(t,i,e){let s=0;for(const[n,r]of Object.entries(i)){const i=t.tf.get(n);if(!i)continue;let o=e.get(n);typeof o!="number"&&(o=this.computeIdf(n),e.set(n,o)),s+=i*o*r}return s}computeEmbedding(t){const i=fct.termFrequencies(t);return this.computeTfidf(i)}computeIdf(t){var i;const e=(i=this.chunkOccurrences.get(t))!==null&&i!==void 0?i:0;return e>0?Math.log((this.chunkCount+1)/e):0}computeTfidf(t){const i=Object.create(null);for(const[e,s]of t){const t=this.computeIdf(e);t>0&&(i[e]=s*t)}return i}}var gct;function pct(t){const i=t;return Array.isArray(i.items)}function mct(t){const i=t;return!!i.picks&&i.additionalPicks instanceof Promise}(function(t){t[t.NO_ACTION=0]="NO_ACTION",t[t.CLOSE_PICKER=1]="CLOSE_PICKER",t[t.REFRESH_PICKER=2]="REFRESH_PICKER",t[t.REMOVE_ITEM=3]="REMOVE_ITEM"})(gct||(gct={}));class wct extends Qi{constructor(t,i){super(),this.prefix=t,this.options=i}provide(t,i,e){var s;const n=new Ji;let r;t.canAcceptInBackground=!!(!((s=this.options)===null||s===void 0)&&s.canAcceptInBackground),t.matchOnLabel=t.matchOnDescription=t.matchOnDetail=t.sortByLabel=!1;const o=n.add(new Yi),h=async()=>{var s;const n=o.value=new Ji;r==null||r.dispose(!0),t.busy=!1,r=new ye(i);const h=r.token;let c=t.value.substring(this.prefix.length);!((s=this.options)===null||s===void 0)&&s.shouldSkipTrimPickFilter||(c=c.trim());const l=this._getPicks(c,n,h,e),a=(i,e)=>{var s;let n,r;if(pct(i)?(n=i.items,r=i.active):n=i,n.length===0){if(e)return!1;(c.length>0||t.hideInput)&&(!((s=this.options)===null||s===void 0)&&s.noResultsPick)&&(n=V(this.options.noResultsPick)?[this.options.noResultsPick(c)]:[this.options.noResultsPick])}return t.items=n,r&&(t.activeItems=[r]),!0},u=async i=>{let e=!1,s=!1;await Promise.all([(async()=>{typeof i.mergeDelay=="number"&&(await wo(i.mergeDelay),h.isCancellationRequested)||s||(e=a(i.picks,!0))})(),(async()=>{t.busy=!0;try{const s=await i.additionalPicks;if(h.isCancellationRequested)return;let n,r,o,c;if(pct(i.picks)?(n=i.picks.items,r=i.picks.active):n=i.picks,pct(s)?(o=s.items,c=s.active):o=s,o.length>0||!e){let i;if(!r&&!c){const e=t.activeItems[0];e&&n.indexOf(e)!==-1&&(i=e)}a({items:[...n,...o],active:r||c||i})}}finally{h.isCancellationRequested||(t.busy=!1),s=!0}})()])};if(l!==null)if(mct(l))await u(l);else if(l instanceof Promise){t.busy=!0;try{const t=await l;if(h.isCancellationRequested)return;mct(t)?await u(t):a(t)}finally{h.isCancellationRequested||(t.busy=!1)}}else a(l)};n.add(t.onDidChangeValue((()=>h()))),h(),n.add(t.onDidAccept((i=>{const[e]=t.selectedItems;typeof(e==null?void 0:e.accept)=="function"&&(i.inBackground||t.hide(),e.accept(t.keyMods,i))})));const c=async(e,s)=>{var n,r;if(typeof s.trigger!="function")return;const o=(r=(n=s.buttons)===null||n===void 0?void 0:n.indexOf(e))!==null&&r!==void 0?r:-1;if(o>=0){const e=s.trigger(o,t.keyMods),n=typeof e=="number"?e:await e;if(i.isCancellationRequested)return;switch(n){case gct.NO_ACTION:break;case gct.CLOSE_PICKER:t.hide();break;case gct.REFRESH_PICKER:h();break;case gct.REMOVE_ITEM:{const i=t.items.indexOf(s);if(i!==-1){const e=t.items.slice(),s=e.splice(i,1),n=t.activeItems.filter((t=>t!==s[0])),r=t.keepScrollPosition;t.keepScrollPosition=!0,t.items=e,n&&(t.activeItems=n),t.keepScrollPosition=r}break}}}};return n.add(t.onDidTriggerItemButton((({button:t,item:i})=>c(t,i)))),n.add(t.onDidTriggerSeparatorButton((({button:t,separator:i})=>c(t,i)))),n}}var vct,bct,yct=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},kct=function(t,i){return function(e,s){i(e,s,t)}};let Cct=vct=class extends wct{constructor(t,i,e,s,n,r){super(vct.PREFIX,t),this.instantiationService=i,this.keybindingService=e,this.commandService=s,this.telemetryService=n,this.dialogService=r,this.commandsHistory=this._register(this.instantiationService.createInstance(Sct)),this.options=t}async _getPicks(t,i,e,s){var n,r,o,h;const c=await this.getCommandPicks(e);if(e.isCancellationRequested)return[];const l=Ui((()=>{const i=new fct;return i.updateDocuments(c.map((t=>({key:t.commandId,textChunks:[this.getTfIdfChunk(t)]})))),function(t){var i,e;const s=t.slice(0);s.sort(((t,i)=>i.score-t.score));const n=(e=(i=s[0])===null||i===void 0?void 0:i.score)!==null&&e!==void 0?e:0;if(n>0)for(const t of s)t.score/=n;return s}(i.calculateScores(t,e)).filter((t=>t.score>vct.TFIDF_THRESHOLD)).slice(0,vct.TFIDF_MAX_RESULTS)})),a=[];for(const i of c){const s=(n=vct.WORD_FILTER(t,i.label))!==null&&n!==void 0?n:void 0,o=i.commandAlias&&(r=vct.WORD_FILTER(t,i.commandAlias))!==null&&r!==void 0?r:void 0;if(s||o)i.highlights={label:s,detail:this.options.showAlias?o:void 0},a.push(i);else if(t===i.commandId)a.push(i);else if(t.length>=3){const t=l();if(e.isCancellationRequested)return[];const s=t.find((t=>t.key===i.commandId));s&&(i.tfIdfScore=s.score,a.push(i))}}const u=new Map;for(const t of a){const i=u.get(t.label);i?(t.description=t.commandId,i.description=i.commandId):u.set(t.label,t)}a.sort(((t,i)=>{if(t.tfIdfScore&&i.tfIdfScore)return t.tfIdfScore===i.tfIdfScore?t.label.localeCompare(i.label):i.tfIdfScore-t.tfIdfScore;if(t.tfIdfScore)return 1;if(i.tfIdfScore)return-1;const e=this.commandsHistory.peek(t.commandId),s=this.commandsHistory.peek(i.commandId);if(e&&s)return e>s?-1:1;if(e)return-1;if(s)return 1;if(this.options.suggestedCommandIds){const e=this.options.suggestedCommandIds.has(t.commandId),s=this.options.suggestedCommandIds.has(i.commandId);if(e&&s)return 0;if(e)return-1;if(s)return 1}return t.label.localeCompare(i.label)}));const d=[];let f=!1,g=!0,p=!!this.options.suggestedCommandIds;for(let t=0;t<a.length;t++){const i=a[t];t===0&&this.commandsHistory.peek(i.commandId)&&(d.push({type:"separator",label:tt(0,"recently used")}),f=!0),g&&i.tfIdfScore!==void 0&&(d.push({type:"separator",label:tt(0,"similar commands")}),g=!1),p&&i.tfIdfScore===void 0&&!this.commandsHistory.peek(i.commandId)&&(!((o=this.options.suggestedCommandIds)===null||o===void 0)&&o.has(i.commandId))&&(d.push({type:"separator",label:tt(0,"commonly used")}),f=!0,p=!1),!f||i.tfIdfScore!==void 0||this.commandsHistory.peek(i.commandId)||!((h=this.options.suggestedCommandIds)===null||h===void 0)&&h.has(i.commandId)||(d.push({type:"separator",label:tt(0,"other commands")}),f=!1),d.push(this.toCommandPick(i,s))}return this.hasAdditionalCommandPicks(t,e)?{picks:d,additionalPicks:(async()=>{var i;const n=await this.getAdditionalCommandPicks(c,a,t,e);if(e.isCancellationRequested)return[];const r=n.map((t=>this.toCommandPick(t,s)));return g&&((i=r[0])===null||i===void 0?void 0:i.type)!=="separator"&&r.unshift({type:"separator",label:tt(0,"similar commands")}),r})()}:d}toCommandPick(t,i){if(t.type==="separator")return t;const e=this.keybindingService.lookupKeybinding(t.commandId),s=e?tt(0,"{0}, {1}",t.label,e.getAriaLabel()):t.label;return{...t,ariaLabel:s,detail:this.options.showAlias&&t.commandAlias!==t.label?t.commandAlias:void 0,keybinding:e,accept:async()=>{var e,s;this.commandsHistory.push(t.commandId),this.telemetryService.publicLog2("workbenchActionExecuted",{id:t.commandId,from:(e=i==null?void 0:i.from)!==null&&e!==void 0?e:"quick open"});try{!((s=t.args)===null||s===void 0)&&s.length?await this.commandService.executeCommand(t.commandId,...t.args):await this.commandService.executeCommand(t.commandId)}catch(i){Bi(i)||this.dialogService.error(tt(0,"Command '{0}' resulted in an error",t.label),dct(i))}}}}getTfIdfChunk({label:t,commandAlias:i,commandDescription:e}){let s=t;return i&&i!==t&&(s+=` - ${i}`),e&&e.value!==t&&(s+=` - ${e.value===e.original?e.value:`${e.value} (${e.original})`}`),s}};Cct.PREFIX=">",Cct.TFIDF_THRESHOLD=.5,Cct.TFIDF_MAX_RESULTS=5,Cct.WORD_FILTER=LI(FI,(function(t,i,e=!1){if(!i||i.length===0)return null;let s=null,n=0;for(t=t.toLowerCase(),i=i.toLowerCase();n<i.length&&(s=ZI(t,i,0,n,e),s===null);)n=JI(i,n+1);return s}),RI),Cct=vct=yct([kct(1,Il),kct(2,NS),kct(3,ql),kct(4,ru),kct(5,VR)],Cct);let Sct=bct=class extends Qi{constructor(t,i,e){super(),this.storageService=t,this.configurationService=i,this.logService=e,this.configuredCommandsHistoryLength=0,this.updateConfiguration(),this.load(),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration((t=>this.updateConfiguration(t)))),this._register(this.storageService.onWillSaveState((t=>{t.reason===rW.SHUTDOWN&&this.saveState()})))}updateConfiguration(t){t&&!t.affectsConfiguration("workbench.commandPalette.history")||(this.configuredCommandsHistoryLength=bct.getConfiguredCommandHistoryLength(this.configurationService),bct.cache&&bct.cache.limit!==this.configuredCommandsHistoryLength&&(bct.cache.limit=this.configuredCommandsHistoryLength,bct.hasChanges=!0))}load(){const t=this.storageService.get(bct.PREF_KEY_CACHE,0);let i;if(t)try{i=JSON.parse(t)}catch(t){this.logService.error(`[CommandsHistory] invalid data: ${t}`)}const e=bct.cache=new Kf(this.configuredCommandsHistoryLength,1);if(i){let t;t=i.usesLRU?i.entries:i.entries.sort(((t,i)=>t.value-i.value)),t.forEach((t=>e.set(t.key,t.value)))}bct.counter=this.storageService.getNumber(bct.PREF_KEY_COUNTER,0,bct.counter)}push(t){bct.cache&&(bct.cache.set(t,bct.counter++),bct.hasChanges=!0)}peek(t){var i;return(i=bct.cache)===null||i===void 0?void 0:i.peek(t)}saveState(){if(!bct.cache||!bct.hasChanges)return;const t={usesLRU:!0,entries:[]};bct.cache.forEach(((i,e)=>t.entries.push({key:e,value:i}))),this.storageService.store(bct.PREF_KEY_CACHE,JSON.stringify(t),0,0),this.storageService.store(bct.PREF_KEY_COUNTER,bct.counter,0,0),bct.hasChanges=!1}static getConfiguredCommandHistoryLength(t){var i,e;const s=(e=(i=t.getValue().workbench)===null||i===void 0?void 0:i.commandPalette)===null||e===void 0?void 0:e.history;return typeof s=="number"?s:bct.DEFAULT_COMMANDS_HISTORY_LENGTH}};Sct.DEFAULT_COMMANDS_HISTORY_LENGTH=50,Sct.PREF_KEY_CACHE="commandPalette.mru.cache",Sct.PREF_KEY_COUNTER="commandPalette.mru.counter",Sct.counter=1,Sct.hasChanges=!1,Sct=bct=yct([kct(0,nW),kct(1,Md),kct(2,ou)],Sct);class xct extends Cct{constructor(t,i,e,s,n,r){super(t,i,e,s,n,r)}getCodeEditorCommandPicks(){const t=this.activeTextEditorControl;if(!t)return[];const i=[];for(const e of t.getSupportedActions())i.push({commandId:e.id,commandAlias:e.alias,label:E_(e.label)||e.id});return i}}var Dct=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Ect=function(t,i){return function(e,s){i(e,s,t)}};let Act=class extends xct{get activeTextEditorControl(){var t;return(t=this.codeEditorService.getFocusedCodeEditor())!==null&&t!==void 0?t:void 0}constructor(t,i,e,s,n,r){super({showAlias:!1},t,e,s,n,r),this.codeEditorService=i}async getCommandPicks(){return this.getCodeEditorCommandPicks()}hasAdditionalCommandPicks(){return!1}async getAdditionalCommandPicks(){return[]}};Act=Dct([Ect(0,Il),Ect(1,Pl),Ect(2,NS),Ect(3,ql),Ect(4,ru),Ect(5,VR)],Act);class Mct extends mu{constructor(){super({id:Mct.ID,label:NN.quickCommandActionLabel,alias:"Command Palette",precondition:void 0,kbOpts:{kbExpr:Ox.focus,primary:59,weight:100},contextMenuOpts:{group:"z_commands",order:1}})}run(t){t.get(vj).quickAccess.show(Act.PREFIX)}}Mct.ID="editor.action.quickCommand",ku(Mct),Va.as(gj).registerQuickAccessProvider({ctor:Act,prefix:Act.PREFIX,helpEntries:[{description:NN.quickCommandHelp,commandId:Mct.ID}]});var Lct=function(t,i,e,s){var n,r=arguments.length,o=r<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,i,e,s);else for(var h=t.length-1;h>=0;h--)(n=t[h])&&(o=(r<3?n(o):r>3?n(i,e,o):n(i,e))||o);return r>3&&o&&Object.defineProperty(i,e,o),o},Fct=function(t,i){return function(e,s){i(e,s,t)}};let Tct=class extends i5{constructor(t,i,e,s,n,r,o){super(!0,t,i,e,s,n,r,o)}};Tct=Lct([Fct(1,Ra),Fct(2,Pl),Fct(3,gR),Fct(4,Il),Fct(5,nW),Fct(6,Md)],Tct),Su(i5.ID,Tct,4);ku(class extends mu{constructor(){super({id:"editor.action.toggleHighContrast",label:WN.toggleHighContrast,alias:"Toggle High Contrast Theme",precondition:void 0}),this._originalThemeName=null}run(t,i){const e=t.get(aK),s=e.getColorTheme();lk(s.type)?(e.setTheme(this._originalThemeName||(ak(s.type)?iK:tK)),this._originalThemeName=null):(e.setTheme(ak(s.type)?eK:sK),this._originalThemeName=s.themeName)}});const Rct=Object.freeze(Object.defineProperty({__proto__:null,CancellationTokenSource:QQ,Emitter:YQ,KeyCode:XQ,KeyMod:tY,MarkerSeverity:rY,MarkerTag:oY,Position:iY,Range:eY,Selection:sY,SelectionDirection:nY,Token:cY,Uri:hY,editor:lY,languages:aY},Symbol.toStringTag,{value:"Module"}));function Oct(t){return new Worker("/assets/editor.worker-kH-qYHP1.js",{name:t==null?void 0:t.name})}function Ict(t){return new Worker("/assets/json.worker-kXvdEO82.js",{name:t==null?void 0:t.name})}function _ct(t){return new Worker("/assets/css.worker-DC5nnw6R.js",{name:t==null?void 0:t.name})}function Pct(t){return new Worker("/assets/html.worker-BCaZjbWa.js",{name:t==null?void 0:t.name})}function Nct(t){return new Worker("/assets/ts.worker-BtbHax8g.js",{name:t==null?void 0:t.name})}function Bct(t){return new Worker("/assets/yaml.worker-tZqYN86i.js",{name:t==null?void 0:t.name})}function $ct(t,i,e){const s=new Map,n=t=>{const e=t.getLanguageId();return Array.isArray(i)?i.includes(e):i===e},r=async i=>{const s=i.getVersionId(),r=await e.provideMarkerData(i);s===i.getVersionId()&&!i.isDisposed()&&n(i)&&t.editor.setModelMarkers(i,e.owner,r??[])},o=t=>{if(!n(t))return;let i;s.set(t,t.onDidChangeContent((()=>{clearTimeout(i),i=setTimeout((()=>{r(t)}),500)}))),r(t)},h=i=>{t.editor.setModelMarkers(i,e.owner,[]);const n=s.get(i);n&&(n.dispose(),s.delete(i))},c=t.editor.onDidCreateModel(o),l=t.editor.onWillDisposeModel((t=>{var i;h(t),(i=e.doReset)==null||i.call(e,t)})),a=t.editor.onDidChangeModelLanguage((t=>{var i;h(t.model),o(t.model),(i=e.doReset)==null||i.call(e,t.model)}));for(const i of t.editor.getModels())o(i);return{dispose(){for(const t of s.keys())h(t);c.dispose(),l.dispose(),a.dispose()},async revalidate(){await Promise.all(t.editor.getModels().map(r))}}}var Wct;(()=>{var t={470:t=>{function i(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}function e(t,i){for(var e,s="",n=0,r=-1,o=0,h=0;h<=t.length;++h){if(h<t.length)e=t.charCodeAt(h);else{if(e===47)break;e=47}if(e===47){if(!(r===h-1||o===1))if(r!==h-1&&o===2){if(s.length<2||n!==2||s.charCodeAt(s.length-1)!==46||s.charCodeAt(s.length-2)!==46){if(s.length>2){var c=s.lastIndexOf("/");if(c!==s.length-1){c===-1?(s="",n=0):n=(s=s.slice(0,c)).length-1-s.lastIndexOf("/"),r=h,o=0;continue}}else if(s.length===2||s.length===1){s="",n=0,r=h,o=0;continue}}i&&(s.length>0?s+="/..":s="..",n=2)}else s.length>0?s+="/"+t.slice(r+1,h):s=t.slice(r+1,h),n=h-r-1;r=h,o=0}else e===46&&o!==-1?++o:o=-1}return s}var s={resolve:function(){for(var t,s="",n=!1,r=arguments.length-1;r>=-1&&!n;r--){var o;r>=0?o=arguments[r]:(t===void 0&&(t=process.cwd()),o=t),i(o),o.length!==0&&(s=o+"/"+s,n=o.charCodeAt(0)===47)}return s=e(s,!n),n?s.length>0?"/"+s:"/":s.length>0?s:"."},normalize:function(t){if(i(t),t.length===0)return".";var s=t.charCodeAt(0)===47,n=t.charCodeAt(t.length-1)===47;return(t=e(t,!s)).length!==0||s||(t="."),t.length>0&&n&&(t+="/"),s?"/"+t:t},isAbsolute:function(t){return i(t),t.length>0&&t.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var t,e=0;e<arguments.length;++e){var n=arguments[e];i(n),n.length>0&&(t===void 0?t=n:t+="/"+n)}return t===void 0?".":s.normalize(t)},relative:function(t,e){if(i(t),i(e),t===e||(t=s.resolve(t))===(e=s.resolve(e)))return"";for(var n=1;n<t.length&&t.charCodeAt(n)===47;++n);for(var r=t.length,o=r-n,h=1;h<e.length&&e.charCodeAt(h)===47;++h);for(var c=e.length-h,l=o<c?o:c,a=-1,u=0;u<=l;++u){if(u===l){if(c>l){if(e.charCodeAt(h+u)===47)return e.slice(h+u+1);if(u===0)return e.slice(h+u)}else o>l&&(t.charCodeAt(n+u)===47?a=u:u===0&&(a=0));break}var d=t.charCodeAt(n+u);if(d!==e.charCodeAt(h+u))break;d===47&&(a=u)}var f="";for(u=n+a+1;u<=r;++u)u!==r&&t.charCodeAt(u)!==47||(f.length===0?f+="..":f+="/..");return f.length>0?f+e.slice(h+a):(h+=a,e.charCodeAt(h)===47&&++h,e.slice(h))},_makeLong:function(t){return t},dirname:function(t){if(i(t),t.length===0)return".";for(var e=t.charCodeAt(0),s=e===47,n=-1,r=!0,o=t.length-1;o>=1;--o)if((e=t.charCodeAt(o))===47){if(!r){n=o;break}}else r=!1;return n===-1?s?"/":".":s&&n===1?"//":t.slice(0,n)},basename:function(t,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');i(t);var s,n=0,r=-1,o=!0;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";var h=e.length-1,c=-1;for(s=t.length-1;s>=0;--s){var l=t.charCodeAt(s);if(l===47){if(!o){n=s+1;break}}else c===-1&&(o=!1,c=s+1),h>=0&&(l===e.charCodeAt(h)?--h==-1&&(r=s):(h=-1,r=c))}return n===r?r=c:r===-1&&(r=t.length),t.slice(n,r)}for(s=t.length-1;s>=0;--s)if(t.charCodeAt(s)===47){if(!o){n=s+1;break}}else r===-1&&(o=!1,r=s+1);return r===-1?"":t.slice(n,r)},extname:function(t){i(t);for(var e=-1,s=0,n=-1,r=!0,o=0,h=t.length-1;h>=0;--h){var c=t.charCodeAt(h);if(c!==47)n===-1&&(r=!1,n=h+1),c===46?e===-1?e=h:o!==1&&(o=1):e!==-1&&(o=-1);else if(!r){s=h+1;break}}return e===-1||n===-1||o===0||o===1&&e===n-1&&e===s+1?"":t.slice(e,n)},format:function(t){if(t===null||typeof t!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof t);return function(t,i){var e=i.dir||i.root,s=i.base||(i.name||"")+(i.ext||"");return e?e===i.root?e+s:e+"/"+s:s}(0,t)},parse:function(t){i(t);var e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;var s,n=t.charCodeAt(0),r=n===47;r?(e.root="/",s=1):s=0;for(var o=-1,h=0,c=-1,l=!0,a=t.length-1,u=0;a>=s;--a)if((n=t.charCodeAt(a))!==47)c===-1&&(l=!1,c=a+1),n===46?o===-1?o=a:u!==1&&(u=1):o!==-1&&(u=-1);else if(!l){h=a+1;break}return o===-1||c===-1||u===0||u===1&&o===c-1&&o===h+1?c!==-1&&(e.base=e.name=h===0&&r?t.slice(1,c):t.slice(h,c)):(h===0&&r?(e.name=t.slice(1,o),e.base=t.slice(1,c)):(e.name=t.slice(h,o),e.base=t.slice(h,c)),e.ext=t.slice(o,c)),h>0?e.dir=t.slice(0,h-1):r&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};s.posix=s,t.exports=s}},i={};function s(e){var n=i[e];if(n!==void 0)return n.exports;var r=i[e]={exports:{}};return t[e](r,r.exports,s),r.exports}s.d=(t,i)=>{for(var e in i)s.o(i,e)&&!s.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:i[e]})},s.o=(t,i)=>Object.prototype.hasOwnProperty.call(t,i),s.r=t=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};(()=>{let t;s.r(n),s.d(n,{URI:()=>u,Utils:()=>D}),typeof process=="object"?t=process.platform==="win32":typeof navigator=="object"&&(t=navigator.userAgent.indexOf("Windows")>=0);const i=/^\w[\w\d+.-]*$/,r=/^\//,o=/^\/\//;function h(t,e){if(!t.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${t.authority}", path: "${t.path}", query: "${t.query}", fragment: "${t.fragment}"}`);if(t.scheme&&!i.test(t.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(t.path){if(t.authority){if(!r.test(t.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(o.test(t.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}const c="",l="/",a=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class u{constructor(t,i,s,n,r,o=!1){e(this,"scheme");e(this,"authority");e(this,"path");e(this,"query");e(this,"fragment");typeof t=="object"?(this.scheme=t.scheme||c,this.authority=t.authority||c,this.path=t.path||c,this.query=t.query||c,this.fragment=t.fragment||c):(this.scheme=function(t,i){return t||i?t:"file"}(t,o),this.authority=i||c,this.path=function(t,i){switch(t){case"https":case"http":case"file":i?i[0]!==l&&(i=l+i):i=l}return i}(this.scheme,s||c),this.query=n||c,this.fragment=r||c,h(this,o))}static isUri(t){return t instanceof u||!!t&&typeof t.authority=="string"&&typeof t.fragment=="string"&&typeof t.path=="string"&&typeof t.query=="string"&&typeof t.scheme=="string"&&typeof t.fsPath=="string"&&typeof t.with=="function"&&typeof t.toString=="function"}get fsPath(){return w(this)}with(t){if(!t)return this;let{scheme:i,authority:e,path:s,query:n,fragment:r}=t;return i===void 0?i=this.scheme:i===null&&(i=c),e===void 0?e=this.authority:e===null&&(e=c),s===void 0?s=this.path:s===null&&(s=c),n===void 0?n=this.query:n===null&&(n=c),r===void 0?r=this.fragment:r===null&&(r=c),i===this.scheme&&e===this.authority&&s===this.path&&n===this.query&&r===this.fragment?this:new f(i,e,s,n,r)}static parse(t,i=!1){const e=a.exec(t);return e?new f(e[2]||c,k(e[4]||c),k(e[5]||c),k(e[7]||c),k(e[9]||c),i):new f(c,c,c,c,c)}static file(i){let e=c;if(t&&(i=i.replace(/\\/g,l)),i[0]===l&&i[1]===l){const t=i.indexOf(l,2);t===-1?(e=i.substring(2),i=l):(e=i.substring(2,t),i=i.substring(t)||l)}return new f("file",e,i,c,c)}static from(t){const i=new f(t.scheme,t.authority,t.path,t.query,t.fragment);return h(i,!0),i}toString(t=!1){return v(this,t)}toJSON(){return this}static revive(t){if(t){if(t instanceof u)return t;{const i=new f(t);return i._formatted=t.external,i._fsPath=t._sep===d?t.fsPath:null,i}}return t}}const d=t?1:void 0;class f extends u{constructor(){super(...arguments);e(this,"_formatted",null);e(this,"_fsPath",null)}get fsPath(){return this._fsPath||(this._fsPath=w(this)),this._fsPath}toString(t=!1){return t?v(this,!0):(this._formatted||(this._formatted=v(this,!1)),this._formatted)}toJSON(){const t={$mid:1};return this._fsPath&&(t.fsPath=this._fsPath,t._sep=d),this._formatted&&(t.external=this._formatted),this.path&&(t.path=this.path),this.scheme&&(t.scheme=this.scheme),this.authority&&(t.authority=this.authority),this.query&&(t.query=this.query),this.fragment&&(t.fragment=this.fragment),t}}const g={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function p(t,i,e){let s,n=-1;for(let r=0;r<t.length;r++){const o=t.charCodeAt(r);if(o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||o===45||o===46||o===95||o===126||i&&o===47||e&&o===91||e&&o===93||e&&o===58)n!==-1&&(s+=encodeURIComponent(t.substring(n,r)),n=-1),s!==void 0&&(s+=t.charAt(r));else{s===void 0&&(s=t.substr(0,r));const i=g[o];i!==void 0?(n!==-1&&(s+=encodeURIComponent(t.substring(n,r)),n=-1),s+=i):n===-1&&(n=r)}}return n!==-1&&(s+=encodeURIComponent(t.substring(n))),s!==void 0?s:t}function m(t){let i;for(let e=0;e<t.length;e++){const s=t.charCodeAt(e);s===35||s===63?(i===void 0&&(i=t.substr(0,e)),i+=g[s]):i!==void 0&&(i+=t[e])}return i!==void 0?i:t}function w(i,e){let s;return s=i.authority&&i.path.length>1&&i.scheme==="file"?`//${i.authority}${i.path}`:i.path.charCodeAt(0)===47&&(i.path.charCodeAt(1)>=65&&i.path.charCodeAt(1)<=90||i.path.charCodeAt(1)>=97&&i.path.charCodeAt(1)<=122)&&i.path.charCodeAt(2)===58?i.path[1].toLowerCase()+i.path.substr(2):i.path,t&&(s=s.replace(/\//g,"\\")),s}function v(t,i){const e=i?m:p;let s="",{scheme:n,authority:r,path:o,query:h,fragment:c}=t;if(n&&(s+=n,s+=":"),(r||n==="file")&&(s+=l,s+=l),r){let t=r.indexOf("@");if(t!==-1){const i=r.substr(0,t);r=r.substr(t+1),t=i.lastIndexOf(":"),t===-1?s+=e(i,!1,!1):(s+=e(i.substr(0,t),!1,!1),s+=":",s+=e(i.substr(t+1),!1,!0)),s+="@"}r=r.toLowerCase(),t=r.lastIndexOf(":"),t===-1?s+=e(r,!1,!0):(s+=e(r.substr(0,t),!1,!0),s+=r.substr(t))}if(o){if(o.length>=3&&o.charCodeAt(0)===47&&o.charCodeAt(2)===58){const t=o.charCodeAt(1);t>=65&&t<=90&&(o=`/${String.fromCharCode(t+32)}:${o.substr(3)}`)}else if(o.length>=2&&o.charCodeAt(1)===58){const t=o.charCodeAt(0);t>=65&&t<=90&&(o=`${String.fromCharCode(t+32)}:${o.substr(2)}`)}s+=e(o,!0,!1)}return h&&(s+="?",s+=e(h,!1,!1)),c&&(s+="#",s+=i?c:p(c,!1,!1)),s}function b(t){try{return decodeURIComponent(t)}catch{return t.length>3?t.substr(0,3)+b(t.substr(3)):t}}const y=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function k(t){return t.match(y)?t.replace(y,(t=>b(t))):t}var C=s(470);const S=C.posix||C,x="/";var D;(function(t){t.joinPath=function(t,...i){return t.with({path:S.join(t.path,...i)})},t.resolvePath=function(t,...i){let e=t.path,s=!1;e[0]!==x&&(e=x+e,s=!0);let n=S.resolve(e,...i);return s&&n[0]===x&&!t.authority&&(n=n.substring(1)),t.with({path:n})},t.dirname=function(t){if(t.path.length===0||t.path===x)return t;let i=S.dirname(t.path);return i.length===1&&i.charCodeAt(0)===46&&(i=""),t.with({path:i})},t.basename=function(t){return S.basename(t.path)},t.extname=function(t){return S.extname(t.path)}})(D||(D={}))})(),Wct=n})();const{URI:jct,Utils:Hct}=Wct;function Vct(t){return t}function zct(t){return t}function Uct(t){return{start:{line:t.startLineNumber-1,character:t.startColumn-1},end:{line:t.endLineNumber-1,character:t.endColumn-1}}}function Kct(t){return{startLineNumber:t.start.line+1,startColumn:t.start.character+1,endLineNumber:t.end.line+1,endColumn:t.end.character+1}}function qct(t){return{location:{range:Uct(t),uri:String(t.resource)},message:t.message}}function Gct(t){return{...Kct(t.location.range),message:t.message,resource:jct.parse(t.location.uri)}}function Zct(t){const i={message:t.message,range:Uct(t),severity:(e=t.severity,e===8?1:e===4?2:e===2?3:4)};var e;return typeof t.code=="string"?i.code=t.code:t.code!=null&&(i.code=t.code.value,i.codeDescription={href:String(t.code.target)}),t.relatedInformation&&(i.relatedInformation=t.relatedInformation.map(qct)),t.tags&&(i.tags=t.tags.map(Vct)),t.source!=null&&(i.source=t.source),i}function Jct(t,i){const e={...Kct(t.range),message:t.message,severity:t.severity?(s=t.severity,s===1?8:s===2?4:s===3?2:1):8};var s;return t.code!=null&&(e.code=t.codeDescription==null?String(t.code):{value:String(t.code),target:jct.parse(t.codeDescription.href)}),t.relatedInformation&&(e.relatedInformation=t.relatedInformation.map(Gct)),t.tags&&(e.tags=t.tags.map(zct)),t.source!=null&&(e.source=t.source),e}function Qct(t){return{range:Kct(t.range),text:t.newText}}function Yct(t){const i=t.kind==="create"?{newResource:jct.parse(t.uri)}:t.kind==="delete"?{oldResource:jct.parse(t.uri)}:{oldResource:jct.parse(t.oldUri),newResource:jct.parse(t.newUri)};return t.options&&(i.options=function(t){const i={};return t.ignoreIfExists!=null&&(i.ignoreIfExists=t.ignoreIfExists),t.ignoreIfNotExists!=null&&(i.ignoreIfNotExists=t.ignoreIfNotExists),t.overwrite!=null&&(i.overwrite=t.overwrite),t.recursive!=null&&(i.recursive=t.recursive),i}(t.options)),i}function Xct(t,i,e){return{resource:jct.parse(i),versionId:e,textEdit:Qct(t)}}function tlt(t,i){const e={title:t.title,isPreferred:t.isPreferred};return t.diagnostics&&(e.diagnostics=t.diagnostics.map((t=>Jct(t)))),t.disabled&&(e.disabled=t.disabled.reason),t.edit&&(e.edit=function(t){var i;const e=[];if(t.changes)for(const[i,s]of Object.entries(t.changes))for(const t of s)e.push(Xct(t,i));if(t.documentChanges)for(const s of t.documentChanges)if("textDocument"in s)for(const t of s.edits)e.push(Xct(t,s.textDocument.uri,(i=s.textDocument.version)!==null&&i!==void 0?i:void 0));else e.push(Yct(s));return{edits:e}}(t.edit)),t.isPreferred!=null&&(e.isPreferred=t.isPreferred),t.kind&&(e.kind=t.kind),e}function ilt(t){return t}function elt(t){return{value:t.value}}function slt(t){return{range:Kct(t.range),text:t.newText}}function nlt(t,i){var e,s,n,r,o;const h=(e=i.itemDefaults)!==null&&e!==void 0?e:{},c=(s=t.textEdit)!==null&&s!==void 0?s:h.editRange,l=(n=t.commitCharacters)!==null&&n!==void 0?n:h.commitCharacters,a=(r=t.insertTextFormat)!==null&&r!==void 0?r:h.insertTextFormat,u=(o=t.insertTextMode)!==null&&o!==void 0?o:h.insertTextMode;let d,f=t.insertText;var g;c?(d="range"in(g=c)?Kct(g.range):"insert"in g&&"replace"in g?{insert:Kct(g.insert),replace:Kct(g.replace)}:Kct(g),"newText"in c&&(f=c.newText)):d={...i.range};const p={insertText:f??t.label,kind:t.kind==null?18:(m=t.kind,m===1?18:m===2?0:m===3?1:m===4?2:m===5?3:m===6?4:m===7?5:m===8?7:m===9?8:m===10?9:m===11?12:m===12?13:m===13?15:m===14?17:m===15?27:m===16?19:m===17?20:m===18?21:m===19?23:m===20?16:m===21?14:m===22?6:m===23?10:m===24?11:24),label:t.label,range:d};var m;return t.additionalTextEdits&&(p.additionalTextEdits=t.additionalTextEdits.map(slt)),t.command&&(p.command=function(t){const i={title:t.title,id:t.command};return t.arguments&&(i.arguments=t.arguments),i}(t.command)),l&&(p.commitCharacters=l),t.detail!=null&&(p.detail=t.detail),typeof t.documentation=="string"?p.documentation=t.documentation:t.documentation&&(p.documentation=elt(t.documentation)),t.filterText!=null&&(p.filterText=t.filterText),a===2?p.insertTextRules=4:u===2&&(p.insertTextRules=1),t.preselect!=null&&(p.preselect=t.preselect),t.sortText!=null&&(p.sortText=t.sortText),t.tags&&(p.tags=t.tags.map(ilt)),p}function rlt(t){return t}function olt(t){var i,e,s;const n={detail:(i=t.detail)!==null&&i!==void 0?i:"",kind:(r=t.kind,r===1?0:r===2?1:r===3?2:r===4?3:r===5?4:r===6?5:r===7?6:r===8?7:r===9?8:r===10?9:r===11?10:r===12?11:r===13?12:r===14?13:r===15?14:r===16?15:r===17?16:r===18?17:r===19?18:r===20?19:r===21?20:r===22?21:r===23?22:r===24?23:r===25?24:25),name:t.name,range:Kct(t.range),selectionRange:Kct(t.selectionRange),tags:(s=(e=t.tags)===null||e===void 0?void 0:e.map(rlt))!==null&&s!==void 0?s:[]};var r;return t.children&&(n.children=t.children.map(olt)),n}function hlt(t){const i={start:t.startLine+1,end:t.endLine+1};return t.kind!=null&&(i.kind={value:t.kind}),i}function clt(t){return typeof t=="string"?{value:t}:{value:`\`\`\`${t.language}\n${t.value}\n\`\`\``}}function llt(t){return{character:t.column-1,line:t.lineNumber-1}}function alt(t){const i={range:Kct(t.range)};return t.tooltip!=null&&(i.tooltip=t.tooltip),t.target!=null&&(i.url=jct.parse(t.target)),i}function ult(t){const i={range:Kct(t.targetRange),targetSelectionRange:Kct(t.targetSelectionRange),uri:jct.parse(t.targetUri)};return t.originSelectionRange&&(i.originSelectionRange=Kct(t.originSelectionRange)),i}function dlt(t){return{owner:"yaml",async provideMarkerData(i){const e=await t(i.uri),s=await e.doValidation(String(i.uri));return s==null?void 0:s.map((t=>Jct(t)))},async doReset(i){await(await t(i.uri)).resetSchema(String(i.uri))}}}function flt(t){return{triggerCharacters:[" ",":"],async provideCompletionItems(i,e){const s=i.uri,n=i.getWordUntilPosition(e),r=await t(s),o=await r.doComplete(String(s),llt(e));if(o)return h=o,c={range:{startLineNumber:e.lineNumber,startColumn:n.startColumn,endLineNumber:e.lineNumber,endColumn:n.endColumn}},{incomplete:!!h.isIncomplete,suggestions:h.items.map((t=>nlt(t,{range:c.range,itemDefaults:h.itemDefaults})))};var h,c}}}function glt(t){return{async provideDefinition(i,e){const s=i.uri,n=await t(s),r=await n.doDefinition(String(s),llt(e));return r==null?void 0:r.map(ult)}}}function plt(t){return{async provideHover(i,e){const s=i.uri,n=await t(s),r=await n.doHover(String(s),llt(e));if(r)return function(t){const i={contents:(e=t.contents,typeof e=="string"||"language"in e?[clt(e)]:Array.isArray(e)?e.map(clt):[elt(e)])};var e;return t.range&&(i.range=Kct(t.range)),i}(r)}}}function mlt(t){return{displayName:"yaml",async provideDocumentSymbols(i){const e=i.uri,s=await t(e),n=await s.findDocumentSymbols(String(e));return n==null?void 0:n.map(olt)}}}function wlt(t){return{displayName:"yaml",async provideDocumentFormattingEdits(i){const e=i.uri,s=await t(e),n=await s.format(String(e));return n==null?void 0:n.map(Qct)}}}function vlt(t){return{async provideLinks(i){const e=i.uri,s=await t(e),n=await s.findLinks(String(e));if(n)return{links:n.map(alt)}}}}function blt(t){return{async provideCodeActions(i,e,s){const n=i.uri,r=await t(n),o=await r.getCodeAction(String(n),Uct(e),function(t){const i={diagnostics:t.markers.map(Zct),triggerKind:t.trigger};return t.only!=null&&(i.only=[t.only]),i}(s));if(o)return{actions:o.map((t=>tlt(t))),dispose(){}}}}}function ylt(t){return{async provideFoldingRanges(i){const e=i.uri,s=await t(e),n=await s.getFoldingRanges(String(e));return n==null?void 0:n.map(hlt)}}}function klt(t,i){const e={completion:!0,customTags:[],enableSchemaRequest:!1,format:!0,isKubernetes:!1,hover:!0,schemas:[],validate:!0,yamlVersion:"1.2",...i};t.languages.register({id:"yaml",extensions:[".yaml",".yml"],aliases:["YAML","yaml","YML","yml"],mimetypes:["application/x-yaml"]});const s=function(t,i){let e,{createData:s,interval:n=3e4,label:r,moduleId:o,stopWhenIdleFor:h=12e4}=i,c=0,l=!1;const a=()=>{e&&(e.dispose(),e=void 0)},u=setInterval((()=>{e&&Date.now()-c>h&&a()}),n);return{dispose(){l=!0,clearInterval(u),a()},getWorker(...i){if(l)throw new Error("Worker manager has been disposed");return c=Date.now(),e||(e=t.editor.createWebWorker({createData:s,label:r,moduleId:o})),e.withSyncedResources(i)},updateCreateData(t){s=t,a()}}}(t,{label:"yaml",moduleId:"monaco-yaml/yaml.worker",createData:e});let n=$ct(t,"yaml",dlt(s.getWorker));const r=[s,t.languages.registerCompletionItemProvider("yaml",flt(s.getWorker)),t.languages.registerHoverProvider("yaml",plt(s.getWorker)),t.languages.registerDefinitionProvider("yaml",glt(s.getWorker)),t.languages.registerDocumentSymbolProvider("yaml",mlt(s.getWorker)),t.languages.registerDocumentFormattingEditProvider("yaml",wlt(s.getWorker)),t.languages.registerLinkProvider("yaml",vlt(s.getWorker)),t.languages.registerCodeActionProvider("yaml",blt(s.getWorker)),t.languages.registerFoldingRangeProvider("yaml",ylt(s.getWorker)),t.languages.setLanguageConfiguration("yaml",{comments:{lineComment:"#"},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],onEnterRules:[{beforeText:/:\s*$/,action:{indentAction:t.languages.IndentAction.Indent}}]})];return{dispose(){for(const t of r)t.dispose();n.dispose()},update(i){s.updateCreateData(Object.assign(e,i)),n.dispose(),n=$ct(t,"yaml",dlt(s.getWorker))}}}self.MonacoEnvironment={getWorker:(t,i)=>i==="json"?new Ict:i==="css"||i==="scss"||i==="less"?new _ct:i==="html"||i==="handlebars"||i==="razor"?new Pct:i==="typescript"||i==="javascript"?new Nct:i==="yaml"?new Bct:new Oct};export{klt as P,Rct as R,dY as j,dX as s};
//# sourceMappingURL=p-d2060894.js.map