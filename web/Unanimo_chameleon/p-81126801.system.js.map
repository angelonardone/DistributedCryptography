{"version":3,"names":["VALID_CSS_URL_PATH_REGEX","isMobileDevice","exports","test","navigator","userAgent","ROOT_VIEW","copyToTheClipboard","text","clipboard","writeText","tokenMap","tokens","keys","Object","result","index","length","tokenKey","tokenValue","concat","tokenMapExportParts","partToRename","inBetween","x","y","z","resetDragImage","window","Image","removeDragImage","event","dataTransfer","setDragImage","isPseudoElementImg","src","imageType","forceCSSMinMax","value","minimum","maximum","Number","isNaN","Math","max","min","addCursorInDocument","cursor","document","documentElement","style","resetCursorInDocument","removePointerEventsInDocumentBody","body","pointerEvents","resetPointerEventsInDocumentBody","isRTL","dir","RTLWatcher","RTLSubscribers","setRTLWatcher","MutationObserver","size","rtlDirection","subscribers","__spreadArray","values","subscriberCallback","observe","attributeFilter","subscribeToRTLChanges","subscriberId","callback","Map","set","unsubscribeToRTLChanges","delete","disconnect","undefined","formatImagePath","imageSrc","updateDirectionInImageCustomVar","image","direction","states_1","startImg","base","active","focus","hover","selected","disabled","classes","styles","states","endImg"],"sources":["src/common/utils.ts"],"sourcesContent":["import { Component } from \"./interfaces\";\r\nimport {\r\n  CssCursorProperty,\r\n  GxImageMultiState,\r\n  GxImageMultiStateEndStyles,\r\n  GxImageMultiStateStartStyles,\r\n  ImageRender\r\n} from \"./types\";\r\n\r\nconst VALID_CSS_URL_PATH_REGEX = /^\\s*(var\\(|url\\()/;\r\n\r\nexport function debounce(\r\n  func: () => void,\r\n  wait: number,\r\n  immediate = false\r\n): () => void {\r\n  let timeout: NodeJS.Timeout;\r\n\r\n  return function (...args) {\r\n    const later = function () {\r\n      timeout = null;\r\n      if (!immediate) {\r\n        // @ts-expect-error: TODO: This function will be removed when we refactor line-clamp implementation. So we are avoiding this error\r\n        func.apply(this, args);\r\n      }\r\n      // @ts-expect-error: TODO: This function will be removed when we refactor line-clamp implementation. So we are avoiding this error\r\n    }.bind(this);\r\n\r\n    const callNow = immediate && !timeout;\r\n\r\n    clearTimeout(timeout);\r\n    timeout = setTimeout(later, wait);\r\n\r\n    if (callNow) {\r\n      // @ts-expect-error: TODO: This function will be removed when we refactor line-clamp implementation. So we are avoiding this error\r\n      func.apply(this, args);\r\n    }\r\n  };\r\n}\r\n\r\nexport const isMobileDevice = () =>\r\n  /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\r\n    navigator.userAgent\r\n  );\r\n\r\nexport const ROOT_VIEW: null = null;\r\n\r\n/*  This functions overrides a method adding calls before (`before()`) and\r\n    after (`after()`) \r\n*/\r\nexport function overrideMethod(\r\n  component: Component,\r\n  methodName: string,\r\n  { before, after }: { before?: () => void; after?: () => void }\r\n) {\r\n  const oldMethod = component[methodName];\r\n  component[methodName] = () => {\r\n    if (before !== undefined) {\r\n      before();\r\n    }\r\n\r\n    if (oldMethod !== undefined) {\r\n      oldMethod.call(component);\r\n    }\r\n\r\n    if (after !== undefined) {\r\n      after();\r\n    }\r\n  };\r\n}\r\n\r\nexport const copyToTheClipboard = (text: string) =>\r\n  navigator.clipboard.writeText(text);\r\n\r\n/**\r\n * Converts an object mapping token keys to booleans into a space-separated\r\n * string containing the token keys that map to truthy values.\r\n * @example\r\n *   part={tokenMap({\r\n *     header: true,\r\n *     disabled: this.disabled,\r\n *     selected: this.selected,\r\n *     [levelPart]: canShowLines,\r\n *     \"expand-button\":\r\n *       canShowLines && !this.leaf && this.expandableButton !== \"no\"\r\n *   })}\r\n */\r\nexport const tokenMap = (tokens: { [key: string]: boolean }) => {\r\n  const keys = Object.keys(tokens);\r\n  let result = \"\";\r\n\r\n  for (let index = 0; index < keys.length; index++) {\r\n    const tokenKey = keys[index];\r\n    const tokenValue = tokens[tokenKey];\r\n\r\n    if (tokenValue) {\r\n      result += result === \"\" ? tokenKey : ` ${tokenKey}`;\r\n    }\r\n  }\r\n\r\n  return result;\r\n};\r\n\r\n/**\r\n * Same as tokenMap, but for the exportparts attribute.\r\n * @example\r\n *   part={tokenMapExportParts({\r\n *     header: true,\r\n *     disabled: this.disabled,\r\n *     selected: this.selected,\r\n *     [levelPart]: canShowLines,\r\n *     \"expand-button\":\r\n *       canShowLines && !this.leaf && this.expandableButton !== \"no\"\r\n *   }, \"window\")}\r\n */\r\nexport const tokenMapExportParts = (\r\n  tokens: { [key: string]: boolean },\r\n  partToRename: string\r\n) => {\r\n  const keys = Object.keys(tokens);\r\n  let result = \"\";\r\n\r\n  for (let index = 0; index < keys.length; index++) {\r\n    const tokenKey = keys[index];\r\n    const tokenValue = tokens[tokenKey];\r\n\r\n    if (tokenValue) {\r\n      result +=\r\n        result === \"\"\r\n          ? `${partToRename}:${tokenKey}`\r\n          : `,${partToRename}:${tokenKey}`;\r\n    }\r\n  }\r\n\r\n  return result;\r\n};\r\n\r\n/**\r\n * `true` if `x` <= `y` <= `z`\r\n */\r\nexport const inBetween = (x: number, y: number, z: number) => x <= y && y <= z;\r\n\r\nlet resetDragImage;\r\n\r\n/* @__PURE__ */ if (!window.Image) {\r\n  resetDragImage = \"test\";\r\n}\r\n\r\nresetDragImage ??= new Image();\r\nexport const removeDragImage = (event: DragEvent) =>\r\n  event.dataTransfer.setDragImage(resetDragImage, 0, 0);\r\n\r\nexport const isPseudoElementImg = (src?: string, imageType?: ImageRender) =>\r\n  src && imageType !== \"img\";\r\n\r\n/**\r\n * Force a value to follow CSS minimum and maximum rules. Note that the minimum\r\n * value can be greater than the maximum value, as implemented by the CSS\r\n * specification.\r\n * The maximum value can be `NaN`. In this case only the minimum value rule\r\n * will be apply.\r\n */\r\nexport const forceCSSMinMax = (\r\n  value: number,\r\n  minimum: number,\r\n  maximum: number\r\n): number =>\r\n  Number.isNaN(maximum)\r\n    ? Math.max(value, minimum)\r\n    : Math.max(Math.min(value, maximum), minimum);\r\n\r\n// - - - - - - - - - - - - - - - - - - - -\r\n//        Cursor and pointer events\r\n// - - - - - - - - - - - - - - - - - - - -\r\nexport const addCursorInDocument = (cursor: CssCursorProperty) => {\r\n  document.documentElement.style.cursor = cursor;\r\n};\r\n\r\nexport const resetCursorInDocument = () => {\r\n  document.documentElement.style.cursor = null;\r\n};\r\n\r\nexport const removePointerEventsInDocumentBody = () => {\r\n  document.body.style.pointerEvents = \"none\";\r\n};\r\n\r\nexport const resetPointerEventsInDocumentBody = () => {\r\n  document.body.style.pointerEvents = null;\r\n};\r\n\r\n// - - - - - - - - - - - - - - - - - - - -\r\n//                RTL utils\r\n// - - - - - - - - - - - - - - - - - - - -\r\nexport const isRTL = () => document.documentElement.dir === \"rtl\";\r\n\r\nlet RTLWatcher: MutationObserver | undefined; // Don't allocate memory until needed\r\nlet RTLSubscribers: Map<string, (rtl: boolean) => void> | undefined; // Don't allocate memory until needed\r\n\r\nconst setRTLWatcher = () => {\r\n  if (RTLWatcher) {\r\n    return;\r\n  }\r\n\r\n  RTLWatcher = new MutationObserver(() => {\r\n    // Defensive programming. Check if there are subscribers\r\n    if (!RTLSubscribers || RTLSubscribers.size === 0) {\r\n      return;\r\n    }\r\n\r\n    const rtlDirection = isRTL();\r\n    const subscribers = [...RTLSubscribers.values()];\r\n\r\n    // Notify all subscribers\r\n    for (let index = 0; index < subscribers.length; index++) {\r\n      const subscriberCallback = subscribers[index];\r\n      subscriberCallback(rtlDirection);\r\n    }\r\n  });\r\n\r\n  // Observe the dir attribute in the document\r\n  RTLWatcher.observe(document.documentElement, {\r\n    attributeFilter: [\"dir\"]\r\n  });\r\n};\r\n\r\nexport const subscribeToRTLChanges = (\r\n  subscriberId: string,\r\n  callback: (rtl: boolean) => void\r\n) => {\r\n  setRTLWatcher();\r\n\r\n  RTLSubscribers ??= new Map();\r\n  RTLSubscribers.set(subscriberId, callback);\r\n};\r\n\r\nexport const unsubscribeToRTLChanges = (subscriberId: string) => {\r\n  RTLSubscribers.delete(subscriberId);\r\n\r\n  // Free the memory if no subscribers remaining\r\n  if (RTLSubscribers.size === 0) {\r\n    RTLWatcher.disconnect();\r\n    RTLWatcher = undefined;\r\n    RTLSubscribers = undefined;\r\n  }\r\n};\r\n\r\n// TODO: Test more use cases\r\nexport const formatImagePath = <T extends string | undefined>(\r\n  imageSrc: T,\r\n  imageType: ImageRender\r\n) =>\r\n  !imageSrc || imageType === \"img\" || VALID_CSS_URL_PATH_REGEX.test(imageSrc)\r\n    ? imageSrc\r\n    : (`url(${imageSrc})` as const);\r\n\r\nexport const updateDirectionInImageCustomVar = <T extends \"start\" | \"end\">(\r\n  image: GxImageMultiState | undefined,\r\n  direction: T,\r\n  imageType: ImageRender = \"background\"\r\n):\r\n  | {\r\n      classes: string;\r\n      styles: GxImageMultiStateStartStyles | GxImageMultiStateEndStyles;\r\n    }\r\n  | undefined => {\r\n  if (!image) {\r\n    return undefined;\r\n  }\r\n\r\n  if (direction === \"start\") {\r\n    let states = \"start-img--base\";\r\n\r\n    const startImg: GxImageMultiStateStartStyles = {\r\n      \"--ch-start-img--base\": formatImagePath(image.base, imageType)\r\n    };\r\n\r\n    if (image.active) {\r\n      startImg[\"--ch-start-img--active\"] = formatImagePath(\r\n        image.active,\r\n        imageType\r\n      );\r\n      states += \" start-img--active\";\r\n    }\r\n    if (image.focus) {\r\n      startImg[\"--ch-start-img--focus\"] = formatImagePath(\r\n        image.focus,\r\n        imageType\r\n      );\r\n      states += \" start-img--focus\";\r\n    }\r\n    if (image.hover) {\r\n      startImg[\"--ch-start-img--hover\"] = formatImagePath(\r\n        image.hover,\r\n        imageType\r\n      );\r\n      states += \" start-img--hover\";\r\n    }\r\n    if (image.selected) {\r\n      startImg[\"--ch-start-img--selected\"] = formatImagePath(\r\n        image.selected,\r\n        imageType\r\n      );\r\n      states += \" start-img--selected\";\r\n    }\r\n    if (image.disabled) {\r\n      startImg[\"--ch-start-img--disabled\"] = formatImagePath(\r\n        image.disabled,\r\n        imageType\r\n      );\r\n      states += \" start-img--disabled\";\r\n    }\r\n\r\n    return { classes: states, styles: startImg };\r\n  }\r\n\r\n  let states = \"end-img--base\";\r\n  const endImg: GxImageMultiStateEndStyles = {\r\n    \"--ch-end-img--base\": formatImagePath(image.base, imageType)\r\n  };\r\n\r\n  if (image.active) {\r\n    endImg[\"--ch-end-img--active\"] = formatImagePath(image.active, imageType);\r\n    states += \" end-img--active\";\r\n  }\r\n  if (image.focus) {\r\n    endImg[\"--ch-end-img--focus\"] = formatImagePath(image.focus, imageType);\r\n    states += \" end-img--focus\";\r\n  }\r\n  if (image.hover) {\r\n    endImg[\"--ch-end-img--hover\"] = formatImagePath(image.hover, imageType);\r\n    states += \" end-img--hover\";\r\n  }\r\n  if (image.selected) {\r\n    endImg[\"--ch-end-img--selected\"] = formatImagePath(\r\n      image.selected,\r\n      imageType\r\n    );\r\n    states += \" end-img--selected\";\r\n  }\r\n  if (image.disabled) {\r\n    endImg[\"--ch-end-img--disabled\"] = formatImagePath(\r\n      image.disabled,\r\n      imageType\r\n    );\r\n    states += \" end-img--disabled\";\r\n  }\r\n\r\n  return { classes: states, styles: endImg };\r\n};\r\n"],"mappings":"yTASA,IAAMA,EAA2B,oB,IA+BpBC,EAAcC,EAAA,KAAG,WAC5B,uEAAiEC,KAC/DC,UAAUC,UADZ,I,IAIWC,EAASJ,EAAA,IAAS,M,IA0BlBK,EAAkBL,EAAA,KAAG,SAACM,GACjC,OAAAJ,UAAUK,UAAUC,UAAUF,EAA9B,I,IAeWG,EAAQT,EAAA,KAAG,SAACU,GACvB,IAAMC,EAAOC,OAAOD,KAAKD,GACzB,IAAIG,EAAS,GAEb,IAAK,IAAIC,EAAQ,EAAGA,EAAQH,EAAKI,OAAQD,IAAS,CAChD,IAAME,EAAWL,EAAKG,GACtB,IAAMG,EAAaP,EAAOM,GAE1B,GAAIC,EAAY,CACdJ,GAAUA,IAAW,GAAKG,EAAW,IAAAE,OAAIF,E,EAI7C,OAAOH,CACT,I,IAcaM,EAAmBnB,EAAA,KAAG,SACjCU,EACAU,GAEA,IAAMT,EAAOC,OAAOD,KAAKD,GACzB,IAAIG,EAAS,GAEb,IAAK,IAAIC,EAAQ,EAAGA,EAAQH,EAAKI,OAAQD,IAAS,CAChD,IAAME,EAAWL,EAAKG,GACtB,IAAMG,EAAaP,EAAOM,GAE1B,GAAIC,EAAY,CACdJ,GACEA,IAAW,GACP,GAAAK,OAAGE,EAAY,KAAAF,OAAIF,GACnB,IAAAE,OAAIE,EAAY,KAAAF,OAAIF,E,EAI9B,OAAOH,CACT,I,IAKaQ,EAASrB,EAAA,KAAG,SAACsB,EAAWC,EAAWC,GAAc,OAAAF,GAAKC,GAAKA,GAAKC,CAAf,IAE9D,IAAIC,EAEY,IAAKC,OAAOC,MAAO,CACjCF,EAAiB,MACnB,CAEAA,IAAc,MAAdA,SAAc,EAAdA,IAAmB,IAAIE,M,IACVC,EAAe5B,EAAA,KAAG,SAAC6B,GAC9B,OAAAA,EAAMC,aAAaC,aAAaN,EAAgB,EAAG,EAAnD,I,IAEWO,EAAkBhC,EAAA,KAAG,SAACiC,EAAcC,GAC/C,OAAAD,GAAOC,IAAc,KAArB,I,IASWC,EAAcnC,EAAA,KAAG,SAC5BoC,EACAC,EACAC,GAEA,OAAAC,OAAOC,MAAMF,GACTG,KAAKC,IAAIN,EAAOC,GAChBI,KAAKC,IAAID,KAAKE,IAAIP,EAAOE,GAAUD,EAFvC,I,IAOWO,EAAmB5C,EAAA,KAAG,SAAC6C,GAClCC,SAASC,gBAAgBC,MAAMH,OAASA,CAC1C,I,IAEaI,EAAqBjD,EAAA,KAAG,WACnC8C,SAASC,gBAAgBC,MAAMH,OAAS,IAC1C,I,IAEaK,EAAiClD,EAAA,KAAG,WAC/C8C,SAASK,KAAKH,MAAMI,cAAgB,MACtC,I,IAEaC,EAAgCrD,EAAA,KAAG,WAC9C8C,SAASK,KAAKH,MAAMI,cAAgB,IACtC,I,IAKaE,EAAKtD,EAAA,KAAG,WAAM,OAAA8C,SAASC,gBAAgBQ,MAAQ,KAAjC,IAE3B,IAAIC,EACJ,IAAIC,EAEJ,IAAMC,EAAgB,WACpB,GAAIF,EAAY,CACd,M,CAGFA,EAAa,IAAIG,kBAAiB,WAEhC,IAAKF,GAAkBA,EAAeG,OAAS,EAAG,CAChD,M,CAGF,IAAMC,EAAeP,IACrB,IAAMQ,EAAWC,cAAA,GAAON,EAAeO,SAAQ,MAG/C,IAAK,IAAIlD,EAAQ,EAAGA,EAAQgD,EAAY/C,OAAQD,IAAS,CACvD,IAAMmD,EAAqBH,EAAYhD,GACvCmD,EAAmBJ,E,KAKvBL,EAAWU,QAAQpB,SAASC,gBAAiB,CAC3CoB,gBAAiB,CAAC,QAEtB,E,IAEaC,EAAqBpE,EAAA,KAAG,SACnCqE,EACAC,GAEAZ,IAEAD,IAAc,MAAdA,SAAc,EAAdA,IAAmB,IAAIc,IACvBd,EAAee,IAAIH,EAAcC,EACnC,I,IAEaG,EAAuBzE,EAAA,KAAG,SAACqE,GACtCZ,EAAeiB,OAAOL,GAGtB,GAAIZ,EAAeG,OAAS,EAAG,CAC7BJ,EAAWmB,aACXnB,EAAaoB,UACbnB,EAAiBmB,S,CAErB,I,IAGaC,EAAe7E,EAAA,KAAG,SAC7B8E,EACA5C,GAEA,OAAC4C,GAAY5C,IAAc,OAASpC,EAAyBG,KAAK6E,GAC9DA,EACC,OAAA5D,OAAO4D,EAAQ,IAFpB,I,IAIWC,EAA+B/E,EAAA,KAAG,SAC7CgF,EACAC,EACA/C,GAAA,GAAAA,SAAA,GAAAA,EAAA,YAAqC,CAOrC,IAAK8C,EAAO,CACV,OAAOJ,S,CAGT,GAAIK,IAAc,QAAS,CACzB,IAAIC,EAAS,kBAEb,IAAMC,EAAyC,CAC7C,uBAAwBN,EAAgBG,EAAMI,KAAMlD,IAGtD,GAAI8C,EAAMK,OAAQ,CAChBF,EAAS,0BAA4BN,EACnCG,EAAMK,OACNnD,GAEFgD,GAAU,oB,CAEZ,GAAIF,EAAMM,MAAO,CACfH,EAAS,yBAA2BN,EAClCG,EAAMM,MACNpD,GAEFgD,GAAU,mB,CAEZ,GAAIF,EAAMO,MAAO,CACfJ,EAAS,yBAA2BN,EAClCG,EAAMO,MACNrD,GAEFgD,GAAU,mB,CAEZ,GAAIF,EAAMQ,SAAU,CAClBL,EAAS,4BAA8BN,EACrCG,EAAMQ,SACNtD,GAEFgD,GAAU,sB,CAEZ,GAAIF,EAAMS,SAAU,CAClBN,EAAS,4BAA8BN,EACrCG,EAAMS,SACNvD,GAEFgD,GAAU,sB,CAGZ,MAAO,CAAEQ,QAASR,EAAQS,OAAQR,E,CAGpC,IAAIS,EAAS,gBACb,IAAMC,EAAqC,CACzC,qBAAsBhB,EAAgBG,EAAMI,KAAMlD,IAGpD,GAAI8C,EAAMK,OAAQ,CAChBQ,EAAO,wBAA0BhB,EAAgBG,EAAMK,OAAQnD,GAC/D0D,GAAU,kB,CAEZ,GAAIZ,EAAMM,MAAO,CACfO,EAAO,uBAAyBhB,EAAgBG,EAAMM,MAAOpD,GAC7D0D,GAAU,iB,CAEZ,GAAIZ,EAAMO,MAAO,CACfM,EAAO,uBAAyBhB,EAAgBG,EAAMO,MAAOrD,GAC7D0D,GAAU,iB,CAEZ,GAAIZ,EAAMQ,SAAU,CAClBK,EAAO,0BAA4BhB,EACjCG,EAAMQ,SACNtD,GAEF0D,GAAU,oB,CAEZ,GAAIZ,EAAMS,SAAU,CAClBI,EAAO,0BAA4BhB,EACjCG,EAAMS,SACNvD,GAEF0D,GAAU,oB,CAGZ,MAAO,CAAEF,QAASE,EAAQD,OAAQE,EACpC,G"}